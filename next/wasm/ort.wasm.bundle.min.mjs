/*! For license information please see ort.wasm.bundle.min.mjs.LICENSE.txt */
let e;var r=Object.defineProperty,n=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,i,s,u,l,f,c,p,d,h,m,y,g,w,b,v,E,T,O,A,C,_,R,U,x,I,L,M,P,S,$,k,B,N,D=(e=function(e){if("u">typeof require)return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')},"u">typeof require?require:"u">typeof Proxy?new Proxy(e,{get:(e,r)=>("u">typeof require?require:e)[r]}):e),F=(e,r)=>()=>(e&&(r=e(e=0)),r),G=(e,n)=>{for(var a in n)r(e,a,{get:n[a],enumerable:!0})},W=e=>((e,i,s,u)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let l of a(i))o.call(e,l)||l===s||r(e,l,{get:()=>i[l],enumerable:!(u=n(i,l))||u.enumerable});return e})(r({},"__esModule",{value:!0}),e),j=F(()=>{"use strict";i=new Map,s=[],u=(e,r,n)=>{if(r&&"function"==typeof r.init&&"function"==typeof r.createInferenceSessionHandler){let a=i.get(e);if(void 0===a)i.set(e,{backend:r,priority:n});else{if(a.priority>n)return;if(a.priority===n&&a.backend!==r)throw Error(`cannot register backend "${e}" using priority ${n}`)}if(n>=0){let r=s.indexOf(e);-1!==r&&s.splice(r,1);for(let r=0;r<s.length;r++)if(i.get(s[r]).priority<=n)return void s.splice(r,0,e);s.push(e)}return}throw TypeError("not a valid backend")},l=async e=>{let r=i.get(e);if(!r)return"backend not found.";if(r.initialized)return r.backend;if(r.aborted)return r.error;{let n=!!r.initPromise;try{return n||(r.initPromise=r.backend.init(e)),await r.initPromise,r.initialized=!0,r.backend}catch(e){return n||(r.error=`${e}`,r.aborted=!0),r.error}finally{delete r.initPromise}}},f=async e=>{let r=e.executionProviders||[],n=r.map(e=>"string"==typeof e?e:e.name),a=0===n.length?s:n,o,i=[],u=new Set;for(let e of a){let r=await l(e);"string"==typeof r?i.push({name:e,err:r}):(o||(o=r),o===r&&u.add(e))}if(!o)throw Error(`no available backend found. ERR: ${i.map(e=>`[${e.name}] ${e.err}`).join(", ")}`);for(let{name:e,err:r}of i)n.includes(e)&&console.warn(`removing requested execution provider "${e}" from session options because it is not available: ${r}`);let f=r.filter(e=>u.has("string"==typeof e?e:e.name));return[o,new Proxy(e,{get:(e,r)=>"executionProviders"===r?f:Reflect.get(e,r)})]}}),V=F(()=>{"use strict";j()}),H=F(()=>{"use strict";c="1.23.2"}),z=F(()=>{"use strict";H(),p="warning",Object.defineProperty(d={wasm:{},webgl:{},webgpu:{},versions:{common:c},set logLevel(t){if(void 0!==t){if("string"!=typeof t||-1===["verbose","info","warning","error","fatal"].indexOf(t))throw Error(`Unsupported logging level: ${t}`);p=t}},get logLevel(){return p}},"logLevel",{enumerable:!0})}),q=F(()=>{"use strict";z(),h=d}),Y=F(()=>{"use strict";m=(e,r)=>{let n="u">typeof document?document.createElement("canvas"):new OffscreenCanvas(1,1);n.width=e.dims[3],n.height=e.dims[2];let a=n.getContext("2d");if(null!=a){let o,i;r?.tensorLayout!==void 0&&"NHWC"===r.tensorLayout?(o=e.dims[2],i=e.dims[3]):(o=e.dims[3],i=e.dims[2]);let s=r?.format!==void 0?r.format:"RGB",u=r?.norm,l,f;void 0===u||void 0===u.mean?l=[255,255,255,255]:"number"==typeof u.mean?l=[u.mean,u.mean,u.mean,u.mean]:(l=[u.mean[0],u.mean[1],u.mean[2],0],void 0!==u.mean[3]&&(l[3]=u.mean[3])),void 0===u||void 0===u.bias?f=[0,0,0,0]:"number"==typeof u.bias?f=[u.bias,u.bias,u.bias,u.bias]:(f=[u.bias[0],u.bias[1],u.bias[2],0],void 0!==u.bias[3]&&(f[3]=u.bias[3]));let c=i*o,p=0,d=c,h=2*c,m=-1;"RGBA"===s?(p=0,d=c,h=2*c,m=3*c):"RGB"===s?(p=0,d=c,h=2*c):"RBG"===s&&(p=0,h=c,d=2*c);for(let r=0;r<i;r++)for(let n=0;n<o;n++)a.fillStyle="rgba("+(e.data[p++]-f[0])*l[0]+","+(e.data[d++]-f[1])*l[1]+","+(e.data[h++]-f[2])*l[2]+","+(-1===m?255:(e.data[m++]-f[3])*l[3])+")",a.fillRect(n,r,1,1);if("toDataURL"in n)return n.toDataURL();throw Error("toDataURL is not supported")}throw Error("Can not access image data")},y=(e,r)=>{let n="u">typeof document?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),a;if(null!=n){let o,i,s;r?.tensorLayout!==void 0&&"NHWC"===r.tensorLayout?(o=e.dims[2],i=e.dims[1],s=e.dims[3]):(o=e.dims[3],i=e.dims[2],s=e.dims[1]);let u=void 0!==r&&void 0!==r.format?r.format:"RGB",l=r?.norm,f,c;void 0===l||void 0===l.mean?f=[255,255,255,255]:"number"==typeof l.mean?f=[l.mean,l.mean,l.mean,l.mean]:(f=[l.mean[0],l.mean[1],l.mean[2],255],void 0!==l.mean[3]&&(f[3]=l.mean[3])),void 0===l||void 0===l.bias?c=[0,0,0,0]:"number"==typeof l.bias?c=[l.bias,l.bias,l.bias,l.bias]:(c=[l.bias[0],l.bias[1],l.bias[2],0],void 0!==l.bias[3]&&(c[3]=l.bias[3]));let p=i*o;if(void 0!==r&&(void 0!==r.format&&4===s&&"RGBA"!==r.format||3===s&&"RGB"!==r.format&&"BGR"!==r.format))throw Error("Tensor format doesn't match input tensor dims");let d=0,h=1,m=2,y=3,g=0,w=p,b=2*p,v=-1;"RGBA"===u?(g=0,w=p,b=2*p,v=3*p):"RGB"===u?(g=0,w=p,b=2*p):"RBG"===u&&(g=0,b=p,w=2*p),a=n.createImageData(o,i);for(let r=0;r<i*o;d+=4,h+=4,m+=4,y+=4,r++)a.data[d]=(e.data[g++]-c[0])*f[0],a.data[h]=(e.data[w++]-c[1])*f[1],a.data[m]=(e.data[b++]-c[2])*f[2],a.data[y]=-1===v?255:(e.data[v++]-c[3])*f[3]}else throw Error("Can not access image data");return a}}),Z=F(()=>{"use strict";J(),g=(e,r)=>{if(void 0===e)throw Error("Image buffer must be defined");if(void 0===r.height||void 0===r.width)throw Error("Image height and width must be defined");if("NHWC"===r.tensorLayout)throw Error("NHWC Tensor layout is not supported yet");let{height:n,width:a}=r,o=r.norm??{mean:255,bias:0},i,s;i="number"==typeof o.mean?[o.mean,o.mean,o.mean,o.mean]:[o.mean[0],o.mean[1],o.mean[2],o.mean[3]??255],s="number"==typeof o.bias?[o.bias,o.bias,o.bias,o.bias]:[o.bias[0],o.bias[1],o.bias[2],o.bias[3]??0];let u=void 0!==r.format?r.format:"RGBA",l=void 0!==r.tensorFormat&&void 0!==r.tensorFormat?r.tensorFormat:"RGB",f=n*a,c=new Float32Array("RGBA"===l?4*f:3*f),p=4,d=0,h=1,m=2,y=3,g=0,w=f,b=2*f,v=-1;"RGB"===u&&(p=3,d=0,h=1,m=2,y=-1),"RGBA"===l?v=3*f:"RBG"===l?(g=0,b=f,w=2*f):"BGR"===l&&(b=0,w=f,g=2*f);for(let r=0;r<f;r++,d+=p,m+=p,h+=p,y+=p)c[g++]=(e[d]+s[0])/i[0],c[w++]=(e[h]+s[1])/i[1],c[b++]=(e[m]+s[2])/i[2],-1!==v&&-1!==y&&(c[v++]=(e[y]+s[3])/i[3]);return"RGBA"===l?new x("float32",c,[1,4,n,a]):new x("float32",c,[1,3,n,a])},w=async(e,r)=>{let n="u">typeof HTMLImageElement&&e instanceof HTMLImageElement,a="u">typeof ImageData&&e instanceof ImageData,o="u">typeof ImageBitmap&&e instanceof ImageBitmap,i="string"==typeof e,s,u=r??{},l=()=>{if("u">typeof document)return document.createElement("canvas");if("u">typeof OffscreenCanvas)return new OffscreenCanvas(1,1);throw Error("Canvas is not supported")},f=e=>"u">typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas?e.getContext("2d"):null;if(n){let n=l();n.width=e.width,n.height=e.height;let a=f(n);if(null!=a){let n=e.height,o=e.width;if(void 0!==r&&void 0!==r.resizedHeight&&void 0!==r.resizedWidth&&(n=r.resizedHeight,o=r.resizedWidth),void 0!==r){if(u=r,void 0!==r.tensorFormat)throw Error("Image input config format must be RGBA for HTMLImageElement");u.tensorFormat="RGBA",u.height=n,u.width=o}else u.tensorFormat="RGBA",u.height=n,u.width=o;a.drawImage(e,0,0),s=a.getImageData(0,0,o,n).data}else throw Error("Can not access image data")}else if(a){let n,a;if(void 0!==r&&void 0!==r.resizedWidth&&void 0!==r.resizedHeight?(n=r.resizedHeight,a=r.resizedWidth):(n=e.height,a=e.width),void 0!==r&&(u=r),u.format="RGBA",u.height=n,u.width=a,void 0!==r){let r=l();r.width=a,r.height=n;let o=f(r);if(null!=o)o.putImageData(e,0,0),s=o.getImageData(0,0,a,n).data;else throw Error("Can not access image data")}else s=e.data}else if(o){if(void 0===r)throw Error("Please provide image config with format for Imagebitmap");let n=l();n.width=e.width,n.height=e.height;let a=f(n);if(null!=a){let r=e.height,n=e.width;return a.drawImage(e,0,0,n,r),s=a.getImageData(0,0,n,r).data,u.height=r,u.width=n,g(s,u)}throw Error("Can not access image data")}else{if(i)return new Promise((r,n)=>{let a=l(),o=f(a);if(!e||!o)return n();let i=new Image;i.crossOrigin="Anonymous",i.src=e,i.onload=()=>{a.width=i.width,a.height=i.height,o.drawImage(i,0,0,a.width,a.height);let e=o.getImageData(0,0,a.width,a.height);u.height=a.height,u.width=a.width,r(g(e.data,u))}});throw Error("Input data provided is not supported - aborted tensor creation")}if(void 0!==s)return g(s,u);throw Error("Input data provided is not supported - aborted tensor creation")},b=(e,r)=>{let{width:n,height:a,download:o,dispose:i}=r;return new x({location:"texture",type:"float32",texture:e,dims:[1,a,n,4],download:o,dispose:i})},v=(e,r)=>{let{dataType:n,dims:a,download:o,dispose:i}=r;return new x({location:"gpu-buffer",type:n??"float32",gpuBuffer:e,dims:a,download:o,dispose:i})},E=(e,r)=>{let{dataType:n,dims:a,download:o,dispose:i}=r;return new x({location:"ml-tensor",type:n??"float32",mlTensor:e,dims:a,download:o,dispose:i})},T=(e,r,n)=>new x({location:"cpu-pinned",type:e,data:r,dims:n??[r.length]})}),Q=F(()=>{"use strict";O=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),A=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),C=!1,_=()=>{if(!C){C=!0;let e="u">typeof BigInt64Array&&BigInt64Array.from,r="u">typeof BigUint64Array&&BigUint64Array.from,n=globalThis.Float16Array,a="u">typeof n&&n.from;e&&(O.set("int64",BigInt64Array),A.set(BigInt64Array,"int64")),r&&(O.set("uint64",BigUint64Array),A.set(BigUint64Array,"uint64")),a?(O.set("float16",n),A.set(n,"float16")):O.set("float16",Uint16Array)}}}),X=F(()=>{"use strict";J(),R=e=>{let r=1;for(let n=0;n<e.length;n++){let a=e[n];if("number"!=typeof a||!Number.isSafeInteger(a))throw TypeError(`dims[${n}] must be an integer, got: ${a}`);if(a<0)throw RangeError(`dims[${n}] must be a non-negative integer, got: ${a}`);r*=a}return r},U=(e,r)=>{switch(e.location){case"cpu":return new x(e.type,e.data,r);case"cpu-pinned":return new x({location:"cpu-pinned",data:e.data,type:e.type,dims:r});case"texture":return new x({location:"texture",texture:e.texture,type:e.type,dims:r});case"gpu-buffer":return new x({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:r});case"ml-tensor":return new x({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:r});default:throw Error(`tensorReshape: tensor location ${e.location} is not supported`)}}}),J=F(()=>{"use strict";Y(),Z(),Q(),X(),x=class{constructor(e,r,n){let a,o;if(_(),"object"==typeof e&&"location"in e)switch(this.dataLocation=e.location,a=e.type,o=e.dims,e.location){case"cpu-pinned":{let r=O.get(a);if(!r)throw TypeError(`unsupported type "${a}" to create tensor from pinned buffer`);if(!(e.data instanceof r))throw TypeError(`buffer should be of type ${r.name}`);this.cpuData=e.data;break}case"texture":if("float32"!==a)throw TypeError(`unsupported type "${a}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break;case"gpu-buffer":if("float32"!==a&&"float16"!==a&&"int32"!==a&&"int64"!==a&&"uint32"!==a&&"uint8"!==a&&"bool"!==a&&"uint4"!==a&&"int4"!==a)throw TypeError(`unsupported type "${a}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break;case"ml-tensor":if("float32"!==a&&"float16"!==a&&"int32"!==a&&"int64"!==a&&"uint32"!==a&&"uint64"!==a&&"int8"!==a&&"uint8"!==a&&"bool"!==a&&"uint4"!==a&&"int4"!==a)throw TypeError(`unsupported type "${a}" to create tensor from MLTensor`);this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break;default:throw Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let i,s;if("string"==typeof e)if(a=e,s=n,"string"===e){if(!Array.isArray(r))throw TypeError("A string tensor's data must be a string array.");i=r}else{let n=O.get(e);if(void 0===n)throw TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(r)){if("float16"===e&&n===Uint16Array||"uint4"===e||"int4"===e)throw TypeError(`Creating a ${e} tensor from number array is not supported. Please use ${n.name} as data.`);i="uint64"===e||"int64"===e?n.from(r,BigInt):n.from(r)}else if(r instanceof n)i=r;else if(r instanceof Uint8ClampedArray)if("uint8"===e)i=Uint8Array.from(r);else throw TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if("float16"===e&&r instanceof Uint16Array&&n!==Uint16Array)i=new globalThis.Float16Array(r.buffer,r.byteOffset,r.length);else throw TypeError(`A ${a} tensor's data must be type of ${n}`)}else if(s=r,Array.isArray(e)){if(0===e.length)throw TypeError("Tensor type cannot be inferred from an empty array.");let r=typeof e[0];if("string"===r)a="string",i=e;else if("boolean"===r)a="bool",i=Uint8Array.from(e);else throw TypeError(`Invalid element type of data array: ${r}.`)}else if(e instanceof Uint8ClampedArray)a="uint8",i=Uint8Array.from(e);else{let r=A.get(e.constructor);if(void 0===r)throw TypeError(`Unsupported type for tensor data: ${e.constructor}.`);a=r,i=e}if(void 0===s)s=[i.length];else if(!Array.isArray(s))throw TypeError("A tensor's dims must be a number array");o=s,this.cpuData=i,this.dataLocation="cpu"}let i=R(o);if(this.cpuData&&i!==this.cpuData.length&&("uint4"!==a&&"int4"!==a||Math.ceil(i/2)!==this.cpuData.length))throw Error(`Tensor's size(${i}) does not match data length(${this.cpuData.length}).`);this.type=a,this.dims=o,this.size=i}static async fromImage(e,r){return w(e,r)}static fromTexture(e,r){return b(e,r)}static fromGpuBuffer(e,r){return v(e,r)}static fromMLTensor(e,r){return E(e,r)}static fromPinnedBuffer(e,r,n){return T(e,r,n)}toDataURL(e){return m(this,e)}toImageData(e){return y(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":if(!this.downloader)throw Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let r=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=r,e&&this.disposer&&(this.disposer(),this.disposer=void 0),r}finally{this.isDownloading=!1}default:throw Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if("none"===this.dataLocation)throw Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw Error("Cannot reshape a tensor that owns GPU resource.");return U(this,e)}}}),K=F(()=>{"use strict";J(),I=x}),ee=F(()=>{"use strict";z(),L=(e,r)=>{(typeof d.trace>"u"?d.wasm.trace:d.trace)&&console.timeStamp(`${e}::ORT::${r}`)},M=(e,r)=>{let n=Error().stack?.split(/\r\n|\r|\n/g)||[],a=!1;for(let o=0;o<n.length;o++){if(a&&!n[o].includes("TRACE_FUNC")){let a=`FUNC_${e}::${n[o].trim().split(" ")[1]}`;r&&(a+=`::${r}`),L("CPU",a);return}n[o].includes("TRACE_FUNC")&&(a=!0)}},P=e=>{(typeof d.trace>"u"?d.wasm.trace:d.trace)&&M("BEGIN",e)},S=e=>{(typeof d.trace>"u"?d.wasm.trace:d.trace)&&M("END",e)},$=e=>{(typeof d.trace>"u"?d.wasm.trace:d.trace)&&console.time(`ORT::${e}`)},k=e=>{(typeof d.trace>"u"?d.wasm.trace:d.trace)&&console.timeEnd(`ORT::${e}`)}}),et=F(()=>{"use strict";j(),K(),ee(),B=class e{constructor(e){this.handler=e}async run(e,r,n){P(),$("InferenceSession.run");let a={},o={};if("object"!=typeof e||null===e||e instanceof I||Array.isArray(e))throw TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let i=!0;if("object"==typeof r){if(null===r)throw TypeError("Unexpected argument[1]: cannot be null.");if(r instanceof I)throw TypeError("'fetches' cannot be a Tensor");if(Array.isArray(r)){if(0===r.length)throw TypeError("'fetches' cannot be an empty array.");for(let e of(i=!1,r)){if("string"!=typeof e)throw TypeError("'fetches' must be a string array or an object.");if(-1===this.outputNames.indexOf(e))throw RangeError(`'fetches' contains invalid output name: ${e}.`);a[e]=null}if("object"==typeof n&&null!==n)o=n;else if("u">typeof n)throw TypeError("'options' must be an object.")}else{let e=!1,s=Object.getOwnPropertyNames(r);for(let n of this.outputNames)if(-1!==s.indexOf(n)){let o=r[n];(null===o||o instanceof I)&&(e=!0,i=!1,a[n]=o)}if(e){if("object"==typeof n&&null!==n)o=n;else if("u">typeof n)throw TypeError("'options' must be an object.")}else o=r}}else if("u">typeof r)throw TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let r of this.inputNames)if(typeof e[r]>"u")throw Error(`input '${r}' is missing in 'feeds'.`);if(i)for(let e of this.outputNames)a[e]=null;let s=await this.handler.run(e,a,o),u={};for(let e in s)if(Object.hasOwnProperty.call(s,e)){let r=s[e];r instanceof I?u[e]=r:u[e]=new I(r.type,r.data,r.dims)}return k("InferenceSession.run"),S(),u}async release(){return this.handler.dispose()}static async create(r,n,a,o){P(),$("InferenceSession.create");let i,s={};if("string"==typeof r){if(i=r,"object"==typeof n&&null!==n)s=n;else if("u">typeof n)throw TypeError("'options' must be an object.")}else if(r instanceof Uint8Array){if(i=r,"object"==typeof n&&null!==n)s=n;else if("u">typeof n)throw TypeError("'options' must be an object.")}else if(r instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&r instanceof SharedArrayBuffer){let e=0,u=r.byteLength;if("object"==typeof n&&null!==n)s=n;else if("number"==typeof n){if(!Number.isSafeInteger(e=n))throw RangeError("'byteOffset' must be an integer.");if(e<0||e>=r.byteLength)throw RangeError(`'byteOffset' is out of range [0, ${r.byteLength}).`);if(u=r.byteLength-e,"number"==typeof a){if(!Number.isSafeInteger(u=a))throw RangeError("'byteLength' must be an integer.");if(u<=0||e+u>r.byteLength)throw RangeError(`'byteLength' is out of range (0, ${r.byteLength-e}].`);if("object"==typeof o&&null!==o)s=o;else if("u">typeof o)throw TypeError("'options' must be an object.")}else if("u">typeof a)throw TypeError("'byteLength' must be a number.")}else if("u">typeof n)throw TypeError("'options' must be an object.");i=new Uint8Array(r,e,u)}else throw TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[u,l]=await f(s),c=await u.createInferenceSessionHandler(i,l);return k("InferenceSession.create"),S(),new e(c)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}get inputMetadata(){return this.handler.inputMetadata}get outputMetadata(){return this.handler.outputMetadata}}}),er=F(()=>{"use strict";et(),N=B}),en=F(()=>{}),ea=F(()=>{}),eo=F(()=>{}),ei=F(()=>{}),es={};G(es,{InferenceSession:()=>N,TRACE:()=>L,TRACE_EVENT_BEGIN:()=>$,TRACE_EVENT_END:()=>k,TRACE_FUNC_BEGIN:()=>P,TRACE_FUNC_END:()=>S,Tensor:()=>I,env:()=>h,registerBackend:()=>u});var eu=F(()=>{"use strict";V(),q(),er(),K(),en(),ea(),ee(),eo(),ei()}),el=F(()=>{}),ef={};G(ef,{default:()=>ep});var ec,ep,ed=F(()=>{"use strict";t_(),tv(),tb(),(ec=globalThis.self?.name==="ort-wasm-proxy-worker")&&(self.onmessage=e=>{let{type:r,in:n}=e.data;try{switch(r){case"init-wasm":eM(n.wasm).then(()=>{eQ(n).then(()=>{postMessage({type:r})},e=>{postMessage({type:r,err:e})})},e=>{postMessage({type:r,err:e})});break;case"init-ep":{let{epName:e,env:a}=n;eX(a,e).then(()=>{postMessage({type:r})},e=>{postMessage({type:r,err:e})});break}case"copy-from":{let{buffer:e}=n,a=e0(e);postMessage({type:r,out:a});break}case"create":{let{model:e,options:a}=n;e1(e,a).then(e=>{postMessage({type:r,out:e})},e=>{postMessage({type:r,err:e})});break}case"release":e2(n),postMessage({type:r});break;case"run":{let{sessionId:e,inputIndices:a,inputs:o,outputIndices:i,options:s}=n;e6(e,a,o,i,Array(i.length).fill(null),s).then(e=>{e.some(e=>"cpu"!==e[3])?postMessage({type:r,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:r,out:e},e8([...o,...e]))},e=>{postMessage({type:r,err:e})});break}case"end-profiling":e4(n),postMessage({type:r})}}catch(e){postMessage({type:r,err:e})}}),ep=ec?null:e=>new Worker(e??eb,{type:"module",name:"ort-wasm-proxy-worker"})}),eh={};G(eh,{default:()=>ey});var em,ey,eg,ew,eb,ev,eE,eT,eO,eA,eC,e_,eR,eU,ex,eI,eL,eM,eP,eS,e$,ek,eB,eN,eD,eF,eG,eW,ej,eV,eH,ez,eq,eY,eZ,eQ,eX,eJ,eK,e0,e1,e2,e3,e6,e4,e8,e5,e9,e7,te,tt,tr,tn,ta,to,ti,ts,tu,tl,tf,tc,tp,td,th,tm,ty,tg,tw=F(()=>{"use strict";ey=em=async function(e={}){var r,n,a=new Promise((e,a)=>{r=e,n=a}),o="object"==typeof window,i="u">typeof WorkerGlobalScope,s=i&&self.name?.startsWith("em-pthread");e.mountExternalData=(r,n)=>{r.startsWith("./")&&(r=r.substring(2)),(e.Sa||(e.Sa=new Map)).set(r,n)},e.unmountExternalData=()=>{delete e.Sa};var u,l,f=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,kb:!0}).buffer.constructor,c=(e,r)=>{throw r},p=import.meta.url,d="";if(o||i){try{d=new URL(".",p).href}catch{}i&&(l=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),u=async e=>{if(M(e))return new Promise((r,n)=>{var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{200==a.status||0==a.status&&a.response?r(a.response):n(a.status)},a.onerror=n,a.send(null)});var r=await fetch(e,{credentials:"same-origin"});if(r.ok)return r.arrayBuffer();throw Error(r.status+" : "+r.url)}}var h,m,y,g,w,b,v,E,T,O,A,C,_,R=console.log.bind(console),U=console.error.bind(console),x=R,I=U,L=!1,M=e=>e.startsWith("file://");function P(){return m.buffer!=w.buffer&&G(),w}function S(){return m.buffer!=w.buffer&&G(),b}function $(){return m.buffer!=w.buffer&&G(),v}function k(){return m.buffer!=w.buffer&&G(),E}function B(){return m.buffer!=w.buffer&&G(),T}function N(){return m.buffer!=w.buffer&&G(),O}function D(){return m.buffer!=w.buffer&&G(),C}if(s){let r=function(n){try{var a=n.data,o=a.Ra;if("load"===o){let n=[];for(let o of(self.onmessage=e=>n.push(e),self.startWorker=()=>{for(let e of(postMessage({Ra:"loaded"}),n))r(e);self.onmessage=r},a.Za))e[o]&&!e[o].proxy||(e[o]=(...e)=>{postMessage({Ra:"callHandler",Ya:o,args:e})},"print"==o&&(x=e[o]),"printErr"==o&&(I=e[o]));m=a.fb,G(),_(a.gb)}else if("run"===o){ed(a.Qa),tU(a.Qa,0,0,1,0,0),el(),eD(a.Qa),F||=!0;try{em(a.bb,a.Va)}catch(e){if("unwind"!=e)throw e}}else"setimmediate"!==a.target&&("checkMailbox"===o?F&&eF():o&&(I(`worker: received unknown command ${o}`),I(a)))}catch(e){throw tx(),e}};var F=!1;self.onunhandledrejection=e=>{throw e.reason||e},self.onmessage=r}function G(){var r=m.buffer;e.HEAP8=w=new Int8Array(r),v=new Int16Array(r),e.HEAPU8=b=new Uint8Array(r),new Uint16Array(r),e.HEAP32=E=new Int32Array(r),e.HEAPU32=T=new Uint32Array(r),O=new Float32Array(r),C=new Float64Array(r),A=new BigInt64Array(r),new BigUint64Array(r)}function W(){s?startWorker(e):t_.$()}var j,V=0,H=null;function z(){if(0==--V&&H){var e=H;H=null,e()}}function q(e){throw I(e="Aborted("+e+")"),L=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),n(e),e}function Y(){return{a:{j:tC,b:eg,E:eb,f:eO,U:eA,A:eC,C:e_,V:eR,S:eU,L:ex,R:eI,n:eL,B:eM,y:eP,T:eS,z:e$,_:ek,O:eB,w:eG,F:ej,t:eV,i:eH,N:eD,X:ez,I:eq,J:eX,K:eJ,G:eK,H:e0,u:e3,q:e4,Z:e5,o:e7,k:te,Y:e8,d:tt,W:tr,x:tn,c:e2,e:ta,h:to,v:ti,s:tf,r:tc,P:tm,Q:tg,D:en,g:tw,m:tb,M:tv,l:tT,a:m,p:et}}}class Z{name="ExitStatus";constructor(e){this.message=`Program terminated with exit(${e})`,this.status=e}}var Q=e=>{e.terminate(),e.onmessage=()=>{}},X=[],J=e=>{0==ea.length&&(ec(),ef(ea[0]));var r=ea.pop();if(!r)return 6;eo.push(r),es[e.Qa]=r,r.Qa=e.Qa;var n={Ra:"run",bb:e.ab,Va:e.Va,Qa:e.Qa};return r.postMessage(n,e.Xa),0},K=0,ee=(e,r,...n)=>{for(var a=2*n.length,o=tN(),i=tB(8*a),s=i>>>3,u=0;u<n.length;u++){var l=n[u];"bigint"==typeof l?(A[s+2*u]=1n,A[s+2*u+1]=l):(A[s+2*u]=0n,D()[s+2*u+1>>>0]=l)}return e=tI(e,0,a,i,r),tk(o),e};function et(e){if(s)return ee(0,1,e);if(g=e,!(0<K)){for(var r of eo)Q(r);for(r of ea)Q(r);ea=[],eo=[],es={},L=!0}c(0,new Z(e))}function er(e){if(s)return ee(1,0,e);en(e)}var en=e=>{if(g=e,s)throw er(e),"unwind";et(e)},ea=[],eo=[],ei=[],es={},eu=e=>{var r=e.Qa;delete es[r],ea.push(e),eo.splice(eo.indexOf(e),1),e.Qa=0,tL(r)};function el(){ei.forEach(e=>e())}var ef=r=>new Promise(n=>{r.onmessage=a=>{var o=(a=a.data).Ra;if(a.Ta&&a.Ta!=tR()){var i=es[a.Ta];i?i.postMessage(a,a.Xa):I(`Internal error! Worker sent a message "${o}" to target pthread ${a.Ta}, but that thread no longer exists!`)}else"checkMailbox"===o?eF():"spawnThread"===o?J(a):"cleanupThread"===o?eu(es[a.cb]):"loaded"===o?(r.loaded=!0,n(r)):"setimmediate"===a.target?r.postMessage(a):"callHandler"===o?e[a.Ya](...a.args):o&&I(`worker sent an unknown command ${o}`)},r.onerror=e=>{throw I(`worker sent an error! ${e.filename}:${e.lineno}: ${e.message}`),e};var a,o=[];for(a of[])e.propertyIsEnumerable(a)&&o.push(a);r.postMessage({Ra:"load",Za:o,fb:m,gb:y})});function ec(){let e;var r=new Worker((e=URL,import.meta.url>"file:"&&import.meta.url<"file;"?new e("ort.wasm.bundle.min.mjs",import.meta.url):new URL(import.meta.url)),{type:"module",workerData:"em-pthread",name:"em-pthread"});ea.push(r)}var ep,ed=e=>{G();var r=B()[e+52>>>2>>>0];e=B()[e+56>>>2>>>0],t$(r,r-e),tk(r)},eh=[],em=(e,r)=>{K=0;var n=eh[e];n||(eh[e]=n=ep.get(e)),e=n(r),0<K?g=e:tM(e)};class ey{constructor(e){this.Ua=e-24}}function eg(e,r,n){var a=new ey(e>>>=0);throw r>>>=0,n>>>=0,B()[a.Ua+16>>>2>>>0]=0,B()[a.Ua+4>>>2>>>0]=r,B()[a.Ua+8>>>2>>>0]=n,e}function ew(e,r,n,a){return s?ee(2,1,e,r,n,a):eb(e,r,n,a)}function eb(e,r,n,a){if(e>>>=0,n>>>=0,a>>>=0,void 0===f)return 6;var o=[];return s&&0===o.length?ew(e,r>>>=0,n,a):(e={ab:n,Qa:e,Va:a,Xa:o},s?(e.Ra="spawnThread",postMessage(e,o),0):J(e))}var ev="u">typeof TextDecoder?new TextDecoder:void 0,eE=(e,r=0,n=NaN)=>{var a=(r>>>=0)+n;for(n=r;e[n]&&!(n>=a);)++n;if(16<n-r&&e.buffer&&ev)return ev.decode(e.buffer instanceof ArrayBuffer?e.subarray(r,n):e.slice(r,n));for(a="";r<n;){var o=e[r++];if(128&o){var i=63&e[r++];if((224&o)==192)a+=String.fromCharCode((31&o)<<6|i);else{var s=63&e[r++];65536>(o=(240&o)==224?(15&o)<<12|i<<6|s:(7&o)<<18|i<<12|s<<6|63&e[r++])?a+=String.fromCharCode(o):(o-=65536,a+=String.fromCharCode(55296|o>>10,56320|1023&o))}}else a+=String.fromCharCode(o)}return a},eT=(e,r)=>(e>>>=0)?eE(S(),e,r):"";function eO(e,r,n){return s?ee(3,1,e,r,n):0}function eA(e,r){if(s)return ee(4,1,e,r)}function eC(e,r){if(s)return ee(5,1,e,r)}function e_(e,r,n){if(s)return ee(6,1,e,r,n)}function eR(e,r,n){return s?ee(7,1,e,r,n):0}function eU(e,r){if(s)return ee(8,1,e,r)}function ex(e,r,n){if(s)return ee(9,1,e,r,n)}function eI(e,r,n,a){if(s)return ee(10,1,e,r,n,a)}function eL(e,r,n,a){if(s)return ee(11,1,e,r,n,a)}function eM(e,r,n,a){if(s)return ee(12,1,e,r,n,a)}function eP(e){if(s)return ee(13,1,e)}function eS(e,r){if(s)return ee(14,1,e,r)}function e$(e,r,n){if(s)return ee(15,1,e,r,n)}var ek=()=>q("");function eB(e){tU(e>>>0,!i,1,!o,131072,!1),el()}var eN=e=>{if(!L)try{if(e(),!(0<K))try{s?tM(g):en(g)}catch(e){e instanceof Z||"unwind"==e||c(0,e)}}catch(e){e instanceof Z||"unwind"==e||c(0,e)}};function eD(e){e>>>=0,"function"==typeof Atomics.eb&&(Atomics.eb(k(),e>>>2,e).value.then(eF),e+=128,Atomics.store(k(),e>>>2,1))}var eF=()=>{var e=tR();e&&(eD(e),eN(tS))};function eG(e,r){(e>>>=0)==r>>>0?setTimeout(eF):s?postMessage({Ta:e,Ra:"checkMailbox"}):(e=es[e])&&e.postMessage({Ra:"checkMailbox"})}var eW=[];function ej(e,r,n,a,o){for(r>>>=0,eW.length=a/=2,n=o>>>0>>>3,o=0;o<a;o++)eW[o]=A[n+2*o]?A[n+2*o+1]:D()[n+2*o+1>>>0];return(r?tA[r]:tO[e])(...eW)}var eV=()=>{K=0};function eH(e){e>>>=0,s?postMessage({Ra:"cleanupThread",cb:e}):eu(es[e])}function ez(e){}function eq(e,r){e=-0x20000000000000>e||0x20000000000000<e?NaN:Number(e),r>>>=0,e=new Date(1e3*e),k()[r>>>2>>>0]=e.getUTCSeconds(),k()[r+4>>>2>>>0]=e.getUTCMinutes(),k()[r+8>>>2>>>0]=e.getUTCHours(),k()[r+12>>>2>>>0]=e.getUTCDate(),k()[r+16>>>2>>>0]=e.getUTCMonth(),k()[r+20>>>2>>>0]=e.getUTCFullYear()-1900,k()[r+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,k()[r+28>>>2>>>0]=e}var eY=e=>e%4==0&&(e%100!=0||e%400==0),eZ=[0,31,60,91,121,152,182,213,244,274,305,335],eQ=[0,31,59,90,120,151,181,212,243,273,304,334];function eX(e,r){e=-0x20000000000000>e||0x20000000000000<e?NaN:Number(e),r>>>=0,e=new Date(1e3*e),k()[r>>>2>>>0]=e.getSeconds(),k()[r+4>>>2>>>0]=e.getMinutes(),k()[r+8>>>2>>>0]=e.getHours(),k()[r+12>>>2>>>0]=e.getDate(),k()[r+16>>>2>>>0]=e.getMonth(),k()[r+20>>>2>>>0]=e.getFullYear()-1900,k()[r+24>>>2>>>0]=e.getDay();var n=(eY(e.getFullYear())?eZ:eQ)[e.getMonth()]+e.getDate()-1|0;k()[r+28>>>2>>>0]=n,k()[r+36>>>2>>>0]=-60*e.getTimezoneOffset(),n=new Date(e.getFullYear(),6,1).getTimezoneOffset();var a=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=0|(n!=a&&e.getTimezoneOffset()==Math.min(a,n)),k()[r+32>>>2>>>0]=e}function eJ(e){e>>>=0;var r=new Date(k()[e+20>>>2>>>0]+1900,k()[e+16>>>2>>>0],k()[e+12>>>2>>>0],k()[e+8>>>2>>>0],k()[e+4>>>2>>>0],k()[e>>>2>>>0],0),n=k()[e+32>>>2>>>0],a=r.getTimezoneOffset(),o=new Date(r.getFullYear(),6,1).getTimezoneOffset(),i=new Date(r.getFullYear(),0,1).getTimezoneOffset(),s=Math.min(i,o);return 0>n?k()[e+32>>>2>>>0]=+(o!=i&&s==a):0<n!=(s==a)&&(o=Math.max(i,o),r.setTime(r.getTime()+6e4*((0<n?s:o)-a))),k()[e+24>>>2>>>0]=r.getDay(),n=(eY(r.getFullYear())?eZ:eQ)[r.getMonth()]+r.getDate()-1|0,k()[e+28>>>2>>>0]=n,k()[e>>>2>>>0]=r.getSeconds(),k()[e+4>>>2>>>0]=r.getMinutes(),k()[e+8>>>2>>>0]=r.getHours(),k()[e+12>>>2>>>0]=r.getDate(),k()[e+16>>>2>>>0]=r.getMonth(),k()[e+20>>>2>>>0]=r.getYear(),BigInt(isNaN(e=r.getTime())?-1:e/1e3)}function eK(e,r,n,a,o,i,u){return s?ee(16,1,e,r,n,a,o,i,u):-52}function e0(e,r,n,a,o,i){if(s)return ee(17,1,e,r,n,a,o,i)}var e1={},e2=()=>performance.timeOrigin+performance.now();function e3(e,r){if(s)return ee(18,1,e,r);if(e1[e]&&(clearTimeout(e1[e].id),delete e1[e]),!r)return 0;var n=setTimeout(()=>{delete e1[e],eN(()=>tP(e,performance.timeOrigin+performance.now()))},r);return e1[e]={id:n,lb:r},0}var e6=(e,r,n)=>{var a=S();if(r>>>=0,0<n){var o=r;n=r+n-1;for(var i=0;i<e.length;++i){var s=e.charCodeAt(i);if(55296<=s&&57343>=s&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++i)),127>=s){if(r>=n)break;a[r++>>>0]=s}else{if(2047>=s){if(r+1>=n)break;a[r++>>>0]=192|s>>6}else{if(65535>=s){if(r+2>=n)break;a[r++>>>0]=224|s>>12}else{if(r+3>=n)break;a[r++>>>0]=240|s>>18,a[r++>>>0]=128|s>>12&63}a[r++>>>0]=128|s>>6&63}a[r++>>>0]=128|63&s}}a[r>>>0]=0,e=r-o}else e=0;return e};function e4(e,r,n,a){e>>>=0,r>>>=0,n>>>=0,a>>>=0;var o=new Date().getFullYear(),i=new Date(o,0,1).getTimezoneOffset(),s=Math.max(i,o=new Date(o,6,1).getTimezoneOffset());B()[e>>>2>>>0]=60*s,k()[r>>>2>>>0]=+(i!=o),e=(r=e=>{var r=Math.abs(e);return`UTC${0<=e?"-":"+"}${String(Math.floor(r/60)).padStart(2,"0")}${String(r%60).padStart(2,"0")}`})(i),r=r(o),o<i?(e6(e,n,17),e6(r,a,17)):(e6(e,a,17),e6(r,n,17))}var e8=()=>Date.now();function e5(e,r,n){return 0<=e&&3>=e?(e=0===e?Date.now():performance.timeOrigin+performance.now(),A[n>>>0>>>3]=BigInt(Math.round(1e6*e)),0):28}var e9=[];function e7(e,r,n){e>>>=0,r>>>=0,n>>>=0,e9.length=0;for(var a;a=S()[r++>>>0];){var o=105!=a;n+=(o&=112!=a)&&n%8?4:0,e9.push(112==a?B()[n>>>2>>>0]:106==a?A[n>>>3]:105==a?k()[n>>>2>>>0]:D()[n>>>3>>>0]),n+=o?8:4}return tA[e](...e9)}var te=()=>{};function tt(e,r){return I(eT(e>>>0,r>>>0))}var tr=()=>{throw K+=1,"unwind"};function tn(){return 0xffff0000}var ta=()=>navigator.hardwareConcurrency;function to(){return q("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function ti(e){e>>>=0;var r=S().length;if(e<=r||0xffff0000<e)return!1;for(var n=1;4>=n;n*=2){var a=r*(1+.2/n);a=Math.min(a,e+0x6000000);e:{a=(Math.min(0xffff0000,65536*Math.ceil(Math.max(e,a)/65536))-m.buffer.byteLength+65535)/65536|0;try{m.grow(a),G();var o=1;break e}catch{}o=void 0}if(o)return!0}return!1}var ts=()=>(q("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),tu={},tl=e=>{e.forEach(e=>{var r=ts();r&&(tu[r]=e)})};function tf(){var e=Error().stack.toString().split(`
`);return"Error"==e[0]&&e.shift(),tl(e),tu.Wa=ts(),tu.$a=e,tu.Wa}function tc(e,r,n){if(e>>>=0,r>>>=0,tu.Wa==e)var a=tu.$a;else"Error"==(a=Error().stack.toString().split(`
`))[0]&&a.shift(),tl(a);for(var o=3;a[o]&&ts()!=e;)++o;for(e=0;e<n&&a[e+o];++e)k()[r+4*e>>>2>>>0]=ts();return e}var tp,td={},th=()=>{if(!tp){var e,r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:"./this.program"};for(e in td)void 0===td[e]?delete r[e]:r[e]=td[e];var n=[];for(e in r)n.push(`${e}=${r[e]}`);tp=n}return tp};function tm(e,r){if(s)return ee(19,1,e,r);e>>>=0,r>>>=0;var n,a=0,o=0;for(n of th()){var i=r+a;B()[e+o>>>2>>>0]=i,a+=e6(n,i,1/0)+1,o+=4}return 0}var ty=e=>{for(var r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);127>=a?r++:2047>=a?r+=2:55296<=a&&57343>=a?(r+=4,++n):r+=3}return r};function tg(e,r){if(s)return ee(20,1,e,r);e>>>=0,r>>>=0;var n=th();for(var a of(B()[e>>>2>>>0]=n.length,e=0,n))e+=ty(a)+1;return B()[r>>>2>>>0]=e,0}function tw(e){return s?ee(21,1,e):52}function tb(e,r,n,a){return s?ee(22,1,e,r,n,a):52}function tv(e,r,n,a){return s?ee(23,1,e,r,n,a):70}var tE=[null,[],[]];function tT(e,r,n,a){if(s)return ee(24,1,e,r,n,a);r>>>=0,n>>>=0,a>>>=0;for(var o=0,i=0;i<n;i++){var u=B()[r>>>2>>>0],l=B()[r+4>>>2>>>0];r+=8;for(var f=0;f<l;f++){var c=S()[u+f>>>0],p=tE[e];0===c||10===c?((1===e?x:I)(eE(p)),p.length=0):p.push(c)}o+=l}return B()[a>>>2>>>0]=o,0}s||function(){for(var r=e.numThreads-1;r--;)ec();X.push(()=>{var e;V++,e=()=>z(),s?e():Promise.all(ea.map(ef)).then(e)})}(),s||(m=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0}),G()),e.wasmBinary&&(h=e.wasmBinary),e.stackSave=()=>tN(),e.stackRestore=e=>tk(e),e.stackAlloc=e=>tB(e),e.setValue=function(e,r,n="i8"){switch(n.endsWith("*")&&(n="*"),n){case"i1":case"i8":P()[e>>>0]=r;break;case"i16":$()[e>>>1>>>0]=r;break;case"i32":k()[e>>>2>>>0]=r;break;case"i64":A[e>>>3]=BigInt(r);break;case"float":N()[e>>>2>>>0]=r;break;case"double":D()[e>>>3>>>0]=r;break;case"*":B()[e>>>2>>>0]=r;break;default:q(`invalid type for setValue: ${n}`)}},e.getValue=function(e,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":case"i8":return P()[e>>>0];case"i16":return $()[e>>>1>>>0];case"i32":return k()[e>>>2>>>0];case"i64":return A[e>>>3];case"float":return N()[e>>>2>>>0];case"double":return D()[e>>>3>>>0];case"*":return B()[e>>>2>>>0];default:q(`invalid type for getValue: ${r}`)}},e.UTF8ToString=eT,e.stringToUTF8=e6,e.lengthBytesUTF8=ty;var tO=[et,er,ew,eO,eA,eC,e_,eR,eU,ex,eI,eL,eM,eP,eS,e$,eK,e0,e3,tm,tg,tw,tb,tv,tT],tA={853836:(r,n,a,o,i)=>{if(void 0===e||!e.Sa)return 1;if((r=eT(Number(r>>>0))).startsWith("./")&&(r=r.substring(2)),!(r=e.Sa.get(r)))return 2;if(n=Number(n>>>0),a=Number(a>>>0),o=Number(o>>>0),n+a>r.byteLength)return 3;try{let s=r.subarray(n,n+a);switch(i){case 0:S().set(s,o>>>0);break;case 1:e.hb?e.hb(o,s):e.jb(o,s);break;default:return 4}return 0}catch{return 4}},854660:()=>"u">typeof wasmOffsetConverter};function tC(){return"u">typeof wasmOffsetConverter}var t_=await async function(){function r(e,r){var n,a,o;return n=t_=e.exports,a=e=>()=>e()>>>0,o=e=>r=>e(r)>>>0,(n=Object.assign({},n)).Aa=a(n.Aa),n.Ca=o(n.Ca),n.Oa=o(n.Oa),n.Pa=a(n.Pa),n.__cxa_get_exception_ptr=o(n.__cxa_get_exception_ptr),t_=n,ei.push(t_.Da),ep=t_.Ea,y=r,z(),t_}V++;var a=Y();if(e.instantiateWasm)return new Promise(n=>{e.instantiateWasm(a,(e,a)=>{n(r(e,a))})});if(s)return new Promise(e=>{_=n=>{e(r(new WebAssembly.Instance(n,Y()),n))}});j??=e.locateFile?e.locateFile?e.locateFile("ort-wasm-simd-threaded.wasm",d):d+"ort-wasm-simd-threaded.wasm":new URL("ort-wasm-simd-threaded.wasm",import.meta.url).href;try{var o=await async function(e){if(!h&&"function"==typeof WebAssembly.instantiateStreaming&&!M(j))try{var r=fetch(j,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(r,e)}catch(e){I(`wasm streaming compile failed: ${e}`),I("falling back to ArrayBuffer instantiation")}return async function(e,r){try{var n=await async function(e){if(!h)try{var r=await u(e);return new Uint8Array(r)}catch{}if(e==j&&h)e=new Uint8Array(h);else{if(!l)throw"both async and sync fetching of the wasm failed";e=l(e)}return e}(e);return await WebAssembly.instantiate(n,r)}catch(e){I(`failed to asynchronously prepare wasm: ${e}`),q(e)}}(j,e)}(a);return r(o.instance,o.module)}catch(e){return n(e),Promise.reject(e)}}();e._OrtInit=(r,n)=>(e._OrtInit=t_.aa)(r,n),e._OrtGetLastError=(r,n)=>(e._OrtGetLastError=t_.ba)(r,n),e._OrtCreateSessionOptions=(r,n,a,o,i,s,u,l,f,c)=>(e._OrtCreateSessionOptions=t_.ca)(r,n,a,o,i,s,u,l,f,c),e._OrtAppendExecutionProvider=(r,n,a,o,i)=>(e._OrtAppendExecutionProvider=t_.da)(r,n,a,o,i),e._OrtAddFreeDimensionOverride=(r,n,a)=>(e._OrtAddFreeDimensionOverride=t_.ea)(r,n,a),e._OrtAddSessionConfigEntry=(r,n,a)=>(e._OrtAddSessionConfigEntry=t_.fa)(r,n,a),e._OrtReleaseSessionOptions=r=>(e._OrtReleaseSessionOptions=t_.ga)(r),e._OrtCreateSession=(r,n,a)=>(e._OrtCreateSession=t_.ha)(r,n,a),e._OrtReleaseSession=r=>(e._OrtReleaseSession=t_.ia)(r),e._OrtGetInputOutputCount=(r,n,a)=>(e._OrtGetInputOutputCount=t_.ja)(r,n,a),e._OrtGetInputOutputMetadata=(r,n,a,o)=>(e._OrtGetInputOutputMetadata=t_.ka)(r,n,a,o),e._OrtFree=r=>(e._OrtFree=t_.la)(r),e._OrtCreateTensor=(r,n,a,o,i,s)=>(e._OrtCreateTensor=t_.ma)(r,n,a,o,i,s),e._OrtGetTensorData=(r,n,a,o,i)=>(e._OrtGetTensorData=t_.na)(r,n,a,o,i),e._OrtReleaseTensor=r=>(e._OrtReleaseTensor=t_.oa)(r),e._OrtCreateRunOptions=(r,n,a,o)=>(e._OrtCreateRunOptions=t_.pa)(r,n,a,o),e._OrtAddRunConfigEntry=(r,n,a)=>(e._OrtAddRunConfigEntry=t_.qa)(r,n,a),e._OrtReleaseRunOptions=r=>(e._OrtReleaseRunOptions=t_.ra)(r),e._OrtCreateBinding=r=>(e._OrtCreateBinding=t_.sa)(r),e._OrtBindInput=(r,n,a)=>(e._OrtBindInput=t_.ta)(r,n,a),e._OrtBindOutput=(r,n,a,o)=>(e._OrtBindOutput=t_.ua)(r,n,a,o),e._OrtClearBoundOutputs=r=>(e._OrtClearBoundOutputs=t_.va)(r),e._OrtReleaseBinding=r=>(e._OrtReleaseBinding=t_.wa)(r),e._OrtRunWithBinding=(r,n,a,o,i)=>(e._OrtRunWithBinding=t_.xa)(r,n,a,o,i),e._OrtRun=(r,n,a,o,i,s,u,l)=>(e._OrtRun=t_.ya)(r,n,a,o,i,s,u,l),e._OrtEndProfiling=r=>(e._OrtEndProfiling=t_.za)(r);var tR=()=>(tR=t_.Aa)();e._free=r=>(e._free=t_.Ba)(r),e._malloc=r=>(e._malloc=t_.Ca)(r);var tU=(e,r,n,a,o,i)=>(tU=t_.Fa)(e,r,n,a,o,i),tx=()=>(tx=t_.Ga)(),tI=(e,r,n,a,o)=>(tI=t_.Ha)(e,r,n,a,o),tL=e=>(tL=t_.Ia)(e),tM=e=>(tM=t_.Ja)(e),tP=(e,r)=>(tP=t_.Ka)(e,r),tS=()=>(tS=t_.La)(),t$=(e,r)=>(t$=t_.Ma)(e,r),tk=e=>(tk=t_.Na)(e),tB=e=>(tB=t_.Oa)(e),tN=()=>(tN=t_.Pa)();return function n(){if(0<V)H=n;else if(s)r(e),W();else{for(;0<X.length;)X.shift()(e);0<V?H=n:(e.calledRun=!0,L||(W(),r(e)))}}(),e.PTR_SIZE=4,a},globalThis.self?.name?.startsWith("em-pthread")&&em()}),tb=F(()=>{"use strict";el(),eg=typeof location>"u"?void 0:location.origin,ew=import.meta.url>"file:"&&import.meta.url<"file;",eb=(()=>{if(ew){let e=URL;return new URL(new e("ort.wasm.bundle.min.mjs",import.meta.url).href,eg).href}return import.meta.url})(),ev=()=>{if(eb&&!eb.startsWith("blob:"))return eb.substring(0,eb.lastIndexOf("/")+1)},eE=(e,r)=>{try{let n=r??eb;return(n?new URL(e,n):new URL(e)).origin===eg}catch{return!1}},eT=async e=>{let r=await (await fetch(e,{credentials:"same-origin"})).blob();return URL.createObjectURL(r)},eO=async e=>(await import(e)).default,eA=(ed(),W(ef)).default,eC=async()=>{if(!eb)throw Error("Failed to load proxy worker: cannot determine the script source URL.");if(eE(eb))return[void 0,eA()];let e=await eT(eb);return[e,eA(e)]},e_=(tw(),W(eh)).default,eR=async(e,r,n,a)=>{let o=e_&&!(e||r);if(o)if(eb)o=eE(eb);else if(a&&!n)o=!0;else throw Error("cannot determine the script source URL.");if(o)return[void 0,e_];{let a,o,i="ort-wasm-simd-threaded.mjs",s=e??((e,r)=>{let n=r??eb;try{return(n?new URL(e,n):new URL(e)).href}catch{return}})(i,r),u=n&&s&&!eE(s,r),l=u?await eT(s):s??(a=i,o=r,`${o??"./"}${a}`);return[u?l:void 0,await eO(l)]}}}),tv=F(()=>{"use strict";tb(),ex=!1,eI=!1,eL=!1,eM=async e=>{if(ex)return Promise.resolve();if(eI)throw Error("multiple calls to 'initializeWebAssembly()' detected.");if(eL)throw Error("previous call to 'initializeWebAssembly()' failed.");eI=!0;let r=e.initTimeout,n=e.numThreads;if(!1!==e.simd){if("relaxed"===e.simd){if(!(()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,19,1,17,0,65,1,253,15,65,2,253,15,65,3,253,15,253,147,2,11]))}catch{return!1}})())throw Error("Relaxed WebAssembly SIMD is not supported in the current environment.")}else if(!(()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}})())throw Error("WebAssembly SIMD is not supported in the current environment.")}let a=(()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return"u">typeof MessageChannel&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}})();n>1&&!a&&("u">typeof self&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+n+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),e.numThreads=n=1);let o=e.wasmPaths,i="string"==typeof o?o:void 0,s=o?.mjs,u=s?.href??s,l=o?.wasm,f=l?.href??l,c=e.wasmBinary,[p,d]=await eR(u,i,n>1,!!c||!!f),h=!1,m=[];if(r>0&&m.push(new Promise(e=>{setTimeout(()=>{h=!0,e()},r)})),m.push(new Promise((e,r)=>{let a={numThreads:n};if(c)a.wasmBinary=c;else if(f||i)a.locateFile=e=>f??i+e;else if(u&&0!==u.indexOf("blob:"))a.locateFile=e=>new URL(e,u).href;else if(p){let e=ev();e&&(a.locateFile=r=>e+r)}d(a).then(r=>{eI=!1,ex=!0,eU=r,e(),p&&URL.revokeObjectURL(p)},e=>{eI=!1,eL=!0,r(e)})})),await Promise.race(m),h)throw Error(`WebAssembly backend initializing failed due to timeout: ${r}ms`)},eP=()=>{if(ex&&eU)return eU;throw Error("WebAssembly is not initialized yet.")}}),tE=F(()=>{"use strict";tv(),eS=(e,r)=>{let n=eP(),a=n.lengthBytesUTF8(e)+1,o=n._malloc(a);return n.stringToUTF8(e,o,a),r.push(o),o},e$=(e,r,n,a)=>{if("object"==typeof e&&null!==e){if(n.has(e))throw Error("Circular reference in options");n.add(e)}Object.entries(e).forEach(([e,o])=>{let i=r?r+e:e;if("object"==typeof o)e$(o,i+".",n,a);else if("string"==typeof o||"number"==typeof o)a(i,o.toString());else if("boolean"==typeof o)a(i,o?"1":"0");else throw Error(`Can't handle extra config type: ${typeof o}`)})},ek=e=>{let r=eP(),n=r.stackSave();try{let n=r.PTR_SIZE,a=r.stackAlloc(2*n);r._OrtGetLastError(a,a+n);let o=Number(r.getValue(a,4===n?"i32":"i64")),i=r.getValue(a+n,"*"),s=i?r.UTF8ToString(i):"";throw Error(`${e} ERROR_CODE: ${o}, ERROR_MESSAGE: ${s}`)}finally{r.stackRestore(n)}}}),tT=F(()=>{"use strict";tv(),tE(),eB=e=>{let r=eP(),n=0,a=[],o=e||{};try{if(e?.logSeverityLevel===void 0)o.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw Error(`log severity level is not valid: ${e.logSeverityLevel}`);if(e?.logVerbosityLevel===void 0)o.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);e?.terminate===void 0&&(o.terminate=!1);let i=0;return e?.tag!==void 0&&(i=eS(e.tag,a)),n=r._OrtCreateRunOptions(o.logSeverityLevel,o.logVerbosityLevel,!!o.terminate,i),0===n&&ek("Can't create run options."),e?.extra!==void 0&&e$(e.extra,"",new WeakSet,(e,o)=>{let i=eS(e,a),s=eS(o,a);0!==r._OrtAddRunConfigEntry(n,i,s)&&ek(`Can't set a run config entry: ${e} - ${o}.`)}),[n,a]}catch(e){throw 0!==n&&r._OrtReleaseRunOptions(n),a.forEach(e=>r._free(e)),e}}}),tO=F(()=>{"use strict";tv(),tE(),eN=(e,r,n,a)=>{let o=eS(r,a),i=eS(n,a);0!==eP()._OrtAddSessionConfigEntry(e,o,i)&&ek(`Can't set a session config entry: ${r} - ${n}.`)},eD=async(e,r,n)=>{for(let a of r){let r="string"==typeof a?a:a.name,o=[];switch(r){case"webnn":if(r="WEBNN","string"!=typeof a){let r=a?.deviceType;r&&eN(e,"deviceType",r,n)}break;case"webgpu":if(r="JS","string"!=typeof a&&a?.preferredLayout){if("NCHW"!==a.preferredLayout&&"NHWC"!==a.preferredLayout)throw Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${a.preferredLayout}`);eN(e,"preferredLayout",a.preferredLayout,n)}break;case"wasm":case"cpu":continue;default:throw Error(`not supported execution provider: ${r}`)}let i=eS(r,n),s=o.length,u=0,l=0;if(s>0){u=eP()._malloc(s*eP().PTR_SIZE),n.push(u),l=eP()._malloc(s*eP().PTR_SIZE),n.push(l);for(let e=0;e<s;e++)eP().setValue(u+e*eP().PTR_SIZE,o[e][0],"*"),eP().setValue(l+e*eP().PTR_SIZE,o[e][1],"*")}await eP()._OrtAppendExecutionProvider(e,i,u,l,s)!==0&&ek(`Can't append execution provider: ${r}.`)}},eF=async e=>{var r;let n,a=eP(),o=0,i=[],s=e||{};(r=s).extra||(r.extra={}),r.extra.session||(r.extra.session={}),(n=r.extra.session).use_ort_model_bytes_directly||(n.use_ort_model_bytes_directly="1"),r.executionProviders&&r.executionProviders.some(e=>("string"==typeof e?e:e.name)==="webgpu")&&(r.enableMemPattern=!1);try{let e=(e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"layout":return 3;case"all":return 99;default:throw Error(`unsupported graph optimization level: ${e}`)}})(s.graphOptimizationLevel??"all"),r=(e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw Error(`unsupported execution mode: ${e}`)}})(s.executionMode??"sequential"),n="string"==typeof s.logId?eS(s.logId,i):0,u=s.logSeverityLevel??2;if(!Number.isInteger(u)||u<0||u>4)throw Error(`log severity level is not valid: ${u}`);let l=s.logVerbosityLevel??0;if(!Number.isInteger(l)||l<0||l>4)throw Error(`log verbosity level is not valid: ${l}`);let f="string"==typeof s.optimizedModelFilePath?eS(s.optimizedModelFilePath,i):0;if(o=a._OrtCreateSessionOptions(e,!!s.enableCpuMemArena,!!s.enableMemPattern,r,!!s.enableProfiling,0,n,u,l,f),0===o&&ek("Can't create session options."),s.executionProviders&&await eD(o,s.executionProviders,i),void 0!==s.enableGraphCapture){if("boolean"!=typeof s.enableGraphCapture)throw Error(`enableGraphCapture must be a boolean value: ${s.enableGraphCapture}`);eN(o,"enableGraphCapture",s.enableGraphCapture.toString(),i)}if(s.freeDimensionOverrides)for(let[e,r]of Object.entries(s.freeDimensionOverrides)){if("string"!=typeof e)throw Error(`free dimension override name must be a string: ${e}`);if("number"!=typeof r||!Number.isInteger(r)||r<0)throw Error(`free dimension override value must be a non-negative integer: ${r}`);let n=eS(e,i);0!==a._OrtAddFreeDimensionOverride(o,n,r)&&ek(`Can't set a free dimension override: ${e} - ${r}.`)}return void 0!==s.extra&&e$(s.extra,"",new WeakSet,(e,r)=>{eN(o,e,r,i)}),[o,i]}catch(e){throw 0!==o&&0!==a._OrtReleaseSessionOptions(o)&&ek("Can't release session options."),i.forEach(e=>a._free(e)),e}}}),tA=F(()=>{"use strict";eG=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw Error(`unsupported data type: ${e}`)}},eW=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw Error(`unsupported data type: ${e}`)}},ej=(e,r)=>{let n=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][e],a="number"==typeof r?r:r.reduce((e,r)=>e*r,1);return n>0?Math.ceil(a*n):void 0},eV=e=>{switch(e){case"float16":return"u">typeof Float16Array&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw Error(`unsupported type: ${e}`)}},eH=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw Error(`unsupported logging level: ${e}`)}},ez=e=>"float32"===e||"float16"===e||"int32"===e||"int64"===e||"uint32"===e||"uint8"===e||"bool"===e||"uint4"===e||"int4"===e,eq=e=>"float32"===e||"float16"===e||"int32"===e||"int64"===e||"uint32"===e||"uint64"===e||"int8"===e||"uint8"===e||"bool"===e||"uint4"===e||"int4"===e,eY=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw Error(`unsupported data location: ${e}`)}}}),tC=F(()=>{"use strict";el(),eZ=async e=>{if("string"!=typeof e)return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e);{let r=await fetch(e);if(!r.ok)throw Error(`failed to load external data file: ${e}`);let n=r.headers.get("Content-Length"),a=n?parseInt(n,10):0;if(a<0x40000000)return new Uint8Array(await r.arrayBuffer());{if(!r.body)throw Error(`failed to load external data file: ${e}, no response body.`);let n=r.body.getReader(),o;try{o=new ArrayBuffer(a)}catch(e){if(e instanceof RangeError){let e=Math.ceil(a/65536);o=new WebAssembly.Memory({initial:e,maximum:e}).buffer}else throw e}let i=0;for(;;){let{done:e,value:r}=await n.read();if(e)break;let a=r.byteLength;new Uint8Array(o,i,a).set(r),i+=a}return new Uint8Array(o,0,a)}}}}),t_=F(()=>{"use strict";eu(),tT(),tO(),tA(),tv(),tE(),tC(),eQ=async e=>{var r,n;r=e.wasm.numThreads,n=eH(e.logLevel),0!==eP()._OrtInit(r,n)&&ek("Can't initialize onnxruntime.")},eX=async(e,r)=>{eP().asyncInit?.();let n=e.webgpu.adapter;if("webgpu"===r){if(typeof navigator>"u"||!navigator.gpu)throw Error("WebGPU is not supported in current environment");if(n){if("object"!=typeof n.limits||"object"!=typeof n.features||"function"!=typeof n.requestDevice)throw Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let r=e.webgpu.powerPreference;if(void 0!==r&&"low-power"!==r&&"high-performance"!==r)throw Error(`Invalid powerPreference setting: "${r}"`);let a=e.webgpu.forceFallbackAdapter;if(void 0!==a&&"boolean"!=typeof a)throw Error(`Invalid forceFallbackAdapter setting: "${a}"`);if(!(n=await navigator.gpu.requestAdapter({powerPreference:r,forceFallbackAdapter:a})))throw Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}}if("webnn"===r&&(typeof navigator>"u"||!navigator.ml))throw Error("WebNN is not supported in current environment")},eJ=new Map,eK=(e,r)=>{let n=eP(),a=n.stackSave(),o=0;try{let a=n.PTR_SIZE,i=n.stackAlloc(2*a);0!==n._OrtGetInputOutputMetadata(e,r,i,i+a)&&ek("Can't get session input/output metadata.");let s=Number(n.getValue(i,"*"));o=Number(n.getValue(i+a,"*"));let u=n.HEAP32[o/4];if(0===u)return[s,0];let l=n.HEAPU32[o/4+1],f=[];for(let e=0;e<l;e++){let r=Number(n.getValue(o+8+e*a,"*"));f.push(0!==r?n.UTF8ToString(r):Number(n.getValue(o+8+(e+l)*a,"*")))}return[s,u,f]}finally{n.stackRestore(a),0!==o&&n._OrtFree(o)}},e0=e=>{let r=eP(),n=r._malloc(e.byteLength);if(0===n)throw Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return r.HEAPU8.set(e,n),[n,e.byteLength]},e1=async(e,r)=>{let n,a,o=eP();Array.isArray(e)?[n,a]=e:e.buffer===o.HEAPU8.buffer?[n,a]=[e.byteOffset,e.byteLength]:[n,a]=e0(e);let i=0,s=0,u=[],l=[],f=[];try{if([s,u]=await eF(r),r?.externalData&&o.mountExternalData){let e=[];for(let n of r.externalData){let r="string"==typeof n?n:n.path;e.push(eZ("string"==typeof n?n:n.data).then(e=>{o.mountExternalData(r,e)}))}await Promise.all(e)}for(let e of r?.executionProviders??[])if(("string"==typeof e?e:e.name)==="webnn"){if(o.shouldTransferToMLTensor=!1,"string"!=typeof e){let r=e?.context,n=e?.gpuDevice,a=e?.deviceType,i=e?.powerPreference;r?o.currentContext=r:n?o.currentContext=await o.webnnCreateMLContext(n):o.currentContext=await o.webnnCreateMLContext({deviceType:a,powerPreference:i})}else o.currentContext=await o.webnnCreateMLContext();break}i=await o._OrtCreateSession(n,a,s),o.webgpuOnCreateSession?.(i),0===i&&ek("Can't create a session."),o.jsepOnCreateSession?.(),o.currentContext&&(o.webnnRegisterMLContext(i,o.currentContext),o.currentContext=void 0,o.shouldTransferToMLTensor=!0);let[e,c]=(e=>{let r=eP(),n=r.stackSave();try{let n=r.PTR_SIZE,a=r.stackAlloc(2*n);0!==r._OrtGetInputOutputCount(e,a,a+n)&&ek("Can't get session input/output count.");let o=4===n?"i32":"i64";return[Number(r.getValue(a,o)),Number(r.getValue(a+n,o))]}finally{r.stackRestore(n)}})(i),p=!!r?.enableGraphCapture,d=[],h=[],m=[],y=[];for(let r=0;r<e;r++){let[e,n,a]=eK(i,r);0===e&&ek("Can't get an input name."),l.push(e);let s=o.UTF8ToString(e);d.push(s),m.push(0===n?{name:s,isTensor:!1}:{name:s,isTensor:!0,type:eW(n),shape:a})}for(let r=0;r<c;r++){let[n,a,s]=eK(i,r+e);0===n&&ek("Can't get an output name."),f.push(n);let u=o.UTF8ToString(n);h.push(u),y.push(0===a?{name:u,isTensor:!1}:{name:u,isTensor:!0,type:eW(a),shape:s})}return eJ.set(i,[i,l,f,null,p,!1]),[i,d,h,m,y]}catch(e){throw l.forEach(e=>o._OrtFree(e)),f.forEach(e=>o._OrtFree(e)),0!==i&&0!==o._OrtReleaseSession(i)&&ek("Can't release session."),e}finally{o._free(n),0!==s&&0!==o._OrtReleaseSessionOptions(s)&&ek("Can't release session options."),u.forEach(e=>o._free(e)),o.unmountExternalData?.()}},e2=e=>{let r=eP(),n=eJ.get(e);if(!n)throw Error(`cannot release session. invalid session id: ${e}`);let[a,o,i,s,u]=n;s&&(u&&0!==r._OrtClearBoundOutputs(s.handle)&&ek("Can't clear bound outputs."),0!==r._OrtReleaseBinding(s.handle)&&ek("Can't release IO binding.")),r.jsepOnReleaseSession?.(e),r.webnnOnReleaseSession?.(e),r.webgpuOnReleaseSession?.(e),o.forEach(e=>r._OrtFree(e)),i.forEach(e=>r._OrtFree(e)),0!==r._OrtReleaseSession(a)&&ek("Can't release session."),eJ.delete(e)},e3=async(e,r,n,a,o,i,s=!1)=>{if(!e)return void r.push(0);let u=eP(),l=u.PTR_SIZE,f=e[0],c=e[1],p=e[3],d=p,h,m;if("string"===f&&("gpu-buffer"===p||"ml-tensor"===p))throw Error("String tensor is not supported on GPU.");if(s&&"gpu-buffer"!==p)throw Error(`External buffer must be provided for input/output index ${i} when enableGraphCapture is true.`);if("gpu-buffer"===p){let r=e[2].gpuBuffer;m=ej(eG(f),c);{let e=u.jsepRegisterBuffer;if(!e)throw Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');h=e(a,i,r,m)}}else if("ml-tensor"===p){let r=e[2].mlTensor;m=ej(eG(f),c);let n=u.webnnRegisterMLTensor;if(!n)throw Error('Tensor location "ml-tensor" is not supported without using WebNN.');h=n(a,r,eG(f),c)}else{let r=e[2];if(Array.isArray(r)){m=l*r.length,h=u._malloc(m),n.push(h);for(let e=0;e<r.length;e++){if("string"!=typeof r[e])throw TypeError(`tensor data at index ${e} is not a string`);u.setValue(h+e*l,eS(r[e],n),"*")}}else{let e=u.webnnIsGraphInput,i=u.webnnIsGraphOutput;if("string"!==f&&e&&i){let s=u.UTF8ToString(o);if(e(a,s)||i(a,s)){let e=eG(f);m=ej(e,c),d="ml-tensor";let n=u.webnnCreateTemporaryTensor,o=u.webnnUploadTensor;if(!n||!o)throw Error('Tensor location "ml-tensor" is not supported without using WebNN.');let i=await n(a,e,c);o(i,new Uint8Array(r.buffer,r.byteOffset,r.byteLength)),h=i}else m=r.byteLength,h=u._malloc(m),n.push(h),u.HEAPU8.set(new Uint8Array(r.buffer,r.byteOffset,m),h)}else m=r.byteLength,h=u._malloc(m),n.push(h),u.HEAPU8.set(new Uint8Array(r.buffer,r.byteOffset,m),h)}}let y=u.stackSave(),g=u.stackAlloc(4*c.length);try{c.forEach((e,r)=>u.setValue(g+r*l,e,4===l?"i32":"i64"));let e=u._OrtCreateTensor(eG(f),h,m,g,c.length,eY(d));0===e&&ek(`Can't create tensor for input/output. session=${a}, index=${i}.`),r.push(e)}finally{u.stackRestore(y)}},e6=async(e,r,n,a,o,i)=>{let s=eP(),u=s.PTR_SIZE,l=eJ.get(e);if(!l)throw Error(`cannot run inference. invalid session id: ${e}`);let f=l[0],c=l[1],p=l[2],d=l[3],h=l[4],m=(l[5],r.length),y=a.length,g=0,w=[],b=[],v=[],E=[],T=s.stackSave(),O=s.stackAlloc(m*u),A=s.stackAlloc(m*u),C=s.stackAlloc(y*u),_=s.stackAlloc(y*u);try{let l;[g,w]=eB(i),$("wasm prepareInputOutputTensor");for(let a=0;a<m;a++)await e3(n[a],b,E,e,c[r[a]],r[a],h);for(let r=0;r<y;r++)await e3(o[r],v,E,e,p[a[r]],m+a[r],h);k("wasm prepareInputOutputTensor");for(let e=0;e<m;e++)s.setValue(O+e*u,b[e],"*"),s.setValue(A+e*u,c[r[e]],"*");for(let e=0;e<y;e++)s.setValue(C+e*u,v[e],"*"),s.setValue(_+e*u,p[a[e]],"*");s.jsepOnRunStart?.(f),s.webnnOnRunStart?.(f),l=await s._OrtRun(f,A,O,m,_,y,C,g),0!==l&&ek("failed to call OrtRun().");let T=[],R=[];$("wasm ProcessOutputTensor");for(let r=0;r<y;r++){let n=Number(s.getValue(C+r*u,"*"));if(n===v[r]){T.push(o[r]);continue}let i=s.stackSave(),l=s.stackAlloc(4*u),f=!1,c,p=0;try{0!==s._OrtGetTensorData(n,l,l+u,l+2*u,l+3*u)&&ek(`Can't access output tensor data on index ${r}.`);let o=4===u?"i32":"i64",i=Number(s.getValue(l,o));p=s.getValue(l+u,"*");let h=s.getValue(l+2*u,"*"),m=Number(s.getValue(l+3*u,o)),y=[];for(let e=0;e<m;e++)y.push(Number(s.getValue(h+e*u,o)));0!==s._OrtFree(h)&&ek("Can't free memory for tensor dims.");let g=y.reduce((e,r)=>e*r,1);c=eW(i);let w=d?.outputPreferredLocations[a[r]];if("string"===c){if("gpu-buffer"===w||"ml-tensor"===w)throw Error("String tensor is not supported on GPU.");let e=[];for(let r=0;r<g;r++){let n=s.getValue(p+r*u,"*"),a=s.getValue(p+(r+1)*u,"*"),o=r===g-1?void 0:a-n;e.push(s.UTF8ToString(n,o))}T.push([c,y,e,"cpu"])}else if("gpu-buffer"===w&&g>0){let e=s.jsepGetBuffer;if(!e)throw Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let r=e(p),a=ej(i,g);if(void 0===a||!ez(c))throw Error(`Unsupported data type: ${c}`);f=!0,T.push([c,y,{gpuBuffer:r,download:s.jsepCreateDownloader(r,a,c),dispose:()=>{0!==s._OrtReleaseTensor(n)&&ek("Can't release tensor.")}},"gpu-buffer"])}else if("ml-tensor"===w&&g>0){let r=s.webnnEnsureTensor,a=s.webnnIsGraphInputOutputTypeSupported;if(!r||!a)throw Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(void 0===ej(i,g)||!eq(c))throw Error(`Unsupported data type: ${c}`);if(!a(e,c,!1))throw Error(`preferredLocation "ml-tensor" for ${c} output is not supported by current WebNN Context.`);let o=await r(e,p,i,y,!1);f=!0,T.push([c,y,{mlTensor:o,download:s.webnnCreateMLTensorDownloader(p,c),dispose:()=>{s.webnnReleaseTensorId(p),s._OrtReleaseTensor(n)}},"ml-tensor"])}else if("ml-tensor-cpu-output"===w&&g>0){let e=s.webnnCreateMLTensorDownloader(p,c)(),r=T.length;f=!0,R.push((async()=>{let a=[r,await e];return s.webnnReleaseTensorId(p),s._OrtReleaseTensor(n),a})()),T.push([c,y,[],"cpu"])}else{let e=new(eV(c))(g);new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(s.HEAPU8.subarray(p,p+e.byteLength)),T.push([c,y,e,"cpu"])}}finally{s.stackRestore(i),"string"===c&&p&&s._free(p),f||s._OrtReleaseTensor(n)}}for(let[r,n]of(d&&!h&&(0!==s._OrtClearBoundOutputs(d.handle)&&ek("Can't clear bound outputs."),eJ.set(e,[f,c,p,d,h,!1])),await Promise.all(R)))T[r][2]=n;return k("wasm ProcessOutputTensor"),T}finally{s.webnnOnRunEnd?.(f),s.stackRestore(T),b.forEach(e=>s._OrtReleaseTensor(e)),v.forEach(e=>s._OrtReleaseTensor(e)),E.forEach(e=>s._free(e)),0!==g&&s._OrtReleaseRunOptions(g),w.forEach(e=>s._free(e))}},e4=e=>{let r=eP(),n=eJ.get(e);if(!n)throw Error("invalid session id");let a=n[0],o=r._OrtEndProfiling(a);0===o&&ek("Can't get an profile file name."),r._OrtFree(o)},e8=e=>{let r=[];for(let n of e){let e=n[2];!Array.isArray(e)&&"buffer"in e&&r.push(e.buffer)}return r}}),tR=F(()=>{"use strict";eu(),t_(),tv(),tb(),e5=()=>!!h.wasm.proxy&&"u">typeof document,e7=!1,te=!1,tt=!1,ta=new Map,to=(e,r)=>{let n=ta.get(e);n?n.push(r):ta.set(e,[r])},ti=()=>{if(e7||!te||tt||!e9)throw Error("worker not ready")},ts=e=>{switch(e.data.type){case"init-wasm":e7=!1,e.data.err?(tt=!0,tn[1](e.data.err)):(te=!0,tn[0]()),tr&&(URL.revokeObjectURL(tr),tr=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let r=ta.get(e.data.type);e.data.err?r.shift()[1](e.data.err):r.shift()[0](e.data.out)}}},tu=async()=>{if(!te){if(e7)throw Error("multiple calls to 'initWasm()' detected.");if(tt)throw Error("previous call to 'initWasm()' failed.");if(e7=!0,e5())return new Promise((e,r)=>{e9?.terminate(),eC().then(([n,a])=>{try{(e9=a).onerror=e=>r(e),e9.onmessage=ts,tn=[e,r];let o={type:"init-wasm",in:h};!o.in.wasm.wasmPaths&&(n||ew)&&(o.in.wasm.wasmPaths={wasm:new URL("ort-wasm-simd-threaded.wasm",import.meta.url).href}),e9.postMessage(o),tr=n}catch(e){r(e)}},r)});try{await eM(h.wasm),await eQ(h),te=!0}catch(e){throw tt=!0,e}finally{e7=!1}}},tl=async e=>{if(e5())return ti(),new Promise((r,n)=>{to("init-ep",[r,n]);let a={type:"init-ep",in:{epName:e,env:h}};e9.postMessage(a)});await eX(h,e)},tf=async e=>e5()?(ti(),new Promise((r,n)=>{to("copy-from",[r,n]),e9.postMessage({type:"copy-from",in:{buffer:e}},[e.buffer])})):e0(e),tc=async(e,r)=>{if(!e5())return e1(e,r);if(r?.preferredOutputLocation)throw Error('session option "preferredOutputLocation" is not supported for proxy.');return ti(),new Promise((n,a)=>{to("create",[n,a]);let o={type:"create",in:{model:e,options:{...r}}},i=[];e instanceof Uint8Array&&i.push(e.buffer),e9.postMessage(o,i)})},tp=async e=>{if(e5())return ti(),new Promise((r,n)=>{to("release",[r,n]),e9.postMessage({type:"release",in:e})});e2(e)},td=async(e,r,n,a,o,i)=>{if(!e5())return e6(e,r,n,a,o,i);if(n.some(e=>"cpu"!==e[3]))throw Error("input tensor on GPU is not supported for proxy.");if(o.some(e=>e))throw Error("pre-allocated output tensor is not supported for proxy.");return ti(),new Promise((o,s)=>{to("run",[o,s]),e9.postMessage({type:"run",in:{sessionId:e,inputIndices:r,inputs:n,outputIndices:a,options:i}},e8(n))})},th=async e=>{if(e5())return ti(),new Promise((r,n)=>{to("end-profiling",[r,n]),e9.postMessage({type:"end-profiling",in:e})});e4(e)}}),tU=F(()=>{"use strict";eu(),tR(),tA(),el(),tC(),tm=(e,r)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[e.type,e.dims,{mlTensor:e.mlTensor},"ml-tensor"];default:throw Error(`invalid data location: ${e.location} for ${r()}`)}},ty=e=>{switch(e[3]){case"cpu":return new I(e[0],e[2],e[1]);case"gpu-buffer":{let r=e[0];if(!ez(r))throw Error(`not supported data type: ${r} for deserializing GPU tensor`);let{gpuBuffer:n,download:a,dispose:o}=e[2];return I.fromGpuBuffer(n,{dataType:r,dims:e[1],download:a,dispose:o})}case"ml-tensor":{let r=e[0];if(!eq(r))throw Error(`not supported data type: ${r} for deserializing MLTensor tensor`);let{mlTensor:n,download:a,dispose:o}=e[2];return I.fromMLTensor(n,{dataType:r,dims:e[1],download:a,dispose:o})}default:throw Error(`invalid data location: ${e[3]}`)}},tg=class{async fetchModelAndCopyToWasmMemory(e){return tf(await eZ(e))}async loadModel(e,r){let n;P(),n="string"==typeof e?await this.fetchModelAndCopyToWasmMemory(e):e,[this.sessionId,this.inputNames,this.outputNames,this.inputMetadata,this.outputMetadata]=await tc(n,r),S()}async dispose(){return tp(this.sessionId)}async run(e,r,n){P();let a=[],o=[];Object.entries(e).forEach(e=>{let r=e[0],n=e[1],i=this.inputNames.indexOf(r);if(-1===i)throw Error(`invalid input '${r}'`);a.push(n),o.push(i)});let i=[],s=[];Object.entries(r).forEach(e=>{let r=e[0],n=e[1],a=this.outputNames.indexOf(r);if(-1===a)throw Error(`invalid output '${r}'`);i.push(n),s.push(a)});let u=a.map((e,r)=>tm(e,()=>`input "${this.inputNames[o[r]]}"`)),l=i.map((e,r)=>e?tm(e,()=>`output "${this.outputNames[s[r]]}"`):null),f=await td(this.sessionId,o,u,s,l,n),c={};for(let e=0;e<f.length;e++)c[this.outputNames[s[e]]]=i[e]??ty(f[e]);return S(),c}startProfiling(){}endProfiling(){th(this.sessionId)}}}),tx={};G(tx,{OnnxruntimeWebAssemblyBackend:()=>tL,initializeFlags:()=>tI,wasmBackend:()=>tM});var tI,tL,tM,tP=F(()=>{"use strict";eu(),tR(),tU(),tI=()=>{("number"!=typeof h.wasm.initTimeout||h.wasm.initTimeout<0)&&(h.wasm.initTimeout=0);let e=h.wasm.simd;if("boolean"!=typeof e&&void 0!==e&&"fixed"!==e&&"relaxed"!==e&&(console.warn(`Property "env.wasm.simd" is set to unknown value "${e}". Reset it to \`false\` and ignore SIMD feature checking.`),h.wasm.simd=!1),"boolean"!=typeof h.wasm.proxy&&(h.wasm.proxy=!1),"boolean"!=typeof h.wasm.trace&&(h.wasm.trace=!1),"number"!=typeof h.wasm.numThreads||!Number.isInteger(h.wasm.numThreads)||h.wasm.numThreads<=0)if("u">typeof self&&!self.crossOriginIsolated)h.wasm.numThreads=1;else{let e=typeof navigator>"u"?D("node:os").cpus().length:navigator.hardwareConcurrency;h.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},tM=new(tL=class{async init(e){tI(),await tu(),await tl(e)}async createInferenceSessionHandler(e,r){let n=new tg;return await n.loadModel(e,r),n}})});eu(),eu(),eu();var tS=es;{let e=(tP(),W(tx)).wasmBackend;u("cpu",e,10),u("wasm",e,10)}Object.defineProperty(h.versions,"web",{value:"1.23.2",enumerable:!0});export{N as InferenceSession,L as TRACE,$ as TRACE_EVENT_BEGIN,k as TRACE_EVENT_END,P as TRACE_FUNC_BEGIN,S as TRACE_FUNC_END,I as Tensor,tS as default,h as env,u as registerBackend};