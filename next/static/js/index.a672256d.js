/*! For license information please see index.a672256d.js.LICENSE.txt */
(()=>{var __webpack_modules__={710(e){"use strict";var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString,i=Object.defineProperty,a=Object.getOwnPropertyDescriptor,o=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===n.call(e)},s=function(e){if(!e||"[object Object]"!==n.call(e))return!1;var i,a=t.call(e,"constructor"),o=e.constructor&&e.constructor.prototype&&t.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!a&&!o)return!1;for(i in e);return void 0===i||t.call(e,i)},l=function(e,t){i&&"__proto__"===t.name?i(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},u=function(e,n){if("__proto__"===n){if(!t.call(e,n))return;else if(a)return a(e,n).value}return e[n]};e.exports=function e(){var t,n,i,a,c,d,p=arguments[0],h=1,f=arguments.length,g=!1;for("boolean"==typeof p&&(g=p,p=arguments[1]||{},h=2),(null==p||"object"!=typeof p&&"function"!=typeof p)&&(p={});h<f;++h)if(t=arguments[h],null!=t)for(n in t)i=u(p,n),p!==(a=u(t,n))&&(g&&a&&(s(a)||(c=o(a)))?(c?(c=!1,d=i&&o(i)?i:[]):d=i&&s(i)?i:{},l(p,{name:n,newValue:e(g,d,a)})):void 0!==a&&l(p,{name:n,newValue:a}));return p}},792(e){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;if(Array.isArray(t)){if((i=t.length)!=n.length)return!1;for(a=i;0!=a--;)if(!e(t[a],n[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((i=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(a=i;0!=a--;)if(!Object.prototype.hasOwnProperty.call(n,o[a]))return!1;for(a=i;0!=a--;){var i,a,o,s=o[a];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}},776(e){"use strict";var t=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,i=/^\s*/,a=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,o=/^:\s*/,s=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,l=/^[;\s]*/,u=/^\s+|\s+$/g,c="\n",d="/",p="*",h="",f="comment",g="declaration";function m(e){return e?e.replace(u,h):h}e.exports=function(e,u){if("string"!=typeof e)throw TypeError("First argument must be a string");if(!e)return[];u=u||{};var y=1,b=1;function v(e){var t=e.match(n);t&&(y+=t.length);var i=e.lastIndexOf(c);b=~i?e.length-i:b+e.length}function x(){var e={line:y,column:b};return function(t){return t.position=new w(e),k(),t}}function w(e){this.start=e,this.end={line:y,column:b},this.source=u.source}function _(t){var n=Error(u.source+":"+y+":"+b+": "+t);if(n.reason=t,n.filename=u.source,n.line=y,n.column=b,n.source=e,u.silent);else throw n}function S(t){var n=t.exec(e);if(n){var i=n[0];return v(i),e=e.slice(i.length),n}}function k(){S(i)}function T(e){var t;for(e=e||[];t=C();)!1!==t&&e.push(t);return e}function C(){var t=x();if(d==e.charAt(0)&&p==e.charAt(1)){for(var n=2;h!=e.charAt(n)&&(p!=e.charAt(n)||d!=e.charAt(n+1));)++n;if(n+=2,h===e.charAt(n-1))return _("End of comment missing");var i=e.slice(2,n-2);return b+=2,v(i),e=e.slice(n),b+=2,t({type:f,comment:i})}}function E(){var e=x(),n=S(a);if(n){if(C(),!S(o))return _("property missing ':'");var i=S(s),u=e({type:g,property:m(n[0].replace(t,h)),value:i?m(i[0].replace(t,h)):h});return S(l),u}}function I(){var e,t=[];for(T(t);e=E();)!1!==e&&(t.push(e),T(t));return t}return w.prototype.content=e,k(),I()}},974(e,t,n){"use strict";var i,a=n(967),o=n(41),s=n(144);function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function c(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do 0!=(4098&(t=e).flags)&&(n=t.return),e=t.return;while(e)}return 3===t.tag?n:null}function d(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function p(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function h(e){if(c(e)!==e)throw Error(l(188))}function f(e){var t=e.alternate;if(!t){if(null===(t=c(e)))throw Error(l(188));return t!==e?null:e}for(var n=e,i=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(i=a.return)){n=i;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return h(a),e;if(o===i)return h(a),t;o=o.sibling}throw Error(l(188))}if(n.return!==i.return)n=a,i=o;else{for(var s=!1,u=a.child;u;){if(u===n){s=!0,n=a,i=o;break}if(u===i){s=!0,i=a,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,i=a;break}if(u===i){s=!0,i=o,n=a;break}u=u.sibling}if(!s)throw Error(l(189))}}if(n.alternate!==i)throw Error(l(190))}if(3!==n.tag)throw Error(l(188));return n.stateNode.current===n?e:t}function g(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=g(e)))return t;e=e.sibling}return null}var m=Object.assign,y=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),S=Symbol.for("react.consumer"),k=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),$=Symbol.for("react.lazy");Symbol.for("react.scope");var O=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var A=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var N=Symbol.iterator;function P(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=N&&e[N]||e["@@iterator"])?e:null}var D=Symbol.for("react.client.reference");function M(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===D?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case x:return"Fragment";case _:return"Profiler";case w:return"StrictMode";case C:return"Suspense";case E:return"SuspenseList";case O:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case v:return"Portal";case k:return e.displayName||"Context";case S:return(e._context.displayName||"Context")+".Consumer";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case I:return null!==(t=e.displayName||null)?t:M(e.type)||"Memo";case $:t=e._payload,e=e._init;try{return M(e(t))}catch(e){}}return null}var z=Array.isArray,j=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},F=[],B=-1;function U(e){return{current:e}}function V(e){0>B||(e.current=F[B],F[B]=null,B--)}function G(e,t){F[++B]=e.current,e.current=t}var H=U(null),W=U(null),q=U(null),K=U(null);function X(e,t){switch(G(q,t),G(W,e),G(H,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?u6(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=u5(t=u6(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}V(H),G(H,e)}function Z(){V(H),V(W),V(q)}function Y(e){null!==e.memoizedState&&G(K,e);var t=H.current,n=u5(t,e.type);t!==n&&(G(W,e),G(H,n))}function Q(e){W.current===e&&(V(H),V(W)),K.current===e&&(V(K),c3._currentValue=L)}function J(e){if(void 0===tq)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);tq=t&&t[1]||"",tK=-1<e.stack.indexOf("\n    at")?" (<anonymous>)":-1<e.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+tq+e+tK}var ee=!1;function et(e,t){if(!e||ee)return"";ee=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(e){var i=e}Reflect.construct(e,[],n)}else{try{n.call()}catch(e){i=e}e.call(n.prototype)}}else{try{throw Error()}catch(e){i=e}(n=e())&&"function"==typeof n.catch&&n.catch(function(){})}}catch(e){if(e&&i&&"string"==typeof e.stack)return[e.stack,i.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=i.DetermineComponentFrameRoot(),s=o[0],l=o[1];if(s&&l){var u=s.split("\n"),c=l.split("\n");for(a=i=0;i<u.length&&!u[i].includes("DetermineComponentFrameRoot");)i++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(i===u.length||a===c.length)for(i=u.length-1,a=c.length-1;1<=i&&0<=a&&u[i]!==c[a];)a--;for(;1<=i&&0<=a;i--,a--)if(u[i]!==c[a]){if(1!==i||1!==a)do if(i--,a--,0>a||u[i]!==c[a]){var d="\n"+u[i].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=i&&0<=a);break}}}finally{ee=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?J(n):""}function en(e,t){switch(e.tag){case 26:case 27:case 5:return J(e.type);case 16:return J("Lazy");case 13:return e.child!==t&&null!==t?J("Suspense Fallback"):J("Suspense");case 19:return J("SuspenseList");case 0:case 15:return et(e.type,!1);case 11:return et(e.type.render,!1);case 1:return et(e.type,!0);case 31:return J("Activity");default:return""}}function er(e){try{var t="",n=null;do t+=en(e,n),n=e,e=e.return;while(e);return t}catch(e){return"\nError generating stack: "+e.message+"\n"+e.stack}}var ei=Object.prototype.hasOwnProperty,ea=a.unstable_scheduleCallback,eo=a.unstable_cancelCallback,es=a.unstable_shouldYield,el=a.unstable_requestPaint,eu=a.unstable_now,ec=a.unstable_getCurrentPriorityLevel,ed=a.unstable_ImmediatePriority,ep=a.unstable_UserBlockingPriority,eh=a.unstable_NormalPriority,ef=a.unstable_LowPriority,eg=a.unstable_IdlePriority,em=a.log,ey=a.unstable_setDisableYieldValue,eb=null,ev=null;function ex(e){if("function"==typeof em&&ey(e),ev&&"function"==typeof ev.setStrictMode)try{ev.setStrictMode(eb,e)}catch(e){}}var ew=Math.clz32?Math.clz32:ek,e_=Math.log,eS=Math.LN2;function ek(e){return 0==(e>>>=0)?32:31-(e_(e)/eS|0)|0}var eT=256,eC=262144,eE=4194304;function eI(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 0x1000000:case 0x2000000:return 0x3c00000&e;case 0x4000000:return 0x4000000;case 0x8000000:return 0x8000000;case 0x10000000:return 0x10000000;case 0x20000000:return 0x20000000;case 0x40000000:return 0;default:return e}}function e$(e,t,n){var i=e.pendingLanes;if(0===i)return 0;var a=0,o=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var l=0x7ffffff&i;return 0!==l?0!=(i=l&~o)?a=eI(i):0!=(s&=l)?a=eI(s):n||0!=(n=l&~e)&&(a=eI(n)):0!=(l=i&~o)?a=eI(l):0!==s?a=eI(s):n||0!=(n=i&~e)&&(a=eI(n)),0===a?0:0!==t&&t!==a&&0==(t&o)&&((o=a&-a)>=(n=t&-t)||32===o&&0!=(4194048&n))?t:a}function eO(e,t){return 0==(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function eA(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return -1}}function eN(){var e=eE;return 0==(0x3c00000&(eE<<=1))&&(eE=4194304),e}function eP(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function eD(e,t){e.pendingLanes|=t,0x10000000!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function eM(e,t,n,i,a,o){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var l=e.entanglements,u=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var d=31-ew(n),p=1<<d;l[d]=0,u[d]=-1;var h=c[d];if(null!==h)for(c[d]=null,d=0;d<h.length;d++){var f=h[d];null!==f&&(f.lane&=-0x20000001)}n&=~p}0!==i&&ez(e,i,0),0!==o&&0===a&&0!==e.tag&&(e.suspendedLanes|=o&~(s&~t))}function ez(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-ew(t);e.entangledLanes|=t,e.entanglements[i]=0x40000000|e.entanglements[i]|261930&n}function ej(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ew(n),a=1<<i;a&t|e[i]&t&&(e[i]|=t),n&=~a}}function eR(e,t){var n=t&-t;return 0!=((n=0!=(42&n)?1:eL(n))&(e.suspendedLanes|t))?0:n}function eL(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 0x1000000:case 0x2000000:e=128;break;case 0x10000000:e=0x8000000;break;default:e=0}return e}function eF(e){return 2<(e&=-e)?8<e?0!=(0x7ffffff&e)?32:0x10000000:8:2}function eB(){var e=R.p;return 0!==e?e:void 0===(e=window.event)?32:dc(e.type)}function eU(e,t){var n=R.p;try{return R.p=e,t()}finally{R.p=n}}var eV=Math.random().toString(36).slice(2),eG="__reactFiber$"+eV,eH="__reactProps$"+eV,eW="__reactContainer$"+eV,eq="__reactEvents$"+eV,eK="__reactListeners$"+eV,eX="__reactHandles$"+eV,eZ="__reactResources$"+eV,eY="__reactMarker$"+eV;function eQ(e){delete e[eG],delete e[eH],delete e[eq],delete e[eK],delete e[eX]}function eJ(e){var t=e[eG];if(t)return t;for(var n=e.parentNode;n;){if(t=n[eW]||n[eG]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=cb(e);null!==e;){if(n=e[eG])return n;e=cb(e)}return t}n=(e=n).parentNode}return null}function e0(e){if(e=e[eG]||e[eW]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function e1(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(l(33))}function e2(e){var t=e[eZ];return t||(t=e[eZ]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function e3(e){e[eY]=!0}var e4=new Set,e6={};function e5(e,t){e8(e,t),e8(e+"Capture",t)}function e8(e,t){for(e6[e]=t,e=0;e<t.length;e++)e4.add(t[e])}var e7=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),e9={},te={};function tt(e){return!!ei.call(te,e)||!ei.call(e9,e)&&(e7.test(e)?te[e]=!0:(e9[e]=!0,!1))}function tn(e,t,n){if(tt(t))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if("data-"!==i&&"aria-"!==i)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function tr(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function ti(e,t,n,i){if(null===i)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+i)}}function ta(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function to(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ts(e,t,n){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&void 0!==i&&"function"==typeof i.get&&"function"==typeof i.set){var a=i.get,o=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function tl(e){if(!e._valueTracker){var t=to(e)?"checked":"value";e._valueTracker=ts(e,t,""+e[t])}}function tu(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=to(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function tc(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var td=/[\n"\\]/g;function tp(e){return e.replace(td,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function th(e,t,n,i,a,o,s,l){e.name="",null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ta(t)):e.value!==""+ta(t)&&(e.value=""+ta(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?tg(e,s,ta(t)):null!=n?tg(e,s,ta(n)):null!=i&&e.removeAttribute("value"),null==a&&null!=o&&(e.defaultChecked=!!o),null!=a&&(e.checked=a&&"function"!=typeof a&&"symbol"!=typeof a),null!=l&&"function"!=typeof l&&"symbol"!=typeof l&&"boolean"!=typeof l?e.name=""+ta(l):e.removeAttribute("name")}function tf(e,t,n,i,a,o,s,l){if(null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o&&(e.type=o),null!=t||null!=n){if(("submit"===o||"reset"===o)&&null==t)return void tl(e);n=null!=n?""+ta(n):"",t=null!=t?""+ta(t):n,l||t===e.value||(e.value=t),e.defaultValue=t}i="function"!=typeof(i=null!=i?i:a)&&"symbol"!=typeof i&&!!i,e.checked=l?e.checked:!!i,e.defaultChecked=!!i,null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s&&(e.name=s),tl(e)}function tg(e,t,n){"number"===t&&tc(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function tm(e,t,n,i){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&i&&(e[n].defaultSelected=!0)}else{for(a=0,n=""+ta(n),t=null;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,i&&(e[a].defaultSelected=!0);return}null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function ty(e,t,n){if(null!=t&&((t=""+ta(t))!==e.value&&(e.value=t),null==n)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=null!=n?""+ta(n):""}function tb(e,t,n,i){if(null==t){if(null!=i){if(null!=n)throw Error(l(92));if(z(i)){if(1<i.length)throw Error(l(93));i=i[0]}n=i}null==n&&(n=""),t=n}e.defaultValue=n=ta(t),(i=e.textContent)===n&&""!==i&&null!==i&&(e.value=i),tl(e)}function tv(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType){n.nodeValue=t;return}}e.textContent=t}var tx=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function tw(e,t,n){var i=0===t.indexOf("--");null==n||"boolean"==typeof n||""===n?i?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":i?e.setProperty(t,n):"number"!=typeof n||0===n||tx.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function t_(e,t,n){if(null!=t&&"object"!=typeof t)throw Error(l(62));if(e=e.style,null!=n){for(var i in n)!n.hasOwnProperty(i)||null!=t&&t.hasOwnProperty(i)||(0===i.indexOf("--")?e.setProperty(i,""):"float"===i?e.cssFloat="":e[i]="");for(var a in t)i=t[a],t.hasOwnProperty(a)&&n[a]!==i&&tw(e,a,i)}else for(var o in t)t.hasOwnProperty(o)&&tw(e,o,t[o])}function tS(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tk=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),tT=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function tC(e){return tT.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function tE(){}var tI=null;function t$(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var tO=null,tA=null;function tN(e){var t=e0(e);if(t&&(e=t.stateNode)){var n=e[eH]||null;switch(e=t.stateNode,t.type){case"input":if(th(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+tp(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var a=i[eH]||null;if(!a)throw Error(l(90));th(i,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<n.length;t++)(i=n[t]).form===e.form&&tu(i)}break;case"textarea":ty(e,n.value,n.defaultValue);break;case"select":null!=(t=n.value)&&tm(e,!!n.multiple,t,!1)}}}var tP=!1;function tD(e,t,n){if(tP)return e(t,n);tP=!0;try{return e(t)}finally{if(tP=!1,(null!==tO||null!==tA)&&(lH(),tO&&(t=tO,e=tA,tA=tO=null,tN(t),e)))for(t=0;t<e.length;t++)tN(e[t])}}function tM(e,t){var n=e.stateNode;if(null===n)return null;var i=n[eH]||null;if(null===i)return null;switch(n=i[t],t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i="button"!==(e=e.type)&&"input"!==e&&"select"!==e&&"textarea"!==e),e=!i;break;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(l(231,t,typeof n));return n}var tz="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,tj=!1;if(tz)try{var tR={};Object.defineProperty(tR,"passive",{get:function(){tj=!0}}),window.addEventListener("test",tR,tR),window.removeEventListener("test",tR,tR)}catch(e){tj=!1}var tL=null,tF=null,tB=null;function tU(){if(tB)return tB;var e,t,n=tF,i=n.length,a="value"in tL?tL.value:tL.textContent,o=a.length;for(e=0;e<i&&n[e]===a[e];e++);var s=i-e;for(t=1;t<=s&&n[i-t]===a[o-t];t++);return tB=a.slice(e,1<t?1-t:void 0)}function tV(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function tG(){return!0}function tH(){return!1}function tW(e){function t(t,n,i,a,o){for(var s in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?tG:tH,this.isPropagationStopped=tH,this}return m(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=tG)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=tG)},persist:function(){},isPersistent:tG}),t}var tq,tK,tX,tZ,tY,tQ={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tJ=tW(tQ),t0=m({},tQ,{view:0,detail:0}),t1=tW(t0),t2=m({},t0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==tY&&(tY&&"mousemove"===e.type?(tX=e.screenX-tY.screenX,tZ=e.screenY-tY.screenY):tZ=tX=0,tY=e),tX)},movementY:function(e){return"movementY"in e?e.movementY:tZ}}),t3=tW(t2),t4=tW(m({},t2,{dataTransfer:0})),t6=tW(m({},t0,{relatedTarget:0})),t5=tW(m({},tQ,{animationName:0,elapsedTime:0,pseudoElement:0})),t8=tW(m({},tQ,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),t7=tW(m({},tQ,{data:0})),t9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ne={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=nt[e])&&!!t[e]}function nr(){return nn}var ni=tW(m({},t0,{key:function(e){if(e.key){var t=t9[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tV(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?ne[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nr,charCode:function(e){return"keypress"===e.type?tV(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tV(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),na=tW(m({},t2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),no=tW(m({},t0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nr})),ns=tW(m({},tQ,{propertyName:0,elapsedTime:0,pseudoElement:0})),nl=tW(m({},t2,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),nu=tW(m({},tQ,{newState:0,oldState:0})),nc=[9,13,27,32],nd=tz&&"CompositionEvent"in window,np=null;tz&&"documentMode"in document&&(np=document.documentMode);var nh=tz&&"TextEvent"in window&&!np,nf=tz&&(!nd||np&&8<np&&11>=np),ng=" ",nm=!1;function ny(e,t){switch(e){case"keyup":return -1!==nc.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nb(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var nv=!1;function nx(e,t){switch(e){case"compositionend":return nb(t);case"keypress":if(32!==t.which)return null;return nm=!0,ng;case"textInput":return(e=t.data)===ng&&nm?null:e;default:return null}}function nw(e,t){if(nv)return"compositionend"===e||!nd&&ny(e,t)?(e=tU(),tB=tF=tL=null,nv=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return nf&&"ko"!==t.locale?null:t.data}}var n_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nS(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!n_[e.type]:"textarea"===t}function nk(e,t,n,i){tO?tA?tA.push(i):tA=[i]:tO=i,0<(t=uV(t,"onChange")).length&&(n=new tJ("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var nT=null,nC=null;function nE(e){uM(e,0)}function nI(e){if(tu(e1(e)))return e}function n$(e,t){if("change"===e)return t}var nO=!1;if(tz){if(tz){var nA="oninput"in document;if(!nA){var nN=document.createElement("div");nN.setAttribute("oninput","return;"),nA="function"==typeof nN.oninput}i=nA}else i=!1;nO=i&&(!document.documentMode||9<document.documentMode)}function nP(){nT&&(nT.detachEvent("onpropertychange",nD),nC=nT=null)}function nD(e){if("value"===e.propertyName&&nI(nC)){var t=[];nk(t,nC,e,t$(e)),tD(nE,t)}}function nM(e,t,n){"focusin"===e?(nP(),nT=t,nC=n,nT.attachEvent("onpropertychange",nD)):"focusout"===e&&nP()}function nz(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return nI(nC)}function nj(e,t){if("click"===e)return nI(t)}function nR(e,t){if("input"===e||"change"===e)return nI(t)}function nL(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t}var nF="function"==typeof Object.is?Object.is:nL;function nB(e,t){if(nF(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var a=n[i];if(!ei.call(t,a)||!nF(e[a],t[a]))return!1}return!0}function nU(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function nV(e,t){var n,i=nU(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=nU(i)}}function nG(e,t){return!!e&&!!t&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?nG(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function nH(e){e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window;for(var t=tc(e.document);t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(n)e=t.contentWindow;else break;t=tc(e.document)}return t}function nW(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var nq=tz&&"documentMode"in document&&11>=document.documentMode,nK=null,nX=null,nZ=null,nY=!1;function nQ(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;nY||null==nK||nK!==tc(i)||(i="selectionStart"in(i=nK)&&nW(i)?{start:i.selectionStart,end:i.selectionEnd}:{anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},nZ&&nB(nZ,i)||(nZ=i,0<(i=uV(nX,"onSelect")).length&&(t=new tJ("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=nK)))}function nJ(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var n0={animationend:nJ("Animation","AnimationEnd"),animationiteration:nJ("Animation","AnimationIteration"),animationstart:nJ("Animation","AnimationStart"),transitionrun:nJ("Transition","TransitionRun"),transitionstart:nJ("Transition","TransitionStart"),transitioncancel:nJ("Transition","TransitionCancel"),transitionend:nJ("Transition","TransitionEnd")},n1={},n2={};function n3(e){if(n1[e])return n1[e];if(!n0[e])return e;var t,n=n0[e];for(t in n)if(n.hasOwnProperty(t)&&t in n2)return n1[e]=n[t];return e}tz&&(n2=document.createElement("div").style,"AnimationEvent"in window||(delete n0.animationend.animation,delete n0.animationiteration.animation,delete n0.animationstart.animation),"TransitionEvent"in window||delete n0.transitionend.transition);var n4=n3("animationend"),n6=n3("animationiteration"),n5=n3("animationstart"),n8=n3("transitionrun"),n7=n3("transitionstart"),n9=n3("transitioncancel"),re=n3("transitionend"),rt=new Map,rn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rr(e,t){rt.set(e,t),e5(t,[e])}rn.push("scrollEnd");var ri="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},ra=[],ro=0,rs=0;function rl(){for(var e=ro,t=rs=ro=0;t<e;){var n=ra[t];ra[t++]=null;var i=ra[t];ra[t++]=null;var a=ra[t];ra[t++]=null;var o=ra[t];if(ra[t++]=null,null!==i&&null!==a){var s=i.pending;null===s?a.next=a:(a.next=s.next,s.next=a),i.pending=a}0!==o&&rp(n,a,o)}}function ru(e,t,n,i){ra[ro++]=e,ra[ro++]=t,ra[ro++]=n,ra[ro++]=i,rs|=i,e.lanes|=i,null!==(e=e.alternate)&&(e.lanes|=i)}function rc(e,t,n,i){return ru(e,t,n,i),rh(e)}function rd(e,t){return ru(e,null,null,t),rh(e)}function rp(e,t,n){e.lanes|=n;var i=e.alternate;null!==i&&(i.lanes|=n);for(var a=!1,o=e.return;null!==o;)o.childLanes|=n,null!==(i=o.alternate)&&(i.childLanes|=n),22===o.tag&&(null===(e=o.stateNode)||1&e._visibility||(a=!0)),e=o,o=o.return;return 3===e.tag?(o=e.stateNode,a&&null!==t&&(a=31-ew(n),null===(i=(e=o.hiddenUpdates)[a])?e[a]=[t]:i.push(t),t.lane=0x20000000|n),o):null}function rh(e){if(50<lz)throw lz=0,lj=null,Error(l(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var rf={};function rg(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rm(e,t,n,i){return new rg(e,t,n,i)}function ry(e){return!(!(e=e.prototype)||!e.isReactComponent)}function rb(e,t){var n=e.alternate;return null===n?((n=rm(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=0x3e00000&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function rv(e,t){e.flags&=0x3e00002;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,e.dependencies=null===(t=n.dependencies)?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function rx(e,t,n,i,a,o){var s=0;if(i=e,"function"==typeof e)ry(e)&&(s=1);else if("string"==typeof e)s=cK(e,n,H.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case O:return(e=rm(31,n,t,a)).elementType=O,e.lanes=o,e;case x:return rw(n.children,a,o,t);case w:s=8,a|=24;break;case _:return(e=rm(12,n,t,2|a)).elementType=_,e.lanes=o,e;case C:return(e=rm(13,n,t,a)).elementType=C,e.lanes=o,e;case E:return(e=rm(19,n,t,a)).elementType=E,e.lanes=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case k:s=10;break e;case S:s=9;break e;case T:s=11;break e;case I:s=14;break e;case $:s=16,i=null;break e}s=29,n=Error(l(130,null===e?"null":typeof e,"")),i=null}return(t=rm(s,n,t,a)).elementType=e,t.type=i,t.lanes=o,t}function rw(e,t,n,i){return(e=rm(7,e,i,t)).lanes=n,e}function r_(e,t,n){return(e=rm(6,e,null,t)).lanes=n,e}function rS(e){var t=rm(18,null,null,0);return t.stateNode=e,t}function rk(e,t,n){return(t=rm(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var rT=new WeakMap;function rC(e,t){if("object"==typeof e&&null!==e){var n=rT.get(e);return void 0!==n?n:(t={value:e,source:t,stack:er(t)},rT.set(e,t),t)}return{value:e,source:t,stack:er(t)}}var rE=[],rI=0,r$=null,rO=0,rA=[],rN=0,rP=null,rD=1,rM="";function rz(e,t){rE[rI++]=rO,rE[rI++]=r$,r$=e,rO=t}function rj(e,t,n){rA[rN++]=rD,rA[rN++]=rM,rA[rN++]=rP,rP=e;var i=rD;e=rM;var a=32-ew(i)-1;i&=~(1<<a),n+=1;var o=32-ew(t)+a;if(30<o){var s=a-a%5;o=(i&(1<<s)-1).toString(32),i>>=s,a-=s,rD=1<<32-ew(t)+a|n<<a|i,rM=o+e}else rD=1<<o|n<<a|i,rM=e}function rR(e){null!==e.return&&(rz(e,1),rj(e,1,0))}function rL(e){for(;e===r$;)r$=rE[--rI],rE[rI]=null,rO=rE[--rI],rE[rI]=null;for(;e===rP;)rP=rA[--rN],rA[rN]=null,rM=rA[--rN],rA[rN]=null,rD=rA[--rN],rA[rN]=null}function rF(e,t){rA[rN++]=rD,rA[rN++]=rM,rA[rN++]=rP,rD=t.id,rM=t.overflow,rP=e}var rB=null,rU=null,rV=!1,rG=null,rH=!1,rW=Error(l(519));function rq(e){var t=Error(l(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML",""));throw rJ(rC(t,e)),rW}function rK(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[eG]=e,t[eH]=i,n){case"dialog":uz("cancel",t),uz("close",t);break;case"iframe":case"object":case"embed":uz("load",t);break;case"video":case"audio":for(n=0;n<uP.length;n++)uz(uP[n],t);break;case"source":uz("error",t);break;case"img":case"image":case"link":uz("error",t),uz("load",t);break;case"details":uz("toggle",t);break;case"input":uz("invalid",t),tf(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":uz("invalid",t);break;case"textarea":uz("invalid",t),tb(t,i.value,i.defaultValue,i.children)}"string"!=typeof(n=i.children)&&"number"!=typeof n&&"bigint"!=typeof n||t.textContent===""+n||!0===i.suppressHydrationWarning||uX(t.textContent,n)?(null!=i.popover&&(uz("beforetoggle",t),uz("toggle",t)),null!=i.onScroll&&uz("scroll",t),null!=i.onScrollEnd&&uz("scrollend",t),null!=i.onClick&&(t.onclick=tE),t=!0):t=!1,t||rq(e,!0)}function rX(e){for(rB=e.return;rB;)switch(rB.tag){case 5:case 31:case 13:rH=!1;return;case 27:case 3:rH=!0;return;default:rB=rB.return}}function rZ(e){if(e!==rB)return!1;if(!rV)return rX(e),rV=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t="form"===(t=e.type)||"button"===t||u8(e.type,e.memoizedProps)),t=!t),t&&rU&&rq(e),rX(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(l(317));rU=cy(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(l(317));rU=cy(e)}else 27===n?(n=rU,ca(e.type)?(e=cm,cm=null,rU=e):rU=n):rU=rB?cg(e.stateNode.nextSibling):null;return!0}function rY(){rU=rB=null,rV=!1}function rQ(){var e=rG;return null!==e&&(null===l_?l_=e:l_.push.apply(l_,e),rG=null),e}function rJ(e){null===rG?rG=[e]:rG.push(e)}var r0=U(null),r1=null,r2=null;function r3(e,t,n){G(r0,t._currentValue),t._currentValue=n}function r4(e){e._currentValue=r0.current,V(r0)}function r6(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function r5(e,t,n,i){var a=e.child;for(null!==a&&(a.return=e);null!==a;){var o=a.dependencies;if(null!==o){var s=a.child;o=o.firstContext;e:for(;null!==o;){var u=o;o=a;for(var c=0;c<t.length;c++)if(u.context===t[c]){o.lanes|=n,null!==(u=o.alternate)&&(u.lanes|=n),r6(o.return,n,e),i||(s=null);break e}o=u.next}}else if(18===a.tag){if(null===(s=a.return))throw Error(l(341));s.lanes|=n,null!==(o=s.alternate)&&(o.lanes|=n),r6(s,n,e),s=null}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===e){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}}function r8(e,t,n,i){e=null;for(var a=t,o=!1;null!==a;){if(!o){if(0!=(524288&a.flags))o=!0;else if(0!=(262144&a.flags))break}if(10===a.tag){var s=a.alternate;if(null===s)throw Error(l(387));if(null!==(s=s.memoizedProps)){var u=a.type;nF(a.pendingProps.value,s.value)||(null!==e?e.push(u):e=[u])}}else if(a===K.current){if(null===(s=a.alternate))throw Error(l(387));s.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(null!==e?e.push(c3):e=[c3])}a=a.return}null!==e&&r5(t,e,n,i),t.flags|=262144}function r7(e){for(e=e.firstContext;null!==e;){if(!nF(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function r9(e){r1=e,r2=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function ie(e){return ir(r1,e)}function it(e,t){return null===r1&&r9(e),ir(e,t)}function ir(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===r2){if(null===e)throw Error(l(308));r2=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else r2=r2.next=t;return n}var ii="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},ia=a.unstable_scheduleCallback,io=a.unstable_NormalPriority,is={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function il(){return{controller:new ii,data:new Map,refCount:0}}function iu(e){e.refCount--,0===e.refCount&&ia(io,function(){e.controller.abort()})}var ic=null,id=0,ip=0,ih=null;function ig(e,t){if(null===ic){var n=ic=[];id=0,ip=uE(),ih={status:"pending",value:void 0,then:function(e){n.push(e)}}}return id++,t.then(im,im),t}function im(){if(0==--id&&null!==ic){null!==ih&&(ih.status="fulfilled");var e=ic;ic=null,ip=0,ih=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function iy(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(i.status="rejected",i.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),i}var ib=j.S;j.S=function(e,t){lT=eu(),"object"==typeof t&&null!==t&&"function"==typeof t.then&&ig(e,t),null!==ib&&ib(e,t)};var iv=U(null);function ix(){var e=iv.current;return null!==e?e:lo.pooledCache}function iw(e,t){null===t?G(iv,iv.current):G(iv,t.pool)}function i_(){var e=ix();return null===e?null:{parent:is._currentValue,pool:e}}var iS=Error(l(460)),ik=Error(l(474)),iT=Error(l(542)),iC={then:function(){}};function iE(e){return"fulfilled"===(e=e.status)||"rejected"===e}function iI(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(tE,tE),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw iN(e=t.reason),e;default:if("string"==typeof t.status)t.then(tE,tE);else{if(null!==(e=lo)&&100<e.shellSuspendCounter)throw Error(l(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw iN(e=t.reason),e}throw iO=t,iS}}function i$(e){try{return(0,e._init)(e._payload)}catch(e){if(null!==e&&"object"==typeof e&&"function"==typeof e.then)throw iO=e,iS;throw e}}var iO=null;function iA(){if(null===iO)throw Error(l(459));var e=iO;return iO=null,e}function iN(e){if(e===iS||e===iT)throw Error(l(483))}var iP=null,iD=0;function iM(e){var t=iD;return iD+=1,null===iP&&(iP=[]),iI(iP,e,t)}function iz(e,t){e.ref=void 0!==(t=t.props.ref)?t:null}function ij(e,t){if(t.$$typeof===y)throw Error(l(525));throw Error(l(31,"[object Object]"===(e=Object.prototype.toString.call(t))?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function iR(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(e,t){return(e=rb(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return(t.index=i,e)?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=0x4000002,n):i:(t.flags|=0x4000002,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=0x4000002),t}function u(e,t,n,i){return null===t||6!==t.tag?(t=r_(n,e.mode,i)).return=e:(t=a(t,n)).return=e,t}function c(e,t,n,i){var o=n.type;return o===x?p(e,t,n.props.children,i,n.key):(null!==t&&(t.elementType===o||"object"==typeof o&&null!==o&&o.$$typeof===$&&i$(o)===t.type)?iz(t=a(t,n.props),n):iz(t=rx(n.type,n.key,n.props,null,e.mode,i),n),t.return=e,t)}function d(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?(t=rk(n,e.mode,i)).return=e:(t=a(t,n.children||[])).return=e,t}function p(e,t,n,i,o){return null===t||7!==t.tag?(t=rw(n,e.mode,i,o)).return=e:(t=a(t,n)).return=e,t}function h(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=r_(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case b:return iz(n=rx(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case v:return(t=rk(t,e.mode,n)).return=e,t;case $:return h(e,t=i$(t),n)}if(z(t)||P(t))return(t=rw(t,e.mode,n,null)).return=e,t;if("function"==typeof t.then)return h(e,iM(t),n);if(t.$$typeof===k)return h(e,it(e,t),n);ij(e,t)}return null}function f(e,t,n,i){var a=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return null!==a?null:u(e,t,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===a?c(e,t,n,i):null;case v:return n.key===a?d(e,t,n,i):null;case $:return f(e,t,n=i$(n),i)}if(z(n)||P(n))return null!==a?null:p(e,t,n,i,null);if("function"==typeof n.then)return f(e,t,iM(n),i);if(n.$$typeof===k)return f(e,t,it(e,n),i);ij(e,n)}return null}function g(e,t,n,i,a){if("string"==typeof i&&""!==i||"number"==typeof i||"bigint"==typeof i)return u(t,e=e.get(n)||null,""+i,a);if("object"==typeof i&&null!==i){switch(i.$$typeof){case b:return c(t,e=e.get(null===i.key?n:i.key)||null,i,a);case v:return d(t,e=e.get(null===i.key?n:i.key)||null,i,a);case $:return g(e,t,n,i=i$(i),a)}if(z(i)||P(i))return p(t,e=e.get(n)||null,i,a,null);if("function"==typeof i.then)return g(e,t,n,iM(i),a);if(i.$$typeof===k)return g(e,t,n,it(t,i),a);ij(t,i)}return null}function m(a,s,l,u){for(var c=null,d=null,p=s,m=s=0,y=null;null!==p&&m<l.length;m++){p.index>m?(y=p,p=null):y=p.sibling;var b=f(a,p,l[m],u);if(null===b){null===p&&(p=y);break}e&&p&&null===b.alternate&&t(a,p),s=o(b,s,m),null===d?c=b:d.sibling=b,d=b,p=y}if(m===l.length)return n(a,p),rV&&rz(a,m),c;if(null===p){for(;m<l.length;m++)null!==(p=h(a,l[m],u))&&(s=o(p,s,m),null===d?c=p:d.sibling=p,d=p);return rV&&rz(a,m),c}for(p=i(p);m<l.length;m++)null!==(y=g(p,a,m,l[m],u))&&(e&&null!==y.alternate&&p.delete(null===y.key?m:y.key),s=o(y,s,m),null===d?c=y:d.sibling=y,d=y);return e&&p.forEach(function(e){return t(a,e)}),rV&&rz(a,m),c}function y(a,s,u,c){if(null==u)throw Error(l(151));for(var d=null,p=null,m=s,y=s=0,b=null,v=u.next();null!==m&&!v.done;y++,v=u.next()){m.index>y?(b=m,m=null):b=m.sibling;var x=f(a,m,v.value,c);if(null===x){null===m&&(m=b);break}e&&m&&null===x.alternate&&t(a,m),s=o(x,s,y),null===p?d=x:p.sibling=x,p=x,m=b}if(v.done)return n(a,m),rV&&rz(a,y),d;if(null===m){for(;!v.done;y++,v=u.next())null!==(v=h(a,v.value,c))&&(s=o(v,s,y),null===p?d=v:p.sibling=v,p=v);return rV&&rz(a,y),d}for(m=i(m);!v.done;y++,v=u.next())null!==(v=g(m,a,y,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?y:v.key),s=o(v,s,y),null===p?d=v:p.sibling=v,p=v);return e&&m.forEach(function(e){return t(a,e)}),rV&&rz(a,y),d}function w(e,i,o,u){if("object"==typeof o&&null!==o&&o.type===x&&null===o.key&&(o=o.props.children),"object"==typeof o&&null!==o){switch(o.$$typeof){case b:e:{for(var c=o.key;null!==i;){if(i.key===c){if((c=o.type)===x){if(7===i.tag){n(e,i.sibling),(u=a(i,o.props.children)).return=e,e=u;break e}}else if(i.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===$&&i$(c)===i.type){n(e,i.sibling),iz(u=a(i,o.props),o),u.return=e,e=u;break e}n(e,i);break}t(e,i),i=i.sibling}o.type===x?(u=rw(o.props.children,e.mode,u,o.key)).return=e:(iz(u=rx(o.type,o.key,o.props,null,e.mode,u),o),u.return=e),e=u}return s(e);case v:e:{for(c=o.key;null!==i;){if(i.key===c)if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(e,i.sibling),(u=a(i,o.children||[])).return=e,e=u;break e}else{n(e,i);break}t(e,i),i=i.sibling}(u=rk(o,e.mode,u)).return=e,e=u}return s(e);case $:return w(e,i,o=i$(o),u)}if(z(o))return m(e,i,o,u);if(P(o)){if("function"!=typeof(c=P(o)))throw Error(l(150));return y(e,i,o=c.call(o),u)}if("function"==typeof o.then)return w(e,i,iM(o),u);if(o.$$typeof===k)return w(e,i,it(e,o),u);ij(e,o)}return"string"==typeof o&&""!==o||"number"==typeof o||"bigint"==typeof o?(o=""+o,null!==i&&6===i.tag?(n(e,i.sibling),(u=a(i,o)).return=e):(n(e,i),(u=r_(o,e.mode,u)).return=e),s(e=u)):n(e,i)}return function(e,t,n,i){try{iD=0;var a=w(e,t,n,i);return iP=null,a}catch(t){if(t===iS||t===iT)throw t;var o=rm(29,t,null,e.mode);return o.lanes=i,o.return=e,o}finally{}}}var iL=iR(!0),iF=iR(!1),iB=!1;function iU(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function iV(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function iG(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function iH(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!=(2&la)){var a=i.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),i.pending=t,t=rh(e),rp(e,null,n),t}return ru(e,i,t,n),rh(e)}function iW(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194048&n))){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,ej(e,n)}}function iq(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var a=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===o?a=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?a=o=t:o=o.next=t}else a=o=t;n={baseState:i.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:i.shared,callbacks:i.callbacks},e.updateQueue=n;return}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var iK=!1;function iX(){if(iK){var e=ih;if(null!==e)throw e}}function iZ(e,t,n,i){iK=!1;var a=e.updateQueue;iB=!1;var o=a.firstBaseUpdate,s=a.lastBaseUpdate,l=a.shared.pending;if(null!==l){a.shared.pending=null;var u=l,c=u.next;u.next=null,null===s?o=c:s.next=c,s=u;var d=e.alternate;null!==d&&(l=(d=d.updateQueue).lastBaseUpdate)!==s&&(null===l?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=u)}if(null!==o){var p=a.baseState;for(s=0,d=c=u=null,l=o;;){var h=-0x20000001&l.lane,f=h!==l.lane;if(f?(ll&h)===h:(i&h)===h){0!==h&&h===ip&&(iK=!0),null!==d&&(d=d.next={lane:0,tag:l.tag,payload:l.payload,callback:null,next:null});e:{var g=e,y=l;h=t;var b=n;switch(y.tag){case 1:if("function"==typeof(g=y.payload)){p=g.call(b,p,h);break e}p=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null==(h="function"==typeof(g=y.payload)?g.call(b,p,h):g))break e;p=m({},p,h);break e;case 2:iB=!0}}null!==(h=l.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=a.callbacks)?a.callbacks=[h]:f.push(h))}else f={lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===d?(c=d=f,u=p):d=d.next=f,s|=h;if(null===(l=l.next))if(null===(l=a.shared.pending))break;else l=(f=l).next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}null===d&&(u=p),a.baseState=u,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null===o&&(a.shared.lanes=0),lm|=s,e.lanes=s,e.memoizedState=p}}function iY(e,t){if("function"!=typeof e)throw Error(l(191,e));e.call(t)}function iQ(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)iY(n[e],t)}var iJ=U(null),i0=U(0);function i1(e,t){G(i0,e=lf),G(iJ,t),lf=e|t.baseLanes}function i2(){G(i0,lf),G(iJ,iJ.current)}function i3(){lf=i0.current,V(iJ),V(i0)}var i4=U(null),i6=null;function i5(e){var t=e.alternate;G(at,1&at.current),G(i4,e),null===i6&&(null===t||null!==iJ.current?i6=e:null!==t.memoizedState&&(i6=e))}function i8(e){G(at,at.current),G(i4,e),null===i6&&(i6=e)}function i7(e){22===e.tag?(G(at,at.current),G(i4,e),null===i6&&(i6=e)):i9(e)}function i9(){G(at,at.current),G(i4,i4.current)}function ae(e){V(i4),i6===e&&(i6=null),V(at)}var at=U(0);function an(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||cp(n)||ch(n)))return t}else if(19===t.tag&&("forwards"===t.memoizedProps.revealOrder||"backwards"===t.memoizedProps.revealOrder||"unstable_legacy-backwards"===t.memoizedProps.revealOrder||"together"===t.memoizedProps.revealOrder)){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ar=0,ai=null,aa=null,ao=null,as=!1,al=!1,au=!1,ac=0,ad=0,ap=null,ah=0;function af(){throw Error(l(321))}function ag(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!nF(e[n],t[n]))return!1;return!0}function am(e,t,n,i,a,o){return ar=o,ai=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,j.H=null===e||null===e.memoizedState?oS:ok,au=!1,o=n(i,a),au=!1,al&&(o=ab(t,n,i,a)),ay(e),o}function ay(e){j.H=o_;var t=null!==aa&&null!==aa.next;if(ar=0,ao=aa=ai=null,as=!1,ad=0,ap=null,t)throw Error(l(300));null===e||oB||null!==(e=e.dependencies)&&r7(e)&&(oB=!0)}function ab(e,t,n,i){ai=e;var a=0;do{if(al&&(ap=null),ad=0,al=!1,25<=a)throw Error(l(301));if(a+=1,ao=aa=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}j.H=oT,o=t(n,i)}while(al);return o}function av(){var e=j.H,t=e.useState()[0];return t="function"==typeof t.then?aC(t):t,e=e.useState()[0],(null!==aa?aa.memoizedState:null)!==e&&(ai.flags|=1024),t}function ax(){var e=0!==ac;return ac=0,e}function aw(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function a_(e){if(as){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}as=!1}ar=0,ao=aa=ai=null,al=!1,ad=ac=0,ap=null}function aS(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ao?ai.memoizedState=ao=e:ao=ao.next=e,ao}function ak(){if(null===aa){var e=ai.alternate;e=null!==e?e.memoizedState:null}else e=aa.next;var t=null===ao?ai.memoizedState:ao.next;if(null!==t)ao=t,aa=e;else{if(null===e){if(null===ai.alternate)throw Error(l(467));throw Error(l(310))}e={memoizedState:(aa=e).memoizedState,baseState:aa.baseState,baseQueue:aa.baseQueue,queue:aa.queue,next:null},null===ao?ai.memoizedState=ao=e:ao=ao.next=e}return ao}function aT(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function aC(e){var t=ad;return ad+=1,null===ap&&(ap=[]),e=iI(ap,e,t),t=ai,null===(null===ao?t.memoizedState:ao.next)&&(j.H=null===(t=t.alternate)||null===t.memoizedState?oS:ok),e}function aE(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return aC(e);if(e.$$typeof===k)return ie(e)}throw Error(l(438,String(e)))}function aI(e){var t=null,n=ai.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var i=ai.alternate;null!==i&&null!==(i=i.updateQueue)&&null!=(i=i.memoCache)&&(t={data:i.data.map(function(e){return e.slice()}),index:0})}if(null==t&&(t={data:[],index:0}),null===n&&(n=aT(),ai.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=A;return t.index++,n}function a$(e,t){return"function"==typeof t?t(e):t}function aO(e){return aA(ak(),aa,e)}function aA(e,t,n){var i=e.queue;if(null===i)throw Error(l(311));i.lastRenderedReducer=n;var a=e.baseQueue,o=i.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}t.baseQueue=a=o,i.pending=null}if(o=e.baseState,null===a)e.memoizedState=o;else{t=a.next;var u=s=null,c=null,d=t,p=!1;do{var h=-0x20000001&d.lane;if(h!==d.lane?(ll&h)===h:(ar&h)===h){var f=d.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),h===ip&&(p=!0);else if((ar&f)===f){d=d.next,f===ip&&(p=!0);continue}else h={lane:0,revertLane:d.revertLane,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(u=c=h,s=o):c=c.next=h,ai.lanes|=f,lm|=f;h=d.action,au&&n(o,h),o=d.hasEagerState?d.eagerState:n(o,h)}else f={lane:h,revertLane:d.revertLane,gesture:d.gesture,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(u=c=f,s=o):c=c.next=f,ai.lanes|=h,lm|=h;d=d.next}while(null!==d&&d!==t);if(null===c?s=o:c.next=u,!nF(o,e.memoizedState)&&(oB=!0,p&&null!==(n=ih)))throw n;e.memoizedState=o,e.baseState=s,e.baseQueue=c,i.lastRenderedState=o}return null===a&&(i.lanes=0),[e.memoizedState,i.dispatch]}function aN(e){var t=ak(),n=t.queue;if(null===n)throw Error(l(311));n.lastRenderedReducer=e;var i=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do o=e(o,s.action),s=s.next;while(s!==a);nF(o,t.memoizedState)||(oB=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function aP(e,t,n){var i=ai,a=ak(),o=rV;if(o){if(void 0===n)throw Error(l(407));n=n()}else n=t();var s=!nF((aa||a).memoizedState,n);if(s&&(a.memoizedState=n,oB=!0),a=a.queue,a4(az.bind(null,i,a,e),[e]),a.getSnapshot!==t||s||null!==ao&&1&ao.memoizedState.tag){if(i.flags|=2048,aJ(9,{destroy:void 0},aM.bind(null,i,a,n,t),null),null===lo)throw Error(l(349));o||0!=(127&ar)||aD(i,t,n)}return n}function aD(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ai.updateQueue)?(t=aT(),ai.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function aM(e,t,n,i){t.value=n,t.getSnapshot=i,aj(t)&&aR(e)}function az(e,t,n){return n(function(){aj(t)&&aR(e)})}function aj(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!nF(e,n)}catch(e){return!0}}function aR(e){var t=rd(e,2);null!==t&&lF(t,e,2)}function aL(e){var t=aS();if("function"==typeof e){var n=e;if(e=n(),au){ex(!0);try{n()}finally{ex(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a$,lastRenderedState:e},t}function aF(e,t,n,i){return e.baseState=n,aA(e,aa,"function"==typeof i?i:a$)}function aB(e,t,n,i,a){if(ov(e))throw Error(l(485));if(null!==(e=t.action)){var o={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==j.T?n(!0):o.isTransition=!1,i(o),null===(n=t.pending)?(o.next=t.pending=o,aU(t,o)):(o.next=n.next,t.pending=n.next=o)}}function aU(e,t){var n=t.action,i=t.payload,a=e.state;if(t.isTransition){var o=j.T,s={};j.T=s;try{var l=n(a,i),u=j.S;null!==u&&u(s,l),aV(e,t,l)}catch(n){aH(e,t,n)}finally{null!==o&&null!==s.types&&(o.types=s.types),j.T=o}}else try{o=n(a,i),aV(e,t,o)}catch(n){aH(e,t,n)}}function aV(e,t,n){null!==n&&"object"==typeof n&&"function"==typeof n.then?n.then(function(n){aG(e,t,n)},function(n){return aH(e,t,n)}):aG(e,t,n)}function aG(e,t,n){t.status="fulfilled",t.value=n,aW(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,aU(e,n)))}function aH(e,t,n){var i=e.pending;if(e.pending=null,null!==i){i=i.next;do t.status="rejected",t.reason=n,aW(t),t=t.next;while(t!==i)}e.action=null}function aW(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function aq(e,t){return t}function aK(e,t){if(rV){var n=lo.formState;if(null!==n){e:{var i=ai;if(rV){if(rU){t:{for(var a=rU,o=rH;8!==a.nodeType;)if(!o||null===(a=cg(a.nextSibling))){a=null;break t}a="F!"===(o=a.data)||"F"===o?a:null}if(a){rU=cg(a.nextSibling),i="F!"===a.data;break e}}rq(i)}i=!1}i&&(t=n[0])}}return(n=aS()).memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:aq,lastRenderedState:t},n.queue=i,n=om.bind(null,ai,i),i.dispatch=n,i=aL(!1),o=ob.bind(null,ai,!1,i.queue),i=aS(),a={state:t,dispatch:null,action:e,pending:null},i.queue=a,n=aB.bind(null,ai,a,o,n),a.dispatch=n,i.memoizedState=e,[t,n,!1]}function aX(e){return aZ(ak(),aa,e)}function aZ(e,t,n){if(t=aA(e,t,aq)[0],e=aO(a$)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var i=aC(t)}catch(e){if(e===iS)throw iT;throw e}else i=t;var a=(t=ak()).queue,o=a.dispatch;return n!==t.memoizedState&&(ai.flags|=2048,aJ(9,{destroy:void 0},aY.bind(null,a,n),null)),[i,o,e]}function aY(e,t){e.action=t}function aQ(e){var t=ak(),n=aa;if(null!==n)return aZ(t,n,e);ak(),t=t.memoizedState;var i=(n=ak()).queue.dispatch;return n.memoizedState=e,[t,i,!1]}function aJ(e,t,n,i){return e={tag:e,create:n,deps:i,inst:t,next:null},null===(t=ai.updateQueue)&&(t=aT(),ai.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function a0(){return ak().memoizedState}function a1(e,t,n,i){var a=aS();ai.flags|=e,a.memoizedState=aJ(1|t,{destroy:void 0},n,void 0===i?null:i)}function a2(e,t,n,i){var a=ak();i=void 0===i?null:i;var o=a.memoizedState.inst;null!==aa&&null!==i&&ag(i,aa.memoizedState.deps)?a.memoizedState=aJ(t,o,n,i):(ai.flags|=e,a.memoizedState=aJ(1|t,o,n,i))}function a3(e,t){a1(8390656,8,e,t)}function a4(e,t){a2(2048,8,e,t)}function a6(e){ai.flags|=4;var t=ai.updateQueue;if(null===t)t=aT(),ai.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}function a5(e){var t=ak().memoizedState;return a6({ref:t,nextImpl:e}),function(){if(0!=(2&la))throw Error(l(440));return t.impl.apply(void 0,arguments)}}function a8(e,t){return a2(4,2,e,t)}function a7(e,t){return a2(4,4,e,t)}function a9(e,t){if("function"==typeof t){var n=t(e=e());return function(){"function"==typeof n?n():t(null)}}if(null!=t)return t.current=e=e(),function(){t.current=null}}function oe(e,t,n){n=null!=n?n.concat([e]):null,a2(4,4,a9.bind(null,t,e),n)}function ot(){}function on(e,t){var n=ak();t=void 0===t?null:t;var i=n.memoizedState;return null!==t&&ag(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function or(e,t){var n=ak();t=void 0===t?null:t;var i=n.memoizedState;if(null!==t&&ag(t,i[1]))return i[0];if(i=e(),au){ex(!0);try{e()}finally{ex(!1)}}return n.memoizedState=[i,t],i}function oi(e,t,n){return void 0===n||0!=(0x40000000&ar)&&0==(261930&ll)?e.memoizedState=t:(e.memoizedState=n,e=lL(),ai.lanes|=e,lm|=e,n)}function oa(e,t,n,i){return nF(n,t)?n:null!==iJ.current?(nF(e=oi(e,n,i),t)||(oB=!0),e):0==(42&ar)||0!=(0x40000000&ar)&&0==(261930&ll)?(oB=!0,e.memoizedState=n):(e=lL(),ai.lanes|=e,lm|=e,t)}function oo(e,t,n,i,a){var o=R.p;R.p=0!==o&&8>o?o:8;var s=j.T,l={};j.T=l,ob(e,!1,t,n);try{var u=a(),c=j.S;if(null!==c&&c(l,u),null!==u&&"object"==typeof u&&"function"==typeof u.then){var d=iy(u,i);oy(e,t,d,lR(e))}else oy(e,t,i,lR(e))}catch(n){oy(e,t,{then:function(){},status:"rejected",reason:n},lR())}finally{R.p=o,null!==s&&null!==l.types&&(s.types=l.types),j.T=s}}function os(){}function ol(e,t,n,i){if(5!==e.tag)throw Error(l(476));var a=ou(e).queue;oo(e,a,t,L,null===n?os:function(){return oc(e),n(i)})}function ou(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:a$,lastRenderedState:L},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:a$,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function oc(e){var t=ou(e);null===t.next&&(t=e.alternate.memoizedState),oy(e,t.next.queue,{},lR())}function od(){return ie(c3)}function op(){return ak().memoizedState}function oh(){return ak().memoizedState}function of(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=lR(),i=iH(t,e=iG(n),n);null!==i&&(lF(i,t,n),iW(i,t,n)),t={cache:il()},e.payload=t;return}t=t.return}}function og(e,t,n){var i=lR();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},ov(e)?ox(t,n):null!==(n=rc(e,t,n,i))&&(lF(n,e,i),ow(n,t,i))}function om(e,t,n){oy(e,t,n,lR())}function oy(e,t,n,i){var a={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(ov(e))ox(t,a);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,l=o(s,n);if(a.hasEagerState=!0,a.eagerState=l,nF(l,s))return ru(e,t,a,0),null===lo&&rl(),!1}catch(e){}finally{}if(null!==(n=rc(e,t,a,i)))return lF(n,e,i),ow(n,t,i),!0}return!1}function ob(e,t,n,i){if(i={lane:2,revertLane:uE(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},ov(e)){if(t)throw Error(l(479))}else null!==(t=rc(e,n,i,2))&&lF(t,e,2)}function ov(e){var t=e.alternate;return e===ai||null!==t&&t===ai}function ox(e,t){al=as=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ow(e,t,n){if(0!=(4194048&n)){var i=t.lanes;i&=e.pendingLanes,t.lanes=n|=i,ej(e,n)}}var o_={readContext:ie,use:aE,useCallback:af,useContext:af,useEffect:af,useImperativeHandle:af,useLayoutEffect:af,useInsertionEffect:af,useMemo:af,useReducer:af,useRef:af,useState:af,useDebugValue:af,useDeferredValue:af,useTransition:af,useSyncExternalStore:af,useId:af,useHostTransitionStatus:af,useFormState:af,useActionState:af,useOptimistic:af,useMemoCache:af,useCacheRefresh:af};o_.useEffectEvent=af;var oS={readContext:ie,use:aE,useCallback:function(e,t){return aS().memoizedState=[e,void 0===t?null:t],e},useContext:ie,useEffect:a3,useImperativeHandle:function(e,t,n){n=null!=n?n.concat([e]):null,a1(4194308,4,a9.bind(null,t,e),n)},useLayoutEffect:function(e,t){return a1(4194308,4,e,t)},useInsertionEffect:function(e,t){a1(4,2,e,t)},useMemo:function(e,t){var n=aS();t=void 0===t?null:t;var i=e();if(au){ex(!0);try{e()}finally{ex(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=aS();if(void 0!==n){var a=n(t);if(au){ex(!0);try{n(t)}finally{ex(!1)}}}else a=t;return i.memoizedState=i.baseState=a,i.queue=e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},e=e.dispatch=og.bind(null,ai,e),[i.memoizedState,e]},useRef:function(e){return aS().memoizedState={current:e}},useState:function(e){var t=(e=aL(e)).queue,n=om.bind(null,ai,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:ot,useDeferredValue:function(e,t){return oi(aS(),e,t)},useTransition:function(){var e=aL(!1);return e=oo.bind(null,ai,e.queue,!0,!1),aS().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=ai,a=aS();if(rV){if(void 0===n)throw Error(l(407));n=n()}else{if(n=t(),null===lo)throw Error(l(349));0!=(127&ll)||aD(i,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,a3(az.bind(null,i,o,e),[e]),i.flags|=2048,aJ(9,{destroy:void 0},aM.bind(null,i,o,n,t),null),n},useId:function(){var e=aS(),t=lo.identifierPrefix;if(rV){var n=rM,i=rD;t="_"+t+"R_"+(n=(i&~(1<<32-ew(i)-1)).toString(32)+n),0<(n=ac++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=ah++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:od,useFormState:aK,useActionState:aK,useOptimistic:function(e){var t=aS();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ob.bind(null,ai,!0,n),n.dispatch=t,[e,t]},useMemoCache:aI,useCacheRefresh:function(){return aS().memoizedState=of.bind(null,ai)},useEffectEvent:function(e){var t=aS(),n={impl:e};return t.memoizedState=n,function(){if(0!=(2&la))throw Error(l(440));return n.impl.apply(void 0,arguments)}}},ok={readContext:ie,use:aE,useCallback:on,useContext:ie,useEffect:a4,useImperativeHandle:oe,useInsertionEffect:a8,useLayoutEffect:a7,useMemo:or,useReducer:aO,useRef:a0,useState:function(){return aO(a$)},useDebugValue:ot,useDeferredValue:function(e,t){return oa(ak(),aa.memoizedState,e,t)},useTransition:function(){var e=aO(a$)[0],t=ak().memoizedState;return["boolean"==typeof e?e:aC(e),t]},useSyncExternalStore:aP,useId:op,useHostTransitionStatus:od,useFormState:aX,useActionState:aX,useOptimistic:function(e,t){return aF(ak(),aa,e,t)},useMemoCache:aI,useCacheRefresh:oh};ok.useEffectEvent=a5;var oT={readContext:ie,use:aE,useCallback:on,useContext:ie,useEffect:a4,useImperativeHandle:oe,useInsertionEffect:a8,useLayoutEffect:a7,useMemo:or,useReducer:aN,useRef:a0,useState:function(){return aN(a$)},useDebugValue:ot,useDeferredValue:function(e,t){var n=ak();return null===aa?oi(n,e,t):oa(n,aa.memoizedState,e,t)},useTransition:function(){var e=aN(a$)[0],t=ak().memoizedState;return["boolean"==typeof e?e:aC(e),t]},useSyncExternalStore:aP,useId:op,useHostTransitionStatus:od,useFormState:aQ,useActionState:aQ,useOptimistic:function(e,t){var n=ak();return null!==aa?aF(n,aa,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:aI,useCacheRefresh:oh};function oC(e,t,n,i){n=null==(n=n(i,t=e.memoizedState))?t:m({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}oT.useEffectEvent=a5;var oE={enqueueSetState:function(e,t,n){e=e._reactInternals;var i=lR(),a=iG(i);a.payload=t,null!=n&&(a.callback=n),null!==(t=iH(e,a,i))&&(lF(t,e,i),iW(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=lR(),a=iG(i);a.tag=1,a.payload=t,null!=n&&(a.callback=n),null!==(t=iH(e,a,i))&&(lF(t,e,i),iW(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=lR(),i=iG(n);i.tag=2,null!=t&&(i.callback=t),null!==(t=iH(e,i,n))&&(lF(t,e,n),iW(t,e,n))}};function oI(e,t,n,i,a,o,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,o,s):!t.prototype||!t.prototype.isPureReactComponent||!nB(n,i)||!nB(a,o)}function o$(e,t,n,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&oE.enqueueReplaceState(t,t.state,null)}function oO(e,t){var n=t;if("ref"in t)for(var i in n={},t)"ref"!==i&&(n[i]=t[i]);if(e=e.defaultProps)for(var a in n===t&&(n=m({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}function oA(e){ri(e)}function oN(e){console.error(e)}function oP(e){ri(e)}function oD(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(e){setTimeout(function(){throw e})}}function oM(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(e){setTimeout(function(){throw e})}}function oz(e,t,n){return(n=iG(n)).tag=3,n.payload={element:null},n.callback=function(){oD(e,t)},n}function oj(e){return(e=iG(e)).tag=3,e}function oR(e,t,n,i){var a=n.type.getDerivedStateFromError;if("function"==typeof a){var o=i.value;e.payload=function(){return a(o)},e.callback=function(){oM(t,n,i)}}var s=n.stateNode;null!==s&&"function"==typeof s.componentDidCatch&&(e.callback=function(){oM(t,n,i),"function"!=typeof a&&(null===lI?lI=new Set([this]):lI.add(this));var e=i.stack;this.componentDidCatch(i.value,{componentStack:null!==e?e:""})})}function oL(e,t,n,i,a){if(n.flags|=32768,null!==i&&"object"==typeof i&&"function"==typeof i.then){if(null!==(t=n.alternate)&&r8(t,n,a,!0),null!==(n=i4.current)){switch(n.tag){case 31:case 13:return null===i6?lQ():null===n.alternate&&0===lg&&(lg=3),n.flags&=-257,n.flags|=65536,n.lanes=a,i===iC?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([i]):t.add(i),us(e,i,a)),!1;case 22:return n.flags|=65536,i===iC?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([i]):n.add(i),us(e,i,a)),!1}throw Error(l(435,n.tag))}return us(e,i,a),lQ(),!1}if(rV)return null!==(t=i4.current)?(0==(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=a,i!==rW&&rJ(rC(e=Error(l(422),{cause:i}),n))):(i!==rW&&rJ(rC(t=Error(l(423),{cause:i}),n)),e=e.current.alternate,e.flags|=65536,a&=-a,e.lanes|=a,i=rC(i,n),a=oz(e.stateNode,i,a),iq(e,a),4!==lg&&(lg=2)),!1;var o=Error(l(520),{cause:i});if(o=rC(o,n),null===lw?lw=[o]:lw.push(o),4!==lg&&(lg=2),null===t)return!0;i=rC(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=a&-a,n.lanes|=e,e=oz(n.stateNode,i,e),iq(n,e),!1;case 1:if(t=n.type,o=n.stateNode,0==(128&n.flags)&&("function"==typeof t.getDerivedStateFromError||null!==o&&"function"==typeof o.componentDidCatch&&(null===lI||!lI.has(o))))return n.flags|=65536,a&=-a,n.lanes|=a,oR(a=oj(a),e,n,i),iq(n,a),!1}n=n.return}while(null!==n);return!1}var oF=Error(l(461)),oB=!1;function oU(e,t,n,i){t.child=null===e?iF(t,null,n,i):iL(t,e.child,n,i)}function oV(e,t,n,i,a){n=n.render;var o=t.ref;if("ref"in i){var s={};for(var l in i)"ref"!==l&&(s[l]=i[l])}else s=i;return(r9(t),i=am(e,t,n,s,o,a),l=ax(),null===e||oB)?(rV&&l&&rR(t),t.flags|=1,oU(e,t,i,a),t.child):(aw(e,t,a),sr(e,t,a))}function oG(e,t,n,i,a){if(null===e){var o=n.type;return"function"!=typeof o||ry(o)||void 0!==o.defaultProps||null!==n.compare?((e=rx(n.type,null,i,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,oH(e,t,o,i,a))}if(o=e.child,!si(e,a)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:nB)(s,i)&&e.ref===t.ref)return sr(e,t,a)}return t.flags|=1,(e=rb(o,i)).ref=t.ref,e.return=t,t.child=e}function oH(e,t,n,i,a){if(null!==e){var o=e.memoizedProps;if(nB(o,i)&&e.ref===t.ref)if(oB=!1,t.pendingProps=i=o,!si(e,a))return t.lanes=e.lanes,sr(e,t,a);else 0!=(131072&e.flags)&&(oB=!0)}return oJ(e,t,n,i,a)}function oW(e,t,n,i){var a=i.children,o=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===i.mode){if(0!=(128&t.flags)){if(o=null!==o?o.baseLanes|n:n,null!==e){for(a=0,i=t.child=e.child;null!==i;)a=a|i.lanes|i.childLanes,i=i.sibling;i=a&~o}else i=0,t.child=null;return oK(e,t,o,n,i)}if(0==(0x20000000&n))return i=t.lanes=0x20000000,oK(e,t,null!==o?o.baseLanes|n:n,n,i);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&iw(t,null!==o?o.cachePool:null),null!==o?i1(t,o):i2(),i7(t)}else null!==o?(iw(t,o.cachePool),i1(t,o),i9(t),t.memoizedState=null):(null!==e&&iw(t,null),i2(),i9(t));return oU(e,t,a,n),t.child}function oq(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function oK(e,t,n,i,a){var o=ix();return t.memoizedState={baseLanes:n,cachePool:o=null===o?null:{parent:is._currentValue,pool:o}},null!==e&&iw(t,null),i2(),i7(t),null!==e&&r8(e,t,i,!0),t.childLanes=a,null}function oX(e,t){return(t=o7({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function oZ(e,t,n){return iL(t,e.child,null,n),e=oX(t,t.pendingProps),e.flags|=2,ae(t),t.memoizedState=null,e}function oY(e,t,n){var i=t.pendingProps,a=0!=(128&t.flags);if(t.flags&=-129,null===e){if(rV){if("hidden"===i.mode)return e=oX(t,i),t.lanes=0x20000000,oq(null,e);if(i8(t),(e=rU)?null!==(e=null!==(e=cd(e,rH))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==rP?{id:rD,overflow:rM}:null,retryLane:0x20000000,hydrationErrors:null},(n=rS(e)).return=t,t.child=n,rB=t,rU=null):e=null,null===e)throw rq(t);return t.lanes=0x20000000,null}return oX(t,i)}var o=e.memoizedState;if(null!==o){var s=o.dehydrated;if(i8(t),a)if(256&t.flags)t.flags&=-257,t=oZ(e,t,n);else if(null!==t.memoizedState)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(oB||r8(e,t,n,!1),a=0!=(n&e.childLanes),oB||a){if(null!==(i=lo)&&0!==(s=eR(i,n))&&s!==o.retryLane)throw o.retryLane=s,rd(e,s),lF(i,e,s),oF;lQ(),t=oZ(e,t,n)}else e=o.treeContext,rU=cg(s.nextSibling),rB=t,rV=!0,rG=null,rH=!1,null!==e&&rF(t,e),t=oX(t,i),t.flags|=4096;return t}return(e=rb(e.child,{mode:i.mode,children:i.children})).ref=t.ref,t.child=e,e.return=t,e}function oQ(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof n&&"object"!=typeof n)throw Error(l(284));(null===e||e.ref!==n)&&(t.flags|=4194816)}}function oJ(e,t,n,i,a){return(r9(t),n=am(e,t,n,i,void 0,a),i=ax(),null===e||oB)?(rV&&i&&rR(t),t.flags|=1,oU(e,t,n,a),t.child):(aw(e,t,a),sr(e,t,a))}function o0(e,t,n,i,a,o){return(r9(t),t.updateQueue=null,n=ab(t,i,n,a),ay(e),i=ax(),null===e||oB)?(rV&&i&&rR(t),t.flags|=1,oU(e,t,n,o),t.child):(aw(e,t,o),sr(e,t,o))}function o1(e,t,n,i,a){if(r9(t),null===t.stateNode){var o=rf,s=n.contextType;"object"==typeof s&&null!==s&&(o=ie(s)),t.memoizedState=null!==(o=new n(i,o)).state&&void 0!==o.state?o.state:null,o.updater=oE,t.stateNode=o,o._reactInternals=t,(o=t.stateNode).props=i,o.state=t.memoizedState,o.refs={},iU(t),s=n.contextType,o.context="object"==typeof s&&null!==s?ie(s):rf,o.state=t.memoizedState,"function"==typeof(s=n.getDerivedStateFromProps)&&(oC(t,n,s,i),o.state=t.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(s=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),s!==o.state&&oE.enqueueReplaceState(o,o.state,null),iZ(t,i,o,a),iX(),o.state=t.memoizedState),"function"==typeof o.componentDidMount&&(t.flags|=4194308),i=!0}else if(null===e){o=t.stateNode;var l=t.memoizedProps,u=oO(n,l);o.props=u;var c=o.context,d=n.contextType;s=rf,"object"==typeof d&&null!==d&&(s=ie(d));var p=n.getDerivedStateFromProps;d="function"==typeof p||"function"==typeof o.getSnapshotBeforeUpdate,l=t.pendingProps!==l,d||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(l||c!==s)&&o$(t,o,i,s),iB=!1;var h=t.memoizedState;o.state=h,iZ(t,i,o,a),iX(),c=t.memoizedState,l||h!==c||iB?("function"==typeof p&&(oC(t,n,p,i),c=t.memoizedState),(u=iB||oI(t,n,u,i,h,c,s))?(d||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.flags|=4194308)):("function"==typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=c),o.props=i,o.state=c,o.context=s,i=u):("function"==typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,iV(e,t),d=oO(n,s=t.memoizedProps),o.props=d,p=t.pendingProps,h=o.context,c=n.contextType,u=rf,"object"==typeof c&&null!==c&&(u=ie(c)),(c="function"==typeof(l=n.getDerivedStateFromProps)||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==p||h!==u)&&o$(t,o,i,u),iB=!1,h=t.memoizedState,o.state=h,iZ(t,i,o,a),iX();var f=t.memoizedState;s!==p||h!==f||iB||null!==e&&null!==e.dependencies&&r7(e.dependencies)?("function"==typeof l&&(oC(t,n,l,i),f=t.memoizedState),(d=iB||oI(t,n,d,i,h,f,u)||null!==e&&null!==e.dependencies&&r7(e.dependencies))?(c||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(i,f,u),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,f,u)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),o.props=i,o.state=f,o.context=u,i=d):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return o=i,oQ(e,t),i=0!=(128&t.flags),o||i?(o=t.stateNode,n=i&&"function"!=typeof n.getDerivedStateFromError?null:o.render(),t.flags|=1,null!==e&&i?(t.child=iL(t,e.child,null,a),t.child=iL(t,null,n,a)):oU(e,t,n,a),t.memoizedState=o.state,e=t.child):e=sr(e,t,a),e}function o2(e,t,n,i){return rY(),t.flags|=256,oU(e,t,n,i),t.child}var o3={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function o4(e){return{baseLanes:e,cachePool:i_()}}function o6(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=lv),e}function o5(e,t,n){var i,a=t.pendingProps,o=!1,s=0!=(128&t.flags);if((i=s)||(i=(null===e||null!==e.memoizedState)&&0!=(2&at.current)),i&&(o=!0,t.flags&=-129),i=0!=(32&t.flags),t.flags&=-33,null===e){if(rV){if(o?i5(t):i9(t),(e=rU)?null!==(e=null!==(e=cd(e,rH))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==rP?{id:rD,overflow:rM}:null,retryLane:0x20000000,hydrationErrors:null},(n=rS(e)).return=t,t.child=n,rB=t,rU=null):e=null,null===e)throw rq(t);return ch(e)?t.lanes=32:t.lanes=0x20000000,null}var u=a.children;return(a=a.fallback,o)?(i9(t),u=o7({mode:"hidden",children:u},o=t.mode),a=rw(a,o,n,null),u.return=t,a.return=t,u.sibling=a,t.child=u,(a=t.child).memoizedState=o4(n),a.childLanes=o6(e,i,n),t.memoizedState=o3,oq(null,a)):(i5(t),o8(t,u))}var c=e.memoizedState;if(null!==c&&null!==(u=c.dehydrated)){if(s)256&t.flags?(i5(t),t.flags&=-257,t=o9(e,t,n)):null!==t.memoizedState?(i9(t),t.child=e.child,t.flags|=128,t=null):(i9(t),u=a.fallback,o=t.mode,a=o7({mode:"visible",children:a.children},o),u=rw(u,o,n,null),u.flags|=2,a.return=t,u.return=t,a.sibling=u,t.child=a,iL(t,e.child,null,n),(a=t.child).memoizedState=o4(n),a.childLanes=o6(e,i,n),t.memoizedState=o3,t=oq(null,a));else if(i5(t),ch(u)){if(i=u.nextSibling&&u.nextSibling.dataset)var d=i.dgst;i=d,(a=Error(l(419))).stack="",a.digest=i,rJ({value:a,source:null,stack:null}),t=o9(e,t,n)}else if(oB||r8(e,t,n,!1),i=0!=(n&e.childLanes),oB||i){if(null!==(i=lo)&&0!==(a=eR(i,n))&&a!==c.retryLane)throw c.retryLane=a,rd(e,a),lF(i,e,a),oF;cp(u)||lQ(),t=o9(e,t,n)}else cp(u)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,rU=cg(u.nextSibling),rB=t,rV=!0,rG=null,rH=!1,null!==e&&rF(t,e),t=o8(t,a.children),t.flags|=4096);return t}return o?(i9(t),u=a.fallback,o=t.mode,d=(c=e.child).sibling,(a=rb(c,{mode:"hidden",children:a.children})).subtreeFlags=0x3e00000&c.subtreeFlags,null!==d?u=rb(d,u):(u=rw(u,o,n,null),u.flags|=2),u.return=t,a.return=t,a.sibling=u,t.child=a,oq(null,a),a=t.child,null===(u=e.child.memoizedState)?u=o4(n):(null!==(o=u.cachePool)?(c=is._currentValue,o=o.parent!==c?{parent:c,pool:c}:o):o=i_(),u={baseLanes:u.baseLanes|n,cachePool:o}),a.memoizedState=u,a.childLanes=o6(e,i,n),t.memoizedState=o3,oq(e.child,a)):(i5(t),e=(n=e.child).sibling,(n=rb(n,{mode:"visible",children:a.children})).return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n,t.memoizedState=null,n)}function o8(e,t){return(t=o7({mode:"visible",children:t},e.mode)).return=e,e.child=t}function o7(e,t){return(e=rm(22,e,null,t)).lanes=0,e}function o9(e,t,n){return iL(t,e.child,null,n),e=o8(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function se(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),r6(e.return,t,n)}function st(e,t,n,i,a,o){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:a,treeForkCount:o}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=a,s.treeForkCount=o)}function sn(e,t,n){var i=t.pendingProps,a=i.revealOrder,o=i.tail;i=i.children;var s=at.current,l=0!=(2&s);if(l?(s=1&s|2,t.flags|=128):s&=1,G(at,s),oU(e,t,i,n),i=rV?rO:0,!l&&null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&se(e,n,t);else if(19===e.tag)se(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(a){case"forwards":for(a=null,n=t.child;null!==n;)null!==(e=n.alternate)&&null===an(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),st(t,!1,a,n,o,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===an(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}st(t,!0,n,null,o,i);break;case"together":st(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function sr(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),lm|=t.lanes,0==(n&t.childLanes)){if(null===e)return null;else if(r8(e,t,n,!1),0==(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(l(153));if(null!==t.child){for(n=rb(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=rb(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function si(e,t){return 0!=(e.lanes&t)||!!(null!==(e=e.dependencies)&&r7(e))}function sa(e,t,n){switch(t.tag){case 3:X(t,t.stateNode.containerInfo),r3(t,is,e.memoizedState.cache),rY();break;case 27:case 5:Y(t);break;case 4:X(t,t.stateNode.containerInfo);break;case 10:r3(t,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,i8(t),null;break;case 13:var i=t.memoizedState;if(null!==i){if(null!==i.dehydrated)return i5(t),t.flags|=128,null;if(0!=(n&t.child.childLanes))return o5(e,t,n);return i5(t),null!==(e=sr(e,t,n))?e.sibling:null}i5(t);break;case 19:var a=0!=(128&e.flags);if((i=0!=(n&t.childLanes))||(r8(e,t,n,!1),i=0!=(n&t.childLanes)),a){if(i)return sn(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),G(at,at.current),!i)return null;break;case 22:return t.lanes=0,oW(e,t,n,t.pendingProps);case 24:r3(t,is,e.memoizedState.cache)}return sr(e,t,n)}function so(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)oB=!0;else{if(!si(e,n)&&0==(128&t.flags))return oB=!1,sa(e,t,n);oB=0!=(131072&e.flags)}else oB=!1,rV&&0!=(1048576&t.flags)&&rj(t,rO,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=i$(t.elementType),t.type=e,"function"==typeof e)ry(e)?(i=oO(e,i),t.tag=1,t=o1(null,t,e,i,n)):(t.tag=0,t=oJ(null,t,e,i,n));else{if(null!=e){var a=e.$$typeof;if(a===T){t.tag=11,t=oV(null,t,e,i,n);break e}if(a===I){t.tag=14,t=oG(null,t,e,i,n);break e}}throw Error(l(306,t=M(e)||e,""))}}return t;case 0:return oJ(e,t,t.type,t.pendingProps,n);case 1:return a=oO(i=t.type,t.pendingProps),o1(e,t,i,a,n);case 3:e:{if(X(t,t.stateNode.containerInfo),null===e)throw Error(l(387));i=t.pendingProps;var o=t.memoizedState;a=o.element,iV(e,t),iZ(t,i,null,n);var s=t.memoizedState;if(r3(t,is,i=s.cache),i!==o.cache&&r5(t,[is],n,!0),iX(),i=s.element,o.isDehydrated)if(o={element:i,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=o2(e,t,i,n);break e}else if(i!==a){rJ(a=rC(Error(l(424)),t)),t=o2(e,t,i,n);break e}else for(rU=cg((e=9===(e=t.stateNode.containerInfo).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e).firstChild),rB=t,rV=!0,rG=null,rH=!0,n=iF(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling;else{if(rY(),i===a){t=sr(e,t,n);break e}oU(e,t,i,n)}t=t.child}return t;case 26:return oQ(e,t),null===e?(n=cD(t.type,null,t.pendingProps,null))?t.memoizedState=n:rV||(n=t.type,e=t.pendingProps,(i=u4(q.current).createElement(n))[eG]=t,i[eH]=e,uQ(i,n,e),e3(i),t.stateNode=i):t.memoizedState=cD(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Y(t),null===e&&rV&&(i=t.stateNode=cv(t.type,t.pendingProps,q.current),rB=t,rH=!0,a=rU,ca(t.type)?(cm=a,rU=cg(i.firstChild)):rU=a),oU(e,t,t.pendingProps.children,n),oQ(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&rV&&((a=i=rU)&&(null!==(i=cu(i,t.type,t.pendingProps,rH))?(t.stateNode=i,rB=t,rU=cg(i.firstChild),rH=!1,a=!0):a=!1),a||rq(t)),Y(t),a=t.type,o=t.pendingProps,s=null!==e?e.memoizedProps:null,i=o.children,u8(a,o)?i=null:null!==s&&u8(a,s)&&(t.flags|=32),null!==t.memoizedState&&(c3._currentValue=a=am(e,t,av,null,null,n)),oQ(e,t),oU(e,t,i,n),t.child;case 6:return null===e&&rV&&((e=n=rU)&&(null!==(n=cc(n,t.pendingProps,rH))?(t.stateNode=n,rB=t,rU=null,e=!0):e=!1),e||rq(t)),null;case 13:return o5(e,t,n);case 4:return X(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=iL(t,null,i,n):oU(e,t,i,n),t.child;case 11:return oV(e,t,t.type,t.pendingProps,n);case 7:return oU(e,t,t.pendingProps,n),t.child;case 8:case 12:return oU(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,r3(t,t.type,i.value),oU(e,t,i.children,n),t.child;case 9:return a=t.type._context,i=t.pendingProps.children,r9(t),i=i(a=ie(a)),t.flags|=1,oU(e,t,i,n),t.child;case 14:return oG(e,t,t.type,t.pendingProps,n);case 15:return oH(e,t,t.type,t.pendingProps,n);case 19:return sn(e,t,n);case 31:return oY(e,t,n);case 22:return oW(e,t,n,t.pendingProps);case 24:return r9(t),i=ie(is),null===e?(null===(a=ix())&&(a=lo,o=il(),a.pooledCache=o,o.refCount++,null!==o&&(a.pooledCacheLanes|=n),a=o),t.memoizedState={parent:i,cache:a},iU(t),r3(t,is,a)):(0!=(e.lanes&n)&&(iV(e,t),iZ(t,null,null,n),iX()),a=e.memoizedState,o=t.memoizedState,a.parent!==i?(a={parent:i,cache:i},t.memoizedState=a,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=a),r3(t,is,i)):(r3(t,is,i=o.cache),i!==a.cache&&r5(t,[is],n,!0))),oU(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function ss(e){e.flags|=4}function sl(e,t,n,i,a){if((t=0!=(32&e.mode))&&(t=!1),t){if(e.flags|=0x1000000,(0x13ffff40&a)===a)if(e.stateNode.complete)e.flags|=8192;else if(lX())e.flags|=8192;else throw iO=iC,ik}else e.flags&=-0x1000001}function su(e,t){if("stylesheet"!==t.type||0!=(4&t.state.loading))e.flags&=-0x1000001;else if(e.flags|=0x1000000,!cX(t))if(lX())e.flags|=8192;else throw iO=iC,ik}function sc(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?eN():0x20000000,e.lanes|=t,lx|=t)}function sd(e,t){if(!rV)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function sp(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,i|=0x3e00000&a.subtreeFlags,i|=0x3e00000&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,i|=a.subtreeFlags,i|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function sh(e,t,n){var i=t.pendingProps;switch(rL(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return sp(t),null;case 3:return n=t.stateNode,i=null,null!==e&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),r4(is),Z(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(null===e||null===e.child)&&(rZ(t)?ss(t):null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,rQ())),sp(t),null;case 26:var a=t.type,o=t.memoizedState;return null===e?(ss(t),null!==o?(sp(t),su(t,o)):(sp(t),sl(t,a,null,i,n))):o?o!==e.memoizedState?(ss(t),sp(t),su(t,o)):(sp(t),t.flags&=-0x1000001):((e=e.memoizedProps)!==i&&ss(t),sp(t),sl(t,a,e,i,n)),null;case 27:if(Q(t),n=q.current,a=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==i&&ss(t);else{if(!i){if(null===t.stateNode)throw Error(l(166));return sp(t),null}e=H.current,rZ(t)?rK(t,e):(t.stateNode=e=cv(a,i,n),ss(t))}return sp(t),null;case 5:if(Q(t),a=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==i&&ss(t);else{if(!i){if(null===t.stateNode)throw Error(l(166));return sp(t),null}if(o=H.current,rZ(t))rK(t,o);else{var s=u4(q.current);switch(o){case 1:o=s.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:o=s.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":o=s.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":o=s.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":(o=s.createElement("div")).innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o="string"==typeof i.is?s.createElement("select",{is:i.is}):s.createElement("select"),i.multiple?o.multiple=!0:i.size&&(o.size=i.size);break;default:o="string"==typeof i.is?s.createElement(a,{is:i.is}):s.createElement(a)}}o[eG]=t,o[eH]=i;e:for(s=t.child;null!==s;){if(5===s.tag||6===s.tag)o.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(t.stateNode=o,uQ(o,a,i),a){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break;case"img":i=!0;break;default:i=!1}i&&ss(t)}}return sp(t),sl(t,t.type,null===e?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==i&&ss(t);else{if("string"!=typeof i&&null===t.stateNode)throw Error(l(166));if(e=q.current,rZ(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,null!==(a=rB))switch(a.tag){case 27:case 5:i=a.memoizedProps}e[eG]=t,(e=!!(e.nodeValue===n||null!==i&&!0===i.suppressHydrationWarning||uX(e.nodeValue,n)))||rq(t,!0)}else(e=u4(e).createTextNode(i))[eG]=t,t.stateNode=e}return sp(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(i=rZ(t),null!==n){if(null===e){if(!i)throw Error(l(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(l(557));e[eG]=t}else rY(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;sp(t),e=!1}else n=rQ(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e){if(256&t.flags)return ae(t),t;return ae(t),null}if(0!=(128&t.flags))throw Error(l(558))}return sp(t),null;case 13:if(i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(a=rZ(t),null!==i&&null!==i.dehydrated){if(null===e){if(!a)throw Error(l(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(l(317));a[eG]=t}else rY(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;sp(t),a=!1}else a=rQ(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a){if(256&t.flags)return ae(t),t;return ae(t),null}}if(ae(t),0!=(128&t.flags))return t.lanes=n,t;return n=null!==i,e=null!==e&&null!==e.memoizedState,n&&(i=t.child,a=null,null!==i.alternate&&null!==i.alternate.memoizedState&&null!==i.alternate.memoizedState.cachePool&&(a=i.alternate.memoizedState.cachePool.pool),o=null,null!==i.memoizedState&&null!==i.memoizedState.cachePool&&(o=i.memoizedState.cachePool.pool),o!==a&&(i.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),sc(t,t.updateQueue),sp(t),null;case 4:return Z(),null===e&&uL(t.stateNode.containerInfo),sp(t),null;case 10:return r4(t.type),sp(t),null;case 19:if(V(at),null===(i=t.memoizedState))return sp(t),null;if(a=0!=(128&t.flags),null===(o=i.rendering))if(a)sd(i,!1);else{if(0!==lg||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=an(e))){for(t.flags|=128,sd(i,!1),t.updateQueue=e=o.updateQueue,sc(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)rv(n,e),n=n.sibling;return G(at,1&at.current|2),rV&&rz(t,i.treeForkCount),t.child}e=e.sibling}null!==i.tail&&eu()>lC&&(t.flags|=128,a=!0,sd(i,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=an(o))){if(t.flags|=128,a=!0,t.updateQueue=e=e.updateQueue,sc(t,e),sd(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!rV)return sp(t),null}else 2*eu()-i.renderingStartTime>lC&&0x20000000!==n&&(t.flags|=128,a=!0,sd(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=i.last)?e.sibling=o:t.child=o,i.last=o)}if(null!==i.tail)return e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=eu(),e.sibling=null,n=at.current,G(at,a?1&n|2:1&n),rV&&rz(t,i.treeForkCount),e;return sp(t),null;case 22:case 23:return ae(t),i3(),i=null!==t.memoizedState,null!==e?null!==e.memoizedState!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?0!=(0x20000000&n)&&0==(128&t.flags)&&(sp(t),6&t.subtreeFlags&&(t.flags|=8192)):sp(t),null!==(n=t.updateQueue)&&sc(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),i=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),null!==e&&V(iv),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),r4(is),sp(t),null;case 25:case 30:return null}throw Error(l(156,t.tag))}function sf(e,t){switch(rL(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return r4(is),Z(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Q(t),null;case 31:if(null!==t.memoizedState){if(ae(t),null===t.alternate)throw Error(l(340));rY()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(ae(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(l(340));rY()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return V(at),null;case 4:return Z(),null;case 10:return r4(t.type),null;case 22:case 23:return ae(t),i3(),null!==e&&V(iv),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return r4(is),null;default:return null}}function sg(e,t){switch(rL(t),t.tag){case 3:r4(is),Z();break;case 26:case 27:case 5:Q(t);break;case 4:Z();break;case 31:null!==t.memoizedState&&ae(t);break;case 13:ae(t);break;case 19:V(at);break;case 10:r4(t.type);break;case 22:case 23:ae(t),i3(),null!==e&&V(iv);break;case 24:r4(is)}}function sm(e,t){try{var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var a=i.next;n=a;do{if((n.tag&e)===e){i=void 0;var o=n.create;n.inst.destroy=i=o()}n=n.next}while(n!==a)}}catch(e){uo(t,t.return,e)}}function sy(e,t,n){try{var i=t.updateQueue,a=null!==i?i.lastEffect:null;if(null!==a){var o=a.next;i=o;do{if((i.tag&e)===e){var s=i.inst,l=s.destroy;if(void 0!==l){s.destroy=void 0,a=t;var u=n,c=l;try{c()}catch(e){uo(a,u,e)}}}i=i.next}while(i!==o)}}catch(e){uo(t,t.return,e)}}function sb(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{iQ(t,n)}catch(t){uo(e,e.return,t)}}}function sv(e,t,n){n.props=oO(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(n){uo(e,t,n)}}function sx(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;default:i=e.stateNode}"function"==typeof n?e.refCleanup=n(i):n.current=i}}catch(n){uo(e,t,n)}}function sw(e,t){var n=e.ref,i=e.refCleanup;if(null!==n)if("function"==typeof i)try{i()}catch(n){uo(e,t,n)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof n)try{n(null)}catch(n){uo(e,t,n)}else n.current=null}function s_(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(t){uo(e,e.return,t)}}function sS(e,t,n){try{var i=e.stateNode;uJ(i,e.type,n,t),i[eH]=t}catch(t){uo(e,e.return,t)}}function sk(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&ca(e.type)||4===e.tag}function sT(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&ca(e.type)||2&e.flags||null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function sC(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=tE));else if(4!==i&&(27===i&&ca(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(sC(e,t,n),e=e.sibling;null!==e;)sC(e,t,n),e=e.sibling}function sE(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&(27===i&&ca(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(sE(e,t,n),e=e.sibling;null!==e;)sE(e,t,n),e=e.sibling}function sI(e){var t=e.stateNode,n=e.memoizedProps;try{for(var i=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);uQ(t,i,n),t[eG]=e,t[eH]=n}catch(t){uo(e,e.return,t)}}var s$=!1,sO=!1,sA=!1,sN="function"==typeof WeakSet?WeakSet:Set,sP=null;function sD(e,t){if(e=e.containerInfo,u2=dn,nW(e=nH(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var a,o=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch(e){n=null;break e}var u=0,c=-1,d=-1,p=0,h=0,f=e,g=null;t:for(;;){for(;f!==n||0!==o&&3!==f.nodeType||(c=u+o),f!==s||0!==i&&3!==f.nodeType||(d=u+i),3===f.nodeType&&(u+=f.nodeValue.length),null!==(a=f.firstChild);)g=f,f=a;for(;;){if(f===e)break t;if(g===n&&++p===o&&(c=u),g===s&&++h===i&&(d=u),null!==(a=f.nextSibling))break;g=(f=g).parentNode}f=a}n=-1===c||-1===d?null:{start:c,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(u3={focusedElem:e,selectionRange:n},dn=!1,sP=t;null!==sP;)if(e=(t=sP).child,0!=(1028&t.subtreeFlags)&&null!==e)e.return=t,sP=e;else for(;null!==sP;){switch(s=(t=sP).alternate,e=t.flags,t.tag){case 0:if(0!=(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(o=e[n]).ref.impl=o.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!=(1024&e)&&null!==s){e=void 0,n=t,o=s.memoizedProps,s=s.memoizedState,i=n.stateNode;try{var m=oO(n.type,o);e=i.getSnapshotBeforeUpdate(m,s),i.__reactInternalSnapshotBeforeUpdate=e}catch(e){uo(n,n.return,e)}}break;case 3:if(0!=(1024&e)){if(9===(n=(e=t.stateNode.containerInfo).nodeType))cl(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":cl(e);break;default:e.textContent=""}}break;default:if(0!=(1024&e))throw Error(l(163))}if(null!==(e=t.sibling)){e.return=t.return,sP=e;break}sP=t.return}}function sM(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:sZ(e,n),4&i&&sm(5,n);break;case 1:if(sZ(e,n),4&i)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(e){uo(n,n.return,e)}else{var a=oO(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(e){uo(n,n.return,e)}}64&i&&sb(n),512&i&&sx(n,n.return);break;case 3:if(sZ(e,n),64&i&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{iQ(e,t)}catch(e){uo(n,n.return,e)}}break;case 27:null===t&&4&i&&sI(n);case 26:case 5:sZ(e,n),null===t&&4&i&&s_(n),512&i&&sx(n,n.return);break;case 12:default:sZ(e,n);break;case 31:sZ(e,n),4&i&&sB(e,n);break;case 13:sZ(e,n),4&i&&sU(e,n),64&i&&null!==(e=n.memoizedState)&&null!==(e=e.dehydrated)&&cf(e,n=uc.bind(null,n));break;case 22:if(!(i=null!==n.memoizedState||s$)){t=null!==t&&null!==t.memoizedState||sO,a=s$;var o=sO;s$=i,(sO=t)&&!o?sQ(e,n,0!=(8772&n.subtreeFlags)):sZ(e,n),s$=a,sO=o}case 30:}}function sz(e){var t=e.alternate;null!==t&&(e.alternate=null,sz(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&eQ(t),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var sj=null,sR=!1;function sL(e,t,n){for(n=n.child;null!==n;)sF(e,t,n),n=n.sibling}function sF(e,t,n){if(ev&&"function"==typeof ev.onCommitFiberUnmount)try{ev.onCommitFiberUnmount(eb,n)}catch(e){}switch(n.tag){case 26:sO||sw(n,t),sL(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:sO||sw(n,t);var i=sj,a=sR;ca(n.type)&&(sj=n.stateNode,sR=!1),sL(e,t,n),cx(n.stateNode),sj=i,sR=a;break;case 5:sO||sw(n,t);case 6:if(i=sj,a=sR,sj=null,sL(e,t,n),sj=i,sR=a,null!==sj)if(sR)try{(9===sj.nodeType?sj.body:"HTML"===sj.nodeName?sj.ownerDocument.body:sj).removeChild(n.stateNode)}catch(e){uo(n,t,e)}else try{sj.removeChild(n.stateNode)}catch(e){uo(n,t,e)}break;case 18:null!==sj&&(sR?(co(9===(e=sj).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),d$(e)):co(sj,n.stateNode));break;case 4:i=sj,a=sR,sj=n.stateNode.containerInfo,sR=!0,sL(e,t,n),sj=i,sR=a;break;case 0:case 11:case 14:case 15:sy(2,n,t),sO||sy(4,n,t),sL(e,t,n);break;case 1:sO||(sw(n,t),"function"==typeof(i=n.stateNode).componentWillUnmount&&sv(n,t,i)),sL(e,t,n);break;case 21:default:sL(e,t,n);break;case 22:sO=(i=sO)||null!==n.memoizedState,sL(e,t,n),sO=i}}function sB(e,t){if(null===t.memoizedState&&null!==(e=t.alternate)&&null!==(e=e.memoizedState)){e=e.dehydrated;try{d$(e)}catch(e){uo(t,t.return,e)}}}function sU(e,t){if(null===t.memoizedState&&null!==(e=t.alternate)&&null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))try{d$(e)}catch(e){uo(t,t.return,e)}}function sV(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new sN),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new sN),t;default:throw Error(l(435,e.tag))}}function sG(e,t){var n=sV(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var i=ud.bind(null,e,t);t.then(i,i)}})}function sH(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var a=n[i],o=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 27:if(ca(u.type)){sj=u.stateNode,sR=!1;break e}break;case 5:sj=u.stateNode,sR=!1;break e;case 3:case 4:sj=u.stateNode.containerInfo,sR=!0;break e}u=u.return}if(null===sj)throw Error(l(160));sF(o,s,a),sj=null,sR=!1,null!==(o=a.alternate)&&(o.return=null),a.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)sq(t,e),t=t.sibling}var sW=null;function sq(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:sH(t,e),sK(e),4&i&&(sy(3,e,e.return),sm(3,e),sy(5,e,e.return));break;case 1:sH(t,e),sK(e),512&i&&(sO||null===n||sw(n,n.return)),64&i&&s$&&null!==(e=e.updateQueue)&&null!==(i=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?i:n.concat(i));break;case 26:var a=sW;if(sH(t,e),sK(e),512&i&&(sO||null===n||sw(n,n.return)),4&i){var o=null!==n?n.memoizedState:null;if(i=e.memoizedState,null===n)if(null===i)if(null===e.stateNode){e:{i=e.type,n=e.memoizedProps,a=a.ownerDocument||a;t:switch(i){case"title":(!(o=a.getElementsByTagName("title")[0])||o[eY]||o[eG]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=a.createElement(i),a.head.insertBefore(o,a.querySelector("head > title"))),uQ(o,i,n),o[eG]=e,e3(o),i=o;break e;case"link":var s=cW("link","href",a).get(i+(n.href||""));if(s){for(var u=0;u<s.length;u++)if((o=s[u]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(u,1);break t}}uQ(o=a.createElement(i),i,n),a.head.appendChild(o);break;case"meta":if(s=cW("meta","content",a).get(i+(n.content||""))){for(u=0;u<s.length;u++)if((o=s[u]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(u,1);break t}}uQ(o=a.createElement(i),i,n),a.head.appendChild(o);break;default:throw Error(l(468,i))}o[eG]=e,e3(o),i=o}e.stateNode=i}else cq(a,e.type,e.stateNode);else e.stateNode=cB(a,i,e.memoizedProps);else o!==i?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===i?cq(a,e.type,e.stateNode):cB(a,i,e.memoizedProps)):null===i&&null!==e.stateNode&&sS(e,e.memoizedProps,n.memoizedProps)}break;case 27:sH(t,e),sK(e),512&i&&(sO||null===n||sw(n,n.return)),null!==n&&4&i&&sS(e,e.memoizedProps,n.memoizedProps);break;case 5:if(sH(t,e),sK(e),512&i&&(sO||null===n||sw(n,n.return)),32&e.flags){a=e.stateNode;try{tv(a,"")}catch(t){uo(e,e.return,t)}}4&i&&null!=e.stateNode&&(a=e.memoizedProps,sS(e,a,null!==n?n.memoizedProps:a)),1024&i&&(sA=!0);break;case 6:if(sH(t,e),sK(e),4&i){if(null===e.stateNode)throw Error(l(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(t){uo(e,e.return,t)}}break;case 3:if(cH=null,a=sW,sW=cS(t.containerInfo),sH(t,e),sW=a,sK(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{d$(t.containerInfo)}catch(t){uo(e,e.return,t)}sA&&(sA=!1,sX(e));break;case 4:i=sW,sW=cS(e.stateNode.containerInfo),sH(t,e),sK(e),sW=i;break;case 12:default:sH(t,e),sK(e);break;case 31:case 19:sH(t,e),sK(e),4&i&&null!==(i=e.updateQueue)&&(e.updateQueue=null,sG(e,i));break;case 13:sH(t,e),sK(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==n&&null!==n.memoizedState)&&(lk=eu()),4&i&&null!==(i=e.updateQueue)&&(e.updateQueue=null,sG(e,i));break;case 22:a=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,d=s$,p=sO;if(s$=d||a,sO=p||c,sH(t,e),sO=p,s$=d,sK(e),8192&i)e:for((t=e.stateNode)._visibility=a?-2&t._visibility:1|t._visibility,a&&(null===n||c||s$||sO||sY(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(o=c.stateNode,a)s=o.style,"function"==typeof s.setProperty?s.setProperty("display","none","important"):s.display="none";else{u=c.stateNode;var h=c.memoizedProps.style,f=null!=h&&h.hasOwnProperty("display")?h.display:null;u.style.display=null==f||"boolean"==typeof f?"":(""+f).trim()}}catch(e){uo(c,c.return,e)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=a?"":c.memoizedProps}catch(e){uo(c,c.return,e)}}}else if(18===t.tag){if(null===n){c=t;try{var g=c.stateNode;a?cs(g,!0):cs(c.stateNode,!1)}catch(e){uo(c,c.return,e)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&i&&null!==(i=e.updateQueue)&&null!==(n=i.retryQueue)&&(i.retryQueue=null,sG(e,n));case 30:case 21:}}function sK(e){var t=e.flags;if(2&t){try{for(var n,i=e.return;null!==i;){if(sk(i)){n=i;break}i=i.return}if(null==n)throw Error(l(160));switch(n.tag){case 27:var a=n.stateNode,o=sT(e);sE(e,o,a);break;case 5:var s=n.stateNode;32&n.flags&&(tv(s,""),n.flags&=-33);var u=sT(e);sE(e,u,s);break;case 3:case 4:var c=n.stateNode.containerInfo,d=sT(e);sC(e,d,c);break;default:throw Error(l(161))}}catch(t){uo(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function sX(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;sX(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function sZ(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)sM(e,t.alternate,t),t=t.sibling}function sY(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:sy(4,t,t.return),sY(t);break;case 1:sw(t,t.return);var n=t.stateNode;"function"==typeof n.componentWillUnmount&&sv(t,t.return,n),sY(t);break;case 27:cx(t.stateNode);case 26:case 5:sw(t,t.return),sY(t);break;case 22:null===t.memoizedState&&sY(t);break;default:sY(t)}e=e.sibling}}function sQ(e,t,n){for(n=n&&0!=(8772&t.subtreeFlags),t=t.child;null!==t;){var i=t.alternate,a=e,o=t,s=o.flags;switch(o.tag){case 0:case 11:case 15:sQ(a,o,n),sm(4,o);break;case 1:if(sQ(a,o,n),"function"==typeof(a=(i=o).stateNode).componentDidMount)try{a.componentDidMount()}catch(e){uo(i,i.return,e)}if(null!==(a=(i=o).updateQueue)){var l=i.stateNode;try{var u=a.shared.hiddenCallbacks;if(null!==u)for(a.shared.hiddenCallbacks=null,a=0;a<u.length;a++)iY(u[a],l)}catch(e){uo(i,i.return,e)}}n&&64&s&&sb(o),sx(o,o.return);break;case 27:sI(o);case 26:case 5:sQ(a,o,n),n&&null===i&&4&s&&s_(o),sx(o,o.return);break;case 12:default:sQ(a,o,n);break;case 31:sQ(a,o,n),n&&4&s&&sB(a,o);break;case 13:sQ(a,o,n),n&&4&s&&sU(a,o);break;case 22:null===o.memoizedState&&sQ(a,o,n),sx(o,o.return);case 30:}t=t.sibling}}function sJ(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&iu(n))}function s0(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&iu(e))}function s1(e,t,n,i){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)s2(e,t,n,i),t=t.sibling}function s2(e,t,n,i){var a=t.flags;switch(t.tag){case 0:case 11:case 15:s1(e,t,n,i),2048&a&&sm(9,t);break;case 1:case 31:case 13:default:s1(e,t,n,i);break;case 3:s1(e,t,n,i),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&iu(e)));break;case 12:if(2048&a){s1(e,t,n,i),e=t.stateNode;try{var o=t.memoizedProps,s=o.id,l=o.onPostCommit;"function"==typeof l&&l(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(e){uo(t,t.return,e)}}else s1(e,t,n,i);break;case 23:break;case 22:o=t.stateNode,s=t.alternate,null!==t.memoizedState?2&o._visibility?s1(e,t,n,i):s4(e,t):2&o._visibility?s1(e,t,n,i):(o._visibility|=2,s3(e,t,n,i,0!=(10256&t.subtreeFlags))),2048&a&&sJ(s,t);break;case 24:s1(e,t,n,i),2048&a&&s0(t.alternate,t)}}function s3(e,t,n,i,a){for(a=a&&0!=(10256&t.subtreeFlags),t=t.child;null!==t;){var o=e,s=t,l=n,u=i,c=s.flags;switch(s.tag){case 0:case 11:case 15:s3(o,s,l,u,a),sm(8,s);break;case 23:break;case 22:var d=s.stateNode;null!==s.memoizedState?2&d._visibility?s3(o,s,l,u,a):s4(o,s):(d._visibility|=2,s3(o,s,l,u,a)),a&&2048&c&&sJ(s.alternate,s);break;case 24:s3(o,s,l,u,a),a&&2048&c&&s0(s.alternate,s);break;default:s3(o,s,l,u,a)}t=t.sibling}}function s4(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,i=t,a=i.flags;switch(i.tag){case 22:s4(n,i),2048&a&&sJ(i.alternate,i);break;case 24:s4(n,i),2048&a&&s0(i.alternate,i);break;default:s4(n,i)}t=t.sibling}}var s6=8192;function s5(e,t,n){if(e.subtreeFlags&s6)for(e=e.child;null!==e;)s8(e,t,n),e=e.sibling}function s8(e,t,n){switch(e.tag){case 26:s5(e,t,n),e.flags&s6&&null!==e.memoizedState&&cZ(n,sW,e.memoizedState,e.memoizedProps);break;case 5:default:s5(e,t,n);break;case 3:case 4:var i=sW;sW=cS(e.stateNode.containerInfo),s5(e,t,n),sW=i;break;case 22:null===e.memoizedState&&(null!==(i=e.alternate)&&null!==i.memoizedState?(i=s6,s6=0x1000000,s5(e,t,n),s6=i):s5(e,t,n))}}function s7(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(null!==e)}}function s9(e){var t=e.deletions;if(0!=(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];sP=i,ln(i,e)}s7(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)le(e),e=e.sibling}function le(e){switch(e.tag){case 0:case 11:case 15:s9(e),2048&e.flags&&sy(9,e,e.return);break;case 3:case 12:default:s9(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,lt(e)):s9(e)}}function lt(e){var t=e.deletions;if(0!=(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];sP=i,ln(i,e)}s7(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:sy(8,t,t.return),lt(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,lt(t));break;default:lt(t)}e=e.sibling}}function ln(e,t){for(;null!==sP;){var n=sP;switch(n.tag){case 0:case 11:case 15:sy(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var i=n.memoizedState.cachePool.pool;null!=i&&i.refCount++}break;case 24:iu(n.memoizedState.cache)}if(null!==(i=n.child))i.return=n,sP=i;else for(n=e;null!==sP;){var a=(i=sP).sibling,o=i.return;if(sz(i),i===n){sP=null;break}if(null!==a){a.return=o,sP=a;break}sP=o}}}var lr={getCacheForType:function(e){var t=ie(is),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return ie(is).controller.signal}},li="function"==typeof WeakMap?WeakMap:Map,la=0,lo=null,ls=null,ll=0,lu=0,lc=null,ld=!1,lp=!1,lh=!1,lf=0,lg=0,lm=0,ly=0,lb=0,lv=0,lx=0,lw=null,l_=null,lS=!1,lk=0,lT=0,lC=1/0,lE=null,lI=null,l$=0,lO=null,lA=null,lN=0,lP=0,lD=null,lM=null,lz=0,lj=null;function lR(){return 0!=(2&la)&&0!==ll?ll&-ll:null!==j.T?uE():eB()}function lL(){if(0===lv)if(0==(0x20000000&ll)||rV){var e=eC;0==(3932160&(eC<<=1))&&(eC=262144),lv=e}else lv=0x20000000;return null!==(e=i4.current)&&(e.flags|=32),lv}function lF(e,t,n){(e===lo&&(2===lu||9===lu)||null!==e.cancelPendingCommit)&&(lq(e,0),lG(e,ll,lv,!1)),eD(e,n),(0==(2&la)||e!==lo)&&(e===lo&&(0==(2&la)&&(ly|=n),4===lg&&lG(e,ll,lv,!1)),uv(e))}function lB(e,t,n){if(0!=(6&la))throw Error(l(327));for(var i=!n&&0==(127&t)&&0==(t&e.expiredLanes)||eO(e,t),a=i?l1(e,t):lJ(e,t,!0),o=i;;){if(0===a)lp&&!i&&lG(e,t,0,!1);else{if(n=e.current.alternate,o&&!lV(n)){a=lJ(e,t,!1),o=!1;continue}if(2===a){if(o=t,e.errorRecoveryDisabledLanes&o)var s=0;else s=0!=(s=-0x20000001&e.pendingLanes)?s:0x20000000&s?0x20000000:0;if(0!==s){t=s;e:{var u=e;a=lw;var c=u.current.memoizedState.isDehydrated;if(c&&(lq(u,s).flags|=256),2!==(s=lJ(u,s,!1))){if(lh&&!c){u.errorRecoveryDisabledLanes|=o,ly|=o,a=4;break e}o=l_,l_=a,null!==o&&(null===l_?l_=o:l_.push.apply(l_,o))}a=s}if(o=!1,2!==a)continue}}if(1===a){lq(e,0),lG(e,t,0,!0);break}e:{switch(i=e,o=a){case 0:case 1:throw Error(l(345));case 4:if((4194048&t)!==t)break;case 6:lG(i,t,lv,!ld);break e;case 2:l_=null;break;case 3:case 5:break;default:throw Error(l(329))}if((0x3c00000&t)===t&&10<(a=lk+300-eu())){if(lG(i,t,lv,!ld),0!==e$(i,0,!0))break e;lN=t,i.timeoutHandle=ce(lU.bind(null,i,n,l_,lE,lS,t,lv,ly,lx,ld,o,"Throttled",-0,0),a);break e}lU(i,n,l_,lE,lS,t,lv,ly,lx,ld,o,null,-0,0)}}break}uv(e)}function lU(e,t,n,i,a,o,s,l,u,c,d,p,h,f){if(e.timeoutHandle=-1,8192&(p=t.subtreeFlags)||0x1002000==(0x1002000&p)){s8(t,o,p={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:tE});var g=(0x3c00000&o)===o?lk-eu():(4194048&o)===o?lT-eu():0;if(null!==(g=cQ(p,g))){lN=o,e.cancelPendingCommit=g(l7.bind(null,e,t,o,n,i,a,s,l,u,d,p,null,h,f)),lG(e,o,s,!c);return}}l7(e,t,o,n,i,a,s,l,u)}function lV(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&null!==(n=t.updateQueue)&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var a=n[i],o=a.getSnapshot;a=a.value;try{if(!nF(o(),a))return!1}catch(e){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function lG(e,t,n,i){t&=~lb,t&=~ly,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var a=t;0<a;){var o=31-ew(a),s=1<<o;i[o]=-1,a&=~s}0!==n&&ez(e,n,t)}function lH(){return 0!=(6&la)||(ux(0,!1),!1)}function lW(){if(null!==ls){if(0===lu)var e=ls.return;else e=ls,r2=r1=null,a_(e),iP=null,iD=0,e=ls;for(;null!==e;)sg(e.alternate,e),e=e.return;ls=null}}function lq(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,ct(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),lN=0,lW(),lo=e,ls=n=rb(e.current,null),ll=t,lu=0,lc=null,ld=!1,lp=eO(e,t),lh=!1,lx=lv=lb=ly=lm=lg=0,l_=lw=null,lS=!1,0!=(8&t)&&(t|=32&t);var i=e.entangledLanes;if(0!==i)for(e=e.entanglements,i&=t;0<i;){var a=31-ew(i),o=1<<a;t|=e[a],i&=~o}return lf=t,rl(),n}function lK(e,t){ai=null,j.H=o_,t===iS||t===iT?(t=iA(),lu=3):t===ik?(t=iA(),lu=4):lu=t===oF?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,lc=t,null===ls&&(lg=1,oD(e,rC(t,e.current)))}function lX(){var e=i4.current;return null===e||((4194048&ll)===ll?null===i6:((0x3c00000&ll)===ll||0!=(0x20000000&ll))&&e===i6)}function lZ(){var e=j.H;return j.H=o_,null===e?o_:e}function lY(){var e=j.A;return j.A=lr,e}function lQ(){lg=4,ld||(4194048&ll)!==ll&&null!==i4.current||(lp=!0),0==(0x7ffffff&lm)&&0==(0x7ffffff&ly)||null===lo||lG(lo,ll,lv,!1)}function lJ(e,t,n){var i=la;la|=2;var a=lZ(),o=lY();(lo!==e||ll!==t)&&(lE=null,lq(e,t)),t=!1;var s=lg;e:for(;;)try{if(0!==lu&&null!==ls){var l=ls,u=lc;switch(lu){case 8:lW(),s=6;break e;case 3:case 2:case 9:case 6:null===i4.current&&(t=!0);var c=lu;if(lu=0,lc=null,l6(e,l,u,c),n&&lp){s=0;break e}break;default:c=lu,lu=0,lc=null,l6(e,l,u,c)}}l0(),s=lg;break}catch(t){lK(e,t)}return t&&e.shellSuspendCounter++,r2=r1=null,la=i,j.H=a,j.A=o,null===ls&&(lo=null,ll=0,rl()),s}function l0(){for(;null!==ls;)l3(ls)}function l1(e,t){var n=la;la|=2;var i=lZ(),a=lY();lo!==e||ll!==t?(lE=null,lC=eu()+500,lq(e,t)):lp=eO(e,t);e:for(;;)try{if(0!==lu&&null!==ls){t=ls;var o=lc;t:switch(lu){case 1:lu=0,lc=null,l6(e,t,o,1);break;case 2:case 9:if(iE(o)){lu=0,lc=null,l4(t);break}t=function(){2!==lu&&9!==lu||lo!==e||(lu=7),uv(e)},o.then(t,t);break e;case 3:lu=7;break e;case 4:lu=5;break e;case 7:iE(o)?(lu=0,lc=null,l4(t)):(lu=0,lc=null,l6(e,t,o,7));break;case 5:var s=null;switch(ls.tag){case 26:s=ls.memoizedState;case 5:case 27:var u=ls;if(s?cX(s):u.stateNode.complete){lu=0,lc=null;var c=u.sibling;if(null!==c)ls=c;else{var d=u.return;null!==d?(ls=d,l5(d)):ls=null}break t}}lu=0,lc=null,l6(e,t,o,5);break;case 6:lu=0,lc=null,l6(e,t,o,6);break;case 8:lW(),lg=6;break e;default:throw Error(l(462))}}l2();break}catch(t){lK(e,t)}return(r2=r1=null,j.H=i,j.A=a,la=n,null!==ls)?0:(lo=null,ll=0,rl(),lg)}function l2(){for(;null!==ls&&!es();)l3(ls)}function l3(e){var t=so(e.alternate,e,lf);e.memoizedProps=e.pendingProps,null===t?l5(e):ls=t}function l4(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=o0(n,t,t.pendingProps,t.type,void 0,ll);break;case 11:t=o0(n,t,t.pendingProps,t.type.render,t.ref,ll);break;case 5:a_(t);default:sg(n,t),t=so(n,t=ls=rv(t,lf),lf)}e.memoizedProps=e.pendingProps,null===t?l5(e):ls=t}function l6(e,t,n,i){r2=r1=null,a_(t),iP=null,iD=0;var a=t.return;try{if(oL(e,a,t,n,ll)){lg=1,oD(e,rC(n,e.current)),ls=null;return}}catch(t){if(null!==a)throw ls=a,t;lg=1,oD(e,rC(n,e.current)),ls=null;return}32768&t.flags?(rV||1===i?e=!0:lp||0!=(0x20000000&ll)?e=!1:(ld=e=!0,(2===i||9===i||3===i||6===i)&&null!==(i=i4.current)&&13===i.tag&&(i.flags|=16384)),l8(t,e)):l5(t)}function l5(e){var t=e;do{if(0!=(32768&t.flags))return void l8(t,ld);e=t.return;var n=sh(t.alternate,t,lf);if(null!==n){ls=n;return}if(null!==(t=t.sibling)){ls=t;return}ls=t=e}while(null!==t);0===lg&&(lg=5)}function l8(e,t){do{var n=sf(e.alternate,e);if(null!==n){n.flags&=32767,ls=n;return}if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling)){ls=e;return}ls=e=n}while(null!==e);lg=6,ls=null}function l7(e,t,n,i,a,o,s,u,c){e.cancelPendingCommit=null;do ur();while(0!==l$);if(0!=(6&la))throw Error(l(327));if(null!==t){if(t===e.current)throw Error(l(177));if(eM(e,n,o=t.lanes|t.childLanes|rs,s,u,c),e===lo&&(ls=lo=null,ll=0),lA=t,lO=e,lN=n,lP=o,lD=a,lM=i,0!=(10256&t.subtreeFlags)||0!=(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,up(eh,function(){return ui(),null})):(e.callbackNode=null,e.callbackPriority=0),i=0!=(13878&t.flags),0!=(13878&t.subtreeFlags)||i){i=j.T,j.T=null,a=R.p,R.p=2,s=la,la|=4;try{sD(e,t,n)}finally{la=s,R.p=a,j.T=i}}l$=1,l9(),ue(),ut()}}function l9(){if(1===l$){l$=0;var e=lO,t=lA,n=0!=(13878&t.flags);if(0!=(13878&t.subtreeFlags)||n){n=j.T,j.T=null;var i=R.p;R.p=2;var a=la;la|=4;try{sq(t,e);var o=u3,s=nH(e.containerInfo),l=o.focusedElem,u=o.selectionRange;if(s!==l&&l&&l.ownerDocument&&nG(l.ownerDocument.documentElement,l)){if(null!==u&&nW(l)){var c=u.start,d=u.end;if(void 0===d&&(d=c),"selectionStart"in l)l.selectionStart=c,l.selectionEnd=Math.min(d,l.value.length);else{var p=l.ownerDocument||document,h=p&&p.defaultView||window;if(h.getSelection){var f=h.getSelection(),g=l.textContent.length,m=Math.min(u.start,g),y=void 0===u.end?m:Math.min(u.end,g);!f.extend&&m>y&&(s=y,y=m,m=s);var b=nV(l,m),v=nV(l,y);if(b&&v&&(1!==f.rangeCount||f.anchorNode!==b.node||f.anchorOffset!==b.offset||f.focusNode!==v.node||f.focusOffset!==v.offset)){var x=p.createRange();x.setStart(b.node,b.offset),f.removeAllRanges(),m>y?(f.addRange(x),f.extend(v.node,v.offset)):(x.setEnd(v.node,v.offset),f.addRange(x))}}}}for(p=[],f=l;f=f.parentNode;)1===f.nodeType&&p.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"==typeof l.focus&&l.focus(),l=0;l<p.length;l++){var w=p[l];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}dn=!!u2,u3=u2=null}finally{la=a,R.p=i,j.T=n}}e.current=t,l$=2}}function ue(){if(2===l$){l$=0;var e=lO,t=lA,n=0!=(8772&t.flags);if(0!=(8772&t.subtreeFlags)||n){n=j.T,j.T=null;var i=R.p;R.p=2;var a=la;la|=4;try{sM(e,t.alternate,t)}finally{la=a,R.p=i,j.T=n}}l$=3}}function ut(){if(4===l$||3===l$){l$=0,el();var e=lO,t=lA,n=lN,i=lM;0!=(10256&t.subtreeFlags)||0!=(10256&t.flags)?l$=5:(l$=0,lA=lO=null,un(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(lI=null),eF(n),t=t.stateNode,ev&&"function"==typeof ev.onCommitFiberRoot)try{ev.onCommitFiberRoot(eb,t,void 0,128==(128&t.current.flags))}catch(e){}if(null!==i){t=j.T,a=R.p,R.p=2,j.T=null;try{for(var o=e.onRecoverableError,s=0;s<i.length;s++){var l=i[s];o(l.value,{componentStack:l.stack})}}finally{j.T=t,R.p=a}}0!=(3&lN)&&ur(),uv(e),a=e.pendingLanes,0!=(261930&n)&&0!=(42&a)?e===lj?lz++:(lz=0,lj=e):lz=0,ux(0,!1)}}function un(e,t){0==(e.pooledCacheLanes&=t)&&null!=(t=e.pooledCache)&&(e.pooledCache=null,iu(t))}function ur(){return l9(),ue(),ut(),ui()}function ui(){if(5!==l$)return!1;var e=lO,t=lP;lP=0;var n=eF(lN),i=j.T,a=R.p;try{R.p=32>n?32:n,j.T=null,n=lD,lD=null;var o=lO,s=lN;if(l$=0,lA=lO=null,lN=0,0!=(6&la))throw Error(l(331));var u=la;if(la|=4,le(o.current),s2(o,o.current,s,n),la=u,ux(0,!1),ev&&"function"==typeof ev.onPostCommitFiberRoot)try{ev.onPostCommitFiberRoot(eb,o)}catch(e){}return!0}finally{R.p=a,j.T=i,un(e,t)}}function ua(e,t,n){t=rC(n,t),t=oz(e.stateNode,t,2),null!==(e=iH(e,t,2))&&(eD(e,2),uv(e))}function uo(e,t,n){if(3===e.tag)ua(e,e,n);else for(;null!==t;){if(3===t.tag){ua(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===lI||!lI.has(i))){e=rC(n,e),null!==(i=iH(t,n=oj(2),2))&&(oR(n,i,t,e),eD(i,2),uv(i));break}}t=t.return}}function us(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new li;var a=new Set;i.set(t,a)}else void 0===(a=i.get(t))&&(a=new Set,i.set(t,a));a.has(n)||(lh=!0,a.add(n),e=ul.bind(null,e,t,n),t.then(e,e))}function ul(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,lo===e&&(ll&n)===n&&(4===lg||3===lg&&(0x3c00000&ll)===ll&&300>eu()-lk?0==(2&la)&&lq(e,0):lb|=n,lx===ll&&(lx=0)),uv(e)}function uu(e,t){0===t&&(t=eN()),null!==(e=rd(e,t))&&(eD(e,t),uv(e))}function uc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),uu(e,n)}function ud(e,t){var n=0;switch(e.tag){case 31:case 13:var i=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(l(314))}null!==i&&i.delete(t),uu(e,n)}function up(e,t){return ea(e,t)}var uh=null,uf=null,ug=!1,um=!1,uy=!1,ub=0;function uv(e){e!==uf&&null===e.next&&(null===uf?uh=uf=e:uf=uf.next=e),um=!0,ug||(ug=!0,uC())}function ux(e,t){if(!uy&&um){uy=!0;do for(var n=!1,i=uh;null!==i;){if(!t)if(0!==e){var a=i.pendingLanes;if(0===a)var o=0;else{var s=i.suspendedLanes,l=i.pingedLanes;o=0xc000095&(o=(1<<31-ew(42|e)+1)-1&(a&~(s&~l)))?0xc000095&o|1:o?2|o:0}0!==o&&(n=!0,uT(i,o))}else o=ll,0==(3&(o=e$(i,i===lo?o:0,null!==i.cancelPendingCommit||-1!==i.timeoutHandle)))||eO(i,o)||(n=!0,uT(i,o));i=i.next}while(n);uy=!1}}function uw(){u_()}function u_(){um=ug=!1;var e=0;0!==ub&&u9()&&(e=ub);for(var t=eu(),n=null,i=uh;null!==i;){var a=i.next,o=uS(i,t);0===o?(i.next=null,null===n?uh=a:n.next=a,null===a&&(uf=n)):(n=i,(0!==e||0!=(3&o))&&(um=!0)),i=a}0!==l$&&5!==l$||ux(e,!1),0!==ub&&(ub=0)}function uS(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,o=-0x3c00001&e.pendingLanes;0<o;){var s=31-ew(o),l=1<<s,u=a[s];-1===u?(0==(l&n)||0!=(l&i))&&(a[s]=eA(l,t)):u<=t&&(e.expiredLanes|=l),o&=~l}if(t=lo,n=ll,n=e$(e,e===t?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),i=e.callbackNode,0===n||e===t&&(2===lu||9===lu)||null!==e.cancelPendingCommit)return null!==i&&null!==i&&eo(i),e.callbackNode=null,e.callbackPriority=0;if(0==(3&n)||eO(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==i&&eo(i),eF(n)){case 2:case 8:n=ep;break;case 32:default:n=eh;break;case 0x10000000:n=eg}return n=ea(n,i=uk.bind(null,e)),e.callbackPriority=t,e.callbackNode=n,t}return null!==i&&null!==i&&eo(i),e.callbackPriority=2,e.callbackNode=null,2}function uk(e,t){if(0!==l$&&5!==l$)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(ur()&&e.callbackNode!==n)return null;var i=ll;return 0===(i=e$(e,e===lo?i:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(lB(e,i,t),uS(e,eu()),null!=e.callbackNode&&e.callbackNode===n?uk.bind(null,e):null)}function uT(e,t){if(ur())return null;lB(e,t,!0)}function uC(){cr(function(){0!=(6&la)?ea(ed,uw):u_()})}function uE(){if(0===ub){var e=ip;0===e&&(e=eT,0==(261888&(eT<<=1))&&(eT=256)),ub=e}return ub}function uI(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:tC(""+e)}function u$(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function uO(e,t,n,i,a){if("submit"===t&&n&&n.stateNode===a){var o=uI((a[eH]||null).action),s=i.submitter;s&&null!==(t=(t=s[eH]||null)?uI(t.formAction):s.getAttribute("formAction"))&&(o=t,s=null);var l=new tJ("action","action",null,i,a);e.push({event:l,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(0!==ub){var e=s?u$(a,s):new FormData(a);ol(n,{pending:!0,data:e,method:a.method,action:o},null,e)}}else"function"==typeof o&&(l.preventDefault(),ol(n,{pending:!0,data:e=s?u$(a,s):new FormData(a),method:a.method,action:o},o,e))},currentTarget:a}]})}}for(var uA=0;uA<rn.length;uA++){var uN=rn[uA];rr(uN.toLowerCase(),"on"+(uN[0].toUpperCase()+uN.slice(1)))}rr(n4,"onAnimationEnd"),rr(n6,"onAnimationIteration"),rr(n5,"onAnimationStart"),rr("dblclick","onDoubleClick"),rr("focusin","onFocus"),rr("focusout","onBlur"),rr(n8,"onTransitionRun"),rr(n7,"onTransitionStart"),rr(n9,"onTransitionCancel"),rr(re,"onTransitionEnd"),e8("onMouseEnter",["mouseout","mouseover"]),e8("onMouseLeave",["mouseout","mouseover"]),e8("onPointerEnter",["pointerout","pointerover"]),e8("onPointerLeave",["pointerout","pointerover"]),e5("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),e5("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),e5("onBeforeInput",["compositionend","keypress","textInput","paste"]),e5("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),e5("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),e5("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uP="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(uP));function uM(e,t){t=0!=(4&t);for(var n=0;n<e.length;n++){var i=e[n],a=i.event;i=i.listeners;e:{var o=void 0;if(t)for(var s=i.length-1;0<=s;s--){var l=i[s],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==o&&a.isPropagationStopped())break e;o=l,a.currentTarget=c;try{o(a)}catch(e){ri(e)}a.currentTarget=null,o=u}else for(s=0;s<i.length;s++){if(u=(l=i[s]).instance,c=l.currentTarget,l=l.listener,u!==o&&a.isPropagationStopped())break e;o=l,a.currentTarget=c;try{o(a)}catch(e){ri(e)}a.currentTarget=null,o=u}}}}function uz(e,t){var n=t[eq];void 0===n&&(n=t[eq]=new Set);var i=e+"__bubble";n.has(i)||(uF(t,e,2,!1),n.add(i))}function uj(e,t,n){var i=0;t&&(i|=4),uF(n,e,i,t)}var uR="_reactListening"+Math.random().toString(36).slice(2);function uL(e){if(!e[uR]){e[uR]=!0,e4.forEach(function(t){"selectionchange"!==t&&(uD.has(t)||uj(t,!1,e),uj(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[uR]||(t[uR]=!0,uj("selectionchange",!1,t))}}function uF(e,t,n,i){switch(dc(t)){case 2:var a=dr;break;case 8:a=di;break;default:a=da}n=a.bind(null,t,n,e),a=void 0,tj&&("touchstart"===t||"touchmove"===t||"wheel"===t)&&(a=!0),i?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function uB(e,t,n,i,a){var o=i;if(0==(1&t)&&0==(2&t)&&null!==i)e:for(;;){if(null===i)return;var s=i.tag;if(3===s||4===s){var l=i.stateNode.containerInfo;if(l===a)break;if(4===s)for(s=i.return;null!==s;){var u=s.tag;if((3===u||4===u)&&s.stateNode.containerInfo===a)return;s=s.return}for(;null!==l;){if(null===(s=eJ(l)))return;if(5===(u=s.tag)||6===u||26===u||27===u){i=o=s;continue e}l=l.parentNode}}i=i.return}tD(function(){var i=o,a=t$(n),s=[];e:{var l=rt.get(e);if(void 0!==l){var u=tJ,d=e;switch(e){case"keypress":if(0===tV(n))break e;case"keydown":case"keyup":u=ni;break;case"focusin":d="focus",u=t6;break;case"focusout":d="blur",u=t6;break;case"beforeblur":case"afterblur":u=t6;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=t3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=t4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=no;break;case n4:case n6:case n5:u=t5;break;case re:u=ns;break;case"scroll":case"scrollend":u=t1;break;case"wheel":u=nl;break;case"copy":case"cut":case"paste":u=t8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=na;break;case"toggle":case"beforetoggle":u=nu}var p=0!=(4&t),h=!p&&("scroll"===e||"scrollend"===e),f=p?null!==l?l+"Capture":null:l;p=[];for(var g,m=i;null!==m;){var y=m;if(g=y.stateNode,5!==(y=y.tag)&&26!==y&&27!==y||null===g||null===f||null!=(y=tM(m,f))&&p.push(uU(m,y,g)),h)break;m=m.return}0<p.length&&(l=new u(l,d,null,n,a),s.push({event:l,listeners:p}))}}if(0==(7&t)){if((l="mouseover"===e||"pointerover"===e,u="mouseout"===e||"pointerout"===e,!(l&&n!==tI&&(d=n.relatedTarget||n.fromElement)&&(eJ(d)||d[eW])))&&(u||l)&&(l=a.window===a?a:(l=a.ownerDocument)?l.defaultView||l.parentWindow:window,u?(d=n.relatedTarget||n.toElement,u=i,null!==(d=d?eJ(d):null)&&(h=c(d),p=d.tag,d!==h||5!==p&&27!==p&&6!==p)&&(d=null)):(u=null,d=i),u!==d)){if(p=t3,y="onMouseLeave",f="onMouseEnter",m="mouse",("pointerout"===e||"pointerover"===e)&&(p=na,y="onPointerLeave",f="onPointerEnter",m="pointer"),h=null==u?l:e1(u),g=null==d?l:e1(d),(l=new p(y,m+"leave",u,n,a)).target=h,l.relatedTarget=g,y=null,eJ(a)===i&&((p=new p(f,m+"enter",d,n,a)).target=g,p.relatedTarget=h,y=p),h=y,u&&d)t:{for(p=uG,f=u,m=d,g=0,y=f;y;y=p(y))g++;y=0;for(var b,v=m;v;v=p(v))y++;for(;0<g-y;)f=p(f),g--;for(;0<y-g;)m=p(m),y--;for(;g--;){if(f===m||null!==m&&f===m.alternate){p=f;break t}f=p(f),m=p(m)}p=null}else p=null;null!==u&&uH(s,l,u,p,!1),null!==d&&null!==h&&uH(s,h,d,p,!0)}e:{if("select"===(u=(l=i?e1(i):window).nodeName&&l.nodeName.toLowerCase())||"input"===u&&"file"===l.type)var x=n$;else if(nS(l))if(nO)x=nR;else{x=nz;var w=nM}else(u=l.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===l.type||"radio"===l.type)?x=nj:i&&tS(i.elementType)&&(x=n$);if(x&&(x=x(e,i))){nk(s,x,n,a);break e}w&&w(e,l,i),"focusout"===e&&i&&"number"===l.type&&null!=i.memoizedProps.value&&tg(l,"number",l.value)}switch(w=i?e1(i):window,e){case"focusin":(nS(w)||"true"===w.contentEditable)&&(nK=w,nX=i,nZ=null);break;case"focusout":nZ=nX=nK=null;break;case"mousedown":nY=!0;break;case"contextmenu":case"mouseup":case"dragend":nY=!1,nQ(s,n,a);break;case"selectionchange":if(nq)break;case"keydown":case"keyup":nQ(s,n,a)}if(nd)t:{switch(e){case"compositionstart":var _="onCompositionStart";break t;case"compositionend":_="onCompositionEnd";break t;case"compositionupdate":_="onCompositionUpdate";break t}_=void 0}else nv?ny(e,n)&&(_="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(_="onCompositionStart");_&&(nf&&"ko"!==n.locale&&(nv||"onCompositionStart"!==_?"onCompositionEnd"===_&&nv&&(b=tU()):(tF="value"in(tL=a)?tL.value:tL.textContent,nv=!0)),0<(w=uV(i,_)).length&&(_=new t7(_,e,null,n,a),s.push({event:_,listeners:w}),b?_.data=b:null!==(b=nb(n))&&(_.data=b))),(b=nh?nx(e,n):nw(e,n))&&0<(_=uV(i,"onBeforeInput")).length&&(w=new t7("onBeforeInput","beforeinput",null,n,a),s.push({event:w,listeners:_}),w.data=b),uO(s,e,i,n,a)}uM(s,t)})}function uU(e,t,n){return{instance:e,listener:t,currentTarget:n}}function uV(e,t){for(var n=t+"Capture",i=[];null!==e;){var a=e,o=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===o||(null!=(a=tM(e,n))&&i.unshift(uU(e,a,o)),null!=(a=tM(e,t))&&i.push(uU(e,a,o))),3===e.tag)return i;e=e.return}return[]}function uG(e){if(null===e)return null;do e=e.return;while(e&&5!==e.tag&&27!==e.tag);return e||null}function uH(e,t,n,i,a){for(var o=t._reactName,s=[];null!==n&&n!==i;){var l=n,u=l.alternate,c=l.stateNode;if(l=l.tag,null!==u&&u===i)break;5!==l&&26!==l&&27!==l||null===c||(u=c,a?null!=(c=tM(n,o))&&s.unshift(uU(n,c,u)):a||null!=(c=tM(n,o))&&s.push(uU(n,c,u))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var uW=/\r\n?/g,uq=/\u0000|\uFFFD/g;function uK(e){return("string"==typeof e?e:""+e).replace(uW,"\n").replace(uq,"")}function uX(e,t){return t=uK(t),uK(e)===t}function uZ(e,t,n,i,a,o){switch(n){case"children":"string"==typeof i?"body"===t||"textarea"===t&&""===i||tv(e,i):("number"==typeof i||"bigint"==typeof i)&&"body"!==t&&tv(e,""+i);break;case"className":tr(e,"class",i);break;case"tabIndex":tr(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":tr(e,n,i);break;case"style":t_(e,i,o);break;case"data":if("object"!==t){tr(e,"data",i);break}case"src":case"href":if(""===i&&("a"!==t||"href"!==n)||null==i||"function"==typeof i||"symbol"==typeof i||"boolean"==typeof i){e.removeAttribute(n);break}i=tC(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if("function"==typeof i){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof o&&("formAction"===n?("input"!==t&&uZ(e,t,"name",a.name,a,null),uZ(e,t,"formEncType",a.formEncType,a,null),uZ(e,t,"formMethod",a.formMethod,a,null),uZ(e,t,"formTarget",a.formTarget,a,null)):(uZ(e,t,"encType",a.encType,a,null),uZ(e,t,"method",a.method,a,null),uZ(e,t,"target",a.target,a,null))),null==i||"symbol"==typeof i||"boolean"==typeof i){e.removeAttribute(n);break}i=tC(""+i),e.setAttribute(n,i);break;case"onClick":null!=i&&(e.onclick=tE);break;case"onScroll":null!=i&&uz("scroll",e);break;case"onScrollEnd":null!=i&&uz("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!=typeof i||!("__html"in i))throw Error(l(61));if(null!=(n=i.__html)){if(null!=a.children)throw Error(l(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&"function"!=typeof i&&"symbol"!=typeof i;break;case"muted":e.muted=i&&"function"!=typeof i&&"symbol"!=typeof i;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":case"innerText":case"textContent":break;case"xlinkHref":if(null==i||"function"==typeof i||"boolean"==typeof i||"symbol"==typeof i){e.removeAttribute("xlink:href");break}n=tC(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=i&&"function"!=typeof i&&"symbol"!=typeof i?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&"function"!=typeof i&&"symbol"!=typeof i?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===i?e.setAttribute(n,""):!1!==i&&null!=i&&"function"!=typeof i&&"symbol"!=typeof i?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":null==i||"function"==typeof i||"symbol"==typeof i||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":uz("beforetoggle",e),uz("toggle",e),tn(e,"popover",i);break;case"xlinkActuate":ti(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":ti(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":ti(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":ti(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":ti(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":ti(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":ti(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":ti(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":ti(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":tn(e,"is",i);break;default:2<n.length&&("o"===n[0]||"O"===n[0])&&("n"===n[1]||"N"===n[1])||tn(e,n=tk.get(n)||n,i)}}function uY(e,t,n,i,a,o){switch(n){case"style":t_(e,i,o);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!=typeof i||!("__html"in i))throw Error(l(61));if(null!=(n=i.__html)){if(null!=a.children)throw Error(l(60));e.innerHTML=n}}break;case"children":"string"==typeof i?tv(e,i):("number"==typeof i||"bigint"==typeof i)&&tv(e,""+i);break;case"onScroll":null!=i&&uz("scroll",e);break;case"onScrollEnd":null!=i&&uz("scrollend",e);break;case"onClick":null!=i&&(e.onclick=tE);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:if(!e6.hasOwnProperty(n))e:{if("o"===n[0]&&"n"===n[1]&&(a=n.endsWith("Capture"),t=n.slice(2,a?n.length-7:void 0),"function"==typeof(o=null!=(o=e[eH]||null)?o[n]:null)&&e.removeEventListener(t,o,a),"function"==typeof i)){"function"!=typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,a);break e}n in e?e[n]=i:!0===i?e.setAttribute(n,""):tn(e,n,i)}}}function uQ(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":uz("error",e),uz("load",e);var i,a=!1,o=!1;for(i in n)if(n.hasOwnProperty(i)){var s=n[i];if(null!=s)switch(i){case"src":a=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:uZ(e,t,i,s,n,null)}}o&&uZ(e,t,"srcSet",n.srcSet,n,null),a&&uZ(e,t,"src",n.src,n,null);return;case"input":uz("invalid",e);var u=i=s=o=null,c=null,d=null;for(a in n)if(n.hasOwnProperty(a)){var p=n[a];if(null!=p)switch(a){case"name":o=p;break;case"type":s=p;break;case"checked":c=p;break;case"defaultChecked":d=p;break;case"value":i=p;break;case"defaultValue":u=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(l(137,t));break;default:uZ(e,t,a,p,n,null)}}tf(e,i,u,c,d,s,o,!1);return;case"select":for(o in uz("invalid",e),a=s=i=null,n)if(n.hasOwnProperty(o)&&null!=(u=n[o]))switch(o){case"value":i=u;break;case"defaultValue":s=u;break;case"multiple":a=u;default:uZ(e,t,o,u,n,null)}t=i,n=s,e.multiple=!!a,null!=t?tm(e,!!a,t,!1):null!=n&&tm(e,!!a,n,!0);return;case"textarea":for(s in uz("invalid",e),i=o=a=null,n)if(n.hasOwnProperty(s)&&null!=(u=n[s]))switch(s){case"value":a=u;break;case"defaultValue":o=u;break;case"children":i=u;break;case"dangerouslySetInnerHTML":if(null!=u)throw Error(l(91));break;default:uZ(e,t,s,u,n,null)}tb(e,a,o,i);return;case"option":for(c in n)n.hasOwnProperty(c)&&null!=(a=n[c])&&("selected"===c?e.selected=a&&"function"!=typeof a&&"symbol"!=typeof a:uZ(e,t,c,a,n,null));return;case"dialog":uz("beforetoggle",e),uz("toggle",e),uz("cancel",e),uz("close",e);break;case"iframe":case"object":uz("load",e);break;case"video":case"audio":for(a=0;a<uP.length;a++)uz(uP[a],e);break;case"image":uz("error",e),uz("load",e);break;case"details":uz("toggle",e);break;case"embed":case"source":case"link":uz("error",e),uz("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in n)if(n.hasOwnProperty(d)&&null!=(a=n[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:uZ(e,t,d,a,n,null)}return;default:if(tS(t)){for(p in n)n.hasOwnProperty(p)&&void 0!==(a=n[p])&&uY(e,t,p,a,n,void 0);return}}for(u in n)n.hasOwnProperty(u)&&null!=(a=n[u])&&uZ(e,t,u,a,n,null)}function uJ(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,o=null,s=null,u=null,c=null,d=null,p=null;for(g in n){var h=n[g];if(n.hasOwnProperty(g)&&null!=h)switch(g){case"checked":case"value":break;case"defaultValue":c=h;default:i.hasOwnProperty(g)||uZ(e,t,g,null,i,h)}}for(var f in i){var g=i[f];if(h=n[f],i.hasOwnProperty(f)&&(null!=g||null!=h))switch(f){case"type":o=g;break;case"name":a=g;break;case"checked":d=g;break;case"defaultChecked":p=g;break;case"value":s=g;break;case"defaultValue":u=g;break;case"children":case"dangerouslySetInnerHTML":if(null!=g)throw Error(l(137,t));break;default:g!==h&&uZ(e,t,f,g,i,h)}}th(e,s,u,c,d,p,o,a);return;case"select":for(o in g=s=u=f=null,n)if(c=n[o],n.hasOwnProperty(o)&&null!=c)switch(o){case"value":break;case"multiple":g=c;default:i.hasOwnProperty(o)||uZ(e,t,o,null,i,c)}for(a in i)if(o=i[a],c=n[a],i.hasOwnProperty(a)&&(null!=o||null!=c))switch(a){case"value":f=o;break;case"defaultValue":u=o;break;case"multiple":s=o;default:o!==c&&uZ(e,t,a,o,i,c)}t=u,n=s,i=g,null!=f?tm(e,!!n,f,!1):!!i!=!!n&&(null!=t?tm(e,!!n,t,!0):tm(e,!!n,n?[]:"",!1));return;case"textarea":for(u in g=f=null,n)if(a=n[u],n.hasOwnProperty(u)&&null!=a&&!i.hasOwnProperty(u))switch(u){case"value":case"children":break;default:uZ(e,t,u,null,i,a)}for(s in i)if(a=i[s],o=n[s],i.hasOwnProperty(s)&&(null!=a||null!=o))switch(s){case"value":f=a;break;case"defaultValue":g=a;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=a)throw Error(l(91));break;default:a!==o&&uZ(e,t,s,a,i,o)}ty(e,f,g);return;case"option":for(var m in n)f=n[m],n.hasOwnProperty(m)&&null!=f&&!i.hasOwnProperty(m)&&("selected"===m?e.selected=!1:uZ(e,t,m,null,i,f));for(c in i)f=i[c],g=n[c],i.hasOwnProperty(c)&&f!==g&&(null!=f||null!=g)&&("selected"===c?e.selected=f&&"function"!=typeof f&&"symbol"!=typeof f:uZ(e,t,c,f,i,g));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var y in n)f=n[y],n.hasOwnProperty(y)&&null!=f&&!i.hasOwnProperty(y)&&uZ(e,t,y,null,i,f);for(d in i)if(f=i[d],g=n[d],i.hasOwnProperty(d)&&f!==g&&(null!=f||null!=g))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(l(137,t));break;default:uZ(e,t,d,f,i,g)}return;default:if(tS(t)){for(var b in n)f=n[b],n.hasOwnProperty(b)&&void 0!==f&&!i.hasOwnProperty(b)&&uY(e,t,b,void 0,i,f);for(p in i)f=i[p],g=n[p],i.hasOwnProperty(p)&&f!==g&&(void 0!==f||void 0!==g)&&uY(e,t,p,f,i,g);return}}for(var v in n)f=n[v],n.hasOwnProperty(v)&&null!=f&&!i.hasOwnProperty(v)&&uZ(e,t,v,null,i,f);for(h in i)f=i[h],g=n[h],i.hasOwnProperty(h)&&f!==g&&(null!=f||null!=g)&&uZ(e,t,h,f,i,g)}function u0(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function u1(){if("function"==typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var a=n[i],o=a.transferSize,s=a.initiatorType,l=a.duration;if(o&&l&&u0(s)){for(s=0,l=a.responseEnd,i+=1;i<n.length;i++){var u=n[i],c=u.startTime;if(c>l)break;var d=u.transferSize,p=u.initiatorType;d&&u0(p)&&(s+=d*((u=u.responseEnd)<l?1:(l-c)/(u-c)))}if(--i,t+=8*(o+s)/(a.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"==typeof(e=navigator.connection.downlink)?e:5}var u2=null,u3=null;function u4(e){return 9===e.nodeType?e:e.ownerDocument}function u6(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function u5(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function u8(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var u7=null;function u9(){var e=window.event;return e&&"popstate"===e.type?e!==u7&&(u7=e,!0):(u7=null,!1)}var ce="function"==typeof setTimeout?setTimeout:void 0,ct="function"==typeof clearTimeout?clearTimeout:void 0,cn="function"==typeof Promise?Promise:void 0,cr="function"==typeof queueMicrotask?queueMicrotask:void 0!==cn?function(e){return cn.resolve(null).then(e).catch(ci)}:ce;function ci(e){setTimeout(function(){throw e})}function ca(e){return"head"===e}function co(e,t){var n=t,i=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)||"/&"===n){if(0===i){e.removeChild(a),d$(t);return}i--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)i++;else if("html"===n)cx(e.ownerDocument.documentElement);else if("head"===n){cx(n=e.ownerDocument.head);for(var o=n.firstChild;o;){var s=o.nextSibling,l=o.nodeName;o[eY]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===o.rel.toLowerCase()||n.removeChild(o),o=s}}else"body"===n&&cx(e.ownerDocument.body);n=a}while(n);d$(t)}function cs(e,t){var n=e;e=0;do{var i=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&8===i.nodeType)if("/$"===(n=i.data))if(0===e)break;else e--;else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=i}while(n)}function cl(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":cl(n),eQ(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function cu(e,t,n,i){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(i){if(!e[eY])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(o=e.getAttribute("rel"))&&e.hasAttribute("data-precedence")||o!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((o=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var o=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===o)return e}if(null===(e=cg(e.nextSibling)))break}return null}function cc(e,t,n){if(""===t)return null;for(;3!==e.nodeType;)if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n||null===(e=cg(e.nextSibling)))return null;return e}function cd(e,t){for(;8!==e.nodeType;)if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t||null===(e=cg(e.nextSibling)))return null;return e}function cp(e){return"$?"===e.data||"$~"===e.data}function ch(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function cf(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}function cg(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var cm=null;function cy(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return cg(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function cb(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function cv(e,t,n){switch(t=u4(n),e){case"html":if(!(e=t.documentElement))throw Error(l(452));return e;case"head":if(!(e=t.head))throw Error(l(453));return e;case"body":if(!(e=t.body))throw Error(l(454));return e;default:throw Error(l(451))}}function cx(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);eQ(e)}var cw=new Map,c_=new Set;function cS(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var ck=R.d;R.d={f:function e(){var e=ck.f(),t=lH();return e||t},r:function e(e){var t=e0(e);null!==t&&5===t.tag&&"form"===t.type?oc(t):ck.r(e)},D:cE,C:cI,L:c$,m:cO,X:cN,S:cA,M:cP};var cT="undefined"==typeof document?null:document;function cC(e,t,n){var i=cT;if(i&&"string"==typeof t&&t){var a=tp(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"==typeof n&&(a+='[crossorigin="'+n+'"]'),c_.has(a)||(c_.add(a),e={rel:e,crossOrigin:n,href:t},null===i.querySelector(a)&&(uQ(t=i.createElement("link"),"link",e),e3(t),i.head.appendChild(t)))}}function cE(e){ck.D(e),cC("dns-prefetch",e,null)}function cI(e,t){ck.C(e,t),cC("preconnect",e,t)}function c$(e,t,n){ck.L(e,t,n);var i=cT;if(i&&e&&t){var a='link[rel="preload"][as="'+tp(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+tp(n.imageSrcSet)+'"]',"string"==typeof n.imageSizes&&(a+='[imagesizes="'+tp(n.imageSizes)+'"]')):a+='[href="'+tp(e)+'"]';var o=a;switch(t){case"style":o=cM(e);break;case"script":o=cL(e)}cw.has(o)||(e=m({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),cw.set(o,e),null!==i.querySelector(a)||"style"===t&&i.querySelector(cz(o))||"script"===t&&i.querySelector(cF(o))||(uQ(t=i.createElement("link"),"link",e),e3(t),i.head.appendChild(t)))}}function cO(e,t){ck.m(e,t);var n=cT;if(n&&e){var i=t&&"string"==typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+tp(i)+'"][href="'+tp(e)+'"]',o=a;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=cL(e)}if(!cw.has(o)&&(e=m({rel:"modulepreload",href:e},t),cw.set(o,e),null===n.querySelector(a))){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(cF(o)))return}uQ(i=n.createElement("link"),"link",e),e3(i),n.head.appendChild(i)}}}function cA(e,t,n){ck.S(e,t,n);var i=cT;if(i&&e){var a=e2(i).hoistableStyles,o=cM(e);t=t||"default";var s=a.get(o);if(!s){var l={loading:0,preload:null};if(s=i.querySelector(cz(o)))l.loading=5;else{e=m({rel:"stylesheet",href:e,"data-precedence":t},n),(n=cw.get(o))&&cV(e,n);var u=s=i.createElement("link");e3(u),uQ(u,"link",e),u._p=new Promise(function(e,t){u.onload=e,u.onerror=t}),u.addEventListener("load",function(){l.loading|=1}),u.addEventListener("error",function(){l.loading|=2}),l.loading|=4,cU(s,t,i)}s={type:"stylesheet",instance:s,count:1,state:l},a.set(o,s)}}}function cN(e,t){ck.X(e,t);var n=cT;if(n&&e){var i=e2(n).hoistableScripts,a=cL(e),o=i.get(a);o||((o=n.querySelector(cF(a)))||(e=m({src:e,async:!0},t),(t=cw.get(a))&&cG(e,t),e3(o=n.createElement("script")),uQ(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},i.set(a,o))}}function cP(e,t){ck.M(e,t);var n=cT;if(n&&e){var i=e2(n).hoistableScripts,a=cL(e),o=i.get(a);o||((o=n.querySelector(cF(a)))||(e=m({src:e,async:!0,type:"module"},t),(t=cw.get(a))&&cG(e,t),e3(o=n.createElement("script")),uQ(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},i.set(a,o))}}function cD(e,t,n,i){var a=(a=q.current)?cS(a):null;if(!a)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof n.precedence&&"string"==typeof n.href?(t=cM(n.href),(i=(n=e2(a).hoistableStyles).get(t))||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"==typeof n.href&&"string"==typeof n.precedence){e=cM(n.href);var o=e2(a).hoistableStyles,s=o.get(e);if(s||(a=a.ownerDocument||a,s={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},o.set(e,s),(o=a.querySelector(cz(e)))&&!o._p&&(s.instance=o,s.state.loading=5),cw.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},cw.set(e,n),o||cR(a,e,n,s.state))),t&&null===i)throw Error(l(528,""));return s}if(t&&null!==i)throw Error(l(529,""));return null;case"script":return t=n.async,"string"==typeof(n=n.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=cL(n),(i=(n=e2(a).hoistableScripts).get(t))||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function cM(e){return'href="'+tp(e)+'"'}function cz(e){return'link[rel="stylesheet"]['+e+"]"}function cj(e){return m({},e,{"data-precedence":e.precedence,precedence:null})}function cR(e,t,n,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(i.preload=t=e.createElement("link"),t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),uQ(t,"link",n),e3(t),e.head.appendChild(t))}function cL(e){return'[src="'+tp(e)+'"]'}function cF(e){return"script[async]"+e}function cB(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+tp(n.href)+'"]');if(i)return t.instance=i,e3(i),i;var a=m({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return e3(i=(e.ownerDocument||e).createElement("style")),uQ(i,"style",a),cU(i,n.precedence,e),t.instance=i;case"stylesheet":a=cM(n.href);var o=e.querySelector(cz(a));if(o)return t.state.loading|=4,t.instance=o,e3(o),o;i=cj(n),(a=cw.get(a))&&cV(i,a),e3(o=(e.ownerDocument||e).createElement("link"));var s=o;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),uQ(o,"link",i),t.state.loading|=4,cU(o,n.precedence,e),t.instance=o;case"script":if(o=cL(n.src),a=e.querySelector(cF(o)))return t.instance=a,e3(a),a;return i=n,(a=cw.get(o))&&cG(i=m({},n),a),e3(a=(e=e.ownerDocument||e).createElement("script")),uQ(a,"link",i),e.head.appendChild(a),t.instance=a;case"void":return null;default:throw Error(l(443,t.type))}return"stylesheet"===t.type&&0==(4&t.state.loading)&&(i=t.instance,t.state.loading|=4,cU(i,n.precedence,e)),t.instance}function cU(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=i.length?i[i.length-1]:null,o=a,s=0;s<i.length;s++){var l=i[s];if(l.dataset.precedence===t)o=l;else if(o!==a)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function cV(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function cG(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var cH=null;function cW(e,t,n){if(null===cH){var i=new Map,a=cH=new Map;a.set(n,i)}else(i=(a=cH).get(n))||(i=new Map,a.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var o=n[a];if(!(o[eY]||o[eG]||"link"===e&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var s=o.getAttribute(t)||"";s=e+s;var l=i.get(s);l?l.push(o):i.set(s,[o])}}return i}function cq(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function cK(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;if("stylesheet"===t.rel)return e=t.disabled,"string"==typeof t.precedence&&null==e;return!0;case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}function cX(e){return"stylesheet"!==e.type||0!=(3&e.state.loading)}function cZ(e,t,n,i){if("stylesheet"===n.type&&("string"!=typeof i.media||!1!==matchMedia(i.media).matches)&&0==(4&n.state.loading)){if(null===n.instance){var a=cM(i.href),o=t.querySelector(cz(a));if(o){null!==(t=o._p)&&"object"==typeof t&&"function"==typeof t.then&&(e.count++,e=cJ.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=o,e3(o);return}o=t.ownerDocument||t,i=cj(i),(a=cw.get(a))&&cV(i,a),e3(o=o.createElement("link"));var s=o;s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),uQ(o,"link",i),n.instance=o}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&0==(3&n.state.loading)&&(e.count++,n=cJ.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var cY=0;function cQ(e,t){return e.stylesheets&&0===e.count&&c1(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var i=setTimeout(function(){if(e.stylesheets&&c1(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===cY&&(cY=62500*u1());var a=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&c1(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>cY?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(a)}}:null}function cJ(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages)){if(this.stylesheets)c1(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var c0=null;function c1(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,c0=new Map,t.forEach(c2,e),c0=null,cJ.call(e))}function c2(e,t){if(!(4&t.state.loading)){var n=c0.get(e);if(n)var i=n.get(null);else{n=new Map,c0.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<a.length;o++){var s=a[o];("LINK"===s.nodeName||"not all"!==s.getAttribute("media"))&&(n.set(s.dataset.precedence,s),i=s)}i&&n.set(null,i)}s=(a=t.instance).getAttribute("data-precedence"),(o=n.get(s)||i)===i&&n.set(null,a),n.set(s,a),this.count++,i=cJ.bind(this),a.addEventListener("load",i),a.addEventListener("error",i),o?o.parentNode.insertBefore(a,o.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var c3={$$typeof:k,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function c4(e,t,n,i,a,o,s,l,u){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=eP(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=eP(0),this.hiddenUpdates=eP(null),this.identifierPrefix=i,this.onUncaughtError=a,this.onCaughtError=o,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=u,this.incompleteTransitions=new Map}function c6(e,t,n,i,a,o,s,l,u,c,d,p){return e=new c4(e,t,n,s,u,c,d,p,l),t=1,!0===o&&(t|=24),o=rm(3,null,null,t),e.current=o,o.stateNode=e,t=il(),t.refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:i,isDehydrated:n,cache:t},iU(o),e}function c5(e){return e?e=rf:rf}function c8(e,t,n,i,a,o){a=c5(a),null===i.context?i.context=a:i.pendingContext=a,(i=iG(t)).payload={element:n},null!==(o=void 0===o?null:o)&&(i.callback=o),null!==(n=iH(e,i,t))&&(lF(n,e,t),iW(n,e,t))}function c7(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function c9(e,t){c7(e,t),(e=e.alternate)&&c7(e,t)}function de(e){if(13===e.tag||31===e.tag){var t=rd(e,0x4000000);null!==t&&lF(t,e,0x4000000),c9(e,0x4000000)}}function dt(e){if(13===e.tag||31===e.tag){var t=lR(),n=rd(e,t=eL(t));null!==n&&lF(n,e,t),c9(e,t)}}var dn=!0;function dr(e,t,n,i){var a=j.T;j.T=null;var o=R.p;try{R.p=2,da(e,t,n,i)}finally{R.p=o,j.T=a}}function di(e,t,n,i){var a=j.T;j.T=null;var o=R.p;try{R.p=8,da(e,t,n,i)}finally{R.p=o,j.T=a}}function da(e,t,n,i){if(dn){var a=ds(i);if(null===a)uB(e,t,i,dl,n),dv(e,i);else if(dw(a,e,t,n,i))i.stopPropagation();else if(dv(e,i),4&t&&-1<db.indexOf(e)){for(;null!==a;){var o=e0(a);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var s=eI(o.pendingLanes);if(0!==s){var l=o;for(l.pendingLanes|=2,l.entangledLanes|=2;s;){var u=1<<31-ew(s);l.entanglements[1]|=u,s&=~u}uv(o),0==(6&la)&&(lC=eu()+500,ux(0,!1))}}break;case 31:case 13:null!==(l=rd(o,2))&&lF(l,o,2),lH(),c9(o,2)}if(null===(o=ds(i))&&uB(e,t,i,dl,n),o===a)break;a=o}null!==a&&i.stopPropagation()}else uB(e,t,i,null,n)}}function ds(e){return du(e=t$(e))}var dl=null;function du(e){if(dl=null,null!==(e=eJ(e))){var t=c(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=d(t)))return e;e=null}else if(31===n){if(null!==(e=p(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return dl=e,null}function dc(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ec()){case ed:return 2;case ep:return 8;case eh:case ef:return 32;case eg:return 0x10000000;default:return 32}default:return 32}}var dd=!1,dp=null,dh=null,df=null,dg=new Map,dm=new Map,dy=[],db="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function dv(e,t){switch(e){case"focusin":case"focusout":dp=null;break;case"dragenter":case"dragleave":dh=null;break;case"mouseover":case"mouseout":df=null;break;case"pointerover":case"pointerout":dg.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":dm.delete(t.pointerId)}}function dx(e,t,n,i,a,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[a]},null!==t&&null!==(t=e0(t))&&de(t)):(e.eventSystemFlags|=i,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a)),e}function dw(e,t,n,i,a){switch(t){case"focusin":return dp=dx(dp,e,t,n,i,a),!0;case"dragenter":return dh=dx(dh,e,t,n,i,a),!0;case"mouseover":return df=dx(df,e,t,n,i,a),!0;case"pointerover":var o=a.pointerId;return dg.set(o,dx(dg.get(o)||null,e,t,n,i,a)),!0;case"gotpointercapture":return o=a.pointerId,dm.set(o,dx(dm.get(o)||null,e,t,n,i,a)),!0}return!1}function d_(e){var t=eJ(e.target);if(null!==t){var n=c(t);if(null!==n){if(13===(t=n.tag)){if(null!==(t=d(n))){e.blockedOn=t,eU(e.priority,function(){dt(n)});return}}else if(31===t){if(null!==(t=p(n))){e.blockedOn=t,eU(e.priority,function(){dt(n)});return}}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=3===n.tag?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function dS(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=ds(e.nativeEvent);if(null!==n)return null!==(t=e0(n))&&de(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);tI=i,n.target.dispatchEvent(i),tI=null,t.shift()}return!0}function dk(e,t,n){dS(e)&&n.delete(t)}function dT(){dd=!1,null!==dp&&dS(dp)&&(dp=null),null!==dh&&dS(dh)&&(dh=null),null!==df&&dS(df)&&(df=null),dg.forEach(dk),dm.forEach(dk)}function dC(e,t){e.blockedOn===t&&(e.blockedOn=null,dd||(dd=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,dT)))}var dE=null;function dI(e){dE!==e&&(dE=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){dE===e&&(dE=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],a=e[t+2];if("function"!=typeof i)if(null===du(i||n))continue;else break;var o=e0(n);null!==o&&(e.splice(t,3),t-=3,ol(o,{pending:!0,data:a,method:n.method,action:i},i,a))}}))}function d$(e){function t(t){return dC(t,e)}null!==dp&&dC(dp,e),null!==dh&&dC(dh,e),null!==df&&dC(df,e),dg.forEach(t),dm.forEach(t);for(var n=0;n<dy.length;n++){var i=dy[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<dy.length&&null===(n=dy[0]).blockedOn;)d_(n),null===n.blockedOn&&dy.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(i=0;i<n.length;i+=3){var a=n[i],o=n[i+1],s=a[eH]||null;if("function"==typeof o)s||dI(n);else if(s){var l=null;if(o&&o.hasAttribute("formAction")){if(a=o,s=o[eH]||null)l=s.formAction;else if(null!==du(a))continue}else l=s.action;"function"==typeof l?n[i+1]=l:(n.splice(i,3),i-=3),dI(n)}}}function dO(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return a=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==a&&(a(),a=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"==typeof navigation){var i=!1,a=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==a&&(a(),a=null)}}}function dA(e){this._internalRoot=e}function dN(e){this._internalRoot=e}dN.prototype.render=dA.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(l(409));c8(t.current,lR(),e,t,null,null)},dN.prototype.unmount=dA.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;c8(e.current,2,null,e,null,null),lH(),t[eW]=null}},dN.prototype.unstable_scheduleHydration=function(e){if(e){var t=eB();e={blockedOn:null,target:e,priority:t};for(var n=0;n<dy.length&&0!==t&&t<dy[n].priority;n++);dy.splice(n,0,e),0===n&&d_(e)}};var dP=o.version;if("19.2.3"!==dP)throw Error(l(527,dP,"19.2.3"));R.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(l(188));throw Error(l(268,e=Object.keys(e).join(",")))}return null===(e=null!==(e=f(t))?g(e):null)?null:e.stateNode};var dD={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:j,reconcilerVersion:"19.2.3"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var dM=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dM.isDisabled&&dM.supportsFiber)try{eb=dM.inject(dD),ev=dM}catch(e){}}t.createRoot=function(e,t){if(!u(e))throw Error(l(299));var n=!1,i="",a=oA,o=oN,s=oP;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onUncaughtError&&(a=t.onUncaughtError),void 0!==t.onCaughtError&&(o=t.onCaughtError),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=c6(e,1,!1,null,null,n,i,null,a,o,s,dO),e[eW]=t.current,uL(e),new dA(t)}},929(e,t,n){"use strict";var i=n(41);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var s={d:{f:o,r:function(){throw Error(a(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:l,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}var c=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(e,t){return"font"===e?"":"string"==typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(a(299));return u(e,t,null,n)},t.flushSync=function(e){var t=c.T,n=s.p;try{if(c.T=null,s.p=2,e)return e()}finally{c.T=t,s.p=n,s.d.f()}},t.preconnect=function(e,t){"string"==typeof e&&(t=t?"string"==typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:null,s.d.C(e,t))},t.prefetchDNS=function(e){"string"==typeof e&&s.d.D(e)},t.preinit=function(e,t){if("string"==typeof e&&t&&"string"==typeof t.as){var n=t.as,i=d(n,t.crossOrigin),a="string"==typeof t.integrity?t.integrity:void 0,o="string"==typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?s.d.S(e,"string"==typeof t.precedence?t.precedence:void 0,{crossOrigin:i,integrity:a,fetchPriority:o}):"script"===n&&s.d.X(e,{crossOrigin:i,integrity:a,fetchPriority:o,nonce:"string"==typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"==typeof e)if("object"==typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=d(t.as,t.crossOrigin);s.d.M(e,{crossOrigin:n,integrity:"string"==typeof t.integrity?t.integrity:void 0,nonce:"string"==typeof t.nonce?t.nonce:void 0})}}else null==t&&s.d.M(e)},t.preload=function(e,t){if("string"==typeof e&&"object"==typeof t&&null!==t&&"string"==typeof t.as){var n=t.as,i=d(n,t.crossOrigin);s.d.L(e,n,{crossOrigin:i,integrity:"string"==typeof t.integrity?t.integrity:void 0,nonce:"string"==typeof t.nonce?t.nonce:void 0,type:"string"==typeof t.type?t.type:void 0,fetchPriority:"string"==typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"==typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"==typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"==typeof t.imageSizes?t.imageSizes:void 0,media:"string"==typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"==typeof e)if(t){var n=d(t.as,t.crossOrigin);s.d.m(e,{as:"string"==typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"==typeof t.integrity?t.integrity:void 0})}else s.d.m(e)},t.requestFormReset=function(e){s.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return c.H.useFormState(e,t,n)},t.useFormStatus=function(){return c.H.useHostTransitionStatus()},t.version="19.2.3"},873(e,t,n){"use strict";function i(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}i(),e.exports=n(974)},144(e,t,n){"use strict";function i(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}i(),e.exports=n(929)},197(e,t){"use strict";var n=Symbol.for("react.transitional.element");function i(e,t,i){var a=null;if(void 0!==i&&(a=""+i),void 0!==t.key&&(a=""+t.key),"key"in t)for(var o in i={},t)"key"!==o&&(i[o]=t[o]);else i=t;return{$$typeof:n,type:e,key:a,ref:void 0!==(t=i.ref)?t:null,props:i}}t.Fragment=Symbol.for("react.fragment"),t.jsx=i,t.jsxs=i},62(e,t){"use strict";var n=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),g=Symbol.iterator;function m(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=g&&e[g]||e["@@iterator"])?e:null}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,v={};function x(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||y}function w(){}function _(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||y}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},w.prototype=x.prototype;var S=_.prototype=new w;S.constructor=_,b(S,x.prototype),S.isPureReactComponent=!0;var k=Array.isArray;function T(){}var C={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function I(e,t,i){var a=i.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==a?a:null,props:i}}function $(e,t){return I(e.type,t,e.props)}function O(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}function A(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}var N=/\/+/g;function P(e,t){return"object"==typeof e&&null!==e&&null!=e.key?A(""+e.key):t.toString(36)}function D(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"==typeof e.status?e.then(T,T):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function M(e,t,a,o,s){var l=typeof e;("undefined"===l||"boolean"===l)&&(e=null);var u=!1;if(null===e)u=!0;else switch(l){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case i:u=!0;break;case h:return M((u=e._init)(e._payload),t,a,o,s)}}if(u)return s=s(e),u=""===o?"."+P(e,0):o,k(s)?(a="",null!=u&&(a=u.replace(N,"$&/")+"/"),M(s,t,a,"",function(e){return e})):null!=s&&(O(s)&&(s=$(s,a+(null==s.key||e&&e.key===s.key?"":(""+s.key).replace(N,"$&/")+"/")+u)),t.push(s)),1;u=0;var c=""===o?".":o+":";if(k(e))for(var d=0;d<e.length;d++)l=c+P(o=e[d],d),u+=M(o,t,a,l,s);else if("function"==typeof(d=m(e)))for(e=d.call(e),d=0;!(o=e.next()).done;)l=c+P(o=o.value,d++),u+=M(o,t,a,l,s);else if("object"===l){if("function"==typeof e.then)return M(D(e),t,a,o,s);throw Error("Objects are not valid as a React child (found: "+("[object Object]"===(t=String(e))?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function z(e,t,n){if(null==e)return e;var i=[],a=0;return M(e,i,"","",function(e){return t.call(n,e,a++)}),i}function j(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){(0===e._status||-1===e._status)&&(e._status=1,e._result=t)},function(t){(0===e._status||-1===e._status)&&(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},L={map:z,forEach:function(e,t,n){z(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return z(e,function(){t++}),t},toArray:function(e){return z(e,function(e){return e})||[]},only:function(e){if(!O(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=f,t.Children=L,t.Component=x,t.Fragment=a,t.Profiler=s,t.PureComponent=_,t.StrictMode=o,t.Suspense=d,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return C.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null==e)throw Error("The argument must be a React element, but you passed "+e+".");var i=b({},e.props),a=e.key;if(null!=t)for(o in void 0!==t.key&&(a=""+t.key),t)E.call(t,o)&&"key"!==o&&"__self"!==o&&"__source"!==o&&("ref"!==o||void 0!==t.ref)&&(i[o]=t[o]);var o=arguments.length-2;if(1===o)i.children=n;else if(1<o){for(var s=Array(o),l=0;l<o;l++)s[l]=arguments[l+2];i.children=s}return I(e.type,a,i)},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:l,_context:e},e},t.createElement=function(e,t,n){var i,a={},o=null;if(null!=t)for(i in void 0!==t.key&&(o=""+t.key),t)E.call(t,i)&&"key"!==i&&"__self"!==i&&"__source"!==i&&(a[i]=t[i]);var s=arguments.length-2;if(1===s)a.children=n;else if(1<s){for(var l=Array(s),u=0;u<s;u++)l[u]=arguments[u+2];a.children=l}if(e&&e.defaultProps)for(i in s=e.defaultProps)void 0===a[i]&&(a[i]=s[i]);return I(e,o,a)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=O,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:j}},t.memo=function(e,t){return{$$typeof:p,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=C.T,n={};C.T=n;try{var i=e(),a=C.S;null!==a&&a(n,i),"object"==typeof i&&null!==i&&"function"==typeof i.then&&i.then(T,R)}catch(e){R(e)}finally{null!==t&&null!==n.types&&(t.types=n.types),C.T=t}},t.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},t.use=function(e){return C.H.use(e)},t.useActionState=function(e,t,n){return C.H.useActionState(e,t,n)},t.useCallback=function(e,t){return C.H.useCallback(e,t)},t.useContext=function(e){return C.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return C.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return C.H.useEffect(e,t)},t.useEffectEvent=function(e){return C.H.useEffectEvent(e)},t.useId=function(){return C.H.useId()},t.useImperativeHandle=function(e,t,n){return C.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return C.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return C.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return C.H.useMemo(e,t)},t.useOptimistic=function(e,t){return C.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return C.H.useReducer(e,t,n)},t.useRef=function(e){return C.H.useRef(e)},t.useState=function(e){return C.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return C.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return C.H.useTransition()},t.version="19.2.3"},41(e,t,n){"use strict";e.exports=n(62)},85(e,t,n){"use strict";e.exports=n(197)},310(e,t){"use strict";function n(e,t){var n=e.length;for(e.push(t);0<n;){var i=n-1>>>1,a=e[i];if(0<o(a,t))e[i]=t,e[n]=a,n=i;else break}}function i(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;for(var i=0,a=e.length,s=a>>>1;i<s;){var l=2*(i+1)-1,u=e[l],c=l+1,d=e[c];if(0>o(u,n))c<a&&0>o(d,u)?(e[i]=d,e[c]=n,i=c):(e[i]=u,e[l]=n,i=l);else if(c<a&&0>o(d,n))e[i]=d,e[c]=n,i=c;else break}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var s,l=performance;t.unstable_now=function(){return l.now()}}else{var u=Date,c=u.now();t.unstable_now=function(){return u.now()-c}}var d=[],p=[],h=1,f=null,g=3,m=!1,y=!1,b=!1,v=!1,x="function"==typeof setTimeout?setTimeout:null,w="function"==typeof clearTimeout?clearTimeout:null,_="undefined"!=typeof setImmediate?setImmediate:null;function S(e){for(var t=i(p);null!==t;){if(null===t.callback)a(p);else if(t.startTime<=e)a(p),t.sortIndex=t.expirationTime,n(d,t);else break;t=i(p)}}function k(e){if(b=!1,S(e),!y)if(null!==i(d))y=!0,T||(T=!0,s());else{var t=i(p);null!==t&&P(k,t.startTime-e)}}var T=!1,C=-1,E=5,I=-1;function $(){return!!v||!(t.unstable_now()-I<E)}function O(){if(v=!1,T){var e=t.unstable_now();I=e;var n=!0;try{e:{y=!1,b&&(b=!1,w(C),C=-1),m=!0;var o=g;try{t:{for(S(e),f=i(d);null!==f&&!(f.expirationTime>e&&$());){var l=f.callback;if("function"==typeof l){f.callback=null,g=f.priorityLevel;var u=l(f.expirationTime<=e);if(e=t.unstable_now(),"function"==typeof u){f.callback=u,S(e),n=!0;break t}f===i(d)&&a(d),S(e)}else a(d);f=i(d)}if(null!==f)n=!0;else{var c=i(p);null!==c&&P(k,c.startTime-e),n=!1}}break e}finally{f=null,g=o,m=!1}}}finally{n?s():T=!1}}}if("function"==typeof _)s=function(){_(O)};else if("undefined"!=typeof MessageChannel){var A=new MessageChannel,N=A.port2;A.port1.onmessage=O,s=function(){N.postMessage(null)}}else s=function(){x(O,0)};function P(e,n){C=x(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_next=function(e){switch(g){case 1:case 2:case 3:var t=3;break;default:t=g}var n=g;g=t;try{return e()}finally{g=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=g;g=e;try{return t()}finally{g=n}},t.unstable_scheduleCallback=function(e,a,o){var l=t.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?l+o:l,e){case 1:var u=-1;break;case 2:u=250;break;case 5:u=0x3fffffff;break;case 4:u=1e4;break;default:u=5e3}return u=o+u,e={id:h++,callback:a,priorityLevel:e,startTime:o,expirationTime:u,sortIndex:-1},o>l?(e.sortIndex=o,n(p,e),null===i(d)&&e===i(p)&&(b?(w(C),C=-1):b=!0,P(k,o-l))):(e.sortIndex=u,n(d,e),y||m||(y=!0,T||(T=!0,s()))),e},t.unstable_shouldYield=$,t.unstable_wrapCallback=function(e){var t=g;return function(){var n=g;g=t;try{return e.apply(this,arguments)}finally{g=n}}}},967(e,t,n){"use strict";e.exports=n(310)},20(e,t,n){"use strict";var i=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(n(52)),a=n(576);function o(e,t){var n={};return e&&"string"==typeof e&&(0,i.default)(e,function(e,i){e&&i&&(n[(0,a.camelCase)(e,t)]=i)}),n}o.default=o,e.exports=o},576(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.camelCase=void 0;var n=/^--[a-zA-Z0-9_-]+$/,i=/-([a-z])/g,a=/^[^-]+$/,o=/^-(webkit|moz|ms|o|khtml)-/,s=/^-(ms)-/,l=function(e){return!e||a.test(e)||n.test(e)},u=function(e,t){return t.toUpperCase()},c=function(e,t){return"".concat(t,"-")};t.camelCase=function(e,t){return(void 0===t&&(t={}),l(e))?e:(e=e.toLowerCase(),(e=t.reactCompat?e.replace(s,c):e.replace(o,c)).replace(i,u))}},52(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;let a=i(n(776));function o(e,t){let n=null;if(!e||"string"!=typeof e)return n;let i=(0,a.default)(e),o="function"==typeof t;return i.forEach(e=>{if("declaration"!==e.type)return;let{property:i,value:a}=e;o?t(i,a,e):a&&((n=n||{})[i]=a)}),n}},915(e,t,n){"use strict";var i=n(41);function a(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t}var o="function"==typeof Object.is?Object.is:a,s=i.useState,l=i.useEffect,u=i.useLayoutEffect,c=i.useDebugValue;function d(e,t){var n=t(),i=s({inst:{value:n,getSnapshot:t}}),a=i[0].inst,o=i[1];return u(function(){a.value=n,a.getSnapshot=t,p(a)&&o({inst:a})},[e,n,t]),l(function(){return p(a)&&o({inst:a}),e(function(){p(a)&&o({inst:a})})},[e]),c(n),n}function p(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(e){return!0}}function h(e,t){return t()}var f="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?h:d;t.useSyncExternalStore=void 0!==i.useSyncExternalStore?i.useSyncExternalStore:f},435(e,t,n){"use strict";var i=n(41),a=n(139);function o(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t}var s="function"==typeof Object.is?Object.is:o,l=a.useSyncExternalStore,u=i.useRef,c=i.useEffect,d=i.useMemo,p=i.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,i,a){var o=u(null);if(null===o.current){var h={hasValue:!1,value:null};o.current=h}else h=o.current;var f=l(e,(o=d(function(){function e(e){if(!u){if(u=!0,o=e,e=i(e),void 0!==a&&h.hasValue){var t=h.value;if(a(t,e))return l=t}return l=e}if(t=l,s(o,e))return t;var n=i(e);return void 0!==a&&a(t,n)?(o=e,t):(o=e,l=n)}var o,l,u=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,i,a]))[0],o[1]);return c(function(){h.hasValue=!0,h.value=f},[f]),p(f),f}},139(e,t,n){"use strict";e.exports=n(915)},121(e,t,n){"use strict";e.exports=n(435)},2(e){e.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},681(e,t,n){"use strict";e.exports=n.p+"static/wasm/c198d660.module.wasm"},249(e,t,n){"use strict";e.exports=n.p+"static/assets/ort.all.bundle.min.0e868baf.mjs"},255(e,t,n){"use strict";n.d(t,{N:()=>a});var i=n(990);class a{async analyzeBatch(e){let t=[];for(let n of e)t.push(await this.analyze(n.signMap,n.options));return t}getRuntimeInfo(){return{backend:"unknown",inputDataType:"float32",didFallback:!1}}async dispose(){this.cache.clear(),this.initialized=!1}async analyze(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.initialized||(await this.initialize(),this.initialized=!0);let n=this.getCapabilities(),i=e.length;if(n.supportedBoardSizes.length>0&&!n.supportedBoardSizes.includes(i))throw Error(`Engine ${n.name} does not support board size ${i}. Supported sizes: ${n.supportedBoardSizes.join(", ")}`);let a=this.config.enableCache&&!t.skipCache;if(a){let n=this.getCacheKey(e,t),i=this.cache.get(n);if(i)return i}let o=await this.analyzePosition(e,{maxMoves:t.maxMoves??this.config.maxMoves,...t});if(a){let n=this.getCacheKey(e,t);if(this.cache.set(n,o),this.cache.size>(this.config.maxCacheSize??1e3)){let e=this.cache.keys().next().value;e&&this.cache.delete(e)}}return o}async generateMove(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(null==(t=(await this.analyze(e,n)).moveSuggestions[0])?void 0:t.move)??"PASS"}async analyzeMany(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.getCapabilities().supportsParallel)return Promise.all(e.map(e=>this.analyze(e,t)));let n=[];for(let i of e)n.push(await this.analyze(i,t));return n}clearCache(){this.cache.clear()}getCacheStats(){return{size:this.cache.size,maxSize:this.config.maxCacheSize??1e3}}isInitialized(){return this.initialized}getCacheKey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.config.cacheKeyFn)return this.config.cacheKeyFn(e);let n=this.defaultHashSignMap(e),i=t.nextToPlay??"B";return JSON.stringify({board:n,nextToPlay:i,komi:t.komi??7.5,history:(t.history||[]).slice(-5).map(e=>`${e.color}:${e.x},${e.y}`)})}defaultHashSignMap(e){let t=e.map(e=>e.join(",")).join(";");return`${e.length}:${t}`}constructor(e={}){(0,i._)(this,"config",void 0),(0,i._)(this,"cache",void 0),(0,i._)(this,"initialized",!1),this.config={maxMoves:10,enableCache:!0,maxCacheSize:1e3,...e},this.cache=new Map}}},990(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{_:()=>i})},296(e,t,n){"use strict";var i,a,o,s,l;function u(e,t,n,i){if("a"===n&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)}function c(e,t,n,i,a){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!a)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?a.call(e,n):a?a.value=n:t.set(e,n),n}n.d(t,{yw:()=>p,FW:()=>g,$c:()=>d,lA:()=>f,c3:()=>h}),"function"==typeof SuppressedError&&SuppressedError;let d="__TAURI_TO_IPC_KEY__";function p(e,t=!1){return window.__TAURI_INTERNALS__.transformCallback(e,t)}class h{constructor(e){i.set(this,void 0),a.set(this,0),o.set(this,[]),s.set(this,void 0),c(this,i,e||(()=>{}),"f"),this.id=p(e=>{let t=e.index;if("end"in e)return void(t==u(this,a,"f")?this.cleanupCallback():c(this,s,t,"f"));let n=e.message;if(t==u(this,a,"f")){for(u(this,i,"f").call(this,n),c(this,a,u(this,a,"f")+1,"f");u(this,a,"f")in u(this,o,"f");){let e=u(this,o,"f")[u(this,a,"f")];u(this,i,"f").call(this,e),delete u(this,o,"f")[u(this,a,"f")],c(this,a,u(this,a,"f")+1,"f")}u(this,a,"f")===u(this,s,"f")&&this.cleanupCallback()}else u(this,o,"f")[t]=n})}cleanupCallback(){window.__TAURI_INTERNALS__.unregisterCallback(this.id)}set onmessage(e){c(this,i,e,"f")}get onmessage(){return u(this,i,"f")}[(i=new WeakMap,a=new WeakMap,o=new WeakMap,s=new WeakMap,d)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[d]()}}async function f(e,t={},n){return window.__TAURI_INTERNALS__.invoke(e,t,n)}class g{get rid(){return u(this,l,"f")}constructor(e){l.set(this,void 0),c(this,l,e,"f")}async close(){return f("plugin:resources|close",{rid:this.rid})}}l=new WeakMap},907(__unused_rspack___webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{_K:()=>me,qY:()=>St,wV:()=>LT});var si,Ar,sr,NT,op,ap,up,ot,me,cp,dp,Cs,fp,hp,mp,gp,bp,Or,vo,_p,vp,xp,Tp,dt,St,li,Sp,$t,yt,ur,lr,ci,LT,PT=Object.create,ai=Object.defineProperty,ET=Object.getOwnPropertyDescriptor,CT=Object.getOwnPropertyNames,DT=Object.getPrototypeOf,kT=Object.prototype.hasOwnProperty,Os=(e=>"u">typeof require?require:"u">typeof Proxy?new Proxy(e,{get:(e,t)=>("u">typeof require?require:e)[t]}):e)(function(e){if("u">typeof require)return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),k=(e,t)=>()=>(e&&(t=e(e=0)),t),oe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),$r=(e,t)=>{for(var n in t)ai(e,n,{get:t[n],enumerable:!0})},rp=(e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let a of CT(t))kT.call(e,a)||a===n||ai(e,a,{get:()=>t[a],enumerable:!(i=ET(t,a))||i.enumerable});return e},ve=(e,t,n)=>(n=null!=e?PT(DT(e)):{},rp(!t&&e&&e.__esModule?n:ai(n,"default",{value:e,enumerable:!0}),e)),Jr=e=>rp(ai({},"__esModule",{value:!0}),e),Ps=k(()=>{si=new Map,Ar=[],sr=(e,t,n)=>{if(t&&"function"==typeof t.init&&"function"==typeof t.createInferenceSessionHandler){let i=si.get(e);if(void 0===i)si.set(e,{backend:t,priority:n});else{if(i.priority>n)return;if(i.priority===n&&i.backend!==t)throw Error(`cannot register backend "${e}" using priority ${n}`)}if(n>=0){let t=Ar.indexOf(e);-1!==t&&Ar.splice(t,1);for(let t=0;t<Ar.length;t++)if(si.get(Ar[t]).priority<=n)return void Ar.splice(t,0,e);Ar.push(e)}return}throw TypeError("not a valid backend")},NT=async e=>{let t=si.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{let n=!!t.initPromise;try{return n||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(e){return n||(t.error=`${e}`,t.aborted=!0),t.error}finally{delete t.initPromise}}},op=async e=>{let t=e.executionProviders||[],n=t.map(e=>"string"==typeof e?e:e.name),i=0===n.length?Ar:n,a,o=[],s=new Set;for(let e of i){let t=await NT(e);"string"==typeof t?o.push({name:e,err:t}):(a||(a=t),a===t&&s.add(e))}if(!a)throw Error(`no available backend found. ERR: ${o.map(e=>`[${e.name}] ${e.err}`).join(", ")}`);for(let{name:e,err:t}of o)n.includes(e)&&console.warn(`removing requested execution provider "${e}" from session options because it is not available: ${t}`);let l=t.filter(e=>s.has("string"==typeof e?e:e.name));return[a,new Proxy(e,{get:(e,t)=>"executionProviders"===t?l:Reflect.get(e,t)})]}}),ip=k(()=>{Ps()}),sp=k(()=>{ap="1.23.2"}),Es=k(()=>{sp(),up="warning",Object.defineProperty(ot={wasm:{},webgl:{},webgpu:{},versions:{common:ap},set logLevel(r){if(void 0!==r){if("string"!=typeof r||-1===["verbose","info","warning","error","fatal"].indexOf(r))throw Error(`Unsupported logging level: ${r}`);up=r}},get logLevel(){return up}},"logLevel",{enumerable:!0})}),lp=k(()=>{Es(),me=ot}),pp=k(()=>{cp=(e,t)=>{let n="u">typeof document?document.createElement("canvas"):new OffscreenCanvas(1,1);n.width=e.dims[3],n.height=e.dims[2];let i=n.getContext("2d");if(null!=i){let a,o;t?.tensorLayout!==void 0&&"NHWC"===t.tensorLayout?(a=e.dims[2],o=e.dims[3]):(a=e.dims[3],o=e.dims[2]);let s=t?.format!==void 0?t.format:"RGB",l=t?.norm,u,c;void 0===l||void 0===l.mean?u=[255,255,255,255]:"number"==typeof l.mean?u=[l.mean,l.mean,l.mean,l.mean]:(u=[l.mean[0],l.mean[1],l.mean[2],0],void 0!==l.mean[3]&&(u[3]=l.mean[3])),void 0===l||void 0===l.bias?c=[0,0,0,0]:"number"==typeof l.bias?c=[l.bias,l.bias,l.bias,l.bias]:(c=[l.bias[0],l.bias[1],l.bias[2],0],void 0!==l.bias[3]&&(c[3]=l.bias[3]));let d=o*a,p=0,h=d,f=2*d,g=-1;"RGBA"===s?(p=0,h=d,f=2*d,g=3*d):"RGB"===s?(p=0,h=d,f=2*d):"RBG"===s&&(p=0,f=d,h=2*d);for(let t=0;t<o;t++)for(let n=0;n<a;n++)i.fillStyle="rgba("+(e.data[p++]-c[0])*u[0]+","+(e.data[h++]-c[1])*u[1]+","+(e.data[f++]-c[2])*u[2]+","+(-1===g?255:(e.data[g++]-c[3])*u[3])+")",i.fillRect(n,t,1,1);if("toDataURL"in n)return n.toDataURL();throw Error("toDataURL is not supported")}throw Error("Can not access image data")},dp=(e,t)=>{let n="u">typeof document?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),i;if(null!=n){let a,o,s;t?.tensorLayout!==void 0&&"NHWC"===t.tensorLayout?(a=e.dims[2],o=e.dims[1],s=e.dims[3]):(a=e.dims[3],o=e.dims[2],s=e.dims[1]);let l=void 0!==t&&void 0!==t.format?t.format:"RGB",u=t?.norm,c,d;void 0===u||void 0===u.mean?c=[255,255,255,255]:"number"==typeof u.mean?c=[u.mean,u.mean,u.mean,u.mean]:(c=[u.mean[0],u.mean[1],u.mean[2],255],void 0!==u.mean[3]&&(c[3]=u.mean[3])),void 0===u||void 0===u.bias?d=[0,0,0,0]:"number"==typeof u.bias?d=[u.bias,u.bias,u.bias,u.bias]:(d=[u.bias[0],u.bias[1],u.bias[2],0],void 0!==u.bias[3]&&(d[3]=u.bias[3]));let p=o*a;if(void 0!==t&&(void 0!==t.format&&4===s&&"RGBA"!==t.format||3===s&&"RGB"!==t.format&&"BGR"!==t.format))throw Error("Tensor format doesn't match input tensor dims");let h=4,f=0,g=1,m=2,y=3,b=0,v=p,x=2*p,w=-1;"RGBA"===l?(b=0,v=p,x=2*p,w=3*p):"RGB"===l?(b=0,v=p,x=2*p):"RBG"===l&&(b=0,x=p,v=2*p),i=n.createImageData(a,o);for(let t=0;t<o*a;f+=h,g+=h,m+=h,y+=h,t++)i.data[f]=(e.data[b++]-d[0])*c[0],i.data[g]=(e.data[v++]-d[1])*c[1],i.data[m]=(e.data[x++]-d[2])*c[2],i.data[y]=-1===w?255:(e.data[w++]-d[3])*c[3]}else throw Error("Can not access image data");return i}}),yp=k(()=>{ui(),Cs=(e,t)=>{if(void 0===e)throw Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw Error("NHWC Tensor layout is not supported yet");let{height:n,width:i}=t,a=t.norm??{mean:255,bias:0},o,s;o="number"==typeof a.mean?[a.mean,a.mean,a.mean,a.mean]:[a.mean[0],a.mean[1],a.mean[2],a.mean[3]??255],s="number"==typeof a.bias?[a.bias,a.bias,a.bias,a.bias]:[a.bias[0],a.bias[1],a.bias[2],a.bias[3]??0];let l=void 0!==t.format?t.format:"RGBA",u=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",c=n*i,d=new Float32Array("RGBA"===u?4*c:3*c),p=4,h=0,f=1,g=2,m=3,y=0,b=c,v=2*c,x=-1;"RGB"===l&&(p=3,h=0,f=1,g=2,m=-1),"RGBA"===u?x=3*c:"RBG"===u?(y=0,v=c,b=2*c):"BGR"===u&&(v=0,b=c,y=2*c);for(let t=0;t<c;t++,h+=p,g+=p,f+=p,m+=p)d[y++]=(e[h]+s[0])/o[0],d[b++]=(e[f]+s[1])/o[1],d[v++]=(e[g]+s[2])/o[2],-1!==x&&-1!==m&&(d[x++]=(e[m]+s[3])/o[3]);return"RGBA"===u?new dt("float32",d,[1,4,n,i]):new dt("float32",d,[1,3,n,i])},fp=async(e,t)=>{let n="u">typeof HTMLImageElement&&e instanceof HTMLImageElement,i="u">typeof ImageData&&e instanceof ImageData,a="u">typeof ImageBitmap&&e instanceof ImageBitmap,o="string"==typeof e,s,l=t??{},u=()=>{if("u">typeof document)return document.createElement("canvas");if("u">typeof OffscreenCanvas)return new OffscreenCanvas(1,1);throw Error("Canvas is not supported")},c=e=>"u">typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas?e.getContext("2d"):null;if(n){let n=u();n.width=e.width,n.height=e.height;let i=c(n);if(null!=i){let n=e.height,a=e.width;if(void 0!==t&&void 0!==t.resizedHeight&&void 0!==t.resizedWidth&&(n=t.resizedHeight,a=t.resizedWidth),void 0!==t){if(l=t,void 0!==t.tensorFormat)throw Error("Image input config format must be RGBA for HTMLImageElement");l.tensorFormat="RGBA",l.height=n,l.width=a}else l.tensorFormat="RGBA",l.height=n,l.width=a;i.drawImage(e,0,0),s=i.getImageData(0,0,a,n).data}else throw Error("Can not access image data")}else if(i){let n,i;if(void 0!==t&&void 0!==t.resizedWidth&&void 0!==t.resizedHeight?(n=t.resizedHeight,i=t.resizedWidth):(n=e.height,i=e.width),void 0!==t&&(l=t),l.format="RGBA",l.height=n,l.width=i,void 0!==t){let t=u();t.width=i,t.height=n;let a=c(t);if(null!=a)a.putImageData(e,0,0),s=a.getImageData(0,0,i,n).data;else throw Error("Can not access image data")}else s=e.data}else if(a){if(void 0===t)throw Error("Please provide image config with format for Imagebitmap");let n=u();n.width=e.width,n.height=e.height;let i=c(n);if(null!=i){let t=e.height,n=e.width;return i.drawImage(e,0,0,n,t),s=i.getImageData(0,0,n,t).data,l.height=t,l.width=n,Cs(s,l)}throw Error("Can not access image data")}else{if(o)return new Promise((t,n)=>{let i=u(),a=c(i);if(!e||!a)return n();let o=new Image;o.crossOrigin="Anonymous",o.src=e,o.onload=()=>{i.width=o.width,i.height=o.height,a.drawImage(o,0,0,i.width,i.height);let e=a.getImageData(0,0,i.width,i.height);l.height=i.height,l.width=i.width,t(Cs(e.data,l))}});throw Error("Input data provided is not supported - aborted tensor creation")}if(void 0!==s)return Cs(s,l);throw Error("Input data provided is not supported - aborted tensor creation")},hp=(e,t)=>{let{width:n,height:i,download:a,dispose:o}=t;return new dt({location:"texture",type:"float32",texture:e,dims:[1,i,n,4],download:a,dispose:o})},mp=(e,t)=>{let{dataType:n,dims:i,download:a,dispose:o}=t;return new dt({location:"gpu-buffer",type:n??"float32",gpuBuffer:e,dims:i,download:a,dispose:o})},gp=(e,t)=>{let{dataType:n,dims:i,download:a,dispose:o}=t;return new dt({location:"ml-tensor",type:n??"float32",mlTensor:e,dims:i,download:a,dispose:o})},bp=(e,t,n)=>new dt({location:"cpu-pinned",type:e,data:t,dims:n??[t.length]})}),wp=k(()=>{Or=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),vo=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),_p=!1,vp=()=>{if(!_p){_p=!0;let e="u">typeof BigInt64Array&&BigInt64Array.from,t="u">typeof BigUint64Array&&BigUint64Array.from,n=globalThis.Float16Array,i="u">typeof n&&n.from;e&&(Or.set("int64",BigInt64Array),vo.set(BigInt64Array,"int64")),t&&(Or.set("uint64",BigUint64Array),vo.set(BigUint64Array,"uint64")),i?(Or.set("float16",n),vo.set(n,"float16")):Or.set("float16",Uint16Array)}}}),Ip=k(()=>{ui(),xp=e=>{let t=1;for(let n=0;n<e.length;n++){let i=e[n];if("number"!=typeof i||!Number.isSafeInteger(i))throw TypeError(`dims[${n}] must be an integer, got: ${i}`);if(i<0)throw RangeError(`dims[${n}] must be a non-negative integer, got: ${i}`);t*=i}return t},Tp=(e,t)=>{switch(e.location){case"cpu":return new dt(e.type,e.data,t);case"cpu-pinned":return new dt({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new dt({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new dt({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});case"ml-tensor":return new dt({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:t});default:throw Error(`tensorReshape: tensor location ${e.location} is not supported`)}}}),ui=k(()=>{pp(),yp(),wp(),Ip(),dt=class{constructor(e,t,n){let i,a;if(vp(),"object"==typeof e&&"location"in e)switch(this.dataLocation=e.location,i=e.type,a=e.dims,e.location){case"cpu-pinned":{let t=Or.get(i);if(!t)throw TypeError(`unsupported type "${i}" to create tensor from pinned buffer`);if(!(e.data instanceof t))throw TypeError(`buffer should be of type ${t.name}`);this.cpuData=e.data;break}case"texture":if("float32"!==i)throw TypeError(`unsupported type "${i}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break;case"gpu-buffer":if("float32"!==i&&"float16"!==i&&"int32"!==i&&"int64"!==i&&"uint32"!==i&&"uint8"!==i&&"bool"!==i&&"uint4"!==i&&"int4"!==i)throw TypeError(`unsupported type "${i}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break;case"ml-tensor":if("float32"!==i&&"float16"!==i&&"int32"!==i&&"int64"!==i&&"uint32"!==i&&"uint64"!==i&&"int8"!==i&&"uint8"!==i&&"bool"!==i&&"uint4"!==i&&"int4"!==i)throw TypeError(`unsupported type "${i}" to create tensor from MLTensor`);this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break;default:throw Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let o,s;if("string"==typeof e)if(i=e,s=n,"string"===e){if(!Array.isArray(t))throw TypeError("A string tensor's data must be a string array.");o=t}else{let n=Or.get(e);if(void 0===n)throw TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if("float16"===e&&n===Uint16Array||"uint4"===e||"int4"===e)throw TypeError(`Creating a ${e} tensor from number array is not supported. Please use ${n.name} as data.`);o="uint64"===e||"int64"===e?n.from(t,BigInt):n.from(t)}else if(t instanceof n)o=t;else if(t instanceof Uint8ClampedArray)if("uint8"===e)o=Uint8Array.from(t);else throw TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if("float16"===e&&t instanceof Uint16Array&&n!==Uint16Array)o=new globalThis.Float16Array(t.buffer,t.byteOffset,t.length);else throw TypeError(`A ${i} tensor's data must be type of ${n}`)}else if(s=t,Array.isArray(e)){if(0===e.length)throw TypeError("Tensor type cannot be inferred from an empty array.");let t=typeof e[0];if("string"===t)i="string",o=e;else if("boolean"===t)i="bool",o=Uint8Array.from(e);else throw TypeError(`Invalid element type of data array: ${t}.`)}else if(e instanceof Uint8ClampedArray)i="uint8",o=Uint8Array.from(e);else{let t=vo.get(e.constructor);if(void 0===t)throw TypeError(`Unsupported type for tensor data: ${e.constructor}.`);i=t,o=e}if(void 0===s)s=[o.length];else if(!Array.isArray(s))throw TypeError("A tensor's dims must be a number array");a=s,this.cpuData=o,this.dataLocation="cpu"}let o=xp(a);if(this.cpuData&&o!==this.cpuData.length&&("uint4"!==i&&"int4"!==i||Math.ceil(o/2)!==this.cpuData.length))throw Error(`Tensor's size(${o}) does not match data length(${this.cpuData.length}).`);this.type=i,this.dims=a,this.size=o}static async fromImage(e,t){return fp(e,t)}static fromTexture(e,t){return hp(e,t)}static fromGpuBuffer(e,t){return mp(e,t)}static fromMLTensor(e,t){return gp(e,t)}static fromPinnedBuffer(e,t,n){return bp(e,t,n)}toDataURL(e){return cp(this,e)}toImageData(e){return dp(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":if(!this.downloader)throw Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}default:throw Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if("none"===this.dataLocation)throw Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw Error("Cannot reshape a tensor that owns GPU resource.");return Tp(this,e)}}}),Ds=k(()=>{ui(),St=dt}),ks=k(()=>{Es(),li=(e,t)=>{(typeof ot.trace>"u"?ot.wasm.trace:ot.trace)&&console.timeStamp(`${e}::ORT::${t}`)},Sp=(e,t)=>{let n=Error().stack?.split(/\r\n|\r|\n/g)||[],i=!1;for(let a=0;a<n.length;a++){if(i&&!n[a].includes("TRACE_FUNC")){let i=`FUNC_${e}::${n[a].trim().split(" ")[1]}`;t&&(i+=`::${t}`),li("CPU",i);return}n[a].includes("TRACE_FUNC")&&(i=!0)}},$t=e=>{(typeof ot.trace>"u"?ot.wasm.trace:ot.trace)&&Sp("BEGIN",e)},yt=e=>{(typeof ot.trace>"u"?ot.wasm.trace:ot.trace)&&Sp("END",e)},ur=e=>{(typeof ot.trace>"u"?ot.wasm.trace:ot.trace)&&console.time(`ORT::${e}`)},lr=e=>{(typeof ot.trace>"u"?ot.wasm.trace:ot.trace)&&console.timeEnd(`ORT::${e}`)}}),$p=k(()=>{Ps(),Ds(),ks(),ci=class e{constructor(e){this.handler=e}async run(e,t,n){$t(),ur("InferenceSession.run");let i={},a={};if("object"!=typeof e||null===e||e instanceof St||Array.isArray(e))throw TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let o=!0;if("object"==typeof t){if(null===t)throw TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof St)throw TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(0===t.length)throw TypeError("'fetches' cannot be an empty array.");for(let e of(o=!1,t)){if("string"!=typeof e)throw TypeError("'fetches' must be a string array or an object.");if(-1===this.outputNames.indexOf(e))throw RangeError(`'fetches' contains invalid output name: ${e}.`);i[e]=null}if("object"==typeof n&&null!==n)a=n;else if("u">typeof n)throw TypeError("'options' must be an object.")}else{let e=!1,s=Object.getOwnPropertyNames(t);for(let n of this.outputNames)if(-1!==s.indexOf(n)){let a=t[n];(null===a||a instanceof St)&&(e=!0,o=!1,i[n]=a)}if(e){if("object"==typeof n&&null!==n)a=n;else if("u">typeof n)throw TypeError("'options' must be an object.")}else a=t}}else if("u">typeof t)throw TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let t of this.inputNames)if(typeof e[t]>"u")throw Error(`input '${t}' is missing in 'feeds'.`);if(o)for(let e of this.outputNames)i[e]=null;let s=await this.handler.run(e,i,a),l={};for(let e in s)if(Object.hasOwnProperty.call(s,e)){let t=s[e];t instanceof St?l[e]=t:l[e]=new St(t.type,t.data,t.dims)}return lr("InferenceSession.run"),yt(),l}async release(){return this.handler.dispose()}static async create(t,n,i,a){$t(),ur("InferenceSession.create");let o,s={};if("string"==typeof t){if(o=t,"object"==typeof n&&null!==n)s=n;else if("u">typeof n)throw TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(o=t,"object"==typeof n&&null!==n)s=n;else if("u">typeof n)throw TypeError("'options' must be an object.")}else if(t instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&t instanceof SharedArrayBuffer){let e=t,l=0,u=t.byteLength;if("object"==typeof n&&null!==n)s=n;else if("number"==typeof n){if(!Number.isSafeInteger(l=n))throw RangeError("'byteOffset' must be an integer.");if(l<0||l>=e.byteLength)throw RangeError(`'byteOffset' is out of range [0, ${e.byteLength}).`);if(u=t.byteLength-l,"number"==typeof i){if(!Number.isSafeInteger(u=i))throw RangeError("'byteLength' must be an integer.");if(u<=0||l+u>e.byteLength)throw RangeError(`'byteLength' is out of range (0, ${e.byteLength-l}].`);if("object"==typeof a&&null!==a)s=a;else if("u">typeof a)throw TypeError("'options' must be an object.")}else if("u">typeof i)throw TypeError("'byteLength' must be a number.")}else if("u">typeof n)throw TypeError("'options' must be an object.");o=new Uint8Array(e,l,u)}else throw TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[l,u]=await op(s),c=await l.createInferenceSessionHandler(o,u);return lr("InferenceSession.create"),yt(),new e(c)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}get inputMetadata(){return this.handler.inputMetadata}get outputMetadata(){return this.handler.outputMetadata}}}),Ap=k(()=>{$p(),LT=ci}),Op=k(()=>{}),Pp=k(()=>{}),Ep=k(()=>{}),Cp=k(()=>{}),Ns={};$r(Ns,{InferenceSession:()=>LT,TRACE:()=>li,TRACE_EVENT_BEGIN:()=>ur,TRACE_EVENT_END:()=>lr,TRACE_FUNC_BEGIN:()=>$t,TRACE_FUNC_END:()=>yt,Tensor:()=>St,env:()=>me,registerBackend:()=>sr});var pt=k(()=>{ip(),lp(),Ap(),Ds(),Op(),Pp(),ks(),Ep(),Cp()});function cr(e,t,n,i){if(void 0===t)return zT(e);if(void 0===n)di(e,t,1);else if("number"==typeof n&&void 0===i)di(e,t,n);else if("string"==typeof n&&void 0===i)di(e,n,1,t);else if("string"==typeof n&&"number"==typeof i)di(e,n,i,t);else throw TypeError("input is valid")}function zT(e){return{verbose:cr.verbose.bind(null,e),info:cr.info.bind(null,e),warning:cr.warning.bind(null,e),error:cr.error.bind(null,e),fatal:cr.fatal.bind(null,e)}}function di(e,t,n,i){let a=wo[i||""]||wo[""];kp[e]<kp[a.minimalSeverity]||(a.logDateTime&&(t=`${new Date().toISOString()}|${t}`),a.logSourceLocation,RT[a.provider].log(e,t,i))}var Ls,Rs,kp,RT,Np,wo,Fe,fi,hi,mi,pi,Ct=k(()=>{Ls=class{log(e,t,n){}},Rs=class{log(e,t,n){console.log(`${this.color(e)} ${n?"\x1b[35m"+n+"\x1b[0m ":""}${t}`)}color(e){switch(e){case"verbose":return"\x1b[34;40mv\x1b[0m";case"info":return"\x1b[32mi\x1b[0m";case"warning":return"\x1b[30;43mw\x1b[0m";case"error":return"\x1b[31;40me\x1b[0m";case"fatal":return"\x1b[101mf\x1b[0m";default:throw Error(`unsupported severity: ${e}`)}}},kp={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},RT={none:new Ls,console:new Rs},wo={"":Np={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1}},(e=>{function t(t,n){e("verbose",t,n)}function n(t,n){e("info",t,n)}function i(t,n){e("warning",t,n)}function a(t,n){e("error",t,n)}function o(t,n){e("fatal",t,n)}function s(e){wo={},l("",e||{})}function l(e,t){if("*"===e)s(t);else{let n=wo[e]||Np;wo[e]={provider:t.provider||n.provider,minimalSeverity:t.minimalSeverity||n.minimalSeverity,logDateTime:void 0===t.logDateTime?n.logDateTime:t.logDateTime,logSourceLocation:void 0===t.logSourceLocation?n.logSourceLocation:t.logSourceLocation}}}e.verbose=t,e.info=n,e.warning=i,e.error=a,e.fatal=o,e.reset=s,e.set=l,e.setWithEnv=function(e){let t={};e.logLevel&&(t.minimalSeverity=e.logLevel),l("",t)}})(cr||={}),Fe=cr,fi=class{constructor(e,t,n,i,a,o){this.category=e,this.name=t,this.startTime=n,this.endCallback=i,this.timer=a,this.ctx=o}async end(){return this.endCallback(this)}async checkTimer(){if(void 0===this.ctx||void 0===this.timer)throw Error("No webgl timer found");return this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)}},hi=class{constructor(e,t,n,i){this.category=e,this.name=t,this.startTime=n,this.endTime=i}},mi=class{constructor(e,t,n){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=void 0===e?1e4:e,this._flushBatchSize=void 0===t?10:t,this._flushIntervalInMilliseconds=void 0===n?5e3:n}static create(e){return void 0===e?new this:new this(e.maxNumberEvents,e.flushBatchSize,e.flushIntervalInMilliseconds)}start(){this._started=!0,this._timingEvents=[],this._flushTime=pi(),this._flushPointer=0}stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}event(e,t,n,i){let a=this._started?this.begin(e,t,i):void 0,o=!1,s=n();if(s&&"function"==typeof s.then)return o=!0,new Promise((e,t)=>{s.then(async t=>{a&&await a.end(),e(t)},async e=>{a&&await a.end(),t(e)})});if(!o&&a){let e=a.end();if(e&&"function"==typeof e.then)return new Promise((t,n)=>{e.then(()=>{t(s)},e=>{n(e)})})}return s}begin(e,t,n){if(!this._started)throw Error("profiler is not started yet");if(void 0!==n)return new fi(e,t,0,async e=>this.end(e),n.beginTimer(),n);{let n=pi();return this.flush(n),new fi(e,t,n,e=>this.endSync(e))}}async end(e){let t=await e.checkTimer();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new hi(e.category,e.name,e.startTime,t)),this.flush(t))}endSync(e){let t=pi();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new hi(e.category,e.name,e.startTime,t)),this.flush(t))}logOneEvent(e){Fe.verbose(`Profiler.${e.category}`,`${(e.endTime-e.startTime).toFixed(2)}ms on event '${e.name}' at ${e.endTime.toFixed(2)}`)}flush(e){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||e-this._flushTime>=this._flushIntervalInMilliseconds){for(let e=this._flushPointer;this._flushPointer<e+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=pi()}}get started(){return this._started}},pi="u">typeof performance&&performance.now?()=>performance.now():Date.now});function Lp(e,t,n){for(let i of n){let n=i[0],a=i[1],o=i[2],s=i[3],l=i[4];if(e.opType===n){for(let e of t)if((e.domain===a||"ai.onnx"===e.domain&&""===a)&&MT(e.version,o))return{opImpl:s,opInit:l}}}throw TypeError(`cannot resolve operator '${e.opType}' with opsets: ${t.map(e=>`${e.domain||"ai.onnx"} v${e.version}`).join(", ")}`)}function MT(e,t){if(t.endsWith("+")){let n=Number.parseInt(t.substring(0,t.length-1),10);return!isNaN(n)&&n<=e}if(2!==t.split("-").length)return Number.parseInt(t,10)===e;{let n=t.split("-"),i=Number.parseInt(n[0],10),a=Number.parseInt(n[1],10);return!isNaN(i)&&!isNaN(a)&&i<=e&&e<=a}}var Rp=k(()=>{}),zp=oe(e=>{e.__esModule=!0,e.Guid=function(){function e(t){if(!t)throw TypeError("Invalid argument; `value` has no value.");this.value=e.EMPTY,t&&e.isGuid(t)&&(this.value=t)}return e.isGuid=function(t){var n=t.toString();return t&&(t instanceof e||e.validator.test(n))},e.create=function(){return new e([e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-"))},e.createEmpty=function(){return new e("emptyguid")},e.parse=function(t){return new e(t)},e.raw=function(){return[e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-")},e.gen=function(e){for(var t="",n=0;n<e;n++)t+=((1+Math.random())*65536|0).toString(16).substring(1);return t},e.prototype.equals=function(t){return e.isGuid(t)&&this.value===t.toString()},e.prototype.isEmpty=function(){return this.value===e.EMPTY},e.prototype.toString=function(){return this.value},e.prototype.toJSON=function(){return{value:this.value}},e.validator=RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),e.EMPTY="00000000-0000-0000-0000-000000000000",e}()});function Ge(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function ht(e){return(e&&e.__isLong__)===!0}function Mp(e){var t=Math.clz32(e&-e);return e?31-t:t}function Pr(e,t){var n,i,a;return t?(e>>>=0,(a=0<=e&&e<256)&&(i=Fp[e])?i:(n=Re(e,0,!0),a&&(Fp[e]=n),n)):(e|=0,(a=-128<=e&&e<128)&&(i=Bp[e])?i:(n=Re(e,e<0?-1:0,!1),a&&(Bp[e]=n),n))}function kt(e,t){if(isNaN(e))return t?Zn:Gt;if(t){if(e<0)return Zn;if(e>=Wp)return qp}else{if(e<=-Gp)return _t;if(e+1>=Gp)return jp}return e<0?kt(-e,t).neg():Re(e%Qr|0,e/Qr|0,t)}function Re(e,t,n){return new Ge(e,t,n)}function Bs(e,t,n){if(0===e.length)throw Error("empty string");if("number"==typeof t?(n=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?Zn:Gt;if((n=n||10)<2||36<n)throw RangeError("radix");if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return Bs(e.substring(1),t,n).neg();for(var i,a=kt(gi(n,8)),o=Gt,s=0;s<e.length;s+=8){var l=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+l),n);if(l<8){var c=kt(gi(n,l));o=o.mul(c).add(kt(u))}else o=(o=o.mul(a)).add(kt(u))}return o.unsigned=t,o}function Ut(e,t){return"number"==typeof e?kt(e,t):"string"==typeof e?Bs(e,t):Re(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}var Dt,Bp,Fp,gi,Vp,FT,Qr,Wp,Gp,Up,Gt,Zn,Yr,Hp,Ms,jp,qp,_t,j,dr,R1,z1,Pi,Lt,M1,B1,F1,V1,G1,U1,W1,H1,el,tl,j1,q1,K1,X1,nl,Z1,J1,Y1,Q1,eS,tS,nS,rS,oS,iS,aS,sS,uS,So,rl,lS,ol,cS,Fs=k(()=>{Dt=null;try{Dt=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}Ge.prototype.__isLong__,Object.defineProperty(Ge.prototype,"__isLong__",{value:!0}),Ge.isLong=ht,Bp={},Fp={},Ge.fromInt=Pr,Ge.fromNumber=kt,Ge.fromBits=Re,gi=Math.pow,Ge.fromString=Bs,Ge.fromValue=Ut,FT=0x1000000,Gp=(Wp=(Qr=(Vp=65536)*Vp)*Qr)/2,Up=Pr(FT),Ge.ZERO=Gt=Pr(0),Ge.UZERO=Zn=Pr(0,!0),Ge.ONE=Yr=Pr(1),Ge.UONE=Hp=Pr(1,!0),Ge.NEG_ONE=Ms=Pr(-1),Ge.MAX_VALUE=jp=Re(-1,0x7fffffff,!1),Ge.MAX_UNSIGNED_VALUE=qp=Re(-1,-1,!0),Ge.MIN_VALUE=_t=Re(0,-0x80000000,!1),(j=Ge.prototype).toInt=function(){return this.unsigned?this.low>>>0:this.low},j.toNumber=function(){return this.unsigned?(this.high>>>0)*Qr+(this.low>>>0):this.high*Qr+(this.low>>>0)},j.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(!this.eq(_t))return"-"+this.neg().toString(e);else{var t=kt(e),n=this.div(t),i=n.mul(t).sub(this);return n.toString(e)+i.toInt().toString(e)}for(var a=kt(gi(e,6),this.unsigned),o=this,s="";;){var l=o.div(a),u=(o.sub(l.mul(a)).toInt()>>>0).toString(e);if((o=l).isZero())return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}},j.getHighBits=function(){return this.high},j.getHighBitsUnsigned=function(){return this.high>>>0},j.getLowBits=function(){return this.low},j.getLowBitsUnsigned=function(){return this.low>>>0},j.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_t)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return 0!=this.high?t+33:t+1},j.isZero=function(){return 0===this.high&&0===this.low},j.eqz=j.isZero,j.isNegative=function(){return!this.unsigned&&this.high<0},j.isPositive=function(){return this.unsigned||this.high>=0},j.isOdd=function(){return(1&this.low)==1},j.isEven=function(){return(1&this.low)==0},j.equals=function(e){return ht(e)||(e=Ut(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},j.eq=j.equals,j.notEquals=function(e){return!this.eq(e)},j.neq=j.notEquals,j.ne=j.notEquals,j.lessThan=function(e){return 0>this.comp(e)},j.lt=j.lessThan,j.lessThanOrEqual=function(e){return 0>=this.comp(e)},j.lte=j.lessThanOrEqual,j.le=j.lessThanOrEqual,j.greaterThan=function(e){return this.comp(e)>0},j.gt=j.greaterThan,j.greaterThanOrEqual=function(e){return this.comp(e)>=0},j.gte=j.greaterThanOrEqual,j.ge=j.greaterThanOrEqual,j.compare=function(e){if(ht(e)||(e=Ut(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},j.comp=j.compare,j.negate=function(){return!this.unsigned&&this.eq(_t)?_t:this.not().add(Yr)},j.neg=j.negate,j.add=function(e){ht(e)||(e=Ut(e));var t,n,i=this.high>>>16,a=65535&this.high,o=this.low>>>16,s=65535&this.low,l=e.high>>>16,u=65535&e.high,c=e.low>>>16,d=65535&e.low,p=0,h=0;return n=0+((t=0+(s+d))>>>16),t&=65535,n+=o+c,h+=n>>>16,n&=65535,h+=a+u,p+=h>>>16,h&=65535,p+=i+l,Re(n<<16|t,(p&=65535)<<16|h,this.unsigned)},j.subtract=function(e){return ht(e)||(e=Ut(e)),this.add(e.neg())},j.sub=j.subtract,j.multiply=function(e){if(this.isZero())return this;if(ht(e)||(e=Ut(e)),Dt)return Re(Dt.mul(this.low,this.high,e.low,e.high),Dt.get_high(),this.unsigned);if(e.isZero())return this.unsigned?Zn:Gt;if(this.eq(_t))return e.isOdd()?_t:Gt;if(e.eq(_t))return this.isOdd()?_t:Gt;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(Up)&&e.lt(Up))return kt(this.toNumber()*e.toNumber(),this.unsigned);var t,n,i=this.high>>>16,a=65535&this.high,o=this.low>>>16,s=65535&this.low,l=e.high>>>16,u=65535&e.high,c=e.low>>>16,d=65535&e.low,p=0,h=0;return n=0+((t=0+s*d)>>>16),t&=65535,n+=o*d,h+=n>>>16,n&=65535,n+=s*c,h+=n>>>16,n&=65535,h+=a*d,p+=h>>>16,h&=65535,h+=o*c,p+=h>>>16,h&=65535,h+=s*u,p+=h>>>16,h&=65535,p+=i*d+a*c+o*u+s*l,Re(n<<16|t,(p&=65535)<<16|h,this.unsigned)},j.mul=j.multiply,j.divide=function(e){if(ht(e)||(e=Ut(e)),e.isZero())throw Error("division by zero");if(Dt){var t,n,i;return this.unsigned||-0x80000000!==this.high||-1!==e.low||-1!==e.high?Re((this.unsigned?Dt.div_u:Dt.div_s)(this.low,this.high,e.low,e.high),Dt.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?Zn:Gt;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Zn;if(e.gt(this.shru(1)))return Hp;i=Zn}else{if(this.eq(_t))return e.eq(Yr)||e.eq(Ms)?_t:e.eq(_t)?Yr:(t=this.shr(1).div(e).shl(1)).eq(Gt)?e.isNegative()?Yr:Ms:(n=this.sub(e.mul(t)),i=t.add(n.div(e)));if(e.eq(_t))return this.unsigned?Zn:Gt;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=Gt}for(n=this;n.gte(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(t)/Math.LN2),o=a<=48?1:gi(2,a-48),s=kt(t),l=s.mul(e);l.isNegative()||l.gt(n);)t-=o,l=(s=kt(t,this.unsigned)).mul(e);s.isZero()&&(s=Yr),i=i.add(s),n=n.sub(l)}return i},j.div=j.divide,j.modulo=function(e){return(ht(e)||(e=Ut(e)),Dt)?Re((this.unsigned?Dt.rem_u:Dt.rem_s)(this.low,this.high,e.low,e.high),Dt.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},j.mod=j.modulo,j.rem=j.modulo,j.not=function(){return Re(~this.low,~this.high,this.unsigned)},j.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},j.clz=j.countLeadingZeros,j.countTrailingZeros=function(){return this.low?Mp(this.low):Mp(this.high)+32},j.ctz=j.countTrailingZeros,j.and=function(e){return ht(e)||(e=Ut(e)),Re(this.low&e.low,this.high&e.high,this.unsigned)},j.or=function(e){return ht(e)||(e=Ut(e)),Re(this.low|e.low,this.high|e.high,this.unsigned)},j.xor=function(e){return ht(e)||(e=Ut(e)),Re(this.low^e.low,this.high^e.high,this.unsigned)},j.shiftLeft=function(e){return ht(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?Re(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Re(0,this.low<<e-32,this.unsigned)},j.shl=j.shiftLeft,j.shiftRight=function(e){return ht(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?Re(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Re(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},j.shr=j.shiftRight,j.shiftRightUnsigned=function(e){return ht(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?Re(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):32===e?Re(this.high,0,this.unsigned):Re(this.high>>>e-32,0,this.unsigned)},j.shru=j.shiftRightUnsigned,j.shr_u=j.shiftRightUnsigned,j.rotateLeft=function(e){var t;return ht(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?Re(this.high,this.low,this.unsigned):e<32?(t=32-e,Re(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,Re(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},j.rotl=j.rotateLeft,j.rotateRight=function(e){var t;return ht(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?Re(this.high,this.low,this.unsigned):e<32?(t=32-e,Re(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,Re(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},j.rotr=j.rotateRight,j.toSigned=function(){return this.unsigned?Re(this.low,this.high,!1):this},j.toUnsigned=function(){return this.unsigned?this:Re(this.low,this.high,!0)},j.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},j.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},j.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Ge.fromBytes=function(e,t,n){return n?Ge.fromBytesLE(e,t):Ge.fromBytesBE(e,t)},Ge.fromBytesLE=function(e,t){return new Ge(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Ge.fromBytesBE=function(e,t){return new Ge(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},dr=Ge}),Vs=oe(e=>{var t;Object.defineProperty(e,"__esModule",{value:!0}),e.ArgType=void 0,function(e){e[e.INPUT=0]="INPUT",e[e.OUTPUT=1]="OUTPUT"}(t||(e.ArgType=t={}))}),Er=oe(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SIZE_PREFIX_LENGTH=e.FILE_IDENTIFIER_LENGTH=e.SIZEOF_INT=e.SIZEOF_SHORT=void 0,e.SIZEOF_SHORT=2,e.SIZEOF_INT=4,e.FILE_IDENTIFIER_LENGTH=4,e.SIZE_PREFIX_LENGTH=4}),Gs=oe(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isLittleEndian=e.float64=e.float32=e.int32=void 0,e.int32=new Int32Array(2),e.float32=new Float32Array(e.int32.buffer),e.float64=new Float64Array(e.int32.buffer),e.isLittleEndian=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0]}),Us=oe(e=>{var t;Object.defineProperty(e,"__esModule",{value:!0}),e.Encoding=void 0,function(e){e[e.UTF8_BYTES=1]="UTF8_BYTES",e[e.UTF16_STRING=2]="UTF16_STRING"}(t||(e.Encoding=t={}))}),Hs=oe(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ByteBuffer=void 0;var t=Er(),n=Gs(),i=Us();e.ByteBuffer=class e{constructor(e){this.bytes_=e,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new e(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(e){this.position_=e}capacity(){return this.bytes_.length}readInt8(e){return this.readUint8(e)<<24>>24}readUint8(e){return this.bytes_[e]}readInt16(e){return this.readUint16(e)<<16>>16}readUint16(e){return this.bytes_[e]|this.bytes_[e+1]<<8}readInt32(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24}readUint32(e){return this.readInt32(e)>>>0}readInt64(e){return BigInt.asIntN(64,BigInt(this.readUint32(e))+(BigInt(this.readUint32(e+4))<<BigInt(32)))}readUint64(e){return BigInt.asUintN(64,BigInt(this.readUint32(e))+(BigInt(this.readUint32(e+4))<<BigInt(32)))}readFloat32(e){return n.int32[0]=this.readInt32(e),n.float32[0]}readFloat64(e){return n.int32[+!n.isLittleEndian]=this.readInt32(e),n.int32[+!!n.isLittleEndian]=this.readInt32(e+4),n.float64[0]}writeInt8(e,t){this.bytes_[e]=t}writeUint8(e,t){this.bytes_[e]=t}writeInt16(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8}writeUint16(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8}writeInt32(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24}writeUint32(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24}writeInt64(e,t){this.writeInt32(e,Number(BigInt.asIntN(32,t))),this.writeInt32(e+4,Number(BigInt.asIntN(32,t>>BigInt(32))))}writeUint64(e,t){this.writeUint32(e,Number(BigInt.asUintN(32,t))),this.writeUint32(e+4,Number(BigInt.asUintN(32,t>>BigInt(32))))}writeFloat32(e,t){n.float32[0]=t,this.writeInt32(e,n.int32[0])}writeFloat64(e,t){n.float64[0]=t,this.writeInt32(e,n.int32[+!n.isLittleEndian]),this.writeInt32(e+4,n.int32[+!!n.isLittleEndian])}getBufferIdentifier(){if(this.bytes_.length<this.position_+t.SIZEOF_INT+t.FILE_IDENTIFIER_LENGTH)throw Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let e="";for(let n=0;n<t.FILE_IDENTIFIER_LENGTH;n++)e+=String.fromCharCode(this.readInt8(this.position_+t.SIZEOF_INT+n));return e}__offset(e,t){let n=e-this.readInt32(e);return t<this.readInt16(n)?this.readInt16(n+t):0}__union(e,t){return e.bb_pos=t+this.readInt32(t),e.bb=this,e}__string(e,n){e+=this.readInt32(e);let a=this.readInt32(e);e+=t.SIZEOF_INT;let o=this.bytes_.subarray(e,e+a);return n===i.Encoding.UTF8_BYTES?o:this.text_decoder_.decode(o)}__union_with_string(e,t){return"string"==typeof e?this.__string(t):this.__union(e,t)}__indirect(e){return e+this.readInt32(e)}__vector(e){return e+this.readInt32(e)+t.SIZEOF_INT}__vector_len(e){return this.readInt32(e+this.readInt32(e))}__has_identifier(e){if(e.length!=t.FILE_IDENTIFIER_LENGTH)throw Error("FlatBuffers: file identifier must be length "+t.FILE_IDENTIFIER_LENGTH);for(let n=0;n<t.FILE_IDENTIFIER_LENGTH;n++)if(e.charCodeAt(n)!=this.readInt8(this.position()+t.SIZEOF_INT+n))return!1;return!0}createScalarList(e,t){let n=[];for(let i=0;i<t;++i){let t=e(i);null!==t&&n.push(t)}return n}createObjList(e,t){let n=[];for(let i=0;i<t;++i){let t=e(i);null!==t&&n.push(t.unpack())}return n}}}),Jp=oe(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Builder=void 0;var t=Hs(),n=Er();e.Builder=class e{constructor(e){let n;this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder,n=e||1024,this.bb=t.ByteBuffer.allocate(n),this.space=n}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(e){this.force_defaults=e}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,n){t>this.minalign&&(this.minalign=t);let i=~(this.bb.capacity()-this.space+n)+1&t-1;for(;this.space<i+t+n;){let t=this.bb.capacity();this.bb=e.growByteBuffer(this.bb),this.space+=this.bb.capacity()-t}this.pad(i)}pad(e){for(let t=0;t<e;t++)this.bb.writeInt8(--this.space,0)}writeInt8(e){this.bb.writeInt8(this.space-=1,e)}writeInt16(e){this.bb.writeInt16(this.space-=2,e)}writeInt32(e){this.bb.writeInt32(this.space-=4,e)}writeInt64(e){this.bb.writeInt64(this.space-=8,e)}writeFloat32(e){this.bb.writeFloat32(this.space-=4,e)}writeFloat64(e){this.bb.writeFloat64(this.space-=8,e)}addInt8(e){this.prep(1,0),this.writeInt8(e)}addInt16(e){this.prep(2,0),this.writeInt16(e)}addInt32(e){this.prep(4,0),this.writeInt32(e)}addInt64(e){this.prep(8,0),this.writeInt64(e)}addFloat32(e){this.prep(4,0),this.writeFloat32(e)}addFloat64(e){this.prep(8,0),this.writeFloat64(e)}addFieldInt8(e,t,n){(this.force_defaults||t!=n)&&(this.addInt8(t),this.slot(e))}addFieldInt16(e,t,n){(this.force_defaults||t!=n)&&(this.addInt16(t),this.slot(e))}addFieldInt32(e,t,n){(this.force_defaults||t!=n)&&(this.addInt32(t),this.slot(e))}addFieldInt64(e,t,n){(this.force_defaults||t!==n)&&(this.addInt64(t),this.slot(e))}addFieldFloat32(e,t,n){(this.force_defaults||t!=n)&&(this.addFloat32(t),this.slot(e))}addFieldFloat64(e,t,n){(this.force_defaults||t!=n)&&(this.addFloat64(t),this.slot(e))}addFieldOffset(e,t,n){(this.force_defaults||t!=n)&&(this.addOffset(t),this.slot(e))}addFieldStruct(e,t,n){t!=n&&(this.nested(t),this.slot(e))}nested(e){if(e!=this.offset())throw TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw TypeError("FlatBuffers: object serialization must not be nested.")}slot(e){null!==this.vtable&&(this.vtable[e]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(e){let n=e.capacity();if(0xc0000000&n)throw Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");let i=n<<1,a=t.ByteBuffer.allocate(i);return a.setPosition(i-n),a.bytes().set(e.bytes(),i-n),a}addOffset(e){this.prep(n.SIZEOF_INT,0),this.writeInt32(this.offset()-e+n.SIZEOF_INT)}startObject(e){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=e;for(let t=0;t<e;t++)this.vtable[t]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(null==this.vtable||!this.isNested)throw Error("FlatBuffers: endObject called without startObject");this.addInt32(0);let e=this.offset(),t=this.vtable_in_use-1;for(;t>=0&&0==this.vtable[t];t--);let i=t+1;for(;t>=0;t--)this.addInt16(0!=this.vtable[t]?e-this.vtable[t]:0);let a=2;this.addInt16(e-this.object_start);let o=(i+a)*n.SIZEOF_SHORT;this.addInt16(o);let s=0,l=this.space;n:for(t=0;t<this.vtables.length;t++){let e=this.bb.capacity()-this.vtables[t];if(o==this.bb.readInt16(e)){for(let t=n.SIZEOF_SHORT;t<o;t+=n.SIZEOF_SHORT)if(this.bb.readInt16(l+t)!=this.bb.readInt16(e+t))continue n;s=this.vtables[t];break}}return s?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,s-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e}finish(e,t,i){let a=i?n.SIZE_PREFIX_LENGTH:0;if(t){let e=t;if(this.prep(this.minalign,n.SIZEOF_INT+n.FILE_IDENTIFIER_LENGTH+a),e.length!=n.FILE_IDENTIFIER_LENGTH)throw TypeError("FlatBuffers: file identifier must be length "+n.FILE_IDENTIFIER_LENGTH);for(let t=n.FILE_IDENTIFIER_LENGTH-1;t>=0;t--)this.writeInt8(e.charCodeAt(t))}this.prep(this.minalign,n.SIZEOF_INT+a),this.addOffset(e),a&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(e,t){this.finish(e,t,!0)}requiredField(e,t){let n=this.bb.capacity()-e,i=n-this.bb.readInt32(n);if(!(t<this.bb.readInt16(i)&&0!=this.bb.readInt16(i+t)))throw TypeError("FlatBuffers: field "+t+" must be set")}startVector(e,t,i){this.notNested(),this.vector_num_elems=t,this.prep(n.SIZEOF_INT,e*t),this.prep(i,e*t)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(e){if(!e)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(e))return this.string_maps.get(e);let t=this.createString(e);return this.string_maps.set(e,t),t}createString(e){let t;return null==e?0:(t=e instanceof Uint8Array?e:this.text_encoder.encode(e),this.addInt8(0),this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length),this.bb.bytes().set(t,this.space),this.endVector())}createByteVector(e){return null==e?0:(this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length),this.bb.bytes().set(e,this.space),this.endVector())}createObjectOffset(e){return null===e?0:"string"==typeof e?this.createString(e):e.pack(this)}createObjectOffsetList(e){let t=[];for(let n=0;n<e.length;++n){let i=e[n];if(null!==i)t.push(this.createObjectOffset(i));else throw TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return t}createStructOffsetList(e,t){return t(this,e.length),this.createObjectOffsetList(e.slice().reverse()),this.endVector()}}}),ze=oe(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ByteBuffer=e.Builder=e.Encoding=e.isLittleEndian=e.float64=e.float32=e.int32=e.SIZE_PREFIX_LENGTH=e.FILE_IDENTIFIER_LENGTH=e.SIZEOF_INT=e.SIZEOF_SHORT=void 0;var t=Er();Object.defineProperty(e,"SIZEOF_SHORT",{enumerable:!0,get:function(){return t.SIZEOF_SHORT}});var n=Er();Object.defineProperty(e,"SIZEOF_INT",{enumerable:!0,get:function(){return n.SIZEOF_INT}});var i=Er();Object.defineProperty(e,"FILE_IDENTIFIER_LENGTH",{enumerable:!0,get:function(){return i.FILE_IDENTIFIER_LENGTH}});var a=Er();Object.defineProperty(e,"SIZE_PREFIX_LENGTH",{enumerable:!0,get:function(){return a.SIZE_PREFIX_LENGTH}});var o=Gs();Object.defineProperty(e,"int32",{enumerable:!0,get:function(){return o.int32}}),Object.defineProperty(e,"float32",{enumerable:!0,get:function(){return o.float32}}),Object.defineProperty(e,"float64",{enumerable:!0,get:function(){return o.float64}}),Object.defineProperty(e,"isLittleEndian",{enumerable:!0,get:function(){return o.isLittleEndian}});var s=Us();Object.defineProperty(e,"Encoding",{enumerable:!0,get:function(){return s.Encoding}});var l=Jp();Object.defineProperty(e,"Builder",{enumerable:!0,get:function(){return l.Builder}});var u=Hs();Object.defineProperty(e,"ByteBuffer",{enumerable:!0,get:function(){return u.ByteBuffer}})}),Ks=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.ArgTypeAndIndex=void 0;var a=i(ze()),o=Vs();e.ArgTypeAndIndex=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsArgTypeAndIndex(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsArgTypeAndIndex(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}argType(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt8(this.bb_pos+e):o.ArgType.INPUT}index(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint32(this.bb_pos+e):0}static startArgTypeAndIndex(e){e.startObject(2)}static addArgType(e,t){e.addFieldInt8(0,t,o.ArgType.INPUT)}static addIndex(e,t){e.addFieldInt32(1,t,0)}static endArgTypeAndIndex(e){return e.endObject()}static createArgTypeAndIndex(t,n,i){return e.startArgTypeAndIndex(t),e.addArgType(t,n),e.addIndex(t,i),e.endArgTypeAndIndex(t)}}}),Xs=oe(e=>{var t;Object.defineProperty(e,"__esModule",{value:!0}),e.AttributeType=void 0,function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.FLOAT=1]="FLOAT",e[e.INT=2]="INT",e[e.STRING=3]="STRING",e[e.TENSOR=4]="TENSOR",e[e.GRAPH=5]="GRAPH",e[e.FLOATS=6]="FLOATS",e[e.INTS=7]="INTS",e[e.STRINGS=8]="STRINGS",e[e.TENSORS=9]="TENSORS",e[e.GRAPHS=10]="GRAPHS",e[e.SPARSE_TENSOR=11]="SPARSE_TENSOR",e[e.SPARSE_TENSORS=12]="SPARSE_TENSORS"}(t||(e.AttributeType=t={}))}),Zs=oe(e=>{var t;Object.defineProperty(e,"__esModule",{value:!0}),e.NodeType=void 0,function(e){e[e.Primitive=0]="Primitive",e[e.Fused=1]="Fused"}(t||(e.NodeType=t={}))}),Ys=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.Node=void 0;var a=i(ze()),o=Qs(),s=Zs();e.Node=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsNode(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNode(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}domain(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}sinceVersion(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt32(this.bb_pos+e):0}index(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readUint32(this.bb_pos+e):0}opType(e){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__string(this.bb_pos+t,e):null}type(){let e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readInt32(this.bb_pos+e):s.NodeType.Primitive}executionProviderType(e){let t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__string(this.bb_pos+t,e):null}inputs(e,t){let n=this.bb.__offset(this.bb_pos,20);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}inputsLength(){let e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__vector_len(this.bb_pos+e):0}outputs(e,t){let n=this.bb.__offset(this.bb_pos,22);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}outputsLength(){let e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__vector_len(this.bb_pos+e):0}attributes(e,t){let n=this.bb.__offset(this.bb_pos,24);return n?(t||new o.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}attributesLength(){let e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__vector_len(this.bb_pos+e):0}inputArgCounts(e){let t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readInt32(this.bb.__vector(this.bb_pos+t)+4*e):0}inputArgCountsLength(){let e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__vector_len(this.bb_pos+e):0}inputArgCountsArray(){let e=this.bb.__offset(this.bb_pos,26);return e?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}implicitInputs(e,t){let n=this.bb.__offset(this.bb_pos,28);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}implicitInputsLength(){let e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__vector_len(this.bb_pos+e):0}static startNode(e){e.startObject(13)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addDomain(e,t){e.addFieldOffset(2,t,0)}static addSinceVersion(e,t){e.addFieldInt32(3,t,0)}static addIndex(e,t){e.addFieldInt32(4,t,0)}static addOpType(e,t){e.addFieldOffset(5,t,0)}static addType(e,t){e.addFieldInt32(6,t,s.NodeType.Primitive)}static addExecutionProviderType(e,t){e.addFieldOffset(7,t,0)}static addInputs(e,t){e.addFieldOffset(8,t,0)}static createInputsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startInputsVector(e,t){e.startVector(4,t,4)}static addOutputs(e,t){e.addFieldOffset(9,t,0)}static createOutputsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startOutputsVector(e,t){e.startVector(4,t,4)}static addAttributes(e,t){e.addFieldOffset(10,t,0)}static createAttributesVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startAttributesVector(e,t){e.startVector(4,t,4)}static addInputArgCounts(e,t){e.addFieldOffset(11,t,0)}static createInputArgCountsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addInt32(t[n]);return e.endVector()}static startInputArgCountsVector(e,t){e.startVector(4,t,4)}static addImplicitInputs(e,t){e.addFieldOffset(12,t,0)}static createImplicitInputsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startImplicitInputsVector(e,t){e.startVector(4,t,4)}static endNode(e){return e.endObject()}static createNode(t,n,i,a,o,s,l,u,c,d,p,h,f,g){return e.startNode(t),e.addName(t,n),e.addDocString(t,i),e.addDomain(t,a),e.addSinceVersion(t,o),e.addIndex(t,s),e.addOpType(t,l),e.addType(t,u),e.addExecutionProviderType(t,c),e.addInputs(t,d),e.addOutputs(t,p),e.addAttributes(t,h),e.addInputArgCounts(t,f),e.addImplicitInputs(t,g),e.endNode(t)}}}),tu=oe(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EdgeEnd=void 0,e.EdgeEnd=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}nodeIndex(){return this.bb.readUint32(this.bb_pos)}srcArgIndex(){return this.bb.readInt32(this.bb_pos+4)}dstArgIndex(){return this.bb.readInt32(this.bb_pos+8)}static sizeOf(){return 12}static createEdgeEnd(e,t,n,i){return e.prep(4,12),e.writeInt32(i),e.writeInt32(n),e.writeInt32(t),e.offset()}}}),ru=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.NodeEdge=void 0;var a=i(ze()),o=tu();e.NodeEdge=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsNodeEdge(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNodeEdge(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}nodeIndex(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb_pos+e):0}inputEdges(e,t){let n=this.bb.__offset(this.bb_pos,6);return n?(t||new o.EdgeEnd).__init(this.bb.__vector(this.bb_pos+n)+12*e,this.bb):null}inputEdgesLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}outputEdges(e,t){let n=this.bb.__offset(this.bb_pos,8);return n?(t||new o.EdgeEnd).__init(this.bb.__vector(this.bb_pos+n)+12*e,this.bb):null}outputEdgesLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}static startNodeEdge(e){e.startObject(3)}static addNodeIndex(e,t){e.addFieldInt32(0,t,0)}static addInputEdges(e,t){e.addFieldOffset(1,t,0)}static startInputEdgesVector(e,t){e.startVector(12,t,4)}static addOutputEdges(e,t){e.addFieldOffset(2,t,0)}static startOutputEdgesVector(e,t){e.startVector(12,t,4)}static endNodeEdge(e){return e.endObject()}static createNodeEdge(t,n,i,a){return e.startNodeEdge(t),e.addNodeIndex(t,n),e.addInputEdges(t,i),e.addOutputEdges(t,a),e.endNodeEdge(t)}}}),iu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.NodesToOptimizeIndices=void 0;var a=i(ze());e.NodesToOptimizeIndices=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsNodesToOptimizeIndices(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNodesToOptimizeIndices(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}nodeIndices(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint32(this.bb.__vector(this.bb_pos+t)+4*e):0}nodeIndicesLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}nodeIndicesArray(){let e=this.bb.__offset(this.bb_pos,4);return e?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}numInputs(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint32(this.bb_pos+e):0}numOutputs(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint32(this.bb_pos+e):0}hasVariadicInput(){let e=this.bb.__offset(this.bb_pos,10);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}hasVariadicOutput(){let e=this.bb.__offset(this.bb_pos,12);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}numVariadicInputs(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readUint32(this.bb_pos+e):0}numVariadicOutputs(){let e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readUint32(this.bb_pos+e):0}static startNodesToOptimizeIndices(e){e.startObject(7)}static addNodeIndices(e,t){e.addFieldOffset(0,t,0)}static createNodeIndicesVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addInt32(t[n]);return e.endVector()}static startNodeIndicesVector(e,t){e.startVector(4,t,4)}static addNumInputs(e,t){e.addFieldInt32(1,t,0)}static addNumOutputs(e,t){e.addFieldInt32(2,t,0)}static addHasVariadicInput(e,t){e.addFieldInt8(3,+t,0)}static addHasVariadicOutput(e,t){e.addFieldInt8(4,+t,0)}static addNumVariadicInputs(e,t){e.addFieldInt32(5,t,0)}static addNumVariadicOutputs(e,t){e.addFieldInt32(6,t,0)}static endNodesToOptimizeIndices(e){return e.endObject()}static createNodesToOptimizeIndices(t,n,i,a,o,s,l,u){return e.startNodesToOptimizeIndices(t),e.addNodeIndices(t,n),e.addNumInputs(t,i),e.addNumOutputs(t,a),e.addHasVariadicInput(t,o),e.addHasVariadicOutput(t,s),e.addNumVariadicInputs(t,l),e.addNumVariadicOutputs(t,u),e.endNodesToOptimizeIndices(t)}}}),su=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.RuntimeOptimizationRecord=void 0;var a=i(ze()),o=iu();e.RuntimeOptimizationRecord=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsRuntimeOptimizationRecord(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRuntimeOptimizationRecord(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}actionId(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}nodesToOptimizeIndices(e){let t=this.bb.__offset(this.bb_pos,6);return t?(e||new o.NodesToOptimizeIndices).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}producedOpIds(e,t){let n=this.bb.__offset(this.bb_pos,10);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}producedOpIdsLength(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}static startRuntimeOptimizationRecord(e){e.startObject(4)}static addActionId(e,t){e.addFieldOffset(0,t,0)}static addNodesToOptimizeIndices(e,t){e.addFieldOffset(1,t,0)}static addProducedOpIds(e,t){e.addFieldOffset(3,t,0)}static createProducedOpIdsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startProducedOpIdsVector(e,t){e.startVector(4,t,4)}static endRuntimeOptimizationRecord(e){return e.endObject()}}}),lu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.RuntimeOptimizationRecordContainerEntry=void 0;var a=i(ze()),o=su();e.RuntimeOptimizationRecordContainerEntry=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsRuntimeOptimizationRecordContainerEntry(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRuntimeOptimizationRecordContainerEntry(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}optimizerName(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}runtimeOptimizationRecords(e,t){let n=this.bb.__offset(this.bb_pos,6);return n?(t||new o.RuntimeOptimizationRecord).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}runtimeOptimizationRecordsLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}static startRuntimeOptimizationRecordContainerEntry(e){e.startObject(2)}static addOptimizerName(e,t){e.addFieldOffset(0,t,0)}static addRuntimeOptimizationRecords(e,t){e.addFieldOffset(1,t,0)}static createRuntimeOptimizationRecordsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startRuntimeOptimizationRecordsVector(e,t){e.startVector(4,t,4)}static endRuntimeOptimizationRecordContainerEntry(e){let t=e.endObject();return e.requiredField(t,4),t}static createRuntimeOptimizationRecordContainerEntry(t,n,i){return e.startRuntimeOptimizationRecordContainerEntry(t),e.addOptimizerName(t,n),e.addRuntimeOptimizationRecords(t,i),e.endRuntimeOptimizationRecordContainerEntry(t)}}}),du=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.RuntimeOptimizations=void 0;var a=i(ze()),o=lu();e.RuntimeOptimizations=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsRuntimeOptimizations(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRuntimeOptimizations(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}records(e,t){let n=this.bb.__offset(this.bb_pos,4);return n?(t||new o.RuntimeOptimizationRecordContainerEntry).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}recordsLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}static startRuntimeOptimizations(e){e.startObject(1)}static addRecords(e,t){e.addFieldOffset(0,t,0)}static createRecordsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startRecordsVector(e,t){e.startVector(4,t,4)}static endRuntimeOptimizations(e){return e.endObject()}static createRuntimeOptimizations(t,n){return e.startRuntimeOptimizations(t),e.addRecords(t,n),e.endRuntimeOptimizations(t)}}}),xo=oe(e=>{var t;Object.defineProperty(e,"__esModule",{value:!0}),e.TensorDataType=void 0,function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.FLOAT=1]="FLOAT",e[e.UINT8=2]="UINT8",e[e.INT8=3]="INT8",e[e.UINT16=4]="UINT16",e[e.INT16=5]="INT16",e[e.INT32=6]="INT32",e[e.INT64=7]="INT64",e[e.STRING=8]="STRING",e[e.BOOL=9]="BOOL",e[e.FLOAT16=10]="FLOAT16",e[e.DOUBLE=11]="DOUBLE",e[e.UINT32=12]="UINT32",e[e.UINT64=13]="UINT64",e[e.COMPLEX64=14]="COMPLEX64",e[e.COMPLEX128=15]="COMPLEX128",e[e.BFLOAT16=16]="BFLOAT16",e[e.FLOAT8E4M3FN=17]="FLOAT8E4M3FN",e[e.FLOAT8E4M3FNUZ=18]="FLOAT8E4M3FNUZ",e[e.FLOAT8E5M2=19]="FLOAT8E5M2",e[e.FLOAT8E5M2FNUZ=20]="FLOAT8E5M2FNUZ"}(t||(e.TensorDataType=t={}))}),To=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.Tensor=void 0;var a=i(ze()),o=xo();e.Tensor=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTensor(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTensor(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}dims(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):BigInt(0)}dimsLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}dataType(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt32(this.bb_pos+e):o.TensorDataType.UNDEFINED}rawData(e){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readUint8(this.bb.__vector(this.bb_pos+t)+e):0}rawDataLength(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}rawDataArray(){let e=this.bb.__offset(this.bb_pos,12);return e?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}stringData(e,t){let n=this.bb.__offset(this.bb_pos,14);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}stringDataLength(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}externalDataOffset(){let e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readInt64(this.bb_pos+e):BigInt("-1")}static startTensor(e){e.startObject(7)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addDims(e,t){e.addFieldOffset(2,t,0)}static createDimsVector(e,t){e.startVector(8,t.length,8);for(let n=t.length-1;n>=0;n--)e.addInt64(t[n]);return e.endVector()}static startDimsVector(e,t){e.startVector(8,t,8)}static addDataType(e,t){e.addFieldInt32(3,t,o.TensorDataType.UNDEFINED)}static addRawData(e,t){e.addFieldOffset(4,t,0)}static createRawDataVector(e,t){e.startVector(1,t.length,1);for(let n=t.length-1;n>=0;n--)e.addInt8(t[n]);return e.endVector()}static startRawDataVector(e,t){e.startVector(1,t,1)}static addStringData(e,t){e.addFieldOffset(5,t,0)}static createStringDataVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startStringDataVector(e,t){e.startVector(4,t,4)}static addExternalDataOffset(e,t){e.addFieldInt64(6,t,BigInt("-1"))}static endTensor(e){return e.endObject()}static createTensor(t,n,i,a,o,s,l,u){return e.startTensor(t),e.addName(t,n),e.addDocString(t,i),e.addDims(t,a),e.addDataType(t,o),e.addRawData(t,s),e.addStringData(t,l),e.addExternalDataOffset(t,u),e.endTensor(t)}}}),hu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.SparseTensor=void 0;var a=i(ze()),o=To();e.SparseTensor=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSparseTensor(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSparseTensor(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}values(e){let t=this.bb.__offset(this.bb_pos,4);return t?(e||new o.Tensor).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}indices(e){let t=this.bb.__offset(this.bb_pos,6);return t?(e||new o.Tensor).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}dims(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):BigInt(0)}dimsLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSparseTensor(e){e.startObject(3)}static addValues(e,t){e.addFieldOffset(0,t,0)}static addIndices(e,t){e.addFieldOffset(1,t,0)}static addDims(e,t){e.addFieldOffset(2,t,0)}static createDimsVector(e,t){e.startVector(8,t.length,8);for(let n=t.length-1;n>=0;n--)e.addInt64(t[n]);return e.endVector()}static startDimsVector(e,t){e.startVector(8,t,8)}static endSparseTensor(e){return e.endObject()}}}),gu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.MapType=void 0;var a=i(ze()),o=xo(),s=Io();e.MapType=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsMapType(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMapType(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}keyType(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):o.TensorDataType.UNDEFINED}valueType(e){let t=this.bb.__offset(this.bb_pos,6);return t?(e||new s.TypeInfo).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}static startMapType(e){e.startObject(2)}static addKeyType(e,t){e.addFieldInt32(0,t,o.TensorDataType.UNDEFINED)}static addValueType(e,t){e.addFieldOffset(1,t,0)}static endMapType(e){return e.endObject()}}}),yu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.SequenceType=void 0;var a=i(ze()),o=Io();e.SequenceType=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSequenceType(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSequenceType(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}elemType(e){let t=this.bb.__offset(this.bb_pos,4);return t?(e||new o.TypeInfo).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}static startSequenceType(e){e.startObject(1)}static addElemType(e,t){e.addFieldOffset(0,t,0)}static endSequenceType(e){return e.endObject()}static createSequenceType(t,n){return e.startSequenceType(t),e.addElemType(t,n),e.endSequenceType(t)}}}),_u=oe(e=>{var t;Object.defineProperty(e,"__esModule",{value:!0}),e.DimensionValueType=void 0,function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VALUE=1]="VALUE",e[e.PARAM=2]="PARAM"}(t||(e.DimensionValueType=t={}))}),wu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.DimensionValue=void 0;var a=i(ze()),o=_u();e.DimensionValue=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDimensionValue(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDimensionValue(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}dimType(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt8(this.bb_pos+e):o.DimensionValueType.UNKNOWN}dimValue(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}dimParam(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}static startDimensionValue(e){e.startObject(3)}static addDimType(e,t){e.addFieldInt8(0,t,o.DimensionValueType.UNKNOWN)}static addDimValue(e,t){e.addFieldInt64(1,t,BigInt("0"))}static addDimParam(e,t){e.addFieldOffset(2,t,0)}static endDimensionValue(e){return e.endObject()}static createDimensionValue(t,n,i,a){return e.startDimensionValue(t),e.addDimType(t,n),e.addDimValue(t,i),e.addDimParam(t,a),e.endDimensionValue(t)}}}),Tu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.Dimension=void 0;var a=i(ze()),o=wu();e.Dimension=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDimension(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDimension(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}value(e){let t=this.bb.__offset(this.bb_pos,4);return t?(e||new o.DimensionValue).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}denotation(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startDimension(e){e.startObject(2)}static addValue(e,t){e.addFieldOffset(0,t,0)}static addDenotation(e,t){e.addFieldOffset(1,t,0)}static endDimension(e){return e.endObject()}static createDimension(t,n,i){return e.startDimension(t),e.addValue(t,n),e.addDenotation(t,i),e.endDimension(t)}}}),Su=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=void 0;var a=i(ze()),o=Tu();e.Shape=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsShape(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsShape(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}dim(e,t){let n=this.bb.__offset(this.bb_pos,4);return n?(t||new o.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}dimLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}static startShape(e){e.startObject(1)}static addDim(e,t){e.addFieldOffset(0,t,0)}static createDimVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startDimVector(e,t){e.startVector(4,t,4)}static endShape(e){return e.endObject()}static createShape(t,n){return e.startShape(t),e.addDim(t,n),e.endShape(t)}}}),Au=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.TensorTypeAndShape=void 0;var a=i(ze()),o=Su(),s=xo();e.TensorTypeAndShape=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTensorTypeAndShape(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTensorTypeAndShape(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}elemType(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):s.TensorDataType.UNDEFINED}shape(e){let t=this.bb.__offset(this.bb_pos,6);return t?(e||new o.Shape).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}static startTensorTypeAndShape(e){e.startObject(2)}static addElemType(e,t){e.addFieldInt32(0,t,s.TensorDataType.UNDEFINED)}static addShape(e,t){e.addFieldOffset(1,t,0)}static endTensorTypeAndShape(e){return e.endObject()}}}),Ou=oe(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.unionListToTypeInfoValue=e.unionToTypeInfoValue=e.TypeInfoValue=void 0;var t,n=gu(),i=yu(),a=Au();!function(e){e[e.NONE=0]="NONE",e[e.tensor_type=1]="tensor_type",e[e.sequence_type=2]="sequence_type",e[e.map_type=3]="map_type"}(t||(e.TypeInfoValue=t={})),e.unionToTypeInfoValue=function(e,o){switch(t[e]){case"NONE":default:return null;case"tensor_type":return o(new a.TensorTypeAndShape);case"sequence_type":return o(new i.SequenceType);case"map_type":return o(new n.MapType)}},e.unionListToTypeInfoValue=function(e,o,s){switch(t[e]){case"NONE":default:return null;case"tensor_type":return o(s,new a.TensorTypeAndShape);case"sequence_type":return o(s,new i.SequenceType);case"map_type":return o(s,new n.MapType)}}}),Io=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.TypeInfo=void 0;var a=i(ze()),o=Ou();e.TypeInfo=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTypeInfo(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTypeInfo(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}denotation(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}valueType(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb_pos+e):o.TypeInfoValue.NONE}value(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__union(e,this.bb_pos+t):null}static startTypeInfo(e){e.startObject(3)}static addDenotation(e,t){e.addFieldOffset(0,t,0)}static addValueType(e,t){e.addFieldInt8(1,t,o.TypeInfoValue.NONE)}static addValue(e,t){e.addFieldOffset(2,t,0)}static endTypeInfo(e){return e.endObject()}static createTypeInfo(t,n,i,a){return e.startTypeInfo(t),e.addDenotation(t,n),e.addValueType(t,i),e.addValue(t,a),e.endTypeInfo(t)}}}),Cu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.ValueInfo=void 0;var a=i(ze()),o=Io();e.ValueInfo=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsValueInfo(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsValueInfo(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}type(e){let t=this.bb.__offset(this.bb_pos,8);return t?(e||new o.TypeInfo).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}static startValueInfo(e){e.startObject(3)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addType(e,t){e.addFieldOffset(2,t,0)}static endValueInfo(e){return e.endObject()}}}),Oi=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.Graph=void 0;var a=i(ze()),o=Ys(),s=ru(),l=du(),u=hu(),c=To(),d=Cu();e.Graph=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsGraph(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsGraph(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}initializers(e,t){let n=this.bb.__offset(this.bb_pos,4);return n?(t||new c.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}initializersLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}nodeArgs(e,t){let n=this.bb.__offset(this.bb_pos,6);return n?(t||new d.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}nodeArgsLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}nodes(e,t){let n=this.bb.__offset(this.bb_pos,8);return n?(t||new o.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}nodesLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}maxNodeIndex(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readUint32(this.bb_pos+e):0}nodeEdges(e,t){let n=this.bb.__offset(this.bb_pos,12);return n?(t||new s.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}nodeEdgesLength(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}inputs(e,t){let n=this.bb.__offset(this.bb_pos,14);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}inputsLength(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}outputs(e,t){let n=this.bb.__offset(this.bb_pos,16);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}outputsLength(){let e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0}sparseInitializers(e,t){let n=this.bb.__offset(this.bb_pos,18);return n?(t||new u.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}sparseInitializersLength(){let e=this.bb.__offset(this.bb_pos,18);return e?this.bb.__vector_len(this.bb_pos+e):0}runtimeOptimizations(e){let t=this.bb.__offset(this.bb_pos,20);return t?(e||new l.RuntimeOptimizations).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}static startGraph(e){e.startObject(9)}static addInitializers(e,t){e.addFieldOffset(0,t,0)}static createInitializersVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startInitializersVector(e,t){e.startVector(4,t,4)}static addNodeArgs(e,t){e.addFieldOffset(1,t,0)}static createNodeArgsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startNodeArgsVector(e,t){e.startVector(4,t,4)}static addNodes(e,t){e.addFieldOffset(2,t,0)}static createNodesVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startNodesVector(e,t){e.startVector(4,t,4)}static addMaxNodeIndex(e,t){e.addFieldInt32(3,t,0)}static addNodeEdges(e,t){e.addFieldOffset(4,t,0)}static createNodeEdgesVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startNodeEdgesVector(e,t){e.startVector(4,t,4)}static addInputs(e,t){e.addFieldOffset(5,t,0)}static createInputsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startInputsVector(e,t){e.startVector(4,t,4)}static addOutputs(e,t){e.addFieldOffset(6,t,0)}static createOutputsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startOutputsVector(e,t){e.startVector(4,t,4)}static addSparseInitializers(e,t){e.addFieldOffset(7,t,0)}static createSparseInitializersVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startSparseInitializersVector(e,t){e.startVector(4,t,4)}static addRuntimeOptimizations(e,t){e.addFieldOffset(8,t,0)}static endGraph(e){return e.endObject()}}}),Qs=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.Attribute=void 0;var a=i(ze()),o=Xs(),s=Oi(),l=To();e.Attribute=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsAttribute(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsAttribute(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}type(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt32(this.bb_pos+e):o.AttributeType.UNDEFINED}f(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat32(this.bb_pos+e):0}i(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}s(e){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__string(this.bb_pos+t,e):null}t(e){let t=this.bb.__offset(this.bb_pos,16);return t?(e||new l.Tensor).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}g(e){let t=this.bb.__offset(this.bb_pos,18);return t?(e||new s.Graph).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}floats(e){let t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readFloat32(this.bb.__vector(this.bb_pos+t)+4*e):0}floatsLength(){let e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__vector_len(this.bb_pos+e):0}floatsArray(){let e=this.bb.__offset(this.bb_pos,20);return e?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}ints(e){let t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):BigInt(0)}intsLength(){let e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__vector_len(this.bb_pos+e):0}strings(e,t){let n=this.bb.__offset(this.bb_pos,24);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}stringsLength(){let e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__vector_len(this.bb_pos+e):0}tensors(e,t){let n=this.bb.__offset(this.bb_pos,26);return n?(t||new l.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}tensorsLength(){let e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__vector_len(this.bb_pos+e):0}graphs(e,t){let n=this.bb.__offset(this.bb_pos,28);return n?(t||new s.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}graphsLength(){let e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__vector_len(this.bb_pos+e):0}static startAttribute(e){e.startObject(13)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addType(e,t){e.addFieldInt32(2,t,o.AttributeType.UNDEFINED)}static addF(e,t){e.addFieldFloat32(3,t,0)}static addI(e,t){e.addFieldInt64(4,t,BigInt("0"))}static addS(e,t){e.addFieldOffset(5,t,0)}static addT(e,t){e.addFieldOffset(6,t,0)}static addG(e,t){e.addFieldOffset(7,t,0)}static addFloats(e,t){e.addFieldOffset(8,t,0)}static createFloatsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addFloat32(t[n]);return e.endVector()}static startFloatsVector(e,t){e.startVector(4,t,4)}static addInts(e,t){e.addFieldOffset(9,t,0)}static createIntsVector(e,t){e.startVector(8,t.length,8);for(let n=t.length-1;n>=0;n--)e.addInt64(t[n]);return e.endVector()}static startIntsVector(e,t){e.startVector(8,t,8)}static addStrings(e,t){e.addFieldOffset(10,t,0)}static createStringsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startStringsVector(e,t){e.startVector(4,t,4)}static addTensors(e,t){e.addFieldOffset(11,t,0)}static createTensorsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startTensorsVector(e,t){e.startVector(4,t,4)}static addGraphs(e,t){e.addFieldOffset(12,t,0)}static createGraphsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startGraphsVector(e,t){e.startVector(4,t,4)}static endAttribute(e){return e.endObject()}}}),Lu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.DeprecatedKernelCreateInfos=void 0;var a=i(ze());e.DeprecatedKernelCreateInfos=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDeprecatedKernelCreateInfos(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDeprecatedKernelCreateInfos(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}nodeIndices(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint32(this.bb.__vector(this.bb_pos+t)+4*e):0}nodeIndicesLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}nodeIndicesArray(){let e=this.bb.__offset(this.bb_pos,4);return e?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}kernelDefHashes(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint64(this.bb.__vector(this.bb_pos+t)+8*e):BigInt(0)}kernelDefHashesLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}static startDeprecatedKernelCreateInfos(e){e.startObject(2)}static addNodeIndices(e,t){e.addFieldOffset(0,t,0)}static createNodeIndicesVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addInt32(t[n]);return e.endVector()}static startNodeIndicesVector(e,t){e.startVector(4,t,4)}static addKernelDefHashes(e,t){e.addFieldOffset(1,t,0)}static createKernelDefHashesVector(e,t){e.startVector(8,t.length,8);for(let n=t.length-1;n>=0;n--)e.addInt64(t[n]);return e.endVector()}static startKernelDefHashesVector(e,t){e.startVector(8,t,8)}static endDeprecatedKernelCreateInfos(e){return e.endObject()}static createDeprecatedKernelCreateInfos(t,n,i){return e.startDeprecatedKernelCreateInfos(t),e.addNodeIndices(t,n),e.addKernelDefHashes(t,i),e.endDeprecatedKernelCreateInfos(t)}}}),yf=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.DeprecatedNodeIndexAndKernelDefHash=void 0;var a=i(ze());e.DeprecatedNodeIndexAndKernelDefHash=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDeprecatedNodeIndexAndKernelDefHash(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDeprecatedNodeIndexAndKernelDefHash(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}nodeIndex(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb_pos+e):0}kernelDefHash(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint64(this.bb_pos+e):BigInt("0")}static startDeprecatedNodeIndexAndKernelDefHash(e){e.startObject(2)}static addNodeIndex(e,t){e.addFieldInt32(0,t,0)}static addKernelDefHash(e,t){e.addFieldInt64(1,t,BigInt("0"))}static endDeprecatedNodeIndexAndKernelDefHash(e){return e.endObject()}static createDeprecatedNodeIndexAndKernelDefHash(t,n,i){return e.startDeprecatedNodeIndexAndKernelDefHash(t),e.addNodeIndex(t,n),e.addKernelDefHash(t,i),e.endDeprecatedNodeIndexAndKernelDefHash(t)}}}),Mu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.DeprecatedSubGraphSessionState=void 0;var a=i(ze()),o=Bu();e.DeprecatedSubGraphSessionState=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDeprecatedSubGraphSessionState(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDeprecatedSubGraphSessionState(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}graphId(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}sessionState(e){let t=this.bb.__offset(this.bb_pos,6);return t?(e||new o.DeprecatedSessionState).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}static startDeprecatedSubGraphSessionState(e){e.startObject(2)}static addGraphId(e,t){e.addFieldOffset(0,t,0)}static addSessionState(e,t){e.addFieldOffset(1,t,0)}static endDeprecatedSubGraphSessionState(e){let t=e.endObject();return e.requiredField(t,4),t}}}),Bu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.DeprecatedSessionState=void 0;var a=i(ze()),o=Lu(),s=Mu();e.DeprecatedSessionState=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDeprecatedSessionState(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDeprecatedSessionState(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}kernels(e){let t=this.bb.__offset(this.bb_pos,4);return t?(e||new o.DeprecatedKernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}subGraphSessionStates(e,t){let n=this.bb.__offset(this.bb_pos,6);return n?(t||new s.DeprecatedSubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}subGraphSessionStatesLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}static startDeprecatedSessionState(e){e.startObject(2)}static addKernels(e,t){e.addFieldOffset(0,t,0)}static addSubGraphSessionStates(e,t){e.addFieldOffset(1,t,0)}static createSubGraphSessionStatesVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startSubGraphSessionStatesVector(e,t){e.startVector(4,t,4)}static endDeprecatedSessionState(e){return e.endObject()}static createDeprecatedSessionState(t,n,i){return e.startDeprecatedSessionState(t),e.addKernels(t,n),e.addSubGraphSessionStates(t,i),e.endDeprecatedSessionState(t)}}}),Gu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.KernelTypeStrArgsEntry=void 0;var a=i(ze()),o=Ks();e.KernelTypeStrArgsEntry=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsKernelTypeStrArgsEntry(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKernelTypeStrArgsEntry(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}kernelTypeStr(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}args(e,t){let n=this.bb.__offset(this.bb_pos,6);return n?(t||new o.ArgTypeAndIndex).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}argsLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}static startKernelTypeStrArgsEntry(e){e.startObject(2)}static addKernelTypeStr(e,t){e.addFieldOffset(0,t,0)}static addArgs(e,t){e.addFieldOffset(1,t,0)}static createArgsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startArgsVector(e,t){e.startVector(4,t,4)}static endKernelTypeStrArgsEntry(e){let t=e.endObject();return e.requiredField(t,4),t}static createKernelTypeStrArgsEntry(t,n,i){return e.startKernelTypeStrArgsEntry(t),e.addKernelTypeStr(t,n),e.addArgs(t,i),e.endKernelTypeStrArgsEntry(t)}}}),Wu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.OpIdKernelTypeStrArgsEntry=void 0;var a=i(ze()),o=Gu();e.OpIdKernelTypeStrArgsEntry=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsOpIdKernelTypeStrArgsEntry(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsOpIdKernelTypeStrArgsEntry(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}opId(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}kernelTypeStrArgs(e,t){let n=this.bb.__offset(this.bb_pos,6);return n?(t||new o.KernelTypeStrArgsEntry).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}kernelTypeStrArgsLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}static startOpIdKernelTypeStrArgsEntry(e){e.startObject(2)}static addOpId(e,t){e.addFieldOffset(0,t,0)}static addKernelTypeStrArgs(e,t){e.addFieldOffset(1,t,0)}static createKernelTypeStrArgsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startKernelTypeStrArgsVector(e,t){e.startVector(4,t,4)}static endOpIdKernelTypeStrArgsEntry(e){let t=e.endObject();return e.requiredField(t,4),t}static createOpIdKernelTypeStrArgsEntry(t,n,i){return e.startOpIdKernelTypeStrArgsEntry(t),e.addOpId(t,n),e.addKernelTypeStrArgs(t,i),e.endOpIdKernelTypeStrArgsEntry(t)}}}),ju=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.KernelTypeStrResolver=void 0;var a=i(ze()),o=Wu();e.KernelTypeStrResolver=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsKernelTypeStrResolver(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKernelTypeStrResolver(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}opKernelTypeStrArgs(e,t){let n=this.bb.__offset(this.bb_pos,4);return n?(t||new o.OpIdKernelTypeStrArgsEntry).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}opKernelTypeStrArgsLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}static startKernelTypeStrResolver(e){e.startObject(1)}static addOpKernelTypeStrArgs(e,t){e.addFieldOffset(0,t,0)}static createOpKernelTypeStrArgsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startOpKernelTypeStrArgsVector(e,t){e.startVector(4,t,4)}static endKernelTypeStrResolver(e){return e.endObject()}static createKernelTypeStrResolver(t,n){return e.startKernelTypeStrResolver(t),e.addOpKernelTypeStrArgs(t,n),e.endKernelTypeStrResolver(t)}}}),Ku=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.OperatorSetId=void 0;var a=i(ze());e.OperatorSetId=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsOperatorSetId(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsOperatorSetId(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}domain(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}version(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}static startOperatorSetId(e){e.startObject(2)}static addDomain(e,t){e.addFieldOffset(0,t,0)}static addVersion(e,t){e.addFieldInt64(1,t,BigInt("0"))}static endOperatorSetId(e){return e.endObject()}static createOperatorSetId(t,n,i){return e.startOperatorSetId(t),e.addDomain(t,n),e.addVersion(t,i),e.endOperatorSetId(t)}}}),Zu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.StringStringEntry=void 0;var a=i(ze());e.StringStringEntry=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsStringStringEntry(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStringStringEntry(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}key(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}value(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startStringStringEntry(e){e.startObject(2)}static addKey(e,t){e.addFieldOffset(0,t,0)}static addValue(e,t){e.addFieldOffset(1,t,0)}static endStringStringEntry(e){return e.endObject()}static createStringStringEntry(t,n,i){return e.startStringStringEntry(t),e.addKey(t,n),e.addValue(t,i),e.endStringStringEntry(t)}}}),Yu=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0;var a=i(ze()),o=Oi(),s=Ku(),l=Zu();e.Model=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsModel(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsModel(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}irVersion(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}opsetImport(e,t){let n=this.bb.__offset(this.bb_pos,6);return n?(t||new s.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}opsetImportLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}producerName(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}producerVersion(e){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__string(this.bb_pos+t,e):null}domain(e){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__string(this.bb_pos+t,e):null}modelVersion(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}docString(e){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__string(this.bb_pos+t,e):null}graph(e){let t=this.bb.__offset(this.bb_pos,18);return t?(e||new o.Graph).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}graphDocString(e){let t=this.bb.__offset(this.bb_pos,20);return t?this.bb.__string(this.bb_pos+t,e):null}metadataProps(e,t){let n=this.bb.__offset(this.bb_pos,22);return n?(t||new l.StringStringEntry).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}metadataPropsLength(){let e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__vector_len(this.bb_pos+e):0}static startModel(e){e.startObject(10)}static addIrVersion(e,t){e.addFieldInt64(0,t,BigInt("0"))}static addOpsetImport(e,t){e.addFieldOffset(1,t,0)}static createOpsetImportVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startOpsetImportVector(e,t){e.startVector(4,t,4)}static addProducerName(e,t){e.addFieldOffset(2,t,0)}static addProducerVersion(e,t){e.addFieldOffset(3,t,0)}static addDomain(e,t){e.addFieldOffset(4,t,0)}static addModelVersion(e,t){e.addFieldInt64(5,t,BigInt("0"))}static addDocString(e,t){e.addFieldOffset(6,t,0)}static addGraph(e,t){e.addFieldOffset(7,t,0)}static addGraphDocString(e,t){e.addFieldOffset(8,t,0)}static addMetadataProps(e,t){e.addFieldOffset(9,t,0)}static createMetadataPropsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startMetadataPropsVector(e,t){e.startVector(4,t,4)}static endModel(e){return e.endObject()}}}),_f=oe(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,a)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(i,e,a);return n(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.InferenceSession=void 0;var a=i(ze()),o=ju(),s=Yu();e.InferenceSession=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsInferenceSession(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInferenceSession(t,n){return t.setPosition(t.position()+a.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static bufferHasIdentifier(e){return e.__has_identifier("ORTM")}ortVersion(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}model(e){let t=this.bb.__offset(this.bb_pos,6);return t?(e||new s.Model).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}kernelTypeStrResolver(e){let t=this.bb.__offset(this.bb_pos,10);return t?(e||new o.KernelTypeStrResolver).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}static startInferenceSession(e){e.startObject(4)}static addOrtVersion(e,t){e.addFieldOffset(0,t,0)}static addModel(e,t){e.addFieldOffset(1,t,0)}static addKernelTypeStrResolver(e,t){e.addFieldOffset(3,t,0)}static endInferenceSession(e){return e.endObject()}static finishInferenceSessionBuffer(e,t){e.finish(t,"ORTM")}static finishSizePrefixedInferenceSessionBuffer(e,t){e.finish(t,"ORTM",!0)}}}),vf=k(()=>{R1=ve(Vs()),z1=ve(Ks()),Pi=ve(Qs()),Lt=ve(Xs()),M1=ve(Lu()),B1=ve(yf()),F1=ve(Bu()),V1=ve(Mu()),G1=ve(Tu()),U1=ve(wu()),W1=ve(_u()),H1=ve(tu()),el=ve(Oi()),tl=ve(_f()),j1=ve(Gu()),q1=ve(ju()),K1=ve(gu()),X1=ve(Yu()),nl=ve(Ys()),Z1=ve(ru()),J1=ve(Zs()),Y1=ve(iu()),Q1=ve(Wu()),eS=ve(Ku()),tS=ve(su()),nS=ve(lu()),rS=ve(du()),oS=ve(yu()),iS=ve(Su()),aS=ve(hu()),sS=ve(Zu()),uS=ve(To()),So=ve(xo()),rl=ve(Au()),lS=ve(Io()),ol=ve(Ou()),cS=ve(Cu())}),$o=k(()=>{vf()}),xf=oe((e,t)=>{t.exports=function e(e,t){for(var n=Array(arguments.length-1),i=0,a=2,o=!0;a<arguments.length;)n[i++]=arguments[a++];return new Promise(function(a,s){n[i]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];a.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,s(e))}})}}),$f=oe(e=>{var t,n=e;n.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};var i=Array(64),a=Array(123);for(t=0;t<64;)a[i[t]=t<26?t+65:t<52?t+71:t<62?t-4:t-59|43]=t++;n.encode=function(e,t,n){for(var a,o=null,s=[],l=0,u=0;t<n;){var c=e[t++];switch(u){case 0:s[l++]=i[c>>2],a=(3&c)<<4,u=1;break;case 1:s[l++]=i[a|c>>4],a=(15&c)<<2,u=2;break;case 2:s[l++]=i[a|c>>6],s[l++]=i[63&c],u=0}l>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),l=0)}return u&&(s[l++]=i[a],s[l++]=61,1===u&&(s[l++]=61)),o?(l&&o.push(String.fromCharCode.apply(String,s.slice(0,l))),o.join("")):String.fromCharCode.apply(String,s.slice(0,l))};var o="invalid encoding";n.decode=function(e,t,n){for(var i,s=n,l=0,u=0;u<e.length;){var c=e.charCodeAt(u++);if(61===c&&l>1)break;if(void 0===(c=a[c]))throw Error(o);switch(l){case 0:i=c,l=1;break;case 1:t[n++]=i<<2|(48&c)>>4,i=c,l=2;break;case 2:t[n++]=(15&i)<<4|(60&c)>>2,i=c,l=3;break;case 3:t[n++]=(3&i)<<6|c,l=0}}if(1===l)throw Error(o);return n-s},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}}),Of=oe((e,t)=>{function n(){this._listeners={}}t.exports=n,n.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},n.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this},n.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this}}),Lf=oe((e,t)=>{function n(e){return"u">typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),i=128===n[3];function a(e,i,a){t[0]=e,i[a]=n[0],i[a+1]=n[1],i[a+2]=n[2],i[a+3]=n[3]}function o(e,i,a){t[0]=e,i[a]=n[3],i[a+1]=n[2],i[a+2]=n[1],i[a+3]=n[0]}function s(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],t[0]}function l(e,i){return n[3]=e[i],n[2]=e[i+1],n[1]=e[i+2],n[0]=e[i+3],t[0]}e.writeFloatLE=i?a:o,e.writeFloatBE=i?o:a,e.readFloatLE=i?s:l,e.readFloatBE=i?l:s}():function(){function t(e,t,n,i){var a=+(t<0);if(a&&(t=-t),0===t)e(1/t>0?0:0x80000000,n,i);else if(isNaN(t))e(0x7fc00000,n,i);else if(t>34028234663852886e22)e((a<<31|0x7f800000)>>>0,n,i);else if(t<11754943508222875e-54)e((a<<31|Math.round(t/1401298464324817e-60))>>>0,n,i);else{var o=Math.floor(Math.log(t)/Math.LN2),s=8388607&Math.round(t*Math.pow(2,-o)*8388608);e((a<<31|o+127<<23|s)>>>0,n,i)}}function n(e,t,n){var i=e(t,n),a=(i>>31)*2+1,o=i>>>23&255,s=8388607&i;return 255===o?s?NaN:1/0*a:0===o?1401298464324817e-60*a*s:a*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,a),e.readFloatLE=n.bind(null,o),e.readFloatBE=n.bind(null,s)}(),"u">typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),i=128===n[7];function a(e,i,a){t[0]=e,i[a]=n[0],i[a+1]=n[1],i[a+2]=n[2],i[a+3]=n[3],i[a+4]=n[4],i[a+5]=n[5],i[a+6]=n[6],i[a+7]=n[7]}function o(e,i,a){t[0]=e,i[a]=n[7],i[a+1]=n[6],i[a+2]=n[5],i[a+3]=n[4],i[a+4]=n[3],i[a+5]=n[2],i[a+6]=n[1],i[a+7]=n[0]}function s(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],n[4]=e[i+4],n[5]=e[i+5],n[6]=e[i+6],n[7]=e[i+7],t[0]}function l(e,i){return n[7]=e[i],n[6]=e[i+1],n[5]=e[i+2],n[4]=e[i+3],n[3]=e[i+4],n[2]=e[i+5],n[1]=e[i+6],n[0]=e[i+7],t[0]}e.writeDoubleLE=i?a:o,e.writeDoubleBE=i?o:a,e.readDoubleLE=i?s:l,e.readDoubleBE=i?l:s}():function(){function t(e,t,n,i,a,o){var s,l=+(i<0);if(l&&(i=-i),0===i)e(0,a,o+t),e(1/i>0?0:0x80000000,a,o+n);else if(isNaN(i))e(0,a,o+t),e(0x7ff80000,a,o+n);else if(i>17976931348623157e292)e(0,a,o+t),e((l<<31|0x7ff00000)>>>0,a,o+n);else if(i<22250738585072014e-324)e((s=i/5e-324)>>>0,a,o+t),e((l<<31|s/0x100000000)>>>0,a,o+n);else{var u=Math.floor(Math.log(i)/Math.LN2);1024===u&&(u=1023),e(0x10000000000000*(s=i*Math.pow(2,-u))>>>0,a,o+t),e((l<<31|u+1023<<20|1048576*s&1048575)>>>0,a,o+n)}}function n(e,t,n,i,a){var o=e(i,a+t),s=e(i,a+n),l=(s>>31)*2+1,u=s>>>20&2047,c=0x100000000*(1048575&s)+o;return 2047===u?c?NaN:1/0*l:0===u?5e-324*l*c:l*Math.pow(2,u-1075)*(c+0x10000000000000)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,a,4,0),e.readDoubleLE=n.bind(null,o,0,4),e.readDoubleBE=n.bind(null,s,4,0)}(),e}function i(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function a(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function o(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}t.exports=n(n)}),Rf=oe((exports,module)=>{function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}module.exports=inquire}),Mf=oe(e=>{var t=e;t.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)(n=e.charCodeAt(i))<128?t+=1:n<2048?t+=2:(64512&n)==55296&&(64512&e.charCodeAt(i+1))==56320?(++i,t+=4):t+=3;return t},t.read=function(e,t,n){if(n-t<1)return"";for(var i,a=null,o=[],s=0;t<n;)(i=e[t++])<128?o[s++]=i:i>191&&i<224?o[s++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(i>>10),o[s++]=56320+(1023&i)):o[s++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,o)),s=0);return a?(s&&a.push(String.fromCharCode.apply(String,o.slice(0,s))),a.join("")):String.fromCharCode.apply(String,o.slice(0,s))},t.write=function(e,t,n){for(var i,a,o=n,s=0;s<e.length;++s)(i=e.charCodeAt(s))<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:((64512&i)==55296&&(64512&(a=e.charCodeAt(s+1)))==56320?(i=65536+((1023&i)<<10)+(1023&a),++s,t[n++]=i>>18|240,t[n++]=i>>12&63|128):t[n++]=i>>12|224,t[n++]=i>>6&63|128),t[n++]=63&i|128);return n-o}}),Ff=oe((e,t)=>{t.exports=function e(e,t,n){var i=n||8192,a=i>>>1,o=null,s=i;return function(n){if(n<1||n>a)return e(n);s+n>i&&(o=e(i),s=0);var l=t.call(o,s,s+=n);return 7&s&&(s=(7|s)+1),l}}}),Gf=oe((e,t)=>{t.exports=i;var n=hr();function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var a=i.zero=new i(0,0);a.toNumber=function(){return 0},a.zzEncode=a.zzDecode=function(){return this},a.length=function(){return 1};var o=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return a;var t=e<0;t&&(e=-e);var n=e>>>0,o=(e-n)/0x100000000>>>0;return t&&(o=~o>>>0,n=~n>>>0,++n>0xffffffff&&(n=0,++o>0xffffffff&&(o=0))),new i(n,o)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(n.isString(e))if(!n.Long)return i.fromNumber(parseInt(e,10));else e=n.Long.fromString(e);return e.low||e.high?new i(e.low>>>0,e.high>>>0):a},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+0x100000000*n)}return this.lo+0x100000000*this.hi},i.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var s=String.prototype.charCodeAt;i.fromHash=function(e){return e===o?a:new i((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}}),hr=oe(e=>{var t=e;function n(e,t,n){for(var i=Object.keys(t),a=0;a<i.length;++a)void 0!==e[i[a]]&&n||(e[i[a]]=t[i[a]]);return e}function i(e){function t(e,i){if(!(this instanceof t))return new t(e,i);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:Error().stack||""}),i&&n(this,i)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}t.asPromise=xf(),t.base64=$f(),t.EventEmitter=Of(),t.float=Lf(),t.inquire=Rf(),t.utf8=Mf(),t.pool=Ff(),t.LongBits=Gf(),t.isNode=!!("u">typeof global&&global&&global.process&&global.process.versions&&global.process.versions.node),t.global=t.isNode&&global||"u">typeof window&&window||"u">typeof self&&self||e,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isObject=function(e){return e&&"object"==typeof e},t.isset=t.isSet=function(e,t){var n=e[t];return!!(null!=n&&e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},t.Buffer=function(){try{var e=t.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch{return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(e){return"number"==typeof e?t.Buffer?t._Buffer_allocUnsafe(e):new t.Array(e):t.Buffer?t._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)},t.Array="u">typeof Uint8Array?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(e){return e?t.LongBits.from(e).toHash():t.LongBits.zeroHash},t.longFromHash=function(e,n){var i=t.LongBits.fromHash(e);return t.Long?t.Long.fromBits(i.lo,i.hi,n):i.toNumber(!!n)},t.merge=n,t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},t.newError=i,t.ProtocolError=i("ProtocolError"),t.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},t.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var e=t.Buffer;if(!e){t._Buffer_from=t._Buffer_allocUnsafe=null;return}t._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},t._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}}}),fl=oe((e,t)=>{t.exports=d;var n,i=hr(),a=i.LongBits,o=i.base64,s=i.utf8;function l(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function u(){}function c(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new l(u,0,0),this.tail=this.head,this.states=null}var p=function(){return i.Buffer?function(){return(d.create=function(){return new n})()}:function(){return new d}};function h(e,t,n){t[n]=255&e}function f(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e}function g(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function y(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}d.create=p(),d.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(d.alloc=i.pool(d.alloc,i.Array.prototype.subarray)),d.prototype._push=function(e,t,n){return this.tail=this.tail.next=new l(e,t,n),this.len+=t,this},g.prototype=Object.create(l.prototype),g.prototype.fn=f,d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new g((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<0x10000000?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(m,10,a.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=a.from(e);return this._push(m,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=a.from(e).zzEncode();return this._push(m,t.length(),t)},d.prototype.bool=function(e){return this._push(h,1,+!!e)},d.prototype.fixed32=function(e){return this._push(y,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=a.from(e);return this._push(y,4,t.lo)._push(y,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var b=i.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(h,1,0);if(i.isString(e)){var n=d.alloc(t=o.length(e));o.decode(e,n,0),e=n}return this.uint32(t)._push(b,t,e)},d.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(h,1,0)},d.prototype.fork=function(){return this.states=new c(this),this.head=this.tail=new l(u,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(u,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},d._configure=function(e){n=e,d.create=p(),n._configure()}}),Jf=oe((e,t)=>{t.exports=a;var n=fl();(a.prototype=Object.create(n.prototype)).constructor=a;var i=hr();function a(){n.call(this)}function o(e,t,n){e.length<40?i.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}a._configure=function(){a.alloc=i._Buffer_allocUnsafe,a.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var i=0;i<e.length;)t[n++]=e[i++]}},a.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(a.writeBytesBuffer,t,e),this},a.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},a._configure()}),gl=oe((e,t)=>{t.exports=l;var n,i=hr(),a=i.LongBits,o=i.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var u="u">typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},c=function(){return i.Buffer?function(e){return(l.create=function(e){return i.Buffer.isBuffer(e)?new n(e):u(e)})(e)}:u};function d(){var e=new a(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function h(){if(this.pos+8>this.len)throw s(this,8);return new a(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}l.create=c(),l.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,l.prototype.uint32=function(){var e=0xffffffff;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return e}}(),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return p(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|p(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw s(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,n);if(t===n){var a=i.Buffer;return a?a.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,n)},l.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do if(this.pos>=this.len)throw s(this);while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){n=e,l.create=c(),n._configure();var t=i.Long?"toLong":"toNumber";i.merge(l.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return h.call(this)[t](!0)},sfixed64:function(){return h.call(this)[t](!1)}})}}),ah=oe((e,t)=>{t.exports=a;var n=gl();(a.prototype=Object.create(n.prototype)).constructor=a;var i=hr();function a(e){n.call(this,e)}a._configure=function(){i.Buffer&&(a.prototype._slice=i.Buffer.prototype.slice)},a.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},a._configure()}),uh=oe((e,t)=>{t.exports=i;var n=hr();function i(e,t,i){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!i}(i.prototype=Object.create(n.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,i,a,o,s){if(!o)throw TypeError("request must be specified");var l=this;if(!s)return n.asPromise(e,l,t,i,a,o);if(!l.rpcImpl)return void setTimeout(function(){s(Error("already ended"))},0);try{return l.rpcImpl(t,i[l.requestDelimited?"encodeDelimited":"encode"](o).finish(),function(e,n){if(e)return l.emit("error",e,t),s(e);if(null===n)return void l.end(!0);if(!(n instanceof a))try{n=a[l.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return l.emit("error",e,t),s(e)}return l.emit("data",n,t),s(null,n)})}catch(e){l.emit("error",e,t),setTimeout(function(){s(e)},0);return}},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}}),ch=oe(e=>{e.Service=uh()}),ph=oe((e,t)=>{t.exports={}}),mh=oe(e=>{var t=e;function n(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}t.build="minimal",t.Writer=fl(),t.BufferWriter=Jf(),t.Reader=gl(),t.BufferReader=ah(),t.util=hr(),t.rpc=ch(),t.roots=ph(),t.configure=n,n()}),bh=oe((e,t)=>{t.exports=mh()}),to=oe((e,t)=>{var n=bh(),i=n.Reader,a=n.Writer,o=n.util,s=n.roots.default||(n.roots.default={});s.onnx=function(){var e={};return e.Version=function(){var e={},t=Object.create(e);return t[e[0]="_START_VERSION"]=0,t[e[1]="IR_VERSION_2017_10_10"]=1,t[e[2]="IR_VERSION_2017_10_30"]=2,t[e[3]="IR_VERSION_2017_11_3"]=3,t[e[4]="IR_VERSION_2019_1_22"]=4,t[e[5]="IR_VERSION_2019_3_18"]=5,t[e[6]="IR_VERSION_2019_9_19"]=6,t[e[7]="IR_VERSION_2020_5_8"]=7,t[e[8]="IR_VERSION_2021_7_30"]=8,t[e[9]="IR_VERSION"]=9,t}(),e.AttributeProto=function(){function e(e){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],this.sparseTensors=[],this.typeProtos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.name="",e.prototype.refAttrName="",e.prototype.docString="",e.prototype.type=0,e.prototype.f=0,e.prototype.i=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.s=o.newBuffer([]),e.prototype.t=null,e.prototype.g=null,e.prototype.sparseTensor=null,e.prototype.tp=null,e.prototype.floats=o.emptyArray,e.prototype.ints=o.emptyArray,e.prototype.strings=o.emptyArray,e.prototype.tensors=o.emptyArray,e.prototype.graphs=o.emptyArray,e.prototype.sparseTensors=o.emptyArray,e.prototype.typeProtos=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.f&&Object.hasOwnProperty.call(e,"f")&&t.uint32(21).float(e.f),null!=e.i&&Object.hasOwnProperty.call(e,"i")&&t.uint32(24).int64(e.i),null!=e.s&&Object.hasOwnProperty.call(e,"s")&&t.uint32(34).bytes(e.s),null!=e.t&&Object.hasOwnProperty.call(e,"t")&&s.onnx.TensorProto.encode(e.t,t.uint32(42).fork()).ldelim(),null!=e.g&&Object.hasOwnProperty.call(e,"g")&&s.onnx.GraphProto.encode(e.g,t.uint32(50).fork()).ldelim(),null!=e.floats&&e.floats.length){t.uint32(58).fork();for(var n=0;n<e.floats.length;++n)t.float(e.floats[n]);t.ldelim()}if(null!=e.ints&&e.ints.length){t.uint32(66).fork();for(var n=0;n<e.ints.length;++n)t.int64(e.ints[n]);t.ldelim()}if(null!=e.strings&&e.strings.length)for(var n=0;n<e.strings.length;++n)t.uint32(74).bytes(e.strings[n]);if(null!=e.tensors&&e.tensors.length)for(var n=0;n<e.tensors.length;++n)s.onnx.TensorProto.encode(e.tensors[n],t.uint32(82).fork()).ldelim();if(null!=e.graphs&&e.graphs.length)for(var n=0;n<e.graphs.length;++n)s.onnx.GraphProto.encode(e.graphs[n],t.uint32(90).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(106).string(e.docString),null!=e.tp&&Object.hasOwnProperty.call(e,"tp")&&s.onnx.TypeProto.encode(e.tp,t.uint32(114).fork()).ldelim(),null!=e.typeProtos&&e.typeProtos.length)for(var n=0;n<e.typeProtos.length;++n)s.onnx.TypeProto.encode(e.typeProtos[n],t.uint32(122).fork()).ldelim();if(null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(160).int32(e.type),null!=e.refAttrName&&Object.hasOwnProperty.call(e,"refAttrName")&&t.uint32(170).string(e.refAttrName),null!=e.sparseTensor&&Object.hasOwnProperty.call(e,"sparseTensor")&&s.onnx.SparseTensorProto.encode(e.sparseTensor,t.uint32(178).fork()).ldelim(),null!=e.sparseTensors&&e.sparseTensors.length)for(var n=0;n<e.sparseTensors.length;++n)s.onnx.SparseTensorProto.encode(e.sparseTensors[n],t.uint32(186).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.AttributeProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.name=e.string();break;case 21:a.refAttrName=e.string();break;case 13:a.docString=e.string();break;case 20:a.type=e.int32();break;case 2:a.f=e.float();break;case 3:a.i=e.int64();break;case 4:a.s=e.bytes();break;case 5:a.t=s.onnx.TensorProto.decode(e,e.uint32());break;case 6:a.g=s.onnx.GraphProto.decode(e,e.uint32());break;case 22:a.sparseTensor=s.onnx.SparseTensorProto.decode(e,e.uint32());break;case 14:a.tp=s.onnx.TypeProto.decode(e,e.uint32());break;case 7:if(a.floats&&a.floats.length||(a.floats=[]),(7&o)==2)for(var l=e.uint32()+e.pos;e.pos<l;)a.floats.push(e.float());else a.floats.push(e.float());break;case 8:if(a.ints&&a.ints.length||(a.ints=[]),(7&o)==2)for(var l=e.uint32()+e.pos;e.pos<l;)a.ints.push(e.int64());else a.ints.push(e.int64());break;case 9:a.strings&&a.strings.length||(a.strings=[]),a.strings.push(e.bytes());break;case 10:a.tensors&&a.tensors.length||(a.tensors=[]),a.tensors.push(s.onnx.TensorProto.decode(e,e.uint32()));break;case 11:a.graphs&&a.graphs.length||(a.graphs=[]),a.graphs.push(s.onnx.GraphProto.decode(e,e.uint32()));break;case 23:a.sparseTensors&&a.sparseTensors.length||(a.sparseTensors=[]),a.sparseTensors.push(s.onnx.SparseTensorProto.decode(e,e.uint32()));break;case 15:a.typeProtos&&a.typeProtos.length||(a.typeProtos=[]),a.typeProtos.push(s.onnx.TypeProto.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.refAttrName&&e.hasOwnProperty("refAttrName")&&!o.isString(e.refAttrName))return"refAttrName: string expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 11:case 13:case 6:case 7:case 8:case 9:case 10:case 12:case 14:}if(null!=e.f&&e.hasOwnProperty("f")&&"number"!=typeof e.f)return"f: number expected";if(null!=e.i&&e.hasOwnProperty("i")&&!o.isInteger(e.i)&&!(e.i&&o.isInteger(e.i.low)&&o.isInteger(e.i.high)))return"i: integer|Long expected";if(null!=e.s&&e.hasOwnProperty("s")&&!(e.s&&"number"==typeof e.s.length||o.isString(e.s)))return"s: buffer expected";if(null!=e.t&&e.hasOwnProperty("t")){var t=s.onnx.TensorProto.verify(e.t);if(t)return"t."+t}if(null!=e.g&&e.hasOwnProperty("g")){var t=s.onnx.GraphProto.verify(e.g);if(t)return"g."+t}if(null!=e.sparseTensor&&e.hasOwnProperty("sparseTensor")){var t=s.onnx.SparseTensorProto.verify(e.sparseTensor);if(t)return"sparseTensor."+t}if(null!=e.tp&&e.hasOwnProperty("tp")){var t=s.onnx.TypeProto.verify(e.tp);if(t)return"tp."+t}if(null!=e.floats&&e.hasOwnProperty("floats")){if(!Array.isArray(e.floats))return"floats: array expected";for(var n=0;n<e.floats.length;++n)if("number"!=typeof e.floats[n])return"floats: number[] expected"}if(null!=e.ints&&e.hasOwnProperty("ints")){if(!Array.isArray(e.ints))return"ints: array expected";for(var n=0;n<e.ints.length;++n)if(!o.isInteger(e.ints[n])&&!(e.ints[n]&&o.isInteger(e.ints[n].low)&&o.isInteger(e.ints[n].high)))return"ints: integer|Long[] expected"}if(null!=e.strings&&e.hasOwnProperty("strings")){if(!Array.isArray(e.strings))return"strings: array expected";for(var n=0;n<e.strings.length;++n)if(!(e.strings[n]&&"number"==typeof e.strings[n].length||o.isString(e.strings[n])))return"strings: buffer[] expected"}if(null!=e.tensors&&e.hasOwnProperty("tensors")){if(!Array.isArray(e.tensors))return"tensors: array expected";for(var n=0;n<e.tensors.length;++n){var t=s.onnx.TensorProto.verify(e.tensors[n]);if(t)return"tensors."+t}}if(null!=e.graphs&&e.hasOwnProperty("graphs")){if(!Array.isArray(e.graphs))return"graphs: array expected";for(var n=0;n<e.graphs.length;++n){var t=s.onnx.GraphProto.verify(e.graphs[n]);if(t)return"graphs."+t}}if(null!=e.sparseTensors&&e.hasOwnProperty("sparseTensors")){if(!Array.isArray(e.sparseTensors))return"sparseTensors: array expected";for(var n=0;n<e.sparseTensors.length;++n){var t=s.onnx.SparseTensorProto.verify(e.sparseTensors[n]);if(t)return"sparseTensors."+t}}if(null!=e.typeProtos&&e.hasOwnProperty("typeProtos")){if(!Array.isArray(e.typeProtos))return"typeProtos: array expected";for(var n=0;n<e.typeProtos.length;++n){var t=s.onnx.TypeProto.verify(e.typeProtos[n]);if(t)return"typeProtos."+t}}return null},e.fromObject=function(e){if(e instanceof s.onnx.AttributeProto)return e;var t=new s.onnx.AttributeProto;switch(null!=e.name&&(t.name=String(e.name)),null!=e.refAttrName&&(t.refAttrName=String(e.refAttrName)),null!=e.docString&&(t.docString=String(e.docString)),e.type){default:"number"==typeof e.type&&(t.type=e.type);break;case"UNDEFINED":case 0:t.type=0;break;case"FLOAT":case 1:t.type=1;break;case"INT":case 2:t.type=2;break;case"STRING":case 3:t.type=3;break;case"TENSOR":case 4:t.type=4;break;case"GRAPH":case 5:t.type=5;break;case"SPARSE_TENSOR":case 11:t.type=11;break;case"TYPE_PROTO":case 13:t.type=13;break;case"FLOATS":case 6:t.type=6;break;case"INTS":case 7:t.type=7;break;case"STRINGS":case 8:t.type=8;break;case"TENSORS":case 9:t.type=9;break;case"GRAPHS":case 10:t.type=10;break;case"SPARSE_TENSORS":case 12:t.type=12;break;case"TYPE_PROTOS":case 14:t.type=14}if(null!=e.f&&(t.f=Number(e.f)),null!=e.i&&(o.Long?(t.i=o.Long.fromValue(e.i)).unsigned=!1:"string"==typeof e.i?t.i=parseInt(e.i,10):"number"==typeof e.i?t.i=e.i:"object"==typeof e.i&&(t.i=new o.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber())),null!=e.s&&("string"==typeof e.s?o.base64.decode(e.s,t.s=o.newBuffer(o.base64.length(e.s)),0):e.s.length>=0&&(t.s=e.s)),null!=e.t){if("object"!=typeof e.t)throw TypeError(".onnx.AttributeProto.t: object expected");t.t=s.onnx.TensorProto.fromObject(e.t)}if(null!=e.g){if("object"!=typeof e.g)throw TypeError(".onnx.AttributeProto.g: object expected");t.g=s.onnx.GraphProto.fromObject(e.g)}if(null!=e.sparseTensor){if("object"!=typeof e.sparseTensor)throw TypeError(".onnx.AttributeProto.sparseTensor: object expected");t.sparseTensor=s.onnx.SparseTensorProto.fromObject(e.sparseTensor)}if(null!=e.tp){if("object"!=typeof e.tp)throw TypeError(".onnx.AttributeProto.tp: object expected");t.tp=s.onnx.TypeProto.fromObject(e.tp)}if(e.floats){if(!Array.isArray(e.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");t.floats=[];for(var n=0;n<e.floats.length;++n)t.floats[n]=Number(e.floats[n])}if(e.ints){if(!Array.isArray(e.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");t.ints=[];for(var n=0;n<e.ints.length;++n)o.Long?(t.ints[n]=o.Long.fromValue(e.ints[n])).unsigned=!1:"string"==typeof e.ints[n]?t.ints[n]=parseInt(e.ints[n],10):"number"==typeof e.ints[n]?t.ints[n]=e.ints[n]:"object"==typeof e.ints[n]&&(t.ints[n]=new o.LongBits(e.ints[n].low>>>0,e.ints[n].high>>>0).toNumber())}if(e.strings){if(!Array.isArray(e.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");t.strings=[];for(var n=0;n<e.strings.length;++n)"string"==typeof e.strings[n]?o.base64.decode(e.strings[n],t.strings[n]=o.newBuffer(o.base64.length(e.strings[n])),0):e.strings[n].length>=0&&(t.strings[n]=e.strings[n])}if(e.tensors){if(!Array.isArray(e.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");t.tensors=[];for(var n=0;n<e.tensors.length;++n){if("object"!=typeof e.tensors[n])throw TypeError(".onnx.AttributeProto.tensors: object expected");t.tensors[n]=s.onnx.TensorProto.fromObject(e.tensors[n])}}if(e.graphs){if(!Array.isArray(e.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");t.graphs=[];for(var n=0;n<e.graphs.length;++n){if("object"!=typeof e.graphs[n])throw TypeError(".onnx.AttributeProto.graphs: object expected");t.graphs[n]=s.onnx.GraphProto.fromObject(e.graphs[n])}}if(e.sparseTensors){if(!Array.isArray(e.sparseTensors))throw TypeError(".onnx.AttributeProto.sparseTensors: array expected");t.sparseTensors=[];for(var n=0;n<e.sparseTensors.length;++n){if("object"!=typeof e.sparseTensors[n])throw TypeError(".onnx.AttributeProto.sparseTensors: object expected");t.sparseTensors[n]=s.onnx.SparseTensorProto.fromObject(e.sparseTensors[n])}}if(e.typeProtos){if(!Array.isArray(e.typeProtos))throw TypeError(".onnx.AttributeProto.typeProtos: array expected");t.typeProtos=[];for(var n=0;n<e.typeProtos.length;++n){if("object"!=typeof e.typeProtos[n])throw TypeError(".onnx.AttributeProto.typeProtos: object expected");t.typeProtos[n]=s.onnx.TypeProto.fromObject(e.typeProtos[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.floats=[],n.ints=[],n.strings=[],n.tensors=[],n.graphs=[],n.typeProtos=[],n.sparseTensors=[]),t.defaults){if(n.name="",n.f=0,o.Long){var i=new o.Long(0,0,!1);n.i=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.i=t.longs===String?"0":0;t.bytes===String?n.s="":(n.s=[],t.bytes!==Array&&(n.s=o.newBuffer(n.s))),n.t=null,n.g=null,n.docString="",n.tp=null,n.type=t.enums===String?"UNDEFINED":0,n.refAttrName="",n.sparseTensor=null}if(null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.f&&e.hasOwnProperty("f")&&(n.f=t.json&&!isFinite(e.f)?String(e.f):e.f),null!=e.i&&e.hasOwnProperty("i")&&("number"==typeof e.i?n.i=t.longs===String?String(e.i):e.i:n.i=t.longs===String?o.Long.prototype.toString.call(e.i):t.longs===Number?new o.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber():e.i),null!=e.s&&e.hasOwnProperty("s")&&(n.s=t.bytes===String?o.base64.encode(e.s,0,e.s.length):t.bytes===Array?Array.prototype.slice.call(e.s):e.s),null!=e.t&&e.hasOwnProperty("t")&&(n.t=s.onnx.TensorProto.toObject(e.t,t)),null!=e.g&&e.hasOwnProperty("g")&&(n.g=s.onnx.GraphProto.toObject(e.g,t)),e.floats&&e.floats.length){n.floats=[];for(var a=0;a<e.floats.length;++a)n.floats[a]=t.json&&!isFinite(e.floats[a])?String(e.floats[a]):e.floats[a]}if(e.ints&&e.ints.length){n.ints=[];for(var a=0;a<e.ints.length;++a)"number"==typeof e.ints[a]?n.ints[a]=t.longs===String?String(e.ints[a]):e.ints[a]:n.ints[a]=t.longs===String?o.Long.prototype.toString.call(e.ints[a]):t.longs===Number?new o.LongBits(e.ints[a].low>>>0,e.ints[a].high>>>0).toNumber():e.ints[a]}if(e.strings&&e.strings.length){n.strings=[];for(var a=0;a<e.strings.length;++a)n.strings[a]=t.bytes===String?o.base64.encode(e.strings[a],0,e.strings[a].length):t.bytes===Array?Array.prototype.slice.call(e.strings[a]):e.strings[a]}if(e.tensors&&e.tensors.length){n.tensors=[];for(var a=0;a<e.tensors.length;++a)n.tensors[a]=s.onnx.TensorProto.toObject(e.tensors[a],t)}if(e.graphs&&e.graphs.length){n.graphs=[];for(var a=0;a<e.graphs.length;++a)n.graphs[a]=s.onnx.GraphProto.toObject(e.graphs[a],t)}if(null!=e.docString&&e.hasOwnProperty("docString")&&(n.docString=e.docString),null!=e.tp&&e.hasOwnProperty("tp")&&(n.tp=s.onnx.TypeProto.toObject(e.tp,t)),e.typeProtos&&e.typeProtos.length){n.typeProtos=[];for(var a=0;a<e.typeProtos.length;++a)n.typeProtos[a]=s.onnx.TypeProto.toObject(e.typeProtos[a],t)}if(null!=e.type&&e.hasOwnProperty("type")&&(n.type=t.enums===String?void 0===s.onnx.AttributeProto.AttributeType[e.type]?e.type:s.onnx.AttributeProto.AttributeType[e.type]:e.type),null!=e.refAttrName&&e.hasOwnProperty("refAttrName")&&(n.refAttrName=e.refAttrName),null!=e.sparseTensor&&e.hasOwnProperty("sparseTensor")&&(n.sparseTensor=s.onnx.SparseTensorProto.toObject(e.sparseTensor,t)),e.sparseTensors&&e.sparseTensors.length){n.sparseTensors=[];for(var a=0;a<e.sparseTensors.length;++a)n.sparseTensors[a]=s.onnx.SparseTensorProto.toObject(e.sparseTensors[a],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.AttributeProto"},e.AttributeType=function(){var e={},t=Object.create(e);return t[e[0]="UNDEFINED"]=0,t[e[1]="FLOAT"]=1,t[e[2]="INT"]=2,t[e[3]="STRING"]=3,t[e[4]="TENSOR"]=4,t[e[5]="GRAPH"]=5,t[e[11]="SPARSE_TENSOR"]=11,t[e[13]="TYPE_PROTO"]=13,t[e[6]="FLOATS"]=6,t[e[7]="INTS"]=7,t[e[8]="STRINGS"]=8,t[e[9]="TENSORS"]=9,t[e[10]="GRAPHS"]=10,t[e[12]="SPARSE_TENSORS"]=12,t[e[14]="TYPE_PROTOS"]=14,t}(),e}(),e.ValueInfoProto=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.name="",e.prototype.type=null,e.prototype.docString="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&s.onnx.TypeProto.encode(e.type,t.uint32(18).fork()).ldelim(),null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(26).string(e.docString),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.ValueInfoProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.name=e.string();break;case 2:a.type=s.onnx.TypeProto.decode(e,e.uint32());break;case 3:a.docString=e.string();break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.type&&e.hasOwnProperty("type")){var t=s.onnx.TypeProto.verify(e.type);if(t)return"type."+t}return null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString)?"docString: string expected":null},e.fromObject=function(e){if(e instanceof s.onnx.ValueInfoProto)return e;var t=new s.onnx.ValueInfoProto;if(null!=e.name&&(t.name=String(e.name)),null!=e.type){if("object"!=typeof e.type)throw TypeError(".onnx.ValueInfoProto.type: object expected");t.type=s.onnx.TypeProto.fromObject(e.type)}return null!=e.docString&&(t.docString=String(e.docString)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.name="",n.type=null,n.docString=""),null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(n.type=s.onnx.TypeProto.toObject(e.type,t)),null!=e.docString&&e.hasOwnProperty("docString")&&(n.docString=e.docString),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.ValueInfoProto"},e}(),e.NodeProto=function(){function e(e){if(this.input=[],this.output=[],this.attribute=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.input=o.emptyArray,e.prototype.output=o.emptyArray,e.prototype.name="",e.prototype.opType="",e.prototype.domain="",e.prototype.attribute=o.emptyArray,e.prototype.docString="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.input&&e.input.length)for(var n=0;n<e.input.length;++n)t.uint32(10).string(e.input[n]);if(null!=e.output&&e.output.length)for(var n=0;n<e.output.length;++n)t.uint32(18).string(e.output[n]);if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(26).string(e.name),null!=e.opType&&Object.hasOwnProperty.call(e,"opType")&&t.uint32(34).string(e.opType),null!=e.attribute&&e.attribute.length)for(var n=0;n<e.attribute.length;++n)s.onnx.AttributeProto.encode(e.attribute[n],t.uint32(42).fork()).ldelim();return null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(50).string(e.docString),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(58).string(e.domain),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.NodeProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.input&&a.input.length||(a.input=[]),a.input.push(e.string());break;case 2:a.output&&a.output.length||(a.output=[]),a.output.push(e.string());break;case 3:a.name=e.string();break;case 4:a.opType=e.string();break;case 7:a.domain=e.string();break;case 5:a.attribute&&a.attribute.length||(a.attribute=[]),a.attribute.push(s.onnx.AttributeProto.decode(e,e.uint32()));break;case 6:a.docString=e.string();break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var t=0;t<e.input.length;++t)if(!o.isString(e.input[t]))return"input: string[] expected"}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(var t=0;t<e.output.length;++t)if(!o.isString(e.output[t]))return"output: string[] expected"}if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.opType&&e.hasOwnProperty("opType")&&!o.isString(e.opType))return"opType: string expected";if(null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain))return"domain: string expected";if(null!=e.attribute&&e.hasOwnProperty("attribute")){if(!Array.isArray(e.attribute))return"attribute: array expected";for(var t=0;t<e.attribute.length;++t){var n=s.onnx.AttributeProto.verify(e.attribute[t]);if(n)return"attribute."+n}}return null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString)?"docString: string expected":null},e.fromObject=function(e){if(e instanceof s.onnx.NodeProto)return e;var t=new s.onnx.NodeProto;if(e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.NodeProto.input: array expected");t.input=[];for(var n=0;n<e.input.length;++n)t.input[n]=String(e.input[n])}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.NodeProto.output: array expected");t.output=[];for(var n=0;n<e.output.length;++n)t.output[n]=String(e.output[n])}if(null!=e.name&&(t.name=String(e.name)),null!=e.opType&&(t.opType=String(e.opType)),null!=e.domain&&(t.domain=String(e.domain)),e.attribute){if(!Array.isArray(e.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");t.attribute=[];for(var n=0;n<e.attribute.length;++n){if("object"!=typeof e.attribute[n])throw TypeError(".onnx.NodeProto.attribute: object expected");t.attribute[n]=s.onnx.AttributeProto.fromObject(e.attribute[n])}}return null!=e.docString&&(t.docString=String(e.docString)),t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.input=[],n.output=[],n.attribute=[]),t.defaults&&(n.name="",n.opType="",n.docString="",n.domain=""),e.input&&e.input.length){n.input=[];for(var i=0;i<e.input.length;++i)n.input[i]=e.input[i]}if(e.output&&e.output.length){n.output=[];for(var i=0;i<e.output.length;++i)n.output[i]=e.output[i]}if(null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.opType&&e.hasOwnProperty("opType")&&(n.opType=e.opType),e.attribute&&e.attribute.length){n.attribute=[];for(var i=0;i<e.attribute.length;++i)n.attribute[i]=s.onnx.AttributeProto.toObject(e.attribute[i],t)}return null!=e.docString&&e.hasOwnProperty("docString")&&(n.docString=e.docString),null!=e.domain&&e.hasOwnProperty("domain")&&(n.domain=e.domain),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.NodeProto"},e}(),e.TrainingInfoProto=function(){function e(e){if(this.initializationBinding=[],this.updateBinding=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.initialization=null,e.prototype.algorithm=null,e.prototype.initializationBinding=o.emptyArray,e.prototype.updateBinding=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.initialization&&Object.hasOwnProperty.call(e,"initialization")&&s.onnx.GraphProto.encode(e.initialization,t.uint32(10).fork()).ldelim(),null!=e.algorithm&&Object.hasOwnProperty.call(e,"algorithm")&&s.onnx.GraphProto.encode(e.algorithm,t.uint32(18).fork()).ldelim(),null!=e.initializationBinding&&e.initializationBinding.length)for(var n=0;n<e.initializationBinding.length;++n)s.onnx.StringStringEntryProto.encode(e.initializationBinding[n],t.uint32(26).fork()).ldelim();if(null!=e.updateBinding&&e.updateBinding.length)for(var n=0;n<e.updateBinding.length;++n)s.onnx.StringStringEntryProto.encode(e.updateBinding[n],t.uint32(34).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.TrainingInfoProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.initialization=s.onnx.GraphProto.decode(e,e.uint32());break;case 2:a.algorithm=s.onnx.GraphProto.decode(e,e.uint32());break;case 3:a.initializationBinding&&a.initializationBinding.length||(a.initializationBinding=[]),a.initializationBinding.push(s.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 4:a.updateBinding&&a.updateBinding.length||(a.updateBinding=[]),a.updateBinding.push(s.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.initialization&&e.hasOwnProperty("initialization")){var t=s.onnx.GraphProto.verify(e.initialization);if(t)return"initialization."+t}if(null!=e.algorithm&&e.hasOwnProperty("algorithm")){var t=s.onnx.GraphProto.verify(e.algorithm);if(t)return"algorithm."+t}if(null!=e.initializationBinding&&e.hasOwnProperty("initializationBinding")){if(!Array.isArray(e.initializationBinding))return"initializationBinding: array expected";for(var n=0;n<e.initializationBinding.length;++n){var t=s.onnx.StringStringEntryProto.verify(e.initializationBinding[n]);if(t)return"initializationBinding."+t}}if(null!=e.updateBinding&&e.hasOwnProperty("updateBinding")){if(!Array.isArray(e.updateBinding))return"updateBinding: array expected";for(var n=0;n<e.updateBinding.length;++n){var t=s.onnx.StringStringEntryProto.verify(e.updateBinding[n]);if(t)return"updateBinding."+t}}return null},e.fromObject=function(e){if(e instanceof s.onnx.TrainingInfoProto)return e;var t=new s.onnx.TrainingInfoProto;if(null!=e.initialization){if("object"!=typeof e.initialization)throw TypeError(".onnx.TrainingInfoProto.initialization: object expected");t.initialization=s.onnx.GraphProto.fromObject(e.initialization)}if(null!=e.algorithm){if("object"!=typeof e.algorithm)throw TypeError(".onnx.TrainingInfoProto.algorithm: object expected");t.algorithm=s.onnx.GraphProto.fromObject(e.algorithm)}if(e.initializationBinding){if(!Array.isArray(e.initializationBinding))throw TypeError(".onnx.TrainingInfoProto.initializationBinding: array expected");t.initializationBinding=[];for(var n=0;n<e.initializationBinding.length;++n){if("object"!=typeof e.initializationBinding[n])throw TypeError(".onnx.TrainingInfoProto.initializationBinding: object expected");t.initializationBinding[n]=s.onnx.StringStringEntryProto.fromObject(e.initializationBinding[n])}}if(e.updateBinding){if(!Array.isArray(e.updateBinding))throw TypeError(".onnx.TrainingInfoProto.updateBinding: array expected");t.updateBinding=[];for(var n=0;n<e.updateBinding.length;++n){if("object"!=typeof e.updateBinding[n])throw TypeError(".onnx.TrainingInfoProto.updateBinding: object expected");t.updateBinding[n]=s.onnx.StringStringEntryProto.fromObject(e.updateBinding[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.initializationBinding=[],n.updateBinding=[]),t.defaults&&(n.initialization=null,n.algorithm=null),null!=e.initialization&&e.hasOwnProperty("initialization")&&(n.initialization=s.onnx.GraphProto.toObject(e.initialization,t)),null!=e.algorithm&&e.hasOwnProperty("algorithm")&&(n.algorithm=s.onnx.GraphProto.toObject(e.algorithm,t)),e.initializationBinding&&e.initializationBinding.length){n.initializationBinding=[];for(var i=0;i<e.initializationBinding.length;++i)n.initializationBinding[i]=s.onnx.StringStringEntryProto.toObject(e.initializationBinding[i],t)}if(e.updateBinding&&e.updateBinding.length){n.updateBinding=[];for(var i=0;i<e.updateBinding.length;++i)n.updateBinding[i]=s.onnx.StringStringEntryProto.toObject(e.updateBinding[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TrainingInfoProto"},e}(),e.ModelProto=function(){function e(e){if(this.opsetImport=[],this.metadataProps=[],this.trainingInfo=[],this.functions=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.irVersion=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.opsetImport=o.emptyArray,e.prototype.producerName="",e.prototype.producerVersion="",e.prototype.domain="",e.prototype.modelVersion=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.docString="",e.prototype.graph=null,e.prototype.metadataProps=o.emptyArray,e.prototype.trainingInfo=o.emptyArray,e.prototype.functions=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.irVersion&&Object.hasOwnProperty.call(e,"irVersion")&&t.uint32(8).int64(e.irVersion),null!=e.producerName&&Object.hasOwnProperty.call(e,"producerName")&&t.uint32(18).string(e.producerName),null!=e.producerVersion&&Object.hasOwnProperty.call(e,"producerVersion")&&t.uint32(26).string(e.producerVersion),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(34).string(e.domain),null!=e.modelVersion&&Object.hasOwnProperty.call(e,"modelVersion")&&t.uint32(40).int64(e.modelVersion),null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(50).string(e.docString),null!=e.graph&&Object.hasOwnProperty.call(e,"graph")&&s.onnx.GraphProto.encode(e.graph,t.uint32(58).fork()).ldelim(),null!=e.opsetImport&&e.opsetImport.length)for(var n=0;n<e.opsetImport.length;++n)s.onnx.OperatorSetIdProto.encode(e.opsetImport[n],t.uint32(66).fork()).ldelim();if(null!=e.metadataProps&&e.metadataProps.length)for(var n=0;n<e.metadataProps.length;++n)s.onnx.StringStringEntryProto.encode(e.metadataProps[n],t.uint32(114).fork()).ldelim();if(null!=e.trainingInfo&&e.trainingInfo.length)for(var n=0;n<e.trainingInfo.length;++n)s.onnx.TrainingInfoProto.encode(e.trainingInfo[n],t.uint32(162).fork()).ldelim();if(null!=e.functions&&e.functions.length)for(var n=0;n<e.functions.length;++n)s.onnx.FunctionProto.encode(e.functions[n],t.uint32(202).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.ModelProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.irVersion=e.int64();break;case 8:a.opsetImport&&a.opsetImport.length||(a.opsetImport=[]),a.opsetImport.push(s.onnx.OperatorSetIdProto.decode(e,e.uint32()));break;case 2:a.producerName=e.string();break;case 3:a.producerVersion=e.string();break;case 4:a.domain=e.string();break;case 5:a.modelVersion=e.int64();break;case 6:a.docString=e.string();break;case 7:a.graph=s.onnx.GraphProto.decode(e,e.uint32());break;case 14:a.metadataProps&&a.metadataProps.length||(a.metadataProps=[]),a.metadataProps.push(s.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 20:a.trainingInfo&&a.trainingInfo.length||(a.trainingInfo=[]),a.trainingInfo.push(s.onnx.TrainingInfoProto.decode(e,e.uint32()));break;case 25:a.functions&&a.functions.length||(a.functions=[]),a.functions.push(s.onnx.FunctionProto.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.irVersion&&e.hasOwnProperty("irVersion")&&!o.isInteger(e.irVersion)&&!(e.irVersion&&o.isInteger(e.irVersion.low)&&o.isInteger(e.irVersion.high)))return"irVersion: integer|Long expected";if(null!=e.opsetImport&&e.hasOwnProperty("opsetImport")){if(!Array.isArray(e.opsetImport))return"opsetImport: array expected";for(var t=0;t<e.opsetImport.length;++t){var n=s.onnx.OperatorSetIdProto.verify(e.opsetImport[t]);if(n)return"opsetImport."+n}}if(null!=e.producerName&&e.hasOwnProperty("producerName")&&!o.isString(e.producerName))return"producerName: string expected";if(null!=e.producerVersion&&e.hasOwnProperty("producerVersion")&&!o.isString(e.producerVersion))return"producerVersion: string expected";if(null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain))return"domain: string expected";if(null!=e.modelVersion&&e.hasOwnProperty("modelVersion")&&!o.isInteger(e.modelVersion)&&!(e.modelVersion&&o.isInteger(e.modelVersion.low)&&o.isInteger(e.modelVersion.high)))return"modelVersion: integer|Long expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.graph&&e.hasOwnProperty("graph")){var n=s.onnx.GraphProto.verify(e.graph);if(n)return"graph."+n}if(null!=e.metadataProps&&e.hasOwnProperty("metadataProps")){if(!Array.isArray(e.metadataProps))return"metadataProps: array expected";for(var t=0;t<e.metadataProps.length;++t){var n=s.onnx.StringStringEntryProto.verify(e.metadataProps[t]);if(n)return"metadataProps."+n}}if(null!=e.trainingInfo&&e.hasOwnProperty("trainingInfo")){if(!Array.isArray(e.trainingInfo))return"trainingInfo: array expected";for(var t=0;t<e.trainingInfo.length;++t){var n=s.onnx.TrainingInfoProto.verify(e.trainingInfo[t]);if(n)return"trainingInfo."+n}}if(null!=e.functions&&e.hasOwnProperty("functions")){if(!Array.isArray(e.functions))return"functions: array expected";for(var t=0;t<e.functions.length;++t){var n=s.onnx.FunctionProto.verify(e.functions[t]);if(n)return"functions."+n}}return null},e.fromObject=function(e){if(e instanceof s.onnx.ModelProto)return e;var t=new s.onnx.ModelProto;if(null!=e.irVersion&&(o.Long?(t.irVersion=o.Long.fromValue(e.irVersion)).unsigned=!1:"string"==typeof e.irVersion?t.irVersion=parseInt(e.irVersion,10):"number"==typeof e.irVersion?t.irVersion=e.irVersion:"object"==typeof e.irVersion&&(t.irVersion=new o.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber())),e.opsetImport){if(!Array.isArray(e.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");t.opsetImport=[];for(var n=0;n<e.opsetImport.length;++n){if("object"!=typeof e.opsetImport[n])throw TypeError(".onnx.ModelProto.opsetImport: object expected");t.opsetImport[n]=s.onnx.OperatorSetIdProto.fromObject(e.opsetImport[n])}}if(null!=e.producerName&&(t.producerName=String(e.producerName)),null!=e.producerVersion&&(t.producerVersion=String(e.producerVersion)),null!=e.domain&&(t.domain=String(e.domain)),null!=e.modelVersion&&(o.Long?(t.modelVersion=o.Long.fromValue(e.modelVersion)).unsigned=!1:"string"==typeof e.modelVersion?t.modelVersion=parseInt(e.modelVersion,10):"number"==typeof e.modelVersion?t.modelVersion=e.modelVersion:"object"==typeof e.modelVersion&&(t.modelVersion=new o.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber())),null!=e.docString&&(t.docString=String(e.docString)),null!=e.graph){if("object"!=typeof e.graph)throw TypeError(".onnx.ModelProto.graph: object expected");t.graph=s.onnx.GraphProto.fromObject(e.graph)}if(e.metadataProps){if(!Array.isArray(e.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");t.metadataProps=[];for(var n=0;n<e.metadataProps.length;++n){if("object"!=typeof e.metadataProps[n])throw TypeError(".onnx.ModelProto.metadataProps: object expected");t.metadataProps[n]=s.onnx.StringStringEntryProto.fromObject(e.metadataProps[n])}}if(e.trainingInfo){if(!Array.isArray(e.trainingInfo))throw TypeError(".onnx.ModelProto.trainingInfo: array expected");t.trainingInfo=[];for(var n=0;n<e.trainingInfo.length;++n){if("object"!=typeof e.trainingInfo[n])throw TypeError(".onnx.ModelProto.trainingInfo: object expected");t.trainingInfo[n]=s.onnx.TrainingInfoProto.fromObject(e.trainingInfo[n])}}if(e.functions){if(!Array.isArray(e.functions))throw TypeError(".onnx.ModelProto.functions: array expected");t.functions=[];for(var n=0;n<e.functions.length;++n){if("object"!=typeof e.functions[n])throw TypeError(".onnx.ModelProto.functions: object expected");t.functions[n]=s.onnx.FunctionProto.fromObject(e.functions[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.opsetImport=[],n.metadataProps=[],n.trainingInfo=[],n.functions=[]),t.defaults){if(o.Long){var i=new o.Long(0,0,!1);n.irVersion=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.irVersion=t.longs===String?"0":0;if(n.producerName="",n.producerVersion="",n.domain="",o.Long){var i=new o.Long(0,0,!1);n.modelVersion=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.modelVersion=t.longs===String?"0":0;n.docString="",n.graph=null}if(null!=e.irVersion&&e.hasOwnProperty("irVersion")&&("number"==typeof e.irVersion?n.irVersion=t.longs===String?String(e.irVersion):e.irVersion:n.irVersion=t.longs===String?o.Long.prototype.toString.call(e.irVersion):t.longs===Number?new o.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber():e.irVersion),null!=e.producerName&&e.hasOwnProperty("producerName")&&(n.producerName=e.producerName),null!=e.producerVersion&&e.hasOwnProperty("producerVersion")&&(n.producerVersion=e.producerVersion),null!=e.domain&&e.hasOwnProperty("domain")&&(n.domain=e.domain),null!=e.modelVersion&&e.hasOwnProperty("modelVersion")&&("number"==typeof e.modelVersion?n.modelVersion=t.longs===String?String(e.modelVersion):e.modelVersion:n.modelVersion=t.longs===String?o.Long.prototype.toString.call(e.modelVersion):t.longs===Number?new o.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber():e.modelVersion),null!=e.docString&&e.hasOwnProperty("docString")&&(n.docString=e.docString),null!=e.graph&&e.hasOwnProperty("graph")&&(n.graph=s.onnx.GraphProto.toObject(e.graph,t)),e.opsetImport&&e.opsetImport.length){n.opsetImport=[];for(var a=0;a<e.opsetImport.length;++a)n.opsetImport[a]=s.onnx.OperatorSetIdProto.toObject(e.opsetImport[a],t)}if(e.metadataProps&&e.metadataProps.length){n.metadataProps=[];for(var a=0;a<e.metadataProps.length;++a)n.metadataProps[a]=s.onnx.StringStringEntryProto.toObject(e.metadataProps[a],t)}if(e.trainingInfo&&e.trainingInfo.length){n.trainingInfo=[];for(var a=0;a<e.trainingInfo.length;++a)n.trainingInfo[a]=s.onnx.TrainingInfoProto.toObject(e.trainingInfo[a],t)}if(e.functions&&e.functions.length){n.functions=[];for(var a=0;a<e.functions.length;++a)n.functions[a]=s.onnx.FunctionProto.toObject(e.functions[a],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.ModelProto"},e}(),e.StringStringEntryProto=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.StringStringEntryProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.key=e.string();break;case 2:a.value=e.string();break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!o.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!o.isString(e.value)?"value: string expected":null},e.fromObject=function(e){if(e instanceof s.onnx.StringStringEntryProto)return e;var t=new s.onnx.StringStringEntryProto;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=""),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.StringStringEntryProto"},e}(),e.TensorAnnotation=function(){function e(e){if(this.quantParameterTensorNames=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.tensorName="",e.prototype.quantParameterTensorNames=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.tensorName&&Object.hasOwnProperty.call(e,"tensorName")&&t.uint32(10).string(e.tensorName),null!=e.quantParameterTensorNames&&e.quantParameterTensorNames.length)for(var n=0;n<e.quantParameterTensorNames.length;++n)s.onnx.StringStringEntryProto.encode(e.quantParameterTensorNames[n],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.TensorAnnotation;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.tensorName=e.string();break;case 2:a.quantParameterTensorNames&&a.quantParameterTensorNames.length||(a.quantParameterTensorNames=[]),a.quantParameterTensorNames.push(s.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.tensorName&&e.hasOwnProperty("tensorName")&&!o.isString(e.tensorName))return"tensorName: string expected";if(null!=e.quantParameterTensorNames&&e.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(e.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var t=0;t<e.quantParameterTensorNames.length;++t){var n=s.onnx.StringStringEntryProto.verify(e.quantParameterTensorNames[t]);if(n)return"quantParameterTensorNames."+n}}return null},e.fromObject=function(e){if(e instanceof s.onnx.TensorAnnotation)return e;var t=new s.onnx.TensorAnnotation;if(null!=e.tensorName&&(t.tensorName=String(e.tensorName)),e.quantParameterTensorNames){if(!Array.isArray(e.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");t.quantParameterTensorNames=[];for(var n=0;n<e.quantParameterTensorNames.length;++n){if("object"!=typeof e.quantParameterTensorNames[n])throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");t.quantParameterTensorNames[n]=s.onnx.StringStringEntryProto.fromObject(e.quantParameterTensorNames[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.quantParameterTensorNames=[]),t.defaults&&(n.tensorName=""),null!=e.tensorName&&e.hasOwnProperty("tensorName")&&(n.tensorName=e.tensorName),e.quantParameterTensorNames&&e.quantParameterTensorNames.length){n.quantParameterTensorNames=[];for(var i=0;i<e.quantParameterTensorNames.length;++i)n.quantParameterTensorNames[i]=s.onnx.StringStringEntryProto.toObject(e.quantParameterTensorNames[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorAnnotation"},e}(),e.GraphProto=function(){function e(e){if(this.node=[],this.initializer=[],this.sparseInitializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.node=o.emptyArray,e.prototype.name="",e.prototype.initializer=o.emptyArray,e.prototype.sparseInitializer=o.emptyArray,e.prototype.docString="",e.prototype.input=o.emptyArray,e.prototype.output=o.emptyArray,e.prototype.valueInfo=o.emptyArray,e.prototype.quantizationAnnotation=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.node&&e.node.length)for(var n=0;n<e.node.length;++n)s.onnx.NodeProto.encode(e.node[n],t.uint32(10).fork()).ldelim();if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),null!=e.initializer&&e.initializer.length)for(var n=0;n<e.initializer.length;++n)s.onnx.TensorProto.encode(e.initializer[n],t.uint32(42).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(82).string(e.docString),null!=e.input&&e.input.length)for(var n=0;n<e.input.length;++n)s.onnx.ValueInfoProto.encode(e.input[n],t.uint32(90).fork()).ldelim();if(null!=e.output&&e.output.length)for(var n=0;n<e.output.length;++n)s.onnx.ValueInfoProto.encode(e.output[n],t.uint32(98).fork()).ldelim();if(null!=e.valueInfo&&e.valueInfo.length)for(var n=0;n<e.valueInfo.length;++n)s.onnx.ValueInfoProto.encode(e.valueInfo[n],t.uint32(106).fork()).ldelim();if(null!=e.quantizationAnnotation&&e.quantizationAnnotation.length)for(var n=0;n<e.quantizationAnnotation.length;++n)s.onnx.TensorAnnotation.encode(e.quantizationAnnotation[n],t.uint32(114).fork()).ldelim();if(null!=e.sparseInitializer&&e.sparseInitializer.length)for(var n=0;n<e.sparseInitializer.length;++n)s.onnx.SparseTensorProto.encode(e.sparseInitializer[n],t.uint32(122).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.GraphProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.node&&a.node.length||(a.node=[]),a.node.push(s.onnx.NodeProto.decode(e,e.uint32()));break;case 2:a.name=e.string();break;case 5:a.initializer&&a.initializer.length||(a.initializer=[]),a.initializer.push(s.onnx.TensorProto.decode(e,e.uint32()));break;case 15:a.sparseInitializer&&a.sparseInitializer.length||(a.sparseInitializer=[]),a.sparseInitializer.push(s.onnx.SparseTensorProto.decode(e,e.uint32()));break;case 10:a.docString=e.string();break;case 11:a.input&&a.input.length||(a.input=[]),a.input.push(s.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 12:a.output&&a.output.length||(a.output=[]),a.output.push(s.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 13:a.valueInfo&&a.valueInfo.length||(a.valueInfo=[]),a.valueInfo.push(s.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 14:a.quantizationAnnotation&&a.quantizationAnnotation.length||(a.quantizationAnnotation=[]),a.quantizationAnnotation.push(s.onnx.TensorAnnotation.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.node&&e.hasOwnProperty("node")){if(!Array.isArray(e.node))return"node: array expected";for(var t=0;t<e.node.length;++t){var n=s.onnx.NodeProto.verify(e.node[t]);if(n)return"node."+n}}if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.initializer&&e.hasOwnProperty("initializer")){if(!Array.isArray(e.initializer))return"initializer: array expected";for(var t=0;t<e.initializer.length;++t){var n=s.onnx.TensorProto.verify(e.initializer[t]);if(n)return"initializer."+n}}if(null!=e.sparseInitializer&&e.hasOwnProperty("sparseInitializer")){if(!Array.isArray(e.sparseInitializer))return"sparseInitializer: array expected";for(var t=0;t<e.sparseInitializer.length;++t){var n=s.onnx.SparseTensorProto.verify(e.sparseInitializer[t]);if(n)return"sparseInitializer."+n}}if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var t=0;t<e.input.length;++t){var n=s.onnx.ValueInfoProto.verify(e.input[t]);if(n)return"input."+n}}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(var t=0;t<e.output.length;++t){var n=s.onnx.ValueInfoProto.verify(e.output[t]);if(n)return"output."+n}}if(null!=e.valueInfo&&e.hasOwnProperty("valueInfo")){if(!Array.isArray(e.valueInfo))return"valueInfo: array expected";for(var t=0;t<e.valueInfo.length;++t){var n=s.onnx.ValueInfoProto.verify(e.valueInfo[t]);if(n)return"valueInfo."+n}}if(null!=e.quantizationAnnotation&&e.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(e.quantizationAnnotation))return"quantizationAnnotation: array expected";for(var t=0;t<e.quantizationAnnotation.length;++t){var n=s.onnx.TensorAnnotation.verify(e.quantizationAnnotation[t]);if(n)return"quantizationAnnotation."+n}}return null},e.fromObject=function(e){if(e instanceof s.onnx.GraphProto)return e;var t=new s.onnx.GraphProto;if(e.node){if(!Array.isArray(e.node))throw TypeError(".onnx.GraphProto.node: array expected");t.node=[];for(var n=0;n<e.node.length;++n){if("object"!=typeof e.node[n])throw TypeError(".onnx.GraphProto.node: object expected");t.node[n]=s.onnx.NodeProto.fromObject(e.node[n])}}if(null!=e.name&&(t.name=String(e.name)),e.initializer){if(!Array.isArray(e.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");t.initializer=[];for(var n=0;n<e.initializer.length;++n){if("object"!=typeof e.initializer[n])throw TypeError(".onnx.GraphProto.initializer: object expected");t.initializer[n]=s.onnx.TensorProto.fromObject(e.initializer[n])}}if(e.sparseInitializer){if(!Array.isArray(e.sparseInitializer))throw TypeError(".onnx.GraphProto.sparseInitializer: array expected");t.sparseInitializer=[];for(var n=0;n<e.sparseInitializer.length;++n){if("object"!=typeof e.sparseInitializer[n])throw TypeError(".onnx.GraphProto.sparseInitializer: object expected");t.sparseInitializer[n]=s.onnx.SparseTensorProto.fromObject(e.sparseInitializer[n])}}if(null!=e.docString&&(t.docString=String(e.docString)),e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.GraphProto.input: array expected");t.input=[];for(var n=0;n<e.input.length;++n){if("object"!=typeof e.input[n])throw TypeError(".onnx.GraphProto.input: object expected");t.input[n]=s.onnx.ValueInfoProto.fromObject(e.input[n])}}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.GraphProto.output: array expected");t.output=[];for(var n=0;n<e.output.length;++n){if("object"!=typeof e.output[n])throw TypeError(".onnx.GraphProto.output: object expected");t.output[n]=s.onnx.ValueInfoProto.fromObject(e.output[n])}}if(e.valueInfo){if(!Array.isArray(e.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");t.valueInfo=[];for(var n=0;n<e.valueInfo.length;++n){if("object"!=typeof e.valueInfo[n])throw TypeError(".onnx.GraphProto.valueInfo: object expected");t.valueInfo[n]=s.onnx.ValueInfoProto.fromObject(e.valueInfo[n])}}if(e.quantizationAnnotation){if(!Array.isArray(e.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");t.quantizationAnnotation=[];for(var n=0;n<e.quantizationAnnotation.length;++n){if("object"!=typeof e.quantizationAnnotation[n])throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");t.quantizationAnnotation[n]=s.onnx.TensorAnnotation.fromObject(e.quantizationAnnotation[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.node=[],n.initializer=[],n.input=[],n.output=[],n.valueInfo=[],n.quantizationAnnotation=[],n.sparseInitializer=[]),t.defaults&&(n.name="",n.docString=""),e.node&&e.node.length){n.node=[];for(var i=0;i<e.node.length;++i)n.node[i]=s.onnx.NodeProto.toObject(e.node[i],t)}if(null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),e.initializer&&e.initializer.length){n.initializer=[];for(var i=0;i<e.initializer.length;++i)n.initializer[i]=s.onnx.TensorProto.toObject(e.initializer[i],t)}if(null!=e.docString&&e.hasOwnProperty("docString")&&(n.docString=e.docString),e.input&&e.input.length){n.input=[];for(var i=0;i<e.input.length;++i)n.input[i]=s.onnx.ValueInfoProto.toObject(e.input[i],t)}if(e.output&&e.output.length){n.output=[];for(var i=0;i<e.output.length;++i)n.output[i]=s.onnx.ValueInfoProto.toObject(e.output[i],t)}if(e.valueInfo&&e.valueInfo.length){n.valueInfo=[];for(var i=0;i<e.valueInfo.length;++i)n.valueInfo[i]=s.onnx.ValueInfoProto.toObject(e.valueInfo[i],t)}if(e.quantizationAnnotation&&e.quantizationAnnotation.length){n.quantizationAnnotation=[];for(var i=0;i<e.quantizationAnnotation.length;++i)n.quantizationAnnotation[i]=s.onnx.TensorAnnotation.toObject(e.quantizationAnnotation[i],t)}if(e.sparseInitializer&&e.sparseInitializer.length){n.sparseInitializer=[];for(var i=0;i<e.sparseInitializer.length;++i)n.sparseInitializer[i]=s.onnx.SparseTensorProto.toObject(e.sparseInitializer[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.GraphProto"},e}(),e.TensorProto=function(){function e(e){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.dims=o.emptyArray,e.prototype.dataType=0,e.prototype.segment=null,e.prototype.floatData=o.emptyArray,e.prototype.int32Data=o.emptyArray,e.prototype.stringData=o.emptyArray,e.prototype.int64Data=o.emptyArray,e.prototype.name="",e.prototype.docString="",e.prototype.rawData=o.newBuffer([]),e.prototype.externalData=o.emptyArray,e.prototype.dataLocation=0,e.prototype.doubleData=o.emptyArray,e.prototype.uint64Data=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.dims&&e.dims.length){t.uint32(10).fork();for(var n=0;n<e.dims.length;++n)t.int64(e.dims[n]);t.ldelim()}if(null!=e.dataType&&Object.hasOwnProperty.call(e,"dataType")&&t.uint32(16).int32(e.dataType),null!=e.segment&&Object.hasOwnProperty.call(e,"segment")&&s.onnx.TensorProto.Segment.encode(e.segment,t.uint32(26).fork()).ldelim(),null!=e.floatData&&e.floatData.length){t.uint32(34).fork();for(var n=0;n<e.floatData.length;++n)t.float(e.floatData[n]);t.ldelim()}if(null!=e.int32Data&&e.int32Data.length){t.uint32(42).fork();for(var n=0;n<e.int32Data.length;++n)t.int32(e.int32Data[n]);t.ldelim()}if(null!=e.stringData&&e.stringData.length)for(var n=0;n<e.stringData.length;++n)t.uint32(50).bytes(e.stringData[n]);if(null!=e.int64Data&&e.int64Data.length){t.uint32(58).fork();for(var n=0;n<e.int64Data.length;++n)t.int64(e.int64Data[n]);t.ldelim()}if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(66).string(e.name),null!=e.rawData&&Object.hasOwnProperty.call(e,"rawData")&&t.uint32(74).bytes(e.rawData),null!=e.doubleData&&e.doubleData.length){t.uint32(82).fork();for(var n=0;n<e.doubleData.length;++n)t.double(e.doubleData[n]);t.ldelim()}if(null!=e.uint64Data&&e.uint64Data.length){t.uint32(90).fork();for(var n=0;n<e.uint64Data.length;++n)t.uint64(e.uint64Data[n]);t.ldelim()}if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(98).string(e.docString),null!=e.externalData&&e.externalData.length)for(var n=0;n<e.externalData.length;++n)s.onnx.StringStringEntryProto.encode(e.externalData[n],t.uint32(106).fork()).ldelim();return null!=e.dataLocation&&Object.hasOwnProperty.call(e,"dataLocation")&&t.uint32(112).int32(e.dataLocation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.TensorProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:if(a.dims&&a.dims.length||(a.dims=[]),(7&o)==2)for(var l=e.uint32()+e.pos;e.pos<l;)a.dims.push(e.int64());else a.dims.push(e.int64());break;case 2:a.dataType=e.int32();break;case 3:a.segment=s.onnx.TensorProto.Segment.decode(e,e.uint32());break;case 4:if(a.floatData&&a.floatData.length||(a.floatData=[]),(7&o)==2)for(var l=e.uint32()+e.pos;e.pos<l;)a.floatData.push(e.float());else a.floatData.push(e.float());break;case 5:if(a.int32Data&&a.int32Data.length||(a.int32Data=[]),(7&o)==2)for(var l=e.uint32()+e.pos;e.pos<l;)a.int32Data.push(e.int32());else a.int32Data.push(e.int32());break;case 6:a.stringData&&a.stringData.length||(a.stringData=[]),a.stringData.push(e.bytes());break;case 7:if(a.int64Data&&a.int64Data.length||(a.int64Data=[]),(7&o)==2)for(var l=e.uint32()+e.pos;e.pos<l;)a.int64Data.push(e.int64());else a.int64Data.push(e.int64());break;case 8:a.name=e.string();break;case 12:a.docString=e.string();break;case 9:a.rawData=e.bytes();break;case 13:a.externalData&&a.externalData.length||(a.externalData=[]),a.externalData.push(s.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 14:a.dataLocation=e.int32();break;case 10:if(a.doubleData&&a.doubleData.length||(a.doubleData=[]),(7&o)==2)for(var l=e.uint32()+e.pos;e.pos<l;)a.doubleData.push(e.double());else a.doubleData.push(e.double());break;case 11:if(a.uint64Data&&a.uint64Data.length||(a.uint64Data=[]),(7&o)==2)for(var l=e.uint32()+e.pos;e.pos<l;)a.uint64Data.push(e.uint64());else a.uint64Data.push(e.uint64());break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.dims&&e.hasOwnProperty("dims")){if(!Array.isArray(e.dims))return"dims: array expected";for(var t=0;t<e.dims.length;++t)if(!o.isInteger(e.dims[t])&&!(e.dims[t]&&o.isInteger(e.dims[t].low)&&o.isInteger(e.dims[t].high)))return"dims: integer|Long[] expected"}if(null!=e.dataType&&e.hasOwnProperty("dataType")&&!o.isInteger(e.dataType))return"dataType: integer expected";if(null!=e.segment&&e.hasOwnProperty("segment")){var n=s.onnx.TensorProto.Segment.verify(e.segment);if(n)return"segment."+n}if(null!=e.floatData&&e.hasOwnProperty("floatData")){if(!Array.isArray(e.floatData))return"floatData: array expected";for(var t=0;t<e.floatData.length;++t)if("number"!=typeof e.floatData[t])return"floatData: number[] expected"}if(null!=e.int32Data&&e.hasOwnProperty("int32Data")){if(!Array.isArray(e.int32Data))return"int32Data: array expected";for(var t=0;t<e.int32Data.length;++t)if(!o.isInteger(e.int32Data[t]))return"int32Data: integer[] expected"}if(null!=e.stringData&&e.hasOwnProperty("stringData")){if(!Array.isArray(e.stringData))return"stringData: array expected";for(var t=0;t<e.stringData.length;++t)if(!(e.stringData[t]&&"number"==typeof e.stringData[t].length||o.isString(e.stringData[t])))return"stringData: buffer[] expected"}if(null!=e.int64Data&&e.hasOwnProperty("int64Data")){if(!Array.isArray(e.int64Data))return"int64Data: array expected";for(var t=0;t<e.int64Data.length;++t)if(!o.isInteger(e.int64Data[t])&&!(e.int64Data[t]&&o.isInteger(e.int64Data[t].low)&&o.isInteger(e.int64Data[t].high)))return"int64Data: integer|Long[] expected"}if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.rawData&&e.hasOwnProperty("rawData")&&!(e.rawData&&"number"==typeof e.rawData.length||o.isString(e.rawData)))return"rawData: buffer expected";if(null!=e.externalData&&e.hasOwnProperty("externalData")){if(!Array.isArray(e.externalData))return"externalData: array expected";for(var t=0;t<e.externalData.length;++t){var n=s.onnx.StringStringEntryProto.verify(e.externalData[t]);if(n)return"externalData."+n}}if(null!=e.dataLocation&&e.hasOwnProperty("dataLocation"))switch(e.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:}if(null!=e.doubleData&&e.hasOwnProperty("doubleData")){if(!Array.isArray(e.doubleData))return"doubleData: array expected";for(var t=0;t<e.doubleData.length;++t)if("number"!=typeof e.doubleData[t])return"doubleData: number[] expected"}if(null!=e.uint64Data&&e.hasOwnProperty("uint64Data")){if(!Array.isArray(e.uint64Data))return"uint64Data: array expected";for(var t=0;t<e.uint64Data.length;++t)if(!o.isInteger(e.uint64Data[t])&&!(e.uint64Data[t]&&o.isInteger(e.uint64Data[t].low)&&o.isInteger(e.uint64Data[t].high)))return"uint64Data: integer|Long[] expected"}return null},e.fromObject=function(e){if(e instanceof s.onnx.TensorProto)return e;var t=new s.onnx.TensorProto;if(e.dims){if(!Array.isArray(e.dims))throw TypeError(".onnx.TensorProto.dims: array expected");t.dims=[];for(var n=0;n<e.dims.length;++n)o.Long?(t.dims[n]=o.Long.fromValue(e.dims[n])).unsigned=!1:"string"==typeof e.dims[n]?t.dims[n]=parseInt(e.dims[n],10):"number"==typeof e.dims[n]?t.dims[n]=e.dims[n]:"object"==typeof e.dims[n]&&(t.dims[n]=new o.LongBits(e.dims[n].low>>>0,e.dims[n].high>>>0).toNumber())}if(null!=e.dataType&&(t.dataType=0|e.dataType),null!=e.segment){if("object"!=typeof e.segment)throw TypeError(".onnx.TensorProto.segment: object expected");t.segment=s.onnx.TensorProto.Segment.fromObject(e.segment)}if(e.floatData){if(!Array.isArray(e.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");t.floatData=[];for(var n=0;n<e.floatData.length;++n)t.floatData[n]=Number(e.floatData[n])}if(e.int32Data){if(!Array.isArray(e.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");t.int32Data=[];for(var n=0;n<e.int32Data.length;++n)t.int32Data[n]=0|e.int32Data[n]}if(e.stringData){if(!Array.isArray(e.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");t.stringData=[];for(var n=0;n<e.stringData.length;++n)"string"==typeof e.stringData[n]?o.base64.decode(e.stringData[n],t.stringData[n]=o.newBuffer(o.base64.length(e.stringData[n])),0):e.stringData[n].length>=0&&(t.stringData[n]=e.stringData[n])}if(e.int64Data){if(!Array.isArray(e.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");t.int64Data=[];for(var n=0;n<e.int64Data.length;++n)o.Long?(t.int64Data[n]=o.Long.fromValue(e.int64Data[n])).unsigned=!1:"string"==typeof e.int64Data[n]?t.int64Data[n]=parseInt(e.int64Data[n],10):"number"==typeof e.int64Data[n]?t.int64Data[n]=e.int64Data[n]:"object"==typeof e.int64Data[n]&&(t.int64Data[n]=new o.LongBits(e.int64Data[n].low>>>0,e.int64Data[n].high>>>0).toNumber())}if(null!=e.name&&(t.name=String(e.name)),null!=e.docString&&(t.docString=String(e.docString)),null!=e.rawData&&("string"==typeof e.rawData?o.base64.decode(e.rawData,t.rawData=o.newBuffer(o.base64.length(e.rawData)),0):e.rawData.length>=0&&(t.rawData=e.rawData)),e.externalData){if(!Array.isArray(e.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");t.externalData=[];for(var n=0;n<e.externalData.length;++n){if("object"!=typeof e.externalData[n])throw TypeError(".onnx.TensorProto.externalData: object expected");t.externalData[n]=s.onnx.StringStringEntryProto.fromObject(e.externalData[n])}}switch(e.dataLocation){default:"number"==typeof e.dataLocation&&(t.dataLocation=e.dataLocation);break;case"DEFAULT":case 0:t.dataLocation=0;break;case"EXTERNAL":case 1:t.dataLocation=1}if(e.doubleData){if(!Array.isArray(e.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");t.doubleData=[];for(var n=0;n<e.doubleData.length;++n)t.doubleData[n]=Number(e.doubleData[n])}if(e.uint64Data){if(!Array.isArray(e.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");t.uint64Data=[];for(var n=0;n<e.uint64Data.length;++n)o.Long?(t.uint64Data[n]=o.Long.fromValue(e.uint64Data[n])).unsigned=!0:"string"==typeof e.uint64Data[n]?t.uint64Data[n]=parseInt(e.uint64Data[n],10):"number"==typeof e.uint64Data[n]?t.uint64Data[n]=e.uint64Data[n]:"object"==typeof e.uint64Data[n]&&(t.uint64Data[n]=new o.LongBits(e.uint64Data[n].low>>>0,e.uint64Data[n].high>>>0).toNumber(!0))}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.dims=[],n.floatData=[],n.int32Data=[],n.stringData=[],n.int64Data=[],n.doubleData=[],n.uint64Data=[],n.externalData=[]),t.defaults&&(n.dataType=0,n.segment=null,n.name="",t.bytes===String?n.rawData="":(n.rawData=[],t.bytes!==Array&&(n.rawData=o.newBuffer(n.rawData))),n.docString="",n.dataLocation=t.enums===String?"DEFAULT":0),e.dims&&e.dims.length){n.dims=[];for(var i=0;i<e.dims.length;++i)"number"==typeof e.dims[i]?n.dims[i]=t.longs===String?String(e.dims[i]):e.dims[i]:n.dims[i]=t.longs===String?o.Long.prototype.toString.call(e.dims[i]):t.longs===Number?new o.LongBits(e.dims[i].low>>>0,e.dims[i].high>>>0).toNumber():e.dims[i]}if(null!=e.dataType&&e.hasOwnProperty("dataType")&&(n.dataType=e.dataType),null!=e.segment&&e.hasOwnProperty("segment")&&(n.segment=s.onnx.TensorProto.Segment.toObject(e.segment,t)),e.floatData&&e.floatData.length){n.floatData=[];for(var i=0;i<e.floatData.length;++i)n.floatData[i]=t.json&&!isFinite(e.floatData[i])?String(e.floatData[i]):e.floatData[i]}if(e.int32Data&&e.int32Data.length){n.int32Data=[];for(var i=0;i<e.int32Data.length;++i)n.int32Data[i]=e.int32Data[i]}if(e.stringData&&e.stringData.length){n.stringData=[];for(var i=0;i<e.stringData.length;++i)n.stringData[i]=t.bytes===String?o.base64.encode(e.stringData[i],0,e.stringData[i].length):t.bytes===Array?Array.prototype.slice.call(e.stringData[i]):e.stringData[i]}if(e.int64Data&&e.int64Data.length){n.int64Data=[];for(var i=0;i<e.int64Data.length;++i)"number"==typeof e.int64Data[i]?n.int64Data[i]=t.longs===String?String(e.int64Data[i]):e.int64Data[i]:n.int64Data[i]=t.longs===String?o.Long.prototype.toString.call(e.int64Data[i]):t.longs===Number?new o.LongBits(e.int64Data[i].low>>>0,e.int64Data[i].high>>>0).toNumber():e.int64Data[i]}if(null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.rawData&&e.hasOwnProperty("rawData")&&(n.rawData=t.bytes===String?o.base64.encode(e.rawData,0,e.rawData.length):t.bytes===Array?Array.prototype.slice.call(e.rawData):e.rawData),e.doubleData&&e.doubleData.length){n.doubleData=[];for(var i=0;i<e.doubleData.length;++i)n.doubleData[i]=t.json&&!isFinite(e.doubleData[i])?String(e.doubleData[i]):e.doubleData[i]}if(e.uint64Data&&e.uint64Data.length){n.uint64Data=[];for(var i=0;i<e.uint64Data.length;++i)"number"==typeof e.uint64Data[i]?n.uint64Data[i]=t.longs===String?String(e.uint64Data[i]):e.uint64Data[i]:n.uint64Data[i]=t.longs===String?o.Long.prototype.toString.call(e.uint64Data[i]):t.longs===Number?new o.LongBits(e.uint64Data[i].low>>>0,e.uint64Data[i].high>>>0).toNumber(!0):e.uint64Data[i]}if(null!=e.docString&&e.hasOwnProperty("docString")&&(n.docString=e.docString),e.externalData&&e.externalData.length){n.externalData=[];for(var i=0;i<e.externalData.length;++i)n.externalData[i]=s.onnx.StringStringEntryProto.toObject(e.externalData[i],t)}return null!=e.dataLocation&&e.hasOwnProperty("dataLocation")&&(n.dataLocation=t.enums===String?void 0===s.onnx.TensorProto.DataLocation[e.dataLocation]?e.dataLocation:s.onnx.TensorProto.DataLocation[e.dataLocation]:e.dataLocation),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorProto"},e.DataType=function(){var e={},t=Object.create(e);return t[e[0]="UNDEFINED"]=0,t[e[1]="FLOAT"]=1,t[e[2]="UINT8"]=2,t[e[3]="INT8"]=3,t[e[4]="UINT16"]=4,t[e[5]="INT16"]=5,t[e[6]="INT32"]=6,t[e[7]="INT64"]=7,t[e[8]="STRING"]=8,t[e[9]="BOOL"]=9,t[e[10]="FLOAT16"]=10,t[e[11]="DOUBLE"]=11,t[e[12]="UINT32"]=12,t[e[13]="UINT64"]=13,t[e[14]="COMPLEX64"]=14,t[e[15]="COMPLEX128"]=15,t[e[16]="BFLOAT16"]=16,t[e[17]="FLOAT8E4M3FN"]=17,t[e[18]="FLOAT8E4M3FNUZ"]=18,t[e[19]="FLOAT8E5M2"]=19,t[e[20]="FLOAT8E5M2FNUZ"]=20,t}(),e.Segment=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.begin=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.end=o.Long?o.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.begin&&Object.hasOwnProperty.call(e,"begin")&&t.uint32(8).int64(e.begin),null!=e.end&&Object.hasOwnProperty.call(e,"end")&&t.uint32(16).int64(e.end),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.TensorProto.Segment;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.begin=e.int64();break;case 2:a.end=e.int64();break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.begin&&e.hasOwnProperty("begin")&&!o.isInteger(e.begin)&&!(e.begin&&o.isInteger(e.begin.low)&&o.isInteger(e.begin.high))?"begin: integer|Long expected":null!=e.end&&e.hasOwnProperty("end")&&!o.isInteger(e.end)&&!(e.end&&o.isInteger(e.end.low)&&o.isInteger(e.end.high))?"end: integer|Long expected":null},e.fromObject=function(e){if(e instanceof s.onnx.TensorProto.Segment)return e;var t=new s.onnx.TensorProto.Segment;return null!=e.begin&&(o.Long?(t.begin=o.Long.fromValue(e.begin)).unsigned=!1:"string"==typeof e.begin?t.begin=parseInt(e.begin,10):"number"==typeof e.begin?t.begin=e.begin:"object"==typeof e.begin&&(t.begin=new o.LongBits(e.begin.low>>>0,e.begin.high>>>0).toNumber())),null!=e.end&&(o.Long?(t.end=o.Long.fromValue(e.end)).unsigned=!1:"string"==typeof e.end?t.end=parseInt(e.end,10):"number"==typeof e.end?t.end=e.end:"object"==typeof e.end&&(t.end=new o.LongBits(e.end.low>>>0,e.end.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(o.Long){var i=new o.Long(0,0,!1);n.begin=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.begin=t.longs===String?"0":0;if(o.Long){var i=new o.Long(0,0,!1);n.end=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.end=t.longs===String?"0":0}return null!=e.begin&&e.hasOwnProperty("begin")&&("number"==typeof e.begin?n.begin=t.longs===String?String(e.begin):e.begin:n.begin=t.longs===String?o.Long.prototype.toString.call(e.begin):t.longs===Number?new o.LongBits(e.begin.low>>>0,e.begin.high>>>0).toNumber():e.begin),null!=e.end&&e.hasOwnProperty("end")&&("number"==typeof e.end?n.end=t.longs===String?String(e.end):e.end:n.end=t.longs===String?o.Long.prototype.toString.call(e.end):t.longs===Number?new o.LongBits(e.end.low>>>0,e.end.high>>>0).toNumber():e.end),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorProto.Segment"},e}(),e.DataLocation=function(){var e={},t=Object.create(e);return t[e[0]="DEFAULT"]=0,t[e[1]="EXTERNAL"]=1,t}(),e}(),e.SparseTensorProto=function(){function e(e){if(this.dims=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.values=null,e.prototype.indices=null,e.prototype.dims=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.values&&Object.hasOwnProperty.call(e,"values")&&s.onnx.TensorProto.encode(e.values,t.uint32(10).fork()).ldelim(),null!=e.indices&&Object.hasOwnProperty.call(e,"indices")&&s.onnx.TensorProto.encode(e.indices,t.uint32(18).fork()).ldelim(),null!=e.dims&&e.dims.length){t.uint32(26).fork();for(var n=0;n<e.dims.length;++n)t.int64(e.dims[n]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.SparseTensorProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.values=s.onnx.TensorProto.decode(e,e.uint32());break;case 2:a.indices=s.onnx.TensorProto.decode(e,e.uint32());break;case 3:if(a.dims&&a.dims.length||(a.dims=[]),(7&o)==2)for(var l=e.uint32()+e.pos;e.pos<l;)a.dims.push(e.int64());else a.dims.push(e.int64());break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.values&&e.hasOwnProperty("values")){var t=s.onnx.TensorProto.verify(e.values);if(t)return"values."+t}if(null!=e.indices&&e.hasOwnProperty("indices")){var t=s.onnx.TensorProto.verify(e.indices);if(t)return"indices."+t}if(null!=e.dims&&e.hasOwnProperty("dims")){if(!Array.isArray(e.dims))return"dims: array expected";for(var n=0;n<e.dims.length;++n)if(!o.isInteger(e.dims[n])&&!(e.dims[n]&&o.isInteger(e.dims[n].low)&&o.isInteger(e.dims[n].high)))return"dims: integer|Long[] expected"}return null},e.fromObject=function(e){if(e instanceof s.onnx.SparseTensorProto)return e;var t=new s.onnx.SparseTensorProto;if(null!=e.values){if("object"!=typeof e.values)throw TypeError(".onnx.SparseTensorProto.values: object expected");t.values=s.onnx.TensorProto.fromObject(e.values)}if(null!=e.indices){if("object"!=typeof e.indices)throw TypeError(".onnx.SparseTensorProto.indices: object expected");t.indices=s.onnx.TensorProto.fromObject(e.indices)}if(e.dims){if(!Array.isArray(e.dims))throw TypeError(".onnx.SparseTensorProto.dims: array expected");t.dims=[];for(var n=0;n<e.dims.length;++n)o.Long?(t.dims[n]=o.Long.fromValue(e.dims[n])).unsigned=!1:"string"==typeof e.dims[n]?t.dims[n]=parseInt(e.dims[n],10):"number"==typeof e.dims[n]?t.dims[n]=e.dims[n]:"object"==typeof e.dims[n]&&(t.dims[n]=new o.LongBits(e.dims[n].low>>>0,e.dims[n].high>>>0).toNumber())}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.dims=[]),t.defaults&&(n.values=null,n.indices=null),null!=e.values&&e.hasOwnProperty("values")&&(n.values=s.onnx.TensorProto.toObject(e.values,t)),null!=e.indices&&e.hasOwnProperty("indices")&&(n.indices=s.onnx.TensorProto.toObject(e.indices,t)),e.dims&&e.dims.length){n.dims=[];for(var i=0;i<e.dims.length;++i)"number"==typeof e.dims[i]?n.dims[i]=t.longs===String?String(e.dims[i]):e.dims[i]:n.dims[i]=t.longs===String?o.Long.prototype.toString.call(e.dims[i]):t.longs===Number?new o.LongBits(e.dims[i].low>>>0,e.dims[i].high>>>0).toNumber():e.dims[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.SparseTensorProto"},e}(),e.TensorShapeProto=function(){function e(e){if(this.dim=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.dim=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.dim&&e.dim.length)for(var n=0;n<e.dim.length;++n)s.onnx.TensorShapeProto.Dimension.encode(e.dim[n],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.TensorShapeProto;e.pos<n;){var o=e.uint32();o>>>3==1?(a.dim&&a.dim.length||(a.dim=[]),a.dim.push(s.onnx.TensorShapeProto.Dimension.decode(e,e.uint32()))):e.skipType(7&o)}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.dim&&e.hasOwnProperty("dim")){if(!Array.isArray(e.dim))return"dim: array expected";for(var t=0;t<e.dim.length;++t){var n=s.onnx.TensorShapeProto.Dimension.verify(e.dim[t]);if(n)return"dim."+n}}return null},e.fromObject=function(e){if(e instanceof s.onnx.TensorShapeProto)return e;var t=new s.onnx.TensorShapeProto;if(e.dim){if(!Array.isArray(e.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");t.dim=[];for(var n=0;n<e.dim.length;++n){if("object"!=typeof e.dim[n])throw TypeError(".onnx.TensorShapeProto.dim: object expected");t.dim[n]=s.onnx.TensorShapeProto.Dimension.fromObject(e.dim[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.dim=[]),e.dim&&e.dim.length){n.dim=[];for(var i=0;i<e.dim.length;++i)n.dim[i]=s.onnx.TensorShapeProto.Dimension.toObject(e.dim[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorShapeProto"},e.Dimension=function(){var e;function t(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return t.prototype.dimValue=null,t.prototype.dimParam=null,t.prototype.denotation="",Object.defineProperty(t.prototype,"value",{get:o.oneOfGetter(e=["dimValue","dimParam"]),set:o.oneOfSetter(e)}),t.create=function(e){return new t(e)},t.encode=function(e,t){return t||(t=a.create()),null!=e.dimValue&&Object.hasOwnProperty.call(e,"dimValue")&&t.uint32(8).int64(e.dimValue),null!=e.dimParam&&Object.hasOwnProperty.call(e,"dimParam")&&t.uint32(18).string(e.dimParam),null!=e.denotation&&Object.hasOwnProperty.call(e,"denotation")&&t.uint32(26).string(e.denotation),t},t.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},t.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.TensorShapeProto.Dimension;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.dimValue=e.int64();break;case 2:a.dimParam=e.string();break;case 3:a.denotation=e.string();break;default:e.skipType(7&o)}}return a},t.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},t.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t={};if(null!=e.dimValue&&e.hasOwnProperty("dimValue")&&(t.value=1,!o.isInteger(e.dimValue)&&!(e.dimValue&&o.isInteger(e.dimValue.low)&&o.isInteger(e.dimValue.high))))return"dimValue: integer|Long expected";if(null!=e.dimParam&&e.hasOwnProperty("dimParam")){if(1===t.value)return"value: multiple values";if(t.value=1,!o.isString(e.dimParam))return"dimParam: string expected"}return null!=e.denotation&&e.hasOwnProperty("denotation")&&!o.isString(e.denotation)?"denotation: string expected":null},t.fromObject=function(e){if(e instanceof s.onnx.TensorShapeProto.Dimension)return e;var t=new s.onnx.TensorShapeProto.Dimension;return null!=e.dimValue&&(o.Long?(t.dimValue=o.Long.fromValue(e.dimValue)).unsigned=!1:"string"==typeof e.dimValue?t.dimValue=parseInt(e.dimValue,10):"number"==typeof e.dimValue?t.dimValue=e.dimValue:"object"==typeof e.dimValue&&(t.dimValue=new o.LongBits(e.dimValue.low>>>0,e.dimValue.high>>>0).toNumber())),null!=e.dimParam&&(t.dimParam=String(e.dimParam)),null!=e.denotation&&(t.denotation=String(e.denotation)),t},t.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.denotation=""),null!=e.dimValue&&e.hasOwnProperty("dimValue")&&("number"==typeof e.dimValue?n.dimValue=t.longs===String?String(e.dimValue):e.dimValue:n.dimValue=t.longs===String?o.Long.prototype.toString.call(e.dimValue):t.longs===Number?new o.LongBits(e.dimValue.low>>>0,e.dimValue.high>>>0).toNumber():e.dimValue,t.oneofs&&(n.value="dimValue")),null!=e.dimParam&&e.hasOwnProperty("dimParam")&&(n.dimParam=e.dimParam,t.oneofs&&(n.value="dimParam")),null!=e.denotation&&e.hasOwnProperty("denotation")&&(n.denotation=e.denotation),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},t.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorShapeProto.Dimension"},t}(),e}(),e.TypeProto=function(){var e;function t(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return t.prototype.tensorType=null,t.prototype.sequenceType=null,t.prototype.mapType=null,t.prototype.optionalType=null,t.prototype.sparseTensorType=null,t.prototype.denotation="",Object.defineProperty(t.prototype,"value",{get:o.oneOfGetter(e=["tensorType","sequenceType","mapType","optionalType","sparseTensorType"]),set:o.oneOfSetter(e)}),t.create=function(e){return new t(e)},t.encode=function(e,t){return t||(t=a.create()),null!=e.tensorType&&Object.hasOwnProperty.call(e,"tensorType")&&s.onnx.TypeProto.Tensor.encode(e.tensorType,t.uint32(10).fork()).ldelim(),null!=e.sequenceType&&Object.hasOwnProperty.call(e,"sequenceType")&&s.onnx.TypeProto.Sequence.encode(e.sequenceType,t.uint32(34).fork()).ldelim(),null!=e.mapType&&Object.hasOwnProperty.call(e,"mapType")&&s.onnx.TypeProto.Map.encode(e.mapType,t.uint32(42).fork()).ldelim(),null!=e.denotation&&Object.hasOwnProperty.call(e,"denotation")&&t.uint32(50).string(e.denotation),null!=e.sparseTensorType&&Object.hasOwnProperty.call(e,"sparseTensorType")&&s.onnx.TypeProto.SparseTensor.encode(e.sparseTensorType,t.uint32(66).fork()).ldelim(),null!=e.optionalType&&Object.hasOwnProperty.call(e,"optionalType")&&s.onnx.TypeProto.Optional.encode(e.optionalType,t.uint32(74).fork()).ldelim(),t},t.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},t.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.TypeProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.tensorType=s.onnx.TypeProto.Tensor.decode(e,e.uint32());break;case 4:a.sequenceType=s.onnx.TypeProto.Sequence.decode(e,e.uint32());break;case 5:a.mapType=s.onnx.TypeProto.Map.decode(e,e.uint32());break;case 9:a.optionalType=s.onnx.TypeProto.Optional.decode(e,e.uint32());break;case 8:a.sparseTensorType=s.onnx.TypeProto.SparseTensor.decode(e,e.uint32());break;case 6:a.denotation=e.string();break;default:e.skipType(7&o)}}return a},t.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},t.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t={};if(null!=e.tensorType&&e.hasOwnProperty("tensorType")){t.value=1;var n=s.onnx.TypeProto.Tensor.verify(e.tensorType);if(n)return"tensorType."+n}if(null!=e.sequenceType&&e.hasOwnProperty("sequenceType")){if(1===t.value)return"value: multiple values";t.value=1;var n=s.onnx.TypeProto.Sequence.verify(e.sequenceType);if(n)return"sequenceType."+n}if(null!=e.mapType&&e.hasOwnProperty("mapType")){if(1===t.value)return"value: multiple values";t.value=1;var n=s.onnx.TypeProto.Map.verify(e.mapType);if(n)return"mapType."+n}if(null!=e.optionalType&&e.hasOwnProperty("optionalType")){if(1===t.value)return"value: multiple values";t.value=1;var n=s.onnx.TypeProto.Optional.verify(e.optionalType);if(n)return"optionalType."+n}if(null!=e.sparseTensorType&&e.hasOwnProperty("sparseTensorType")){if(1===t.value)return"value: multiple values";t.value=1;var n=s.onnx.TypeProto.SparseTensor.verify(e.sparseTensorType);if(n)return"sparseTensorType."+n}return null!=e.denotation&&e.hasOwnProperty("denotation")&&!o.isString(e.denotation)?"denotation: string expected":null},t.fromObject=function(e){if(e instanceof s.onnx.TypeProto)return e;var t=new s.onnx.TypeProto;if(null!=e.tensorType){if("object"!=typeof e.tensorType)throw TypeError(".onnx.TypeProto.tensorType: object expected");t.tensorType=s.onnx.TypeProto.Tensor.fromObject(e.tensorType)}if(null!=e.sequenceType){if("object"!=typeof e.sequenceType)throw TypeError(".onnx.TypeProto.sequenceType: object expected");t.sequenceType=s.onnx.TypeProto.Sequence.fromObject(e.sequenceType)}if(null!=e.mapType){if("object"!=typeof e.mapType)throw TypeError(".onnx.TypeProto.mapType: object expected");t.mapType=s.onnx.TypeProto.Map.fromObject(e.mapType)}if(null!=e.optionalType){if("object"!=typeof e.optionalType)throw TypeError(".onnx.TypeProto.optionalType: object expected");t.optionalType=s.onnx.TypeProto.Optional.fromObject(e.optionalType)}if(null!=e.sparseTensorType){if("object"!=typeof e.sparseTensorType)throw TypeError(".onnx.TypeProto.sparseTensorType: object expected");t.sparseTensorType=s.onnx.TypeProto.SparseTensor.fromObject(e.sparseTensorType)}return null!=e.denotation&&(t.denotation=String(e.denotation)),t},t.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.denotation=""),null!=e.tensorType&&e.hasOwnProperty("tensorType")&&(n.tensorType=s.onnx.TypeProto.Tensor.toObject(e.tensorType,t),t.oneofs&&(n.value="tensorType")),null!=e.sequenceType&&e.hasOwnProperty("sequenceType")&&(n.sequenceType=s.onnx.TypeProto.Sequence.toObject(e.sequenceType,t),t.oneofs&&(n.value="sequenceType")),null!=e.mapType&&e.hasOwnProperty("mapType")&&(n.mapType=s.onnx.TypeProto.Map.toObject(e.mapType,t),t.oneofs&&(n.value="mapType")),null!=e.denotation&&e.hasOwnProperty("denotation")&&(n.denotation=e.denotation),null!=e.sparseTensorType&&e.hasOwnProperty("sparseTensorType")&&(n.sparseTensorType=s.onnx.TypeProto.SparseTensor.toObject(e.sparseTensorType,t),t.oneofs&&(n.value="sparseTensorType")),null!=e.optionalType&&e.hasOwnProperty("optionalType")&&(n.optionalType=s.onnx.TypeProto.Optional.toObject(e.optionalType,t),t.oneofs&&(n.value="optionalType")),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},t.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto"},t.Tensor=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.elemType=0,e.prototype.shape=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&t.uint32(8).int32(e.elemType),null!=e.shape&&Object.hasOwnProperty.call(e,"shape")&&s.onnx.TensorShapeProto.encode(e.shape,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.TypeProto.Tensor;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.elemType=e.int32();break;case 2:a.shape=s.onnx.TensorShapeProto.decode(e,e.uint32());break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")&&!o.isInteger(e.elemType))return"elemType: integer expected";if(null!=e.shape&&e.hasOwnProperty("shape")){var t=s.onnx.TensorShapeProto.verify(e.shape);if(t)return"shape."+t}return null},e.fromObject=function(e){if(e instanceof s.onnx.TypeProto.Tensor)return e;var t=new s.onnx.TypeProto.Tensor;if(null!=e.elemType&&(t.elemType=0|e.elemType),null!=e.shape){if("object"!=typeof e.shape)throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");t.shape=s.onnx.TensorShapeProto.fromObject(e.shape)}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.elemType=0,n.shape=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(n.elemType=e.elemType),null!=e.shape&&e.hasOwnProperty("shape")&&(n.shape=s.onnx.TensorShapeProto.toObject(e.shape,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Tensor"},e}(),t.Sequence=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.elemType=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&s.onnx.TypeProto.encode(e.elemType,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.TypeProto.Sequence;e.pos<n;){var o=e.uint32();o>>>3==1?a.elemType=s.onnx.TypeProto.decode(e,e.uint32()):e.skipType(7&o)}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")){var t=s.onnx.TypeProto.verify(e.elemType);if(t)return"elemType."+t}return null},e.fromObject=function(e){if(e instanceof s.onnx.TypeProto.Sequence)return e;var t=new s.onnx.TypeProto.Sequence;if(null!=e.elemType){if("object"!=typeof e.elemType)throw TypeError(".onnx.TypeProto.Sequence.elemType: object expected");t.elemType=s.onnx.TypeProto.fromObject(e.elemType)}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.elemType=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(n.elemType=s.onnx.TypeProto.toObject(e.elemType,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Sequence"},e}(),t.Map=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.keyType=0,e.prototype.valueType=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.keyType&&Object.hasOwnProperty.call(e,"keyType")&&t.uint32(8).int32(e.keyType),null!=e.valueType&&Object.hasOwnProperty.call(e,"valueType")&&s.onnx.TypeProto.encode(e.valueType,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.TypeProto.Map;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.keyType=e.int32();break;case 2:a.valueType=s.onnx.TypeProto.decode(e,e.uint32());break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.keyType&&e.hasOwnProperty("keyType")&&!o.isInteger(e.keyType))return"keyType: integer expected";if(null!=e.valueType&&e.hasOwnProperty("valueType")){var t=s.onnx.TypeProto.verify(e.valueType);if(t)return"valueType."+t}return null},e.fromObject=function(e){if(e instanceof s.onnx.TypeProto.Map)return e;var t=new s.onnx.TypeProto.Map;if(null!=e.keyType&&(t.keyType=0|e.keyType),null!=e.valueType){if("object"!=typeof e.valueType)throw TypeError(".onnx.TypeProto.Map.valueType: object expected");t.valueType=s.onnx.TypeProto.fromObject(e.valueType)}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.keyType=0,n.valueType=null),null!=e.keyType&&e.hasOwnProperty("keyType")&&(n.keyType=e.keyType),null!=e.valueType&&e.hasOwnProperty("valueType")&&(n.valueType=s.onnx.TypeProto.toObject(e.valueType,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Map"},e}(),t.Optional=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.elemType=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&s.onnx.TypeProto.encode(e.elemType,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.TypeProto.Optional;e.pos<n;){var o=e.uint32();o>>>3==1?a.elemType=s.onnx.TypeProto.decode(e,e.uint32()):e.skipType(7&o)}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")){var t=s.onnx.TypeProto.verify(e.elemType);if(t)return"elemType."+t}return null},e.fromObject=function(e){if(e instanceof s.onnx.TypeProto.Optional)return e;var t=new s.onnx.TypeProto.Optional;if(null!=e.elemType){if("object"!=typeof e.elemType)throw TypeError(".onnx.TypeProto.Optional.elemType: object expected");t.elemType=s.onnx.TypeProto.fromObject(e.elemType)}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.elemType=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(n.elemType=s.onnx.TypeProto.toObject(e.elemType,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Optional"},e}(),t.SparseTensor=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.elemType=0,e.prototype.shape=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&t.uint32(8).int32(e.elemType),null!=e.shape&&Object.hasOwnProperty.call(e,"shape")&&s.onnx.TensorShapeProto.encode(e.shape,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.TypeProto.SparseTensor;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.elemType=e.int32();break;case 2:a.shape=s.onnx.TensorShapeProto.decode(e,e.uint32());break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")&&!o.isInteger(e.elemType))return"elemType: integer expected";if(null!=e.shape&&e.hasOwnProperty("shape")){var t=s.onnx.TensorShapeProto.verify(e.shape);if(t)return"shape."+t}return null},e.fromObject=function(e){if(e instanceof s.onnx.TypeProto.SparseTensor)return e;var t=new s.onnx.TypeProto.SparseTensor;if(null!=e.elemType&&(t.elemType=0|e.elemType),null!=e.shape){if("object"!=typeof e.shape)throw TypeError(".onnx.TypeProto.SparseTensor.shape: object expected");t.shape=s.onnx.TensorShapeProto.fromObject(e.shape)}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.elemType=0,n.shape=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(n.elemType=e.elemType),null!=e.shape&&e.hasOwnProperty("shape")&&(n.shape=s.onnx.TensorShapeProto.toObject(e.shape,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.SparseTensor"},e}(),t}(),e.OperatorSetIdProto=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.domain="",e.prototype.version=o.Long?o.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(10).string(e.domain),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(16).int64(e.version),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.OperatorSetIdProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.domain=e.string();break;case 2:a.version=e.int64();break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain)?"domain: string expected":null!=e.version&&e.hasOwnProperty("version")&&!o.isInteger(e.version)&&!(e.version&&o.isInteger(e.version.low)&&o.isInteger(e.version.high))?"version: integer|Long expected":null},e.fromObject=function(e){if(e instanceof s.onnx.OperatorSetIdProto)return e;var t=new s.onnx.OperatorSetIdProto;return null!=e.domain&&(t.domain=String(e.domain)),null!=e.version&&(o.Long?(t.version=o.Long.fromValue(e.version)).unsigned=!1:"string"==typeof e.version?t.version=parseInt(e.version,10):"number"==typeof e.version?t.version=e.version:"object"==typeof e.version&&(t.version=new o.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if(n.domain="",o.Long){var i=new o.Long(0,0,!1);n.version=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.version=t.longs===String?"0":0;return null!=e.domain&&e.hasOwnProperty("domain")&&(n.domain=e.domain),null!=e.version&&e.hasOwnProperty("version")&&("number"==typeof e.version?n.version=t.longs===String?String(e.version):e.version:n.version=t.longs===String?o.Long.prototype.toString.call(e.version):t.longs===Number?new o.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber():e.version),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.OperatorSetIdProto"},e}(),e.OperatorStatus=function(){var e={},t=Object.create(e);return t[e[0]="EXPERIMENTAL"]=0,t[e[1]="STABLE"]=1,t}(),e.FunctionProto=function(){function e(e){if(this.input=[],this.output=[],this.attribute=[],this.attributeProto=[],this.node=[],this.opsetImport=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.name="",e.prototype.input=o.emptyArray,e.prototype.output=o.emptyArray,e.prototype.attribute=o.emptyArray,e.prototype.attributeProto=o.emptyArray,e.prototype.node=o.emptyArray,e.prototype.docString="",e.prototype.opsetImport=o.emptyArray,e.prototype.domain="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.input&&e.input.length)for(var n=0;n<e.input.length;++n)t.uint32(34).string(e.input[n]);if(null!=e.output&&e.output.length)for(var n=0;n<e.output.length;++n)t.uint32(42).string(e.output[n]);if(null!=e.attribute&&e.attribute.length)for(var n=0;n<e.attribute.length;++n)t.uint32(50).string(e.attribute[n]);if(null!=e.node&&e.node.length)for(var n=0;n<e.node.length;++n)s.onnx.NodeProto.encode(e.node[n],t.uint32(58).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(66).string(e.docString),null!=e.opsetImport&&e.opsetImport.length)for(var n=0;n<e.opsetImport.length;++n)s.onnx.OperatorSetIdProto.encode(e.opsetImport[n],t.uint32(74).fork()).ldelim();if(null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(82).string(e.domain),null!=e.attributeProto&&e.attributeProto.length)for(var n=0;n<e.attributeProto.length;++n)s.onnx.AttributeProto.encode(e.attributeProto[n],t.uint32(90).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new s.onnx.FunctionProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:a.name=e.string();break;case 4:a.input&&a.input.length||(a.input=[]),a.input.push(e.string());break;case 5:a.output&&a.output.length||(a.output=[]),a.output.push(e.string());break;case 6:a.attribute&&a.attribute.length||(a.attribute=[]),a.attribute.push(e.string());break;case 11:a.attributeProto&&a.attributeProto.length||(a.attributeProto=[]),a.attributeProto.push(s.onnx.AttributeProto.decode(e,e.uint32()));break;case 7:a.node&&a.node.length||(a.node=[]),a.node.push(s.onnx.NodeProto.decode(e,e.uint32()));break;case 8:a.docString=e.string();break;case 9:a.opsetImport&&a.opsetImport.length||(a.opsetImport=[]),a.opsetImport.push(s.onnx.OperatorSetIdProto.decode(e,e.uint32()));break;case 10:a.domain=e.string();break;default:e.skipType(7&o)}}return a},e.decodeDelimited=function(e){return e instanceof i||(e=new i(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var t=0;t<e.input.length;++t)if(!o.isString(e.input[t]))return"input: string[] expected"}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(var t=0;t<e.output.length;++t)if(!o.isString(e.output[t]))return"output: string[] expected"}if(null!=e.attribute&&e.hasOwnProperty("attribute")){if(!Array.isArray(e.attribute))return"attribute: array expected";for(var t=0;t<e.attribute.length;++t)if(!o.isString(e.attribute[t]))return"attribute: string[] expected"}if(null!=e.attributeProto&&e.hasOwnProperty("attributeProto")){if(!Array.isArray(e.attributeProto))return"attributeProto: array expected";for(var t=0;t<e.attributeProto.length;++t){var n=s.onnx.AttributeProto.verify(e.attributeProto[t]);if(n)return"attributeProto."+n}}if(null!=e.node&&e.hasOwnProperty("node")){if(!Array.isArray(e.node))return"node: array expected";for(var t=0;t<e.node.length;++t){var n=s.onnx.NodeProto.verify(e.node[t]);if(n)return"node."+n}}if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.opsetImport&&e.hasOwnProperty("opsetImport")){if(!Array.isArray(e.opsetImport))return"opsetImport: array expected";for(var t=0;t<e.opsetImport.length;++t){var n=s.onnx.OperatorSetIdProto.verify(e.opsetImport[t]);if(n)return"opsetImport."+n}}return null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain)?"domain: string expected":null},e.fromObject=function(e){if(e instanceof s.onnx.FunctionProto)return e;var t=new s.onnx.FunctionProto;if(null!=e.name&&(t.name=String(e.name)),e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.FunctionProto.input: array expected");t.input=[];for(var n=0;n<e.input.length;++n)t.input[n]=String(e.input[n])}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.FunctionProto.output: array expected");t.output=[];for(var n=0;n<e.output.length;++n)t.output[n]=String(e.output[n])}if(e.attribute){if(!Array.isArray(e.attribute))throw TypeError(".onnx.FunctionProto.attribute: array expected");t.attribute=[];for(var n=0;n<e.attribute.length;++n)t.attribute[n]=String(e.attribute[n])}if(e.attributeProto){if(!Array.isArray(e.attributeProto))throw TypeError(".onnx.FunctionProto.attributeProto: array expected");t.attributeProto=[];for(var n=0;n<e.attributeProto.length;++n){if("object"!=typeof e.attributeProto[n])throw TypeError(".onnx.FunctionProto.attributeProto: object expected");t.attributeProto[n]=s.onnx.AttributeProto.fromObject(e.attributeProto[n])}}if(e.node){if(!Array.isArray(e.node))throw TypeError(".onnx.FunctionProto.node: array expected");t.node=[];for(var n=0;n<e.node.length;++n){if("object"!=typeof e.node[n])throw TypeError(".onnx.FunctionProto.node: object expected");t.node[n]=s.onnx.NodeProto.fromObject(e.node[n])}}if(null!=e.docString&&(t.docString=String(e.docString)),e.opsetImport){if(!Array.isArray(e.opsetImport))throw TypeError(".onnx.FunctionProto.opsetImport: array expected");t.opsetImport=[];for(var n=0;n<e.opsetImport.length;++n){if("object"!=typeof e.opsetImport[n])throw TypeError(".onnx.FunctionProto.opsetImport: object expected");t.opsetImport[n]=s.onnx.OperatorSetIdProto.fromObject(e.opsetImport[n])}}return null!=e.domain&&(t.domain=String(e.domain)),t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.input=[],n.output=[],n.attribute=[],n.node=[],n.opsetImport=[],n.attributeProto=[]),t.defaults&&(n.name="",n.docString="",n.domain=""),null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),e.input&&e.input.length){n.input=[];for(var i=0;i<e.input.length;++i)n.input[i]=e.input[i]}if(e.output&&e.output.length){n.output=[];for(var i=0;i<e.output.length;++i)n.output[i]=e.output[i]}if(e.attribute&&e.attribute.length){n.attribute=[];for(var i=0;i<e.attribute.length;++i)n.attribute[i]=e.attribute[i]}if(e.node&&e.node.length){n.node=[];for(var i=0;i<e.node.length;++i)n.node[i]=s.onnx.NodeProto.toObject(e.node[i],t)}if(null!=e.docString&&e.hasOwnProperty("docString")&&(n.docString=e.docString),e.opsetImport&&e.opsetImport.length){n.opsetImport=[];for(var i=0;i<e.opsetImport.length;++i)n.opsetImport[i]=s.onnx.OperatorSetIdProto.toObject(e.opsetImport[i],t)}if(null!=e.domain&&e.hasOwnProperty("domain")&&(n.domain=e.domain),e.attributeProto&&e.attributeProto.length){n.attributeProto=[];for(var i=0;i<e.attributeProto.length;++i)n.attributeProto[i]=s.onnx.AttributeProto.toObject(e.attributeProto[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.FunctionProto"},e}(),e}(),t.exports=s});function no(e,t){if(!e)throw Error("string"==typeof t?t:t())}function Co(e){return new TextDecoder().decode(e)}var We,kr,yl,gt,Li,ft,xt,ne,Eo,Nr,Lr,Rr,Me=k(()=>{Fs(),We=ve(to()),zr(),kr=class{static arraysEqual(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}},yl=class{static preprocessInputShapes(e,t){return[1===e.length?[1,e[0]]:e,1===t.length?[t[0],1]:t]}static postprocessOutputShape(e,t,n){1===t&&e.splice(e.length-2,1),1===n&&e.pop()}static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}},gt=class e{static calcShape(e,t,n=!1){let i=e.length,a=t.length;if(0===i)return t;if(0===a)return e;let o=Math.max(e.length,t.length),s=Array(o);if(n){if(i<2||a<2)return;let n=yl.calcMatMulShape([e[i-2],e[i-1]],[t[a-2],t[a-1]]);if(void 0===n)return;[s[o-2],s[o-1]]=n}for(let l=n?3:1;l<=o;l++){let n=i-l<0?1:e[i-l],u=a-l<0?1:t[a-l];if(n!==u&&n>1&&u>1)return;s[o-l]=Math.max(n,u)}return s}static index(t,n){let i=Array(n.length);return e.fillIndex(t,n,i),i}static fillIndex(e,t,n){let i=e.length-t.length;for(let a=0;a<t.length;a++)n[a]=e[i+a]%t[a]}static calc(t,n,i,a,o){let s=e.calcShape(t.dims,n.dims);if(s){if(a&&!ne.areEqual(s,t.dims))return;let l=ne.size(s),u=a?t:new nt(s,o||t.type);if(0===s.length)u.set([],i(t.get([]),n.get([])));else{let a,o=Array(s.length),c=Array(t.dims.length),d=Array(n.dims.length),p=0,h=0,f=!1,g=!1;0===t.dims.length&&(p=t.get([]),f=!0),0===n.dims.length&&(h=n.get([]),g=!0);for(let m=0;m<l;m++){a=m;for(let e=s.length-1;e>=0;e--)o[e]=a%s[e],a=Math.floor(a/s[e]);f||(e.fillIndex(o,t.dims,c),p=t.get(c)),g||(e.fillIndex(o,n.dims,d),h=n.get(d)),u.set(o,i(p,h))}}return u}}static isValidBroadcast(e,t){let n=e.length,i=t.length;if(n>i)return!1;for(let a=1;a<=n;a++)if(1!==e[n-a]&&e[n-a]!==t[i-a])return!1;return!0}static getBroadcastDims(e,t){let n=e.length,i=[];for(let a=0;a<n;a++){let o=n-1-a,s=e[o]||1;(t[t.length-1-a]||1)>1&&1===s&&i.unshift(o)}return i}},Li=class{static getShapeOfGemmResult(e,t,n,i,a){let o,s,l;if(2!==e.length||2!==n.length)throw Error("shape need to be of size 2");t?(o=e[1],s=e[0]):(o=e[0],s=e[1]);let u=-1;if(i?(l=n[0],u=1):(l=n[1],u=0),n[u]!==s)throw Error("dimension mismatch");if(o<=0||l<=0||s<=0)throw Error("invalid shape specified");if(a&&!gt.isValidBroadcast(a,[o,l]))throw Error("gemm: invalid bias shape for broadcast");return[o,l,s]}},ft=class e{static tensorDataTypeFromProto(e){switch(e){case We.onnx.TensorProto.DataType.INT8:return"int8";case We.onnx.TensorProto.DataType.UINT8:return"uint8";case We.onnx.TensorProto.DataType.BOOL:return"bool";case We.onnx.TensorProto.DataType.INT16:return"int16";case We.onnx.TensorProto.DataType.UINT16:return"uint16";case We.onnx.TensorProto.DataType.INT32:return"int32";case We.onnx.TensorProto.DataType.UINT32:return"uint32";case We.onnx.TensorProto.DataType.FLOAT:return"float32";case We.onnx.TensorProto.DataType.DOUBLE:return"float64";case We.onnx.TensorProto.DataType.STRING:return"string";case We.onnx.TensorProto.DataType.INT64:return"int32";case We.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw Error(`unsupported data type: ${We.onnx.TensorProto.DataType[e]}`)}}static tensorDataTypeStringToEnum(e){switch(e){case"int8":return We.onnx.TensorProto.DataType.INT8;case"uint8":return We.onnx.TensorProto.DataType.UINT8;case"bool":return We.onnx.TensorProto.DataType.BOOL;case"int16":return We.onnx.TensorProto.DataType.INT16;case"uint16":return We.onnx.TensorProto.DataType.UINT16;case"int32":return We.onnx.TensorProto.DataType.INT32;case"uint32":return We.onnx.TensorProto.DataType.UINT32;case"float32":return We.onnx.TensorProto.DataType.FLOAT;case"float64":return We.onnx.TensorProto.DataType.DOUBLE;case"string":return We.onnx.TensorProto.DataType.STRING;case"int64":return We.onnx.TensorProto.DataType.INT64;case"uint64":return We.onnx.TensorProto.DataType.UINT64;default:throw Error(`unsupported data type: ${e}`)}}static tensorDimsFromProto(e){return e.map(e=>dr.isLong(e)?e.toNumber():e)}static tensorValueTypeFromProto(t){return{tensorType:e.tensorDataTypeFromProto(t.elemType),shape:{dims:e.tensorDimsFromProto(t.shape.dim.map(e=>e.dimValue))}}}static tensorDimsFromORTFormat(e){let t=[];for(let n=0;n<e.dimsLength();n++)t.push(xt.longToNumber(e.dims(n)));return t}static tensorAttributesFromORTFormat(e){let t=[];for(let n=0;n<e.attributesLength();n++)t.push(e.attributes(n));return t}},xt=class{static longToNumber(e){return dr.isLong(e)?e.toNumber():"bigint"==typeof e?Number(e):e}static isLong(e){return dr.isLong(e)||"bigint"==typeof e}},ne=class e{static size(t){return e.getSizeFromDimensionRange(t,0,t.length)}static sizeFromDimension(t,n){if(n<0||n>t.length)throw Error(`invalid dimension of ${n} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,n,t.length)}static sizeToDimension(t,n){if(n<0||n>t.length)throw Error(`invalid dimension of ${n} for sizeToDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,0,n)}static getSizeFromDimensionRange(e,t,n){let i=1;for(let a=t;a<n;a++){if(e[a]<=0)throw Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");i*=e[a]}return i}static computeStrides(e){let t=e.length;if(0===t)return[];if(1===t)return[1];let n=Array(t);n[t-1]=1,n[t-2]=e[t-1];for(let i=t-3;i>=0;--i)n[i]=n[i+1]*e[i+1];return n}static transpose(e){return e.slice().reverse()}static indicesToOffset(e,t,n){void 0===n&&(n=e.length);let i=0;for(let a=0;a<n;++a)i+=t[a]*e[a];return i}static offsetToIndices(e,t){let n=t.length;if(0===n)return[];if(1===n)return[e*t[0]];let i=Array(t.length);for(let n=0;n<i.length-1;++n)i[n]=Math.floor(e/t[n]),e-=i[n]*t[n];return i[i.length-1]=e,i}static normalizeAxis(e,t){if(e<-t&&e>=t)throw Error("unsupported axis for this operation.");return e<0?e+t:e}static normalizeAxes(e,t){return e.map(e=>this.normalizeAxis(e,t))}static incrementIndex(e,t,n){if(0===t.length||0===e.length)throw Error("Index incrementing unsupported for scalar Tensor");if(void 0===n)n=t.length;else if(n<=0||n>t.length)throw Error("Incorrect axis to increment on");for(let i=n-1;i>=0&&(e[i]++,!(e[i]<t[i]));--i)e[i]=0}static calculateReshapedDims(t,n){if(0===n.length){if(0===t.length||1===e.size(t))return[];throw Error("cannot reshape to a scalar Tensor")}let i=n.length,a=Array(i),o=-1,s=1;for(let e=0;e<i;e++){if(n[e]<-1)throw Error("a dimension in shape hints cannot be less than -1");if(-1===n[e]){if(-1!==o)throw Error("at most one dimension in shape hints can be -1");o=e}else{if(0===n[e]){if(e>=t.length)throw Error("the dimension with value zero exceeds the dimension size of the input tensor");a[e]=t[e]}else a[e]=n[e];s*=a[e]}}let l=e.size(t);if(-1!==o){if(l%s!=0)throw Error(`the input tensor cannot be reshaped to the requested shape. Input shape: [${t}] Output shape: [${n}]`);a[o]=l/s}else if(s!==l)throw Error("reshapedDims and originalDims don't have matching sizes");return a}static sortBasedOnPerm(e,t){return t?t.map(t=>e[t]):e.slice().reverse()}static padShape(e,t){let n=e.length;return e.map((e,i)=>e+t[i]+t[i+n])}static areEqual(e,t){return e.length===t.length&&e.every((e,n)=>e===t[n])}static validateDimsAndCalcSize(e){if(e.length>6)throw TypeError("Only rank 0 to 6 is supported for tensor shape.");let t=1;for(let n of e){if(!Number.isInteger(n))throw TypeError(`Invalid shape: ${n} is not an integer`);if(n<0||n>0x7fffffff)throw TypeError(`Invalid shape: length ${n} is not allowed`);t*=n}return t}static flattenShape(e,t){t<0&&(t+=e.length);let n=e.reduce((e,t)=>e*t,1),i=e.slice(t).reduce((e,t)=>e*t,1);return[n/i,i]}static squeezeShape(t,n){let i=[];n=e.normalizeAxes(n,t.length);for(let e=0;e<t.length;e++){let a=n.indexOf(e)>=0;if(a&&1!==t[e])throw Error("squeeze an axis of size different than 1");(0===n.length&&t[e]>1||n.length>0&&!a)&&i.push(t[e])}return i}static unsqueezeShape(t,n){let i=Array(t.length+n.length);i.fill(0);for(let t=0;t<n.length;t++){let a=e.normalizeAxis(n[t],i.length);if(a>=i.length)throw Error("'axes' has an out of range axis");if(0!==i[a])throw Error("'axes' has a duplicate axis");i[a]=1}let a=0;for(let e=0;e<i.length;e++)0===i[e]&&(i[e]=t[a++]);if(a!==t.length)throw Error("the unsqueezed dimension could not be established");return i}},Eo=class e{static splitShape(t,n,i,a){if(0===i.length){if(!a)throw Error("need to know number of outputs when the 'split' attribute is not specified");e.determineSplit(t[n],a,i)}let o=[],s=[0];for(let e=0;e<i.length;++e){0!==e&&s.push(s[e-1]+i[e-1]);let a=t.slice();a[n]=i[e],o.push(a)}return[o,s]}static determineSplit(e,t,n){if(e%t!=0)throw Error("cannot split tensor to equal sized parts");for(let i=0;i<t;++i)n.push(e/t)}},Nr=class e{static adjustPoolAttributes(e,t,n,i,a,o){if(!e&&n.length!==t.length-2)throw Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(let e=0;e<t.length-2;e++)e>=n.length?n.push(t[e+2]):n[e]=t[e+2];for(let e=0;e<n.length;e++)if(e<i.length){if(i[e]<0)throw Error("strides should be greater than or equal to 1")}else i.push(1);for(let e=0;e<n.length;e++)if(e<a.length){if(a[e]<0)throw Error("dilations should be greater than or equal to 1")}else a.push(1);for(let e=0;e<2*n.length;e++)if(e<o.length){if(o[e]<0)throw Error("pad should be greater than or equal to 1")}else o.push(0);for(let e=0;e<n.length;e++){if(n[e]<=0)throw Error("kernel shapes need to be greater than 0");if(o[e]>=n[e]||o[e+n.length]>=n[e])throw Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,n,i,a,o,s){if(s){if(o.length!==2*(t.length-2))throw Error("length of pads should be twice the length of data dimensions");if(n.length!==t.length-2)throw Error("length of strides should be the length of data dimensions");if(a.length!==t.length-2)throw Error("length of kernel shapes should be the length of data dimensions");for(let l=0;l<t.length-2;l++)e.adjustPadAndReturnShape(t[l+2],n[l],i[l],a[l],o,l,l+t.length-2,s)}}static computePoolOutputShape(t,n,i,a,o,s,l){if(n.length<=0)throw Error("input shape must be of size greater than 0");let u=[n[0],n[1]];return e.computeShapeHelper(t,n,u,i,a,o,s,l),u}static computeConvOutputShape(t,n,i,a,o,s,l){if(t.length<=0||n.length<=0)throw Error("invalid input tensor dims or invalid filter tensor dims");let u=[t[0],n[0]];return e.computeShapeHelper(!1,t,u,i,a,o,s,l),u}static computeShapeHelper(t,n,i,a,o,s,l,u){if(t)for(let e=0;e<n.length-2;e++)i.push(1);else for(let t=0;t<n.length-2;t++)i.push(e.adjustPadAndReturnShape(n[t+2],a[t],o[t],s[t],l,t,t+n.length-2,u))}static adjustPadAndReturnShape(e,t,n,i,a,o,s,l){let u=n*(i-1)+1;if(!l||"NOTSET"===l)return Math.floor((e+a[o]+a[s]-u)/t+1);switch(l){case"VALID":return a[o]=0,a[s]=0,Math.floor((e-u)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(1!==n)throw Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let n=((e+t-1)/t-1)*t+i-e;return a[o]=Math.floor("SAME_LOWER"===l?(n+1)/2:n/2),a[s]=n-a[o],Math.floor((e+n-i)/t+1)}default:throw Error("Unsupported AutoPad type")}}},Lr=-34028234663852886e22,Rr=34028234663852886e22});function vS(e){switch(e){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw Error(`cannot calculate sizeof() on type ${e}`)}}function _h(e){switch(e){case Ie.onnx.TensorProto.DataType.UINT8:case Ie.onnx.TensorProto.DataType.INT8:case Ie.onnx.TensorProto.DataType.BOOL:return 1;case Ie.onnx.TensorProto.DataType.UINT16:case Ie.onnx.TensorProto.DataType.INT16:return 2;case Ie.onnx.TensorProto.DataType.FLOAT:case Ie.onnx.TensorProto.DataType.INT32:case Ie.onnx.TensorProto.DataType.UINT32:return 4;case Ie.onnx.TensorProto.DataType.INT64:case Ie.onnx.TensorProto.DataType.DOUBLE:case Ie.onnx.TensorProto.DataType.UINT64:return 8;default:throw Error(`cannot calculate sizeof() on type ${Ie.onnx.TensorProto.DataType[e]}`)}}function wS(e,t){return new(xh(t))(e)}function xh(e){switch(e){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw Error("unspecified error")}}function _l(e,t){if(t===Ie.onnx.TensorProto.DataType.INT64||t===So.TensorDataType.INT64){if(e.greaterThanOrEqual(0x80000000)||e.lessThan(-0x80000000))throw TypeError("int64 is not supported")}else if(t===Ie.onnx.TensorProto.DataType.UINT32||t===So.TensorDataType.UINT32||t===Ie.onnx.TensorProto.DataType.UINT64||t===So.TensorDataType.UINT64){if(e.greaterThanOrEqual(0x100000000)||e.lessThan(0))throw TypeError("uint64 is not supported")}else throw TypeError(`not a LONG type: ${Ie.onnx.TensorProto.DataType[t]}`);return e.toNumber()}function vh(e,t,n){switch(t){case Ie.onnx.TensorProto.DataType.BOOL:case Ie.onnx.TensorProto.DataType.UINT8:return e.getUint8(n);case Ie.onnx.TensorProto.DataType.INT8:return e.getInt8(n);case Ie.onnx.TensorProto.DataType.UINT16:return e.getUint16(n,!0);case Ie.onnx.TensorProto.DataType.INT16:return e.getInt16(n,!0);case Ie.onnx.TensorProto.DataType.FLOAT:return e.getFloat32(n,!0);case Ie.onnx.TensorProto.DataType.INT32:return e.getInt32(n,!0);case Ie.onnx.TensorProto.DataType.UINT32:return e.getUint32(n,!0);case Ie.onnx.TensorProto.DataType.INT64:return _l(dr.fromBits(e.getUint32(n,!0),e.getUint32(n+4,!0),!1),t);case Ie.onnx.TensorProto.DataType.DOUBLE:return e.getFloat64(n,!0);case Ie.onnx.TensorProto.DataType.UINT64:return _l(dr.fromBits(e.getUint32(n,!0),e.getUint32(n+4,!0),!0),t);default:throw Error(`cannot read from DataView for type ${Ie.onnx.TensorProto.DataType[t]}`)}}var wh,Ie,nt,zr=k(()=>{wh=ve(zp()),Fs(),$o(),Ie=ve(to()),Me(),nt=class e{constructor(e,t,n,i,a,o=wh.Guid.create()){this.dims=e,this.type=t,this.dataProvider=n,this.asyncDataProvider=i,this.cache=a,this.dataId=o,this.size=ne.validateDimsAndCalcSize(e);let s=this.size,l=void 0===n&&void 0===i&&void 0===a;if(void 0!==a&&a.length!==s)throw RangeError("Input dims doesn't match data length.");if("string"===t){if(void 0!==a&&(!Array.isArray(a)||!a.every(e=>"string"==typeof e)))throw TypeError("cache should be a string array");l&&(this.cache=Array(s))}else{if(void 0!==a){let e=xh(t);if(!(a instanceof e))throw TypeError(`cache should be type ${e.name}`)}if(l){let e=new ArrayBuffer(s*vS(t));this.cache=wS(e,t)}}}get data(){if(void 0===this.cache){let e=this.dataProvider(this.dataId);if(e.length!==this.size)throw Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=e}return this.cache}get stringData(){if("string"!==this.type)throw TypeError("data type is not string");return this.data}get integerData(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}get floatData(){switch(this.type){case"float32":case"float64":return this.data;default:throw TypeError("data type is not float (float32, float64)")}}get numberData(){if("string"!==this.type)return this.data;throw TypeError("type cannot be non-number (string)")}get(e){return this.data[ne.indicesToOffset(e,this.strides)]}set(e,t){this.data[ne.indicesToOffset(e,this.strides)]=t}async getData(){return void 0===this.cache&&(this.cache=await this.asyncDataProvider(this.dataId)),this.cache}get strides(){return this._strides||(this._strides=ne.computeStrides(this.dims)),this._strides}static fromProto(t){if(!t)throw Error("cannot construct Value from an empty tensor");let n=ft.tensorDataTypeFromProto(t.dataType),i=new e(ft.tensorDimsFromProto(t.dims),n);if("string"===n)t.stringData.forEach((e,t)=>{i.data[t]=Co(e)});else if(t.rawData&&"number"==typeof t.rawData.byteLength&&t.rawData.byteLength>0){let e=i.data,n=new DataView(t.rawData.buffer,t.rawData.byteOffset,t.rawData.byteLength),a=_h(t.dataType),o=t.rawData.byteLength/a;if(t.rawData.byteLength%a!=0)throw Error("invalid buffer length");if(e.length!==o)throw Error("buffer length mismatch");for(let i=0;i<o;i++){let o=vh(n,t.dataType,i*a);e[i]=o}}else{let e;switch(t.dataType){case Ie.onnx.TensorProto.DataType.FLOAT:e=t.floatData;break;case Ie.onnx.TensorProto.DataType.INT32:case Ie.onnx.TensorProto.DataType.INT16:case Ie.onnx.TensorProto.DataType.UINT16:case Ie.onnx.TensorProto.DataType.INT8:case Ie.onnx.TensorProto.DataType.UINT8:case Ie.onnx.TensorProto.DataType.BOOL:e=t.int32Data;break;case Ie.onnx.TensorProto.DataType.INT64:e=t.int64Data;break;case Ie.onnx.TensorProto.DataType.DOUBLE:e=t.doubleData;break;case Ie.onnx.TensorProto.DataType.UINT32:case Ie.onnx.TensorProto.DataType.UINT64:e=t.uint64Data;break;default:throw Error("unspecific error")}if(null==e)throw Error("failed to populate data from a tensorproto value");let n=i.data;if(n.length!==e.length)throw Error("array length mismatch");for(let i=0;i<e.length;i++){let a=e[i];dr.isLong(a)?n[i]=_l(a,t.dataType):n[i]=a}}return i}static fromData(t,n,i){return new e(n,i,void 0,void 0,t)}static fromOrtTensor(t){if(!t)throw Error("cannot construct Value from an empty tensor");let n=ft.tensorDimsFromORTFormat(t),i=ft.tensorDataTypeFromProto(t.dataType()),a=new e(n,i);if("string"===i)for(let e=0;e<t.stringDataLength();e++)a.data[e]=t.stringData(e);else if(t.rawDataArray()&&"number"==typeof t.rawDataLength()&&t.rawDataLength()>0){let e=a.data,n=new DataView(t.rawDataArray().buffer,t.rawDataArray().byteOffset,t.rawDataLength()),i=_h(t.dataType()),o=t.rawDataLength()/i;if(t.rawDataLength()%i!=0)throw Error("invalid buffer length");if(e.length!==o)throw Error("buffer length mismatch");for(let a=0;a<o;a++){let o=vh(n,t.dataType(),a*i);e[a]=o}}return a}}});function ue(e){return 1===e?xS:TS}function Th(e){let t=ue(e);return`${t.version}
      precision highp float;
      ${t.attribute} vec3 position;
      ${t.attribute} vec2 textureCoord;

      ${t.varyingVertex} vec2 TexCoords;

      void main()
      {
          gl_Position = vec4(position, 1.0);
          TexCoords = textureCoord;
      }`}function Ih(e){let t=ue(e);return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFrag} vec2 TexCoords;
    ${t.outputDeclaration}
    const vec2 halfCR = vec2(0.5, 0.5);

    // Custom vector types to handle higher dimenalities.
    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    `}function Sh(e,t){let n=ue(e);return`
  void main() {
    int indices[${t}];
    toVec(TexCoords, indices);
    vec4 result = vec4(process(indices));
    ${n.output} = result;
  }
  `}var xS,TS,Ke=k(()=>{xS={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},TS={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"}}),Ae=k(()=>{});async function vl(e,t=e=>0,n){return new Promise((i,a)=>{let o=0,s=()=>{if(e())return void i();let l=t(++o);null!=n&&o>=n?a():setTimeout(s,l)};s()})}function Ri(e){return no("u">typeof e&&0!==e.length,()=>"empty string found for sampler name"),"get"+e.charAt(0).toUpperCase()+e.slice(1)}function $h(e){return no("u">typeof e&&0!==e.length,()=>"empty string found for sampler name"),"get"+e.charAt(0).toUpperCase()+e.slice(1)+"AtOutCoords"}function ro(e,t){return JSON.parse(JSON.stringify(e)),t}function oo(e,t){return t.map(t=>e[t]).join(", ")}function bt(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function qt(e=6){return["x","y","z","w","u","v"].slice(0,e)}var Nn=k(()=>{Me()});function IS(e,t){return qt(t).map(t=>`${e}.${t}`)}function io(e,t){return 1===t?[e]:IS(e,t)}function Ln(){return`
    float getChannel(vec4 frag, int dim) {
      int modCoord = imod(dim, 2);
      return modCoord == 0 ? frag.r : frag.g;
    }

    float getChannel(vec4 frag, vec2 innerDims) {
      vec2 modCoord = mod(innerDims, 2.);
      return modCoord.x == 0. ?
        (modCoord.y == 0. ? frag.r : frag.g) :
        (modCoord.y == 0. ? frag.b : frag.a);
    }
  `}var Mr=k(()=>{Nn()});function $S(e,t,n){if(0===e)return"false";if(1===e)return`rc > ${t[0]}`;let i="";for(let a=e-2;a<e;a++)i+=`${n[a]} >= ${t[a-e+2]}`,a<e-1&&(i+="||");return i}function AS(e,t){let n=e.length;if(0===n)return"getA(), 0, 0, 0";if(1===n)return`getA(rc),
            rc + 1 >= ${e[0]} ? 0. : getA(rc + 1),
            0, 0`;let i="r, c",a="r, cp1",o="rp1, c",s="rp1, cp1",l="";if(n>2)for(let e=0;e<n-2;++e)l+=`${t[e]},`;return`getA(${l}${i}),
          rEdge ? 0. : getA(${l}${o}),
          cEdge ? 0. : getA(${l}${a}),
          rEdge || cEdge ? 0. : getA(${l}${s})`}function OS(e,t,n,i){return 0===e||1===e?"":`
    int r = ${t[e-2]};
    int c = ${t[e-1]};
    int rp1 = ${t[e-2]} + 1;
    int cp1 = ${t[e-1]} + 1;
    bool rEdge = rp1 >= ${i};
    bool cEdge = cp1 >= ${n};
    `}var Ah,SS,Oh,Ph=k(()=>{Ke(),Ae(),Nn(),Mr(),Ah={name:"pack",inputNames:["A"],inputTypes:[1]},SS=(e,t)=>{let n=ue(e.session.backend.glContext.version),i=t.dims,a=i.length,o=t.dims.length,s=bt(o),l=io("rc",o),u=OS(o,l,i[i.length-2],i[i.length-1]),c;c=0===a?[1,1]:1===a?[i[0],1]:[i[o-1],i[o-2]];let d=$S(o,c,l),p=AS(i,l),h=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${d}) {
            ${n.output} = vec4(0);
          } else {
            ${u}

            ${n.output} = vec4(${p});
          }
        }
      `;return{...Ah,hasMain:!0,output:{dims:t.dims,type:t.type,textureType:2},shaderSource:h}},Oh=(e,t)=>({...Ah,get:()=>SS(e,t)})});function wl(e){if(0===e.length)return[1,1,1];let t=1;for(let n=0;n<e.length-2;++n)t*=e[n];return[t,e.length>1?e[e.length-2]:1,e[e.length-1]]}function Ch(e,t){return 0===e.length||0===t.length||(e.length<2||t.length<2?e[e.length-1]===t[t.length-1]:e[e.length-1]===t[t.length-1]&&e[e.length-2]===t[t.length-2])}function CS(e){let t=ne.computeStrides(e),n=["b","r","c"],i="index";return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t.map((e,a)=>{let o=`int ${n[a]} = ${i} / ${e}`,s=a===t.length-1?`int ${n[a+1]} = ${i} - ${n[a]} * ${e}`:`index -= ${n[a]} * ${e}`;return`${o}; ${s};`}).join("")}
      return ivec3(b, r, c);
    }
  `}function DS(e){let t=ne.computeStrides(e);return`
  int getFlattenedIndex(ivec3 coords) {
    // reverse y, z order
    return coords.x * ${t[0]} + coords.z * ${t[1]} + coords.y;
  }
`}var PS,ES,Eh,xl,Dh=k(()=>{Me(),Ke(),Ae(),Mr(),PS=e=>({name:"Reshape (packed)",inputTypes:[2],inputNames:["A"],cacheHint:`${e}`}),ES=(e,t,n,i)=>{let a=t.dims,o=i,s="";for(let e=0;e<4;e++){let t="";switch(e){case 0:t="outputCoords = rc;";break;case 1:t="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:t="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:t="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw Error()}s+=`
        ${t}
        ${e>0?"if(outputCoords.y < rows && outputCoords.z < cols){":""}
          int flattenedIndex = getFlattenedIndex(outputCoords);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);
          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${e}] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);

        ${e>0?"}":""}
      `}let l=ue(e.session.backend.glContext.version),u=`
      ${CS(a)}
      ${DS(o)}
      ${Ln()}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.0);

        ivec3 outputCoords;
        int rows = ${o[2]};
        int cols = ${o[1]};

        ${s}
        ${l.output} = result;
      }
    `;return{...n,output:{dims:o,type:t.type,textureType:2},shaderSource:u,hasMain:!0}},Eh=(e,t,n)=>{let i=PS(n);return{...i,get:()=>ES(e,t,i,n)}}}),kh=k(()=>{Ke(),Ae(),xl=(e,t)=>{let n=t.shape,i=ue(e.session.backend.glContext.version),a=`
    const float FLOAT_MAX = 1.70141184e38;
    const float FLOAT_MIN = 1.17549435e-38;

    bool isNaN(float val) {
      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;
    }

    highp vec4 encodeAsUint8(highp float v) {
      if (isNaN(v)) {
        return vec4(255, 255, 255, 255);
      }

      highp float av = abs(v);

      if(av < FLOAT_MIN) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      } else if(v > FLOAT_MAX) {
        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
      } else if(v < -FLOAT_MAX) {
        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
      }

      highp vec4 c = vec4(0,0,0,0);

      highp float e = floor(log2(av));
      highp float m = exp2(fract(log2(av))) - 1.0;

      c[2] = floor(128.0 * m);
      m -= c[2] / 128.0;
      c[1] = floor(32768.0 * m);
      m -= c[1] / 32768.0;
      c[0] = floor(8388608.0 * m);

      highp float ebias = e + 127.0;
      c[3] = floor(ebias / 2.0);
      ebias -= c[3] * 2.0;
      c[2] += floor(ebias) * 128.0;

      c[3] += 128.0 * step(0.0, -v);

      return c / 255.0;
    }

    void main() {
      float value = ${i.texture2D}(X,TexCoords).r;
      ${i.output} = encodeAsUint8(value);
    }`,o={name:"Uint8Encode",inputTypes:[0],inputNames:["X"],output:{dims:n,type:t.tensor.type,textureType:3},shaderSource:a,hasMain:!0};return e.executeProgram(o,[t.tensor])}});function NS(e,t){if(1===e)return"rc";let n="";for(let i=0;i<e;i++)n+=t[i],i<e-1&&(n+=",");return n}var Nh,kS,Lh,zi,Do,Mi,No,zh,Tl,RS,Bi,Il,xe,Vh,Gh,Uh,zS,MS,Fi,zt,Y,Lo,Vi,Rh=k(()=>{Ke(),Ae(),Nn(),Mr(),Nh={name:"unpack",inputNames:["A"],inputTypes:[2]},kS=(e,t)=>{let n=t.dims.length,i=io("rc",n),a=i.slice(-2),o=bt(n),s=Ln(),l=0===t.dims.length?"":NS(n,i),u=n<=1?"rc":`vec2(${a.join(",")})`,c=ue(e.session.backend.glContext.version),d=`
    ${s}
    void main() {
      ${o} rc = getOutputCoords();

       // Sample the texture with the coords to get the rgba channel value.
       vec4 packedInput = getA(${l});

       ${c.output} = vec4(getChannel(packedInput, ${u}), 0, 0, 0);
     }
   `;return{...Nh,hasMain:!0,output:{dims:t.dims,type:t.type,textureType:0},shaderSource:d}},Lh=(e,t)=>({...Nh,get:()=>kS(e,t)})}),ko=k(()=>{Ct(),zi=class{constructor(e,t=1){if(1===t)this.internalFormat=e.R32F,this.format=e.RED,this.textureType=e.FLOAT,this.channelSize=t;else if(4===t)this.internalFormat=e.RGBA32F,this.format=e.RGBA,this.textureType=e.FLOAT,this.channelSize=t;else throw Error(`Invalid number of channels: ${t}`)}encode(e,t){let n,i;return e.constructor!==Float32Array&&(Fe.warning("Encoder","data was not of type Float32; creating new Float32Array"),i=new Float32Array(e)),t*this.channelSize>e.length?(Fe.warning("Encoder","Source data too small. Allocating larger array"),i=e,n=this.allocate(t*this.channelSize),i.forEach((e,t)=>n[t]=e)):n=i=e,n}allocate(e){return new Float32Array(4*e)}decode(e,t){return 1===this.channelSize?e.filter((e,t)=>t%4==0).subarray(0,t):e.subarray(0,t)}},Do=class{constructor(e,t=1,n){if(1!==t&&4!==t)throw Error(`Invalid number of channels: ${t}`);this.internalFormat=e.RGBA,this.format=e.RGBA,this.channelSize=t,this.textureType=n||e.FLOAT}encode(e,t){let n=e;return 1===this.channelSize&&(Fe.verbose("Encoder","Exploding into a larger array"),n=this.allocate(t),e.forEach((e,t)=>n[4*t]=e)),n}allocate(e){return new Float32Array(4*e)}decode(e,t){return 1===this.channelSize?e.filter((e,t)=>t%4==0).subarray(0,t):e.subarray(0,t)}},Mi=class{constructor(e,t=1){if(this.channelSize=4,1===t)this.internalFormat=e.ALPHA,this.format=e.ALPHA,this.textureType=e.UNSIGNED_BYTE,this.channelSize=t;else if(4===t)this.internalFormat=e.RGBA,this.format=e.RGBA,this.textureType=e.UNSIGNED_BYTE,this.channelSize=t;else throw Error(`Invalid number of channels: ${t}`)}encode(e,t){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}allocate(e){return new Uint8Array(e*this.channelSize)}decode(e,t){if(e instanceof Uint8Array)return e.subarray(0,t);throw Error(`Invalid array type: ${e.constructor}`)}}}),Mh=k(()=>{Me(),Ae(),No=(e,t,n)=>{let i=0===n||1===n?1:4,a=2===n,o=1===n||2===n,s=4===n?t.length-1:void 0,l=4===n?t.map((e,n)=>n===t.length-1?4*e:e):void 0;return Tl(e,t,i,l,{isPacked:a,reverseWH:o,breakAxis:s})},zh=(e,t,n)=>{let i=No(e,t,n);return[i.width,i.height]},Tl=(e,t,n=1,i,a)=>{let o=!!(a&&a.isPacked),[s,l]=e.computeTextureWH(o&&i||t,a),u=t.length,c=t.slice(0);if(0===u&&(c=[1]),1===n)i=t;else if(o){if(4!==n)throw Error("a packed texture must be 4-channel");i=t,u>0&&(c[u-1]=Math.ceil(c[u-1]/2)),u>1&&(c[u-2]=Math.ceil(c[u-2]/2))}else if(!i)throw Error("Unpacked shape is needed when using channels > 1");return{width:s,height:l,channels:n,isPacked:o,shape:c,strides:ne.computeStrides(c),unpackedShape:i,reversedWH:a&&a.reverseWH}}}),Fh=k(()=>{Ct(),zr(),Me(),Ph(),Dh(),kh(),Rh(),ko(),Mh(),Ae(),RS=(e,t)=>{let n=t.map(e=>`${e.unpackedShape.join(",")};${e.width}x${e.height}`).join("_"),i=e.name;return e.cacheHint&&(i+="["+e.cacheHint+"]"),i+=":"+n},Bi=class{constructor(e){this.session=e,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}calculateTextureWidthAndHeight(e,t){return zh(this.session.layoutStrategy,e,t)}executeProgram(e,t){if(t.length<e.inputNames.length)throw Error(`Input size mustn't be less than ${e.inputNames.length}.`);if(e.inputNames.length!==e.inputTypes.length)throw Error("input names size does not match input types");let n=[];for(let i=0;i<e.inputNames.length;++i)n[i]=this.getOrCreateTextureData(t[i],e.inputTypes[i]);let i=RS(e,n),a=this.session.programManager.getArtifact(i),o=a?a.programInfo:"function"==typeof e.get?e.get():e,s=No(this.session.layoutStrategy,o.output.dims,o.output.textureType),l=this.createTextureData(s,o.output.type);return a||(a=this.session.programManager.build(o,n,l),this.session.programManager.setArtifact(i,a)),this.runProgram(a,n,l),l}run(e,t){return this.executeProgram(e,t).tensor}runProgram(e,t,n){for(let n=0;n<t.length;++n)if(!!t[n].isPacked!=(2===e.programInfo.inputTypes[n]))throw Error(`input[${n}] property packed inconsistent`);if(!!n.isPacked!=(2===e.programInfo.output.textureType))throw Error("output property packed inconsistent");this.session.programManager.run(e,t,n)}getOrCreateTextureData(e,t){let n=this.getTextureData(e.dataId,2===t);if(!n&&(n=this.getTextureData(e.dataId,2!==t)))return 2===t?this.pack(n):this.unpack(n);if(!n){let i=No(this.session.layoutStrategy,e.dims,t);if(4===t){let n=e.dims;if(4===n.length){let i=[n[0],Math.ceil(n[1]*n[2]*n[3]/4)],a=No(this.session.layoutStrategy,i,t),o=e.numberData;if(n[1]*n[2]*n[3]%4!=0){let t=n[0],i=n[1]*n[2]*n[3],a=4*Math.ceil(i/4);o=new Float32Array(t*a);for(let n=0;n<t;++n){let t=n*i,s=n*a+n%1*i;o.set(e.numberData.subarray(t,t+i),s)}}return this.createTextureData(a,e.type,o,e,1)}}if(2===t){let t=Tl(this.session.layoutStrategy,e.dims,1,[],{reverseWH:!0}),i=this.createTextureData(t,e.type,e.numberData,e,1);n=this.pack(i)}else n=this.createTextureData(i,e.type,e.numberData,e,1)}return n}createTextureDataFromLayoutBindTensor(e,t,n,i){return this.createTextureData(e,t,n,i,1)}createTextureData(e,t,n,i,a){Fe.verbose("InferenceHandler",`Creating TextureData: layout:[${JSON.stringify(e)}]`);let o=this.session.textureManager.createTextureFromLayout(t,e,n,a);return this.createTextureDataFromTexture(e,t,o,i)}reshapeUnpacked(e,t){let n=this.getOrCreateTextureData(e,0),i={channels:n.channels,height:n.height,width:n.width,shape:0!==t.length?t:[1],strides:ne.computeStrides(t),unpackedShape:t};return this.createTextureDataFromTexture(i,e.type,n.texture).tensor}reshapePacked(e,t){let n=this.getOrCreateTextureData(e,2);if(Ch(e.dims,t)){let i={channels:n.channels,height:n.height,width:n.width,shape:0!==t.length?t:[1],strides:ne.computeStrides(t),unpackedShape:t,isPacked:!0};return this.createTextureDataFromTexture(i,e.type,n.texture).tensor}let i=wl(e.dims),a=wl(t),o=this.reshapePacked(e,i),s=this.run(Eh(this,o,a),[o]);return this.reshapePacked(s,t)}cast(e,t){let n=this.getOrCreateTextureData(e,0);return this.createTextureDataFromTexture(n,t,n.texture).tensor}createTextureDataFromTexture(e,t,n,i,a){let o={...e,tensor:i||new nt(e.unpackedShape,t,e=>this.readTexture(o),async e=>this.readTextureAsync(o),void 0,a),texture:n};return this.setTextureData(o.tensor.dataId,o,e.isPacked),o}getTextureData(e,t=!1){return this.session.isInitializer(e)?this.session.getTextureData(e,t):t?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}setTextureData(e,t,n=!1){this.session.isInitializer(e)?this.session.setTextureData(e,t,n):(n?this.packedTextureDataCache:this.unpackedTextureDataCache).set(e,t)}isTextureLayoutCached(e,t=!1){return!!this.getTextureData(e.dataId,t)}dispose(){this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(e=>this.session.textureManager.releaseTexture(e)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(e=>this.session.textureManager.releaseTexture(e)),this.unpackedTextureDataCache=new Map}readTexture(e){return e.isPacked?this.readTexture(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat(xl(this,e))}async readTextureAsync(e){return e.isPacked?this.readTextureAsync(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat(xl(this,e))}pack(e){return this.executeProgram(Oh(this,e.tensor),[e.tensor])}unpack(e){return this.executeProgram(Lh(this,e.tensor),[e.tensor])}}}),lt=k(()=>{Il=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(e=>`${this[e]}`).join(";")),this.key}},xe=e=>new Il(e)}),Wh=k(()=>{lt(),Ke(),Ae(),Vh={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[0,0,0,0,0]},Gh=(e,t,n)=>(MS(t),[e.run({...Vh,cacheHint:n.cacheKey,get:()=>zS(e,t,n)},t)]),Uh=e=>{let t=e.attributes.getFloat("epsilon",1e-5),n=e.attributes.getFloat("momentum",.9),i=e.attributes.getInt("spatial",1);return xe({epsilon:t,momentum:n,spatial:i})},zS=(e,t,n)=>{let i=ue(e.session.backend.glContext.version),a=t[0].dims.length,[o,s]=e.calculateTextureWidthAndHeight(t[1].dims,0),l=`
  float process(int[${a}] indices) {
    vec2 position = offsetToCoords(indices[1], ${o}, ${s});
    float scale = getColorAsFloat(${i.texture2D}(Scale, position));
    float mean = getColorAsFloat(${i.texture2D}(Mean, position));
    float variance = getColorAsFloat(${i.texture2D}(Variance, position));
    float b = getColorAsFloat(${i.texture2D}(B, position));

    return scale * ( (_A(indices) - mean) / sqrt(variance + float(${n.epsilon})) ) + b;
  }`;return{...Vh,output:{dims:t[0].dims,type:t[0].type,textureType:0},shaderSource:l}},MS=e=>{if(!e||5!==e.length)throw Error("BatchNormalization requires 5 inputs.");let t=e[0],n=e[1],i=e[2],a=e[3],o=e[4];if(t.dims.length<3||1!==n.dims.length||1!==i.dims.length||1!==a.dims.length||1!==o.dims.length||n.dims[0]!==t.dims[1]||i.dims[0]!==t.dims[1]||a.dims[0]!==t.dims[1]||o.dims[0]!==t.dims[1])throw Error("invalid input shape.");if("float32"!==t.type&&"float64"!==t.type||"float32"!==n.type&&"float64"!==n.type||"float32"!==i.type&&"float64"!==i.type||"float32"!==a.type&&"float64"!==a.type||"float32"!==o.type&&"float64"!==o.type)throw Error("invalid input tensor types.")}}),Jn=k(()=>{Fi=class{constructor(e,t,n,i){this.glContext=e,this.programInfo=t,this.inputTextureLayouts=n,this.outputTextureLayout=i}},zt=class{constructor(e){this.context=e}},Y=class{constructor(e,t){this.routineBody=e,this.dependencies=t}},Lo=class{constructor(e,t,n){this.name=e,n?this.dependencies=n:this.dependencies=[],t&&(this.routineBody=t)}addDependency(e){e&&this.dependencies.push(e)}},Vi=class{static returnOrderedNodes(e){if(!e||0===e.length)return[];if(1===e.length)return e;let t=new Set,n=new Set,i=[];return this.createOrderedNodes(e,t,n,i),i}static createOrderedNodes(e,t,n,i){for(let a=0;a<e.length;++a)this.dfsTraverse(e[a],t,n,i)}static dfsTraverse(e,t,n,i){if(!e||n.has(e.name))return;if(t.has(e.name))throw Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");t.add(e.name);let a=e.dependencies;if(a&&a.length>0)for(let e=0;e<a.length;++e)this.dfsTraverse(a[e],t,n,i);i.push(e),n.add(e.name),t.delete(e.name)}}});function FS(){let e="add_";return{body:`
  float ${e}(float a, float b) {
    return a + b;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return v1 + v2;
  }
  `,name:e,type:0}}function VS(){let e="div_";return{body:`
  float ${e}(float a, float b) {
    return a / b;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return v1 / v2;
  }
  `,name:e,type:0}}function GS(){let e="mul_";return{body:`
  float ${e}(float a, float b) {
    return a * b;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return v1 * v2;
  }
  `,name:e,type:0}}function US(){let e="sub_";return{body:`
  float ${e}(float a, float b) {
    return a - b;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return v1 - v2;
  }
  `,name:e,type:0}}function WS(){let e="equal_";return{body:`
  float ${e}(float a, float b) {
    return float(a == b);
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return vec4(equal(v1, v2));
  }
  `,name:e,type:0}}function HS(){let e="greater_";return{body:`
  float ${e}(float a, float b) {
    return float(a > b);
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return vec4( v1.r > v2.r ,
      v1.g > v2.g,
      v1.b > v2.b,
      v1.a > v2.a );
  }
  `,name:e,type:0}}function jS(){let e="less_";return{body:`
  float ${e}(float a, float b) {
    return float(a < b);
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return vec4( v1.r < v2.r ,
                v1.g < v2.g,
                v1.b < v2.b,
                v1.a < v2.a );
  }
  `,name:e,type:0}}function qS(){let e="and_";return{body:`
  float ${e}(float a, float b) {
    return float( bool(a) && bool(b) );
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r && b2.r ,
                b1.g && b2.g,
                b1.b && b2.b,
                b1.a && b2.a );
  }
  `,name:e,type:0}}function KS(){let e="or_";return{body:`
  float ${e}(float a, float b) {
    return float( bool(a) || bool(b) );
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r || b2.r ,
                b1.g || b2.g,
                b1.b || b2.b,
                b1.a || b2.a );
  }
  `,name:e,type:0}}function XS(){let e="xor_";return{body:`
  float ${e}(float a, float b) {
    return float( bool(a) ^^ bool(b) );
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r ^^ b2.r ,
                b1.g ^^ b2.g,
                b1.b ^^ b2.b,
                b1.a ^^ b2.a );
  }
  `,name:e,type:0}}function ZS(){return YS("pow")}function JS(){let e="prelu_";return{body:`
  float ${e}(float a, float b) {
    return a < 0.0 ? a * b: a;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return vec4(
      v1.r < 0.0 ? v1.r * v2.r: v1.r,
      v1.g < 0.0 ? v1.g * v2.g: v1.g,
      v1.b < 0.0 ? v1.b * v2.b: v1.b,
      v1.a < 0.0 ? v1.a * v2.a: v1.a
      );
  }
  `,name:e,type:0}}function YS(e){let t=`${e}_`;return{body:`
  float ${t}(float a, float b) {
    return ${e}(a, b);
  }
  vec4 ${t}(vec4 v1, vec4 v2) {
    return ${e}(v1, v2);
  }
  `,name:t,type:0}}var Mt,QS,Hh,jh,qh,Kh,Xh,Zh,Jh,Yh,Qh,em,tm,nm,om,im,t$,n$,r$,sm,Gi,lm,o$,i$,a$,cm,s$,u$,l$,dm,c$,rm=k(()=>{Me(),Jn(),Ke(),Ae(),Mt=(e,t,n,i=t[0].type,a)=>{let o=2*!!e.session.pack;return{name:n.name,inputNames:["A","B"],inputTypes:[o,o],cacheHint:a,get:()=>QS(e,t,n,i)}},QS=(e,t,n,i=t[0].type)=>{let a=2*!!e.session.pack,o=!ne.areEqual(t[0].dims,t[1].dims),s=t[0].dims,l=e.session.pack;if(o){let o=gt.calcShape(t[0].dims,t[1].dims,!1);if(!o)throw Error("Can't perform binary op on the given tensors");let u=(s=o).length,c=0!==t[0].dims.length?t[0].dims.length:1,d=0!==t[1].dims.length?t[1].dims.length:1,p=0!==t[0].dims.length?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",h=0!==t[1].dims.length?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",f=ue(e.session.backend.glContext.version),g=l?`
      ${n.body}
      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();
        vec4 result = ${n.name}(a, b);
        ${f.output} = result;
      }`:`
      ${n.body}
      float process(int indices[${u}]) {
        int aindices[${c}];
        int bindices[${d}];
        ${p}
        ${h}
        return ${n.name}(_A(aindices), _B(bindices));
      }`;return{name:n.name,inputNames:["A","B"],inputTypes:[a,a],output:{dims:s,type:i,textureType:a},shaderSource:g,hasMain:l}}let u=ue(e.session.backend.glContext.version),c=`
    ${n.body}
    void main() {
      vec4 v1 = ${u.texture2D}(A, TexCoords);
      vec4 v2 = ${u.texture2D}(B, TexCoords);
      vec4 result = ${n.name}(v1, v2);
      ${u.output} = result;
    }
    `;return{name:n.name,inputNames:["A","B"],inputTypes:[a,a],output:{dims:t[0].dims,type:i,textureType:a},shaderSource:c,hasMain:!0}},Hh=(e,t)=>[e.run(Mt(e,t,FS()),t)],jh=(e,t)=>[e.run(Mt(e,t,qS(),"bool"),t)],qh=(e,t)=>[e.run(Mt(e,t,VS()),t)],Kh=(e,t)=>[e.run(Mt(e,t,WS(),"bool"),t)],Xh=(e,t)=>[e.run(Mt(e,t,HS(),"bool"),t)],Zh=(e,t)=>[e.run(Mt(e,t,jS(),"bool"),t)],Jh=(e,t)=>[e.run(Mt(e,t,GS()),t)],Yh=(e,t)=>[e.run(Mt(e,t,KS(),"bool"),t)],Qh=(e,t)=>[e.run(Mt(e,t,ZS()),t)],em=(e,t)=>[e.run(Mt(e,t,JS()),t)],tm=(e,t)=>[e.run(Mt(e,t,US()),t)],nm=(e,t)=>[e.run(Mt(e,t,XS(),"bool"),t)]}),am=k(()=>{Me(),om=(e,t,n)=>(t$(t),[e.cast(t[0],n)]),im=e=>ft.tensorDataTypeFromProto(e.attributes.getInt("to")),t$=e=>{if(!e||1!==e.length)throw Error("Cast requires 1 input.");if("string"===e[0].type)throw Error("Invalid input type.")}}),um=k(()=>{Ke(),Ae(),Nn(),Mr(),n$=(e,t)=>({name:"Concat (packed)",inputNames:Array.from({length:e},(e,t)=>`X${t}`),inputTypes:Array(e).fill(2),cacheHint:t}),r$=(e,t,n,i)=>{let a=n[0].dims.slice();if(i>=a.length||i<-1*a.length)throw Error("axis specified for concat doesn't match input dimensionality");i<0&&(i=a.length+i);let o=a.slice(0);for(let e=1;e<n.length;e++){let t=n[e].dims.slice();for(let e=0;e<a.length;e++)if(e===i)o[i]+=t[e];else if(a[e]!==t[e])throw Error("non concat dimensions must match")}let s=o.length,l=io("coords",s),u=bt(s),c=Ln(),d=n.map(e=>e.dims),p=qt(s),h=Array(d.length-1);h[0]=d[0][i];for(let e=1;e<h.length;e++)h[e]=h[e-1]+d[e][i];let f=p[i],g=p.slice(-2),m=p.join(),y=`if (${f} < ${h[0]}) {
        return getChannel(
            getX0(${m}), vec2(${g.join()}));
        }`;for(let e=1;e<h.length;e++){let t=h[e-1];y+=`
            if (${f} < ${h[e]}  && ${f} >= ${h[e-1]}) {
              return getChannel(
                getX${e}(${Gi(p,f,t)}),
                vec2(${Gi(g,f,t)}));
            }`}let b=h.length,v=h[h.length-1];y+=`
            return getChannel(
              getX${b}(${Gi(p,f,v)}),
              vec2(${Gi(g,f,v)}));`;let x=ue(e.session.backend.glContext.version),w=`
          ${c}
          float getValue(${p.map(e=>"int "+e)}) {
            ${y}
          }

          void main() {
            ${u} coords = getOutputCoords();
            int lastDim = coords.${p[s-1]};
            coords.${p[s-1]} = coords.${p[s-2]};
            coords.${p[s-2]} = lastDim;

            vec4 result = vec4(getValue(${l}), 0., 0., 0.);

            ${l[s-1]} = ${l[s-1]} + 1;
            if (${l[s-1]} < ${o[s-1]}) {
              result.g = getValue(${l});
            }

            ${l[s-2]} = ${l[s-2]} + 1;
            if (${l[s-2]} < ${o[s-2]}) {
              result.a = getValue(${l});
            }

            ${l[s-1]} = ${l[s-1]} - 1;
            if (${l[s-2]} < ${o[s-2]} &&
                ${l[s-1]} < ${o[s-1]}) {
              result.b = getValue(${l});
            }
            ${x.output} = result;
          }
        `;return{...t,output:{dims:o,type:n[0].type,textureType:2},shaderSource:w,hasMain:!0}},sm=(e,t,n)=>{let i=n$(t.length,n.cacheKey);return{...i,get:()=>r$(e,i,t,n.axis)}},Gi=(e,t,n)=>{let i=e.indexOf(t);return e.map((e,t)=>t===i?`${e} - ${n}`:e).join()}}),pm=k(()=>{lt(),Ae(),um(),lm=(e,t,n)=>(c$(t),e.session.pack&&t[0].dims.length>1?[e.run(sm(e,t,n),t)]:[e.run(a$(e,t,n),t)]),o$=(e,t)=>({name:"Concat",inputNames:Array.from({length:e},(e,t)=>`X${t}`),inputTypes:Array(e).fill(0),cacheHint:t}),i$=(e,t,n,i)=>{let a=n[0].dims.slice();if(i>=a.length||i<-1*a.length)throw Error("axis specified for concat doesn't match input dimensionality");i<0&&(i=a.length+i);let o=a.slice(0);for(let e=1;e<n.length;e++){let t=n[e].dims.slice();for(let e=0;e<a.length;e++)if(e===i)o[i]+=t[e];else if(a[e]!==t[e])throw Error("non concat dimensions must match")}let s=o.length,l=Array(n.length),u=0;for(let e=0;e<l.length;++e)u+=n[e].dims[i],l[e]=u;let c="";c=n.length<5?cm(l):s$(l);let d=u$(n.length,s),p=l$(l),h=`
        ${d}
        ${p}
        ${c}
        float process(int indices[${s}]) {
          int textureIndex = getTextureWhereDataResides (indices[${i}]);

          if(textureIndex != 0) {
            indices[${i}] = indices[${i}] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));
          }

          return fetchDataFromCorrectTexture(textureIndex, indices);
        }`;return{...t,output:{dims:o,type:n[0].type,textureType:0},shaderSource:h}},a$=(e,t,n)=>{let i=o$(t.length,n.cacheKey);return{...i,get:()=>i$(e,i,t,n.axis)}},cm=e=>`int getTextureWhereDataResides(int index) {
      ${e.map((e,t)=>`if(index<${e}) {return ${t};}
`).join("")}
    }`,s$=e=>cm(e),u$=(e,t)=>{let n=[`float fetchDataFromCorrectTexture(int textureIndex, int indices[${t}]) {`];for(let t=0;t<e;++t)0===t?n.push(`	if (textureIndex == ${t}) { return _X${t}(indices); }`):t===e-1?n.push(`	else { return _X${t}(indices); }`):n.push(`	else if (textureIndex == ${t}) { return _X${t}(indices); }`);return n.push("	}"),n.join(`
`)},l$=e=>{let t=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(let n=0;n<e.length;++n)0===n?t.push(`	if (index == ${n}) { return ${e[n]}; }`):n===e.length-1?t.push(`	else { return ${e[n]}; }`):t.push(`	else if (index == ${n}) { return ${e[n]}; }`);return t.push("	}"),t.join(`
`)},dm=e=>xe({axis:e.attributes.getInt("axis")}),c$=e=>{if(!e||e.length<1)throw Error("too few inputs");let t=e[0].type,n=e[0].dims.length;if("string"===t)throw Error("string tensor is not supported yet");for(let i of e){if(i.type!==t)throw Error("input tensors should be one type");if(i.dims.length!==n)throw Error("input tensors should have the same shape")}}});function d$(){return Bt("abs")}function p$(){return Bt("acos")}function f$(){return Bt("asin")}function h$(){return Bt("atan")}function m$(){return Bt("ceil")}function g$(){return Bt("cos")}function b$(e){let t="elu";return{body:`
  const float alpha = float(${e});

  float ${t}_(float a) {
    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;
  }
  vec4 ${t}_(vec4 v) {
    return vec4(${t}_(v.x), ${t}_(v.y), ${t}_(v.z), ${t}_(v.w));
  }
  `,name:t,type:0}}function y$(){return Bt("exp")}function _$(){return Bt("floor")}function Sl(e,t){let n="clip";return{body:`
  const float min = float(${e});
  const float max = float(${t});

  float ${n}_(float a) {
    return clamp(a, min, max);
  }
  vec4 ${n}_(vec4 v) {
    return clamp(v, min, max);
  }
  `,name:n,type:0}}function v$(){let e="indentity";return{body:`
  float ${e}_(float a) {
    return a;
  }
  vec4 ${e}_(vec4 v) {
    return v;
  }
  `,name:e,type:0}}function w$(e){let t="leakyRelu";return{body:`
  const float alpha = float(${e});

  float ${t}_(float a) {
    return a < 0.0 ? a * alpha : a;
  }
  vec4 ${t}_(vec4 v) {
    return vec4(${t}_(v.x), ${t}_(v.y), ${t}_(v.z), ${t}_(v.w));
  }
  `,name:t,type:0}}function x$(){return Bt("log")}function T$(){let e="neg";return{body:`
  float ${e}_(float a) {
    return -a;
  }
  vec4 ${e}_(vec4 v) {
    return -v;
  }
  `,name:e,type:0}}function I$(){let e="not";return{body:`
  float ${e}_(float a) {
    return float( ! bool(a) );
  }
  bool ${e}_(bool a) {
    return !a;
  }
  vec4 ${e}_(vec4 v) {
    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));
  }
  bvec4 ${e}_(bvec4 v) {
    return bvec4(!v.x, !v.y, !v.z, !v.w);
  }
  `,name:e,type:0}}function S$(){return Bt("sin")}function $l(){let e="relu";return{body:`
  float ${e}_(float a) {
    return max( a, 0.0 );
  }
  vec4 ${e}_(vec4 v) {
    return max( v, 0.0 );
  }
  `,name:e,type:0}}function Al(){let e="sigmoid";return{body:`
  float ${e}_(float a) {
    return 1.0 / (1.0 + exp(-a));
  }
  vec4 ${e}_(vec4 v) {
    return 1.0 / (1.0 + exp(-v));
  }
  `,name:e,type:0}}function $$(){return Bt("sqrt")}function A$(){return Bt("tan")}function O$(){let e="tanh";return{body:`
  float ${e}_(float a) {
    a = clamp(a, -10., 10.);
    a = exp(2.*a);
    return (a - 1.) / (a + 1.);
  }
  vec4 ${e}_(vec4 v) {
    v = clamp(v, -10., 10.);
    v = exp(2.*v);
    return (v - 1.) / (v + 1.);
  }
  `,name:e,type:0}}function Bt(e){return{body:`
  float ${e}_(float a) {
    return ${e}(a);
  }
  vec4 ${e}_(vec4 v) {
    return ${e}(v);
  }
  `,name:e,type:0}}var P$,et,fm,hm,mm,gm,Ol,bm,ym,E$,_m,vm,wm,xm,Tm,Im,Pl,Sm,$m,Am,Om,Pm,Em,Cm,Dm,km,Nm,Lm,El=k(()=>{lt(),Me(),Jn(),Ke(),Ae(),P$=(e,t,n,i)=>{let a=2*!!e.session.pack,o=ue(e.session.backend.glContext.version);return{...t,output:{dims:n.dims,type:n.type,textureType:a},shaderSource:`
     ${i.body}
     void main() {
       vec4 v = ${o.texture2D}(A, TexCoords);
       v = ${i.name}_(v);
       ${o.output} = v;
     }
     `,hasMain:!0}},et=(e,t,n,i)=>{let a=2*!!e.session.pack,o={name:n.name,inputTypes:[a],inputNames:["A"],cacheHint:i};return{...o,get:()=>P$(e,o,t,n)}},fm=(e,t)=>[e.run(et(e,t[0],d$()),t)],hm=(e,t)=>[e.run(et(e,t[0],p$()),t)],mm=(e,t)=>[e.run(et(e,t[0],f$()),t)],gm=(e,t)=>[e.run(et(e,t[0],h$()),t)],Ol=(e,t,n)=>[e.run(et(e,t[0],Sl(n.min,n.max),n.cacheKey),t)],bm=e=>xe({min:e.attributes.getFloat("min",Lr),max:e.attributes.getFloat("max",Rr)}),ym=(e,t)=>{let n=E$(e,t);return Ol(e,[t[0]],n)},E$=(e,t)=>{if(t.length>=3&&(!e.session.isInitializer(t[1].dataId)||!e.session.isInitializer(t[2].dataId)))throw Error("dynamic clip attributes are not allowed");let n=t.length>=3?t[1].numberData[0]:Lr,i=t.length>=3?t[2].numberData[0]:Rr;return xe({min:n,max:i})},_m=(e,t)=>[e.run(et(e,t[0],m$()),t)],vm=(e,t)=>[e.run(et(e,t[0],g$()),t)],wm=(e,t,n)=>[e.run(et(e,t[0],b$(n.alpha),n.cacheKey),t)],xm=e=>xe({alpha:e.attributes.getFloat("alpha",1)}),Tm=(e,t)=>[e.run(et(e,t[0],y$()),t)],Im=(e,t)=>[e.run(et(e,t[0],_$()),t)],Pl=(e,t)=>[e.run(et(e,t[0],v$()),t)],Sm=(e,t,n)=>[e.run(et(e,t[0],w$(n.alpha),n.cacheKey),t)],$m=e=>xe({alpha:e.attributes.getFloat("alpha",.01)}),Am=(e,t)=>[e.run(et(e,t[0],x$()),t)],Om=(e,t)=>[e.run(et(e,t[0],T$()),t)],Pm=(e,t)=>[e.run(et(e,t[0],I$()),t)],Em=(e,t)=>[e.run(et(e,t[0],$l()),t)],Cm=(e,t)=>[e.run(et(e,t[0],Al()),t)],Dm=(e,t)=>[e.run(et(e,t[0],S$()),t)],km=(e,t)=>[e.run(et(e,t[0],$$()),t)],Nm=(e,t)=>[e.run(et(e,t[0],A$()),t)],Lm=(e,t)=>[e.run(et(e,t[0],O$()),t)]});function Rn(e){let t;switch(e.activation){case"Relu":t=$l();break;case"Sigmoid":t=Al();break;case"Clip":t=Sl(e.clipMin,e.clipMax);break;default:return{activationFunction:"",applyActivation:""}}let n=t.name;return{activationFunction:t.body,applyActivation:`value = ${n}_(value);`}}var ao,D$,k$,Rm,N$,L$,Mm,Br=k(()=>{Me(),El(),ao=e=>{let t=e.getString("activation","");if("Clip"===t){let[n,i]=e.getFloats("activation_params",[Lr,Rr]);return{activation:t,clipMax:i,clipMin:n,activationCacheKey:`${t}:${n},${i}`}}return{activation:t,activationCacheKey:t}}}),zm=k(()=>{Ct(),Ke(),Ae(),Ui(),Br(),D$=(e,t)=>({name:"GroupedConv",inputNames:e?["X","W","Bias"]:["X","W"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}),k$=(e,t,n,i)=>{let a=t.length>2?"value += getBias(output_channel);":"",o=t[0].dims.slice(),s=t[1].dims.slice(),l=s[0]/i.group;Fe.verbose("GroupedConv",`autpPad:${i.autoPad}, dilations:${i.dilations}, group:${i.group}, kernelShape:${i.kernelShape}, pads:${i.pads}, strides:${i.strides}`);let u=so(o,s,i.dilations,i.pads,i.strides),c=ue(e.session.backend.glContext.version),{activationFunction:d,applyActivation:p}=Rn(i),h=`
  const ivec2 strides = ivec2(${i.strides[0]}, ${i.strides[1]});
  const ivec2 pads = ivec2(${i.pads[0]}, ${i.pads[1]});
  ${d}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;
    ivec2 xRCCorner = coords.zw * strides - pads;
    int group_id = output_channel / ${l};

    float value = 0.0;
    for (int wInChannel = 0; wInChannel < ${s[1]}; wInChannel++) {
      int input_channel = group_id * ${s[1]} + wInChannel;
      for (int wHeight = 0; wHeight < ${s[2]}; wHeight++) {
        int xHeight = xRCCorner.x + wHeight * ${i.dilations[0]};

        if (xHeight < 0 || xHeight >= ${o[2]}) {
          continue;
        }

        for (int wWidth = 0; wWidth < ${s[3]}; wWidth++) {
          int xWidth = xRCCorner.y + wWidth * ${i.dilations[1]};
          if (xWidth < 0 || xWidth >= ${o[3]}) {
            continue;
          }

          float xVal = getX(batch, input_channel, xWidth, xHeight);
          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);
          value += xVal*wVal;
        }
      }
    }
    ${a}
    ${p}
    ${c.output} = vec4(value, .0, .0, .0);
  }
`;return{...n,output:{dims:u,type:t[0].type,textureType:0},shaderSource:h,hasMain:!0}},Rm=(e,t,n)=>{let i=D$(t.length>2,n.cacheKey);return{...i,get:()=>k$(e,t,i,n)}}}),Bm=k(()=>{Ke(),Ae(),Mr(),N$=e=>({name:"Im2Col (packed)",inputNames:["A"],inputTypes:[2],cacheHint:e}),L$=(e,t,n,i,a,o)=>{let s=n.dims,l=i.dims,u=2,c=3,d=a.length,p=[l[1]*l[2]*l[3],a[2]*a[3]],h=l[2]*l[3],f=Ln(),g=ue(e.session.backend.glContext.version),m="";for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)m+=`
            blockIndex = rc.x + ${t};
            pos = rc.y + ${e};

            if(blockIndex < ${p[1]} && pos < ${p[0]}) {
              offsetY = int(blockIndex / (${a[d-1]})) * ${o.strides[0]} -
                ${o.pads[0]};
              d0 = offsetY + ${o.dilations[0]} * (imod(pos, ${h}) / ${l[2]});

              if(d0 < ${s[u]} && d0 >= 0) {
                offsetX = imod(blockIndex, ${a[d-1]}) * ${o.strides[1]} -
                  ${o.pads[1]};
                d1 = offsetX + ${o.dilations[1]} * imod(imod(pos, ${h}), ${l[2]});

                if(d1 < ${s[c]} && d1 >= 0) {

                  ch = int(float(pos)/ ${h}.);
                    innerDims = vec2(d0, d1);
                    result[${2*e+t}] = getChannel(
                      getA(0, ch, int(innerDims.x),
                      int(innerDims.y)), innerDims);
                }
              }
            }

          `;let y=`
      ${f}

      void main() {
        ivec2 rc = getOutputCoords();
          vec4 result = vec4(0.0);
          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
          vec2 innerDims;
          ${m}
          ${g.output} = result;
      }
            `;return{...t,output:{dims:p,type:n.type,textureType:2},shaderSource:y,hasMain:!0}},Mm=(e,t,n,i,a)=>{let o=N$(a.cacheKey);return{...o,get:()=>L$(e,o,t,n,i,a)}}});function z$(e,t,n){let i=t[0].dims,a=t[1].dims,o=gt.calcShape(i,a,!0);if(!o)throw Error("Can't use matmul on the given tensors");let s=bt(o.length),l=qt(),{activationFunction:u,applyActivation:c}=Rn(n),d=t.length>2,p=d?"value += getBiasForMatmul();":"",h=d?`${Dl(s,l,t[2].dims,o,!1)}`:"",f=o.length,g=i.length,m=a.length,y=i[i.length-1],b=`
    ${u}
    ${h}
    float process(int indices[${f}]) {
        int a[${g}];
        int b[${m}];
        bcastMatmulIndices_A(indices, a);
        bcastMatmulIndices_B(indices, b);

        float value;
        for (int k=0; k<${y}; ++k) {
            a[${g-1}] = k;
            b[${m-2}] = k;
            value += _A(a) * _B(b);
        }
        ${p}
        ${c}
        return value;
    }`;return{...e,output:{dims:o,type:t[0].type,textureType:0},shaderSource:b}}function Cl(e,t){let n=R$(e.length>2,t.activationCacheKey);return{...n,get:()=>z$(n,e,t)}}function Dl(e,t,n,i,a){let o="",s=n.length,l=i.length,u=l-s;o=l<2&&s>0?"coords":n.map((e,n)=>`coords.${t[n+u]}`).join(", ");let c=gt.getBroadcastDims(n,i).map(e=>`coords.${t[e+u]} = 0;`).join(`
`),d=1===ne.size(n),p="vec4(outputValue.xx, outputValue.yy)";return d&&(p="vec4(outputValue.x)"),a?`
vec4 getBiasForMatmul() {
  ${e} coords = getOutputCoords();
  ${c}
  vec4 outputValue = getBias(${o});
  return ${p};
}`:`
float getBiasForMatmul() {
  ${e} coords = getOutputCoords();
  ${c}
  return getBias(coords.x);
}`}var Fm,Vm,R$,M$,Wi=k(()=>{Me(),Ae(),Nn(),Br(),kl(),Fm=(e,t,n)=>(M$(t),e.session.pack?[e.run(Hi(e,t,n),t)]:[e.run(Cl(t,n),t)]),Vm=e=>ao(e.attributes),R$=(e,t)=>({name:"MatMul",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}),M$=e=>{if(!e||2!==e.length)throw Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw Error("shared dimension does not match.");if("float32"!==e[0].type&&"float64"!==e[0].type||"float32"!==e[1].type&&"float64"!==e[1].type)throw Error("inputs should be float type");if(e[0].type!==e[1].type)throw Error("inputs types should match")}});function V$(e,t,n,i){let a=[],o=[],s=n[0].dims,l=n[1].dims,u=s.length,c=l.length,d=i.length,p=d-u,h=d-c;(a=s.map((e,n)=>`coords.${t[n+p]}`))[u-1]="i*2",a.join(", "),(o=l.map((e,n)=>`coords.${t[n+h]}`))[c-2]="i*2",o.join(", ");let f=gt.getBroadcastDims(s,i),g=gt.getBroadcastDims(l,i),m=f.map(e=>`coords.${t[e+p]} = 0;`).join(`
`),y=g.map(e=>`coords.${t[e+h]} = 0;`).join(`
`),b=`int lastDim = coords.${t[d-1]};
  coords.${t[d-1]} = coords.${t[d-2]};
  coords.${t[d-2]} = lastDim;`;return`
vec4 getAAtOutCoordsMatmul(int i) {
  ${e} coords = getOutputCoords();
  ${b}
  ${m}
  vec4 outputValue = getA(${a});
  return outputValue;
}

vec4 getBAtOutCoordsMatmul(int i) {
  ${e} coords = getOutputCoords();
  ${b}
  ${y}
  vec4 outputValue = getB(${o});
  return outputValue;
}`}function G$(e,t){let n="";for(let i=0;i<t-2;i++)n+=`rc.${e[i]}, `;return n+`rc.${e[t-2]}, i*2`}function U$(e,t){let n="";for(let i=0;i<t-2;i++)n+=`rc.${e[i]}, `;return n+`i*2, rc.${e[t-1]}`}var B$,F$,Hi,Gm,W$,H$,Wm,Nl,j$,q$,Hm,so,Rl,K$,X$,Z$,J$,zl,Y$,Q$,eA,tA,qm,nA,rA,oA,iA,aA,sA,Km,uA,Zm,Fr,Jm,lA,Ym,cA,dA,pA,Qm,eg,fA,ng,rg,hA,gr,ig,ag,mA,gA,bA,yA,Ml,ug,lg,cg,_A,vA,wA,pg,fg,xA,TA,IA,SA,$A,gg,bg,mg,AA,OA,PA,EA,CA,DA,kl=k(()=>{Me(),Ke(),Ae(),Nn(),Br(),Wi(),B$=(e,t)=>({name:"MatMul (packed)",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[2,2,2]:[2,2],cacheHint:t}),F$=(e,t,n,i)=>{let a=n.length>2,o=a?"value += getBiasForMatmul();":"",s=n[0].dims,l=n[1].dims,u=gt.calcShape(s,l,!0),c=!ne.areEqual(n[0].dims,n[1].dims);if(!u)throw Error("Can't use matmul on the given tensors");let d=Math.ceil(s[s.length-1]/2),p=s.length,h=l.length,f=ue(e.session.backend.glContext.version),g=bt(u.length),m=u.length,y=qt(),{activationFunction:b,applyActivation:v}=Rn(i),x=a?`${Dl(g,y,n[2].dims,u,!0)}`:"",w=c?`${V$(g,y,n,u)}`:"",_=c?"getAAtOutCoordsMatmul(i)":`getA(${G$(y,p)})`,S=c?"getBAtOutCoordsMatmul(i)":`getB(${U$(y,h)})`,k=c?"":`${g} rc =
          getOutputCoords(); int lastDim = rc.${y[m-1]}; rc.${y[m-1]} =
          rc.${y[m-2]}; rc.${y[m-2]} = lastDim;
      `,T=`
            ${w}
            ${x}
            ${b}
            void main() {
              ${k}

              vec4 value = vec4(0);
              for (int i = 0; i < ${d}; i++) {
                vec4 a = ${_};
                vec4 b = ${S};

                value += (a.rrbb * b.rgrg);
                value += (a.ggaa * b.baba);
              }
              ${o}
              ${v}
              ${f.output} = value;
            }`;return{...t,output:{dims:u,type:n[0].type,textureType:2},shaderSource:T,hasMain:!0}},Hi=(e,t,n)=>{let i=B$(t.length>2,n.activationCacheKey);return{...i,get:()=>F$(e,i,t,n)}}}),Um=k(()=>{Ui(),Bm(),kl(),Gm=(e,t,n)=>{let i=t[0].dims,a=t[1].dims,o=so(i,a,n.dilations,n.pads,n.strides),s=e.run(Mm(e,t[0],t[1],o,n),[t[0]]),l=e.reshapePacked(t[1],[a[0],a[1]*a[2]*a[3]]),u=3===t.length?[l,s,t[2]]:[l,s],c=e.run(Hi(e,u,n),u);return e.reshapePacked(c,o)}}),Ll=k(()=>{Ae(),W$=e=>({name:"Im2Col",inputNames:["X"],inputTypes:[0],cacheHint:e}),H$=(e,t,n,i,a,o)=>{let s=n.dims,l=i.dims,u=a.length,c=Nl(s,l,a,4),d=`
        const int XC = ${s[1]};
        const int XH = ${s[2]};
        const int XW = ${s[3]};
        const int KH = ${o.kernelShape[0]};
        const int KW = ${o.kernelShape[1]};
        const int dilationH = ${o.dilations[0]};
        const int dilationW = ${o.dilations[1]};
        const int strideH = ${o.strides[0]};
        const int strideW = ${o.strides[1]};
        const int padH = ${o.pads[0]};
        const int padW = ${o.pads[1]};
        const int KHKW = KH*KW;
        const int XCKHKW = XC * KHKW;
        const int outputChannels = 4;
        vec4 process(int indices[${u}]) {
          int b  = indices[0]; // batch size
          int oh = indices[1] * strideH - padH; //output height
          int ow = indices[2] * strideW - padW; //output width
          int p = indices[3] * outputChannels; //patch
          vec4 value = vec4(0.0);
          for(int i=0; i < outputChannels; ++i) {
            if(p < XCKHKW) {
              int patchC = p / KHKW;
              int patchH = (p - patchC*KHKW) / KW;
              int patchW = (p - patchC*KHKW) - patchH * KW;
              int xh2 = oh + patchH * dilationH;
              int xw2 = ow + patchW * dilationW;
              int x[${s.length}];
              x[0] = b;
              x[1] = patchC;
              x[2] = xh2;
              x[3] = xw2;
              if(xh2 >= 0 &&
                  xh2 < XH &&
                  xw2 >= 0 &&
                  xw2 < XW) {
                value[i] = _X(x);
              }
            }
            ++p;
          }
          return value;
        }
        `;return{...t,output:{dims:c,type:n.type,textureType:4},shaderSource:d}},Wm=(e,t,n,i,a)=>{let o=W$(a.cacheKey);return{...o,get:()=>H$(e,o,t,n,i,a)}},Nl=(e,t,n,i=4)=>[n[0],n[2],n[3],Math.ceil(e[1]*t[2]*t[3]/i)]}),jm=k(()=>{Me(),Ke(),Ae(),Br(),Ll(),j$=(e,t)=>({name:"ConvDotProduct",inputNames:e?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:e?[0,4,0]:[0,4],cacheKey:t.activationCacheKey}),q$=(e,t,n,i,a)=>{let o=n[0].dims,s=n[1].dims,l=[s[0],Math.ceil(o[1]*s[2]*s[3]/4)],u=Nl(o,s,i),[c,d]=e.calculateTextureWidthAndHeight(l,4),p=ne.computeStrides(u),[h,f]=e.calculateTextureWidthAndHeight(u,4),g=i.length,m=n.length<3?"0.0":"_B(b)",y=Math.ceil(o[1]*s[2]*s[3]/4),{activationFunction:b,applyActivation:v}=Rn(a),x=ue(e.session.backend.glContext.version),w=`
${b}
float process(int indices[${g}]) {
  int b[1];
  b[0] = indices[1];
  int im2col[4];
  im2col[0] = indices[0];
  im2col[1] = indices[2];
  im2col[2] = indices[3];
  int im2colOffset = im2col[0] * ${p[0]} + im2col[1] * ${p[1]} + im2col[2] * ${p[2]};
  int kernelOffset = indices[1] * ${l[1]};
  float value = ${m};
  for (int i = 0; i < ${y}; ++i) {
    vec2 im2colCoords = offsetToCoords(im2colOffset, ${h}, ${f});
    vec2 kernelCoords = offsetToCoords(kernelOffset, ${c}, ${d});
    value += dot(${x.texture2D}(Im2Col, im2colCoords), ${x.texture2D}(K, kernelCoords));
    ++im2colOffset;
    ++kernelOffset;
  }
  ${v}
  return value;
}`;return{...t,output:{dims:i,type:n[0].type,textureType:0},shaderSource:w}},Hm=(e,t,n,i)=>{let a=j$(t.length>2,i);return{...a,get:()=>q$(e,a,t,n,i)}}}),Ui=k(()=>{lt(),Me(),zm(),Um(),jm(),Br(),Ll(),Wi(),so=(e,t,n,i,a)=>{let o=e[0],s=e.slice(2),l=s.length,u=t[0],c=t.slice(2).map((e,t)=>e+(e-1)*(n[t]-1));return[o,u].concat(...s.map((e,t)=>e+i[t]+i[t+l]).map((e,t)=>Math.floor((e-c[t]+a[t])/a[t])))},Rl=(e,t,n)=>(Y$(t,n),K$(e,t,n)),K$=(e,t,n)=>{let i=J$(n,t),a=e.session.pack,o=1===i.kernelShape[0]&&1===i.kernelShape[1];return i.group>1?[e.run(Rm(e,t,i),t)]:o&&a?[X$(e,t,i)]:a&&4===t[0].dims.length&&1===t[0].dims[0]&&!o?[Gm(e,t,i)]:[Z$(e,t,i)]},X$=(e,t,n)=>{let i=t[0].dims,a=t[1].dims,o=so(i,a,n.dilations,n.pads,n.strides),s=e.reshapeUnpacked(t[0],[i[1],i[2]*i[3]]),l=e.reshapeUnpacked(t[1],[a[0],a[1]]),u=t.length>2?[l,s,t[2]]:[l,s],c=e.run(Cl(u,n),u);return e.reshapeUnpacked(c,o)},Z$=(e,t,n)=>{let i=t[0].dims,a=t[1].dims,o=so(i,a,n.dilations,n.pads,n.strides),s=e.run(Wm(e,t[0],t[1],o,n),[t[0]]),l=3===t.length?[s,t[1],t[2]]:[s,t[1]];return e.run(Hm(e,t,o,n),l)},J$=(e,t)=>{let n=e.kernelShape.slice();if(0===e.kernelShape.length)for(let e=2;e<t[1].dims.length;++e)n.push(t[1].dims[e]);let i=e.pads.slice();Nr.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,n,i,e.autoPad);let a=Object.assign({},e);return Object.assign(a,{kernelShape:n,pads:i,cacheKey:e.cacheKey}),a},zl=e=>{let t=e.attributes,n=ao(t),i=t.getString("auto_pad","NOTSET"),a=t.getInts("dilations",[1,1]),o=t.getInt("group",1),s=t.getInts("kernel_shape",[]),l=t.getInts("pads",[0,0,0,0]),u=t.getInts("strides",[1,1]);return xe({autoPad:i,dilations:a,group:o,kernelShape:s,pads:l,strides:u,...n})},Y$=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length||4!==e[1].dims.length)throw Error("currently only support 2-dimensional conv");if(e[0].dims[1]!==e[1].dims[1]*t.group)throw Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(3===e.length&&(1!==e[2].dims.length||e[1].dims[0]!==e[2].dims[0]))throw Error("invalid bias");let n=e[0].dims.length-2;if(t.dilations.length!==n)throw Error(`dilations should be ${n}D`);if(t.strides.length!==n)throw Error(`strides should be ${n}D`);if(t.pads.length!==2*n)throw Error(`pads should be ${2*n}D`);if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw Error("invalid kernel shape");if("float32"!==e[0].type||"float32"!==e[1].type)throw Error("Conv input(X,W) should be float tensor");if(3===e.length&&"float32"!==e[2].type)throw Error("Conv input(bias) should be float tensor")}}),Xm=k(()=>{lt(),Ke(),Ae(),Br(),Q$=(e,t,n,i,a,o)=>(e-1)*t+n+(i-1)*a+1-o,eA=(e,t,n,i,a)=>{let o=Math.floor(e/2);"SAME_UPPER"===t?(n[i]=o,n[a]=e-o):"SAME_LOWER"===t&&(n[i]=e-o,n[a]=o)},tA=(e,t,n,i,a,o,s,l)=>{let u=e.length-2,c=0===l.length;for(let d=0;d<u;++d){let p=c?e[d+2]*o[d]:l[d];eA(Q$(e[d+2],o[d],a[d],t[d],n[d],p),i,a,d,d+u),c&&l.push(o[d]*(e[d+2]-1)+s[d]+(t[d]-1)*n[d]+1-a[d]-a[d+u])}},qm=(e,t,n)=>(uA(t,n),nA(e,t,n)),nA=(e,t,n)=>{let i=sA(n,t);return[aA(e,t,i)]},rA=(e,t)=>({name:"ConvTranspose",inputNames:e?["X","W","B"]:["X","W"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}),oA=(e,t,n,i)=>{let a=t.length>2?"getB(output_channel)":"0.0",o=t[0].dims,s=t[1].dims,l=s[1],u=s[0]/i.group,c=[t[0].dims[0],t[1].dims[1]*i.group,...i.outputShape],d=ue(e.session.backend.glContext.version),{activationFunction:p,applyActivation:h}=Rn(i),f=`
  const ivec2 strides = ivec2(${i.strides[0]}, ${i.strides[1]});
  const ivec2 pads = ivec2(${i.pads[0]}, ${i.pads[1]});
  ${p}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;

    ivec2 loc = coords.zw + pads;

    int group_id = output_channel / ${l};
    int wOutChannel = output_channel - group_id * ${l};

    float value = ${a};
    for (int inChannelOffset = 0; inChannelOffset < ${u}; inChannelOffset++) {
      int input_channel = group_id * ${u} + inChannelOffset;
      for (int wWOff = 0; wWOff < ${s[2]}; wWOff++) {
        for (int wHOff = 0; wHOff < ${s[3]}; wHOff++) {
          ivec2 wOff = ivec2(wWOff * ${i.dilations[0]}, wHOff * ${i.dilations[1]});
          ivec2 wLoc = loc - wOff;
          ivec2 wLocIn = wLoc / strides;
          if (
            wLocIn * strides == wLoc &&
            wLocIn.x >= 0 && wLocIn.x < ${o[2]} &&
            wLocIn.y >= 0 && wLocIn.y < ${o[3]}
          ) {
            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);
            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);
            value += xVal * wVal;
          }
        }
      }
    }
    ${h}
    ${d.output} = vec4(value, .0, .0, .0);
  }
`;return{...n,output:{dims:c,type:t[0].type,textureType:0},shaderSource:f,hasMain:!0}},iA=(e,t,n)=>{let i=rA(t.length>2,n.cacheKey);return{...i,get:()=>oA(e,t,i,n)}},aA=(e,t,n)=>e.run(iA(e,t,n),t),sA=(e,t)=>{let n=e.kernelShape.slice();if(0===e.kernelShape.length)for(let e=2;e<t[1].dims.length;++e)n.push(t[1].dims[e]);let i=e.pads.slice(),a=e.outputShape.slice();tA(t[0].dims,n,e.dilations,e.autoPad,i,e.strides,e.outputPadding,a);let o=Object.assign({},e);return Object.assign(o,{kernelShape:n,pads:i,outputShape:a,cacheKey:e.cacheKey}),o},Km=e=>{let t=e.attributes,n=ao(t),i=t.getString("auto_pad","NOTSET"),a=t.getInts("dilations",[1,1]),o=t.getInt("group",1),s=t.getInts("kernel_shape",[]),l=t.getInts("output_padding",[0,0]),u=t.getInts("output_shape",[]),c=t.getInts("pads",[0,0,0,0]),d=t.getInts("strides",[1,1]);return xe({autoPad:i,dilations:a,group:o,kernelShape:s,outputPadding:l,outputShape:u,pads:c,strides:d,...n})},uA=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length||4!==e[1].dims.length)throw Error("currently only support 2-dimensional conv");if(e[0].dims[1]!==e[1].dims[0])throw Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let n=e[1].dims[1]*t.group;if(3===e.length&&(1!==e[2].dims.length||e[2].dims[0]!==n))throw Error("invalid bias");let i=e[0].dims.length-2;if(t.dilations.length!==i)throw Error(`dilations should be ${i}D`);if(t.strides.length!==i)throw Error(`strides should be ${i}D`);if(t.pads.length!==2*i)throw Error(`pads should be ${2*i}D`);if(t.outputPadding.length!==i)throw Error(`output_padding should be ${i}D`);if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw Error("invalid kernel shape");if(0!==t.outputShape.length&&t.outputShape.length!==e[0].dims.length-2)throw Error("invalid output shape");if("float32"!==e[0].type||"float32"!==e[1].type)throw Error("ConvTranspose input(X,W) should be float tensor");if(3===e.length&&"float32"!==e[2].type)throw Error("ConvTranspose input(bias) should be float tensor")}}),ji=k(()=>{lt(),Me(),Ae(),Zm={name:"Transpose",inputNames:["A"],inputTypes:[0]},Fr=(e,t,n)=>(pA(t),[e.run({...Zm,cacheHint:n.cacheKey,get:()=>lA(e,t[0],n.perm)},t)]),Jm=e=>xe({perm:e.attributes.getInts("perm",[])}),lA=(e,t,n)=>{let i=t.dims;n=Ym(i,n);let a=cA(i,n),o=i.length,s=`
      ${dA("perm",n,o)}
      float process(int indices[${o}]) {
        int a[${o}];
        perm(a, indices);
        return _A(a);
      }`;return{...Zm,output:{dims:a,type:t.type,textureType:0},shaderSource:s}},Ym=(e,t)=>(t&&t.length!==e.length&&(t=[...e.keys()].reverse()),t),cA=(e,t)=>(t=Ym(e,t),ne.sortBasedOnPerm(e,t)),dA=(e,t,n)=>{let i=[];i.push(`void ${e}(out int a[${n}], int src[${n}]) {`);for(let e=0;e<n;++e)i.push(`	a[${t[e]}]=src[${e}];`);return i.push("	}"),i.join(`
`)},pA=e=>{if(!e||1!==e.length)throw Error("Transpose requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw Error("input should be float tensor")}}),tg=k(()=>{ji(),Qm=(e,t,n)=>{fA(t);let i=n.blocksize,a=i*i,o="DCR"===n.mode?[0,3,4,1,5,2]:[0,1,4,2,5,3],s="DCR"===n.mode?[t[0].dims[0],i,i,t[0].dims[1]/a,t[0].dims[2],t[0].dims[3]]:[t[0].dims[0],t[0].dims[1]/a,i,i,t[0].dims[2],t[0].dims[3]],l=e.reshapeUnpacked(t[0],s),u={perm:o,cacheKey:`${o}`},[c]=Fr(e,[l],u),d=[t[0].dims[0],t[0].dims[1]/a,t[0].dims[2]*i,t[0].dims[3]*i];return[e.reshapeUnpacked(c,d)]},eg=e=>{let t=e.attributes.getInt("blocksize");if(t<1)throw Error(`blocksize must be >= 1, but got : ${t} for DepthToSpace`);let n=e.attributes.getString("mode","DCR");if("DCR"!==n&&"CRD"!==n)throw Error(`unrecognized mode: ${n} for DepthToSpace`);return{mode:n,blocksize:t}},fA=e=>{if(1!==e.length)throw Error(`DepthToSpace expect 1 inputs, but got ${e.length}`);if("string"===e[0].type||4!==e[0].dims.length)throw TypeError("DepthToSpace input should be a 4-D numeric tensor")}}),og=k(()=>{Me(),ng=(e,t,n)=>{hA(t,n);let i=ne.flattenShape(t[0].dims,n);return[e.reshapeUnpacked(t[0],i)]},rg=e=>e.attributes.getInt("axis",1),hA=(e,t)=>{if(!e||1!==e.length)throw Error("Flatten requires 1 input.");let n=e[0].dims.length;if(0===n)throw Error("scalar tensor is not supported.");if(t<-n||t>n)throw Error("Invalid axis");if("string"===e[0].type)throw Error("string tensor is not supported.")}}),Ro=k(()=>{gr=["float32","float64","int32","int16","int8","uint16","uint32","uint8"]}),sg=k(()=>{lt(),Ro(),Me(),Ae(),ig=(e,t,n)=>(yA(t,n.axis),[e.run(bA(e,t,n),t)]),ag=e=>xe({axis:e.attributes.getInt("axis",0)}),mA={name:"Gather",inputNames:["A","B"],inputTypes:[0,0]},gA=(e,t,n,i)=>{let a=n[0].dims.slice(),o=n[1].dims.slice(),s=Array(a.length+o.length-1);i=ne.normalizeAxis(i,a.length);let l=[];for(let e=0;e<s.length;e++)e<i?(s[e]=a[e],l.push(`inputIdx[${e}] = outputIdx[${e}];`)):e<i+o.length?(s[e]=o[e-i],l.push(`indexDataIdx[${e-i}] = outputIdx[${e}];`)):(s[e]=a[e-o.length+1],l.push(`inputIdx[${e-o.length+1}] = outputIdx[${e}];`));let u=s.length||1,c=a.length,d=o.length||1,p=`
      float process(int outputIdx[${u}]) {
        int inputIdx[${c}];
        int indexDataIdx[${d}];
        indexDataIdx[0] = 0;
        ${l.join(`
        `)}
        int idx = int(_B(indexDataIdx));
        inputIdx[${i}] = idx < 0 ? idx + ${a[i]} : idx;
        return _A(inputIdx);
      }`;return{...t,output:{dims:s,type:n[0].type,textureType:0},shaderSource:p}},bA=(e,t,n)=>{let i={...mA,cacheHint:n.cacheKey};return{...i,get:()=>gA(e,i,t,n.axis)}},yA=(e,t)=>{if(!e||2!==e.length)throw Error("Gather requires 2 inputs.");let n=e[0].dims.length;if(n<1)throw Error("Invalid input shape.");if(t<-n||t>n-1)throw Error("Invalid axis.");if(-1===gr.indexOf(e[0].type)||"int32"!==e[1].type&&"int16"!==e[1].type)throw Error("Invaid input type.")}}),dg=k(()=>{lt(),Me(),Ae(),Ml=(e,t,n)=>(wA(t,n),[e.run(_A(t,n),t)]),ug=(e,t)=>{let n=0!==e.attributes.getInt("transA",0),i=0!==e.attributes.getInt("transB",0),a=e.attributes.getFloat("alpha",1),o=e.attributes.getFloat("beta",1);return xe({transA:n,transB:i,alpha:a,beta:o,isOptionalC:t})},lg=e=>ug(e,!1),cg=e=>ug(e,!0),_A=(e,t)=>{let n={name:"Gemm",inputNames:3===e.length?["A","B","C"]:["A","B"],inputTypes:3===e.length?[0,0,0]:[0,0],key:t.cacheKey};return{...n,get:()=>vA(n,e,t)}},vA=(e,t,n)=>{let i=t[0].dims.slice(),a=t[1].dims.slice(),[o,s]=Li.getShapeOfGemmResult(i,n.transA,a,n.transB,3===t.length?t[2].dims:void 0),l=[o,s];if(!l)throw Error("Can't use gemm on the given tensors");let u=i[i.length-1],c="";n.transA&&(u=i[0]),n.transA&&n.transB?c="value += _A_T(a) * _B_T(b);":n.transA&&!n.transB?c="value += _A_T(a) * _B(b);":!n.transA&&n.transB?c="value += _A(a) * _B_T(b);":n.transA||n.transB||(c="value += _A(a) * _B(b);");let d=l.length,p=3===t.length?`int c[${t[2].dims.length}];`:"",h=3===t.length?"bcastIndices_C(indices, c);":"",f=3===t.length?"value += beta * _C(c);":"",g=`
      float process(int indices[${d}]) {
          int a[${d}];
          int b[${d}];
          ${p}

          copyVec(indices, a);
          copyVec(indices, b);
          ${h}

          float value = 0.0;
          for (int k=0; k<${u}; ++k) {
              a[${d-1}] = k;
              b[${d-2}] = k;
              ${c}
          }

          value = value * alpha;
          ${f}
          return value;
      }`;return{...e,output:{dims:l,type:t[0].type,textureType:0},variables:[{name:"alpha",type:"float",data:n.alpha},{name:"beta",type:"float",data:n.beta}],shaderSource:g}},wA=(e,t)=>{if(!e)throw Error("Input is missing");if(t.isOptionalC&&(e.length<2||e.length>3))throw Error("Invaid input shape.");if(!t.isOptionalC&&3!==e.length)throw Error("Gemm requires 3 inputs");if(3===e.length&&1!==e[2].dims.length&&2!==e[2].dims.length)throw Error("Invalid input shape of C");if("float32"!==e[0].type&&"float64"!==e[0].type||"float32"!==e[1].type&&"float64"!==e[1].type||3===e.length&&"float32"!==e[2].type&&"float64"!==e[2].type)throw Error("Invalid input type.");if(e[0].type!==e[1].type||3===e.length&&e[0].type!==e[2].type)throw Error("Input types are mismatched")}}),hg=k(()=>{lt(),Ae(),pg=(e,t,n)=>($A(t),[e.run(IA(e,t,n),t)]),fg=e=>{let t=e.attributes.getFloat("scale"),n=e.attributes.getFloats("bias");return xe({scale:t,bias:n})},xA={name:"ImageScaler",inputNames:["X"],inputTypes:[0]},TA=(e,t,n,i)=>{let a=n[0].dims.slice(),o=a.length,s=`
      ${SA(i.bias.length)}
      float process(int indices[${o}]) {
        return _X(indices) * scale + getBias(bias, indices[1]);
      }`;return{...t,output:{dims:a,type:n[0].type,textureType:0},variables:[{name:"bias",type:"float",arrayLength:i.bias.length,data:i.bias},{name:"scale",type:"float",data:i.scale}],shaderSource:s}},IA=(e,t,n)=>{let i={...xA,cacheHint:n.cacheKey};return{...i,get:()=>TA(e,i,t,n)}},SA=e=>{let t=[`float getBias(float bias[${e}], int channel) {`];for(let n=0;n<e;++n)0===n?t.push(`	if (channel == ${n}) { return bias[${n}]; }`):n===e-1?t.push(`	else { return bias[${n}]; }`):t.push(`	else if (channel == ${n}) { return bias[${n}]; }`);return t.push("	}"),t.join(`
`)},$A=e=>{if(!e||1!==e.length)throw Error("ImageScaler requires 1 input.");if(4!==e[0].dims.length)throw Error("Invalid input shape.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw Error("Invalid input type.")}}),yg=k(()=>{Ke(),Ae(),gg=(e,t,n)=>{DA(t);let i=e.run(OA(t[0]),t);return[e.run(CA(e,t[0],n,i.dims),[t[0],i,t[1],t[2]])]},bg=e=>e.attributes.getFloat("epsilon",1e-5),mg={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[0]},AA=(e,t)=>{let n=t.dims.slice(),i=n[1],a=n[2]*n[3],o=[n[0],i],s=`
      vec4 process(int[2] indices) {
        vec4 v = vec4(0.0);
        int a[4];
        a[0] = indices[0];
        a[1] = indices[1];
        float temp = 0.0;
        for(int a2=0; a2<${n[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${n[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += x;
          }
        }
        float mean = temp / float(${a});
        temp = 0.0;
        for(int a2=0; a2<${n[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${n[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += (x - mean) * (x - mean);
          }
        }
        v.r = mean;
        v.g = temp / float(${a});

        return v;
      }`;return{...e,output:{dims:o,type:t.type,textureType:4},shaderSource:s}},OA=e=>({...mg,get:()=>AA(mg,e)}),PA={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[0,4,0,0]},EA=(e,t,n,i,a)=>{let o=ue(e.session.backend.glContext.version),[s,l]=e.calculateTextureWidthAndHeight(a,4),[u,c]=[s/4,l],d=`
      vec4 get_MeanAndVariance(int[2] mv) {
        int offset = indicesToOffset_MeanAndVariance(mv);
        vec2 coords = offsetToCoords(offset, ${u}, ${c});
        return ${o.texture2D}(MeanAndVariance, coords);
      }

      float process(int[4] indices) {
        int mv[2];
        mv[0] = indices[0];
        mv[1] = indices[1];
        vec4 mean_and_variance = get_MeanAndVariance(mv);
        float mean = mean_and_variance.r;
        float variance = mean_and_variance.g;

        int sb[1];
        sb[0] = indices[1];
        float scale = _Scale(sb);
        float b = _B(sb);

        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;
      }`;return{...t,output:{dims:n.dims,type:n.type,textureType:0},variables:[{name:"epsilon",type:"float",data:i}],shaderSource:d}},CA=(e,t,n,i)=>{let a={...PA,cacheHint:`${n}`};return{...a,get:()=>EA(e,a,t,n,i)}},DA=e=>{if(!e||3!==e.length)throw Error("InstanceNormalization requires 3 inputs.");let t=e[0],n=e[1],i=e[2];if(t.dims.length<3||1!==n.dims.length||1!==i.dims.length)throw Error("Invalid input shape.");if(n.dims[0]!==t.dims[1]||i.dims[0]!==t.dims[1])throw Error("Input shapes are mismatched.");if("float32"!==t.type&&"float64"!==t.type||"float32"!==n.type&&"float64"!==n.type||"float32"!==i.type&&"float64"!==i.type)throw Error("Invalid input type.");if(4!==e[0].dims.length)throw Error("Only support 4-D input shape.")}});function kA(e,t){let n=e[0].dims[1],i=e[0].dims.length,a=-Math.floor((t.size-1)/2),o=Math.ceil((t.size-1)/2),s=`float(${t.alpha}) / float(${t.size})`,l=`float(${t.bias})`,u=`float(${t.beta})`,c=`
    float process(int indices[${i}]) {
        int c = indices[1];
        float x = _X(indices);
        float square_sum = 0.0;

        for (int i = ${a}; i <= ${o}; i++) {
          int idx = c + i;
          if (c >= 0 && c < ${n}) {
            indices[1] = idx;
            float j = _X(indices);
            square_sum += j * j;
          }
        }
        return x / pow(${l} + ${s} * square_sum, ${u});
    }`;return{...wg,cacheHint:t.cacheKey,output:{dims:e[0].dims,type:e[0].type,textureType:0},shaderSource:c}}function NA(e,t){return{...wg,cacheHint:t.cacheKey,get:()=>kA(e,t)}}var _g,vg,wg,LA,RA,Bl,Tg,Ig,Sg,zA,MA,BA,FA,VA,GA,UA,WA,Og,Pg,Eg,Cg,Dg,kg,Ng,Lg,Rg,HA,Ag,zg,Ki,Mg,qi,jA,Vr,br,qA,KA,Fg,Vg,Gg,Ug,Wg,Hg,jg,Kg,Zg,Fl,Jg,Yg,zo,XA,Vl,Xi,Ul,Wl,Qg,eb,ZA,JA,YA,QA,nb,eO,Hl,ob,ib,ab,tO,sb,nO,rO,lb,cb,db,pb,fb,hb,mb,gb,oO,iO,aO,bb,_b,vb,wb,sO,uO,lO,jl,Tb,Ib,cO,dO,$b,pO,fO,Ob,hO,mO,ql,Eb,Cb,gO,bO,kb,xg=k(()=>{lt(),Ae(),_g=(e,t,n)=>(LA(t),[e.run(NA(t,n),t)]),vg=e=>{let t=e.attributes.getFloat("alpha",1e-4),n=e.attributes.getFloat("beta",.75),i=e.attributes.getFloat("bias",1),a=e.attributes.getInt("size");return xe({alpha:t,beta:n,bias:i,size:a})},wg={name:"LRN",inputNames:["X"],inputTypes:[0]},LA=e=>{if(!e||1!==e.length)throw Error("LRN requires 1 input.");if(4!==e[0].dims.length)throw Error('currently only support LRN for input with "NCHW" format');if("float32"!==e[0].type)throw Error("input should be float type")}}),$g=k(()=>{lt(),Me(),Ke(),Ae(),RA={name:"Pad",inputNames:["A"],inputTypes:[0]},Bl=(e,t,n)=>(BA(t),[e.run({...RA,cacheHint:n.cacheKey,get:()=>MA(e,t[0],n)},t)]),Tg=e=>{let t=e.attributes.getString("mode","constant"),n=e.attributes.getFloat("value",0),i=e.attributes.getInts("pads");return xe({mode:t,value:n,pads:i})},Ig=(e,t,n)=>{FA(t);let i=zA(e,t,n);return Bl(e,[t[0]],i)},Sg=e=>e.attributes.getString("mode","constant"),zA=(e,t,n)=>{if(!e.session.isInitializer(t[1].dataId)||t.length>=3&&!e.session.isInitializer(t[2].dataId))throw Error("dynamic pad attributes are not allowed");let i=Array.from(t[1].integerData),a=t.length>=3?t[2].floatData[0]:0;return xe({mode:n,pads:i,value:a})},MA=(e,t,n)=>{let i=ne.padShape(t.dims.slice(),n.pads),a=i.length,o=`
      ${VA(e,t,n)}
      float process(int[${a}] indices) {
          return padA(indices);
      }`;return{name:"Pad",inputNames:["A"],inputTypes:[0],output:{dims:i,type:t.type,textureType:0},shaderSource:o}},BA=e=>{if(!e||1!==e.length)throw Error("Pad requires 1 input");if("float32"!==e[0].type&&"float64"!==e[0].type)throw Error("Invalid input type.")},FA=e=>{if(!e||2!==e.length&&3!==e.length)throw Error("Pad requires 2 or 3 inputs");if("int32"!==e[1].type||e.length>=3&&"string"===e[2].type)throw Error("Invalid input type.")},VA=(e,t,n)=>{let i=ue(e.session.backend.glContext.version),[a,o]=e.calculateTextureWidthAndHeight(t.dims,0),s=ne.computeStrides(t.dims);switch(n.mode){case"constant":return GA(i,t.dims,s,a,o,n.pads,n.value);case"reflect":return UA(i,t.dims,s,a,o,n.pads);case"edge":return WA(i,t.dims,s,a,o,n.pads);default:throw Error("Invalid mode")}},GA=(e,t,n,i,a,o,s)=>{let l=t.length,u="";for(let e=l-1;e>=0;--e)u+=`
        k = m[${e}] - ${o[e]};
        if (k < 0)  return constant;
        if (k >= ${t[e]}) return constant;
        offset += k * ${n[e]};
        `;return`
      float padA(int m[${l}]) {
        const float constant = float(${s});
        int offset = 0;
        int k = 0;
        ${u}
        vec2 coords = offsetToCoords(offset, ${i}, ${a});
        float value = getColorAsFloat(${e.texture2D}(A, coords));
        return value;
      }
      `},UA=(e,t,n,i,a,o)=>{let s=t.length,l="";for(let e=s-1;e>=0;--e)l+=`
        k = m[${e}] - ${o[e]};
        if (k < 0) { k = -k; }
        {
          const int _2n_1 = ${2*(t[e]-1)};
          k = int( mod( float(k), float(_2n_1) ) ) ;
          if(k >= ${t[e]}) { k = _2n_1 - k; }
        }
        offset += k * ${n[e]};
        `;return`
      float padA(int m[${s}]) {
        int offset = 0;
        int k = 0;
        ${l}
        vec2 coords = offsetToCoords(offset, ${i}, ${a});
        float value = getColorAsFloat(${e.texture2D}(A, coords));
        return value;
      }
      `},WA=(e,t,n,i,a,o)=>{let s=t.length,l="";for(let e=s-1;e>=0;--e)l+=`
        k = m[${e}] - ${o[e]};
        if (k < 0)  k = 0;
        if (k >= ${t[e]}) k = ${t[e]-1};
        offset += k * ${n[e]};
      `;return`
      float padA(int m[${s}]) {
        int offset = 0;
        int k = 0;
        ${l}
        vec2 coords = offsetToCoords(offset, ${i}, ${a});
        float value = getColorAsFloat(${e.texture2D}(A, coords));
        return value;
      }
      `}}),Bg=k(()=>{lt(),Me(),Ae(),Og=(e,t,n)=>{Ki(t);let i={name:"AveragePool",inputNames:["X"],inputTypes:[0],cacheHint:n.cacheKey};return[e.run({...i,get:()=>Eg(t,i,!1,n)},t)]},Pg=e=>{let t=e.attributes.getString("auto_pad","NOTSET"),n=e.attributes.getInt("ceil_mode",0),i=0!==e.attributes.getInt("count_include_pad",0),a=e.attributes.getInts("kernel_shape"),o=e.attributes.getInts("strides",[]),s=e.attributes.getInts("pads",[]);if(0!==n)throw Error("using ceil() in shape computation is not yet supported for AveragePool");return xe({autoPad:t,ceilMode:n,countIncludePad:i,kernelShape:a,strides:o,pads:s})},Eg=(e,t,n,i)=>{let[a,o]=Rg(e,i,n),s=ne.size(a.kernelShape),l="value += _X(x);",u="";a.countIncludePad?u+=`value /= float(${s});`:u+=`value /= float(${s} - pad);`;let c=`
        ${Mg(e[0].dims,a,l,u,"0.0")}
      `;return{...t,output:{dims:o,type:e[0].type,textureType:0},shaderSource:c}},Cg=(e,t,n)=>{Ki(t);let i={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[0],cacheHint:`${n.countIncludePad}`};return[e.run({...i,get:()=>Eg(t,i,!0,n)},t)]},Dg=e=>{let t=0!==e.attributes.getInt("count_include_pad",0);return xe({autoPad:"",ceilMode:0,countIncludePad:t,kernelShape:[],strides:[],pads:[]})},kg=(e,t,n)=>{Ki(t);let i={name:"MaxPool",inputNames:["X"],inputTypes:[0],cacheHint:n.cacheKey};return[e.run({...i,get:()=>Lg(t,i,!1,n)},t)]},Ng=e=>{let t=e.attributes.getString("auto_pad","NOTSET"),n=e.attributes.getInt("ceil_mode",0),i=e.attributes.getInts("kernel_shape"),a=e.attributes.getInts("strides",[]),o=e.attributes.getInts("pads",[]),s=e.attributes.getInt("storage_order",0),l=e.attributes.getInts("dilations",[]);if(0!==s)throw Error("column major storage order is not yet supported for MaxPool");if(0!==n)throw Error("using ceil() in shape computation is not yet supported for MaxPool");return xe({autoPad:t,ceilMode:n,countIncludePad:!1,kernelShape:i,strides:a,pads:o,storageOrder:s,dilations:l})},Lg=(e,t,n,i)=>{let[a,o]=Rg(e,i,n),s=`
      ${Mg(e[0].dims,a,`
      value = max(_X(x), value);
    `,"","-1e5")}
    `;return{...t,output:{dims:o,type:e[0].type,textureType:0},shaderSource:s}},Rg=(e,t,n)=>{let i=e[0].dims.slice(),a=Object.hasOwnProperty.call(t,"dilations"),o=t.kernelShape.slice(),s=t.strides.slice(),l=a?t.dilations.slice():[],u=t.pads.slice();Nr.adjustPoolAttributes(n,i,o,s,l,u);let c=Nr.computePoolOutputShape(n,i,s,l,o,u,t.autoPad),d=Object.assign({},t);return a?Object.assign(d,{kernelShape:o,strides:s,pads:u,dilations:l,cacheKey:t.cacheKey}):Object.assign(d,{kernelShape:o,strides:s,pads:u,cacheKey:t.cacheKey}),[d,c]},HA={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},Ag={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[0]},zg=(e,t)=>(Ki(t),[e.run({...Ag,get:()=>Lg(t,Ag,!0,HA)},t)]),Ki=e=>{if(!e||1!==e.length)throw Error("Pool ops requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw Error("Invalid input type.")},Mg=(e,t,n,i,a)=>{let o=e.length;if(t.kernelShape.length<=2){let s=t.kernelShape[t.kernelShape.length-1],l=t.strides[t.strides.length-1],u=t.pads[t.pads.length/2-1],c=t.pads[t.pads.length-1],d=e[o-1],p="",h="",f="";if(p=u+c!==0?`
          for (int i = 0; i < ${s}; i++) {
            x[${o} - 1] = indices[${o} - 1] * ${l} - ${u} + i;
            if (x[${o} - 1] < 0 || x[${o} - 1] >= ${d}) {
              pad++;
              continue;
            }
            ${n}
          }`:`
          for (int i = 0; i < ${s}; i++) {
            x[${o} - 1] = indices[${o} - 1] * ${l} - ${u} + i;
            ${n}
          }`,2===t.kernelShape.length){let n=t.kernelShape[t.kernelShape.length-2],i=t.strides[t.strides.length-2],a=t.pads[t.pads.length/2-2],l=t.pads[t.pads.length-2],u=e[o-2];h=a+l!==0?`
            for (int j = 0; j < ${n}; j++) {
              x[${o} - 2] = indices[${o} - 2] * ${i} - ${a} + j;
              if (x[${o} - 2] < 0 || x[${o} - 2] >= ${u}) {
                pad+= ${s};
                continue;
              }
          `:`
            for (int j = 0; j < ${n}; j++) {
              x[${o} - 2] = indices[${o} - 2] * ${i} - ${a} + j;
            `,f=`
          }
        `}return`
        float process(int indices[${o}]) {
          int x[${o}];
          copyVec(indices, x);

          float value = ${a};
          int pad = 0;
          ${h}
          ${p}
          ${f}
          ${i}
          return value;
        }
      `}{let s=ne.size(t.kernelShape),l=ne.computeStrides(t.kernelShape),u=l.length,c=t.pads.length,d=jA(u),p=qi(e,"inputDims"),h=qi(t.pads,"pads"),f=qi(l,"kernelStrides"),g=qi(t.strides,"strides"),m=t.pads.reduce((e,t)=>e+t),y="";return y=m?`
            if (x[j] >= inputDims[j] || x[j] < 0) {
              pad++;
              isPad = true;
              break;
            }
          }
          if (!isPad) {
            ${n}
          }`:`
          }
          ${n}
        `,`
        ${d}
        float process(int indices[${o}]) {
          int x[${o}];
          copyVec(indices, x);
          int offset[${u}];
          int pads[${c}];
          int inputDims[${o}];
          int kernelStrides[${u}];
          int strides[${u}];
          ${h}
          ${p}
          ${g}
          ${f}

          float value = ${a};
          int pad = 0;
          bool isPad = false;
          for (int i = 0; i < ${s}; i++) {
            offsetToIndices(i, kernelStrides, offset);
            isPad = false;
            for (int j = ${o} - ${u}; j < ${o}; j++) {
              x[j] = indices[j] * strides[j - ${o} + ${u}]
                + offset[j - ${o} + ${u}] - pads[j - 2];
              ${y}
          }
          ${i}

          return value;
        }
      `}},qi=(e,t)=>{let n="";for(let i=0;i<e.length;i++)n+=`
      ${t}[${i}] = ${e[i]};
    `;return n},jA=e=>`
  void offsetToIndices(int offset, int[${e}] strides, out int[${e}] indices) {
    if (${e} == 0) {
      return;
    }
    for (int i = 0; i < ${e} - 1; ++i) {
      indices[i] = offset / strides[i];
      offset -= indices[i] * strides[i];
    }
    indices[${e} - 1] = offset;
  }`}),qg=k(()=>{lt(),Ro(),Me(),Ae(),Vr=(e,t,n,i,a)=>{KA(t);let o={name:i,inputNames:["A"],inputTypes:[0]};return[e.run({...o,cacheHint:n.cacheKey,get:()=>qA(e,t,n,i,a,o)},t)]},br=e=>{let t=e.attributes.getInts("axes",[]),n=1===e.attributes.getInt("keepdims",1);return xe({axes:t,keepDims:n})},qA=(e,t,n,i,a,o)=>{let s=[],l=t[0].dims.length||1,u=[],c=ne.normalizeAxes(n.axes,t[0].dims.length),d=a(t,c),p=d[1];for(let e=0;e<t[0].dims.length;e++)c.indexOf(e)>=0||0===c.length?(n.keepDims&&s.push(1),p=`
          for(int j${e} = 0; j${e} < ${t[0].dims[e]}; j${e}++) {
            inputIdx[${e}] = j${e};
            ${p}
          }`):(u.push(`inputIdx[${e}] = outputIdx[${s.length}];`),s.push(t[0].dims[e]));let h=`
      float process(int outputIdx[${s.length||1}]) {
        float value;                 // final result
        int inputIdx[${l}];      // addressing input data
        ${u.join(`
`)}
        ${d[0]}       // init ops for reduce max/min
        ${p}
        ${d[2]}       // final computation for reduce mean
        return value;
      }`;return{...o,output:{dims:s,type:t[0].type,textureType:0},shaderSource:h}},KA=e=>{if(!e||1!==e.length)throw Error("Reduce op requires 1 input.");if(-1===gr.indexOf(e[0].type))throw Error("Invalid input type.")},Fg=(e,t,n)=>Vr(e,t,n,"ReduceSum",()=>["value = 0.0;","value += _A(inputIdx);",""]),Vg=(e,t,n)=>Vr(e,t,n,"ReduceMean",(e,t)=>{let n=1;for(let i=0;i<e[0].dims.length;i++)(t.indexOf(i)>=0||0===t.length)&&(n*=e[0].dims[i]);return["value = 0.0;","value += _A(inputIdx);",`value /= ${n}.;`]}),Gg=(e,t,n)=>Vr(e,t,n,"ReduceMax",(e,t)=>{let n=[];for(let i=0;i<e[0].dims.length;i++)(t.indexOf(i)>=0||0===t.length)&&n.push(`inputIdx[${i}] = 0;`);return[`${n.join(`
`)}
value = _A(inputIdx);`,"value = max(value, _A(inputIdx));",""]}),Ug=(e,t,n)=>Vr(e,t,n,"ReduceMin",(e,t)=>{let n=[];for(let i=0;i<e[0].dims.length;i++)(t.indexOf(i)>=0||0===t.length)&&n.push(`inputIdx[${i}] = 0;`);return[`${n.join(`
`)}
value = _A(inputIdx);`,"value = min(value, _A(inputIdx));",""]}),Wg=(e,t,n)=>Vr(e,t,n,"ReduceProd",()=>["value = 1.0;","value *= _A(inputIdx);",""]),Hg=(e,t,n)=>Vr(e,t,n,"ReduceLogSum",()=>["value = 0.0;","value += _A(inputIdx);","value = log(value);"]),jg=(e,t,n)=>Vr(e,t,n,"ReduceLogSumSquare",()=>["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""])}),Xg=k(()=>{Me(),Kg=(e,t)=>{let n=ne.calculateReshapedDims(t[0].dims,t[1].integerData);return e.session.pack?[e.reshapePacked(t[0],n)]:[e.reshapeUnpacked(t[0],n)]}}),Gl=k(()=>{lt(),Ke(),Ae(),Zg={name:"Upsample",inputNames:["X"],inputTypes:[0]},Fl=(e,t,n)=>(Vl(t,n),[e.run({...Zg,cacheHint:n.cacheKey,get:()=>XA(e,t,n)},t)]),Jg=e=>zo(e,7),Yg=e=>zo(e,9),zo=(e,t)=>{let n=t>=10,i=e.attributes.getString("mode","nearest");if("nearest"!==i&&"linear"!==i&&(t<11||"cubic"!==i))throw Error(`unrecognized mode: ${i}`);let a=[];t<9&&(a=e.attributes.getFloats("scales"),Xi(a,i,n));let o=e.attributes.getFloat("extrapolation_value",0),s=t>10?e.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(-1===["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(s))throw Error(`coordinate_transform_mode '${s}' is not supported`);let l="tf_crop_and_resize"===s,u=l,c="nearest"===i&&t>=11?e.attributes.getString("nearest_mode","round_prefer_floor"):"";if(-1===["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(c))throw Error(`nearest_mode '${c}' is not supported`);let d=e.attributes.getFloat("cubic_coeff_a",-.75),p=0!==e.attributes.getInt("exclude_outside",0);if(p&&"cubic"!==i)throw Error("exclude_outside can be set to 1 only when mode is CUBIC.");let h=t<11||"nearest"===i&&"asymmetric"===s&&"floor"===c,f=0,g=0,m=0;return t>10?e.inputs.length>2?(f=1,g=2,m=3):(g=1,m=2):9===t&&(g=1),xe({opset:t,isResize:n,mode:i,scales:a,extrapolationValue:o,coordinateTransformMode:s,useExtrapolation:u,needRoiInput:l,nearestMode:c,cubicCoefficientA:d,excludeOutside:p,useNearest2xOptimization:h,roiInputIdx:f,scalesInputIdx:g,sizesInputIdx:m})},XA=(e,t,n)=>{let i=ue(e.session.backend.glContext.version),[a,o]=e.calculateTextureWidthAndHeight(t[0].dims,0),s=t[0].dims.map((e,t)=>Math.floor(e*n.scales[t])),[l,u]=e.calculateTextureWidthAndHeight(s,0),c=s.length,d=Array(c),p=Array(c),h=`
      int output_pitches[${c}];
      int input_pitches[${c}];
      `;for(let e=c-1;e>=0;e--)d[e]=e===c-1?1:d[e+1]*s[e+1],p[e]=e===c-1?1:p[e+1]*t[0].dims[e+1],h+=`
        output_pitches[${e}] = ${d[e]};
        input_pitches[${e}] = ${p[e]};
        `;let f=`
      float getInputFloat(int index) {
        vec2 coords = offsetToCoords(index, ${a}, ${o});
        float value = getColorAsFloat(${i.texture2D}(X, coords));
        return value;
      }
      `,g="nearest"===n.mode?`
    ${f}
    float process(int indices[${c}]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${l}, ${u});

      ${h}

      int d, m;
      for (int dim = 0; dim < ${c}; ++dim) {
        d = output_index / output_pitches[dim];
        m = output_index - d * output_pitches[dim];
        output_index = m;

        if (scales[dim] != 1 && d > 0) {
          int d2 = d / scales[dim];
          m = d - d2 * scales[dim];
          d = d2;
        }
        input_index += input_pitches[dim] * d;
      }

      return getInputFloat(input_index);
    }`:4===c?`
    ${f}
    float process(int indices[4]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${l}, ${u});

      ${h}

      int m;
      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m / output_pitches[1];
      m = m - index_of_dim1 * output_pitches[1];
      index_of_dim2 = m / output_pitches[2];
      m = m - index_of_dim2 * output_pitches[2];
      index_of_dim3 = m;

      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;
      index_of_input_dim2 = index_of_dim2 / scales[2];
      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];
      index_of_input_dim3 = index_of_dim3 / scales[3];
      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];

      input_index = index_of_dim0 * input_pitches[0] +
            index_of_dim1 * input_pitches[1] +
            index_of_input_dim2 * input_pitches[2] +
            index_of_input_dim3;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim2 = false;
      if (index_of_input_dim2 == (${t[0].dims[2]} - 1)) {
        // It's the end in dimension 2
        x01 = x00;
        end_of_dim2 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[2]);
      }

      if (index_of_input_dim3 == (input_pitches[2] - 1)) {
        // It's the end in dimension 3
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);
    }`:`
    ${f}
    float process(int indices[2]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${l}, ${u});

      ${h}

      int m;
      int index_of_dim0, index_of_dim1;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m;

      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;
      index_of_input_dim0 = index_of_dim0 / scales[0];
      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];
      index_of_input_dim1 = index_of_dim1 / scales[1];
      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];

      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim0 = false;
      if (index_of_input_dim0 == (${t[0].dims[0]} - 1)) {
        // It's the end in dimension 0
        x01 = x00;
        end_of_dim0 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[0]);
      }

      if (index_of_input_dim1 == (input_pitches[0] - 1)) {
        // It's the end in dimension 1
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);
    }`;return{...Zg,output:{dims:s,type:t[0].type,textureType:0},shaderSource:g,variables:[{name:"scales",type:"int",arrayLength:n.scales.length,data:n.scales.map(e=>Math.ceil(e))}]}},Vl=(e,t)=>{if(!e||t.opset<9&&1!==e.length||t.opset>=9&&t.opset<11&&2!==e.length||t.opset>=11&&e.length<2)throw Error("invalid inputs.");if(t.scales.length>0&&e[0].dims.length!==t.scales.length)throw Error("Invalid input shape.");if("string"===e[0].type)throw Error("Invalid input tensor types.")},Xi=(e,t,n)=>{if(n){for(let t of e)if(t<=0)throw Error("Scale value should be greater than 0.")}else for(let t of e)if(t<1)throw Error("Scale value should be greater than or equal to 1.");if(("linear"===t||"cubic"===t)&&2!==e.length&&(4!==e.length||1!==e[0]||1!==e[1]))throw Error(`'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ${n?"Resize":"Upsample"} opeartor.`)}}),tb=k(()=>{Ke(),Ae(),Nn(),Mr(),Gl(),Ul={name:"Resize",inputNames:["A"],inputTypes:[2]},Wl=(e,t,n)=>(Vl(t,n),[e.run({...Ul,cacheHint:n.cacheKey,get:()=>ZA(e,t,n)},t)]),Qg=e=>zo(e,10),eb=e=>zo(e,11),ZA=(e,t,n)=>{let i=ue(e.session.backend.glContext.version),[a,o]=JA(t,n);if(a.every(e=>1===e)&&"tf_crop_and_resize"!==n.coordinateTransformMode)return{...Ul,output:{dims:o,type:t[0].type,textureType:2},hasMain:!0,shaderSource:`void main() {
                    vec4 v = ${i.texture2D}(X, TexCoords);
                    ${i.output} = v;
                }`};let s=o.length;if(s<2)throw Error(`output dimension should be at least 2, but got ${s}`);let l=o[s-2],u=o[s-1],c=t[0].dims;if(s!==c.length)throw Error(`output dimension should match input ${c.length}, but got ${s}`);let d=c[s-2],p=c[s-1],h=a[s-2],f=a[s-1],g="";if("linear"!==n.mode)throw Error(`resize (packed) does not support mode: '${n.mode}'`);switch(n.coordinateTransformMode){case"asymmetric":g=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return vec4(coords) / scaleWHWH;
                    }
                `;break;case"half_pixel":g=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;
                    }
                `;break;case"pytorch_half_pixel":g=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 fcoords = vec4(coords);
                        return vec4(
                            ${u}.0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,
                            ${l}.0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,
                            ${u}.0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,
                            ${l}.0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0
                          );
                    }
                `;break;case"align_corners":g=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 resized = vec4(${u}.0 - 1.0, ${l}.0 - 1.0, ${u}.0 - 1.0,
                            ${l}.0 - 1.0);
                        vec4 original = vec4(${p}.0 - 1.0, ${d}.0 - 1.0, ${p}.0 - 1.0,
                            ${d}.0 - 1.0);
                        vec4 new_scale = original / resized;
                        return vec4(coords) * new_scale;
                    }
                `;break;default:throw Error(`resize (packed) does not support coordinateTransformMode:                                 '${n.coordinateTransformMode}'`)}let m=bt(s),y=Ln(),b=`
            const vec2 inputWH = vec2(${d}.0, ${p}.0);
            const vec4 scaleWHWH = vec4(float(${h}), float(${f}), float(${h}), float(${f}));
            ${y}
            ${g}
            float getAValue(int x10, int r, int c, int d) {
                return getChannel(getA(x10, r, c, d), vec2(c, d));
            }
            void main() {
                ${m} rc = getOutputCoords();

                int batch = rc[0];
                int depth = rc[1];

                // retrieve the 4 coordinates that is used in the 4 packed output values.
                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);

                // calculate the source index in fraction
                vec4 sourceFrac = getSourceFracIndex(coords);

                // get the lower and upper bound of the 4 values that will be packed into one texel.
                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));
                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));
                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));
                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));

                bool hasNextRow = rc.w < ${l-1};
                bool hasNextCol = rc.z < ${u-1};

                // pack x00, x01, x10, x11's top-left corner into one vec4 structure
                vec4 topLeft = vec4(
                    getAValue(batch, depth, x00.x, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);

                // pack x00, x01, x10, x11's top-right corner into one vec4 structure
                vec4 topRight = vec4(
                    getAValue(batch, depth, x00.x, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);

                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure
                vec4 bottomLeft = vec4(
                    getAValue(batch, depth, x00.z, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);

                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure
                vec4 bottomRight = vec4(
                    getAValue(batch, depth, x00.z, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);

                // calculate the interpolation fraction on u and v direction
                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);
                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));

                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);
                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);
                vec4 newValue = mix(top, bottom, clampFrac.xxzz);

                ${i.output} = vec4(newValue);
            }
        `;return{...Ul,output:{dims:o,type:t[0].type,textureType:2},hasMain:!0,shaderSource:b}},JA=(e,t)=>{let n=e[0].dims,i=t.scales,a;if(0===i.length){let o=e[t.scalesInputIdx];if(o&&0!==o.size){if(e[t.sizesInputIdx])throw Error("Only one of scales or sizes must be provided as input.");i=YA(o,t.mode,t.isResize)}else{let o=e[t.sizesInputIdx];if(!o||0===o.size)throw Error("Either scales or sizes MUST be provided as input.");a=Array.from(o.integerData),i=QA(a,n,t.mode,t.isResize)}}else if(e[t.sizesInputIdx])throw Error("Only one of scales or sizes must be provided as input.");let o=a||n.map((e,t)=>Math.floor(e*i[t]));return[i,o]},YA=(e,t,n)=>{let i=Array.from(e.floatData);return Xi(i,t,n),i},QA=(e,t,n,i)=>{let a=t.length,o=Array(a);for(let n=0,i=a;n<i;n++)if(0===t[n]){if(0!==e[n])throw Error("Input dim is zero but required output dim is non-zero.");o[n]=1}else o[n]=e[n]/t[n];return Xi(o,n,i),o}}),rb=k(()=>{zr(),nb=(e,t)=>(eO(t),[new nt([t[0].dims.length],"int32",void 0,void 0,new Int32Array(t[0].dims))]),eO=e=>{if(!e||1!==e.length)throw Error("Shape requires 1 input.")}}),ub=k(()=>{lt(),Ro(),Me(),Ae(),Hl={name:"Slice",inputNames:["A"],inputTypes:[0]},ob=(e,t,n)=>(tO(t),[e.run({...Hl,cacheHint:n.cacheKey,get:()=>ab(e,t[0],n)},t)]),ib=e=>{let t=e.attributes.getInts("starts"),n=e.attributes.getInts("ends"),i=e.attributes.getInts("axes",[]);return xe({starts:t,ends:n,axes:i})},ab=(e,t,n)=>{let i=0===n.axes.length?t.dims.slice(0).map((e,t)=>t):n.axes,a=ne.normalizeAxes(i,t.dims.length),o=n.starts.map((e,n)=>e>t.dims[a[n]]-1?t.dims[a[n]]:ne.normalizeAxis(e,t.dims[a[n]])),s=n.ends.map((e,n)=>e>t.dims[a[n]]-1?t.dims[a[n]]:ne.normalizeAxis(e,t.dims[a[n]])),l=t.dims.slice(),u=[];for(let e=0;e<a.length;e++)l[a[e]]=s[e]-o[e],o[e]>0&&u.push(`outputIdx[${a[e]}] += ${o[e]};`);let c=`
      float process(int outputIdx[${l.length}]) {
        ${u.join(`
      `)}
        return _A(outputIdx);
      }`;return{...Hl,output:{dims:l,type:t.type,textureType:0},shaderSource:c}},tO=e=>{if(!e||1!==e.length)throw Error("Slice requires 1 input.");if(-1===gr.indexOf(e[0].type))throw Error("Invalid input type.")},sb=(e,t)=>{rO(t);let n=nO(e,t);return[e.run({...Hl,cacheHint:n.cacheKey,get:()=>ab(e,t[0],n)},[t[0]])]},nO=(e,t)=>{if(!e.session.isInitializer(t[1].dataId)||!e.session.isInitializer(t[2].dataId)||t.length>=4&&!e.session.isInitializer(t[3].dataId)||t.length>=5&&!e.session.isInitializer(t[4].dataId))throw Error("dynamic slice attributes are not allowed");if(t.length>=5&&t[4].integerData.some(e=>1!==e))throw Error("currently non-1 steps is not supported for Slice");let n=Array.from(t[1].integerData),i=Array.from(t[2].integerData),a=t.length>=4?Array.from(t[3].integerData):[],o=`${a};${n};${i}`;return{starts:n,ends:i,axes:a,cacheKey:o}},rO=e=>{if(!e||e.length<3||e.length>5)throw Error("Invalid input number.");if("int32"!==e[1].type||1!==e[1].dims.length||"int32"!==e[2].type||1!==e[2].dims.length||e.length>=4&&("int32"!==e[3].type||1!==e[3].dims.length)||e.length>=5&&("int32"!==e[4].type||1!==e[4].dims.length))throw Error("Invalid input type.")}}),yb=k(()=>{lt(),Me(),Ke(),Ae(),ji(),lb={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[0]},cb={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[0,0]},db={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[0,0,0]},pb=(e,t,n)=>{bb(t);let i=t[0].dims.slice(),a=ne.normalizeAxis(n.axis,i.length),o=ne.sizeToDimension(i,a),s=ne.sizeFromDimension(i,a);return gb(e,t,n,o,s)},fb=e=>xe({axis:e.attributes.getInt("axis",1)}),hb=e=>xe({axis:e.attributes.getInt("axis",-1)}),mb=(e,t,n)=>{bb(t);let i=t[0].dims.slice(),a=ne.normalizeAxis(n.axis,i.length),o=i.length,s=a!==o-1,l=[],u=[],c=[],d;s&&((u=Array.from({length:o}).map((e,t)=>t))[a]=o-1,u[o-1]=a,u.map(e=>l.push(i[e])),d=xe({perm:u}),c=Fr(e,t,d));let p=s?ne.sizeToDimension(l,o-1):ne.sizeToDimension(i,o-1),h=s?ne.sizeFromDimension(l,o-1):ne.sizeFromDimension(i,o-1),f=gb(e,s?c:t,n,p,h);return s?Fr(e,f,d):f},gb=(e,t,n,i,a)=>{let o=oO(e,t[0],i,a,[i]),s=e.run({...lb,cacheHint:n.cacheKey,get:()=>o},t),l=iO(e,t[0],i,a,o.output.dims,[i]),u=e.run({...cb,cacheHint:n.cacheKey,get:()=>l},[t[0],s]),c=aO(e,t[0],i,a,o.output.dims,l.output.dims);return[e.run({...db,cacheHint:n.cacheKey,get:()=>c},[t[0],s,u])]},oO=(e,t,n,i,a)=>{let[o,s]=e.calculateTextureWidthAndHeight(t.dims,0),l=a.length;if(n<1||i<1)throw Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==a.length)throw Error("Dimensionality of the output should be 1");if(a[0]!==n)throw Error("Shape of the output should be equal to logical row count");let u=ue(e.session.backend.glContext.version),c=`
      float process(int[${l}] indices) {
        int logical_row_start_offset = indices[0] * ${i};

        float max = getColorAsFloat(${u.texture2D}(A, offsetToCoords(logical_row_start_offset, ${o},
        ${s} )));
        for(int i=1; i<${i}; ++i)
        {
          float current = getColorAsFloat(${u.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${o}, ${s})));
          if(current > max)
          max = current;
        }

        return max;
      }`;return{...lb,output:{dims:a,type:t.type,textureType:0},shaderSource:c}},iO=(e,t,n,i,a,o)=>{let[s,l]=e.calculateTextureWidthAndHeight(t.dims,0),u=o.length;if(n<1||i<1)throw Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==o.length)throw Error("Dimensionality of the output should be 1");if(o[0]!==n)throw Error("Shape of the output should be equal to logical row count");if(1!==a.length)throw Error("Dimensionality of the intermediate results should be 1");if(a[0]!==n)throw Error("Shape of the intermediate results should be equal to logical row count");let c=ue(e.session.backend.glContext.version),d=`
      float process(int[${u}] indices) {
        int logical_row_start_offset = indices[0] * ${i};

        float norm_factor = 0.0;
        float max = _Max(indices);
        for(int i=0; i<${i}; ++i)
        {
          norm_factor += exp(getColorAsFloat(${c.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${s}, ${l}))) - max);
        }

        return norm_factor;
      }`;return{...cb,output:{dims:o,type:t.type,textureType:0},shaderSource:d}},aO=(e,t,n,i,a,o)=>{let[s,l]=e.calculateTextureWidthAndHeight(t.dims,0),u=t.dims.length;if(n<1||i<1)throw Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==a.length||1!==o.length)throw Error("Dimensionality of the intermediate results should be 1");if(a[0]!==n||o[0]!==n)throw Error("Shape of the intermediate results should be equal to logical row count");let c=`
      float process(int[${u}] indices) {

      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)
      int offset = coordsToOffset(TexCoords, ${s}, ${l});

      //determine the logical row for this index
      int logical_row_index[1];
      logical_row_index[0] = offset / ${i};

      float norm_factor = _Norm(logical_row_index);

      // avoid possible division by 0
      // if norm_facor is 0, all elements are zero
      // if so, return 0
      if(norm_factor == 0.0)
        return 0.0;

      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;
    }`;return{...db,output:{dims:t.dims,type:t.type,textureType:0},shaderSource:c}},bb=e=>{if(!e||1!==e.length)throw Error("Softmax requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw Error("Invalid input type")}}),xb=k(()=>{lt(),Me(),Ae(),_b={name:"Split",inputNames:["A"],inputTypes:[0]},vb=(e,t,n)=>{lO(t);let i=ne.normalizeAxis(n.axis,t[0].dims.length),a=sO(e,t,i,n),o=[];for(let s=0;s<a;++s)o.push(e.run({..._b,cacheHint:`${n.cacheKey};${s}`,get:()=>uO(e,t[0],n,i,s)},t));return o},wb=e=>{let t=e.attributes.getInt("axis",0),n=e.attributes.getInts("split",[]),i=e.outputs.length;return xe({axis:t,split:n,numOutputs:i})},sO=(e,t,n,i)=>{let[,a]=Eo.splitShape(t[0].dims,n,i.split,i.numOutputs);return a.length},uO=(e,t,n,i,a)=>{let[o,s]=Eo.splitShape(t.dims,i,n.split,n.numOutputs),l=s[a],u=o[a],c=`
      float process(int indices[${u.length}]) {
        indices[${i}] += ${l};
        return _A(indices);
      }
    `;return{..._b,cacheHint:`${n.cacheKey}:${a}`,output:{dims:u,type:t.type,textureType:0},shaderSource:c}},lO=e=>{if(!e||1!==e.length)throw Error("Split requires one input.");if("int8"!==e[0].type&&"uint8"!==e[0].type&&"int16"!==e[0].type&&"uint16"!==e[0].type&&"int32"!==e[0].type&&"uint32"!==e[0].type&&"float32"!==e[0].type&&"float64"!==e[0].type&&"bool"!==e[0].type)throw Error("Invalid input type.")}}),Sb=k(()=>{Me(),jl=(e,t,n)=>{cO(t);let i=ne.squeezeShape(t[0].dims,n);return[e.reshapeUnpacked(t[0],i)]},Tb=(e,t)=>(dO(t),jl(e,[t[0]],Array.from(t[1].integerData))),Ib=e=>e.attributes.getInts("axes"),cO=e=>{if(!e||1!==e.length)throw Error("Squeeze requires 1 input.");if("string"===e[0].type)throw Error("invalid input tensor types.")},dO=e=>{if(!e||2!==e.length)throw Error("Squeeze requires 2 inputs.");if("int32"!==e[1].type)throw Error("Invalid input type.")}}),Ab=k(()=>{Ke(),Ae(),$b=(e,t)=>{fO(t);let n={name:"Sum",inputNames:t.map((e,t)=>`X${t}`),inputTypes:Array(t.length).fill(0)};return[e.run({...n,get:()=>pO(e,t,n)},t)]},pO=(e,t,n)=>{let i=ue(e.session.backend.glContext.version),a=t[0].dims.slice(),o=`
      void main() {
        vec4 result = ${t.map((e,t)=>`${i.texture2D}(X${t},TexCoords)`).join(" + ")};
        ${i.output} = result;
      }
    `;return{...n,output:{dims:a,type:t[0].type,textureType:0},hasMain:!0,shaderSource:o}},fO=e=>{if(!e||0===e.length)throw Error("Sum requires inputs.");let t=e[0].dims.length;for(let n=1;n<e.length;n++){if(t!==e[n].dims.length)throw Error("Input shapes are mismatched.");for(let i=0;i<t;i++)if(e[0].dims[i]!==e[n].dims[i])throw Error("Input shapes are not matched.")}if("float32"!==e[0].type&&"float64"!==e[0].type)throw Error("Invalid input type.");for(let t=1;t<e.length;t++)if(e[0].type!==e[t].type)throw Error("Input types are not matched.")}}),Pb=k(()=>{Ro(),Ae(),Ob=(e,t)=>{mO(t);let n={name:"Tile",inputNames:["A"],inputTypes:[0]};return[e.run({...n,get:()=>hO(e,t,n)},t)]},hO=(e,t,n)=>{let i=t[0].dims.slice(),a=Array(i.length),o=[];for(let e=0;e<i.length;e++)a[e]=i[e]*t[1].numberData[e],o.push(`inputIdx[${e}] = int(mod(float(outputIdx[${e}]), ${i[e]}.));`);let s=a.length,l=`
      float process(int outputIdx[${s}]) {
        int inputIdx[${s}];
        ${o.join(`
`)}
        return _A(inputIdx);
      }
    `;return{...n,output:{dims:a,type:t[0].type,textureType:0},shaderSource:l}},mO=e=>{if(!e||2!==e.length)throw Error("Tile requires 2 input.");if(1!==e[1].dims.length)throw Error("The second input shape must 1 dimension.");if(e[1].dims[0]!==e[0].dims.length)throw Error("Invalid input shape.");if(-1===gr.indexOf(e[0].type))throw Error("Invalid input type.");if("int32"!==e[1].type&&"int16"!==e[1].type)throw Error("Invalid repeat type.")}}),Db=k(()=>{Me(),ql=(e,t,n)=>{gO(t);let i=ne.unsqueezeShape(t[0].dims,n);return[e.reshapeUnpacked(t[0],i)]},Eb=(e,t)=>(bO(t),ql(e,[t[0]],Array.from(t[1].integerData))),Cb=e=>e.attributes.getInts("axes"),gO=e=>{if(!e||1!==e.length)throw Error("Unsqueeze requires 1 input.");if("string"===e[0].type)throw Error("invalid input tensor types.")},bO=e=>{if(!e||2!==e.length)throw Error("Unsqueeze requires 2 inputs.");if("int32"!==e[1].type)throw Error("Invalid input type.")}}),Nb=k(()=>{Wh(),rm(),am(),pm(),Ui(),Xm(),tg(),og(),sg(),dg(),hg(),yg(),xg(),Wi(),$g(),Bg(),qg(),Xg(),tb(),rb(),ub(),yb(),xb(),Sb(),Ab(),Pb(),ji(),El(),Db(),Gl(),kb=[["Abs","","6+",fm],["Acos","","7+",hm],["Add","","7+",Hh],["And","","7+",jh],["Asin","","7+",mm],["Atan","","7+",gm],["AveragePool","","7+",Og,Pg],["BatchNormalization","","7+",Gh,Uh],["Cast","","6+",om,im],["Ceil","","6+",_m],["Clip","","6-10",Ol,bm],["Clip","","11+",ym],["Concat","","4+",lm,dm],["Conv","","1+",Rl,zl],["ConvTranspose","","1+",qm,Km],["Cos","","7+",vm],["Div","","7+",qh],["Dropout","","7+",Pl],["DepthToSpace","","1+",Qm,eg],["Equal","","7+",Kh],["Elu","","6+",wm,xm],["Exp","","6+",Tm],["Flatten","","1+",ng,rg],["Floor","","6+",Im],["FusedConv","com.microsoft","1+",Rl,zl],["Gather","","1+",ig,ag],["Gemm","","7-10",Ml,lg],["Gemm","","11+",Ml,cg],["GlobalAveragePool","","1+",Cg,Dg],["GlobalMaxPool","","1+",zg],["Greater","","7+",Xh],["Identity","","1+",Pl],["ImageScaler","","1+",pg,fg],["InstanceNormalization","","6+",gg,bg],["LeakyRelu","","6+",Sm,$m],["Less","","7+",Zh],["LRN","","1+",_g,vg],["Log","","6+",Am],["MatMul","","1+",Fm,Vm],["MaxPool","","1+",kg,Ng],["Mul","","7+",Jh],["Neg","","6+",Om],["Not","","1+",Pm],["Or","","7+",Yh],["Pad","","2-10",Bl,Tg],["Pad","","11+",Ig,Sg],["Pow","","7+",Qh],["PRelu","","7+",em],["ReduceLogSum","","1+",Hg,br],["ReduceMax","","1+",Gg,br],["ReduceMean","","1+",Vg,br],["ReduceMin","","1+",Ug,br],["ReduceProd","","1+",Wg,br],["ReduceSum","","1-12",Fg,br],["ReduceSumSquare","","1+",jg,br],["Relu","","6+",Em],["Reshape","","5+",Kg],["Resize","","10",Wl,Qg],["Resize","","11+",Wl,eb],["Shape","","1+",nb],["Sigmoid","","6+",Cm],["Sin","","7+",Dm],["Slice","","10+",sb],["Slice","","1-9",ob,ib],["Softmax","","1-12",pb,fb],["Softmax","","13+",mb,hb],["Split","","2-12",vb,wb],["Sqrt","","6+",km],["Squeeze","","1-12",jl,Ib],["Squeeze","","13+",Tb],["Sub","","7+",tm],["Sum","","6+",$b],["Tan","","7+",Nm],["Tanh","","6+",Lm],["Tile","","6+",Ob],["Transpose","","1+",Fr,Jm],["Upsample","","7-8",Fl,Jg],["Upsample","","9",Fl,Yg],["Unsqueeze","","1-12",ql,Cb],["Unsqueeze","","13+",Eb],["Xor","","7+",nm]]});function Rb(e){let t={},n;for(;null!==(n=Lb.exec(e));){let e=n[3].split(",").map(e=>{let t=e.trim().split(" ");return t&&2===t.length?{type:t[0],name:t[1]}:null}).filter(e=>null!==e);t[n[2]]={params:e,body:n[4]}}for(let i in t){let a=RegExp(yO.replace("__FUNC__",i),"gm");for(;null!==(n=a.exec(e));){let a=n[1],o=n[2],s=n[3].split(","),l=a?`${a} ${o};`:"",u=t[i].body,c="";t[i].params.forEach((e,t)=>{e&&(c+=`${e.type} ${e.name} = ${s[t]};
`)}),u=(u=`${c}
 ${u}`).replace("return",`${o} = `);let d=`
      ${l}
      {
        ${u}
      }
      `;e=e.replace(n[0],d)}}return e.replace(Lb,"")}var Lb,yO,zb=k(()=>{Lb=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm,yO="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;"});function uo(e,t){let n=[],i=[],a=null!=t&&Array.isArray(t)&&0===t.length,o=null==t||a?null:_O(t,e).sort(),s=0;for(let t=0;t<e.length;++t){if(null!=o){if(o[s]===t&&1!==e[t])throw Error(`Can't squeeze axis ${t} since its dim '${e[t]}' is not 1`);(null==o[s]||o[s]>t)&&1===e[t]&&(n.push(e[t]),i.push(t)),o[s]<=t&&s++}1!==e[t]&&(n.push(e[t]),i.push(t))}return{newShape:n,keptDims:i}}function _O(e,t){let n=t.length;return no((e=null==e?t.map((e,t)=>t):[].concat(e)).every(e=>e>=-n&&e<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),no(e.every(vO),()=>`All values in axis param must be integers but got axis ${e}`),e.map(e=>e<0?n+e:e)}function vO(e){return e%1==0}function wO(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function Mb(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}var Zi,Ji,Yi,Qi,ea,ta,Xl,na,ra,oa,ia,Kl=k(()=>{Ct(),Me(),Zi=class{constructor(e){this.maxTextureSize=e}computeTextureWH(e,t){let n=this.computeTexture(e,t);return t&&t.isPacked&&(n[0]/=2,n[1]/=2),t&&t.reverseWH?[n[1],n[0]]:n}computeTexture(e,t){let n=t&&t.isPacked;if(0===e.length)return n?[2,2]:[1,1];let i=this.maxTextureSize;if(t&&void 0!==t.breakAxis){let n=t.breakAxis>=e.length?1:e.slice(t.breakAxis).reduce((e,t)=>e*t),a=t.breakAxis<=0?1:e.slice(0,t.breakAxis).reduce((e,t)=>e*t);if(!(n>i)&&!(a>i))return[n,a];Fe.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${e}, breakAxis:${t.breakAxis}`)}let a=e.slice(0);n&&(i*=2,1===(a=a.map((e,t)=>t>=a.length-2?a[t]%2==0?a[t]:a[t]+1:a[t])).length&&(a=[2,a[0]])),2!==a.length&&(a=uo(a).newShape);let o=wO(a);return a.length<=1&&o<=i?[1,o]:2===a.length&&a[0]<=i&&a[1]<=i?a:3===a.length&&a[0]*a[1]<=i&&a[2]<=i?[a[0]*a[1],a[2]]:3===a.length&&a[0]<=i&&a[1]*a[2]<=i?[a[0],a[1]*a[2]]:4===a.length&&a[0]*a[1]*a[2]<=i&&a[3]<=i?[a[0]*a[1]*a[2],a[3]]:4===a.length&&a[0]<=i&&a[1]*a[2]*a[3]<=i?[a[0],a[1]*a[2]*a[3]]:n?Mb(o/4).map(e=>2*e):Mb(o)}}}),Bb=k(()=>{Me(),Jn(),Ke(),Kl(),Nn(),Ji=class extends zt{constructor(e){super(e)}getFunctions(){return{...this.offsetToCoords(),...this.coordsToOffset(),...this.toVec(),...this.valueFrom(),...this.getCommonUtilFuncs(),...this.getInputsSamplingSnippets(),...this.getOutputSamplingSnippet()}}getCustomTypes(){return{}}offsetToCoords(){let e="offsetToCoords";return{offsetToCoords:new Y(`
      vec2 ${e}(int offset, int width, int height) {
        int t = offset / width;
        int s = offset - t*width;
        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);
        return coords;
      }
      `)}}coordsToOffset(){let e="coordsToOffset";return{coordsToOffset:new Y(`
      int ${e}(vec2 coords, int width, int height) {
        float s = coords.s * float(width);
        float t = coords.t * float(height);
        int offset = int(t) * width + int(s);
        return offset;
      }
      `)}}getOutputSamplingSnippet(){let e=this.context.outputTextureLayout;return e.isPacked?this.getPackedOutputSamplingSnippet(e):this.getUnpackedOutputSamplingSnippet(e)}getPackedOutputSamplingSnippet(e){let t=e.unpackedShape,n=[e.width,e.height],i={},a="getOutputCoords";switch(t.length){case 0:i[a]=this.getOutputScalarCoords();break;case 1:i[a]=this.getOutputPacked1DCoords(t,n);break;case 2:i[a]=this.getOutputPacked2DCoords(t,n);break;case 3:i[a]=this.getOutputPacked3DCoords(t,n);break;default:i[a]=this.getOutputPackedNDCoords(t,n)}let o=`
      void setOutput(vec4 val) {
        ${ue(this.context.glContext.version).output} = val;
      }
    `;return i.floatTextureSetRGBA=new Y(o),i}getUnpackedOutputSamplingSnippet(e){let t=e.unpackedShape,n=[e.width,e.height],i={},a="getOutputCoords";switch(t.length){case 0:i[a]=this.getOutputScalarCoords();break;case 1:i[a]=this.getOutputUnpacked1DCoords(t,n);break;case 2:i[a]=this.getOutputUnpacked2DCoords(t,n);break;case 3:i[a]=this.getOutputUnpacked3DCoords(t,n);break;case 4:i[a]=this.getOutputUnpacked4DCoords(t,n);break;case 5:i[a]=this.getOutputUnpacked5DCoords(t,n);break;case 6:i[a]=this.getOutputUnpacked6DCoords(t,n);break;default:throw Error(`Unsupported output dimensionality: ${t.length}`)}let o=`
        void setOutput(float val) {
          ${ue(this.context.glContext.version).output} = vec4(val, 0, 0, 0);
        }
    `;return i.floatTextureSetR=new Y(o),i}getOutputScalarCoords(){return new Y(`
      int getOutputCoords() {
        return 0;
      }
    `)}getOutputPacked1DCoords(e,t){let n=t,i="";return i=1===n[0]?`
          int getOutputCoords() {
            return 2 * int(TexCoords.y * ${n[1]}.0);
          }
        `:1===n[1]?`
          int getOutputCoords() {
            return 2 * int(TexCoords.x * ${n[0]}.0);
          }
        `:`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                 vec2(${n[0]}, ${n[1]}));
          return 2 * (resTexRC.y * ${n[0]} + resTexRC.x);
        }
      `,new Y(i)}getOutputPacked2DCoords(e,t){let n="";if(kr.arraysEqual(e,t))return n=`
        ivec2 getOutputCoords() {
          return 2 * ivec2(TexCoords.xy * vec2(${t[0]}, ${t[1]}));
        }
      `,new Y(n);let i=t,a=Math.ceil(e[1]/2);return n=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${i[0]}, ${i[1]}));

          int index = resTexRC.y * ${i[0]} + resTexRC.x;

          // reverse r and c order for packed texture
          int r = imod(index, ${a}) * 2;
          int c = 2 * (index / ${a});

          return ivec2(r, c);
        }
      `,new Y(n)}getOutputPacked3DCoords(e,t){let n=[t[0],t[1]],i=Math.ceil(e[2]/2),a=i*Math.ceil(e[1]/2),o=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${n[0]}, ${n[1]}));
          int index = resTexRC.y * ${n[0]} + resTexRC.x;

          int b = index / ${a};
          index -= b * ${a};

          // reverse r and c order for packed texture
          int r = imod(index, ${i}) * 2;
          int c = 2 * (index / ${i});

          return ivec3(b, r, c);
        }
      `;return new Y(o)}getOutputPackedNDCoords(e,t){let n=[t[0],t[1]],i=Math.ceil(e[e.length-1]/2),a=i*Math.ceil(e[e.length-2]/2),o=a,s="",l="b, r, c";for(let t=2;t<e.length-1;t++)o*=e[e.length-t-1],s=`
      int b${t} = index / ${o};
      index -= b${t} * ${o};
    `+s,l=`b${t}, `+l;let u=`
      ivec${e.length} getOutputCoords() {
        ivec2 resTexRC = ivec2(TexCoords.xy *
                              vec2(${n[0]}, ${n[1]}));
        int index = resTexRC.y * ${n[0]} + resTexRC.x;

        ${s}

        int b = index / ${a};
        index -= b * ${a};

        // reverse r and c order for packed texture
        int r = imod(index, ${i}) * 2;
        int c = 2 * (index / ${i});

        return ivec${e.length}(${l});
      }
    `;return new Y(u)}getOutputUnpacked1DCoords(e,t){let n=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${t[0]}, ${t[1]}));
          return resTexRC.y * ${t[0]} + resTexRC.x;
        }
      `;return new Y(n)}getOutputUnpacked2DCoords(e,t){let n=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${t[0]}, ${t[1]}));
          int index = resTexRC.y * ${t[0]} + resTexRC.x;
          int r = index / ${e[1]};
          int c = index - r * ${e[1]};
          return ivec2(r, c);
        }
      `;return new Y(n)}getOutputUnpacked3DCoords(e,t){let n="",i=e.length,a=null;i<2&&(a=[]),(a=Array(i-1))[i-2]=e[i-1];for(let t=i-3;t>=0;--t)a[t]=a[t+1]*e[t+1];let o=["r","c","d"],s=a.map((e,t)=>{let n=`int ${o[t]} = index / ${e}`,i=t===a.length-1?`int ${o[t+1]} = index - ${o[t]} * ${e}`:`index -= ${o[t]} * ${e}`;return`${n}; ${i};`}).join("");return n=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${t[0]}, ${t[1]}));
          int index = resTexRC.y * ${t[0]} + resTexRC.x;
          ${s}
          return ivec3(r, c, d);
        }
      `,new Y(n)}getOutputUnpacked4DCoords(e,t){let n="",i=e.length,a=null;i<2&&(a=[]),(a=Array(i-1))[i-2]=e[i-1];for(let t=i-3;t>=0;--t)a[t]=a[t+1]*e[t+1];let o=["r","c","d","d2"],s=a.map((e,t)=>{let n=`int ${o[t]} = index / ${e}`,i=t===a.length-1?`int ${o[t+1]} = index - ${o[t]} * ${e}`:`index -= ${o[t]} * ${e}`;return`${n}; ${i};`}).join("");return n=`
      ivec4 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${t[0]}, ${t[1]}));
          int index = resTexRC.y * ${t[0]} + resTexRC.x;
          ${s}
          return ivec4(r, c, d, d2);
        }
      `,new Y(n)}getOutputUnpacked5DCoords(e,t){let n="",i=e.length,a=null;i<2&&(a=[]),(a=Array(i-1))[i-2]=e[i-1];for(let t=i-3;t>=0;--t)a[t]=a[t+1]*e[t+1];let o=["r","c","d","d2","d3"],s=a.map((e,t)=>{let n=`int ${o[t]} = index / ${e}`,i=t===a.length-1?`int ${o[t+1]} = index - ${o[t]} * ${e}`:`index -= ${o[t]} * ${e}`;return`${n}; ${i};`}).join("");return n=`
      ivec5 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${t[0]}, ${t[1]}));
          int index = resTexRC.y * ${t[0]} + resTexRC.x;
          ${s}
          return ivec5(r, c, d, d2, d3);
        }
      `,new Y(n)}getOutputUnpacked6DCoords(e,t){let n="",i=e.length,a=null;i<2&&(a=[]),(a=Array(i-1))[i-2]=e[i-1];for(let t=i-3;t>=0;--t)a[t]=a[t+1]*e[t+1];let o=["r","c","d","d2","d3","d4"],s=a.map((e,t)=>{let n=`int ${o[t]} = index / ${e}`,i=t===a.length-1?`int ${o[t+1]} = index - ${o[t]} * ${e}`:`index -= ${o[t]} * ${e}`;return`${n}; ${i};`}).join("");return n=`
     ivec6 getOutputCoords() {
         ivec2 resTexRC = ivec2(TexCoords.xy *
                               vec2(${t[0]}, ${t[1]}));
         int index = resTexRC.y * ${t[0]} + resTexRC.x;
         ${s}
         return ivec6(r, c, d, d2, d3, d4);
       }
     `,new Y(n)}getCommonUtilFuncs(){let e={},t="uvFromFlat";e[t]=new Y(`
    vec2 uvFromFlat(int texNumR, int texNumC, int index) {
      int texC = index / texNumR;
      int texR = index - texC * texNumR;
      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to
      //       v.
      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);
    }
    `),e[t="packedUVfrom1D"]=new Y(`
      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
        int texelIndex = index / 2;
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),e[t="packedUVfrom2D"]=new Y(`
      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {
        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),e[t="packedUVfrom3D"]=new Y(`
      vec2 packedUVfrom3D(int texNumR, int texNumC,
          int texelsInBatch, int texelsInLogicalRow, int b,
          int row, int col) {
        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = index / texNumC;
        int texC = index - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),t="sampleTexture";let n=ue(this.context.glContext.version);return e[t]=new Y(`
        float sampleTexture(sampler2D textureSampler, vec2 uv) {
            return ${n.texture2D}(textureSampler, uv).r;
        }`),e}getInputsSamplingSnippets(){let e={},t=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach((n,i)=>{let a=this.context.inputTextureLayouts[i],o=Ri(n);a.isPacked?e[o]=this.getPackedSamplerFromInput(o,n,a):e[o]=this.getUnpackedSamplerFromInput(o,n,a);let s=$h(n);a.unpackedShape.length<=t.unpackedShape.length&&(a.isPacked?e[s]=this.getPackedSamplerAtOutputCoords(s,a,t,n):e[s]=this.getUnpackedSamplerAtOutputCoords(s,a,t,n))}),e}getPackedSamplerAtOutputCoords(e,t,n,i){let a=t.unpackedShape,o=n.unpackedShape,s=Ri(i),l=a.length,u=o.length,c=gt.getBroadcastDims(a,o),d=bt(u),p=u-l,h,f=qt();h=0===l?"":u<2&&c.length>=1?"coords = 0;":c.map(e=>`coords.${f[e+p]} = 0;`).join(`
`);let g="";g=u<2&&l>0?"coords":a.map((e,t)=>`coords.${f[t+p]}`).join(", ");let m="return outputValue;",y=1===ne.size(a),b=1===ne.size(o);if(1!==l||y||b){if(y&&!b)m=1===u?`
          return vec4(outputValue.x, outputValue.x, 0., 0.);
        `:`
          return vec4(outputValue.x);
        `;else if(c.length){let e=l-2,t=l-1;c.indexOf(e)>-1&&c.indexOf(t)>-1?m="return vec4(outputValue.x);":c.indexOf(e)>-1?m="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":c.indexOf(t)>-1&&(m="return vec4(outputValue.xx, outputValue.zz);")}}else m=`
        return vec4(outputValue.xy, outputValue.xy);
      `;let v=`
        int lastDim = coords.${f[u-1]};
        coords.${f[u-1]} = coords.${f[u-2]};
        coords.${f[u-2]} = lastDim;
      `,x=`
      vec4 ${e}() {
        ${d} coords = getOutputCoords();
        ${v}
        ${h}
        vec4 outputValue = ${s}(${g});
        ${m}
      }
    `;return new Y(x,["coordinates.getOutputCoords"])}getUnpackedSamplerAtOutputCoords(e,t,n,i){let a=[n.width,n.height],o=[t.width,t.height],s=t.unpackedShape.length,l=n.unpackedShape.length,u=t.unpackedShape,c=n.unpackedShape,d=Ri(i);if(s===l&&kr.arraysEqual(o,a)){let t=`
          float ${e}() {
            return sampleTexture(${i}, TexCoords);
          }
        `;return new Y(t,["coordinates.sampleTexture"])}let p=bt(l),h=gt.getBroadcastDims(u,c),f=l-s,g,m=qt();g=0===s?"":l<2&&h.length>=1?"coords = 0;":h.map(e=>`coords.${m[e+f]} = 0;`).join(`
`);let y="";y=l<2&&s>0?"coords":t.unpackedShape.map((e,t)=>`coords.${m[t+f]}`).join(", ");let b=`
        float ${e}() {
          ${p} coords = getOutputCoords();
          ${g}
          return ${d}(${y});
        }
      `;return new Y(b,["coordinates.getOutputCoords"])}getPackedSamplerFromInput(e,t,n){switch(n.unpackedShape.length){case 0:return this.getPackedSamplerScalar(e,t);case 1:return this.getPackedSampler1D(e,t,n);case 2:return this.getPackedSampler2D(e,t,n);case 3:return this.getPackedSampler3D(e,t,n);default:return this.getPackedSamplerND(e,t,n)}}getUnpackedSamplerFromInput(e,t,n){let i=n.unpackedShape;switch(i.length){case 0:return this.getUnpackedSamplerScalar(e,t,n);case 1:return this.getUnpackedSampler1D(e,t,n);case 2:return this.getUnpackedSampler2D(e,t,n);case 3:return this.getUnpackedSampler3D(e,t,n);case 4:return this.getUnpackedSampler4D(e,t,n);case 5:return this.getUnpackedSampler5D(e,t,n);case 6:return this.getUnpackedSampler6D(e,t,n);default:throw Error(`Unsupported dimension ${i.length}-D`)}}getPackedSamplerScalar(e,t){let n=ue(this.context.glContext.version),i=`
          vec4 ${e}() {
            return ${n.texture2D}(${t}, halfCR);
          }
        `;return new Y(i)}getPackedSampler1D(e,t,n){let i=[n.width,n.height],a=[i[1],i[0]],o=ue(this.context.glContext.version),s=`vec4 ${e}(int index) {
      vec2 uv = packedUVfrom1D(
      ${a[0]}, ${a[1]}, index);
      return ${o.texture2D}(${t}, uv);
    }`;return new Y(s,["coordinates.packedUVfrom1D"])}getPackedSampler2D(e,t,n){let i=n.unpackedShape,a=[n.width,n.height],o=ue(this.context.glContext.version),s=a[0],l=a[1];if(null!=a&&kr.arraysEqual(i,a)){let n=`vec4 ${e}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${l}.0, ${s}.0);
        return ${o.texture2D}(${t}, uv);
      }`;return new Y(n)}let u=a,c=Math.ceil(i[1]/2),d=`vec4 ${e}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u[1]}, ${u[0]}, ${c}, row, col);
      return ${o.texture2D}(${t}, uv);
    }`;return new Y(d,["coordinates.packedUVfrom2D"])}getPackedSampler3D(e,t,n){let i=n.unpackedShape,a=[n.width,n.height],o=[a[0],a[1]],s=ue(this.context.glContext.version);if(1===i[0]){let a=i.slice(1),o=[1,2],s=ro(i,a),l=["b","row","col"],u=JSON.parse(JSON.stringify(n));u.unpackedShape=s;let c=this.getPackedSamplerFromInput(e,t,u),d=`${c.routineBody}
      vec4 ${e}(int b, int row, int col) {
        return ${e}(${oo(l,o)});
      } `;return new Y(d,c.dependencies)}let l=o[0],u=o[1],c=Math.ceil(i[2]/2),d=c*Math.ceil(i[1]/2),p=`vec4 ${e}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${u}, ${l}, ${d}, ${c}, b, row, col);
      return ${s.texture2D}(${t}, uv);}`;return new Y(p,["coordinates.packedUVfrom3D"])}getPackedSamplerND(e,t,n){let i=n.unpackedShape,a=i.length,o=[n.width,n.height],s=ue(this.context.glContext.version),l=[o[0],o[1]],u=l[1],c=l[0],d=Math.ceil(i[a-1]/2),p=d*Math.ceil(i[a-2]/2),h="int b, int row, int col",f=`b * ${p} + (row / 2) * ${d} + (col / 2)`;for(let e=2;e<a-1;e++)h=`int b${e}, `+h,p*=i[a-e-1],f=`b${e} * ${p} + `+f;let g=`vec4 ${e}(${h}) {
      int index = ${f};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${s.texture2D}(${t}, uv);
    }`;return new Y(g)}getUnpackedSamplerScalar(e,t,n){let[i,a]=[n.width,n.height];if(1===i&&1===a){let n=`
          float ${e}() {
            return sampleTexture(${t}, halfCR);
          }
        `;return new Y(n,["coordinates.sampleTexture"])}let o=`
        float ${e}() {
          int offset_${t} = coordsToOffset(TexCoords, ${i}, ${a});
          vec2 uv = uvFromFlat(${i}, ${a}, offset_${t});
          return sampleTexture(${t}, uv);
        }
      `;return new Y(o,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler1D(e,t,n){let i=n.width,a=n.height;if(1===a&&1===i){let n=`
        float ${e}(int index) {
          return sampleTexture(${t}, halfCR);
        }
      `;return new Y(n,["coordinates.sampleTexture"])}if(1===a){let n=`
          float ${e}(int index) {
            vec2 uv = vec2((float(index) + 0.5) / ${i}.0, 0.5);
            return sampleTexture(${t}, uv);
          }
        `;return new Y(n,["coordinates.sampleTexture"])}if(1===i){let n=`
          float ${e}(int index) {
            vec2 uv = vec2(0.5, (float(index) + 0.5) / ${a}.0);
            return sampleTexture(${t}, uv);
          }
        `;return new Y(n,["coordinates.sampleTexture"])}let o=`
        float ${e}(int index) {
          vec2 uv = uvFromFlat(${i}, ${a}, index);
          return sampleTexture(${t}, uv);
        }
      `;return new Y(o,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler2D(e,t,n){let i=n.unpackedShape,a=[n.height,n.width];if(null!=a&&kr.arraysEqual(i,a)){let n=a[1],i=a[0],o=`
          float ${e}(int row, int col) {
            vec2 uv = (vec2(row, col) + halfCR) / vec2(${n}.0, ${i}.0);
            return sampleTexture(${t}, uv);
          }
        `;return new Y(o,["coordinates.sampleTexture"])}let{newShape:o,keptDims:s}=uo(i),l=o;if(l.length<i.length){let a=ro(i,l),o=JSON.parse(JSON.stringify(n));o.unpackedShape=a;let u=["col","row"],c=`
          ${this.getUnpackedSamplerFromInput(e,t,o).routineBody}
          float ${e}(int row, int col) {
            return ${e}(${oo(u,s)});
          }
        `;return new Y(c,["coordinates.sampleTexture"])}let u=a[1],c=a[0];if(1===c){let n=`
          float ${e}(int row, int col) {
            int offset_${t} = coordsToOffset(TexCoords, ${u}, ${c});
            float index = dot(vec3(row, col, offset_${t}), vec3(${i[1]}, 1, 1));
            vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
            return sampleTexture(${t}, uv);
          }
        `;return new Y(n,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(1===u){let n=`
          float ${e}(int row, int col) {
            int offset_${t} = coordsToOffset(TexCoords, ${u}, ${c});
            float index = dot(vec3(row, col, offset_${t}), vec3(${i[1]}, 1, 1));
            vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
            return sampleTexture(${t}, uv);
          }
        `;return new Y(n,["coordinates.sampleTexture","coordinates.coordsToOffset"])}let d=`
        float ${e}(int row, int col) {
          int index = col * ${i[1]} + row;
          vec2 uv = uvFromFlat(${u}, ${c}, index);
          return sampleTexture(${t}, uv);
        }
      `;return new Y(d,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler3D(e,t,n){let i=n.unpackedShape,a=i[1]*i[2],o=i[2],{newShape:s,keptDims:l}=uo(i),u=s;if(u.length<i.length){let a=ro(i,u),o=["batch","col","row"],s=JSON.parse(JSON.stringify(n));s.unpackedShape=a;let c=this.getUnpackedSamplerFromInput(e,t,s),d=l.reverse(),p=`
          ${c.routineBody}
          float ${e}(int batch, int row, int col) {
            return ${e}(${oo(o,d)});
          }
        `;return new Y(p,c.dependencies)}let c=n.width,d=n.height,p=`
          float ${e}(int depth, int row, int col) {
            // Explicitly use integer operations as dot() only works on floats.
            int index = depth * ${a} + col * ${o} + row;
            vec2 uv = uvFromFlat(${c}, ${d}, index);
            return sampleTexture(${t}, uv);
          }
      `;return new Y(p,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler4D(e,t,n){let i=n.unpackedShape,a=i[3],o=i[2]*a,s=i[1]*o,l=n.width,u=n.height,c=`
        float ${e}(int row, int col, int depth, int depth2) {
          int index = row * ${s} + col * ${o} +
              depth2 * ${a} + depth;
          vec2 uv = uvFromFlat(${l}, ${u}, index);
          return sampleTexture(${t}, uv);
        }
      `;return new Y(c,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler5D(e,t,n){let i=n.unpackedShape,a=i[4],o=i[3]*a,s=i[2]*o,l=i[1]*s,{newShape:u,keptDims:c}=uo(i);if(u.length<i.length){let a=ro(i,u),o=["row","col","depth","depth2","depth3"],s=JSON.parse(JSON.stringify(n));s.unpackedShape=a;let l=`
          ${this.getUnpackedSamplerFromInput(e,t,s).routineBody}
          float ${e}(int row, int col, int depth, int depth2, int depth3) {
            return ${e}(${oo(o,c)});
          }
        `;return new Y(l,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let d=n.width,p=n.height,h=`
        float ${e}(int row, int col, int depth, int depth2, int depth3) {
          int index = row * ${l} + col * ${s} + depth * ${o} +
          depth3 * ${a} + depth2;
          vec2 uv = uvFromFlat(${d}, ${p}, index);
          return sampleTexture(${t}, uv);
        }
      `;return new Y(h,["coordinates.sampleTexture","coordinates.uvFromFlat"])}getUnpackedSampler6D(e,t,n){let i=n.unpackedShape,a=i[5],o=i[4]*a,s=i[3]*o,l=i[2]*s,u=i[1]*l,{newShape:c,keptDims:d}=uo(i);if(c.length<i.length){let a=ro(i,c),o=["row","col","depth","depth2","depth3","depth4"],s=JSON.parse(JSON.stringify(n));s.unpackedShape=a;let l=`
            ${this.getUnpackedSamplerFromInput(e,t,s).routineBody}
            float ${e}(int row, int col, int depth,
              int depth2, int depth3, int depth4) {
              return ${e}(${oo(o,d)});
            }
          `;return new Y(l,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let p=n.width,h=n.height,f=`
          float ${e}(int row, int col, int depth,
            int depth2, int depth3, int depth4) {
            int index = row * ${u} + col * ${l} + depth * ${s} +
            depth2 * ${o} + depth3 * ${a} + depth4;
            vec2 uv = uvFromFlat(${p}, ${h}, index);
            return sampleTexture(${t}, uv);
          }
        `;return new Y(f,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}toVec(){let e=this.context.outputTextureLayout,t=e.shape.length,n=e.strides,i=e.width,a=e.height,o=[];for(let e=0;e<t-1;++e)o.push(`
        c[${e}] = offset / ${n[e]};`),o.push(`
        offset -= c[${e}] * ${n[e]};`);o.push(`
        c[${t-1}] = offset;`);let s=`
      void toVec(vec2 texCoords, out int c[${t}]) {
        int offset = coordsToOffset(texCoords, ${i}, ${a});
        ${o.join("")}
      }
      void toVec(int offset, out int c[${t}]) {
        ${o.join("")}
      }
    `;return{toVec:new Y(s,["coordinates.coordsToOffset"])}}valueFrom(){let e={};return this.context.programInfo.inputNames.forEach((t,n)=>{let i=this.context.inputTextureLayouts[n],a=(i.unpackedShape.length>0?i.unpackedShape:i.shape).length,o=`_${t}`;e[o]=new Y(this.getValueFromSingle(t,a,i.width,i.height,!1),[`shapeUtils.indicesToOffset${o}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),e[o+="_T"]=new Y(this.getValueFromSingle(t,a,i.width,i.height,!0),[`shapeUtils.indicesToOffset${o}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])}),e}getValueFromSingle(e,t,n,i,a){let o=`_${e}`;a&&(o+="_T");let s=ue(this.context.glContext.version);return`
        float ${o}(int m[${t}]) {
          int offset = indicesToOffset${o}(m);
          vec2 coords = offsetToCoords(offset, ${n}, ${i});
          float value = getColorAsFloat(${s.texture2D}(${e}, coords));
          return value;
        }
        `}getPackedValueFrom(e,t,n,i,a){let o=`_${e}_Pack`;a&&(o+="_T");let s=ue(this.context.glContext.version);return`
        vec4 ${o}(int m[${t}]) {
          int offset = indicesToOffset_${e}(m);
          vec2 coords = offsetToCoords(offset, ${n}, ${i});
          return ${s.texture2D}(${e}, coords);
        }
        `}}}),Fb=k(()=>{Jn(),Yi=class e extends zt{constructor(e){super(e)}getFunctions(){return{...this.encodeFloat32(),...this.decodeFloat32()}}getCustomTypes(){return{}}encodeFloat32(){return{encode:new Y(`highp vec4 encode(highp float f) {
        return vec4(f, 0.0, 0.0, 0.0);
      }
        `)}}decodeFloat32(){return{decode:new Y(`highp float decode(highp vec4 rgba) {
        return rgba.r;
      }
        `)}}encodeUint8(){let t=e.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new Y(`
      highp vec4 encode(highp float f) {
        highp float F = abs(f);
        highp float Sign = step(0.0,-f);
        highp float Exponent = floor(log2(F));
        highp float Mantissa = (exp2(- Exponent) * F);
        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));
        highp vec4 rgba;
        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));
        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);
        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));
        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));
        ${t}
        rgba = rgba / 255.0; // values need to be normalized to [0,1]
        return rgba;
    }
        `)}}decodeUint8(){let t=e.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new Y(`
        highp float decode(highp vec4 rgba) {
          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]
          ${t}
          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;
          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;
          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);
          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));
          return Result;
      }
        `)}}static isLittleEndian(){let e=new ArrayBuffer(4),t=new Uint32Array(e),n=new Uint8Array(e);if(t[0]=0xdeadbeef,239===n[0])return!0;if(222===n[0])return!1;throw Error("unknown endianness")}}}),Vb=k(()=>{Jn(),Ke(),Qi=class extends zt{constructor(e){super(e)}getFunctions(){return{...this.setFragColor(),...this.getColorAsFloat()}}getCustomTypes(){return{}}setFragColor(){let e=ue(this.context.glContext.version);return{setFragColor:new Y(`
        void setFragColor(float value) {
            ${e.output} = encode(value);
        }
        `,["encoding.encode"])}}getColorAsFloat(){return{getColorAsFloat:new Y(`
        float getColorAsFloat(vec4 color) {
            return decode(color);
        }
        `,["encoding.decode"])}}}}),Gb=k(()=>{Jn(),ea=class e extends zt{constructor(e){super(e)}getFunctions(){return{...this.bcastIndex(),...this.bcastMatmulIndex(),...this.offsetToIndices(),...this.indicesToOffset(),...this.incrementIndices()}}getCustomTypes(){return{}}bcastIndex(){let e=this.context.outputTextureLayout.shape.length,t={};return this.context.programInfo.inputNames.forEach((n,i)=>{let a=this.context.inputTextureLayouts[i].unpackedShape;if(a.length<=e){let i=a.length,o=e-i,s=`bcastIndices_${n}`,l="";for(let e=0;e<i;++e)l+=`
          realIndices[${e}] = int( mod(float(bcastedIndices[${o+e}]), ${a[e]}.0) );
          `;let u=`
        void ${s} (int bcastedIndices[${e}], out int realIndices[${i}]) {
          ${l}
        }
        `;t[s]=new Y(u)}}),t}bcastMatmulIndex(){let e=this.context.outputTextureLayout.shape.length,t={};return this.context.programInfo.inputNames.forEach((n,i)=>{let a=this.context.inputTextureLayouts[i].shape;if(!(a.length<2||a.length>e)){let i=a.length,o=e-i,s=`bcastMatmulIndices_${n}`,l="";for(let e=0;e<i-2;++e)l+=`
          realIndices[${e}] = int( mod(float(bcastedIndices[${o+e}]), ${a[e]}.0) );
          `;let u=`
        void ${s}(int bcastedIndices[${e}], out int realIndices[${i}]) {
          ${l}
          realIndices[${i-1}] = bcastedIndices[${e-1}];
          realIndices[${i-2}] = bcastedIndices[${e-2}];
        }
        `;t[s]=new Y(u)}}),t}indicesToOffset(){let t={};return this.context.programInfo.inputNames.forEach((n,i)=>{let a=this.context.inputTextureLayouts[i].shape,o=this.context.inputTextureLayouts[i].strides,s=a.length,l=`indicesToOffset_${n}`;t[l]=new Y(e.indexToOffsetSingle(l,s,o)),t[l=`indicesToOffset_${n}_T`]=new Y(e.indexToOffsetSingle(l,s,o.slice().reverse()))}),t}static indexToOffsetSingle(e,t,n){let i="";for(let e=t-1;e>=0;--e)i+=`
        offset += indices[${e}] * ${n[e]};
        `;return`
      int ${e}(int indices[${t}]) {
        int offset = 0;
        ${i}
        return offset;
      }
      `}offsetToIndices(){let t={};return this.context.programInfo.inputNames.forEach((n,i)=>{let a=this.context.inputTextureLayouts[i].shape,o=this.context.inputTextureLayouts[i].strides,s=a.length,l=`offsetToIndices_${n}`;t[l]=new Y(e.offsetToIndicesSingle(l,s,o)),t[l=`offsetToIndices_${n}_T`]=new Y(e.offsetToIndicesSingle(l,s,o.slice().reverse()))}),t}static offsetToIndicesSingle(e,t,n){let i=[];for(let e=0;e<t-1;++e)i.push(`
      indices[${e}] = offset / ${n[e]};`),i.push(`
        offset -= indices[${e}] * ${n[e]};`);return i.push(`
      indices[${t-1}] = offset;`),`
      void ${e}(int offset, out int indices[${t}]) {
        ${i.join("")}
      }
      `}incrementIndices(){let e={};return this.context.programInfo.inputNames.forEach((t,n)=>{let i=this.context.inputTextureLayouts[n].shape,a=i.length,o=`incrementIndices_${t}`,s="";for(let e=0;e<a;++e)s+=`
        shape[${e}] = ${i[e]};`;let l=`
        void ${o}(int axis, out int indices[${a}]) {
          int shape[${a}];
          ${s};
          for(int i = ${a} -1 ; i >= 0; --i) {
            if(i > axis) continue;
            indices[i] += 1;
            if(indices[i] < shape[i]) {
              break;
            }
            indices[i] = 0;
          }
        }
        `;e[o]=new Y(l)}),e}}}),Ub=k(()=>{Jn(),ta=class extends zt{constructor(e){super(e)}getCustomTypes(){return{}}getFunctions(){return{...this.binaryVecFunctions(),...this.copyVec(),...this.setVecItem(),...this.getVecItem()}}binaryVecFunctions(){let e=this.context.outputTextureLayout.shape.length,t={add:"+=",sub:"-=",mul:"*=",div:"/="},n={};for(let i in t){let a=`${i}Vec`,o="";for(let n=0;n<e;++n)o+=`
          dest[${n}] ${t[i]} src[${n}];
          `;let s=`
        void ${a}(int src[${e}], out int dest[${e}]) {
          ${o}
        }
        `;n[a]=new Y(s)}return n}copyVec(){let e=this.context.outputTextureLayout.shape.length,t="";for(let n=0;n<e;++n)t+=`
        dest[${n}] = src[${n}];
        `;let n=`
      void copyVec(int src[${e}], out int dest[${e}]) {
        ${t}
      }
      `;return{copyVec:new Y(n)}}setVecItem(){let e=this.context.outputTextureLayout.shape.length,t=`
        if(index < 0)
            index =${e} + index;
        if (index == 0)
            m[0] = value;
        `;for(let n=1;n<e-1;++n)t+=`
        else if (index == ${n})
            m[${n}] = value;
            `;t+=`
        else
            m[${e-1}] = value;
        `;let n=`
      void setVecItem(out int m[${e}], int index, int value) {
        ${t}
      }
        `;return{setVecItem:new Y(n)}}getVecItem(){let e=this.context.outputTextureLayout.shape.length,t=`
        if(index < 0)
            index = ${e} + index;
        if (index == 0)
            return m[0];
      `;for(let n=1;n<e-1;++n)t+=`
        else if (index == ${n})
            return m[${n}];
      `;t+=`
        else
            return m[${e-1}];
        `;let n=`
      int getVecItem(int m[${e}], int index) {
        ${t}
      }
    `;return{getVecItem:new Y(n)}}}}),Wb=k(()=>{Bb(),Fb(),Vb(),Gb(),Ub(),Xl={encoding:Yi,fragcolor:Qi,vec:ta,shapeUtils:ea,coordinates:Ji}}),Hb=k(()=>{Jn(),zb(),Wb(),Ke(),na=class{constructor(e,t,n,i){this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new Fi(e,t,n,i),Object.keys(Xl).forEach(e=>{let t=new Xl[e](this.context);this.libs[e]=t});let a=this.glslLibRoutineDependencyGraph;for(let e in this.libs){let t=this.libs[e].getFunctions();for(let n in t){let i=e+"."+n,o;a[i]?(o=a[i]).routineBody=t[n].routineBody:(o=new Lo(i,t[n].routineBody),a[i]=o);let s=t[n].dependencies;if(s)for(let e=0;e<s.length;++e)if(a[s[e]])o.addDependency(a[s[e]]);else{let t=new Lo(s[e]);a[s[e]]=t,o.addDependency(t)}}}}preprocess(){let e=this.context.programInfo,t=e.shaderSource;return this.context.programInfo.hasMain||(t=`${t}
      ${Sh(this.context.glContext.version,this.context.outputTextureLayout.shape.length)}`),t=Rb(t),`${Ih(this.context.glContext.version)}
    ${this.getUniforms(e.inputNames,e.variables)}
    ${this.getImports(t)}
    ${t}`}getImports(e){let t=this.selectGlslLibRoutinesToBeIncluded(e);if(0===t.length)return"";let n="";for(let e=0;e<t.length;++e)if(t[e].routineBody)n+=t[e].routineBody+`
`;else throw Error(`Missing body for the Glsl Library routine: ${t[e].name}`);return n}selectGlslLibRoutinesToBeIncluded(e){let t=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach(n=>{let i=n.split(".")[1];-1!==e.indexOf(i)&&t.push(this.glslLibRoutineDependencyGraph[n])}),Vi.returnOrderedNodes(t)}getUniforms(e,t){let n=[];if(e)for(let t of e)n.push(`uniform sampler2D ${t};`);if(t)for(let e of t)n.push(`uniform ${e.type} ${e.name}${e.arrayLength?`[${e.arrayLength}]`:""};`);return n.join(`
`)}}}),jb=k(()=>{pt(),Ct(),Hb(),Ke(),ra=class{constructor(e,t,n){this.profiler=e,this.glContext=t,this.textureLayoutStrategy=n,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,n){this.profiler.event("op",`ProgramManager.run ${e.programInfo.name??"unknown kernel"}`,()=>{let i=this.glContext.gl,a=e.program;i.useProgram(a);try{this.bindOutput(n),this.attributesBound||this.bindAttributes(e.attribLocations),this.bindUniforms(e.uniformLocations,e.programInfo.variables??[],t)}catch(t){throw Fe.error("ProgramManager",e.programInfo.shaderSource),t}this.profiler.event("backend","GlContext.draw()",()=>{this.glContext.draw()})},this.glContext)}dispose(){this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach(e=>this.glContext.deleteProgram(e.program))}build(e,t,n){return this.profiler.event("backend","ProgramManager.build",()=>{let i=new na(this.glContext,e,t,n),a=i.preprocess(),o=this.compile(a);return{programInfo:e,program:o,uniformLocations:this.getUniformLocations(o,i.context.programInfo.inputNames,i.context.programInfo.variables),attribLocations:this.getAttribLocations(o)}})}compile(e){if(!this.vertexShader){Fe.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");let e=Th(this.glContext.version);this.vertexShader=this.glContext.compileShader(e,this.glContext.gl.VERTEX_SHADER)}me.debug&&Fe.verbose("ProrgramManager",`FragShader:
${e}
`);let t=this.glContext.compileShader(e,this.glContext.gl.FRAGMENT_SHADER),n=this.glContext.createProgram(this.vertexShader,t);return this.glContext.deleteShader(t),n}bindOutput(e){let t=e.width,n=e.height;Fe.verbose("ProrgramManager",`Binding output texture to Framebuffer: w/h=${t}/${n}, shape=${e.shape}, type=${e.tensor.type}`),this.glContext.attachFramebuffer(e.texture,t,n)}bindAttributes(e){let t=e.position,n=e.textureCoord;this.glContext.setVertexAttributes(t,n),this.attributesBound=!0}bindUniforms(e,t,n){let i=this.glContext.gl,a=0;for(let{name:o,type:s,location:l,arrayLength:u}of e){let e=t.find(e=>e.name===o)?.data;if("sampler2D"!==s&&!e)throw Error(`variable '${o}' does not have data defined in program info`);switch(s){case"sampler2D":this.bindTexture(n[a],l,a),a++;break;case"float":u?i.uniform1fv(l,e):i.uniform1f(l,e);break;case"int":u?i.uniform1iv(l,e):i.uniform1i(l,e);break;default:throw Error(`Uniform not implemented: ${s}`)}}}bindTexture(e,t,n){this.glContext.bindTextureToUniform(e.texture,n,t)}getAttribLocations(e){return{position:this.getAttribLocation(e,"position"),textureCoord:this.getAttribLocation(e,"textureCoord")}}getUniformLocations(e,t,n){let i=[];if(t)for(let n of t)i.push({name:n,type:"sampler2D",location:this.getUniformLocation(e,n)});if(n)for(let t of n)i.push({...t,location:this.getUniformLocation(e,t.name)});return i}getUniformLocation(e,t){let n=this.glContext.gl.getUniformLocation(e,t);if(null===n)throw Error(`Uniform ${t} not found.`);return n}getAttribLocation(e,t){return this.glContext.gl.getAttribLocation(e,t)}}}),qb=k(()=>{Ct(),ko(),oa=class{constructor(e,t,n,i){this.glContext=e,this.layoutStrategy=t,this.profiler=n,this.config=i,this.pendingRead=new Map,i.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}createTextureFromLayout(e,t,n,i){let a=this.toEncoderType(e),o=this.glContext.getEncoder(a,t.channels||1,i);if(t.isPacked&&1===i)throw Error("not implemented");let s=t.width,l=t.height,u,c;if(this.config.reuseTextures){u=`${s}x${l}_${o.format}_${o.internalFormat}_${o.textureType}`,(c=this.inUseTextures.get(u))||(c=[],this.inUseTextures.set(u,c));let t=this.idleTextures.get(u);if(t&&t.length>0){let a=t.pop();return c.push(a),1===i&&this.glContext.updateTexture(a,s,l,o,this.toTextureData(e,n)),a}}Fe.verbose("TextureManager",`Creating new texture of size ${t.width}x${t.height}`);let d=this.glContext.allocateTexture(s,l,o,this.toTextureData(e,n));return this.config.reuseTextures&&(c.push(d),this.textureLookup.set(d,u)),d}readTexture(e,t,n){return n||(n=1),this.profiler.event("backend","TextureManager.readTexture",()=>{let i=e.shape.reduce((e,t)=>e*t)*n,a=this.glContext.readTexture(e.texture,e.width,e.height,i,this.toEncoderType(t),n);return this.toTensorData(t,a)})}async readTextureAsync(e,t,n){let i=e.tensor.dataId;if(n||(n=1),this.pendingRead.has(i)){let e=this.pendingRead.get(i);return new Promise(t=>e?.push(t))}return this.profiler.event("backend","TextureManager.readTextureAsync",async()=>{this.pendingRead.set(i,[]);let a=e.shape.reduce((e,t)=>e*t)*n;await this.glContext.createAndWaitForFence();let o=this.glContext.readTexture(e.texture,e.width,e.height,a,this.toEncoderType(t),n),s=this.toTensorData(t,o),l=this.pendingRead.get(i);return this.pendingRead.delete(i),l?.forEach(e=>e(s)),s})}readUint8TextureAsFloat(e){return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",()=>{let t=e.shape.reduce((e,t)=>e*t),n=this.glContext.readTexture(e.texture,e.width,e.height,4*t,"byte",4);return new Float32Array(n.buffer,n.byteOffset,t)})}releaseTexture(e,t){let n;if(this.config.reuseTextures&&(n=this.textureLookup.get(e.texture))){t&&this.textureLookup.delete(n);let i=this.inUseTextures.get(n);if(i){let t=i.indexOf(e.texture);if(-1!==t){i.splice(t,1);let a=this.idleTextures.get(n);a||(a=[],this.idleTextures.set(n,a)),a.push(e.texture)}}}(!n||t)&&(Fe.verbose("TextureManager",`Deleting texture of size ${e.width}x${e.height}`),this.glContext.deleteTexture(e.texture))}toTensorData(e,t){switch(e){case"int16":return t instanceof Int16Array?t:Int16Array.from(t);case"int32":return t instanceof Int32Array?t:Int32Array.from(t);case"int8":return t instanceof Int8Array?t:Int8Array.from(t);case"uint16":return t instanceof Uint16Array?t:Uint16Array.from(t);case"uint32":return t instanceof Uint32Array?t:Uint32Array.from(t);case"uint8":case"bool":return t instanceof Uint8Array?t:Uint8Array.from(t);case"float32":return t instanceof Float32Array?t:Float32Array.from(t);case"float64":return t instanceof Float64Array?t:Float64Array.from(t);default:throw Error(`TensorData type ${e} is not supported`)}}toTextureData(e,t){if(t)return t instanceof Float32Array?t:new Float32Array(t)}toEncoderType(e){return"float"}clearActiveTextures(){this.glContext.clearActiveTextures()}}}),Kb=k(()=>{Ct(),Rp(),Fh(),Nb(),jb(),Kl(),qb(),ia=class{constructor(e,t){this.backend=e,this.context=t,this.layoutStrategy=new Zi(e.glContext.maxTextureSize),this.programManager=new ra(this.context.profiler,e.glContext,this.layoutStrategy),this.textureManager=new oa(e.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:"full"===e.textureCacheMode}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=e.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}createInferenceHandler(){return new Bi(this)}onGraphInitialized(e){let t=e.getValues().filter(e=>-1===e.from&&e.tensor).map(e=>e.tensor.dataId);this.initializers=new Set(t)}isInitializer(e){return!!this.initializers&&this.initializers.has(e)}addInitializer(e){this.initializers.add(e)}getTextureData(e,t){return t?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}setTextureData(e,t,n=!1){Fe.verbose("WebGLSessionHandler","Storing Texture data in cache"),n?this.packedTextureDataCache.set(e,t):this.unpackedTextureDataCache.set(e,t)}dispose(){this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(e=>this.textureManager.releaseTexture(e,!0)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(e=>this.textureManager.releaseTexture(e,!0)),this.unpackedTextureDataCache=new Map}resolve(e,t,n){let i=Lp(e,t,kb);return{impl:i.opImpl,context:i.opInit?i.opInit(e,n):e}}}});function xO(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}var Mo,Xb=k(()=>{pt(),ko(),ko(),Nn(),Mo=class{constructor(e,t){this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=e,this.version=t,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}allocateTexture(e,t,n,i){let a=this.gl,o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);let s=i?n.encode(i,e*t):null;return a.texImage2D(a.TEXTURE_2D,0,n.internalFormat,e,t,0,n.format,n.textureType,s),this.checkError(),o}updateTexture(e,t,n,i,a){let o=this.gl;o.bindTexture(o.TEXTURE_2D,e);let s=i.encode(a,t*n);o.texSubImage2D(o.TEXTURE_2D,0,0,0,t,n,i.format,i.textureType,s),this.checkError()}attachFramebuffer(e,t,n){let i=this.gl;i.bindTexture(i.TEXTURE_2D,e),i.bindFramebuffer(i.FRAMEBUFFER,this.framebuffer),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0),this.checkError(),i.viewport(0,0,t,n),i.scissor(0,0,t,n)}readTexture(e,t,n,i,a,o){let s=this.gl;o||(o=1),this.frameBufferBound||this.attachFramebuffer(e,t,n);let l=this.getEncoder(a,o),u=l.allocate(t*n);return s.bindTexture(s.TEXTURE_2D,e),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e,0),s.readPixels(0,0,t,n,s.RGBA,l.textureType,u),this.checkError(),l.decode(u,i)}isFramebufferReady(){return!0}getActiveTexture(){let e=this.gl;return`TEXTURE${e.getParameter(this.gl.ACTIVE_TEXTURE)-e.TEXTURE0}`}getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}setVertexAttributes(e,t){let n=this.gl;n.vertexAttribPointer(e,3,n.FLOAT,!1,20,0),n.enableVertexAttribArray(e),-1!==t&&(n.vertexAttribPointer(t,2,n.FLOAT,!1,20,12),n.enableVertexAttribArray(t)),this.checkError()}createProgram(e,t){let n=this.gl,i=n.createProgram();return n.attachShader(i,e),n.attachShader(i,t),n.linkProgram(i),i}compileShader(e,t){let n=this.gl,i=n.createShader(t);if(!i)throw Error(`createShader() returned null with type ${t}`);if(n.shaderSource(i,e),n.compileShader(i),!1===n.getShaderParameter(i,n.COMPILE_STATUS))throw Error(`Failed to compile shader: ${n.getShaderInfoLog(i)}
Shader source:
${e}`);return i}deleteShader(e){this.gl.deleteShader(e)}bindTextureToUniform(e,t,n){let i=this.gl;i.activeTexture(i.TEXTURE0+t),this.checkError(),i.bindTexture(i.TEXTURE_2D,e),this.checkError(),i.uniform1i(n,t),this.checkError()}draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}checkError(){if(me.debug){let e=this.gl,t=e.getError(),n="";switch(t){case e.NO_ERROR:return;case e.INVALID_ENUM:n="INVALID_ENUM";break;case e.INVALID_VALUE:n="INVALID_VALUE";break;case e.INVALID_OPERATION:n="INVALID_OPERATION";break;case e.INVALID_FRAMEBUFFER_OPERATION:n="INVALID_FRAMEBUFFER_OPERATION";break;case e.OUT_OF_MEMORY:n="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:n="CONTEXT_LOST_WEBGL";break;default:n=`Unknown WebGL Error: ${t.toString(16)}`}throw Error(n)}}deleteTexture(e){this.gl.deleteTexture(e)}deleteProgram(e){this.gl.deleteProgram(e)}getEncoder(e,t,n=0){if(2===this.version)return new zi(this.gl,t);switch(e){case"float":return 1===n||this.isRenderFloat32Supported?new Do(this.gl,t):new Do(this.gl,t,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw Error("not implemented");case"byte":return new Mi(this.gl,t);default:throw Error(`Invalid dataType: ${e}`)}}clearActiveTextures(){let e=this.gl;for(let t=0;t<this.maxTextureImageUnits;++t)e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,null)}dispose(){if(this.disposed)return;let e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(this.framebuffer),e.bindBuffer(e.ARRAY_BUFFER,null),e.deleteBuffer(this.vertexbuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.finish(),this.disposed=!0}createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}createVertexbuffer(){let e=this.gl,t=e.createBuffer();if(!t)throw Error("createBuffer() returned null");let n=this.createDefaultGeometry();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),this.checkError(),t}createFramebuffer(){let e=this.gl.createFramebuffer();if(!e)throw Error("createFramebuffer returned null");return e}queryVitalParameters(){let e=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),1===this.version&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.version}getExtensions(){2===this.version?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}checkFloatTextureAttachableToFrameBuffer(){let e=this.gl,t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);let n=2===this.version?e.RGBA32F:e.RGBA;e.texImage2D(e.TEXTURE_2D,0,n,1,1,0,e.RGBA,e.FLOAT,null);let i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0);let a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(t),e.deleteFramebuffer(i),a}checkRenderFloat32(){if(2===this.version){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Download(){if(2===this.version){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Blend(){let e=this.gl,t,n,i,a,o;try{t=e.createTexture(),n=e.createFramebuffer(),e.bindTexture(e.TEXTURE_2D,t);let s=2===this.version?e.RGBA32F:e.RGBA;return e.texImage2D(e.TEXTURE_2D,0,s,1,1,0,e.RGBA,e.FLOAT,null),e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),e.enable(e.BLEND),!!(i=e.createShader(e.VERTEX_SHADER))&&(e.shaderSource(i,"void main(){}"),e.compileShader(i),!!(a=e.createShader(e.FRAGMENT_SHADER)))&&(e.shaderSource(a,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),e.compileShader(a),!!(o=e.createProgram()))&&(e.attachShader(o,i),e.attachShader(o,a),e.linkProgram(o),e.useProgram(o),e.drawArrays(e.POINTS,0,1),e.getError()===e.NO_ERROR)}finally{e.disable(e.BLEND),o&&e.deleteProgram(o),i&&e.deleteShader(i),a&&e.deleteShader(a),n&&(e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(n)),t&&(e.bindTexture(e.TEXTURE_2D,null),e.deleteTexture(t))}}beginTimer(){if(2===this.version&&this.disjointTimerQueryWebgl2Extension){let e=this.gl,t=this.disjointTimerQueryWebgl2Extension,n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}throw Error("WebGL1 profiling currently not supported.")}endTimer(){if(2===this.version&&this.disjointTimerQueryWebgl2Extension){let e=this.gl,t=this.disjointTimerQueryWebgl2Extension;e.endQuery(t.TIME_ELAPSED_EXT);return}throw Error("WebGL1 profiling currently not supported")}isTimerResultAvailable(e){let t=!1,n=!1;if(2===this.version&&this.disjointTimerQueryWebgl2Extension){let i=this.gl,a=this.disjointTimerQueryWebgl2Extension;t=i.getQueryParameter(e,i.QUERY_RESULT_AVAILABLE),n=i.getParameter(a.GPU_DISJOINT_EXT)}else throw Error("WebGL1 profiling currently not supported");return t&&!n}getTimerResult(e){let t=0;if(2===this.version){let n=this.gl;t=n.getQueryParameter(e,n.QUERY_RESULT),n.deleteQuery(e)}else throw Error("WebGL1 profiling currently not supported");return t/1e6}async waitForQueryAndGetTime(e){return await vl(()=>this.isTimerResultAvailable(e)),this.getTimerResult(e)}async createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n=e,i=n.fenceSync(n.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),t=null===i?()=>!0:()=>{let e=n.clientWaitSync(i,0,0);return e===n.ALREADY_SIGNALED||e===n.CONDITION_SATISFIED},{query:i,isFencePassed:t}}async pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){let e=xO(this.itemsToPoll.map(e=>e.isDoneFn));for(let t=0;t<=e;++t){let{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}async addItemToPoll(e,t){this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||await vl(()=>(this.pollItems(),0===this.itemsToPoll.length))}}});function Zl(e){let t;if((!e||"webgl2"===e)&&"webgl2"in lo?t=lo.webgl2:(!e||"webgl"===e)&&"webgl"in lo&&(t=lo.webgl),!t)try{let n=IO();t=Zb(n,e)}catch{t=Zb(TO(),e)}e=e||1===t.version?"webgl":"webgl2";let n=t.gl;return lo[e]=t,n.isContextLost()?(delete lo[e],Zl(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),t)}function Zb(e,t){let n,i={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1};if((!t||"webgl2"===t)&&(n=e.getContext("webgl2",i)))try{return new Mo(n,2)}catch(e){Fe.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl2'. Error: ${e}`)}if((!t||"webgl"===t)&&(n=e.getContext("webgl",i)||e.getContext("experimental-webgl",i)))try{return new Mo(n,1)}catch(e){Fe.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ${e}`)}throw Error("WebGL is not supported")}function TO(){if(typeof document>"u")throw TypeError("failed to create canvas: document is not supported");let e=document.createElement("canvas");return e.width=1,e.height=1,e}function IO(){if(typeof OffscreenCanvas>"u")throw TypeError("failed to create offscreen canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}var lo,aa,Jb=k(()=>{Ct(),Xb(),lo={}}),Yb=k(()=>{pt(),Ct(),Kb(),Jb(),aa=class{get contextId(){return me.webgl.contextId}set contextId(e){me.webgl.contextId=e}get matmulMaxBatchSize(){return me.webgl.matmulMaxBatchSize}set matmulMaxBatchSize(e){me.webgl.matmulMaxBatchSize=e}get textureCacheMode(){return me.webgl.textureCacheMode}set textureCacheMode(e){me.webgl.textureCacheMode=e}get pack(){return me.webgl.pack}set pack(e){me.webgl.pack=e}get async(){return me.webgl.async}set async(e){me.webgl.async=e}initialize(){try{return this.glContext=Zl(this.contextId),"number"!=typeof this.matmulMaxBatchSize&&(this.matmulMaxBatchSize=16),"string"!=typeof this.textureCacheMode&&(this.textureCacheMode="full"),"boolean"!=typeof this.pack&&(this.pack=!1),"boolean"!=typeof this.async&&(this.async=!1),Fe.setWithEnv(me),me.webgl.context||Object.defineProperty(me.webgl,"context",{value:this.glContext.gl}),Fe.verbose("WebGLBackend",`Created WebGLContext: ${typeof this.glContext} with matmulMaxBatchSize: ${this.matmulMaxBatchSize}; textureCacheMode: ${this.textureCacheMode}; pack: ${this.pack}; async: ${this.async}.`),!0}catch(e){return Fe.warning("WebGLBackend",`Unable to initialize WebGLBackend. ${e}`),!1}}createSessionHandler(e){return new ia(this,e)}dispose(){this.glContext.dispose()}}});async function Jl(e){if(!e)return Jl(["webgl"]);for(let t of"string"==typeof e?[e]:e){let e=Qb.get(t);if(e)return e;let n=await $O(t);if(n)return n}throw Error("no available backend to use")}async function $O(e){let t=SO;if("u">typeof t[e]&&AO(t[e])){let n=t[e],i=n.initialize();if("object"==typeof i&&"then"in i&&(i=await i),i)return Qb.set(e,n),n}}function AO(e){let t=e;return"initialize"in t&&"function"==typeof t.initialize&&"createSessionHandler"in t&&"function"==typeof t.createSessionHandler&&"dispose"in t&&"function"==typeof t.dispose}var Qb,SO,Yl,sa,$e,Bo,ec,tc,zn,ua,Ql,oy,iy,la,ca,da,ey=k(()=>{Yb(),Qb=new Map,SO={webgl:new aa}}),ty=k(()=>{Ct(),Yl=class{constructor(e,t){this.op=e,this.node=t}},sa=class{constructor(e,t,n){this.graph=e,this.profiler=n,this.initialize(t)}initialize(e){this.profiler.event("session","ExecutionPlan.initialize",()=>{let t=this.graph.getNodes();if(t.length!==e.length)throw Error("The size of nodes and OPs do not match.");this._ops=e.map((e,n)=>new Yl(e,t[n])),this.reset(),this._starter=[],this._ops.forEach((e,t)=>{let n=!0;for(let t of e.node.inputs)if(!this._values[t]&&-1===this.graph.getInputIndices().indexOf(t)){n=!1;break}n&&this._starter.push(t)})})}reset(){this._values=this.graph.getValues().map(e=>e.tensor)}async execute(e,t){return this.profiler.event("session","ExecutionPlan.execute",async()=>{this.reset();let n=e.createInferenceHandler(),i=this.graph.getInputIndices();if(t.length!==i.length)throw Error(`number of input tensors don't match the number of inputs to the model: actual: ${t.length} expected: ${i.length}`);t.forEach((e,t)=>{let n=i[t];this._values[n]=e});let a=this._starter.slice(0),o=this.graph.getValues(),s=this.graph.getNodes(),l=0;for(;l<a.length;){let e=a[l++],t=this._ops[e],i=t.node.inputs.map(e=>this._values[e]);if(-1!==i.indexOf(void 0))throw Error(`unresolved input detected: op: ${t.node}`);let u=i;Fe.verbose("ExecPlan",`Running op:${t.node.name} (${u.map((e,n)=>`'${t.node.inputs[n]}': ${e.type}[${e.dims.join(",")}]`).join(", ")})`);let c=await this.profiler.event("node",t.node.name,async()=>t.op.impl(n,u,t.op.context));if(c.length!==t.node.outputs.length)throw Error("the size of output does not match model definition.");c.forEach((e,n)=>{let i=t.node.outputs[n];if(this._values[i])throw Error(`output [${i}] already has value: op:${t.node.name}`);this._values[i]=e});let d=new Set;c.forEach((e,n)=>{for(let e of o[t.node.outputs[n]].to){let t=s[e],n=!0;for(let e of t.inputs)if(!this._values[e]){n=!1;break}n&&d.add(e)}}),a.push(...d)}let u=[];for(let e=0;e<this.graph.getOutputIndices().length;e++){let t=this.graph.getOutputIndices()[e],n=this._values[t];if(void 0===n)throw Error(`required output [${t}] does not have value`);0===t?await n.getData():n.data,u.push(n)}return Fe.verbose("ExecPlan","disposing of inferenceHandler"),n.dispose(),u})}}}),ny=k(()=>{$o(),$e=ve(to()),zr(),Me(),Bo=class e{constructor(t){if(this._attributes=new Map,null!=t){for(let n of t)n instanceof $e.onnx.AttributeProto?this._attributes.set(n.name,[e.getValue(n),e.getType(n)]):n instanceof Pi.Attribute&&this._attributes.set(n.name(),[e.getValue(n),e.getType(n)]);if(this._attributes.size<t.length)throw Error("duplicated attribute names")}}set(e,t,n){this._attributes.set(e,[n,t])}delete(e){this._attributes.delete(e)}getFloat(e,t){return this.get(e,"float",t)}getInt(e,t){return this.get(e,"int",t)}getString(e,t){return this.get(e,"string",t)}getTensor(e,t){return this.get(e,"tensor",t)}getFloats(e,t){return this.get(e,"floats",t)}getInts(e,t){return this.get(e,"ints",t)}getStrings(e,t){return this.get(e,"strings",t)}getTensors(e,t){return this.get(e,"tensors",t)}get(e,t,n){let i=this._attributes.get(e);if(void 0===i){if(void 0!==n)return n;throw Error(`required attribute not found: ${e}`)}if(i[1]!==t)throw Error(`type mismatch: expected ${t} but got ${i[1]}`);return i[0]}static getType(e){let t=e instanceof $e.onnx.AttributeProto?e.type:e.type();switch(t){case $e.onnx.AttributeProto.AttributeType.FLOAT:return"float";case $e.onnx.AttributeProto.AttributeType.INT:return"int";case $e.onnx.AttributeProto.AttributeType.STRING:return"string";case $e.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case $e.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case $e.onnx.AttributeProto.AttributeType.INTS:return"ints";case $e.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case $e.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw Error(`attribute type is not supported yet: ${$e.onnx.AttributeProto.AttributeType[t]}`)}}static getValue(e){let t=e instanceof $e.onnx.AttributeProto?e.type:e.type();if(t===$e.onnx.AttributeProto.AttributeType.GRAPH||t===$e.onnx.AttributeProto.AttributeType.GRAPHS)throw Error("graph attribute is not supported yet");let n=this.getValueNoCheck(e);if(t===$e.onnx.AttributeProto.AttributeType.INT&&xt.isLong(n))return xt.longToNumber(n);if(t===$e.onnx.AttributeProto.AttributeType.INTS){let e=n,t=Array(e.length);for(let n=0;n<e.length;n++){let i=e[n];t[n]=xt.longToNumber(i)}return t}if(t===$e.onnx.AttributeProto.AttributeType.TENSOR)return e instanceof $e.onnx.AttributeProto?nt.fromProto(n):nt.fromOrtTensor(n);if(t===$e.onnx.AttributeProto.AttributeType.TENSORS){if(e instanceof $e.onnx.AttributeProto)return n.map(e=>nt.fromProto(e));if(e instanceof Pi.Attribute)return n.map(e=>nt.fromOrtTensor(e))}return t===$e.onnx.AttributeProto.AttributeType.STRING&&e instanceof $e.onnx.AttributeProto?Co(n):t===$e.onnx.AttributeProto.AttributeType.STRINGS&&e instanceof $e.onnx.AttributeProto?n.map(Co):n}static getValueNoCheck(e){return e instanceof $e.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(e):this.getValueNoCheckFromOrtFormat(e)}static getValueNoCheckFromOnnxFormat(e){switch(e.type){case $e.onnx.AttributeProto.AttributeType.FLOAT:return e.f;case $e.onnx.AttributeProto.AttributeType.INT:return e.i;case $e.onnx.AttributeProto.AttributeType.STRING:return e.s;case $e.onnx.AttributeProto.AttributeType.TENSOR:return e.t;case $e.onnx.AttributeProto.AttributeType.GRAPH:return e.g;case $e.onnx.AttributeProto.AttributeType.FLOATS:return e.floats;case $e.onnx.AttributeProto.AttributeType.INTS:return e.ints;case $e.onnx.AttributeProto.AttributeType.STRINGS:return e.strings;case $e.onnx.AttributeProto.AttributeType.TENSORS:return e.tensors;case $e.onnx.AttributeProto.AttributeType.GRAPHS:return e.graphs;default:throw Error(`unsupported attribute type: ${$e.onnx.AttributeProto.AttributeType[e.type]}`)}}static getValueNoCheckFromOrtFormat(e){switch(e.type()){case Lt.AttributeType.FLOAT:return e.f();case Lt.AttributeType.INT:return e.i();case Lt.AttributeType.STRING:return e.s();case Lt.AttributeType.TENSOR:return e.t();case Lt.AttributeType.GRAPH:return e.g();case Lt.AttributeType.FLOATS:return e.floatsArray();case Lt.AttributeType.INTS:{let t=[];for(let n=0;n<e.intsLength();n++)t.push(e.ints(n));return t}case Lt.AttributeType.STRINGS:{let t=[];for(let n=0;n<e.stringsLength();n++)t.push(e.strings(n));return t}case Lt.AttributeType.TENSORS:{let t=[];for(let n=0;n<e.tensorsLength();n++)t.push(e.tensors(n));return t}default:throw Error(`unsupported attribute type: ${Lt.AttributeType[e.type()]}`)}}}}),ry=k(()=>{ny(),$o(),ec=ve(to()),zr(),Me(),tc={from:(e,t)=>new Ql(e,t)},zn=class{constructor(e){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,e&&(this.type=ft.tensorValueTypeFromProto(e.type.tensorType))}get from(){return this._from}get to(){return this._to}},ua=class{constructor(e,t){e instanceof ec.onnx.NodeProto?(this.name=e.name,this.opType=e.opType,this.attributes=new Bo(e.attribute)):e instanceof nl.Node&&(this.name=t??e.name(),this.opType=e.opType(),this.attributes=new Bo(ft.tensorAttributesFromORTFormat(e))),this.inputs=[],this.outputs=[],this.executeNode=!0}},Ql=class{constructor(e,t){if(!e)throw TypeError("graph is empty");this.buildGraph(e),this.transformGraph(t),this.checkIsAcyclic()}getInputIndices(){return this._allInputIndices}getInputNames(){return this._allInputNames}getOutputIndices(){return this._allOutputIndices}getOutputNames(){return this._allOutputNames}getValues(){return this._allData}getNodes(){return this._nodes}buildGraph(e){if(e instanceof ec.onnx.GraphProto)this.buildGraphFromOnnxFormat(e);else if(e instanceof el.Graph)this.buildGraphFromOrtFormat(e);else throw TypeError("Graph type is not supported.")}buildGraphFromOnnxFormat(e){let t=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let n=new Map;if(!e.input)throw Error("missing information in graph: input");let i=[];for(let n of e.input){if(t.has(n.name))throw Error(`duplicated input name: ${n.name}`);let e=this._allData.push(new zn(n))-1;t.set(n.name,e),i.push(n.name)}if(!e.initializer)throw Error("missing information in graph: initializer");for(let n of e.initializer){let e=t.get(n.name);if(void 0===e){let i=new zn;i.type={shape:{dims:ft.tensorDimsFromProto(n.dims)},tensorType:ft.tensorDataTypeFromProto(n.dataType)},e=this._allData.push(i)-1,t.set(n.name,e)}this._allData[e]._from=-1,this._allData[e].tensor=nt.fromProto(n)}for(let e=0;e<this._allData.length;e++)this._allData[e].tensor||(this._allInputIndices.push(e),this._allInputNames.push(i[e]));if(!e.output)throw Error("missing information in graph: output");for(let n of e.output){if(t.has(n.name))throw Error(`duplicated output name: ${n.name}`);let e=this._allData.push(new zn(n))-1;t.set(n.name,e),this._allOutputIndices.push(e),this._allOutputNames.push(n.name)}if(!e.node)throw Error("missing information in graph: node");for(let t of e.node){if(!t.name)for(let e=0;;e++){let i=`unnamed_${t.opType}_${e}`;if(!n.has(i)){t.name=i;break}}if(n.has(t.name))throw Error(`duplicated node name: ${t.name}`);let e=this._nodes.push(new ua(t))-1;n.set(t.name,e)}for(let n=0;n<this._nodes.length;n++){let i=this._nodes[n],a=e.node[n];if(!a.output)throw Error(`missing output for node: ${a.name}`);for(let e of a.output){let o=t.get(e);if(typeof o>"u"&&(o=this._allData.push(new zn)-1,t.set(e,o)),i.outputs.push(o),void 0!==this._allData[o]._from)throw Error(`multiple nodes output to one data value: ${o}`);if(this._allData[o]._from=n,"Constant"===a.opType){if(!a.attribute||1!==a.attribute.length||!a.attribute[0].t)throw Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!a.output||1!==a.output.length)throw Error("missing output or incorrect number of outputs for this Constant operator");i.outputs.pop(),i.executeNode=!1,this._allData[o]._from=-1,this._allData[o].tensor=nt.fromProto(a.attribute[0].t)}}}for(let n=0;n<this._nodes.length;n++){let i=this._nodes[n],a=e.node[n];if(!a.input)throw Error(`missing input for node: ${a.name}`);for(let e of a.input){let o=t.get(e);if(typeof o>"u"){if(""===e&&(3===a.input.length||4===a.input.length)&&"Resize"===a.opType)continue;throw Error(`unrecognized input '${e}' for node: ${a.name}`)}i.inputs.push(o),this._allData[o]._to.push(n)}}return!0}buildGraphFromOrtFormat(e){let t=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let n=new Map,i=[];for(let n=0;n<e.inputsLength();n++){let a=e.inputs(n);if(t.has(a))throw Error(`duplicated input name: ${a}`);for(let n=0;n<e.nodeArgsLength();n++)if(e.nodeArgs(n)?.name()===a){let o=new zn;if(e.nodeArgs(n)?.type()?.valueType()!==ol.TypeInfoValue.tensor_type)throw Error("Unexpected value type for the nodeArg.");let s=e.nodeArgs(n).type().value(new rl.TensorTypeAndShape),l=ft.tensorDataTypeFromProto(s.elemType()),u=s.shape(),c=[];for(let e=0;e<u.dimLength();e++)c.push(xt.longToNumber(u.dim(e).value().dimValue()));o.type={shape:{dims:c},tensorType:l};let d=this._allData.push(o)-1;t.set(a,d),i.push(a)}}for(let n=0;n<e.initializersLength();n++){let i=e.initializers(n),a=t.get(i.name());if(void 0===a){let e=new zn;e.type={shape:{dims:ft.tensorDimsFromORTFormat(i)},tensorType:ft.tensorDataTypeFromProto(i.dataType())},a=this._allData.push(e)-1,t.set(i.name(),a)}this._allData[a]._from=-1,this._allData[a].tensor=nt.fromOrtTensor(i)}for(let e=0;e<this._allData.length;e++)this._allData[e].tensor||(this._allInputIndices.push(e),this._allInputNames.push(i[e]));for(let n=0;n<e.outputsLength();n++){let i=e.outputs(n);if(t.has(i))throw Error(`duplicated output name: ${i}`);let a=this._allData.push(new zn)-1;t.set(i,a),this._allOutputIndices.push(a),this._allOutputNames.push(i)}if(!e.nodes)throw Error("missing information in graph: node");for(let t=0;t<e.nodesLength();t++){let i=e.nodes(t),a=i.name();if(!a)for(let e=0;a=`unnamed_${i.opType()}_${e}`,n.has(a);e++);if(n.has(a))throw Error(`duplicated node name: ${a}`);let o=this._nodes.push(new ua(i,a))-1;n.set(a,o)}for(let n=0;n<this._nodes.length;n++){let i=this._nodes[n],a=e.nodes(n);if(null==a)throw Error(`No node exists at index ${n}`);if(a?.outputsLength()===0)throw Error(`missing output for node: ${a.name}`);for(let e=0;e<a?.outputsLength();e++){let o=a?.outputs(e),s=t.get(o);if(typeof s>"u"&&(s=this._allData.push(new zn)-1,t.set(o,s)),i.outputs.push(s),void 0!==this._allData[s]._from)throw Error(`multiple nodes output to one data value: ${s}`);if(this._allData[s]._from=n,"Constant"===a.opType()){if(1!==a.attributesLength()||!a.attributes(0).t())throw Error("missing attributes or missing tensor value in attributes for this Constant operator");if(1!==a.outputsLength())throw Error("missing output or incorrect number of outputs for this Constant operator");i.outputs.pop(),i.executeNode=!1,this._allData[s]._from=-1,this._allData[s].tensor=nt.fromOrtTensor(a.attributes(0).t())}}}for(let n=0;n<this._nodes.length;n++){let i=this._nodes[n],a=e.nodes(n);if(0===a.inputsLength())throw Error(`missing input for node: ${a.name}`);for(let e=0;e<a.inputsLength();e++){let o=a.inputs(e),s=t.get(o);if(typeof s>"u")throw Error(`unrecognized input '${o}' for node: ${a.name()}`);i.inputs.push(s),this._allData[s]._to.push(n)}}}checkIsAcyclic(){let e=new Set;this._allInputIndices.forEach(t=>{this._allData[t]._to.forEach(t=>{e.add(t)})});let t=Array.from(e),n=Array(this._nodes.length).fill("white");for(;t.length>0;){let e=t.pop();"gray"===n[e]?n[e]="black":(t.push(e),n[e]="gray",this._nodes[e].outputs.forEach(i=>{let a=this._allData[i];if("u">typeof a.tensor)throw Error("node outputs should not be initialized");if(a._from!==e)throw Error("from property of the Value object doesn't match index of Node being processed");a._to.forEach(e=>{if("gray"===n[e])throw Error("model graph is cyclic");"white"===n[e]&&t.push(e)})}))}}transformGraph(e){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),e&&e.transformGraph(this),this.finalizeGraph()}finalizeGraph(){let e=0,t=[this._nodes.length,0],n=0;for(let e=0;e<this._nodes.length;e++)t[e]=n,this._nodes[e].executeNode?(n!==e&&(this._nodes[n]=this._nodes[e]),n++):this._nodes[e].outputs.forEach(e=>{this._allData[e]._from=-2});this._nodes.splice(n,this._nodes.length-n);for(let e=0;e<this._allData.length;e++){let n=this._allData[e];void 0!==n._from&&-1!==n._from&&-2!==n._from&&(n._from=t[n._from]);for(let e=0;e<n._to.length;e++)if(n._to[e]>=0)n._to[e]=t[n._to[e]];else throw Error("Trying to update a removed node")}e=0;for(let t=0;t<this._allData.length;t++){if(-2===this._allData[t].from&&-1===this._allOutputIndices.indexOf(t+e)){e++,this._allData.splice(t,1),t--;continue}if(e>0){let n=-1;void 0!==this._allData[t].from&&-1!==this._allData[t].from?-1!==(n=this._nodes[this._allData[t].from].outputs.indexOf(t+e))&&(this._nodes[this._allData[t].from].outputs[n]=t):-1!==(n=this._allInputIndices.indexOf(t+e))&&(this._allInputIndices[n]=t),this._allData[t].to.forEach(i=>{-1!==(n=this._nodes[i].inputs.indexOf(t+e))&&(this._nodes[i].inputs[n]=t)}),0===this._allData[t].to.length&&-1!==(n=this._allOutputIndices.indexOf(t+e))&&(this._allOutputIndices[n]=t)}}}deleteNode(e){let t=this._nodes[e];if(t.outputs.length>1){for(let e=1;e<t.outputs.length;e++)if(this._allData[t.outputs[e]].to.length>0)throw Error("Node deletion with more than one output connected to other nodes is not supported. ")}t.executeNode=!1;let n=t.inputs[0],i=t.outputs[0],a=this._allData[i].to;for(let n=0;n<t.inputs.length;n++){let i=this._allData[t.inputs[n]].to.indexOf(e);if(-1===i)throw Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[t.inputs[n]].to.splice(i,1)}this._allData[i]._to=[];let o=this._allOutputIndices.indexOf(i);if(-1!==o&&(this._allOutputIndices[o]=n),a&&a.length>0)for(let e of a){let t=this._nodes[e].inputs.indexOf(i);if(-1===t)throw Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[e].inputs[t]=n,this._allData[n].to.push(e)}}removeAllDropoutNodes(){let e=0;for(let t of this._nodes){if("Dropout"===t.opType){if(1!==t.inputs.length)throw Error("Dropout nodes should only contain one input. ");if(1!==t.outputs.length&&2!==t.outputs.length)throw Error("Dropout nodes should contain either 1 or 2 output(s)");if(2===t.outputs.length&&0!==this._allData[t.outputs[1]]._to.length)throw Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(e)}e++}}removeAllIdentityNodes(){let e=0;for(let t of this._nodes)"Identity"===t.opType&&this.deleteNode(e),e++}isActivation(e){switch(e.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}fuseConvActivationNodes(){for(let e of this._nodes)if("Conv"===e.opType){let t=this._allData[e.outputs[0]]._to;if(1===t.length&&this.isActivation(this._nodes[t[0]])){let n=this._nodes[t[0]];if("Clip"===n.opType)if(1===n.inputs.length)try{e.attributes.set("activation_params","floats",[n.attributes.getFloat("min"),n.attributes.getFloat("max")])}catch{e.attributes.set("activation_params","floats",[Lr,Rr])}else{if(!(n.inputs.length>=3)||void 0===this._allData[n.inputs[1]].tensor||void 0===this._allData[n.inputs[2]].tensor)continue;e.attributes.set("activation_params","floats",[this._allData[n.inputs[1]].tensor.floatData[0],this._allData[n.inputs[2]].tensor.floatData[0]])}e.attributes.set("activation","string",n.opType),this.deleteNode(t[0])}}}}}),ay=k(()=>{oy=ve(ze()),ry(),$o(),iy=ve(to()),Me(),la=class{constructor(){}load(e,t,n){let i;if(!n)try{this.loadFromOnnxFormat(e,t);return}catch(e){if(void 0!==n)throw e;i=e}try{this.loadFromOrtFormat(e,t)}catch(e){throw void 0!==n?e:Error(`Failed to load model as ONNX format: ${i}
as ORT format: ${e}`)}}loadFromOnnxFormat(e,t){let n=iy.onnx.ModelProto.decode(e);if(3>xt.longToNumber(n.irVersion))throw Error("only support ONNX model with IR_VERSION>=3");this._opsets=n.opsetImport.map(e=>({domain:e.domain,version:xt.longToNumber(e.version)})),this._graph=tc.from(n.graph,t)}loadFromOrtFormat(e,t){let n=new oy.ByteBuffer(e),i=tl.InferenceSession.getRootAsInferenceSession(n).model();if(3>xt.longToNumber(i.irVersion()))throw Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(let e=0;e<i.opsetImportLength();e++){let t=i.opsetImport(e);this._opsets.push({domain:t?.domain(),version:xt.longToNumber(t.version())})}this._graph=tc.from(i.graph(),t)}get graph(){return this._graph}get opsets(){return this._opsets}}}),sy=k(()=>{ey(),ty(),Ct(),ay(),ca=class{constructor(e={}){this._initialized=!1,this.backendHint=e.backendHint,this.profiler=mi.create(e.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}get inputNames(){return this._model.graph.getInputNames()}get outputNames(){return this._model.graph.getOutputNames()}startProfiling(){this.profiler.start()}endProfiling(){this.profiler.stop()}async loadModel(e,t,n){await this.profiler.event("session","Session.loadModel",async()=>{let i=await Jl(this.backendHint);if(this.sessionHandler=i.createSessionHandler(this.context),this._model=new la,"string"==typeof e){let t=e.endsWith(".ort");{let n=await (await fetch(e)).arrayBuffer();this.initialize(new Uint8Array(n),t)}}else if(ArrayBuffer.isView(e))this.initialize(e);else{let i=new Uint8Array(e,t||0,n||e.byteLength);this.initialize(i)}})}initialize(e,t){if(this._initialized)throw Error("already initialized");this.profiler.event("session","Session.initialize",()=>{let n=this.sessionHandler.transformGraph?this.sessionHandler:void 0;this._model.load(e,n,t),this.sessionHandler.onGraphInitialized&&this.sessionHandler.onGraphInitialized(this._model.graph),this.initializeOps(this._model.graph),this._executionPlan=new sa(this._model.graph,this._ops,this.profiler)}),this._initialized=!0}async run(e){if(!this._initialized)throw Error("session not initialized yet");return this.profiler.event("session","Session.run",async()=>{let t=this.normalizeAndValidateInputs(e),n=await this._executionPlan.execute(this.sessionHandler,t);return this.createOutput(n)})}normalizeAndValidateInputs(e){let t=this._model.graph.getInputNames();if(Array.isArray(e)){if(e.length!==t.length)throw Error(`incorrect input array length: expected ${t.length} but got ${e.length}`)}else{if(e.size!==t.length)throw Error(`incorrect input map size: expected ${t.length} but got ${e.size}`);let n=Array(e.size),i=0;for(let a=0;a<t.length;++a){let o=e.get(t[a]);if(!o)throw Error(`missing input tensor for: '${name}'`);n[i++]=o}e=n}if(this.context.graphInputTypes&&0!==this.context.graphInputTypes.length&&this.context.graphInputDims&&0!==this.context.graphInputDims.length)this.validateInputTensorDims(this.context.graphInputDims,e,!1);else{let t=this._model.graph.getInputIndices(),n=this._model.graph.getValues(),i=Array(t.length);for(let a=0;a<t.length;++a){let o=n[t[a]];i[a]=o.type.shape.dims,this.context.graphInputTypes.push(o.type.tensorType),this.context.graphInputDims.push(e[a].dims)}this.validateInputTensorDims(i,e,!0)}return this.validateInputTensorTypes(this.context.graphInputTypes,e),e}validateInputTensorTypes(e,t){for(let n=0;n<t.length;n++){let i=e[n],a=t[n].type;if(i!==a)throw Error(`input tensor[${n}] check failed: expected type '${i}' but got ${a}`)}}validateInputTensorDims(e,t,n){for(let i=0;i<t.length;i++){let a=e[i],o=t[i].dims;if(!this.compareTensorDims(a,o,n))throw Error(`input tensor[${i}] check failed: expected shape '[${a.join(",")}]' but got [${o.join(",")}]`)}}compareTensorDims(e,t,n){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i]&&(!n||0!==e[i]))return!1;return!0}createOutput(e){let t=this._model.graph.getOutputNames();if(e.length!==t.length)throw Error("expected number of outputs do not match number of generated outputs");let n=new Map;for(let i=0;i<t.length;++i)n.set(t[i],e[i]);return n}initializeOps(e){let t=e.getNodes();this._ops=Array(t.length);for(let n=0;n<t.length;n++)this._ops[n]=this.sessionHandler.resolve(t[n],this._model.opsets,e)}}}),uy=k(()=>{pt(),zr(),da=class{constructor(e){this.session=e,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}get inputMetadata(){throw Error("Getting model metadata is not supported in webgl backend.")}get outputMetadata(){throw Error("Getting model metadata is not supported in webgl backend.")}async dispose(){}async run(e,t,n){let i=new Map;for(let t in e)if(Object.hasOwnProperty.call(e,t)){let n=e[t];i.set(t,new nt(n.dims,n.type,void 0,void 0,n.data))}let a=await this.session.run(i),o={};return a.forEach((e,t)=>{o[t]=new St(e.type,e.data,e.dims)}),o}startProfiling(){this.session.startProfiling()}endProfiling(){this.session.endProfiling()}}}),ly={};$r(ly,{onnxjsBackend:()=>OO});var OO,cy=k(()=>{sy(),uy(),OO=new class{async init(){}async createInferenceSessionHandler(e,t){let n=new ca(t);return await n.loadModel(e),new da(n)}}}),pa=k(()=>{}),fy={};$r(fy,{default:()=>PO});var dy,py,PO,hy=k(()=>{rc(),yr(),fa(),dy="ort-wasm-proxy-worker",(py=globalThis.self?.name===dy)&&(self.onmessage=e=>{let{type:t,in:n}=e.data;try{switch(t){case"init-wasm":ha(n.wasm).then(()=>{ma(n).then(()=>{postMessage({type:t})},e=>{postMessage({type:t,err:e})})},e=>{postMessage({type:t,err:e})});break;case"init-ep":{let{epName:e,env:i}=n;ga(i,e).then(()=>{postMessage({type:t})},e=>{postMessage({type:t,err:e})});break}case"copy-from":{let{buffer:e}=n,i=Fo(e);postMessage({type:t,out:i});break}case"create":{let{model:e,options:i}=n;ba(e,i).then(e=>{postMessage({type:t,out:e})},e=>{postMessage({type:t,err:e})});break}case"release":ya(n),postMessage({type:t});break;case"run":{let{sessionId:e,inputIndices:i,inputs:a,outputIndices:o,options:s}=n;_a(e,i,a,o,Array(o.length).fill(null),s).then(e=>{e.some(e=>"cpu"!==e[3])?postMessage({type:t,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:t,out:e},wa([...a,...e]))},e=>{postMessage({type:t,err:e})});break}case"end-profiling":va(n),postMessage({type:t})}}catch(e){postMessage({type:t,err:e})}}),PO=py?null:e=>new Worker(e??Ot,{type:"module",name:dy})}),gy={};$r(gy,{default:()=>EO});var my,EO,vy,ic,Ot,wy,oc,kO,NO,xy,LO,yy,Ty,_y,Iy,ac,sc,xa,Sy,RO,zO,MO,ha,Be,Pt,Vo,Ne,$y,BO,FO,VO,Ia,GO,Oy,_r,Mn,vr,co,Go,Sa,$a,uc,Uo,UO,WO,Ey,Cy,Aa,HO,_e,cc,Fn,C,Ur,Oa,Dy,ky,Pa,Ly,fc,Ry,jO,Ny,qO,zy,Ea,Ca,pc,My,Da,KO,ka,Vy,hc,mc,XO,ZO,Gy,bc,gc,Wy,yc,ce,Wr,vc,Ve,it,W,Ee,wc,Hr,Kt,Q,La,N,G,jy,Ra,_c,qy,JO,Ky,YO,QO,eP,tP,at,Xy,Zy,nP,rP,oP,iP,aP,sP,uP,lP,cP,dP,Vn,Jy,Yy,Qy,e_,t_,n_,r_,o_,i_,a_,Gn,pP,Ma,xc,Un,fP,hP,mP,gP,bP,yP,_P,vP,wP,xP,Wn,u_,l_,c_,d_,p_,f_,h_,m_,g_,b_,y_,__,v_,Tc,TP,Ic,IP,SP,$P,po,AP,x_,OP,PP,EP,T_,CP,DP,S_,kP,Le,A_,O_,P_,E_,C_,D_,k_,N_,L_,NP,R_,z_,M_,B_,Wo,F_,Fa,V_,G_,U_,W_,H_,j_,q_,K_,X_,Z_,J_,Y_,Q_,ev,tv,nv,rv,ov,Sc,$c,iv,av,sv,LP,RP,uv,zP,MP,cv,BP,FP,Hn,pv,fv,hv,mv,gv,bv,yv,_v,vv,wv,GP,UP,WP,HP,Tv,Iv,Xt,Zt,Jt,Ga,rt,$v,Av,Ho,Wa,jP,qP,Ac,Pv,KP,Oc,XP,jo,ZP,Ev,JP,Dv,qa,YP,kv,QP,Nv,Lv,zv,Mv,eE,Pc,tE,Ec,Cc,Fv,nE,rE,Dc,Gv,oE,iE,aE,Wv,Hv,sE,jv,uE,qv,lE,Xv,Zv,cE,dE,pE,Yv,Qv,kc,Ka,t0,hE,Nc,Lc,n0,mE,r0,o0,gE,a0,bE,yE,s0,_E,l0,vE,wE,d0,p0,xE,h0,m0,TE,IE,b0,y0,SE,$E,v0,w0,AE,OE,T0,I0,Qn,xr,fo,ho,PE,EE,CE,DE,kE,NE,LE,RE,$0,A0,Tt,BE,E0,P0,FE,qo,C0,VE,GE,UE,WE,zc,D0,k0,HE,Xa,N0,jE,qE,L0,KE,R0,M0,XE,ZE,B0,JE,YE,V0,QE,U0,eC,tC,nC,H0,j0,rC,oC,iC,aC,sC,uC,lC,cC,K0,Za,Z0,J0,Y0,Q0,dC,pC,ew,tw,nw,rw,ow,iw,aw,sw,uw,lw,cw,dw,hC,mC,fw,hw,gC,bC,gw,yC,_C,yw,_w,vC,wC,xC,ww,TC,IC,SC,$C,AC,OC,PC,EC,xw,CC,DC,kC,NC,LC,Tw,Iw,RC,zC,$w,MC,Ja,BC,Ow,FC,VC,Pw,Ew,GC,UC,Dw,kw,Lw,WC,HC,jC,Rw,qC,KC,Mw,Fw,Ya,by=k(()=>{EO=my=async function(e={}){var t,n,i=e,a=new Promise((e,i)=>{t=e,n=i}),o="object"==typeof window,s="u">typeof WorkerGlobalScope,l=s&&self.name?.startsWith("em-pthread");i.mountExternalData=(e,t)=>{e.startsWith("./")&&(e=e.substring(2)),(i.Fb||(i.Fb=new Map)).set(e,t)},i.unmountExternalData=()=>{delete i.Fb};var u=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,qc:!0}).buffer.constructor;let c=e=>async(...t)=>{try{if(i.Gb)throw Error("Session already started");let n=i.Gb={ec:t[0],errors:[]},a=await e(...t);if(i.Gb!==n)throw Error("Session mismatch");i.Kb?.flush();let o=n.errors;if(0<o.length){let e=await Promise.all(o);if(e=e.filter(e=>e),0<e.length)throw Error(e.join(`
`))}return a}finally{i.Gb=null}};i.jsepInit=(e,t)=>{if("webgpu"===e){[i.Kb,i.Vb,i.Zb,i.Lb,i.Yb,i.Ab,i.$b,i.bc,i.Wb,i.Xb,i.ac]=t;let e=i.Kb;i.jsepRegisterBuffer=(t,n,i,a)=>e.registerBuffer(t,n,i,a),i.jsepGetBuffer=t=>e.getBuffer(t),i.jsepCreateDownloader=(t,n,i)=>e.createDownloader(t,n,i),i.jsepOnCreateSession=t=>{e.onCreateSession(t)},i.jsepOnReleaseSession=t=>{e.onReleaseSession(t)},i.jsepOnRunStart=t=>e.onRunStart(t),i.cc=(t,n)=>{e.upload(t,n)}}else if("webnn"===e){let e=t[0];[i.oc,i.Ob,i.webnnEnsureTensor,i.Pb,i.webnnDownloadTensor,i.nc,i.webnnEnableTraceEvent]=t.slice(1),i.webnnReleaseTensorId=i.Ob,i.webnnUploadTensor=i.Pb,i.webnnRegisterMLContext=i.nc,i.webnnOnRunStart=t=>e.onRunStart(t),i.webnnOnRunEnd=e.onRunEnd.bind(e),i.webnnOnReleaseSession=t=>{e.onReleaseSession(t)},i.webnnCreateMLTensorDownloader=(t,n)=>e.createMLTensorDownloader(t,n),i.webnnRegisterMLTensor=(t,n,i,a)=>e.registerMLTensor(t,n,i,a),i.webnnCreateMLContext=t=>e.createMLContext(t),i.webnnRegisterMLConstant=(t,n,a,o,s,l)=>e.registerMLConstant(t,n,a,o,s,i.Fb,l),i.webnnRegisterGraphInput=e.registerGraphInput.bind(e),i.webnnIsGraphInput=e.isGraphInput.bind(e),i.webnnRegisterGraphOutput=e.registerGraphOutput.bind(e),i.webnnIsGraphOutput=e.isGraphOutput.bind(e),i.webnnCreateTemporaryTensor=e.createTemporaryTensor.bind(e),i.webnnIsGraphInputOutputTypeSupported=e.isGraphInputOutputTypeSupported.bind(e)}};let d=()=>{let e=(e,t,n)=>(...i)=>{let a=tI,o=t?.();i=e(...i);let s=t?.();return o!==s&&(e=s,n(o),t=n=null),tI!=a?new Promise((e,t)=>{tD={resolve:e,reject:t}}):i};(()=>{for(let t of["_OrtAppendExecutionProvider","_OrtCreateSession","_OrtRun","_OrtRunWithBinding","_OrtBindInput"])i[t]=e(i[t],()=>i[t],e=>i[t]=e)})(),void 0!==c&&(i._OrtRun=c(i._OrtRun),i._OrtRunWithBinding=c(i._OrtRunWithBinding)),d=void 0};i.asyncInit=()=>{d?.()};var p,h,f=(e,t)=>{throw t},g="file:///home/runner/work/kaya/kaya/node_modules/onnxruntime-web/dist/ort.all.bundle.min.mjs",m="";if(o||s){try{m=new URL(".",g).href}catch{}s&&(h=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),p=async e=>{if(j(e))return new Promise((t,n)=>{var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=()=>{200==i.status||0==i.status&&i.response?t(i.response):n(i.status)},i.onerror=n,i.send(null)});var t=await fetch(e,{credentials:"same-origin"});if(t.ok)return t.arrayBuffer();throw Error(t.status+" : "+t.url)}}var y,b,v,x,w,_,S,k,T,C,E,I,$,O,A,N=console.log.bind(console),P=console.error.bind(console),D=N,M=P,z=!1,j=e=>e.startsWith("file://");function R(){return b.buffer!=w.buffer&&q(),w}function L(){return b.buffer!=w.buffer&&q(),_}function F(){return b.buffer!=w.buffer&&q(),S}function B(){return b.buffer!=w.buffer&&q(),k}function U(){return b.buffer!=w.buffer&&q(),T}function V(){return b.buffer!=w.buffer&&q(),C}function G(){return b.buffer!=w.buffer&&q(),E}function H(){return b.buffer!=w.buffer&&q(),O}if(l){let e=function(t){try{var n=t.data,a=n.Db;if("load"===a){let t=[];for(let a of(self.onmessage=e=>t.push(e),self.startWorker=()=>{for(let n of(postMessage({Db:"loaded"}),t))e(n);self.onmessage=e},n.Sb))i[a]&&!i[a].proxy||(i[a]=(...e)=>{postMessage({Db:"callHandler",Rb:a,args:e})},"print"==a&&(D=i[a]),"printErr"==a&&(M=i[a]));b=n.kc,q(),A(n.lc)}else if("run"===a){eb(n.Bb),nK(n.Bb,0,0,1,0,0),eg(),tf(n.Bb),W||(nG(),W=!0);try{ev(n.hc,n.Jb)}catch(e){if("unwind"!=e)throw e}}else"setimmediate"!==n.target&&("checkMailbox"===a?W&&tg():a&&(M(`worker: received unknown command ${a}`),M(n)))}catch(e){throw nX(),e}};var W=!1;self.onunhandledrejection=e=>{throw e.reason||e},self.onmessage=e}function q(){var e=b.buffer;i.HEAP8=w=new Int8Array(e),S=new Int16Array(e),i.HEAPU8=_=new Uint8Array(e),k=new Uint16Array(e),i.HEAP32=T=new Int32Array(e),i.HEAPU32=C=new Uint32Array(e),E=new Float32Array(e),O=new Float64Array(e),I=new BigInt64Array(e),$=new BigUint64Array(e)}function K(){l?startWorker(i):nU.Da()}var X,Z=0,Y=null;function Q(){if(0==--Z&&Y){var e=Y;Y=null,e()}}function J(e){throw M(e="Aborted("+e+")"),z=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),n(e),e}function ee(){return{a:{L:nB,Aa:nF,b:ew,$:eS,A:eE,pa:eI,X:e$,Z:eO,qa:eA,na:eN,ga:eP,ma:eD,J:eM,Y:ez,V:ej,oa:eR,W:eL,va:eB,E:eX,Q:eY,O:e6,D:e8,v:e7,s:e9,P:tn,z:tc,R:td,ja:tp,T:tm,aa:tb,M:tv,F:tx,ia:tf,sa:tw,r:tk,Ca:tT,w:tj,o:tL,m:tU,c:e0,Ba:tV,n:tH,j:tK,u:tX,p:tZ,f:tY,t:tQ,l:tJ,e:t0,k:t1,h:t2,g:t3,d:t4,da:t6,ea:t9,fa:ne,ba:nt,ca:nn,N:na,xa:no,ua:nu,i:np,C:nh,G:nf,ta:ns,x:ng,ra:nm,U:ny,q:ni,y:nb,K:nv,S:nx,za:nk,ya:nT,ka:n$,la:nO,_:eu,B:nA,I:nN,ha:nP,H:nM,a:b,wa:es}}}class et{name="ExitStatus";constructor(e){this.message=`Program terminated with exit(${e})`,this.status=e}}var en=e=>{e.terminate(),e.onmessage=()=>{}},er=[],ei=e=>{0==ec.length&&(ey(),em(ec[0]));var t=ec.pop();if(!t)return 6;ed.push(t),eh[e.Bb]=t,t.Bb=e.Bb;var n={Db:"run",hc:e.fc,Jb:e.Jb,Bb:e.Bb};return t.postMessage(n,e.Nb),0},ea=0,eo=(e,t,...n)=>{for(var i=2*n.length,a=n4(),o=n3(8*i),s=o>>>3,l=0;l<n.length;l++){var u=n[l];"bigint"==typeof u?(I[s+2*l]=1n,I[s+2*l+1]=u):(I[s+2*l]=0n,H()[s+2*l+1>>>0]=u)}return e=nZ(e,0,i,o,t),n2(a),e};function es(e){if(l)return eo(0,1,e);if(x=e,!(0<ea)){for(var t of ed)en(t);for(t of ec)en(t);ec=[],ed=[],eh={},z=!0}f(0,new et(e))}function el(e){if(l)return eo(1,0,e);eu(e)}var eu=e=>{if(x=e,l)throw el(e),"unwind";es(e)},ec=[],ed=[],ep=[],eh={},ef=e=>{var t=e.Bb;delete eh[t],ec.push(e),ed.splice(ed.indexOf(e),1),e.Bb=0,nY(t)};function eg(){ep.forEach(e=>e())}var em=e=>new Promise(t=>{e.onmessage=n=>{var a=(n=n.data).Db;if(n.Hb&&n.Hb!=nH()){var o=eh[n.Hb];o?o.postMessage(n,n.Nb):M(`Internal error! Worker sent a message "${a}" to target pthread ${n.Hb}, but that thread no longer exists!`)}else"checkMailbox"===a?tg():"spawnThread"===a?ei(n):"cleanupThread"===a?ef(eh[n.ic]):"loaded"===a?(e.loaded=!0,t(e)):"setimmediate"===n.target?e.postMessage(n):"callHandler"===a?i[n.Rb](...n.args):a&&M(`worker sent an unknown command ${a}`)},e.onerror=e=>{throw M(`worker sent an error! ${e.filename}:${e.lineno}: ${e.message}`),e};var n,a=[];for(n of[])i.propertyIsEnumerable(n)&&a.push(n);e.postMessage({Db:"load",Sb:a,kc:b,lc:v})});function ey(){var e=new Worker(new URL(__webpack_require__(249),__webpack_require__.b),{type:"module",workerData:"em-pthread",name:"em-pthread"});ec.push(e)}var eb=e=>{q();var t=V()[e+52>>>2>>>0];e=V()[e+56>>>2>>>0],n1(t,t-e),n2(t)},ev=(e,t)=>{ea=0,e=n6(e,t),0<ea?x=e:nQ(e)};class ex{constructor(e){this.Ib=e-24}}function ew(e,t,n){var i=new ex(e>>>=0);throw t>>>=0,n>>>=0,V()[i.Ib+16>>>2>>>0]=0,V()[i.Ib+4>>>2>>>0]=t,V()[i.Ib+8>>>2>>>0]=n,e}function e_(e,t,n,i){return l?eo(2,1,e,t,n,i):eS(e,t,n,i)}function eS(e,t,n,i){if(e>>>=0,n>>>=0,i>>>=0,void 0===u)return 6;var a=[];return l&&0===a.length?e_(e,t>>>=0,n,i):(e={fc:n,Bb:e,Jb:i,Nb:a},l?(e.Db="spawnThread",postMessage(e,a),0):ei(e))}var ek="u">typeof TextDecoder?new TextDecoder:void 0,eT=(e,t=0,n=NaN)=>{var i=(t>>>=0)+n;for(n=t;e[n]&&!(n>=i);)++n;if(16<n-t&&e.buffer&&ek)return ek.decode(e.buffer instanceof ArrayBuffer?e.subarray(t,n):e.slice(t,n));for(i="";t<n;){var a=e[t++];if(128&a){var o=63&e[t++];if((224&a)==192)i+=String.fromCharCode((31&a)<<6|o);else{var s=63&e[t++];65536>(a=(240&a)==224?(15&a)<<12|o<<6|s:(7&a)<<18|o<<12|s<<6|63&e[t++])?i+=String.fromCharCode(a):(a-=65536,i+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else i+=String.fromCharCode(a)}return i},eC=(e,t)=>(e>>>=0)?eT(L(),e,t):"";function eE(e,t,n){return l?eo(3,1,e,t,n):0}function eI(e,t){if(l)return eo(4,1,e,t)}function e$(e,t){if(l)return eo(5,1,e,t)}function eO(e,t,n){if(l)return eo(6,1,e,t,n)}function eA(e,t,n){return l?eo(7,1,e,t,n):0}function eN(e,t){if(l)return eo(8,1,e,t)}function eP(e,t,n){if(l)return eo(9,1,e,t,n)}function eD(e,t,n,i){if(l)return eo(10,1,e,t,n,i)}function eM(e,t,n,i){if(l)return eo(11,1,e,t,n,i)}function ez(e,t,n,i){if(l)return eo(12,1,e,t,n,i)}function ej(e){if(l)return eo(13,1,e)}function eR(e,t){if(l)return eo(14,1,e,t)}function eL(e,t,n){if(l)return eo(15,1,e,t,n)}var eF,eB=()=>J(""),eU=e=>{for(var t="";L()[e>>>0];)t+=eF[L()[e++>>>0]];return t},eV={},eG={},eH={},eW=i.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}};function eq(e,t,n={}){return function(e,t,n={}){var i=t.name;if(!e)throw new eW(`type "${i}" must have a positive integer typeid pointer`);if(eG.hasOwnProperty(e)){if(n.Tb)return;throw new eW(`Cannot register type '${i}' twice`)}eG[e]=t,delete eH[e],eV.hasOwnProperty(e)&&(t=eV[e],delete eV[e],t.forEach(e=>e()))}(e,t,n)}var eK=(e,t,n)=>{switch(t){case 1:return n?e=>R()[e>>>0]:e=>L()[e>>>0];case 2:return n?e=>F()[e>>>1>>>0]:e=>B()[e>>>1>>>0];case 4:return n?e=>U()[e>>>2>>>0]:e=>V()[e>>>2>>>0];case 8:return n?e=>I[e>>>3]:e=>$[e>>>3];default:throw TypeError(`invalid integer width (${t}): ${e}`)}};function eX(e,t,n){n>>>=0,eq(e>>>=0,{name:t=eU(t>>>0),fromWireType:e=>e,toWireType:function(e,t){if("bigint"!=typeof t&&"number"!=typeof t)throw t=null===t?"null":"object"==(e=typeof t)||"array"===e||"function"===e?t.toString():""+t,TypeError(`Cannot convert "${t}" to ${this.name}`);return"number"==typeof t&&(t=BigInt(t)),t},Cb:eZ,readValueFromPointer:eK(t,n,-1==t.indexOf("u")),Eb:null})}var eZ=8;function eY(e,t,n,i){eq(e>>>=0,{name:t=eU(t>>>0),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?n:i},Cb:eZ,readValueFromPointer:function(e){return this.fromWireType(L()[e>>>0])},Eb:null})}var eQ=[],eJ=[];function e0(e){9<(e>>>=0)&&0==--eJ[e+1]&&(eJ[e]=void 0,eQ.push(e))}var e1=e=>{if(!e)throw new eW(`Cannot use deleted val. handle = ${e}`);return eJ[e]},e2=e=>{switch(e){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let t=eQ.pop()||eJ.length;return eJ[t]=e,eJ[t+1]=1,t}};function e3(e){return this.fromWireType(V()[e>>>2>>>0])}var e4={name:"emscripten::val",fromWireType:e=>{var t=e1(e);return e0(e),t},toWireType:(e,t)=>e2(t),Cb:8,readValueFromPointer:e3,Eb:null};function e6(e){return eq(e>>>0,e4)}var e5=(e,t)=>{switch(t){case 4:return function(e){return this.fromWireType(G()[e>>>2>>>0])};case 8:return function(e){return this.fromWireType(H()[e>>>3>>>0])};default:throw TypeError(`invalid float width (${t}): ${e}`)}};function e8(e,t,n){n>>>=0,eq(e>>>=0,{name:t=eU(t>>>0),fromWireType:e=>e,toWireType:(e,t)=>t,Cb:eZ,readValueFromPointer:e5(t,n),Eb:null})}function e7(e,t,n,i,a){if(e>>>=0,n>>>=0,t=eU(t>>>0),-1===a&&(a=0xffffffff),a=e=>e,0===i){var o=32-8*n;a=e=>e<<o>>>o}var s=t.includes("unsigned")?function(e,t){return t>>>0}:function(e,t){return t};eq(e,{name:t,fromWireType:a,toWireType:s,Cb:eZ,readValueFromPointer:eK(t,n,0!==i),Eb:null})}function e9(e,t,n){function i(e){var t=V()[e>>>2>>>0];return e=V()[e+4>>>2>>>0],new a(R().buffer,e,t)}var a=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][t];eq(e>>>=0,{name:n=eU(n>>>0),fromWireType:i,Cb:eZ,readValueFromPointer:i},{Tb:!0})}var te=(e,t,n)=>{var i=L();if(t>>>=0,0<n){var a=t;n=t+n-1;for(var o=0;o<e.length;++o){var s=e.charCodeAt(o);if(55296<=s&&57343>=s&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++o)),127>=s){if(t>=n)break;i[t++>>>0]=s}else{if(2047>=s){if(t+1>=n)break;i[t++>>>0]=192|s>>6}else{if(65535>=s){if(t+2>=n)break;i[t++>>>0]=224|s>>12}else{if(t+3>=n)break;i[t++>>>0]=240|s>>18,i[t++>>>0]=128|s>>12&63}i[t++>>>0]=128|s>>6&63}i[t++>>>0]=128|63&s}}i[t>>>0]=0,e=t-a}else e=0;return e},tt=e=>{for(var t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);127>=i?t++:2047>=i?t+=2:55296<=i&&57343>=i?(t+=4,++n):t+=3}return t};function tn(e,t){eq(e>>>=0,{name:t=eU(t>>>0),fromWireType:function(e){for(var t,n=V()[e>>>2>>>0],i=e+4,a=i,o=0;o<=n;++o){var s=i+o;o!=n&&0!=L()[s>>>0]||(a=eC(a,s-a),void 0===t?t=a:(t+="\0",t+=a),a=s+1)}return nW(e),t},toWireType:function(e,t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var n="string"==typeof t;if(!(n||ArrayBuffer.isView(t)&&1==t.BYTES_PER_ELEMENT))throw new eW("Cannot pass non-string to std::string");var i=n?tt(t):t.length,a=nq(4+i+1),o=a+4;return V()[a>>>2>>>0]=i,n?te(t,o,i+1):L().set(t,o>>>0),null!==e&&e.push(nW,a),a},Cb:eZ,readValueFromPointer:e3,Eb(e){nW(e)}})}var tr="u">typeof TextDecoder?new TextDecoder("utf-16le"):void 0,ti=(e,t)=>{for(var n=e>>1,i=n+t/2;!(n>=i)&&B()[n>>>0];)++n;if(32<(n<<=1)-e&&tr)return tr.decode(L().slice(e,n));for(n="",i=0;!(i>=t/2);++i){var a=F()[e+2*i>>>1>>>0];if(0==a)break;n+=String.fromCharCode(a)}return n},ta=(e,t,n)=>{if(2>(n??=0x7fffffff))return 0;var i=t;n=(n-=2)<2*e.length?n/2:e.length;for(var a=0;a<n;++a){var o=e.charCodeAt(a);F()[t>>>1>>>0]=o,t+=2}return F()[t>>>1>>>0]=0,t-i},to=e=>2*e.length,ts=(e,t)=>{for(var n=0,i="";!(n>=t/4);){var a=U()[e+4*n>>>2>>>0];if(0==a)break;++n,65536<=a?(a-=65536,i+=String.fromCharCode(55296|a>>10,56320|1023&a)):i+=String.fromCharCode(a)}return i},tl=(e,t,n)=>{if(t>>>=0,4>(n??=0x7fffffff))return 0;var i=t;n=i+n-4;for(var a=0;a<e.length;++a){var o=e.charCodeAt(a);if(55296<=o&&57343>=o&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++a)),U()[t>>>2>>>0]=o,(t+=4)+4>n)break}return U()[t>>>2>>>0]=0,t-i},tu=e=>{for(var t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);55296<=i&&57343>=i&&++n,t+=4}return t};function tc(e,t,n){if(e>>>=0,t>>>=0,n=eU(n>>>=0),2===t)var i=ti,a=ta,o=to,s=e=>B()[e>>>1>>>0];else 4===t&&(i=ts,a=tl,o=tu,s=e=>V()[e>>>2>>>0]);eq(e,{name:n,fromWireType:e=>{for(var n,a=V()[e>>>2>>>0],o=e+4,l=0;l<=a;++l){var u=e+4+l*t;l!=a&&0!=s(u)||(o=i(o,u-o),void 0===n?n=o:(n+="\0",n+=o),o=u+t)}return nW(e),n},toWireType:(e,i)=>{if("string"!=typeof i)throw new eW(`Cannot pass non-string to C++ string type ${n}`);var s=o(i),l=nq(4+s+t);return V()[l>>>2>>>0]=s/t,a(i,l+4,s+t),null!==e&&e.push(nW,l),l},Cb:eZ,readValueFromPointer:e3,Eb(e){nW(e)}})}function td(e,t){eq(e>>>=0,{Ub:!0,name:t=eU(t>>>0),Cb:0,fromWireType:()=>{},toWireType:()=>{}})}function tp(e){nK(e>>>0,!s,1,!o,131072,!1),eg()}var th=e=>{if(!z)try{if(e(),!(0<ea))try{l?nQ(x):eu(x)}catch(e){e instanceof et||"unwind"==e||f(0,e)}}catch(e){e instanceof et||"unwind"==e||f(0,e)}};function tf(e){e>>>=0,"function"==typeof Atomics.jc&&(Atomics.jc(U(),e>>>2,e).value.then(tg),e+=128,Atomics.store(U(),e>>>2,1))}var tg=()=>{var e=nH();e&&(tf(e),th(n0))};function tm(e,t){(e>>>=0)==t>>>0?setTimeout(tg):l?postMessage({Hb:e,Db:"checkMailbox"}):(e=eh[e])&&e.postMessage({Db:"checkMailbox"})}var ty=[];function tb(e,t,n,i,a){for(t>>>=0,ty.length=i/=2,n=a>>>0>>>3,a=0;a<i;a++)ty[a]=I[n+2*a]?I[n+2*a+1]:H()[n+2*a+1>>>0];return(t?nL[t]:nR[e])(...ty)}var tv=()=>{ea=0};function tx(e){e>>>=0,l?postMessage({Db:"cleanupThread",ic:e}):ef(eh[e])}function tw(e){}var t_=(e,t)=>{var n=eG[e];if(void 0===n)throw n=eU(e=nV(e)),nW(e),new eW(`${t} has unknown type ${n}`);return n},tS=(e,t,n)=>{var i=[];return e=e.toWireType(i,n),i.length&&(V()[t>>>2>>>0]=e2(i)),e};function tk(e,t,n){return t>>>=0,n>>>=0,e=e1(e>>>0),tS(t=t_(t,"emval::as"),n,e)}function tT(e,t){return t>>>=0,e=e1(e>>>0),(t=t_(t,"emval::as")).toWireType(null,e)}var tC=e=>{try{e()}catch(e){J(e)}},tE=0,tI=null,t$=0,tO=[],tA={},tN={},tP=0,tD=null,tM=[];function tz(e){return function(e){if(!z){if(0===tE){var t=!1,n=!1;e((e=0)=>{if(!z&&(t$=e,t=!0,n)){tE=2,tC(()=>n7(tI)),"u">typeof MainLoop&&MainLoop.Qb&&MainLoop.resume(),e=!1;try{var i=function(){var e=U()[tI+8>>>2>>>0];return e=nU[tN[e]],--ea,e()}()}catch(t){i=t,e=!0}var a=!1;if(!tI){var o=tD;o&&(tD=null,(e?o.reject:o.resolve)(i),a=!0)}if(e&&!a)throw i}}),n=!0,t||(tE=1,tI=function(){var e=nq(65548),t=e+12;V()[e>>>2>>>0]=t,V()[e+4>>>2>>>0]=t+65536;var n=tA[t=tO[0]];return void 0===n&&(n=tP++,tA[t]=n,tN[n]=t),t=n,U()[e+8>>>2>>>0]=t,e}(),"u">typeof MainLoop&&MainLoop.Qb&&MainLoop.pause(),tC(()=>n5(tI)))}else 2===tE?(tE=0,tC(n9),nW(tI),tI=null,tM.forEach(th)):J(`invalid state: ${tE}`);return t$}}(t=>{e().then(t)})}function tj(e){return e>>>=0,tz(async()=>e2(await e1(e)))}var tR=[];function tL(e,t,n,i){return n>>>=0,i>>>=0,(e=tR[e>>>0])(null,t=e1(t>>>0),n,i)}var tF={},tB=e=>{var t=tF[e];return void 0===t?eU(e):t};function tU(e,t,n,i,a){return n>>>=0,i>>>=0,a>>>=0,(e=tR[e>>>0])(t=e1(t>>>0),t[n=tB(n)],i,a)}function tV(e,t){return t>>>=0,(e=e1(e>>>0))==e1(t)}var tG=()=>"object"==typeof globalThis?globalThis:Function("return this")();function tH(e){return 0==(e>>>=0)?e2(tG()):(e=tB(e),e2(tG()[e]))}var tW=e=>{var t=tR.length;return tR.push(e),t},tq=(e,t)=>{for(var n=Array(e),i=0;i<e;++i)n[i]=t_(V()[t+4*i>>>2>>>0],`parameter ${i}`);return n};function tK(e,t,n){var i=(t=tq(e,t>>>0)).shift();e--;var a=`return function (obj, func, destructorsRef, args) {
`,o=0,s=[];0===n&&s.push("obj");for(var l=["retType"],u=[i],c=0;c<e;++c)s.push(`arg${c}`),l.push(`argType${c}`),u.push(t[c]),a+=`  var arg${c} = argType${c}.readValueFromPointer(args${o?"+"+o:""});
`,o+=t[c].Cb;return a+=`  var rv = ${1===n?"new func":"func.call"}(${s.join(", ")});
`,i.Ub||(l.push("emval_returnValue"),u.push(tS),a+=`  return emval_returnValue(retType, destructorsRef, rv);
`),tW(Object.defineProperty(e=Function(...l,a+`};
`)(...u),"name",{value:n=`methodCaller<(${t.map(e=>e.name).join(", ")}) => ${i.name}>`}))}function tX(e){return e2(i[e=tB(e>>>0)])}function tZ(e,t){return t>>>=0,e2((e=e1(e>>>0))[t=e1(t)])}function tY(e){9<(e>>>=0)&&(eJ[e+1]+=1)}function tQ(){return e2([])}function tJ(e){e=e1(e>>>0);for(var t=Array(e.length),n=0;n<e.length;n++)t[n]=e[n];return e2(t)}function t0(e){return e2(tB(e>>>0))}function t1(){return e2({})}function t2(e){for(var t=e1(e>>>=0);t.length;){var n=t.pop();t.pop()(n)}e0(e)}function t3(e,t,n){t>>>=0,n>>>=0,e=e1(e>>>0),t=e1(t),n=e1(n),e[t]=n}function t4(e,t){return t>>>=0,e2(e=(e=t_(e>>>0,"_emval_take_value")).readValueFromPointer(t))}function t6(e,t){e=-0x20000000000000>e||0x20000000000000<e?NaN:Number(e),t>>>=0,e=new Date(1e3*e),U()[t>>>2>>>0]=e.getUTCSeconds(),U()[t+4>>>2>>>0]=e.getUTCMinutes(),U()[t+8>>>2>>>0]=e.getUTCHours(),U()[t+12>>>2>>>0]=e.getUTCDate(),U()[t+16>>>2>>>0]=e.getUTCMonth(),U()[t+20>>>2>>>0]=e.getUTCFullYear()-1900,U()[t+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,U()[t+28>>>2>>>0]=e}var t5=e=>e%4==0&&(e%100!=0||e%400==0),t8=[0,31,60,91,121,152,182,213,244,274,305,335],t7=[0,31,59,90,120,151,181,212,243,273,304,334];function t9(e,t){e=-0x20000000000000>e||0x20000000000000<e?NaN:Number(e),t>>>=0,e=new Date(1e3*e),U()[t>>>2>>>0]=e.getSeconds(),U()[t+4>>>2>>>0]=e.getMinutes(),U()[t+8>>>2>>>0]=e.getHours(),U()[t+12>>>2>>>0]=e.getDate(),U()[t+16>>>2>>>0]=e.getMonth(),U()[t+20>>>2>>>0]=e.getFullYear()-1900,U()[t+24>>>2>>>0]=e.getDay();var n=(t5(e.getFullYear())?t8:t7)[e.getMonth()]+e.getDate()-1|0;U()[t+28>>>2>>>0]=n,U()[t+36>>>2>>>0]=-60*e.getTimezoneOffset(),n=new Date(e.getFullYear(),6,1).getTimezoneOffset();var i=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=0|(n!=i&&e.getTimezoneOffset()==Math.min(i,n)),U()[t+32>>>2>>>0]=e}function ne(e){e>>>=0;var t=new Date(U()[e+20>>>2>>>0]+1900,U()[e+16>>>2>>>0],U()[e+12>>>2>>>0],U()[e+8>>>2>>>0],U()[e+4>>>2>>>0],U()[e>>>2>>>0],0),n=U()[e+32>>>2>>>0],i=t.getTimezoneOffset(),a=new Date(t.getFullYear(),6,1).getTimezoneOffset(),o=new Date(t.getFullYear(),0,1).getTimezoneOffset(),s=Math.min(o,a);return 0>n?U()[e+32>>>2>>>0]=+(a!=o&&s==i):0<n!=(s==i)&&(a=Math.max(o,a),t.setTime(t.getTime()+6e4*((0<n?s:a)-i))),U()[e+24>>>2>>>0]=t.getDay(),n=(t5(t.getFullYear())?t8:t7)[t.getMonth()]+t.getDate()-1|0,U()[e+28>>>2>>>0]=n,U()[e>>>2>>>0]=t.getSeconds(),U()[e+4>>>2>>>0]=t.getMinutes(),U()[e+8>>>2>>>0]=t.getHours(),U()[e+12>>>2>>>0]=t.getDate(),U()[e+16>>>2>>>0]=t.getMonth(),U()[e+20>>>2>>>0]=t.getYear(),BigInt(isNaN(e=t.getTime())?-1:e/1e3)}function nt(e,t,n,i,a,o,s){return l?eo(16,1,e,t,n,i,a,o,s):-52}function nn(e,t,n,i,a,o){if(l)return eo(17,1,e,t,n,i,a,o)}var nr={},ni=()=>performance.timeOrigin+performance.now();function na(e,t){if(l)return eo(18,1,e,t);if(nr[e]&&(clearTimeout(nr[e].id),delete nr[e]),!t)return 0;var n=setTimeout(()=>{delete nr[e],th(()=>nJ(e,performance.timeOrigin+performance.now()))},t);return nr[e]={id:n,rc:t},0}function no(e,t,n,i){e>>>=0,t>>>=0,n>>>=0,i>>>=0;var a=new Date().getFullYear(),o=new Date(a,0,1).getTimezoneOffset(),s=Math.max(o,a=new Date(a,6,1).getTimezoneOffset());V()[e>>>2>>>0]=60*s,U()[t>>>2>>>0]=+(o!=a),e=(t=e=>{var t=Math.abs(e);return`UTC${0<=e?"-":"+"}${String(Math.floor(t/60)).padStart(2,"0")}${String(t%60).padStart(2,"0")}`})(o),t=t(a),a<o?(te(e,n,17),te(t,i,17)):(te(e,i,17),te(t,n,17))}var ns=()=>Date.now(),nl=1;function nu(e,t,n){if(!(0<=e&&3>=e))return 28;if(0===e)e=Date.now();else{if(!nl)return 52;e=performance.timeOrigin+performance.now()}return I[n>>>0>>>3]=BigInt(Math.round(1e6*e)),0}var nc=[],nd=(e,t)=>{nc.length=0;for(var n;n=L()[e++>>>0];){var i=105!=n;t+=(i&=112!=n)&&t%8?4:0,nc.push(112==n?V()[t>>>2>>>0]:106==n?I[t>>>3]:105==n?U()[t>>>2>>>0]:H()[t>>>3>>>0]),t+=i?8:4}return nc};function np(e,t,n){return e>>>=0,t=nd(t>>>0,n>>>0),nL[e](...t)}function nh(e,t,n){return e>>>=0,t=nd(t>>>0,n>>>0),nL[e](...t)}var nf=()=>{};function ng(e,t){return M(eC(e>>>0,t>>>0))}var nm=()=>{throw ea+=1,"unwind"};function ny(){return 0xffff0000}var nb=()=>navigator.hardwareConcurrency;function nv(){return J("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function nx(e){e>>>=0;var t=L().length;if(e<=t||0xffff0000<e)return!1;for(var n=1;4>=n;n*=2){var i=t*(1+.2/n);i=Math.min(i,e+0x6000000);n:{i=(Math.min(0xffff0000,65536*Math.ceil(Math.max(e,i)/65536))-b.buffer.byteLength+65535)/65536|0;try{b.grow(i),q();var a=1;break n}catch{}a=void 0}if(a)return!0}return!1}var nw=()=>(J("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),n_={},nS=e=>{e.forEach(e=>{var t=nw();t&&(n_[t]=e)})};function nk(){var e=Error().stack.toString().split(`
`);return"Error"==e[0]&&e.shift(),nS(e),n_.Mb=nw(),n_.dc=e,n_.Mb}function nT(e,t,n){if(e>>>=0,t>>>=0,n_.Mb==e)var i=n_.dc;else"Error"==(i=Error().stack.toString().split(`
`))[0]&&i.shift(),nS(i);for(var a=3;i[a]&&nw()!=e;)++a;for(e=0;e<n&&i[e+a];++e)U()[t+4*e>>>2>>>0]=nw();return e}var nC,nE={},nI=()=>{if(!nC){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:"./this.program"};for(e in nE)void 0===nE[e]?delete t[e]:t[e]=nE[e];var n=[];for(e in t)n.push(`${e}=${t[e]}`);nC=n}return nC};function n$(e,t){if(l)return eo(19,1,e,t);e>>>=0,t>>>=0;var n,i=0,a=0;for(n of nI()){var o=t+i;V()[e+a>>>2>>>0]=o,i+=te(n,o,1/0)+1,a+=4}return 0}function nO(e,t){if(l)return eo(20,1,e,t);e>>>=0,t>>>=0;var n=nI();for(var i of(V()[e>>>2>>>0]=n.length,e=0,n))e+=tt(i)+1;return V()[t>>>2>>>0]=e,0}function nA(e){return l?eo(21,1,e):52}function nN(e,t,n,i){return l?eo(22,1,e,t,n,i):52}function nP(e,t,n,i){return l?eo(23,1,e,t,n,i):70}var nD=[null,[],[]];function nM(e,t,n,i){if(l)return eo(24,1,e,t,n,i);t>>>=0,n>>>=0,i>>>=0;for(var a=0,o=0;o<n;o++){var s=V()[t>>>2>>>0],u=V()[t+4>>>2>>>0];t+=8;for(var c=0;c<u;c++){var d=e,p=L()[s+c>>>0],h=nD[d];0===p||10===p?((1===d?D:M)(eT(h)),h.length=0):h.push(p)}a+=u}return V()[i>>>2>>>0]=a,0}l||function(){for(var e=i.numThreads-1;e--;)ey();er.push(()=>{Z++,function(e){l?e():Promise.all(ec.map(em)).then(e)}(()=>Q())})}();for(var nz=Array(256),nj=0;256>nj;++nj)nz[nj]=String.fromCharCode(nj);eF=nz,eJ.push(0,1,void 0,1,null,1,!0,1,!1,1),i.count_emval_handles=()=>eJ.length/2-5-eQ.length,l||(b=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0}),q()),i.wasmBinary&&(y=i.wasmBinary),i.stackSave=()=>n4(),i.stackRestore=e=>n2(e),i.stackAlloc=e=>n3(e),i.setValue=function(e,t,n="i8"){switch(n.endsWith("*")&&(n="*"),n){case"i1":case"i8":R()[e>>>0]=t;break;case"i16":F()[e>>>1>>>0]=t;break;case"i32":U()[e>>>2>>>0]=t;break;case"i64":I[e>>>3]=BigInt(t);break;case"float":G()[e>>>2>>>0]=t;break;case"double":H()[e>>>3>>>0]=t;break;case"*":V()[e>>>2>>>0]=t;break;default:J(`invalid type for setValue: ${n}`)}},i.getValue=function(e,t="i8"){switch(t.endsWith("*")&&(t="*"),t){case"i1":case"i8":return R()[e>>>0];case"i16":return F()[e>>>1>>>0];case"i32":return U()[e>>>2>>>0];case"i64":return I[e>>>3];case"float":return G()[e>>>2>>>0];case"double":return H()[e>>>3>>>0];case"*":return V()[e>>>2>>>0];default:J(`invalid type for getValue: ${t}`)}},i.UTF8ToString=eC,i.stringToUTF8=te,i.lengthBytesUTF8=tt;var nR=[es,el,e_,eE,eI,e$,eO,eA,eN,eP,eD,eM,ez,ej,eR,eL,nt,nn,na,n$,nO,nA,nN,nP,nM],nL={893836:(e,t,n,a,o)=>{if(void 0===i||!i.Fb)return 1;if((e=eC(Number(e>>>0))).startsWith("./")&&(e=e.substring(2)),!(e=i.Fb.get(e)))return 2;if(t=Number(t>>>0),n=Number(n>>>0),a=Number(a>>>0),t+n>e.byteLength)return 3;try{let s=e.subarray(t,t+n);switch(o){case 0:L().set(s,a>>>0);break;case 1:i.mc?i.mc(a,s):i.cc(a,s);break;default:return 4}return 0}catch{return 4}},894660:(e,t,n)=>{i.Pb(e,L().subarray(t>>>0,t+n>>>0))},894724:()=>i.oc(),894766:e=>{i.Ob(e)},894803:()=>{i.Wb()},894834:()=>{i.Xb()},894863:()=>{i.ac()},894888:e=>i.Vb(e),894921:e=>i.Zb(e),894953:(e,t,n)=>{i.Lb(Number(e),Number(t),Number(n),!0)},895016:(e,t,n)=>{i.Lb(Number(e),Number(t),Number(n))},895073:()=>"u">typeof wasmOffsetConverter,895130:e=>{i.Ab("Abs",e,void 0)},895181:e=>{i.Ab("Neg",e,void 0)},895232:e=>{i.Ab("Floor",e,void 0)},895285:e=>{i.Ab("Ceil",e,void 0)},895337:e=>{i.Ab("Reciprocal",e,void 0)},895395:e=>{i.Ab("Sqrt",e,void 0)},895447:e=>{i.Ab("Exp",e,void 0)},895498:e=>{i.Ab("Erf",e,void 0)},895549:e=>{i.Ab("Sigmoid",e,void 0)},895604:(e,t,n)=>{i.Ab("HardSigmoid",e,{alpha:t,beta:n})},895683:e=>{i.Ab("Log",e,void 0)},895734:e=>{i.Ab("Sin",e,void 0)},895785:e=>{i.Ab("Cos",e,void 0)},895836:e=>{i.Ab("Tan",e,void 0)},895887:e=>{i.Ab("Asin",e,void 0)},895939:e=>{i.Ab("Acos",e,void 0)},895991:e=>{i.Ab("Atan",e,void 0)},896043:e=>{i.Ab("Sinh",e,void 0)},896095:e=>{i.Ab("Cosh",e,void 0)},896147:e=>{i.Ab("Asinh",e,void 0)},896200:e=>{i.Ab("Acosh",e,void 0)},896253:e=>{i.Ab("Atanh",e,void 0)},896306:e=>{i.Ab("Tanh",e,void 0)},896358:e=>{i.Ab("Not",e,void 0)},896409:(e,t,n)=>{i.Ab("Clip",e,{min:t,max:n})},896478:e=>{i.Ab("Clip",e,void 0)},896530:(e,t)=>{i.Ab("Elu",e,{alpha:t})},896588:e=>{i.Ab("Gelu",e,void 0)},896640:e=>{i.Ab("Relu",e,void 0)},896692:(e,t)=>{i.Ab("LeakyRelu",e,{alpha:t})},896756:(e,t)=>{i.Ab("ThresholdedRelu",e,{alpha:t})},896826:(e,t)=>{i.Ab("Cast",e,{to:t})},896884:e=>{i.Ab("Add",e,void 0)},896935:e=>{i.Ab("Sub",e,void 0)},896986:e=>{i.Ab("Mul",e,void 0)},897037:e=>{i.Ab("Div",e,void 0)},897088:e=>{i.Ab("Pow",e,void 0)},897139:e=>{i.Ab("Equal",e,void 0)},897192:e=>{i.Ab("Greater",e,void 0)},897247:e=>{i.Ab("GreaterOrEqual",e,void 0)},897309:e=>{i.Ab("Less",e,void 0)},897361:e=>{i.Ab("LessOrEqual",e,void 0)},897420:(e,t,n,a,o)=>{i.Ab("ReduceMean",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:a?Array.from(U().subarray(Number(a)>>>0,Number(o)>>>0)):[]})},897595:(e,t,n,a,o)=>{i.Ab("ReduceMax",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:a?Array.from(U().subarray(Number(a)>>>0,Number(o)>>>0)):[]})},897769:(e,t,n,a,o)=>{i.Ab("ReduceMin",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:a?Array.from(U().subarray(Number(a)>>>0,Number(o)>>>0)):[]})},897943:(e,t,n,a,o)=>{i.Ab("ReduceProd",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:a?Array.from(U().subarray(Number(a)>>>0,Number(o)>>>0)):[]})},898118:(e,t,n,a,o)=>{i.Ab("ReduceSum",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:a?Array.from(U().subarray(Number(a)>>>0,Number(o)>>>0)):[]})},898292:(e,t,n,a,o)=>{i.Ab("ReduceL1",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:a?Array.from(U().subarray(Number(a)>>>0,Number(o)>>>0)):[]})},898465:(e,t,n,a,o)=>{i.Ab("ReduceL2",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:a?Array.from(U().subarray(Number(a)>>>0,Number(o)>>>0)):[]})},898638:(e,t,n,a,o)=>{i.Ab("ReduceLogSum",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:a?Array.from(U().subarray(Number(a)>>>0,Number(o)>>>0)):[]})},898815:(e,t,n,a,o)=>{i.Ab("ReduceSumSquare",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:a?Array.from(U().subarray(Number(a)>>>0,Number(o)>>>0)):[]})},898995:(e,t,n,a,o)=>{i.Ab("ReduceLogSumExp",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:a?Array.from(U().subarray(Number(a)>>>0,Number(o)>>>0)):[]})},899175:e=>{i.Ab("Where",e,void 0)},899228:(e,t,n)=>{i.Ab("Transpose",e,{perm:t?Array.from(U().subarray(Number(t)>>>0,Number(n)>>>0)):[]})},899352:(e,t,n,a)=>{i.Ab("DepthToSpace",e,{blocksize:t,mode:eC(n),format:a?"NHWC":"NCHW"})},899485:(e,t,n,a)=>{i.Ab("DepthToSpace",e,{blocksize:t,mode:eC(n),format:a?"NHWC":"NCHW"})},899618:(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m)=>{i.Ab("ConvTranspose",e,{format:c?"NHWC":"NCHW",autoPad:t,dilations:[n],group:a,kernelShape:[o],pads:[s,l],strides:[u],wIsConst:()=>!!R()[d>>>0],outputPadding:p?Array.from(U().subarray(Number(p)>>>0,Number(h)>>>0)):[],outputShape:f?Array.from(U().subarray(Number(f)>>>0,Number(g)>>>0)):[],activation:eC(m)})},900051:(e,t,n,a,o,s,l,u,c,d,p,h,f,g)=>{i.Ab("ConvTranspose",e,{format:u?"NHWC":"NCHW",autoPad:t,dilations:Array.from(U().subarray(Number(n)>>>0,2+(Number(n)>>>0)>>>0)),group:a,kernelShape:Array.from(U().subarray(Number(o)>>>0,2+(Number(o)>>>0)>>>0)),pads:Array.from(U().subarray(Number(s)>>>0,4+(Number(s)>>>0)>>>0)),strides:Array.from(U().subarray(Number(l)>>>0,2+(Number(l)>>>0)>>>0)),wIsConst:()=>!!R()[c>>>0],outputPadding:d?Array.from(U().subarray(Number(d)>>>0,Number(p)>>>0)):[],outputShape:h?Array.from(U().subarray(Number(h)>>>0,Number(f)>>>0)):[],activation:eC(g)})},900712:(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m)=>{i.Ab("ConvTranspose",e,{format:c?"NHWC":"NCHW",autoPad:t,dilations:[n],group:a,kernelShape:[o],pads:[s,l],strides:[u],wIsConst:()=>!!R()[d>>>0],outputPadding:p?Array.from(U().subarray(Number(p)>>>0,Number(h)>>>0)):[],outputShape:f?Array.from(U().subarray(Number(f)>>>0,Number(g)>>>0)):[],activation:eC(m)})},901145:(e,t,n,a,o,s,l,u,c,d,p,h,f,g)=>{i.Ab("ConvTranspose",e,{format:u?"NHWC":"NCHW",autoPad:t,dilations:Array.from(U().subarray(Number(n)>>>0,2+(Number(n)>>>0)>>>0)),group:a,kernelShape:Array.from(U().subarray(Number(o)>>>0,2+(Number(o)>>>0)>>>0)),pads:Array.from(U().subarray(Number(s)>>>0,4+(Number(s)>>>0)>>>0)),strides:Array.from(U().subarray(Number(l)>>>0,2+(Number(l)>>>0)>>>0)),wIsConst:()=>!!R()[c>>>0],outputPadding:d?Array.from(U().subarray(Number(d)>>>0,Number(p)>>>0)):[],outputShape:h?Array.from(U().subarray(Number(h)>>>0,Number(f)>>>0)):[],activation:eC(g)})},901806:(e,t)=>{i.Ab("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},901897:(e,t,n,a,o,s,l,u,c,d,p,h,f,g)=>{i.Ab("AveragePool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:a,storage_order:o,dilations:s?Array.from(U().subarray(Number(s)>>>0,Number(l)>>>0)):[],kernel_shape:u?Array.from(U().subarray(Number(u)>>>0,Number(c)>>>0)):[],pads:d?Array.from(U().subarray(Number(d)>>>0,Number(p)>>>0)):[],strides:h?Array.from(U().subarray(Number(h)>>>0,Number(f)>>>0)):[]})},902376:(e,t)=>{i.Ab("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},902467:(e,t,n,a,o,s,l,u,c,d,p,h,f,g)=>{i.Ab("AveragePool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:a,storage_order:o,dilations:s?Array.from(U().subarray(Number(s)>>>0,Number(l)>>>0)):[],kernel_shape:u?Array.from(U().subarray(Number(u)>>>0,Number(c)>>>0)):[],pads:d?Array.from(U().subarray(Number(d)>>>0,Number(p)>>>0)):[],strides:h?Array.from(U().subarray(Number(h)>>>0,Number(f)>>>0)):[]})},902946:(e,t)=>{i.Ab("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},903033:(e,t,n,a,o,s,l,u,c,d,p,h,f,g)=>{i.Ab("MaxPool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:a,storage_order:o,dilations:s?Array.from(U().subarray(Number(s)>>>0,Number(l)>>>0)):[],kernel_shape:u?Array.from(U().subarray(Number(u)>>>0,Number(c)>>>0)):[],pads:d?Array.from(U().subarray(Number(d)>>>0,Number(p)>>>0)):[],strides:h?Array.from(U().subarray(Number(h)>>>0,Number(f)>>>0)):[]})},903508:(e,t)=>{i.Ab("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},903595:(e,t,n,a,o,s,l,u,c,d,p,h,f,g)=>{i.Ab("MaxPool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:a,storage_order:o,dilations:s?Array.from(U().subarray(Number(s)>>>0,Number(l)>>>0)):[],kernel_shape:u?Array.from(U().subarray(Number(u)>>>0,Number(c)>>>0)):[],pads:d?Array.from(U().subarray(Number(d)>>>0,Number(p)>>>0)):[],strides:h?Array.from(U().subarray(Number(h)>>>0,Number(f)>>>0)):[]})},904070:(e,t,n,a,o)=>{i.Ab("Gemm",e,{alpha:t,beta:n,transA:a,transB:o})},904174:e=>{i.Ab("MatMul",e,void 0)},904228:(e,t,n,a)=>{i.Ab("ArgMax",e,{keepDims:!!t,selectLastIndex:!!n,axis:a})},904336:(e,t,n,a)=>{i.Ab("ArgMin",e,{keepDims:!!t,selectLastIndex:!!n,axis:a})},904444:(e,t)=>{i.Ab("Softmax",e,{axis:t})},904507:(e,t)=>{i.Ab("Concat",e,{axis:t})},904567:(e,t,n,a,o)=>{i.Ab("Split",e,{axis:t,numOutputs:n,splitSizes:a?Array.from(U().subarray(Number(a)>>>0,Number(o)>>>0)):[]})},904723:e=>{i.Ab("Expand",e,void 0)},904777:(e,t)=>{i.Ab("Gather",e,{axis:Number(t)})},904848:(e,t)=>{i.Ab("GatherElements",e,{axis:Number(t)})},904927:(e,t)=>{i.Ab("GatherND",e,{batch_dims:Number(t)})},905006:(e,t,n,a,o,s,l,u,c,d,p)=>{i.Ab("Resize",e,{antialias:t,axes:n?Array.from(U().subarray(Number(n)>>>0,Number(a)>>>0)):[],coordinateTransformMode:eC(o),cubicCoeffA:s,excludeOutside:l,extrapolationValue:u,keepAspectRatioPolicy:eC(c),mode:eC(d),nearestMode:eC(p)})},905368:(e,t,n,a,o,s,l)=>{i.Ab("Slice",e,{starts:t?Array.from(U().subarray(Number(t)>>>0,Number(n)>>>0)):[],ends:a?Array.from(U().subarray(Number(a)>>>0,Number(o)>>>0)):[],axes:s?Array.from(U().subarray(Number(s)>>>0,Number(l)>>>0)):[]})},905632:e=>{i.Ab("Tile",e,void 0)},905684:(e,t,n)=>{i.Ab("InstanceNormalization",e,{epsilon:t,format:n?"NHWC":"NCHW"})},905798:(e,t,n)=>{i.Ab("InstanceNormalization",e,{epsilon:t,format:n?"NHWC":"NCHW"})},905912:e=>{i.Ab("Range",e,void 0)},905965:(e,t)=>{i.Ab("Einsum",e,{equation:eC(t)})},906046:(e,t,n,a,o)=>{i.Ab("Pad",e,{mode:t,value:n,pads:a?Array.from(U().subarray(Number(a)>>>0,Number(o)>>>0)):[]})},906189:(e,t,n,a,o,s)=>{i.Ab("BatchNormalization",e,{epsilon:t,momentum:n,spatial:!!o,trainingMode:!!a,format:s?"NHWC":"NCHW"})},906358:(e,t,n,a,o,s)=>{i.Ab("BatchNormalization",e,{epsilon:t,momentum:n,spatial:!!o,trainingMode:!!a,format:s?"NHWC":"NCHW"})},906527:(e,t,n)=>{i.Ab("CumSum",e,{exclusive:Number(t),reverse:Number(n)})},906624:(e,t,n)=>{i.Ab("DequantizeLinear",e,{axis:t,blockSize:n})},906714:(e,t,n,a,o)=>{i.Ab("GridSample",e,{align_corners:t,mode:eC(n),padding_mode:eC(a),format:o?"NHWC":"NCHW"})},906884:(e,t,n,a,o)=>{i.Ab("GridSample",e,{align_corners:t,mode:eC(n),padding_mode:eC(a),format:o?"NHWC":"NCHW"})},907054:(e,t)=>{i.Ab("ScatterND",e,{reduction:eC(t)})},907139:(e,t,n,a,o,s,l,u,c)=>{i.Ab("Attention",e,{numHeads:t,isUnidirectional:n,maskFilterValue:a,scale:o,doRotary:s,qkvHiddenSizes:l?Array.from(U().subarray(Number(u)>>>0,Number(u)+l>>>0)):[],pastPresentShareBuffer:!!c})},907411:e=>{i.Ab("BiasAdd",e,void 0)},907466:e=>{i.Ab("BiasSplitGelu",e,void 0)},907527:e=>{i.Ab("FastGelu",e,void 0)},907583:(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m,y)=>{i.Ab("Conv",e,{format:h?"NHWC":"NCHW",auto_pad:t,dilations:n?Array.from(U().subarray(Number(n)>>>0,Number(a)>>>0)):[],group:o,kernel_shape:s?Array.from(U().subarray(Number(s)>>>0,Number(l)>>>0)):[],pads:u?Array.from(U().subarray(Number(u)>>>0,Number(c)>>>0)):[],strides:d?Array.from(U().subarray(Number(d)>>>0,Number(p)>>>0)):[],w_is_const:()=>!!R()[Number(f)>>>0],activation:eC(g),activation_params:m?Array.from(G().subarray(Number(m)>>>0,Number(y)>>>0)):[]})},908167:e=>{i.Ab("Gelu",e,void 0)},908219:(e,t,n,a,o,s,l,u,c)=>{i.Ab("GroupQueryAttention",e,{numHeads:t,kvNumHeads:n,scale:a,softcap:o,doRotary:s,rotaryInterleaved:l,smoothSoftmax:u,localWindowSize:c})},908436:(e,t,n,a)=>{i.Ab("LayerNormalization",e,{axis:t,epsilon:n,simplified:!!a})},908547:(e,t,n,a)=>{i.Ab("LayerNormalization",e,{axis:t,epsilon:n,simplified:!!a})},908658:(e,t,n,a,o,s)=>{i.Ab("MatMulNBits",e,{k:t,n:n,accuracyLevel:a,bits:o,blockSize:s})},908785:(e,t,n,a,o,s)=>{i.Ab("MultiHeadAttention",e,{numHeads:t,isUnidirectional:n,maskFilterValue:a,scale:o,doRotary:s})},908944:(e,t)=>{i.Ab("QuickGelu",e,{alpha:t})},909008:(e,t,n,a,o)=>{i.Ab("RotaryEmbedding",e,{interleaved:!!t,numHeads:n,rotaryEmbeddingDim:a,scale:o})},909147:(e,t,n)=>{i.Ab("SkipLayerNormalization",e,{epsilon:t,simplified:!!n})},909249:(e,t,n)=>{i.Ab("SkipLayerNormalization",e,{epsilon:t,simplified:!!n})},909351:(e,t,n,a)=>{i.Ab("GatherBlockQuantized",e,{gatherAxis:t,quantizeAxis:n,blockSize:a})},909472:e=>{i.$b(e)},909506:(e,t)=>i.bc(Number(e),Number(t),i.Gb.ec,i.Gb.errors)};function nF(e,t,n){return tz(async()=>{await i.Yb(Number(e),Number(t),Number(n))})}function nB(){return"u">typeof wasmOffsetConverter}var nU=await async function(){function e(e,t){return nU=e.exports,nU=function(){var e={};for(let[t,n]of Object.entries(nU))e[t]="function"==typeof n?(...e)=>{tO.push(t);try{return n(...e)}finally{z||(tO.pop(),tI&&1===tE&&0===tO.length&&(tE=0,ea+=1,tC(n8),"u">typeof Fibers&&Fibers.sc()))}}:n;return e}(),nU=function(){var e=nU,t=e=>t=>e(t)>>>0,n=e=>()=>e()>>>0;return(e=Object.assign({},e)).Ea=t(e.Ea),e.gb=n(e.gb),e.ib=t(e.ib),e.tb=t(e.tb),e.ub=n(e.ub),e.__cxa_get_exception_ptr=t(e.__cxa_get_exception_ptr),e}(),ep.push(nU.jb),v=t,Q(),nU}Z++;var t=ee();if(i.instantiateWasm)return new Promise(n=>{i.instantiateWasm(t,(t,i)=>{n(e(t,i))})});if(l)return new Promise(t=>{A=n=>{t(e(new WebAssembly.Instance(n,ee()),n))}});X??=i.locateFile?i.locateFile?i.locateFile("ort-wasm-simd-threaded.jsep.wasm",m):m+"ort-wasm-simd-threaded.jsep.wasm":new URL(__webpack_require__(681),__webpack_require__.b).href;try{var a=await async function(e){var t=X;if(!y&&"function"==typeof WebAssembly.instantiateStreaming&&!j(t))try{var n=fetch(t,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(n,e)}catch(e){M(`wasm streaming compile failed: ${e}`),M("falling back to ArrayBuffer instantiation")}return async function(e,t){try{var n=await async function(e){if(!y)try{var t=await p(e);return new Uint8Array(t)}catch{}if(e==X&&y)e=new Uint8Array(y);else{if(!h)throw"both async and sync fetching of the wasm failed";e=h(e)}return e}(e);return await WebAssembly.instantiate(n,t)}catch(e){M(`failed to asynchronously prepare wasm: ${e}`),J(e)}}(t,e)}(t);return e(a.instance,a.module)}catch(e){return n(e),Promise.reject(e)}}(),nV=e=>(nV=nU.Ea)(e),nG=()=>(nG=nU.Fa)();i._OrtInit=(e,t)=>(i._OrtInit=nU.Ga)(e,t),i._OrtGetLastError=(e,t)=>(i._OrtGetLastError=nU.Ha)(e,t),i._OrtCreateSessionOptions=(e,t,n,a,o,s,l,u,c,d)=>(i._OrtCreateSessionOptions=nU.Ia)(e,t,n,a,o,s,l,u,c,d),i._OrtAppendExecutionProvider=(e,t,n,a,o)=>(i._OrtAppendExecutionProvider=nU.Ja)(e,t,n,a,o),i._OrtAddFreeDimensionOverride=(e,t,n)=>(i._OrtAddFreeDimensionOverride=nU.Ka)(e,t,n),i._OrtAddSessionConfigEntry=(e,t,n)=>(i._OrtAddSessionConfigEntry=nU.La)(e,t,n),i._OrtReleaseSessionOptions=e=>(i._OrtReleaseSessionOptions=nU.Ma)(e),i._OrtCreateSession=(e,t,n)=>(i._OrtCreateSession=nU.Na)(e,t,n),i._OrtReleaseSession=e=>(i._OrtReleaseSession=nU.Oa)(e),i._OrtGetInputOutputCount=(e,t,n)=>(i._OrtGetInputOutputCount=nU.Pa)(e,t,n),i._OrtGetInputOutputMetadata=(e,t,n,a)=>(i._OrtGetInputOutputMetadata=nU.Qa)(e,t,n,a),i._OrtFree=e=>(i._OrtFree=nU.Ra)(e),i._OrtCreateTensor=(e,t,n,a,o,s)=>(i._OrtCreateTensor=nU.Sa)(e,t,n,a,o,s),i._OrtGetTensorData=(e,t,n,a,o)=>(i._OrtGetTensorData=nU.Ta)(e,t,n,a,o),i._OrtReleaseTensor=e=>(i._OrtReleaseTensor=nU.Ua)(e),i._OrtCreateRunOptions=(e,t,n,a)=>(i._OrtCreateRunOptions=nU.Va)(e,t,n,a),i._OrtAddRunConfigEntry=(e,t,n)=>(i._OrtAddRunConfigEntry=nU.Wa)(e,t,n),i._OrtReleaseRunOptions=e=>(i._OrtReleaseRunOptions=nU.Xa)(e),i._OrtCreateBinding=e=>(i._OrtCreateBinding=nU.Ya)(e),i._OrtBindInput=(e,t,n)=>(i._OrtBindInput=nU.Za)(e,t,n),i._OrtBindOutput=(e,t,n,a)=>(i._OrtBindOutput=nU._a)(e,t,n,a),i._OrtClearBoundOutputs=e=>(i._OrtClearBoundOutputs=nU.$a)(e),i._OrtReleaseBinding=e=>(i._OrtReleaseBinding=nU.ab)(e),i._OrtRunWithBinding=(e,t,n,a,o)=>(i._OrtRunWithBinding=nU.bb)(e,t,n,a,o),i._OrtRun=(e,t,n,a,o,s,l,u)=>(i._OrtRun=nU.cb)(e,t,n,a,o,s,l,u),i._OrtEndProfiling=e=>(i._OrtEndProfiling=nU.db)(e),i._JsepOutput=(e,t,n)=>(i._JsepOutput=nU.eb)(e,t,n),i._JsepGetNodeName=e=>(i._JsepGetNodeName=nU.fb)(e);var nH=()=>(nH=nU.gb)(),nW=i._free=e=>(nW=i._free=nU.hb)(e),nq=i._malloc=e=>(nq=i._malloc=nU.ib)(e),nK=(e,t,n,i,a,o)=>(nK=nU.kb)(e,t,n,i,a,o),nX=()=>(nX=nU.lb)(),nZ=(e,t,n,i,a)=>(nZ=nU.mb)(e,t,n,i,a),nY=e=>(nY=nU.nb)(e),nQ=e=>(nQ=nU.ob)(e),nJ=(e,t)=>(nJ=nU.pb)(e,t),n0=()=>(n0=nU.qb)(),n1=(e,t)=>(n1=nU.rb)(e,t),n2=e=>(n2=nU.sb)(e),n3=e=>(n3=nU.tb)(e),n4=()=>(n4=nU.ub)(),n6=i.dynCall_ii=(e,t)=>(n6=i.dynCall_ii=nU.vb)(e,t);i.dynCall_vii=(e,t,n)=>(i.dynCall_vii=nU.dynCall_vii)(e,t,n),i.dynCall_iiiii=(e,t,n,a,o)=>(i.dynCall_iiiii=nU.dynCall_iiiii)(e,t,n,a,o),i.dynCall_iii=(e,t,n)=>(i.dynCall_iii=nU.dynCall_iii)(e,t,n),i.dynCall_iiiiii=(e,t,n,a,o,s)=>(i.dynCall_iiiiii=nU.dynCall_iiiiii)(e,t,n,a,o,s),i.dynCall_iiiiiiii=(e,t,n,a,o,s,l,u)=>(i.dynCall_iiiiiiii=nU.dynCall_iiiiiiii)(e,t,n,a,o,s,l,u),i.dynCall_iiiiiii=(e,t,n,a,o,s,l)=>(i.dynCall_iiiiiii=nU.dynCall_iiiiiii)(e,t,n,a,o,s,l),i.dynCall_vi=(e,t)=>(i.dynCall_vi=nU.dynCall_vi)(e,t),i.dynCall_iiii=(e,t,n,a)=>(i.dynCall_iiii=nU.dynCall_iiii)(e,t,n,a),i.dynCall_i=e=>(i.dynCall_i=nU.dynCall_i)(e),i.dynCall_viiiiiiii=(e,t,n,a,o,s,l,u,c)=>(i.dynCall_viiiiiiii=nU.dynCall_viiiiiiii)(e,t,n,a,o,s,l,u,c),i.dynCall_viii=(e,t,n,a)=>(i.dynCall_viii=nU.dynCall_viii)(e,t,n,a),i.dynCall_viijj=(e,t,n,a,o)=>(i.dynCall_viijj=nU.dynCall_viijj)(e,t,n,a,o),i.dynCall_viiiiii=(e,t,n,a,o,s,l)=>(i.dynCall_viiiiii=nU.dynCall_viiiiii)(e,t,n,a,o,s,l),i.dynCall_viiii=(e,t,n,a,o)=>(i.dynCall_viiii=nU.dynCall_viiii)(e,t,n,a,o),i.dynCall_viiiii=(e,t,n,a,o,s)=>(i.dynCall_viiiii=nU.dynCall_viiiii)(e,t,n,a,o,s),i.dynCall_vfiii=(e,t,n,a,o)=>(i.dynCall_vfiii=nU.dynCall_vfiii)(e,t,n,a,o),i.dynCall_viiiiff=(e,t,n,a,o,s,l)=>(i.dynCall_viiiiff=nU.dynCall_viiiiff)(e,t,n,a,o,s,l),i.dynCall_viiiiiff=(e,t,n,a,o,s,l,u)=>(i.dynCall_viiiiiff=nU.dynCall_viiiiiff)(e,t,n,a,o,s,l,u),i.dynCall_ffff=(e,t,n,a)=>(i.dynCall_ffff=nU.dynCall_ffff)(e,t,n,a),i.dynCall_viiff=(e,t,n,a,o)=>(i.dynCall_viiff=nU.dynCall_viiff)(e,t,n,a,o),i.dynCall_fffffff=(e,t,n,a,o,s,l)=>(i.dynCall_fffffff=nU.dynCall_fffffff)(e,t,n,a,o,s,l),i.dynCall_jjjjjjj=(e,t,n,a,o,s,l)=>(i.dynCall_jjjjjjj=nU.dynCall_jjjjjjj)(e,t,n,a,o,s,l),i.dynCall_jjjjjj=(e,t,n,a,o,s)=>(i.dynCall_jjjjjj=nU.dynCall_jjjjjj)(e,t,n,a,o,s),i.dynCall_iijjii=(e,t,n,a,o,s)=>(i.dynCall_iijjii=nU.dynCall_iijjii)(e,t,n,a,o,s),i.dynCall_viiiiiiiiiiiii=(e,t,n,a,o,s,l,u,c,d,p,h,f,g)=>(i.dynCall_viiiiiiiiiiiii=nU.dynCall_viiiiiiiiiiiii)(e,t,n,a,o,s,l,u,c,d,p,h,f,g),i.dynCall_viiiiiiiiii=(e,t,n,a,o,s,l,u,c,d,p)=>(i.dynCall_viiiiiiiiii=nU.dynCall_viiiiiiiiii)(e,t,n,a,o,s,l,u,c,d,p),i.dynCall_viiiiiiiiiii=(e,t,n,a,o,s,l,u,c,d,p,h)=>(i.dynCall_viiiiiiiiiii=nU.dynCall_viiiiiiiiiii)(e,t,n,a,o,s,l,u,c,d,p,h),i.dynCall_viiiiiiiiiiii=(e,t,n,a,o,s,l,u,c,d,p,h,f)=>(i.dynCall_viiiiiiiiiiii=nU.dynCall_viiiiiiiiiiii)(e,t,n,a,o,s,l,u,c,d,p,h,f),i.dynCall_viiiiiiiiiiiiiiiiii=(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m,y,b,v,x)=>(i.dynCall_viiiiiiiiiiiiiiiiii=nU.dynCall_viiiiiiiiiiiiiiiiii)(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m,y,b,v,x),i.dynCall_viiiiiiiii=(e,t,n,a,o,s,l,u,c,d)=>(i.dynCall_viiiiiiiii=nU.dynCall_viiiiiiiii)(e,t,n,a,o,s,l,u,c,d),i.dynCall_viiiiiiiiiiiiiiiiiii=(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m,y,b,v,x,w)=>(i.dynCall_viiiiiiiiiiiiiiiiiii=nU.dynCall_viiiiiiiiiiiiiiiiiii)(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m,y,b,v,x,w),i.dynCall_viiiiiii=(e,t,n,a,o,s,l,u)=>(i.dynCall_viiiiiii=nU.dynCall_viiiiiii)(e,t,n,a,o,s,l,u),i.dynCall_viiiiiiiiiiiiiii=(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m,y)=>(i.dynCall_viiiiiiiiiiiiiii=nU.dynCall_viiiiiiiiiiiiiii)(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m,y),i.dynCall_jiji=(e,t,n,a)=>(i.dynCall_jiji=nU.dynCall_jiji)(e,t,n,a),i.dynCall_v=e=>(i.dynCall_v=nU.dynCall_v)(e),i.dynCall_iidiiii=(e,t,n,a,o,s,l)=>(i.dynCall_iidiiii=nU.dynCall_iidiiii)(e,t,n,a,o,s,l),i.dynCall_iiiiiiiii=(e,t,n,a,o,s,l,u,c)=>(i.dynCall_iiiiiiiii=nU.dynCall_iiiiiiiii)(e,t,n,a,o,s,l,u,c),i.dynCall_iiij=(e,t,n,a)=>(i.dynCall_iiij=nU.dynCall_iiij)(e,t,n,a),i.dynCall_iiiiiiiiii=(e,t,n,a,o,s,l,u,c,d)=>(i.dynCall_iiiiiiiiii=nU.dynCall_iiiiiiiiii)(e,t,n,a,o,s,l,u,c,d),i.dynCall_iiiiiiiiiiiii=(e,t,n,a,o,s,l,u,c,d,p,h,f)=>(i.dynCall_iiiiiiiiiiiii=nU.dynCall_iiiiiiiiiiiii)(e,t,n,a,o,s,l,u,c,d,p,h,f),i.dynCall_iiiiiiiiiii=(e,t,n,a,o,s,l,u,c,d,p)=>(i.dynCall_iiiiiiiiiii=nU.dynCall_iiiiiiiiiii)(e,t,n,a,o,s,l,u,c,d,p),i.dynCall_ji=(e,t)=>(i.dynCall_ji=nU.dynCall_ji)(e,t),i.dynCall_iijii=(e,t,n,a,o)=>(i.dynCall_iijii=nU.dynCall_iijii)(e,t,n,a,o),i.dynCall_vij=(e,t,n)=>(i.dynCall_vij=nU.dynCall_vij)(e,t,n),i.dynCall_viiijii=(e,t,n,a,o,s,l)=>(i.dynCall_viiijii=nU.dynCall_viiijii)(e,t,n,a,o,s,l),i.dynCall_viijiiiiiiiiiiiiii=(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m,y,b,v)=>(i.dynCall_viijiiiiiiiiiiiiii=nU.dynCall_viijiiiiiiiiiiiiii)(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m,y,b,v),i.dynCall_viiiji=(e,t,n,a,o,s)=>(i.dynCall_viiiji=nU.dynCall_viiiji)(e,t,n,a,o,s),i.dynCall_fiii=(e,t,n,a)=>(i.dynCall_fiii=nU.dynCall_fiii)(e,t,n,a),i.dynCall_viijii=(e,t,n,a,o,s)=>(i.dynCall_viijii=nU.dynCall_viijii)(e,t,n,a,o,s),i.dynCall_viij=(e,t,n,a)=>(i.dynCall_viij=nU.dynCall_viij)(e,t,n,a),i.dynCall_jiij=(e,t,n,a)=>(i.dynCall_jiij=nU.dynCall_jiij)(e,t,n,a),i.dynCall_fi=(e,t)=>(i.dynCall_fi=nU.dynCall_fi)(e,t),i.dynCall_fii=(e,t,n)=>(i.dynCall_fii=nU.dynCall_fii)(e,t,n),i.dynCall_jii=(e,t,n)=>(i.dynCall_jii=nU.dynCall_jii)(e,t,n),i.dynCall_dii=(e,t,n)=>(i.dynCall_dii=nU.dynCall_dii)(e,t,n),i.dynCall_fiiii=(e,t,n,a,o)=>(i.dynCall_fiiii=nU.dynCall_fiiii)(e,t,n,a,o),i.dynCall_fif=(e,t,n)=>(i.dynCall_fif=nU.dynCall_fif)(e,t,n),i.dynCall_jfi=(e,t,n)=>(i.dynCall_jfi=nU.dynCall_jfi)(e,t,n),i.dynCall_viiiiiiiiiiiiii=(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m)=>(i.dynCall_viiiiiiiiiiiiii=nU.dynCall_viiiiiiiiiiiiii)(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m),i.dynCall_viiiiiiiiiiiiiiiiiiii=(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m,y,b,v,x,w,_)=>(i.dynCall_viiiiiiiiiiiiiiiiiiii=nU.dynCall_viiiiiiiiiiiiiiiiiiii)(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m,y,b,v,x,w,_),i.dynCall_viiiiiiiiiiiiiiii=(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m,y,b)=>(i.dynCall_viiiiiiiiiiiiiiii=nU.dynCall_viiiiiiiiiiiiiiii)(e,t,n,a,o,s,l,u,c,d,p,h,f,g,m,y,b),i.dynCall_iif=(e,t,n)=>(i.dynCall_iif=nU.dynCall_iif)(e,t,n),i.dynCall_jiiii=(e,t,n,a,o)=>(i.dynCall_jiiii=nU.dynCall_jiiii)(e,t,n,a,o),i.dynCall_jiii=(e,t,n,a)=>(i.dynCall_jiii=nU.dynCall_jiii)(e,t,n,a),i.dynCall_viif=(e,t,n,a)=>(i.dynCall_viif=nU.dynCall_viif)(e,t,n,a),i.dynCall_viiij=(e,t,n,a,o)=>(i.dynCall_viiij=nU.dynCall_viiij)(e,t,n,a,o),i.dynCall_viiiijii=(e,t,n,a,o,s,l,u)=>(i.dynCall_viiiijii=nU.dynCall_viiiijii)(e,t,n,a,o,s,l,u),i.dynCall_iiiiij=(e,t,n,a,o,s)=>(i.dynCall_iiiiij=nU.dynCall_iiiiij)(e,t,n,a,o,s),i.dynCall_iiiiid=(e,t,n,a,o,s)=>(i.dynCall_iiiiid=nU.dynCall_iiiiid)(e,t,n,a,o,s),i.dynCall_iiiiijj=(e,t,n,a,o,s,l)=>(i.dynCall_iiiiijj=nU.dynCall_iiiiijj)(e,t,n,a,o,s,l),i.dynCall_iiiiiijj=(e,t,n,a,o,s,l,u)=>(i.dynCall_iiiiiijj=nU.dynCall_iiiiiijj)(e,t,n,a,o,s,l,u);var n5=e=>(n5=nU.wb)(e),n8=()=>(n8=nU.xb)(),n7=e=>(n7=nU.yb)(e),n9=()=>(n9=nU.zb)();return function e(){if(0<Z)Y=e;else if(l)t(i),K();else{for(;0<er.length;)er.shift()(i);0<Z?Y=e:(i.calledRun=!0,z||(K(),t(i)))}}(),i.PTR_SIZE=4,a},globalThis.self?.name?.startsWith("em-pthread")&&my()}),fa=k(()=>{pa(),vy=typeof location>"u"?void 0:location.origin,ic=!0,Ot=(()=>{if(ic){let e=URL;return new URL(new e(__webpack_require__(249),__webpack_require__.b).href,vy).href}return"file:///home/runner/work/kaya/kaya/node_modules/onnxruntime-web/dist/ort.all.bundle.min.mjs"})(),wy=()=>{if(Ot&&!Ot.startsWith("blob:"))return Ot.substring(0,Ot.lastIndexOf("/")+1)},oc=(e,t)=>{try{let n=t??Ot;return(n?new URL(e,n):new URL(e)).origin===vy}catch{return!1}},kO=(e,t)=>{let n=t??Ot;try{return(n?new URL(e,n):new URL(e)).href}catch{return}},NO=(e,t)=>`${t??"./"}${e}`,xy=async e=>{let t=await (await fetch(e,{credentials:"same-origin"})).blob();return URL.createObjectURL(t)},LO=async e=>(await import(e)).default,yy=(hy(),Jr(fy)).default,Ty=async()=>{if(!Ot)throw Error("Failed to load proxy worker: cannot determine the script source URL.");if(oc(Ot))return[void 0,yy()];let e=await xy(Ot);return[e,yy(e)]},_y=(by(),Jr(gy)).default,Iy=async(e,t,n,i)=>{let a=_y&&!(e||t);if(a)if(Ot)a=oc(Ot);else if(i&&!n)a=!0;else throw Error("cannot determine the script source URL.");if(a)return[void 0,_y];{let i="ort-wasm-simd-threaded.jsep.mjs",a=e??kO(i,t),o=n&&a&&!oc(a,t),s=o?await xy(a):a??NO(i,t);return[o?s:void 0,await LO(s)]}}}),yr=k(()=>{fa(),sc=!1,xa=!1,Sy=!1,RO=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return"u">typeof MessageChannel&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},zO=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},MO=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,19,1,17,0,65,1,253,15,65,2,253,15,65,3,253,15,253,147,2,11]))}catch{return!1}},ha=async e=>{if(sc)return Promise.resolve();if(xa)throw Error("multiple calls to 'initializeWebAssembly()' detected.");if(Sy)throw Error("previous call to 'initializeWebAssembly()' failed.");xa=!0;let t=e.initTimeout,n=e.numThreads;if(!1!==e.simd){if("relaxed"===e.simd){if(!MO())throw Error("Relaxed WebAssembly SIMD is not supported in the current environment.")}else if(!zO())throw Error("WebAssembly SIMD is not supported in the current environment.")}let i=RO();n>1&&!i&&("u">typeof self&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+n+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),e.numThreads=n=1);let a=e.wasmPaths,o="string"==typeof a?a:void 0,s=a?.mjs,l=s?.href??s,u=a?.wasm,c=u?.href??u,d=e.wasmBinary,[p,h]=await Iy(l,o,n>1,!!d||!!c),f=!1,g=[];if(t>0&&g.push(new Promise(e=>{setTimeout(()=>{f=!0,e()},t)})),g.push(new Promise((e,t)=>{let i={numThreads:n};if(d)i.wasmBinary=d;else if(c||o)i.locateFile=e=>c??o+e;else if(l&&0!==l.indexOf("blob:"))i.locateFile=e=>new URL(e,l).href;else if(p){let e=wy();e&&(i.locateFile=t=>e+t)}h(i).then(t=>{xa=!1,sc=!0,ac=t,e(),p&&URL.revokeObjectURL(p)},e=>{xa=!1,Sy=!0,t(e)})})),await Promise.race(g),f)throw Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},Be=()=>{if(sc&&ac)return ac;throw Error("WebAssembly is not initialized yet.")}}),Ta=k(()=>{yr(),Pt=(e,t)=>{let n=Be(),i=n.lengthBytesUTF8(e)+1,a=n._malloc(i);return n.stringToUTF8(e,a,i),t.push(a),a},Vo=(e,t,n,i)=>{if("object"==typeof e&&null!==e){if(n.has(e))throw Error("Circular reference in options");n.add(e)}Object.entries(e).forEach(([e,a])=>{let o=t?t+e:e;if("object"==typeof a)Vo(a,o+".",n,i);else if("string"==typeof a||"number"==typeof a)i(o,a.toString());else if("boolean"==typeof a)i(o,a?"1":"0");else throw Error(`Can't handle extra config type: ${typeof a}`)})},Ne=e=>{let t=Be(),n=t.stackSave();try{let n=t.PTR_SIZE,i=t.stackAlloc(2*n);t._OrtGetLastError(i,i+n);let a=Number(t.getValue(i,4===n?"i32":"i64")),o=t.getValue(i+n,"*"),s=o?t.UTF8ToString(o):"";throw Error(`${e} ERROR_CODE: ${a}, ERROR_MESSAGE: ${s}`)}finally{t.stackRestore(n)}}}),Ay=k(()=>{yr(),Ta(),$y=e=>{let t=Be(),n=0,i=[],a=e||{};try{if(e?.logSeverityLevel===void 0)a.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw Error(`log severity level is not valid: ${e.logSeverityLevel}`);if(e?.logVerbosityLevel===void 0)a.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);e?.terminate===void 0&&(a.terminate=!1);let o=0;return e?.tag!==void 0&&(o=Pt(e.tag,i)),n=t._OrtCreateRunOptions(a.logSeverityLevel,a.logVerbosityLevel,!!a.terminate,o),0===n&&Ne("Can't create run options."),e?.extra!==void 0&&Vo(e.extra,"",new WeakSet,(e,a)=>{let o=Pt(e,i),s=Pt(a,i);0!==t._OrtAddRunConfigEntry(n,o,s)&&Ne(`Can't set a run config entry: ${e} - ${a}.`)}),[n,i]}catch(e){throw 0!==n&&t._OrtReleaseRunOptions(n),i.forEach(e=>t._free(e)),e}}}),Py=k(()=>{yr(),Ta(),BO=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"layout":return 3;case"all":return 99;default:throw Error(`unsupported graph optimization level: ${e}`)}},FO=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw Error(`unsupported execution mode: ${e}`)}},VO=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(e=>("string"==typeof e?e:e.name)==="webgpu")&&(e.enableMemPattern=!1)},Ia=(e,t,n,i)=>{let a=Pt(t,i),o=Pt(n,i);0!==Be()._OrtAddSessionConfigEntry(e,a,o)&&Ne(`Can't set a session config entry: ${t} - ${n}.`)},GO=async(e,t,n)=>{for(let i of t){let t="string"==typeof i?i:i.name,a=[];switch(t){case"webnn":if(t="WEBNN","string"!=typeof i){let t=i?.deviceType;t&&Ia(e,"deviceType",t,n)}break;case"webgpu":if(t="JS","string"!=typeof i){let t=i;if(t?.preferredLayout){if("NCHW"!==t.preferredLayout&&"NHWC"!==t.preferredLayout)throw Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${t.preferredLayout}`);Ia(e,"preferredLayout",t.preferredLayout,n)}}break;case"wasm":case"cpu":continue;default:throw Error(`not supported execution provider: ${t}`)}let o=Pt(t,n),s=a.length,l=0,u=0;if(s>0){l=Be()._malloc(s*Be().PTR_SIZE),n.push(l),u=Be()._malloc(s*Be().PTR_SIZE),n.push(u);for(let e=0;e<s;e++)Be().setValue(l+e*Be().PTR_SIZE,a[e][0],"*"),Be().setValue(u+e*Be().PTR_SIZE,a[e][1],"*")}await Be()._OrtAppendExecutionProvider(e,o,l,u,s)!==0&&Ne(`Can't append execution provider: ${t}.`)}},Oy=async e=>{let t=Be(),n=0,i=[],a=e||{};VO(a);try{let e=BO(a.graphOptimizationLevel??"all"),o=FO(a.executionMode??"sequential"),s="string"==typeof a.logId?Pt(a.logId,i):0,l=a.logSeverityLevel??2;if(!Number.isInteger(l)||l<0||l>4)throw Error(`log severity level is not valid: ${l}`);let u=a.logVerbosityLevel??0;if(!Number.isInteger(u)||u<0||u>4)throw Error(`log verbosity level is not valid: ${u}`);let c="string"==typeof a.optimizedModelFilePath?Pt(a.optimizedModelFilePath,i):0;if(n=t._OrtCreateSessionOptions(e,!!a.enableCpuMemArena,!!a.enableMemPattern,o,!!a.enableProfiling,0,s,l,u,c),0===n&&Ne("Can't create session options."),a.executionProviders&&await GO(n,a.executionProviders,i),void 0!==a.enableGraphCapture){if("boolean"!=typeof a.enableGraphCapture)throw Error(`enableGraphCapture must be a boolean value: ${a.enableGraphCapture}`);Ia(n,"enableGraphCapture",a.enableGraphCapture.toString(),i)}if(a.freeDimensionOverrides)for(let[e,o]of Object.entries(a.freeDimensionOverrides)){if("string"!=typeof e)throw Error(`free dimension override name must be a string: ${e}`);if("number"!=typeof o||!Number.isInteger(o)||o<0)throw Error(`free dimension override value must be a non-negative integer: ${o}`);let a=Pt(e,i);0!==t._OrtAddFreeDimensionOverride(n,a,o)&&Ne(`Can't set a free dimension override: ${e} - ${o}.`)}return void 0!==a.extra&&Vo(a.extra,"",new WeakSet,(e,t)=>{Ia(n,e,t,i)}),[n,i]}catch(e){throw 0!==n&&0!==t._OrtReleaseSessionOptions(n)&&Ne("Can't release session options."),i.forEach(e=>t._free(e)),e}}}),le=k(()=>{_r=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw Error(`unsupported data type: ${e}`)}},Mn=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw Error(`unsupported data type: ${e}`)}},vr=(e,t)=>{let n=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][e],i="number"==typeof t?t:t.reduce((e,t)=>e*t,1);return n>0?Math.ceil(i*n):void 0},co=e=>{switch(e){case"float16":return"u">typeof Float16Array&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw Error(`unsupported type: ${e}`)}},Go=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw Error(`unsupported logging level: ${e}`)}},Sa=e=>"float32"===e||"float16"===e||"int32"===e||"int64"===e||"uint32"===e||"uint8"===e||"bool"===e||"uint4"===e||"int4"===e,$a=e=>"float32"===e||"float16"===e||"int32"===e||"int64"===e||"uint32"===e||"uint64"===e||"int8"===e||"uint8"===e||"bool"===e||"uint4"===e||"int4"===e,uc=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw Error(`unsupported data location: ${e}`)}}}),lc=k(()=>{pa(),Uo=async e=>{if("string"!=typeof e)return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e);{let t=await fetch(e);if(!t.ok)throw Error(`failed to load external data file: ${e}`);let n=t.headers.get("Content-Length"),i=n?parseInt(n,10):0;if(i<0x40000000)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw Error(`failed to load external data file: ${e}, no response body.`);let n=t.body.getReader(),a;try{a=new ArrayBuffer(i)}catch(e){if(e instanceof RangeError){let e=Math.ceil(i/65536);a=new WebAssembly.Memory({initial:e,maximum:e}).buffer}else throw e}let o=0;for(;;){let{done:e,value:t}=await n.read();if(e)break;let i=t.byteLength;new Uint8Array(a,o,i).set(t),o+=i}return new Uint8Array(a,0,i)}}}}),Bn=k(()=>{le(),UO=["V","I","W","E","F"],WO=(e,t)=>{console.log(`[${UO[e]},${new Date().toISOString()}]${t}`)},Aa=(e,t)=>{Ey=e,Cy=t},HO=(e,t)=>{let n=Go(e);n>=Go(Ey)&&WO(n,"function"==typeof t?t():t)},_e=(...e)=>{Cy&&HO(...e)}}),ge=k(()=>{cc=class{static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}},Fn=class{static calcShape(e,t,n=!1){let i=e.length,a=t.length;if(0===i)return t;if(0===a)return e;let o=Math.max(e.length,t.length),s=Array(o);if(n){if(i<2||a<2)return;let n=cc.calcMatMulShape([e[i-2],e[i-1]],[t[a-2],t[a-1]]);if(void 0===n)return;[s[o-2],s[o-1]]=n}for(let l=n?3:1;l<=o;l++){let n=i-l<0?1:e[i-l],u=a-l<0?1:t[a-l];if(n!==u&&n>1&&u>1)return;let c=Math.max(n,u);if(n&&u)s[o-l]=Math.max(n,u);else{if(c>1)return;s[o-l]=0}}return s}static isValidBroadcast(e,t){let n=e.length,i=t.length;if(n>i)return!1;for(let a=1;a<=n;a++)if(1!==e[n-a]&&e[n-a]!==t[i-a])return!1;return!0}},C=class e{static size(t){return e.getSizeFromDimensionRange(t,0,t.length)}static convertShape(e,t=4){let n=e.length;if(0===n)return[];let i=Array(n),a=n-1;for(;a>=0;){if(e[a]%t==0){i[a]=e[a]/t;break}if(t%e[a]!=0)throw Error("cannot convert shape");i[a]=1,t/=e[a],a--}for(a--;a>=0;a--)i[a]=e[a];return i}static sizeFromDimension(t,n){if(n<0||n>t.length)throw Error(`invalid dimension of ${n} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,n,t.length)}static sizeToDimension(t,n){if(n<0||n>t.length)throw Error(`invalid dimension of ${n} for sizeToDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,0,n)}static getSizeFromDimensionRange(e,t,n){let i=1;for(let a=t;a<n;a++){if(e[a]<0)throw Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");i*=Number(e[a])}return i}static computeStrides(e){let t=e.length;if(0===t)return[];if(1===t)return[1];let n=Array(t);n[t-1]=1,n[t-2]=e[t-1];for(let i=t-3;i>=0;--i)n[i]=n[i+1]*e[i+1];return n}static normalizeAxis(e,t){if(e<-t&&e>=t)throw Error("unsupported axis for this operation.");return e<0?e+t:e}static normalizeAxes(e,t){return e.map(n=>this.normalizeAxis(n,t??e.length))}static sortBasedOnPerm(e,t){return t?t.map(t=>e[t]):e.slice().reverse()}static padShape(e,t){let n=e.length;return e.map((e,i)=>e+t[i]+t[i+n])}static areEqual(e,t){return e.length===t.length&&e.every((e,n)=>e===t[n])}},Ur=class e{static adjustPoolAttributes(e,t,n,i,a,o){if(!e&&n.length!==t.length-2)throw Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(let e=0;e<t.length-2;e++)e>=n.length?n.push(t[e+2]):n[e]=t[e+2];for(let e=0;e<n.length;e++)if(e<i.length){if(i[e]<0)throw Error("strides should be greater than or equal to 1")}else i.push(1);for(let e=0;e<n.length;e++)if(e<a.length){if(a[e]<0)throw Error("dilations should be greater than or equal to 1")}else a.push(1);for(let e=0;e<2*n.length;e++)if(e<o.length){if(o[e]<0)throw Error("pad should be greater than or equal to 1")}else o.push(0);for(let e=0;e<n.length;e++){if(n[e]<=0)throw Error("kernel shapes need to be greater than 0");if(o[e]>=n[e]||o[e+n.length]>=n[e])throw Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,n,i,a,o,s,l){if(l){if(o.length!==2*(t.length-2))throw Error("length of pads should be twice the length of data dimensions");if(n.length!==t.length-2)throw Error("length of strides should be the length of data dimensions");if(a.length!==t.length-2)throw Error("length of kernel shapes should be the length of data dimensions");for(let u=0;u<t.length-2;u++)e.adjustPadAndReturnShape(t[u+(s?1:2)],n[u],i[u],a[u],o,u,u+t.length-2,l)}}static computePoolOutputShape(t,n,i,a,o,s,l){if(n.length<=0)throw Error("input shape must be of size greater than 0");let u=[n[0],n[1]];return e.computeShapeHelper(t,n,u,i,a,o,s,l),u}static computeConvOutputShape(t,n,i,a,o,s,l){if(t.length<=0||n.length<=0)throw Error("invalid input tensor dims or invalid filter tensor dims");let u=[t[0],n[0]];return e.computeShapeHelper(!1,t,u,i,a,o,s,l),u}static computeShapeHelper(t,n,i,a,o,s,l,u){if(t)for(let e=0;e<n.length-2;e++)i.push(1);else for(let t=0;t<n.length-2;t++)i.push(e.adjustPadAndReturnShape(n[t+2],a[t],o[t],s[t],l,t,t+n.length-2,u))}static adjustPadAndReturnShape(e,t,n,i,a,o,s,l){let u=n*(i-1)+1;if(!l||"NOTSET"===l)return Math.floor((e+a[o]+a[s]-u)/t+1);switch(l){case"VALID":return a[o]=0,a[s]=0,Math.floor((e-u)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(1!==n)throw Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let n=((e+t-1)/t-1)*t+i-e;return a[o]=Math.floor("SAME_LOWER"===l?(n+1)/2:n/2),a[s]=n-a[o],Math.floor((e+n-i)/t+1)}default:throw Error("Unsupported AutoPad type")}}},Oa=class{static getShapeOfGemmResult(e,t,n,i,a){let o,s,l;if(2!==e.length||2!==n.length)throw Error("shape need to be of size 2");t?(o=e[1],s=e[0]):(o=e[0],s=e[1]);let u=-1;if(i?(l=n[0],u=1):(l=n[1],u=0),n[u]!==s)throw Error("dimension mismatch");if(o<=0||l<=0||s<=0)throw Error("invalid shape specified");if(a&&!Fn.isValidBroadcast(a,[o,l]))throw Error("gemm: invalid bias shape for broadcast");return[o,l,s]}},Dy=-34028234663852886e22,ky=34028234663852886e22}),dc=k(()=>{le(),Pa=(e,t)=>new(co(t))(e)}),By=k(()=>{le(),Bn(),Ly=new Map([["float32",32],["float16",16],["int32",32],["uint32",32],["int64",64],["uint64",64],["int8",8],["uint8",8],["int4",4],["uint4",4]]),fc=(e,t)=>{if("int32"===t)return e;let n=Ly.get(t);if(!n)throw Error(`WebNN backend does not support data type: ${t}`);let i=n/8;if(e.byteLength%i!=0)throw Error(`Invalid Uint8Array length - must be a multiple of ${i}.`);let a=e.byteLength/i,o=new(co(t))(e.buffer,e.byteOffset,a);switch(t){case"int64":case"uint64":{let e=new Int32Array(a);for(let t=0;t<a;t++){let n=o[t];if(n>2147483647n||n<-2147483648n)throw Error("Can not convert int64 data to int32 - value out of range.");e[t]=Number(n)}return new Uint8Array(e.buffer)}case"int8":case"uint8":case"uint32":if("uint32"===t&&o.some(e=>e>0x7fffffff))throw Error("Can not convert uint32 data to int32 - value out of range.");return new Uint8Array(Int32Array.from(o,Number).buffer);default:throw Error(`Unsupported data conversion from ${t} to 'int32'`)}},Ry=(e,t)=>{if("int32"===t)return e;if(e.byteLength%4!=0)throw Error("Invalid Uint8Array length - must be a multiple of 4 (int32).");let n=e.byteLength/4,i=new Int32Array(e.buffer,e.byteOffset,n);switch(t){case"int64":return new Uint8Array(BigInt64Array.from(i,BigInt).buffer);case"uint64":if(i.some(e=>e<0))throw Error("Can not convert int32 data to uin64 - negative value found.");return new Uint8Array(BigUint64Array.from(i,BigInt).buffer);case"int8":if(i.some(e=>e<-128||e>127))throw Error("Can not convert int32 data to int8 - value out of range.");return new Uint8Array(Int8Array.from(i,Number).buffer);case"uint8":if(i.some(e=>e<0||e>255))throw Error("Can not convert int32 data to uint8 - value out of range.");return Uint8Array.from(i,Number);case"uint32":if(i.some(e=>e<0))throw Error("Can not convert int32 data to uint32 - negative value found.");return new Uint8Array(Uint32Array.from(i,Number).buffer);default:throw Error(`Unsupported data conversion from 'int32' to ${t}`)}},jO=1,Ny=()=>jO++,qO=new Map([["int8","int32"],["uint8","int32"],["uint32","int32"],["int64","int32"]]),zy=(e,t)=>{let n=Ly.get(e);if(!n)throw Error(`WebNN backend does not support data type: ${e}`);return t.length>0?Math.ceil(t.reduce((e,t)=>e*t)*n/8):0},Ea=class{constructor(e){this.isDataConverted=!1;let{sessionId:t,context:n,tensor:i,dataType:a,shape:o,fallbackDataType:s}=e;this.sessionId=t,this.mlContext=n,this.mlTensor=i,this.dataType=a,this.tensorShape=o,this.fallbackDataType=s}get tensor(){return this.mlTensor}get type(){return this.dataType}get fallbackType(){return this.fallbackDataType}get shape(){return this.tensorShape}get byteLength(){return zy(this.dataType,this.tensorShape)}destroy(){_e("verbose",()=>"[WebNN] TensorWrapper.destroy"),this.mlTensor.destroy()}write(e){this.mlContext.writeTensor(this.mlTensor,e)}async read(e){if(!this.fallbackDataType)return e?this.mlContext.readTensor(this.mlTensor,e):this.mlContext.readTensor(this.mlTensor);{let t=Ry(new Uint8Array(await this.mlContext.readTensor(this.mlTensor)),this.dataType);return e?void(e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).set(t):t.buffer}}canReuseTensor(e,t,n){return this.mlContext===e&&this.dataType===t&&this.tensorShape.length===n.length&&this.tensorShape.every((e,t)=>e===n[t])}setIsDataConverted(e){this.isDataConverted=e}},Ca=class{constructor(e,t){this.tensorManager=e,this.wrapper=t}get tensorWrapper(){return this.wrapper}releaseTensor(){this.tensorWrapper&&(this.tensorManager.releaseTensor(this.tensorWrapper),this.wrapper=void 0)}async ensureTensor(e,t,n,i){let a=this.tensorManager.getMLContext(e),o;if(!a.opSupportLimits().input.dataTypes.includes(t)){if(!(o=qO.get(t))||!a.opSupportLimits().input.dataTypes.includes(o))throw Error(`WebNN backend does not support data type: ${t}`);_e("verbose",()=>`[WebNN] TensorIdTracker.ensureTensor: fallback dataType from ${t} to ${o}`)}if(this.wrapper){if(this.wrapper.canReuseTensor(a,t,n))return this.wrapper.tensor;if(i){if(this.wrapper.byteLength!==zy(t,n))throw Error("Unable to copy data to tensor with different size.");this.activeUpload=new Uint8Array(await this.wrapper.read())}this.tensorManager.releaseTensor(this.wrapper)}let s=typeof MLTensorUsage>"u"?void 0:MLTensorUsage.READ|MLTensorUsage.WRITE;return this.wrapper=await this.tensorManager.getCachedTensor(e,t,n,s,!0,!0,o),i&&this.activeUpload&&(this.wrapper.write(this.activeUpload),this.activeUpload=void 0),this.wrapper.tensor}upload(e){let t=e;if(this.wrapper){if(this.wrapper.fallbackType)if("int32"===this.wrapper.fallbackType)t=fc(e,this.wrapper.type),this.wrapper.setIsDataConverted(!0);else throw Error(`Unsupported fallback data type: ${this.wrapper.fallbackType}`);if(e.byteLength===this.wrapper.byteLength)return void this.wrapper.write(t);_e("verbose",()=>"Data size does not match tensor size. Releasing tensor."),this.releaseTensor()}this.activeUpload?this.activeUpload.set(t):this.activeUpload=new Uint8Array(t)}async download(e){if(this.activeUpload){let t=this.wrapper?.isDataConverted?Ry(this.activeUpload,this.wrapper?.type):this.activeUpload;return e?void(e instanceof ArrayBuffer?new Uint8Array(e).set(t):new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(t)):t.buffer}if(!this.wrapper)throw Error("Tensor has not been created.");return e?this.wrapper.read(e):this.wrapper.read()}},pc=class{constructor(e){this.backend=e,this.tensorTrackersById=new Map,this.freeTensors=[],this.externalTensors=new Set}getMLContext(e){let t=this.backend.getMLContext(e);if(!t)throw Error("MLContext not found for session.");return t}reserveTensorId(){let e=Ny();return this.tensorTrackersById.set(e,new Ca(this)),e}releaseTensorId(e){let t=this.tensorTrackersById.get(e);t&&(this.tensorTrackersById.delete(e),t.tensorWrapper&&this.releaseTensor(t.tensorWrapper))}async ensureTensor(e,t,n,i,a){_e("verbose",()=>`[WebNN] TensorManager.ensureTensor {tensorId: ${t}, dataType: ${n}, shape: ${i}, copyOld: ${a}}`);let o=this.tensorTrackersById.get(t);if(!o)throw Error("Tensor not found.");return o.ensureTensor(e,n,i,a)}upload(e,t){let n=this.tensorTrackersById.get(e);if(!n)throw Error("Tensor not found.");n.upload(t)}async download(e,t){_e("verbose",()=>`[WebNN] TensorManager.download {tensorId: ${e}, dstBuffer: ${t?.byteLength}}`);let n=this.tensorTrackersById.get(e);if(!n)throw Error("Tensor not found.");return n.download(t)}releaseTensorsForSession(e){for(let t of this.freeTensors)t.sessionId===e&&t.destroy();this.freeTensors=this.freeTensors.filter(t=>t.sessionId!==e)}registerTensor(e,t,n,i){let a=this.getMLContext(e),o=Ny(),s=new Ea({sessionId:e,context:a,tensor:t,dataType:n,shape:i});return this.tensorTrackersById.set(o,new Ca(this,s)),this.externalTensors.add(s),o}async getCachedTensor(e,t,n,i,a,o,s){let l=this.getMLContext(e);for(let[i,a]of this.freeTensors.entries())if(a.canReuseTensor(l,t,n)){_e("verbose",()=>`[WebNN] Reusing tensor {dataType: ${t}, ${s?`fallbackDataType: ${s},`:""} shape: ${n}`);let a=this.freeTensors.splice(i,1)[0];return a.sessionId=e,a}_e("verbose",()=>`[WebNN] MLContext.createTensor {dataType: ${t}, ${s?`fallbackDataType: ${s},`:""} shape: ${n}}`);let u=await l.createTensor({dataType:s??t,shape:n,dimensions:n,usage:i,writable:a,readable:o});return new Ea({sessionId:e,context:l,tensor:u,dataType:t,shape:n,fallbackDataType:s})}releaseTensor(e){this.externalTensors.has(e)&&this.externalTensors.delete(e),this.freeTensors.push(e)}},My=(...e)=>new pc(...e)}),Fy=k(()=>{le(),yr(),dc(),By(),Bn(),Da=new Map([[1,"float32"],[10,"float16"],[6,"int32"],[12,"uint32"],[7,"int64"],[13,"uint64"],[22,"int4"],[21,"uint4"],[3,"int8"],[2,"uint8"],[9,"uint8"]]),KO=(e,t)=>{if(e===t)return!0;if(void 0===e||void 0===t)return!1;let n=Object.keys(e).sort(),i=Object.keys(t).sort();return n.length===i.length&&n.every((n,a)=>n===i[a]&&e[n]===t[n])},ka=class{constructor(e){this.tensorManager=My(this),this.mlContextBySessionId=new Map,this.sessionIdsByMLContext=new Map,this.mlContextCache=[],this.sessionGraphInputs=new Map,this.sessionGraphOutputs=new Map,this.temporaryGraphInputs=[],this.temporaryGraphOutputs=[],this.temporarySessionTensorIds=new Map,Aa(e.logLevel,!!e.debug)}get currentSessionId(){if(void 0===this.activeSessionId)throw Error("No active session");return this.activeSessionId}onRunStart(e){_e("verbose",()=>`[WebNN] onRunStart {sessionId: ${e}}`),this.activeSessionId=e}onRunEnd(e){_e("verbose",()=>`[WebNN] onRunEnd {sessionId: ${e}}`);let t=this.temporarySessionTensorIds.get(e);if(t){for(let e of t)_e("verbose",()=>`[WebNN] releasing temporary tensor {tensorId: ${e}}`),this.tensorManager.releaseTensorId(e);this.temporarySessionTensorIds.delete(e),this.activeSessionId=void 0}}async createMLContext(e){if(e instanceof GPUDevice){let t=this.mlContextCache.findIndex(t=>t.gpuDevice===e);if(-1!==t)return this.mlContextCache[t].mlContext;{let t=await navigator.ml.createContext(e);return this.mlContextCache.push({gpuDevice:e,mlContext:t}),t}}if(void 0===e){let e=this.mlContextCache.findIndex(e=>void 0===e.options&&void 0===e.gpuDevice);if(-1!==e)return this.mlContextCache[e].mlContext;{let e=await navigator.ml.createContext();return this.mlContextCache.push({mlContext:e}),e}}let t=this.mlContextCache.findIndex(t=>KO(t.options,e));if(-1!==t)return this.mlContextCache[t].mlContext;{let t=await navigator.ml.createContext(e);return this.mlContextCache.push({options:e,mlContext:t}),t}}registerMLContext(e,t){this.mlContextBySessionId.set(e,t);let n=this.sessionIdsByMLContext.get(t);n||(n=new Set,this.sessionIdsByMLContext.set(t,n)),n.add(e),this.temporaryGraphInputs.length>0&&(this.sessionGraphInputs.set(e,this.temporaryGraphInputs),this.temporaryGraphInputs=[]),this.temporaryGraphOutputs.length>0&&(this.sessionGraphOutputs.set(e,this.temporaryGraphOutputs),this.temporaryGraphOutputs=[])}onReleaseSession(e){this.sessionGraphInputs.delete(e),this.sessionGraphOutputs.delete(e);let t=this.mlContextBySessionId.get(e);if(!t)return;this.tensorManager.releaseTensorsForSession(e),this.mlContextBySessionId.delete(e);let n=this.sessionIdsByMLContext.get(t);if(n.delete(e),0===n.size){this.sessionIdsByMLContext.delete(t);let e=this.mlContextCache.findIndex(e=>e.mlContext===t);-1!==e&&this.mlContextCache.splice(e,1)}}getMLContext(e){return this.mlContextBySessionId.get(e)}reserveTensorId(){return this.tensorManager.reserveTensorId()}releaseTensorId(e){_e("verbose",()=>`[WebNN] releaseTensorId {tensorId: ${e}}`),this.tensorManager.releaseTensorId(e)}async ensureTensor(e,t,n,i,a){let o=Da.get(n);if(!o)throw Error(`Unsupported ONNX data type: ${n}`);return this.tensorManager.ensureTensor(e??this.currentSessionId,t,o,i,a)}async createTemporaryTensor(e,t,n){_e("verbose",()=>`[WebNN] createTemporaryTensor {onnxDataType: ${t}, shape: ${n}}`);let i=Da.get(t);if(!i)throw Error(`Unsupported ONNX data type: ${t}`);let a=this.tensorManager.reserveTensorId();await this.tensorManager.ensureTensor(e,a,i,n,!1);let o=this.temporarySessionTensorIds.get(e);return o?o.push(a):this.temporarySessionTensorIds.set(e,[a]),a}uploadTensor(e,t){if(!Be().shouldTransferToMLTensor)throw Error("Trying to upload to a MLTensor while shouldTransferToMLTensor is false");_e("verbose",()=>`[WebNN] uploadTensor {tensorId: ${e}, data: ${t.byteLength}}`),this.tensorManager.upload(e,t)}async downloadTensor(e,t){return this.tensorManager.download(e,t)}createMLTensorDownloader(e,t){return async()=>{let n=await this.tensorManager.download(e);return Pa(n,t)}}registerMLTensor(e,t,n,i){let a=Da.get(n);if(!a)throw Error(`Unsupported ONNX data type: ${n}`);let o=this.tensorManager.registerTensor(e,t,a,i);return _e("verbose",()=>`[WebNN] registerMLTensor {tensor: ${t}, dataType: ${a}, dimensions: ${i}} -> {tensorId: ${o}}`),o}registerMLConstant(e,t,n,i,a,o,s=!1){if(!o)throw Error("External mounted files are not available.");let l=e;e.startsWith("./")&&(l=e.substring(2));let u=o.get(l);if(!u)throw Error(`File with name ${l} not found in preloaded files.`);if(t+n>u.byteLength)throw Error("Out of bounds: data offset and length exceed the external file data size.");let c=u.slice(t,t+n).buffer,d;switch(a.dataType){case"float32":d=new Float32Array(c);break;case"float16":d="u">typeof Float16Array&&Float16Array.from?new Float16Array(c):new Uint16Array(c);break;case"int32":d=new Int32Array(c);break;case"uint32":d=new Uint32Array(c);break;case"int64":s?(d=new Int32Array(fc(new Uint8Array(c),"int64").buffer),a.dataType="int32"):d=new BigInt64Array(c);break;case"uint64":d=new BigUint64Array(c);break;case"int8":d=new Int8Array(c);break;case"int4":case"uint4":case"uint8":d=new Uint8Array(c);break;default:throw Error(`Unsupported data type: ${a.dataType} in creating WebNN Constant from external data.`)}return _e("verbose",()=>`[WebNN] registerMLConstant {dataType: ${a.dataType}, shape: ${a.shape}}} ${s?"(Note: it was int64 data type and registered to int32 as workaround)":""}`),i.constant(a,d)}registerGraphInput(e){this.temporaryGraphInputs.push(e)}registerGraphOutput(e){this.temporaryGraphOutputs.push(e)}isGraphInput(e,t){let n=this.sessionGraphInputs.get(e);return!!n&&n.includes(t)}isGraphOutput(e,t){let n=this.sessionGraphOutputs.get(e);return!!n&&n.includes(t)}isGraphInputOutputTypeSupported(e,t,n=!0){let i=this.mlContextBySessionId.get(e),a=Da.get(_r(t));return!(typeof a>"u")&&(n?!!i?.opSupportLimits().input.dataTypes.includes(a):!!i?.opSupportLimits().output.dataTypes.includes(a))}flush(){}}}),Na=k(()=>{}),Hy=k(()=>{Bn(),Na(),Vy=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[0xc00000,10],[0x1000000,10],[0x1900000,15],[0x2000000,22],[0x2a30000,2],[0x3840000,6],[0x4000000,6],[0x8000000,6],[0xa000000,6]]),hc=[],mc=e=>16*Math.ceil(Number(e)/16),XO=e=>{for(let t=0;t<hc.length;t++){let n=hc[t];if(e<=n)return n}return 16*Math.ceil(e/16)},ZO=1,Gy=()=>ZO++,bc=async(e,t,n,i)=>{let a=mc(n),o=e.device.createBuffer({size:a,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let s=e.getCommandEncoder();e.endComputePass(),s.copyBufferToBuffer(t,0,o,0,a),e.flush(),await o.mapAsync(GPUMapMode.READ);let l=o.getMappedRange();if(!i)return new Uint8Array(l.slice(0,n));{let e=i();return e.set(new Uint8Array(l,0,n)),e}}finally{o.destroy()}},gc=class{constructor(e){for(let[t]of(this.backend=e,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersPending=[],this.capturedPendingBuffers=new Map,Vy))hc.push(t),this.freeBuffers.set(t,[]),this.freeUniformBuffers.set(t,[]);this.sessionCount=0}upload(e,t){let n=t.buffer,i=t.byteOffset,a=t.byteLength,o=mc(a),s=this.storageCache.get(e);if(!s)throw Error("gpu data for uploading does not exist");if(Number(s.originalSize)!==a)throw Error(`inconsistent data size. gpu data size=${s.originalSize}, data size=${a}`);let l=this.backend.device.createBuffer({mappedAtCreation:!0,size:o,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC});new Uint8Array(l.getMappedRange()).set(new Uint8Array(n,i,a)),l.unmap();let u=this.backend.device.createCommandEncoder();u.copyBufferToBuffer(l,0,s.gpuData.buffer,0,o),this.backend.device.queue.submit([u.finish()]),l.destroy(),_e("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${e})`)}memcpy(e,t){let n=this.storageCache.get(e);if(!n)throw Error("source gpu data for memcpy does not exist");let i=this.storageCache.get(t);if(!i)throw Error("destination gpu data for memcpy does not exist");if(n.originalSize!==i.originalSize)throw Error("inconsistent source and destination gpu data size");let a=mc(n.originalSize),o=this.backend.getCommandEncoder();this.backend.endComputePass(),o.copyBufferToBuffer(n.gpuData.buffer,0,i.gpuData.buffer,0,a)}registerExternalBuffer(e,t,n){let i;if(n){if(i=n[0],e===n[1])return _e("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${i}, buffer is the same, skip.`),i;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw Error(`Registering a different external buffer under graph capture mode is not supported yet.
             Please use the previous external buffer!`)}else i=Gy();return this.storageCache.set(i,{gpuData:{id:i,type:0,buffer:e},originalSize:t}),_e("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${i}, registered.`),i}unregisterExternalBuffer(e){void 0!==e&&(this.storageCache.delete(e),_e("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${e}`))}create(e,t=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let n=XO(e),i,a=(t&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,o=(t&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(a||o){let e=(a?this.freeBuffers:this.freeUniformBuffers).get(n);i=e&&e.length>0?e.pop():this.backend.device.createBuffer({size:n,usage:t})}else i=this.backend.device.createBuffer({size:n,usage:t});let s={id:Gy(),type:0,buffer:i};return this.storageCache.set(s.id,{gpuData:s,originalSize:Number(e)}),_e("verbose",()=>`[WebGPU] GpuDataManager.create(size=${e}) => id=${s.id}`),s}get(e){return this.storageCache.get(e)?.gpuData}release(e){let t="bigint"==typeof e?Number(e):e,n=this.storageCache.get(t);if(!n){if(0===this.storageCache.size)return 0;throw Error("releasing data does not exist")}return _e("verbose",()=>`[WebGPU] GpuDataManager.release(id=${t}), gpuDataId=${n.gpuData.id}`),this.storageCache.delete(t),this.buffersPending.push(n.gpuData.buffer),n.originalSize}async download(e,t){let n=this.storageCache.get(Number(e));if(!n)throw Error("data does not exist");await bc(this.backend,n.gpuData.buffer,n.originalSize,t)}refreshPendingBuffers(){if(0!==this.buffersPending.length)if("default"===this.backend.sessionStatus){for(let e of this.buffersPending){let t=Vy.get(e.size);if((e.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let n=this.freeBuffers.get(e.size)||[];void 0===t||n.length>=t?e.destroy():n.push(e)}else if((e.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let n=this.freeUniformBuffers.get(e.size)||[];void 0===t||n.length>=t?e.destroy():n.push(e)}else e.destroy()}this.buffersPending=[]}else{let e=this.capturedPendingBuffers.get(this.backend.currentSessionId);for(let t of(e||(e=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,e)),this.buffersPending))e.push(t);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(e=>{e.forEach(e=>{e.destroy()})}),this.freeUniformBuffers.forEach(e=>{e.forEach(e=>{e.destroy()})}),this.storageCache.forEach(e=>{e.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(e=>{e.forEach(e=>{e.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onCreateSession(){this.sessionCount+=1}onReleaseSession(e){let t=this.capturedPendingBuffers.get(e);t&&(t.forEach(e=>{e.destroy()}),this.capturedPendingBuffers.delete(e)),this.sessionCount-=1,0===this.sessionCount&&(_e("warning",()=>"[WebGPU] Clearing webgpu buffer cache"),this.storageCache.forEach(e=>{e.gpuData.buffer.destroy()}),this.storageCache=new Map)}},Wy=(...e)=>new gc(...e)}),Xe=k(()=>{yc=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(e=>`${this[e]}`).join(";")),this.key}},ce=e=>new yc(e)}),ye=k(()=>{le(),ge(),Wr=64,vc=(e,t)=>{if(3===t)throw Error("vec3 has same alignment as vec4, use vec4 instead");switch(Number(e)){case 10:return t>1?`vec${t}<f16>`:"f16";case 1:return t>1?`vec${t}<f32>`:"f32";case 6:return t>1?`vec${t}<i32>`:"i32";case 12:return t>1?`vec${t}<u32>`:"u32";case 7:if(t>1)throw Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(4!==t)throw Error("bool must be vec4");return["u32","vec4<bool>"];case 22:return"i32";case 21:return"u32";default:throw Error(`Unknown data type: ${e}`)}},Ve=(e,t=1)=>{let n=vc(e,t);return"string"==typeof n?n:n[0]},it=(e,t=1)=>{let n=vc(e,t);return"string"==typeof n?n:n[1]},W=(...e)=>{let t=[];return e.forEach(e=>{0!==e.length&&t.push({type:12,data:e},{type:12,data:C.computeStrides(e)})}),t},Ee=e=>e%4==0?4:e%2==0?2:1,wc=(e="f32",t,n="0")=>t&&1!==t?`vec${t}<${e}>(${n})`:`${e}(${n})`,Hr=(e,t,n)=>"f32"===e?n:1===t?`f32(${n})`:`vec${t}<f32>(${n})`,Kt=(e,t)=>4===t?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:2===t?`(${e}.x + ${e}.y)`:3===t?`(${e}.x + ${e}.y + ${e}.z)`:e,Q=(e,t,n,i)=>e.startsWith("uniforms.")&&n>4?"string"==typeof t?"f16"===i?`${e}[(${t}) / 8][(${t}) % 8 / 4][(${t}) % 8 % 4]`:`${e}[(${t}) / 4][(${t}) % 4]`:"f16"===i?`${e}[${Math.floor(t/8)}][${Math.floor(t%8/4)}][${t%8%4}]`:`${e}[${Math.floor(t/4)}][${t%4}]`:n>1?`${e}[${t}]`:e,La=(e,t,n,i,a)=>{let o="number"==typeof n,s=o?n:n.length,l=[...Array(s).keys()],u=s<2?"u32":s<=4?`vec${s}<u32>`:`array<u32, ${s}>`,c=vc(t,a),d="string"==typeof c?c:c[1],p={indices:u,value:d,storage:"string"==typeof c?c:c[0],tensor:t},h=e=>"string"==typeof e?e:`${e}u`,f={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},g=o?"uniforms.":"",m=`${g}${e}_shape`,y=`${g}${e}_strides`,b="";for(let e=0;e<s-1;e++)b+=`
    let dim${e} = current / ${Q(y,e,s)};
    let rest${e} = current % ${Q(y,e,s)};
    indices[${e}] = dim${e};
    current = rest${e};
    `;b+=`indices[${s-1}] = current;`;let v=s<2?"":`
  fn o2i_${e}(offset: u32) -> ${p.indices} {
    var indices: ${p.indices};
    var current = offset;
    ${b}
    return indices;
  }`,x=t=>(f.offsetToIndices=!0,s<2?t:`o2i_${e}(${t})`),w=[];if(s>=2)for(let e=s-1;e>=0;e--)w.push(`${Q(y,e,s)} * (indices[${e}])`);let _=s<2?"":`
  fn i2o_${e}(indices: ${p.indices}) -> u32 {
    return ${w.join("+")};
  }`,S=t=>(f.indicesToOffset=!0,s<2?t:`i2o_${e}(${t})`),k=(...e)=>0===s?"0u":`${p.indices}(${e.map(h).join(",")})`,T=(e,t)=>s<2?`${e}`:`${Q(e,t,s)}`,E=(e,t,n)=>s<2?`${e}=${n};`:`${Q(e,t,s)}=${n};`,I={},$=(t,n)=>{f.broadcastedIndicesToOffset=!0;let i=`${n.name}broadcastedIndicesTo${e}Offset`;if(i in I)return`${i}(${t})`;let a=[];for(let e=s-1;e>=0;e--){let t=n.indicesGet("outputIndices",e+n.rank-s);a.push(`${T(y,e)} * (${t} % ${T(m,e)})`)}return I[i]=`fn ${i}(outputIndices: ${n.type.indices}) -> u32 {
             return ${a.length>0?a.join("+"):"0u"};
           }`,`${i}(${t})`},O=(t,n)=>(()=>{if(p.storage===p.value)return`${e}[${t}]=${n};`;if("vec2<u32>"===p.storage&&"i32"===p.value)return`${e}[${t}]=vec2<u32>(u32(${n}), select(0u, 0xFFFFFFFFu, ${n} < 0));`;if("vec2<u32>"===p.storage&&"u32"===p.value)return`${e}[${t}]=vec2<u32>(u32(${n}), 0u);`;if("u32"===p.storage&&"vec4<bool>"===p.value)return`${e}[${t}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${n}));`;throw Error(`not supported combination of storage type ${p.storage} and value type ${p.value} yet`)})(),A=t=>(()=>{if(p.storage===p.value)return`${e}[${t}]`;if("vec2<u32>"===p.storage&&"i32"===p.value)return`i32(${e}[${t}].x)`;if("vec2<u32>"===p.storage&&"u32"===p.value)return`u32(${e}[${t}].x)`;if("u32"===p.storage&&"vec4<bool>"===p.value)return`vec4<bool>(bool(${e}[${t}] & 0xFFu), bool(${e}[${t}] & 0xFF00u), bool(${e}[${t}] & 0xFF0000u), bool(${e}[${t}] & 0xFF000000u))`;throw Error(`not supported combination of storage type ${p.storage} and value type ${p.value} yet`)})(),P=s<2?"":`
  fn get_${e}ByIndices(indices: ${p.indices}) -> ${d} {
    return ${A(`i2o_${e}(indices)`)};
  }`,D=s<2?"":(()=>{let t=l.map(e=>`d${e}: u32`).join(", "),n=l.map(e=>`d${e}`).join(", ");return`
  fn get_${e}(${t}) -> ${d} {
    return get_${e}ByIndices(${k(n)});
  }`})(),M=(...t)=>{if(t.length!==s)throw Error(`indices length must be ${s}`);let n=t.map(h).join(",");return 0===s?A("0u"):1===s?A(n[0]):(f.get=!0,f.getByIndices=!0,f.indicesToOffset=!0,`get_${e}(${n})`)},z=t=>s<2?A(t):(f.getByIndices=!0,f.indicesToOffset=!0,`get_${e}ByIndices(${t})`),j=s<2?"":`
  fn set_${e}ByIndices(indices: ${p.indices}, value: ${d}) {
    ${O(`i2o_${e}(indices)`,"value")}
  }`,R=s<2?"":(()=>{let t=l.map(e=>`d${e}: u32`).join(", "),n=l.map(e=>`d${e}`).join(", ");return`
  fn set_${e}(${t}, value: ${d}) {
    set_${e}ByIndices(${k(n)}, value);
  }`})();return{impl:()=>{let e=[],t=!1;return f.offsetToIndices&&(e.push(v),t=!0),f.indicesToOffset&&(e.push(_),t=!0),f.broadcastedIndicesToOffset&&(Object.values(I).forEach(t=>e.push(t)),t=!0),f.set&&(e.push(R),t=!0),f.setByIndices&&(e.push(j),t=!0),f.get&&(e.push(D),t=!0),f.getByIndices&&(e.push(P),t=!0),!o&&t&&e.unshift(`const ${m} = ${p.indices}(${n.join(",")});`,`const ${y} = ${p.indices}(${C.computeStrides(n).join(",")});`),e.join(`
`)},type:p,offsetToIndices:x,indicesToOffset:S,broadcastedIndicesToOffset:$,indices:k,indicesGet:T,indicesSet:E,set:(...t)=>{if(t.length!==s+1)throw Error(`indices length must be ${s}`);let n=t[s];if("string"!=typeof n)throw Error("value must be string");let i=t.slice(0,s).map(h).join(",");return 0===s?O("0u",n):1===s?O(i[0],n):(f.set=!0,f.setByIndices=!0,f.indicesToOffset=!0,`set_${e}(${i}, ${n})`)},setByOffset:O,setByIndices:(t,n)=>s<2?O(t,n):(f.setByIndices=!0,f.indicesToOffset=!0,`set_${e}ByIndices(${t}, ${n});`),get:M,getByOffset:A,getByIndices:z,usage:i,name:e,strides:y,shape:m,rank:s}},N=(e,t,n,i=1)=>La(e,t,n,"input",i),G=(e,t,n,i=1)=>La(e,t,n,"output",i),jy=(e,t,n)=>La(e,t,n,"atomicOutput",1),Ra=(e,t,n,i=1)=>La(e,t,n,"internal",i),_c=class{constructor(e,t){this.normalizedDispatchGroup=e,this.limits=t,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(e){return`if (global_idx >= ${"number"==typeof e?`${e}u`:e}) { return; }`}mainStart(e=Wr){let t="number"==typeof e?e:e[0],n="number"==typeof e?1:e[1],i="number"==typeof e?1:e[2];if(t>this.limits.maxComputeWorkgroupSizeX||n>this.limits.maxComputeWorkgroupSizeY||i>this.limits.maxComputeWorkgroupSizeZ)throw Error(`workgroup size [${t}, ${n}, ${i}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(t*n*i>this.limits.maxComputeInvocationsPerWorkgroup)throw Error(`workgroup size [${t}, ${n}, ${i}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let a=1===this.normalizedDispatchGroup[1]&&1===this.normalizedDispatchGroup[2],o=a?`@builtin(global_invocation_id) global_id : vec3<u32>,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,
                                             @builtin(local_invocation_id) local_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(num_workgroups) num_workgroups : vec3<u32>`,s=a?`let global_idx = global_id.x;
         let workgroup_index = workgroup_id.x;`:`let workgroup_index = workgroup_id.z * num_workgroups[0] * num_workgroups[1] +
             workgroup_id.y * num_workgroups[0] + workgroup_id.x;
         let global_idx = workgroup_index * ${t*n*i}u + local_idx;`;return`@compute @workgroup_size(${t}, ${n}, ${i})
  fn main(${o}) {
    ${s}
  `}appendVariableUniforms(e){0!==e.rank&&(e.shape.startsWith("uniforms.")&&this.uniforms.push({name:e.shape.replace("uniforms.",""),type:"u32",length:e.rank}),e.strides.startsWith("uniforms.")&&this.uniforms.push({name:e.strides.replace("uniforms.",""),type:"u32",length:e.rank}))}declareVariable(e,t){if("internal"===e.usage)throw Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(e),this.appendVariableUniforms(e);let n="input"===e.usage?"read":"read_write",i="atomicOutput"===e.usage?"atomic<i32>":e.type.storage;return`@group(0) @binding(${t}) var<storage, ${n}> ${e.name}: array<${i}>;`}declareVariables(...e){return e.map(e=>this.declareVariable(e,this.variableIndex++)).join(`
`)}registerInternalVariable(e){if("internal"!==e.usage)throw Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(e),this.appendVariableUniforms(e)}registerInternalVariables(...e){return e.forEach(e=>this.registerInternalVariable(e)),this}registerUniform(e,t,n=1){return this.uniforms.push({name:e,type:t,length:n}),this}registerUniforms(e){return this.uniforms=this.uniforms.concat(e),this}uniformDeclaration(){if(0===this.uniforms.length)return"";let e=[];for(let{name:t,type:n,length:i}of this.uniforms)if(i&&i>4)"f16"===n?e.push(`@align(16) ${t}:array<mat2x4<${n}>, ${Math.ceil(i/8)}>`):e.push(`${t}:array<vec4<${n}>, ${Math.ceil(i/4)}>`);else{let a=null==i||1===i?n:`vec${i}<${n}>`;e.push(`${t}:${a}`)}return`
      struct Uniforms { ${e.join(", ")} };
      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(e=>e.impl()).join(`
`)+this.internalVariables.map(e=>e.impl()).join(`
`)}get variablesInfo(){if(0===this.uniforms.length)return;let e=e=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(e)];return this.uniforms.map(t=>[e(t.type),t.length??1])}},qy=(e,t)=>new _c(e,t)}),Yn=k(()=>{le(),ge(),Xe(),ye(),JO=(e,t)=>{if(!e||1!==e.length)throw Error("Transpose requires 1 input.");if(0!==t.length&&t.length!==e[0].dims.length)throw Error(`perm size ${t.length} does not match input rank ${e[0].dims.length}`)},Ky=(e,t)=>0!==t.length?t:[...Array(e).keys()].reverse(),YO=(e,t)=>C.sortBasedOnPerm(e,Ky(e.length,t)),QO=(e,t,n,i)=>{let a=`fn perm(i: ${i.type.indices}) -> ${n.type.indices} {
    var a: ${n.type.indices};`;for(let n=0;n<t;++n)a+=`a[${e[n]}]=i[${n}];`;return a+"return a;}"},eP=(e,t)=>{let n=[],i=[];for(let a=0;a<e.length;++a)1!==e[a]&&n.push(e[a]),1!==e[t[a]]&&i.push(t[a]);return{newShape:n,newPerm:i}},tP=(e,t)=>{let n=0;for(let i=0;i<e.length;++i)if(1!==t[e[i]]){if(e[i]<n)return!1;n=e[i]}return!0},at=(e,t)=>{let n=e.dataType,i=e.dims.length,a=Ky(i,t),o=YO(e.dims,a),s=e.dims,l=o,u;if(i<2||tP(a,e.dims))return{name:"TransposeCopy",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let t=C.size(o);return{outputs:[{dims:o,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(t/64/4)},programUniforms:[{type:12,data:Math.ceil(t/4)}]}},getShaderSource:u=e=>{let t=N("input",n,s,4),i=G("output",n,l,4);return`
  ${e.registerUniform("output_size","u32").declareVariables(t,i)}
  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    output[global_idx] = input[global_idx];
  }`}};let{newShape:c,newPerm:d}=eP(e.dims,a),p=C.areEqual(d,[2,3,1]),h=C.areEqual(d,[3,1,2]);if(2===c.length||p||h){l=[(s=p?[c[0],c[1]*c[2]]:h?[c[0]*c[1],c[2]]:c)[1],s[0]];let t=16;return{name:"TransposeShared",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let n=C.size(o);return{outputs:[{dims:o,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(l[1]/t),y:Math.ceil(l[0]/t)},programUniforms:[{type:12,data:n},...W(s,l)]}},getShaderSource:u=e=>{let i=N("a",n,s.length),a=G("output",n,l.length);return`
  ${e.registerUniform("output_size","u32").declareVariables(i,a)}
  var<workgroup> tile : array<array<${a.type.value}, ${t+1}>, ${t}>;
  ${e.mainStart([t,t,1])}
    let stride = (uniforms.output_shape[1] - 1) / ${t} + 1;
    let workgroup_id_x = workgroup_index % stride;
    let workgroup_id_y = workgroup_index / stride;
    let input_col = workgroup_id_y * ${t}u + local_id.x;
    let input_row = workgroup_id_x * ${t}u + local_id.y;
    if (input_row < uniforms.a_shape[0] && input_col < uniforms.a_shape[1]) {
      tile[local_id.y][local_id.x] = ${i.getByIndices(`${i.type.indices}(input_row, input_col)`)};
    }
    workgroupBarrier();

    let output_col = workgroup_id_x * ${t}u + local_id.x;
    let output_row = workgroup_id_y * ${t}u + local_id.y;
    if (output_row < uniforms.output_shape[0] && output_col < uniforms.output_shape[1]) {
      ${a.setByIndices(`${a.type.indices}(output_row, output_col)`,"tile[local_id.x][local_id.y]")}
    }
  }`}}}return{name:"Transpose",shaderCache:{hint:`${t}`,inputDependencies:["rank"]},getRunData:()=>{let t=C.size(o);return{outputs:[{dims:o,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(t/64)},programUniforms:[{type:12,data:t},...W(s,l)]}},getShaderSource:u=e=>{let t=N("a",n,s.length),o=G("output",n,l.length);return`
  ${e.registerUniform("output_size","u32").declareVariables(t,o)}

  ${QO(a,i,t,o)}

  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${o.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${o.setByOffset("global_idx",t.getByIndices("aIndices"))}
  }`}}},Xy=(e,t)=>{JO(e.inputs,t.perm),e.compute(at(e.inputs[0],t.perm))},Zy=e=>ce({perm:e.perm})}),s_=k(()=>{le(),ge(),ye(),za(),Yn(),nP={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},rP={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},oP={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},iP={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},aP=(e,t)=>{let n=[];for(let i=t-e;i<t;++i)n.push(i);return n},sP=(e,t)=>{let n=[],i=e.length;for(let a=0;a<i;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map(t=>e[t])]},uP=(e,t)=>{let n=e.length+t.length,i=[],a=0;for(let o=0;o<n;o++)-1===t.indexOf(o)?i.push(e[a++]):i.push(1);return i},lP=(e,t)=>{for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0},cP=(e,t)=>{let n=[];if(!lP(e,t)){for(let i=0;i<t;++i)-1===e.indexOf(i)&&n.push(i);e.forEach(e=>n.push(e))}return n},dP=(e,t,n,i,a,o,s)=>{let l=n[0].dims,u=C.size(o),c=C.size(s),d=N("_A",n[0].dataType,l),p=G("output",a,o),h=64;1===u&&(h=256);let f=`
          var<workgroup> aBestValues : array<f32, ${h}>;
       `,g=e=>`
        ${e.registerUniform("reduceSize","u32").declareVariables(d,p)}
        ${f}
        fn DIV_CEIL(a : u32, b : u32) -> u32 {
          return ((a - 1u) / b + 1u);
         }
         ${e.mainStart(h)}

          let outputIndex = global_idx / ${h};
          let offset = outputIndex * uniforms.reduceSize;

          var bestValue = f32(${oP[i]});
          let Length = uniforms.reduceSize;
          for (var k = local_idx; k < Length; k = k + ${h}) {
           let candidate = f32(${d.getByOffset("offset + k")});
           bestValue = ${nP[i]};
          }
          aBestValues[local_idx] = bestValue;
          workgroupBarrier();

         var reduceSize = min(Length, ${h}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (local_idx < currentSize) {
            let candidate = aBestValues[local_idx + interval];
            bestValue = ${rP[i]};
            aBestValues[local_idx] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (local_idx == 0u) {
          ${p.setByOffset("outputIndex",`${"mean"===i?`${p.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${p.type.storage}(${iP[i]})`}`)};
         }
        }`;return{name:e,shaderCache:{hint:`${t};${h}`,inputDependencies:["type"]},getShaderSource:g,getRunData:()=>({outputs:[{dims:o,dataType:a}],dispatchGroup:{x:u},programUniforms:[{type:12,data:c}]})}},Vn=(e,t,n,i)=>{let a=1===e.inputs.length?n:xc(e.inputs,n),o=a.axes;0!==o.length||a.noopWithEmptyAxes||(o=e.inputs[0].dims.map((e,t)=>t));let s=C.normalizeAxes(o,e.inputs[0].dims.length),l=s,u=e.inputs[0],c=cP(l,e.inputs[0].dims.length);c.length>0&&(u=e.compute(at(e.inputs[0],c),{inputs:[0],outputs:[-1]})[0],l=aP(l.length,u.dims.length));let[d,p]=sP(u.dims,l),h=d;a.keepDims&&(h=uP(d,s)),e.compute(dP(t,a.cacheKey,[u],i,e.inputs[0].dataType,h,p),{inputs:[u]})},Jy=(e,t)=>{Vn(e,"ReduceMeanShared",t,"mean")},Yy=(e,t)=>{Vn(e,"ReduceL1Shared",t,"l1")},Qy=(e,t)=>{Vn(e,"ReduceL2Shared",t,"l2")},e_=(e,t)=>{Vn(e,"ReduceLogSumExpShared",t,"logSumExp")},t_=(e,t)=>{Vn(e,"ReduceMaxShared",t,"max")},n_=(e,t)=>{Vn(e,"ReduceMinShared",t,"min")},r_=(e,t)=>{Vn(e,"ReduceProdShared",t,"prod")},o_=(e,t)=>{Vn(e,"ReduceSumShared",t,"sum")},i_=(e,t)=>{Vn(e,"ReduceSumSquareShared",t,"sumSquare")},a_=(e,t)=>{Vn(e,"ReduceLogSumShared",t,"logSum")}}),za=k(()=>{le(),ge(),Xe(),ye(),s_(),Gn=e=>{if(!e||0===e.length||e.length>2)throw Error("Reduce op requires 1 or 2 inputs.");if(2===e.length&&1!==e[1].dims.length)throw Error("Invalid axes input dims.")},pP=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],Ma=(e,t,n,i,a,o,s=!1,l=!1)=>{let u=[],c=n[0].dims,d=c.length,p=C.normalizeAxes(a,d),h=!l&&0===p.length;c.forEach((e,t)=>{h||p.indexOf(t)>=0?s&&u.push(1):u.push(e)});let f=u.length,g=C.size(u);return{name:e,shaderCache:t,getShaderSource:e=>{let t=[],a=N("_A",n[0].dataType,d),l=G("output",o,f),u=i(a,l,p),g=u[2];for(let e=0,n=0;e<d;e++)h||p.indexOf(e)>=0?(s&&n++,g=`for(var j${e}: u32 = 0; j${e} < ${c[e]}; j${e}++) {
                  ${u[2].includes("last_index")?`let last_index = j${e};`:""}
                  ${a.indicesSet("input_indices",e,`j${e}`)}
                  ${g}
                }`):(t.push(`${a.indicesSet("input_indices",e,l.indicesGet("output_indices",n))};`),n++);return`

        ${e.registerUniform("output_size","u32").declareVariables(a,l)}

        ${e.mainStart()}
          ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var input_indices: ${a.type.indices};
          let output_indices = ${l.offsetToIndices("global_idx")};

          ${t.join(`
`)}
          ${u[0]}       // init ops for reduce max/min
          ${u[1]}
          ${g}
          ${u[3]}
          ${4===u.length?l.setByOffset("global_idx","value"):u.slice(4).join(`
`)}
        }`},getRunData:()=>({outputs:[{dims:u,dataType:o}],dispatchGroup:{x:Math.ceil(g/64)},programUniforms:[{type:12,data:g},...W(c,u)]})}},xc=(e,t)=>{let n=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(e=>n.push(Number(e))),ce({axes:n,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},Un=(e,t,n,i)=>{let a=e.inputs,o=1===a.length?n:xc(a,n);e.compute(Ma(t,{hint:o.cacheKey,inputDependencies:["rank"]},[a[0]],o.noopWithEmptyAxes&&0===o.axes.length?pP:i,o.axes,a[0].dataType,o.keepDims,o.noopWithEmptyAxes),{inputs:[0]})},fP=(e,t)=>{Gn(e.inputs),Un(e,"ReduceLogSum",t,(e,t)=>[`var value = ${t.type.storage}(0);`,"",`value += ${e.getByIndices("input_indices")};`,"value = log(value);"])},hP=(e,t)=>{Gn(e.inputs),Un(e,"ReduceL1",t,(e,t)=>[`var value = ${t.type.storage}(0);`,"",`value += abs(${e.getByIndices("input_indices")});`,""])},mP=(e,t)=>{Gn(e.inputs),Un(e,"ReduceL2",t,(e,t)=>[`var t = ${t.type.value}(0); var value = ${t.type.value}(0);`,"",`t = ${e.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},gP=(e,t)=>{Gn(e.inputs),Un(e,"ReduceLogSumExp",t,(e,t)=>[`var value = ${t.type.storage}(0);`,"",`value += exp(${e.getByIndices("input_indices")});`,"value = log(value);"])},bP=(e,t)=>{Gn(e.inputs),Un(e,"ReduceMax",t,(e,t,n)=>{let i=[];for(let t=0;t<e.rank;t++)(n.indexOf(t)>=0||0===n.length)&&i.push(e.indicesSet("input_indices",t,0));return[`${i.join(`
`)}`,`var value = ${e.getByIndices("input_indices")};`,`value = max(value, ${e.getByIndices("input_indices")});`,""]})},yP=(e,t)=>{Gn(e.inputs),Un(e,"ReduceMean",t,(t,n,i)=>{let a=1;for(let n=0;n<t.rank;n++)(i.indexOf(n)>=0||0===i.length)&&(a*=e.inputs[0].dims[n]);return["var sum = f32(0);","",`sum += f32(${t.getByIndices("input_indices")});`,`let value = ${n.type.value}(sum / ${a});`]})},_P=(e,t)=>{Gn(e.inputs),Un(e,"ReduceMin",t,(e,t,n)=>{let i=[];for(let t=0;t<e.rank;t++)(n.indexOf(t)>=0||0===n.length)&&i.push(`input_indices[${t}] = 0;`);return[`${i.join(`
`)}`,`var value = ${e.getByIndices("input_indices")};`,`value = min(value, ${e.getByIndices("input_indices")});`,""]})},vP=(e,t)=>{Gn(e.inputs),Un(e,"ReduceProd",t,(e,t)=>[`var value = ${t.type.storage}(1);`,"",`value *= ${e.getByIndices("input_indices")};`,""])},wP=(e,t)=>{Gn(e.inputs),Un(e,"ReduceSum",t,(e,t)=>[`var value = ${t.type.storage}(0);`,"",`value += ${e.getByIndices("input_indices")};`,""])},xP=(e,t)=>{Gn(e.inputs),Un(e,"ReduceSumSquare",t,(e,t)=>[`var t = ${t.type.value}(0); var value = ${t.type.value}(0);`,"",`t = ${e.getByIndices("input_indices")}; value += t * t;`,""])},Wn=(e,t,n)=>{if(0===t.length)return n;let i=1,a=1;for(let n=0;n<t.length;n++)-1===t.indexOf(n)?i*=e[n]:a*=e[n];return a<32&&i>1024},u_=(e,t)=>{Wn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?yP(e,t):Jy(e,t)},l_=(e,t)=>{Wn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?hP(e,t):Yy(e,t)},c_=(e,t)=>{Wn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?mP(e,t):Qy(e,t)},d_=(e,t)=>{Wn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?gP(e,t):e_(e,t)},p_=(e,t)=>{Wn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?bP(e,t):t_(e,t)},f_=(e,t)=>{Wn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?_P(e,t):n_(e,t)},h_=(e,t)=>{Wn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?vP(e,t):r_(e,t)},m_=(e,t)=>{Wn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?wP(e,t):o_(e,t)},g_=(e,t)=>{Wn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?xP(e,t):i_(e,t)},b_=(e,t)=>{Wn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?fP(e,t):a_(e,t)}}),w_=k(()=>{le(),Xe(),za(),y_=e=>{if(!e||0===e.length||e.length>2)throw Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(1!==e[0].dataType)throw Error("Invalid input type.")},__=(e,t)=>{y_(e.inputs);let n=(e,n,i)=>{let a=[];for(let t=0;t<e.rank;t++)(i.indexOf(t)>=0||0===i.length)&&a.push(`input_indices[${t}] = 0;`);return[`${a.join(`
`)}`,`var value = ${e.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${e.getByIndices("input_indices")} ${t.selectLastIndex>0?"<=":"<"} value) {
         value = ${e.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",n.setByOffset("global_idx","best_index")]};e.compute(Ma("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],n,[t.axis],7,t.keepDims),{inputs:[0]})},v_=(e,t)=>{y_(e.inputs);let n=(e,n,i)=>{let a=[];for(let t=0;t<e.rank;t++)(i.indexOf(t)>=0||0===i.length)&&a.push(`input_indices[${t}] = 0;`);return[`${a.join(`
`)}`,`var value = ${e.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${e.getByIndices("input_indices")} ${t.selectLastIndex>0?">=":">"} value) {
         value = ${e.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",n.setByOffset("global_idx","best_index")]};e.compute(Ma("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],n,[t.axis],7,t.keepDims),{inputs:[0]})},Tc=e=>ce(e)}),Ba=k(()=>{le(),ge(),Na(),ye(),TP=(e,t)=>{let n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5];if(s&&l)throw Error("Attention cannot have both past and attention_bias");if(3!==n.dims.length)throw Error('Input "input" must have 3 dimensions');let u=n.dims[0],c=n.dims[1],d=n.dims[2];if(1!==a.dims.length)throw Error('Input "bias" is expected to have 1 dimensions');if(2!==i.dims.length)throw Error('Input "weights" is expected to have 2 dimensions');if(i.dims[0]!==d)throw Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(a.dims[0]!==i.dims[1])throw Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let p=a.dims[0]/3,h=p,f=h;if(t.qkvHiddenSizes.length>0){if(3!==t.qkvHiddenSizes.length)throw Error("qkv_hidden_sizes attribute should have 3 elements");for(let e of t.qkvHiddenSizes)if(e%t.numHeads!=0)throw Error("qkv_hidden_sizes should be divisible by num_heads");p=t.qkvHiddenSizes[0],h=t.qkvHiddenSizes[1],f=t.qkvHiddenSizes[2]}let g=c;if(p!==h)throw Error("qkv_hidden_sizes first element should be same as the second");if(a.dims[0]!==p+h+f)throw Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let m=0;if(s){if(h!==f)throw Error('Input "past" expect k_hidden_size == v_hidden_size');if(5!==s.dims.length)throw Error('Input "past" must have 5 dimensions');if(2!==s.dims[0])throw Error('Input "past" first dimension must be 2');if(s.dims[1]!==u)throw Error('Input "past" second dimension must be batch_size');if(s.dims[2]!==t.numHeads)throw Error('Input "past" third dimension must be num_heads');if(s.dims[4]!==h/t.numHeads)throw Error('Input "past" fifth dimension must be k_hidden_size / num_heads');t.pastPresentShareBuffer||(m=s.dims[3])}let y=g+m,b=-1,v=0;if(o)throw Error("Mask not supported");if(s)throw Error("past is not supported");if(l){if(4!==l.dims.length)throw Error('Input "attention_bias" must have 4 dimensions');if(l.dims[0]!==u||l.dims[1]!==t.numHeads||l.dims[2]!==c||l.dims[3]!==y)throw Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:u,sequenceLength:c,pastSequenceLength:m,kvSequenceLength:g,totalSequenceLength:y,maxSequenceLength:b,inputHiddenSize:d,hiddenSize:p,vHiddenSize:f,headSize:Math.floor(p/t.numHeads),vHeadSize:Math.floor(f/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:v,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},Ic=(e,t,n)=>t&&e?`
      let total_sequence_length_input = u32(${t.getByOffset("0")});
      let present_sequence_length = max(total_sequence_length_input, uniforms.past_sequence_length);
      let is_subsequent_prompt: bool = sequence_length > 1 && sequence_length != total_sequence_length_input;
      let is_first_prompt: bool = is_subsequent_prompt == false && sequence_length == total_sequence_length_input;
      total_sequence_length = u32(${e?.getByOffset("batchIdx")}) + 1;
      var past_sequence_length: u32 = 0;
      if (is_first_prompt == false) {
        past_sequence_length = total_sequence_length - sequence_length;
      }
       `:`
    ${n?"let past_sequence_length = uniforms.past_sequence_length":""};
    let present_sequence_length = total_sequence_length;
    `,IP=(e,t,n,i,a,o,s,l)=>{let u=Ee(s?1:o),c=64,d=o/u;d<64&&(c=32);let p=[{type:12,data:t},{type:12,data:n},{type:12,data:i},{type:12,data:a},{type:12,data:d},{type:12,data:Math.ceil(o/u/c)}],h=Ve(e.dataType,u),f=it(1,u),g=["type"];s&&g.push("type"),l&&g.push("type");let m=t=>{let n=G("x",e.dataType,e.dims,u),i=[n],a=s?N("seq_lens",s.dataType,s.dims):void 0;a&&i.push(a);let o=l?N("total_sequence_length_input",l.dataType,l.dims):void 0;o&&i.push(o);let d=it(e.dataType),p=[{name:"batch_size",type:"u32"},{name:"num_heads",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"sequence_length",type:"u32"},{name:"total_sequence_length",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`
  var<workgroup> thread_max: array<f32, ${c}>;
  var<workgroup> thread_sum: array<f32, ${c}>;
  ${t.registerUniforms(p).declareVariables(...i)}
  ${t.mainStart([c,1,1])}
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let sequence_length = uniforms.sequence_length;
    var total_sequence_length = uniforms.total_sequence_length;
    ${Ic(a,o,!1)}
    let local_offset = local_idx * uniforms.elements_per_thread;
    let offset = (global_idx / ${c}) * uniforms.total_sequence_length + local_offset;
    let seq_causal_length = ${s?"u32(past_sequence_length + workgroup_id.y + 1)":"total_sequence_length"};
    var thread_max_vector = ${f}(-3.402823e+38f);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      thread_max_vector = max(${f}(x[offset + i]), thread_max_vector);
    }
    thread_max[local_idx] = ${(()=>{switch(u){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw Error(`Unsupported components: ${u}`)}})()};
    workgroupBarrier();

    var max_value =  f32(-3.402823e+38f);
    for (var i = 0u; i < ${c}; i++) {
      max_value = max(thread_max[i], max_value);
    }

    var sum_vector = ${f}(0);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      sum_vector += exp(${f}(x[offset + i]) - max_value);
    }
    thread_sum[local_idx] = ${(()=>{switch(u){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw Error(`Unsupported components: ${u}`)}})()};
    workgroupBarrier();

    var sum: f32 = 0;
    for (var i = 0u; i < ${c}; i++) {
      sum += thread_sum[i];
    }

    if (sum == 0) {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        x[offset + i] = ${n.type.value}(${d}(1.0) / ${d}(seq_causal_length));
      }
    } else {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        var f32input = ${f}(x[offset + i]);
        x[offset + i] = ${n.type.value}(exp(f32input - max_value) / sum);
      }
    }
      ${s?`
        for (var total_seq_id: u32 = seq_causal_length; total_seq_id + local_offset < uniforms.total_sequence_length; total_seq_id++) {
          x[offset + total_seq_id] = ${n.type.value}(${d}(0));
        }`:""};
  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${c};${h};${u}`,inputDependencies:g},getShaderSource:m,getRunData:()=>({outputs:[],dispatchGroup:{x:1,y:a,z:t*n},programUniforms:p})}},SP=(e,t,n,i,a,o,s,l,u)=>{let c=s+o.kvSequenceLength,d=[o.batchSize,o.numHeads,o.sequenceLength,c],p=e>1&&i,h=o.kvNumHeads?o.kvNumHeads:o.numHeads,f=p?[o.batchSize,h,c,o.headSize]:void 0,g=o.nReps?o.nReps:1,m=0===o.scale?1/Math.sqrt(o.headSize):o.scale,y=Ee(o.headSize),b=o.headSize/y,v=12,x={x:Math.ceil(c/12),y:Math.ceil(o.sequenceLength/v),z:o.batchSize*o.numHeads},w=[{type:12,data:o.sequenceLength},{type:12,data:b},{type:12,data:c},{type:12,data:o.numHeads},{type:12,data:o.headSize},{type:1,data:m},{type:12,data:s},{type:12,data:o.kvSequenceLength},{type:12,data:g}],_=p&&i&&C.size(i.dims)>0,S=["type","type"];_&&S.push("type"),a&&S.push("type"),l&&S.push("type"),u&&S.push("type");let k=[{dims:d,dataType:t.dataType,gpuDataType:0}];p&&k.push({dims:f,dataType:t.dataType,gpuDataType:0});let T=e=>{let o=N("q",t.dataType,t.dims,y),s=[o,N("key",n.dataType,n.dims,y)];if(_){let e=N("past_key",i.dataType,i.dims,y);s.push(e)}a&&s.push(N("attention_bias",a.dataType,a.dims));let c=l?N("seq_lens",l.dataType,l.dims):void 0;c&&s.push(c);let h=u?N("total_sequence_length_input",u.dataType,u.dims):void 0;h&&s.push(h);let m=G("output",t.dataType,d),b=[m];p&&b.push(G("present_key",t.dataType,f,y));let x=it(1,y),w=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"alpha",type:"f32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${v}u;

  var<workgroup> tileQ: array<${o.type.storage}, ${v*v}>;
  var<workgroup> tileK: array<${o.type.storage}, ${v*v}>;
  ${e.registerUniforms(w).declareVariables(...s,...b)}
  ${e.mainStart([v,v,1])}
    // x holds the N and y holds the M
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let kvHeadIdx = ${1===g?"headIdx":"headIdx / uniforms.n_reps"};
    let kv_num_heads = ${1===g?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let m = workgroup_id.y * TILE_SIZE;
    let n = workgroup_id.x * TILE_SIZE;
    let sequence_length = uniforms.M;
    var total_sequence_length = uniforms.N;
    ${Ic(c,h,!0)}
    let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx;
    let qOffset = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
    ${_&&p?"let pastKeyOffset = absKvHeadIdx * uniforms.past_sequence_length * uniforms.K;":""};
    let kOffset = absKvHeadIdx * uniforms.kv_sequence_length * uniforms.K;
    ${p?"let presentKeyOffset = absKvHeadIdx * uniforms.N * uniforms.K;":""}
    var value = ${x}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
      ${_&&p?`
              if (n + local_id.y < past_sequence_length) {
                tileK[idx] = past_key[pastKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
              } else if (n + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
                tileK[idx] = key[kOffset + (n + local_id.y - past_sequence_length) * uniforms.K + w + local_id.x];
              }`:`
          if (n + local_id.y < uniforms.kv_sequence_length) {
            tileK[idx] = key[kOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
          }`}
      ${p?`if (n + local_id.y < present_sequence_length) {
        present_key[presentKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x] = tileK[idx];
      }`:""}
      }
      workgroupBarrier();

      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
          value += ${x}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);
      }

      workgroupBarrier();
    }

    if (global_id.y < uniforms.M && global_id.x < total_sequence_length) {
      let headOffset = workgroup_id.z * uniforms.M * uniforms.N;
      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;
      var sum: f32 = ${(()=>{switch(y){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw Error(`Unsupported components: ${y}`)}})()};
        output[outputIdx] = ${m.type.value} (sum * uniforms.alpha) + ${a?"attention_bias[outputIdx]":"0.0"};
    }
  }`};return{name:"AttentionProbs",shaderCache:{hint:`${y};${void 0!==a};${void 0!==i};${e}`,inputDependencies:S},getRunData:()=>({outputs:k,dispatchGroup:x,programUniforms:w}),getShaderSource:T}},$P=(e,t,n,i,a,o,s,l)=>{let u=o+a.kvSequenceLength,c=a.nReps?a.nReps:1,d=a.vHiddenSize*c,p=e>1&&i,h=a.kvNumHeads?a.kvNumHeads:a.numHeads,f=p?[a.batchSize,h,u,a.headSize]:void 0,g=[a.batchSize,a.sequenceLength,d],m=12,y={x:Math.ceil(a.vHeadSize/m),y:Math.ceil(a.sequenceLength/m),z:a.batchSize*a.numHeads},b=[{type:12,data:a.sequenceLength},{type:12,data:u},{type:12,data:a.vHeadSize},{type:12,data:a.numHeads},{type:12,data:a.headSize},{type:12,data:d},{type:12,data:o},{type:12,data:a.kvSequenceLength},{type:12,data:c}],v=p&&i&&C.size(i.dims)>0,x=["type","type"];v&&x.push("type"),s&&x.push("type"),l&&x.push("type");let w=[{dims:g,dataType:t.dataType,gpuDataType:0}];p&&w.push({dims:f,dataType:t.dataType,gpuDataType:0});let _=e=>{let a=N("probs",t.dataType,t.dims),o=[a,N("v",n.dataType,n.dims)];v&&o.push(N("past_value",i.dataType,i.dims));let u=s?N("seq_lens",s.dataType,s.dims):void 0;s&&o.push(u);let d=l?N("total_sequence_length_input",l.dataType,l.dims):void 0;l&&o.push(d);let h=[G("output",t.dataType,g)];p&&h.push(G("present_value",t.dataType,f));let y=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"v_hidden_size",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${m}u;
  var<workgroup> tileQ: array<${a.type.value}, ${m*m}>;
  var<workgroup> tileV: array<${a.type.value}, ${m*m}>;
  ${e.registerUniforms(y).declareVariables(...o,...h)}
  ${e.mainStart([m,m,1])}
   let headIdx = workgroup_id.z % uniforms.num_heads;
   let batchIdx = workgroup_id.z / uniforms.num_heads;
   let kvHeadIdx = ${1===c?"headIdx":"headIdx / uniforms.n_reps"};
   let kv_num_heads = ${1===c?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
   let m = global_id.y;
   let n = global_id.x;
   let sequence_length = uniforms.M;
   var total_sequence_length = uniforms.K;
   ${Ic(u,d,!0)}
   let offsetA = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
   let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx; // kvHeadIdx is relative to the batch
   ${v&&p?"let pastValueOffset = absKvHeadIdx * uniforms.N * uniforms.past_sequence_length + n;":""};
   let vOffset = absKvHeadIdx * uniforms.N * uniforms.kv_sequence_length + n;
   ${p?"let presentValueOffset = absKvHeadIdx * uniforms.N * uniforms.K + n;":""}
   var value = ${a.type.storage}(0);
   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
        ${v&&p?`
        if (w + local_id.y < past_sequence_length) {
          tileV[idx] = past_value[pastValueOffset + (w + local_id.y) * uniforms.N];
        } else if (w + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
          tileV[idx] = v[vOffset + (w + local_id.y - past_sequence_length) * uniforms.N];
        }
      `:`
            if (w + local_id.y < uniforms.kv_sequence_length) {
              tileV[idx] = v[vOffset + (w + local_id.y) * uniforms.N];
            }`}
        ${p?`
            if (w + local_id.y < present_sequence_length) {
          present_value[presentValueOffset + (w + local_id.y) * uniforms.N] = tileV[idx];
        }`:""}
      }
     workgroupBarrier();
     for (var k: u32 = 0u; k < TILE_SIZE && w+k < total_sequence_length; k++) {
       value += tileQ[TILE_SIZE * local_id.y + k] * tileV[TILE_SIZE * k + local_id.x];
     }
     workgroupBarrier();
   }

   // we need to transpose output from BNSH_v to BSND_v
   if (m < uniforms.M && n < uniforms.N) {
     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size
       + headIdx * uniforms.N + n;
     output[outputIdx] = value;
   }
  }`};return{name:"AttentionScore",shaderCache:{hint:`${void 0!==i};${e}`,inputDependencies:x},getRunData:()=>({outputs:w,dispatchGroup:y,programUniforms:b}),getShaderSource:_}},po=(e,t,n,i,a,o,s,l,u,c,d,p)=>{let h=Math.min(e.outputCount,1+ +!!s+ +!!l),f=h>1?c.pastSequenceLength:0,g=f+c.kvSequenceLength,m=u&&C.size(u.dims)>0?u:void 0,y=[t,n];h>1&&s&&C.size(s.dims)>0&&y.push(s),m&&y.push(m),d&&y.push(d),p&&y.push(p);let b=e.compute(SP(h,t,n,s,m,c,f,d,p),{inputs:y,outputs:h>1?[-1,1]:[-1]})[0];e.compute(IP(b,c.batchSize,c.numHeads,f,c.sequenceLength,g,d,p),{inputs:d&&p?[b,d,p]:[b],outputs:[]});let v=[b,i];h>1&&l&&C.size(l.dims)>0&&v.push(l),d&&v.push(d),p&&v.push(p),e.compute($P(h,b,i,l,c,f,d,p),{inputs:v,outputs:h>1?[0,2]:[0]})},AP=(e,t)=>{let n=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],i=t.sequenceLength,a=t.inputHiddenSize,o=t.headSize,s=12,l={x:Math.ceil(t.headSize/s),y:Math.ceil(t.sequenceLength/s),z:t.batchSize*t.numHeads},u=[e.inputs[0],e.inputs[1],e.inputs[2]],c=[{type:12,data:i},{type:12,data:a},{type:12,data:o},{type:12,data:t.numHeads},{type:12,data:t.headSize},{type:12,data:t.hiddenSize},{type:12,data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}],d=e=>{let t=G("output_q",u[0].dataType,n),i=G("output_k",u[0].dataType,n),a=G("output_v",u[0].dataType,n),o=N("input",u[0].dataType,u[0].dims),l=N("weight",u[1].dataType,u[1].dims),c=N("bias",u[2].dataType,u[2].dims),d=o.type.storage,p=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`
  const TILE_SIZE = ${s}u;
  var<workgroup> tileInput: array<${d}, ${s*s}>;
  var<workgroup> tileWeightQ: array<${d}, ${s*s}>;
  var<workgroup> tileWeightK: array<${d}, ${s*s}>;
  var<workgroup> tileWeightV: array<${d}, ${s*s}>;
  ${e.registerUniforms(p).declareVariables(o,l,c,t,i,a)}
  ${e.mainStart([s,s,1])}
    let batchIndex = workgroup_id.z / uniforms.num_heads;
    let headNumber = workgroup_id.z % uniforms.num_heads;
    let m = global_id.y;
    let n = global_id.x;

    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;
    let biasOffsetQ = headNumber * uniforms.head_size;
    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;
    let biasOffsetV = uniforms.hidden_size + biasOffsetK;

    var valueQ = ${d}(0);
    var valueK = ${d}(0);
    var valueV = ${d}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        let offset = n + (w + local_id.y) * uniforms.ldb;
        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];
        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];
        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];
      }
      workgroupBarrier();
      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {
        let inputTileOffset = TILE_SIZE * local_id.y + k;
        let weightTileOffset = TILE_SIZE * k + local_id.x;
        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];
        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];
        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];
      }

      workgroupBarrier();
    }

    let headOffset = (m * uniforms.N + n) % uniforms.head_size;
    valueQ += bias[headOffset + biasOffsetQ];
    valueK += bias[headOffset + biasOffsetK];
    valueV += bias[headOffset + biasOffsetV];

    let offset = workgroup_id.z * uniforms.M * uniforms.N;
    if (m < uniforms.M && n < uniforms.N) {
      let outputIdx = offset + m * uniforms.N + n;
      output_q[outputIdx] = valueQ;
      output_k[outputIdx] = valueK;
      output_v[outputIdx] = valueV;
    }
  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:l,programUniforms:c}),getShaderSource:d},{inputs:u,outputs:[-1,-1,-1]})},x_=(e,t)=>{let n=TP(e.inputs,t),[i,a,o]=AP(e,n);return po(e,i,a,o,e.inputs[4],void 0,void 0,void 0,e.inputs[5],n)}}),I_=k(()=>{pt(),le(),ge(),Xe(),ye(),OP=(e,t)=>{if(!e||5!==e.length)throw Error("BatchNormalization requires 5 inputs");let n=(e,t,n)=>{let i=t.length;if(i!==e.length)throw Error(`${n}: num dimensions != ${i}`);t.forEach((t,i)=>{if(t!==e[i])throw Error(`${n}: dim[${i}] do not match`)})};if(e[0].dims.length>1){let i="NHWC"===t.format?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);n(e[1].dims,i,"Invalid input scale"),n(e[2].dims,i,"Invalid input B"),n(e[3].dims,i,"Invalid input mean"),n(e[4].dims,i,"Invalid input var")}else n(e[1].dims,[1],"Invalid input scale"),n(e[2].dims,[1],"Invalid input B"),n(e[3].dims,[1],"Invalid input mean"),n(e[4].dims,[1],"Invalid input var")},PP=(e,t)=>{let{epsilon:n,spatial:i,format:a}=t,o=e[0].dims,s=i?Ee(o[o.length-1]):1,l="NHWC"===a&&o.length>1?s:1,u=C.size(o)/s,c=i,d=c?o.length:o,p=N("x",e[0].dataType,e[0].dims,s),h=N("scale",e[1].dataType,e[1].dims,l),f=N("bias",e[2].dataType,e[2].dims,l),g=N("inputMean",e[3].dataType,e[3].dims,l),m=N("inputVar",e[4].dataType,e[4].dims,l),y=G("y",e[0].dataType,d,s),b=()=>{let e="";if(i)e=`let cOffset = ${1===o.length?"0u":"NHWC"===a?`outputIndices[${o.length-1}] / ${s}`:"outputIndices[1]"};`;else if("NCHW"===a)e=`
            ${y.indicesSet("outputIndices","0","0")}
            let cOffset = ${y.indicesToOffset("outputIndices")};`;else{e=`var cIndices = ${h.type.indices}(0);
                       cIndices[0] = outputIndices[${o.length-1}];`;for(let t=1;t<h.rank;t++)e+=`cIndices[${t}] = outputIndices[${t}];`;e+=`let cOffset = ${h.indicesToOffset("cIndices")};`}return e},v=e=>`
  const epsilon = ${n};
  ${e.registerUniform("outputSize","u32").declareVariables(p,h,f,g,m,y)}
  ${e.mainStart()}
  ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
    var outputIndices = ${y.offsetToIndices(`global_idx * ${s}`)};
    ${b()}
    let scale = ${h.getByOffset("cOffset")};
    let bias = ${f.getByOffset("cOffset")};
    let inputMean = ${g.getByOffset("cOffset")};
    let inputVar = ${m.getByOffset("cOffset")};
    let x = ${p.getByOffset("global_idx")};
    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;
    ${y.setByOffset("global_idx","value")}
  }`;return{name:"BatchNormalization",shaderCache:{hint:`${t.epsilon}_${t.format}_${i}_${s}`,inputDependencies:c?["rank","type","type","type","type"]:void 0},getShaderSource:v,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:c?[{type:12,data:u},...W(o)]:[{type:12,data:u}]})}},EP=e=>ce(e),T_=(e,t)=>{let{inputs:n,outputCount:i}=e,a=EP({...t,outputCount:i});if(me.webgpu.validateInputContent&&OP(n,a),t.trainingMode)throw Error("BatchNormalization trainingMode is not supported yet.");e.compute(PP(n,a))}}),$_=k(()=>{ge(),ye(),CP=e=>{if(3!==e[0].dims.length)throw Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw Error("number of channels should be 320, 640 or 1280");if(1!==e[1].dims.length)throw Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw Error("last dimension of input and bias are not the same")},DP=e=>{let t=e[0].dims,n=e[0].dims[2],i=C.size(t)/4,a=e[0].dataType,o=N("input",a,t,4),s=N("bias",a,[n],4),l=N("residual",a,t,4),u=G("output",a,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(i/64)}}),getShaderSource:e=>`
  const channels = ${n}u / 4;
  ${e.declareVariables(o,s,l,u)}

  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes(i)}
    let value = ${o.getByOffset("global_idx")}
      + ${s.getByOffset("global_idx % channels")} + ${l.getByOffset("global_idx")};
    ${u.setByOffset("global_idx","value")}
  }`}},S_=e=>{CP(e.inputs),e.compute(DP(e.inputs))}}),Va=k(()=>{le(),ge(),Xe(),ye(),kP=(e,t,n,i,a,o,s)=>{let l=Math.ceil(t/4),u="";u="string"==typeof a?`${a}(a)`:a("a");let c=N("inputData",n,[l],4),d=G("outputData",i,[l],4),p=[{name:"vec_size",type:"u32"}];return s&&p.push(...s),`
      ${e.registerUniforms(p).declareVariables(c,d)}

  ${o??""}

  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}

    let a = ${c.getByOffset("global_idx")};
    ${d.setByOffset("global_idx",u)}
  }`},Le=(e,t,n,i,a,o=e.dataType,s,l)=>{let u=[{type:12,data:Math.ceil(C.size(e.dims)/4)}];return s&&u.push(...s),{name:t,shaderCache:{hint:a,inputDependencies:["type"]},getShaderSource:t=>kP(t,C.size(e.dims),e.dataType,o,n,i,l),getRunData:t=>({outputs:[{dims:e.dims,dataType:o}],dispatchGroup:{x:Math.ceil(C.size(t[0].dims)/64/4)},programUniforms:u})}},A_=e=>{e.compute(Le(e.inputs[0],"Abs","abs"))},O_=e=>{e.compute(Le(e.inputs[0],"Acos","acos"))},P_=e=>{e.compute(Le(e.inputs[0],"Acosh","acosh"))},E_=e=>{e.compute(Le(e.inputs[0],"Asin","asin"))},C_=e=>{e.compute(Le(e.inputs[0],"Asinh","asinh"))},D_=e=>{e.compute(Le(e.inputs[0],"Atan","atan"))},k_=e=>{e.compute(Le(e.inputs[0],"Atanh","atanh"))},N_=e=>ce(e),L_=(e,t)=>{let n;switch(t.to){case 10:n="vec4<f16>";break;case 1:n="vec4<f32>";break;case 12:n="vec4<u32>";break;case 6:n="vec4<i32>";break;case 9:n="vec4<bool>";break;default:throw RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${t.to}`)}e.compute(Le(e.inputs[0],"Cast",n,void 0,t.cacheKey,t.to))},NP=e=>{let t,n,i=e.length>=2&&0!==e[1].data,a=e.length>=3&&0!==e[2].data;switch(e[0].dataType){case 1:t=i?e[1].getFloat32Array()[0]:-34028234663852886e22,n=a?e[2].getFloat32Array()[0]:34028234663852886e22;break;case 10:t=i?e[1].getUint16Array()[0]:64511,n=a?e[2].getUint16Array()[0]:31743;break;default:throw Error("Unsupport data type")}return ce({min:t,max:n})},R_=(e,t)=>{let n=t||NP(e.inputs),i=it(e.inputs[0].dataType);e.compute(Le(e.inputs[0],"Clip",e=>`clamp(${e}, vec4<${i}>(uniforms.min), vec4<${i}>(uniforms.max))`,void 0,n.cacheKey,void 0,[{type:e.inputs[0].dataType,data:n.min},{type:e.inputs[0].dataType,data:n.max}],[{name:"min",type:i},{name:"max",type:i}]),{inputs:[0]})},z_=e=>{e.compute(Le(e.inputs[0],"Ceil","ceil"))},M_=e=>{e.compute(Le(e.inputs[0],"Cos","cos"))},B_=e=>{e.compute(Le(e.inputs[0],"Cosh","cosh"))},Wo=e=>ce(e),F_=(e,t)=>{let n=it(e.inputs[0].dataType);e.compute(Le(e.inputs[0],"Elu",e=>`elu_vf32(${e})`,`
  const elu_alpha_ = ${n}(${t.alpha});

  fn elu_f32(a: ${n}) -> ${n} {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<${n}>) -> vec4<${n}> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,t.cacheKey))},Fa=(e="f32")=>`
const r0: ${e} = 0.3275911;
const r1: ${e} = 0.254829592;
const r2: ${e} = -0.284496736;
const r3: ${e} = 1.421413741;
const r4: ${e} = -1.453152027;
const r5: ${e} = 1.061405429;

fn erf_vf32(v: vec4<${e}>) -> vec4<${e}> {
  let absv = abs(v);
  let x = 1.0 / (1.0 + r0 * absv);
  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
}`,V_=e=>{let t=it(e.inputs[0].dataType);e.compute(Le(e.inputs[0],"Erf",e=>`erf_vf32(${e})`,Fa(t)))},G_=e=>{e.compute(Le(e.inputs[0],"Exp","exp"))},U_=e=>{e.compute(Le(e.inputs[0],"Floor","floor"))},W_=e=>{let t=it(e.inputs[0].dataType);e.compute(Le(e.inputs[0],"Gelu",e=>`0.5 * ${e} * (1.0 + erf_vf32(${e} * 0.7071067811865475))`,Fa(t)))},H_=(e,t)=>{let n=it(e.inputs[0].dataType);e.compute(Le(e.inputs[0],"LeakyRelu",e=>`select(leaky_relu_alpha_ * ${e}, ${e}, ${e} >= vec4<${n}>(0.0))`,`const leaky_relu_alpha_ = ${n}(${t.alpha});`,t.cacheKey))},j_=e=>{e.compute(Le(e.inputs[0],"Not",e=>`!${e}`))},q_=e=>{e.compute(Le(e.inputs[0],"Neg",e=>`-${e}`))},K_=e=>{e.compute(Le(e.inputs[0],"Reciprocal",e=>`1.0/${e}`))},X_=e=>{let t=it(e.inputs[0].dataType);e.compute(Le(e.inputs[0],"Relu",e=>`select(vec4<${t}>(0.0), ${e}, ${e} > vec4<${t}>(0.0))`))},Z_=e=>{e.compute(Le(e.inputs[0],"Sigmoid",e=>`(1.0 / (1.0 + exp(-${e})))`))},J_=e=>ce(e),Y_=(e,t)=>{let n=it(e.inputs[0].dataType);e.compute(Le(e.inputs[0],"HardSigmoid",e=>`max(vec4<${n}>(0.0), min(vec4<${n}>(1.0), ${t.alpha} * ${e} + vec4<${n}>(${t.beta})))`,void 0,t.cacheKey))},Q_=e=>{e.compute(Le(e.inputs[0],"Sin","sin"))},ev=e=>{e.compute(Le(e.inputs[0],"Sinh","sinh"))},tv=e=>{e.compute(Le(e.inputs[0],"Sqrt","sqrt"))},nv=e=>{e.compute(Le(e.inputs[0],"Tan","tan"))},rv=e=>`sign(${e}) * (1 - exp(-2 * abs(${e}))) / (1 + exp(-2 * abs(${e})))`,ov=e=>{e.compute(Le(e.inputs[0],"Tanh",rv))},Sc=(e="f32")=>`
const fast_gelu_a: ${e} = 0.5;
const fast_gelu_b: ${e} = 0.7978845608028654;
const fast_gelu_c: ${e} = 0.035677408136300125;

fn tanh_v(v: vec4<${e}>) -> vec4<${e}> {
  return ${rv("v")};
}
`,$c=e=>`(fast_gelu_a + fast_gelu_a * tanh_v(${e} * (fast_gelu_c * ${e} * ${e} + fast_gelu_b))) * ${e}`,iv=e=>{let t=it(e.inputs[0].dataType);e.compute(Le(e.inputs[0],"FastGelu",$c,Sc(t),void 0,e.inputs[0].dataType))},av=(e,t)=>{let n=it(e.inputs[0].dataType);return e.compute(Le(e.inputs[0],"ThresholdedRelu",e=>`select(vec4<${n}>(0.0), ${e}, ${e} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${n}>(${t.alpha});`,t.cacheKey)),0},sv=e=>{e.compute(Le(e.inputs[0],"Log","log"))},LP=(e,t)=>`
const alpha = vec4<${e}>(${t});
const one = ${e}(1.0);
const zero = ${e}(0.0);

fn quick_gelu_impl(x: vec4<${e}>) -> vec4<${e}> {
  let v = x *alpha;
  var x1 : vec4<${e}>;
  for (var i = 0; i < 4; i = i + 1) {
    if (v[i] >= zero) {
      x1[i] = one / (one + exp(-v[i]));
    } else {
      x1[i] = one - one / (one + exp(v[i]));
    }
  }
  return x * x1;
}
`,RP=e=>`quick_gelu_impl(${e})`,uv=(e,t)=>{let n=it(e.inputs[0].dataType);e.compute(Le(e.inputs[0],"QuickGelu",RP,LP(n,t.alpha),t.cacheKey,e.inputs[0].dataType))}}),dv=k(()=>{ge(),ye(),Va(),zP=e=>{if(3!==e[0].dims.length)throw Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw Error("hidden state should be 2560, 5120 or 10240");if(1!==e[1].dims.length)throw Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw Error("last dimension of input and bias are not the same")},MP=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let n=N("input",e[0].dataType,e[0].dims,4),i=N("bias",e[0].dataType,[e[0].dims[2]],4),a=G("output",e[0].dataType,t,4),o=C.size(t)/4,s=Ve(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)}}),getShaderSource:t=>`
  const M_SQRT2 = sqrt(2.0);
  const halfChannels = ${e[0].dims[2]/4/2}u;

  ${t.declareVariables(n,i,a)}

  ${Fa(s)}

  ${t.mainStart()}
    ${t.guardAgainstOutOfBoundsWorkgroupSizes(o)}
    let biasIdx = global_idx % halfChannels;
    let batchIndex = global_idx / halfChannels;
    let inputOffset = biasIdx + batchIndex * halfChannels * 2;
    let valueLeft = input[inputOffset] + bias[biasIdx];
    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];
    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);

    ${a.setByOffset("global_idx","valueLeft * geluRight")}
  }`}},cv=e=>{zP(e.inputs),e.compute(MP(e.inputs))}}),xv=k(()=>{le(),ge(),ye(),BP=(e,t,n,i,a,o,s,l,u,c,d,p)=>{let h,f;"string"==typeof l?h=f=(e,t)=>`${l}((${e}),(${t}))`:"function"==typeof l?h=f=l:(h=l.scalar,f=l.vector);let g=G("outputData",d,i.length,4),m=N("aData",u,t.length,4),y=N("bData",c,n.length,4),b;if(a)if(o){let e=1===C.size(t),i=1===C.size(n),a=t.length>0&&t[t.length-1]%4==0,o=n.length>0&&n[n.length-1]%4==0;b=e||i?g.setByOffset("global_idx",f(e?`${m.type.value}(${m.getByOffset("0")}.x)`:m.getByOffset("global_idx"),i?`${y.type.value}(${y.getByOffset("0")}.x)`:y.getByOffset("global_idx"))):`
            let outputIndices = ${g.offsetToIndices("global_idx * 4u")};
            let offsetA = ${m.broadcastedIndicesToOffset("outputIndices",g)};
            let offsetB = ${y.broadcastedIndicesToOffset("outputIndices",g)};
            ${g.setByOffset("global_idx",f(s||a?m.getByOffset("offsetA / 4u"):`${m.type.value}(${m.getByOffset("offsetA / 4u")}[offsetA % 4u])`,s||o?y.getByOffset("offsetB / 4u"):`${y.type.value}(${y.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}
          `}else b=g.setByOffset("global_idx",f(m.getByOffset("global_idx"),y.getByOffset("global_idx")));else{if(!o)throw Error("no necessary to use scalar implementation for element-wise binary op implementation.");let e=(e,t,n="")=>{let i=`aData[indexA${t}][componentA${t}]`,a=`bData[indexB${t}][componentB${t}]`;return`
            let outputIndices${t} = ${g.offsetToIndices(`global_idx * 4u + ${t}u`)};
            let offsetA${t} = ${m.broadcastedIndicesToOffset(`outputIndices${t}`,g)};
            let offsetB${t} = ${y.broadcastedIndicesToOffset(`outputIndices${t}`,g)};
            let indexA${t} = offsetA${t} / 4u;
            let indexB${t} = offsetB${t} / 4u;
            let componentA${t} = offsetA${t} % 4u;
            let componentB${t} = offsetB${t} % 4u;
            ${e}[${t}] = ${n}(${h(i,a)});
          `};b=9===d?`
            var data = vec4<u32>(0);
            ${e("data",0,"u32")}
            ${e("data",1,"u32")}
            ${e("data",2,"u32")}
            ${e("data",3,"u32")}
            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:`
            ${e("outputData[global_idx]",0)}
            ${e("outputData[global_idx]",1)}
            ${e("outputData[global_idx]",2)}
            ${e("outputData[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(m,y,g)}

        ${p??""}

        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${b}
      }`},FP=(e,t,n,i,a,o,s=n.dataType)=>{let l=n.dims.map(e=>Number(e)??1),u=i.dims.map(e=>Number(e)??1),c=!C.areEqual(l,u),d=l,p=C.size(l),h=!1,f=!1,g=[c];if(c){let e=Fn.calcShape(l,u,!1);if(!e)throw Error("Can't perform binary op on the given tensors");d=e.slice(),p=C.size(d);let t=1===C.size(l),n=1===C.size(u),i=l.length>0&&l[l.length-1]%4==0,a=u.length>0&&u[u.length-1]%4==0;g.push(t),g.push(n),g.push(i),g.push(a);let o=1;for(let e=1;e<d.length;e++){let t=l[l.length-e];if(t===u[u.length-e])o*=t;else break}o%4==0?(f=!0,h=!0):(t||n||i||a)&&(h=!0)}else h=!0;return g.push(h),{name:e,shaderCache:{hint:t+g.map(e=>e.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:e=>BP(e,l,u,d,h,c,f,a,n.dataType,i.dataType,s,o),getRunData:()=>({outputs:[{dims:d,dataType:s}],dispatchGroup:{x:Math.ceil(p/64/4)},programUniforms:[{type:12,data:Math.ceil(C.size(d)/4)},...W(l,u,d)]})}},Hn=(e,t,n,i,a,o)=>{e.compute(FP(t,a??"",e.inputs[0],e.inputs[1],n,i,o))},pv=e=>{Hn(e,"Add",(e,t)=>`${e}+${t}`)},fv=e=>{Hn(e,"Div",(e,t)=>`${e}/${t}`)},hv=e=>{Hn(e,"Equal",{scalar:(e,t)=>`u32(${e}==${t})`,vector:(e,t)=>`vec4<u32>(${e}==${t})`},void 0,void 0,9)},mv=e=>{Hn(e,"Mul",(e,t)=>`${e}*${t}`)},gv=e=>{let t=N("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;Hn(e,"Pow",{scalar:(e,t)=>`pow_custom(${e},${t})`,vector:(e,t)=>`pow_vector_custom(${e},${t})`},`
    fn pow_custom(a : ${t}, b : ${t}) -> ${t} {
      if (b == ${t}(0.0)) {
        return ${t}(1.0);
      } else if (a < ${t}(0.0) && f32(b) != floor(f32(b))) {
        return ${t}(pow(f32(a), f32(b))); // NaN
      }
      return select(sign(a), ${t}(1.0), round(f32(abs(b) % ${t}(2.0))) != 1.0) * ${t}(${"i32"===t?"round":""}(pow(f32(abs(a)), f32(b))));
    }
    fn pow_vector_custom(a : vec4<${t}>, b : vec4<${t}>) -> vec4<${t}> {
      // TODO: implement vectorized pow
      return vec4<${t}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));
    }
      `)},bv=e=>{Hn(e,"Sub",(e,t)=>`${e}-${t}`)},yv=e=>{Hn(e,"Greater",{scalar:(e,t)=>`u32(${e}>${t})`,vector:(e,t)=>`vec4<u32>(${e}>${t})`},void 0,void 0,9)},_v=e=>{Hn(e,"Less",{scalar:(e,t)=>`u32(${e}<${t})`,vector:(e,t)=>`vec4<u32>(${e}<${t})`},void 0,void 0,9)},vv=e=>{Hn(e,"GreaterOrEqual",{scalar:(e,t)=>`u32(${e}>=${t})`,vector:(e,t)=>`vec4<u32>(${e}>=${t})`},void 0,void 0,9)},wv=e=>{Hn(e,"LessOrEqual",{scalar:(e,t)=>`u32(${e}<=${t})`,vector:(e,t)=>`vec4<u32>(${e}<=${t})`},void 0,void 0,9)}}),Sv=k(()=>{le(),ge(),Xe(),ye(),GP=(e,t)=>{if(!e||e.length<1)throw Error("too few inputs");let n=0,i=e[0],a=i.dataType,o=i.dims.length;e.forEach((e,s)=>{if(s!==n){if(e.dataType!==a)throw Error("input tensors should be one type");if(e.dims.length!==o)throw Error("input tensors should have the same shape");e.dims.forEach((e,n)=>{if(n!==t&&e!==i.dims[n])throw Error("non concat dimensions must match")})}})},UP=(e,t)=>`
  fn calculateInputIndex(index: u32) -> u32 {
    let sizeInConcatAxis = array<u32, ${e}u>(${t});
    for (var i: u32 = 0u; i < ${e}; i += 1u ) {
      if (index < sizeInConcatAxis[i]) {
        return i;
      }
    }
    return ${e}u;
  }`,WP=(e,t)=>{let n=e.length,i=[];for(let a=0;a<n;++a){let o=t.setByOffset("global_idx",e[a].getByIndices("indices"));1===n?i.push(o):0===a?i.push(`if (inputIndex == ${a}u) { ${o} }`):a===n-1?i.push(`else { ${o} }`):i.push(`else if (inputIndex == ${a}) { ${o} }`)}return i.join(`
`)},HP=(e,t,n,i)=>{let a=C.size(n),o=Array(e.length),s=Array(e.length),l=0,u=[],c=[],d=[{type:12,data:a}];for(let n=0;n<e.length;++n)l+=e[n].dims[t],o[n]=l,c.push(e[n].dims.length),s[n]=N(`input${n}`,i,c[n]),u.push("rank"),d.push({type:12,data:o[n]});for(let t=0;t<e.length;++t)d.push(...W(e[t].dims));d.push(...W(n));let p=G("output",i,n.length),h=p.indicesGet("indices",t),f=Array.from(Array(o.length).keys()).map(e=>`uniforms.sizeInConcatAxis${e}`).join(",");return{name:"Concat",shaderCache:{hint:`${t}`,inputDependencies:u},getRunData:()=>({outputs:[{dims:n,dataType:i}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:d}),getShaderSource:t=>`

  ${(()=>{t.registerUniform("outputSize","u32");for(let n=0;n<e.length;n++)t.registerUniform(`sizeInConcatAxis${n}`,"u32");return t.declareVariables(...s,p)})()}

  ${UP(o.length,f)}

  ${t.mainStart()}
    ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

    var indices = ${p.offsetToIndices("global_idx")};

    let inputIndex = calculateInputIndex(${h});
    if (inputIndex != 0u) {
      let sizeInConcatAxis = array<u32, ${o.length}u>(${f});
      ${h} -= sizeInConcatAxis[inputIndex - 1u];
    }

    ${WP(s,p)}
  }`}},Tv=(e,t)=>{let n=e.inputs,i=n[0].dims,a=C.normalizeAxis(t.axis,i.length);GP(n,a);let o=i.slice();o[a]=n.reduce((e,t)=>e+(t.dims.length>a?t.dims[a]:0),0);let s=n.filter(e=>C.size(e.dims)>0);e.compute(HP(s,a,o,n[0].dataType),{inputs:s})},Iv=e=>ce({axis:e.axis})}),wr=k(()=>{le(),ge(),Xt=(e,t,n="f32")=>{switch(e.activation){case"Relu":return`value = max(value, ${t}(0.0));`;case"Sigmoid":return`value = (${t}(1.0) / (${t}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${t}(${n}(uniforms.clip_min)), ${t}(${n}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${t}(0.0), min(${t}(1.0), ${n}(uniforms.alpha) * value + ${n}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${n}(uniforms.alpha) * value, value, value >= ${t}(0.0));`;case"Tanh":return`let e2x = exp(-2.0 * abs(value));
              value = sign(value) * (1.0 - e2x) / (1.0 + e2x);
        `;case"":return"";default:throw Error(`Unsupported activation ${e.activation}`)}},Zt=(e,t)=>{"Clip"===e.activation?t.push({type:1,data:e.clipMax},{type:1,data:e.clipMin}):"HardSigmoid"===e.activation?t.push({type:1,data:e.alpha},{type:1,data:e.beta}):"LeakyRelu"===e.activation&&t.push({type:1,data:e.alpha})},Jt=(e,t)=>{"Clip"===e.activation?t.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):"HardSigmoid"===e.activation?t.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):"LeakyRelu"===e.activation&&t.push({name:"alpha",type:"f32"})},Ga=e=>{let t=e?.activation||"";if("HardSigmoid"===t){let[n,i]=e?.activation_params||[.2,.5];return{activation:t,alpha:n,beta:i}}if("Clip"===t){let[n,i]=e?.activation_params||[Dy,ky];return{activation:t,clipMax:i,clipMin:n}}if("LeakyRelu"===t){let[n]=e?.activation_params||[.01];return{activation:t,alpha:n}}return{activation:t}}}),Ua=k(()=>{rt=(e,t)=>{switch(e){case 1:return t;case 2:return`vec2<${t}>`;case 3:return`vec3<${t}>`;case 4:return`vec4<${t}>`;default:throw Error(`${e}-component is not supported.`)}},$v=e=>`
      ${e?"value = value + getBiasByOutputCoords(coords);":""}
      `}),Ov=k(()=>{Av=e=>`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));
}
`}),Ha=k(()=>{le(),ge(),ye(),wr(),Ho=(e,t,n,i,a)=>{let o=i-n;return`
      ${Array.from({length:n}).map((n,s)=>`
      if (${Q(t.shape,s,t.rank)} != 1) {
        ${t.indicesSet(e,s,Q(a,s+o,i))}
      } else {
        ${t.indicesSet(e,s,0)}
      }`).join("")}
`},Wa=(e,t,n,i,a=!1,o)=>{let s=e[0].dims,l=e[1].dims,u=s[s.length-2],c=l[l.length-1],d=s[s.length-1],p=Ee(c),h=Ee(d),f=Ee(u),g=C.size(n)/p/f,m=e.length>2,y=i?i.slice(0,-2):n.slice(0,-2),b=[C.size(y),u,c],v=[{type:12,data:g},{type:12,data:u},{type:12,data:c},{type:12,data:d}];Zt(t,v),v.push(...W(y,s,l)),m&&v.push(...W(e[2].dims)),v.push(...W(b));let x=i=>{let o=Ra("batch_dims",e[0].dataType,y.length),u=N("a",e[0].dataType,s.length,h),c=N("b",e[1].dataType,l.length,p),d=G("output",e[0].dataType,b.length,p),g=Ve(d.type.tensor),v=Xt(t,d.type.value,g),x=[u,c],w="";if(m){let t=a?p:1;x.push(N("bias",e[2].dataType,e[2].dims.length,t)),w=`${a?`value += bias[col / ${t}];`:`value += ${d.type.value}(bias[row + i]);`}`}let _=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];Jt(t,_);let S=()=>{let e=`var a_data: ${u.type.value};`;for(let t=0;t<h;t++)e+=`
              let b_data${t} = b[(b_offset + (k + ${t}) * uniforms.N + col) / ${p}];`;for(let t=0;t<f;t++){e+=`a_data = a[(a_offset + (row + ${t}) * uniforms.K + k) / ${h}];`;for(let n=0;n<h;n++)e+=`
            values[${t}] = fma(${c.type.value}(a_data${1===h?"":`[${n}]`}), b_data${n}, values[${t}]);
`}return e};return`
  ${i.registerUniforms(_).registerInternalVariables(o).declareVariables(...x,d)}
  ${i.mainStart()}
    ${i.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let col = (global_idx % (uniforms.N / ${p})) * ${p};
    var index1 = global_idx / (uniforms.N / ${p});
    let stride1 = uniforms.M / ${f};
    let row = (index1 % stride1) * ${f};
    let batch = index1 / stride1;

    ${2===n.length?"":`let batch_indices = ${o.offsetToIndices("batch")};`}

    var a_indices: ${u.type.indices};
    ${Ho("a_indices",u,u.rank-2,o.rank,"batch_indices")}
    ${u.indicesSet("a_indices",u.rank-2,0)}
    ${u.indicesSet("a_indices",u.rank-1,0)}
    let a_offset = ${u.indicesToOffset("a_indices")};

    var b_indices: ${c.type.indices};
    ${Ho("b_indices",c,c.rank-2,o.rank,"batch_indices")}
    ${c.indicesSet("b_indices",c.rank-2,0)}
    ${c.indicesSet("b_indices",c.rank-1,0)}
    let b_offset = ${c.indicesToOffset("b_indices")};
    var values: array<${d.type.value}, ${f}>;
    for (var k: u32 = 0u; k < uniforms.K; k = k + ${h}) {
      ${S()}
    }
    for (var i = 0u; i < ${f}u; i++) {
      var value = values[i];
      ${w}
      ${v}
      let cur_indices = ${d.type.indices}(batch, row + i, col);
      let offset = ${d.indicesToOffset("cur_indices")};
      ${d.setByOffset(`offset / ${p}`,"value")};
    }
  }
  `};return{name:"MatMulNaive",shaderCache:{hint:`${t.activation};${p};${h};${f};${a}`,inputDependencies:m?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:o?o(n):n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(g/64)},programUniforms:v}),getShaderSource:x}}}),ja=k(()=>{le(),ge(),ye(),wr(),Ha(),Ua(),jP=(e,t)=>e?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol${t?", batchIndices":""});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol${t?", batchIndices":""});
        `,qP=(e,t)=>e?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${3===t?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${3===t?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${3===t?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`,Ac=(e,t,n="f32",i,a=!1,o=32,s=!1,l=32)=>{let u=t[1]*e[1],c=t[0]*e[0],d=a?u:o,p=a?o:u,h=d/t[0],f=o/t[1];if(!((a&&4===h&&4===e[1]||!a&&(3===h||4===h))&&d%t[0]==0&&o%t[1]==0&&4===e[0]))throw Error(`If transposeA ${a} is true, innerElementSize ${h} and workPerThread[1] ${e[1]} must be 4.
      Otherwise, innerElementSize ${h} must be 3 or 4.
  tileAWidth ${d} must be divisible by workgroupSize[0]${t[0]}. tileInner ${o} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`
var<workgroup> mm_Asub: array<array<vec${h}<${n}>, ${d/h}>, ${p}>;
var<workgroup> mm_Bsub: array<array<vec4<${n}>, ${c/e[0]}>, ${o}>;

const rowPerThread = ${e[1]};
const colPerThread = ${e[0]};
const innerElementSize = ${h};
const tileInner = ${o};

@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = localRow * rowPerThread;
  let tileCol = i32(localId.x);

  let globalRow =i32(globalId.y) * rowPerThread;
  let globalCol = i32(globalId.x);
  let batch = ${s?"0":"i32(globalId.z)"};
  ${i?`let batchIndices = ${i.offsetToIndices("u32(batch)")};`:""}
  let globalRowStart = i32(workgroupId.y) * ${u};

  let num_tiles = ${s?`${Math.ceil(l/o)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
  var kStart = ${s?`i32(globalId.z) * ${l}`:"0"};

  var acc: array<vec4<${n}>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${f};
  for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${jP(a,i)}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${f}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${i?", batchIndices":""});
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${3===h?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${qP(a,h)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`},Pv=(e,t)=>e?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol${t?", batchIndices":""});
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol${t?", batchIndices":""});
            `,KP=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",Oc=(e,t,n="f32",i,a=!1,o=32,s=!1,l=32,u=!1)=>{let c=e[1]*t[1],d=e[0]*t[0],p=a?c:o,h=a?o:c;if(h%t[1]!=0||p%t[0]!=0||o%t[1]!=0)throw Error(`tileAHight ${h} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${p} must be divisible by workgroupSize[0]${t[0]}, tileInner ${o} must be divisible by workgroupSize[1]${t[1]}`);let f=h/t[1],g=p/t[0],m=o/t[1],y=u?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${c};
    let globalColStart = i32(workgroupId.x) * ${d};

    // Loop over shared dimension.
    for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${h}; inputRow = inputRow + ${t[1]}) {
        for (var inputCol = localCol; inputCol < ${p}; inputCol = inputCol + ${t[0]}) {
          ${Pv(a,i)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${o}; inputRow = inputRow + ${t[1]}) {
            for (var inputCol = localCol; inputCol < ${d}; inputCol = inputCol + ${t[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol${i?", batchIndices":""});
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<${n}, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${a?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${t[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${t[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${c};

let tileRowA = i32(localId.y) * ${f};
let tileColA = i32(localId.x) * ${g};
let tileRowB = i32(localId.y) * ${m};
// Loop over shared dimension.
for (var t = 0; t < num_tiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${f}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${g}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${Pv(a,i)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${m}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol${i?", batchIndices":""});
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<${n}, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${KP(a)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<${n}, ${p}>, ${h}>;
  var<workgroup> mm_Bsub : array<array<${n}, ${d}>, ${o}>;
  const rowPerThread = ${e[1]};
  const colPerThread = ${e[0]};
  const tileInner = ${o};

@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${s?"0":"i32(globalId.z)"};
    ${i?`let batchIndices = ${i.offsetToIndices("u32(batch)")};`:""}
    let num_tiles = ${s?`${Math.ceil(l/o)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
    var kStart = ${s?`i32(globalId.z) * ${l}`:"0"};

    var acc : array<array<${n}, colPerThread>, rowPerThread>;
    ${y}
  }
`},XP=(e,t,n,i,a=!1)=>{let[o,s,l,u]=i,c=Ve(i[0].type.tensor);return`
    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${o.type.indices}) -> ${rt(e,c)} {
      var value = ${rt(e,c)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)
      {
        var aIndices: ${s.type.indices};
        ${Ho("aIndices",s,s.rank-2,o.rank,"batchIndices")}
        ${s.indicesSet("aIndices",s.rank-2,"u32(row)")}
        ${s.indicesSet("aIndices",s.rank-1,"u32(colIn)")}
        value = ${s.getByIndices("aIndices")};
      }
      return value;
    }

    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${o.type.indices}) -> ${rt(e,c)} {
      var value = ${rt(e,c)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)
      {
        var bIndices: ${l.type.indices};
        ${Ho("bIndices",l,l.rank-2,o.rank,"batchIndices")}
        ${l.indicesSet("bIndices",l.rank-2,"u32(row)")}
        ${l.indicesSet("bIndices",l.rank-1,"u32(colIn)")}
        value = ${l.getByIndices("bIndices")};
      }
      return value;
    }

    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${rt(e,c)}) {
      let col = colIn * ${e};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
        var value = valueIn;
        let coords = vec3<i32>(batch, row, colIn);
        ${t?`value = value + ${a?"bias[colIn]":`${rt(e,c)}(bias[row])`};`:""}
        ${n}
        ${u.setByIndices("vec3<u32>(coords)","value")}
      }
    }
    `},jo=(e,t,n,i,a=!1,o)=>{let s=e[0].dims,l=e[1].dims,u=s.slice(0,-2),c=l.slice(0,-2),d=i?i.slice(0,-2):n.slice(0,-2),p=C.size(d),h=s[s.length-2],f=s[s.length-1],g=l[l.length-1],m=f%4==0&&g%4==0,y=h<=8?[4,1,1]:[4,4,1],b=[8,8,1],v=[Math.ceil(g/b[0]/y[0]),Math.ceil(h/b[1]/y[1]),Math.ceil(p/b[2]/y[2])],x=m?4:1,w=[...u,h,f/x],_=w.length,S=[...c,f,g/x],k=S.length,T=[p,h,g/x],E=[{type:6,data:h},{type:6,data:g},{type:6,data:f}];Zt(t,E),E.push(...W(d,w,S));let I=["rank","rank"],$=e.length>2;$&&(E.push(...W(e[2].dims)),I.push("rank")),E.push(...W(T));let O=n=>{let i=d.length,o=Ra("batchDims",e[0].dataType,i,1),s=Ve(e[0].dataType),l=N("a",e[0].dataType,_,x),u=N("b",e[1].dataType,k,x),c=G("result",e[0].dataType,T.length,x),p=[l,u];if($){let t=a?x:1;p.push(N("bias",e[2].dataType,e[2].dims.length,t))}let h=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];Jt(t,h);let f=Ve(c.type.tensor),g=XP(x,$,Xt(t,c.type.value,f),[o,l,u,c],a);return`
  ${n.registerUniforms(h).registerInternalVariables(o).declareVariables(...p,c)}
  ${g}
  ${m?Ac(y,b,s,o):Oc(y,b,s,o)}
                   `};return{name:"MatMul",shaderCache:{hint:`${y};${t.activation};${m};${a}`,inputDependencies:I},getRunData:()=>({outputs:[{dims:o?o(n):n,dataType:e[0].dataType}],dispatchGroup:{x:v[0],y:v[1],z:v[2]},programUniforms:E}),getShaderSource:O}}}),Cv=k(()=>{le(),Bn(),ye(),wr(),Ua(),Ov(),ja(),ZP=(e,t,n,i,a=!1,o,s=4,l=4,u=4,c="f32")=>{let d=e=>{switch(e){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${c}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw Error(`innerElementSize ${e} is not supported.`)}},p=e=>{switch(e){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw Error(`innerElementSize ${e} is not supported.`)}},h=e?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,f=e?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,g=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",m=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",y=e?"row":"col",b=e?"col":"row",v=`
    let inChannels = i32(uniforms.w_shape[2]);
    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
    let outRow = ${y} / outWidth;
    let outCol = ${y} % outWidth;

    let WRow = ${b} / (i32(uniforms.w_shape[1]) * inChannels);
    let WCol = ${b} / inChannels % i32(uniforms.w_shape[1]);
    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];
    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];
    let xCh = ${b} % inChannels;
    var resData = ${rt(s,c)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${g} && xCol >= 0 && xCol < ${m}) {
      ${h}
      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));
      ${d(s)}
    }
    return resData;`,x=e?t&&i?`
    let col = colIn * ${s};
    ${v}`:`
    let col = colIn * ${s};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
      ${v}
    }
    return ${rt(s,c)}(0.0);`:i&&n?`
    let col = colIn * ${s};
    ${v}`:`
    let col = colIn * ${s};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${v}
    }
    return ${rt(s,c)}(0.0);`,w=e?i&&n?p(l):`
    let col = colIn * ${l};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${p(l)}
    }
    return ${rt(l,c)}(0.0);`:`
    let col = colIn * ${l};
    if (row < uniforms.dim_inner && col < uniforms.dim_a_outer) {
      ${p(l)}
    }
    return ${rt(l,c)}(0.0);`,_=rt(u,c),S=e?rt(s,c):rt(l,c),k=e?rt(l,c):rt(s,c),T=Xt(o,_,c);return`
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${S} {
      ${e?x:w}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${k} {
      ${e?w:x}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${_}) {
      let col = colIn * ${u};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)
      {
      var value = valueIn;
      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${f}
      ${$v(a)}
      ${T}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`},Ev=(e,t,n,i,a,o,s,l,u)=>{let c="NHWC"===t.format,d=c?e[0].dims[3]:e[0].dims[1],p=n[0],h=c?n[2]:n[3],f=c?n[1]:n[2],g=c?n[3]:n[1],m=c&&(d%4==0||d%3==0)&&g%4==0,y=c?g:h*f,b=c?h*f:g,v=[8,8,1],x=i<=8?[4,1,1]:[4,4,1],w=[Math.ceil(y/v[0]/x[0]),Math.ceil(b/v[1]/x[1]),Math.ceil(p/v[2]/x[2])];_e("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${w}`);let _=m?c&&d%4!=0?3:4:1,S=v[1]*x[1],k=v[0]*x[0],T=Math.max(v[0]*_,v[1]),C=i%S==0,E=a%k==0,I=o%T==0,$=m?[_,4,4]:[1,1,1],O=[{type:6,data:i},{type:6,data:a},{type:6,data:o},{type:6,data:[t.pads[0],t.pads[1]]},{type:6,data:t.strides},{type:6,data:t.dilations}];Zt(t,O),O.push(...W(e[0].dims,e[1].dims));let A=["rank","rank"];s&&(O.push(...W(e[2].dims)),A.push("rank")),O.push(...W(n));let P=i=>{let a=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];Jt(t,a);let o=m?4:1,u=Ve(e[0].dataType),d=`
      fn setOutputAtIndex(flatIndex : i32, value : ${m?`vec4<${u}>`:u}) {
        result[flatIndex] = ${m?`vec4<${u}>`:u}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${m?`vec4<${u}>`:u}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${m?"/ 4":""}, value);
      }`,p=[N("x",e[0].dataType,e[0].dims.length,3===_?1:_),N("w",e[1].dataType,e[1].dims.length,o)],h=G("result",e[0].dataType,n.length,o);if(s){let t=N("bias",e[2].dataType,e[2].dims.length,o);p.push(t),d+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${m?`vec4<${u}>`:u} {
          return bias[coords.${c?"w":"y"}${m?"/ 4":""}];
        }`}return`
        ${Av("uniforms.result_strides")}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${i.registerUniforms(a).declareVariables(...p,h)}
        ${d}
        ${ZP(c,C,E,I,s,t,$[0],$[1],$[2],u)}
        ${m?Ac(x,v,u,void 0,!c,T):Oc(x,v,u,void 0,!c,T,!1,void 0,l)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${t.cacheKey};${_};${m};${C};${E};${I};${S};${k};${T}`,inputDependencies:A},getRunData:()=>({outputs:[{dims:u?u(n):n,dataType:e[0].dataType}],dispatchGroup:{x:w[0],y:w[1],z:w[2]},programUniforms:O}),getShaderSource:P}}}),Rv=k(()=>{le(),Bn(),ge(),ye(),wr(),Ua(),JP=e=>{let t=1;for(let n=0;n<e.length;n++)t*=e[n];return t},Dv=e=>"number"==typeof e?[e,e,e]:e,qa=(e,t)=>t<=1?e:e+(e-1)*(t-1),YP=(e,t,n,i=1)=>{let a=qa(t,i);return Math.floor((e[0]*(n-1)-n+a)/2)},kv=(e,t,n,i,a)=>{null==a&&(a=YP(e,t[0],i[0]));let o=[0,0,0,n];for(let n=0;n<3;n++)e[n]+2*a>=t[n]&&(o[n]=Math.trunc((e[n]-t[n]+2*a)/i[n]+1));return o},QP=(e,t,n,i,a,o,s,l,u,c)=>{let d,p,h,f;if("VALID"===e&&(e=0),"number"==typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e};let g=kv([t,n,i,1],[l,u,c],1,[a,o,s],e);p=g[0],h=g[1],f=g[2]}else if(Array.isArray(e)){if(!e.every((e,t,n)=>e===n[0]))throw Error(`Unsupported padding parameter: ${e}`);d={top:e[0],bottom:e[1],left:e[2],right:e[3],front:e[4],back:e[5]};let g=kv([t,n,i,1],[l,u,c],1,[a,o,s],e[0]);p=g[0],h=g[1],f=g[2]}else if("SAME_UPPER"===e){p=Math.ceil(t/a),h=Math.ceil(n/o),f=Math.ceil(i/s);let e=(p-1)*a+l-t,g=(h-1)*o+u-n,m=(f-1)*s+c-i,y=Math.floor(e/2),b=e-y,v=Math.floor(g/2),x=g-v,w=Math.floor(m/2),_=m-w;d={top:v,bottom:x,left:w,right:_,front:y,back:b}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:d,outDepth:p,outHeight:h,outWidth:f}},Nv=(e,t,n,i,a,o=!1,s="channelsLast")=>{let l,u,c,d,p;if("channelsLast"===s)[l,u,c,d,p]=e;else if("channelsFirst"===s)[l,p,u,c,d]=e;else throw Error(`Unknown dataFormat ${s}`);let[h,,f,g,m]=t,[y,b,v]=Dv(n),[x,w,_]=Dv(i),S=qa(f,x),k=qa(g,w),T=qa(m,_),{padInfo:E,outDepth:I,outHeight:$,outWidth:O}=QP(a,u,c,d,y,b,v,S,k,T),A=o?h*p:h,P=[0,0,0,0,0];return"channelsFirst"===s?P=[l,A,I,$,O]:"channelsLast"===s&&(P=[l,I,$,O,A]),{batchSize:l,dataFormat:s,inDepth:u,inHeight:c,inWidth:d,inChannels:p,outDepth:I,outHeight:$,outWidth:O,outChannels:A,padInfo:E,strideDepth:y,strideHeight:b,strideWidth:v,filterDepth:f,filterHeight:g,filterWidth:m,effectiveFilterDepth:S,effectiveFilterHeight:k,effectiveFilterWidth:T,dilationDepth:x,dilationHeight:w,dilationWidth:_,inShape:e,outShape:P,filterShape:t}},Lv=(e,t,n,i,a,o)=>{let s="channelsLast"===o,l=s?e[0].dims[3]:e[0].dims[1],u=!1,c=[64,1,1],d=[Math.ceil(JP(({x:n.map((e,t)=>t)}).x.map(e=>n[e]))/c[0]),1,1];_e("verbose",()=>`[conv3d_naive_webgpu] dispatch = ${d}`);let p=u?s&&l%4!=0?3:4:1,h=[{type:12,data:C.size(n)},{type:12,data:i},{type:12,data:a},{type:12,data:t.strides},{type:12,data:t.dilations}];Zt(t,h),h.push(...W(e[0].dims,e[1].dims));let f=["rank","rank"],g=3===e.length;g&&(h.push(...W(e[2].dims)),f.push("rank")),h.push(...W(n));let m=o=>{let l=[{name:"output_size",type:"u32"},{name:"filter_dims",type:"u32",length:i.length},{name:"pads",type:"u32",length:a.length},{name:"strides",type:"u32",length:t.strides.length},{name:"dilations",type:"u32",length:t.dilations.length}];Jt(t,l);let c=u?4:1,d=Ve(e[0].dataType),h=N("x",e[0].dataType,e[0].dims.length,3===p?1:p),f=N("W",e[1].dataType,e[1].dims.length,c),m=[h,f],y=G("result",e[0].dataType,n.length,c),b="";if(g){let t=N("bias",e[2].dataType,e[2].dims.length,c);m.push(t),b+=`
        fn getBiasByOutputCoords(coords : array<u32, 5>) -> ${u?`vec4<${d}>`:d} {
          return bias[${s?Q("coords",4,5):Q("coords",1,5)}${u?"/ 4":""}];
        }`}let v=rt(p,d),x=Xt(t,v,d);return`
            ${b}
            fn getX(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${h.getByIndices("aIndices")};
            }
            fn getW(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${f.getByIndices("aIndices")};
            }
          ${o.registerUniforms(l).declareVariables(...m,y)}
          ${o.mainStart()}
          ${o.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
              let coords = ${y.offsetToIndices("global_idx")};
              let batch = ${Q("coords",0,h.rank)};
              let d2 = ${s?Q("coords",h.rank-1,h.rank):Q("coords",1,h.rank)};
              let xFRCCorner = vec3<u32>(${s?Q("coords",1,h.rank):Q("coords",2,h.rank)},
              ${s?Q("coords",2,h.rank):Q("coords",3,h.rank)},
              ${s?Q("coords",3,h.rank):Q("coords",4,h.rank)}) * uniforms.strides - uniforms.pads;
              let xFCorner = xFRCCorner.x;
              let xRCorner = xFRCCorner.y;
              let xCCorner = xFRCCorner.z;
              let xShapeY = ${s?Q("uniforms.x_shape",1,h.rank):Q("uniforms.x_shape",2,h.rank)};
              let xShapeZ = ${s?Q("uniforms.x_shape",2,h.rank):Q("uniforms.x_shape",3,h.rank)};
              let xShapeW = ${s?Q("uniforms.x_shape",3,h.rank):Q("uniforms.x_shape",4,h.rank)};
              let xShapeU = ${s?Q("uniforms.x_shape",4,h.rank):Q("uniforms.x_shape",1,h.rank)};
              let inputDepthNearestVec4 = (xShapeU / 4) * 4;
              let inputDepthVec4Remainder = xShapeU % 4;

              var value = 0.0;
              for (var wF = 0u; wF < uniforms.filter_dims[0]; wF++) {
                let xF = xFCorner + wF * uniforms.dilations[0];
                if (xF < 0 || xF >= xShapeY) {
                  continue;
                }

                for (var wR = 0u; wR < uniforms.filter_dims[1]; wR++) {
                  let xR = xRCorner + wR * uniforms.dilations[1];
                  if (xR < 0 || xR >= xShapeZ) {
                    continue;
                  }

                  for (var wC = 0u; wC < uniforms.filter_dims[2]; wC++) {
                    let xC = xCCorner + wC * uniforms.dilations[2];
                    if (xC < 0 || xC >= xShapeW) {
                      continue;
                    }

                    for (var d1 = 0u; d1 < inputDepthNearestVec4; d1 += 4) {
                      ${s?`let xValues = vec4<f32>(
                               getX(batch, xF, xR, xC, d1),
                               getX(batch, xF, xR, xC, d1 + 1),
                               getX(batch, xF, xR, xC, d1 + 2),
                               getX(batch, xF, xR, xC, d1 + 3));
                            `:`let xValues = vec4<f32>(
                               getX(batch, d1, xF, xR, xC),
                               getX(batch, d1 + 1, xF, xR, xC),
                               getX(batch, d1 + 2, xF, xR, xC),
                               getX(batch, d1 + 3, xF, xR, xC));
                            `}
                            let wValues = vec4<f32>(
                              getW(d2, d1, wF, wR, wC),
                              getW(d2, d1 + 1, wF, wR, wC),
                              getW(d2, d1 + 2, wF, wR, wC),
                              getW(d2, d1 + 3, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                    if (inputDepthVec4Remainder == 1) {
                        ${s?`value += getX(batch, xF, xR, xC, inputDepthNearestVec4)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`:`value += getX(batch, inputDepthNearestVec4, xF, xR, xC)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`}
                    } else if (inputDepthVec4Remainder == 2) {
                      ${s?`let xValues = vec2<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1));
                      `:`let xValues = vec2<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC));
                    `}
                    let wValues = vec2<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC));
                      value += dot(xValues, wValues);
                    } else if (inputDepthVec4Remainder == 3) {
                      ${s?`let xValues = vec3<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2));
                      `:`let xValues = vec3<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 2, xF, xR, xC));
                    `}
                    let wValues = vec3<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 2, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                  }
                }
              }
              ${g?"value = value + getBiasByOutputCoords(coords)":""};
              ${x}
              result[global_idx] = f32(value);
          }`};return{name:"Conv3DNaive",shaderCache:{hint:`${t.cacheKey};${s};${p};${g}`,inputDependencies:f},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:d[0],y:d[1],z:d[2]},programUniforms:h}),getShaderSource:m}}}),Bv=k(()=>{le(),ge(),ye(),wr(),zv=(e,t,n,i)=>{let a=e.length>2,o=a?"value += b[output_channel];":"",s=e[0].dims,l=e[1].dims,u="NHWC"===t.format,c=u?n[3]:n[1],d=c/t.group,p=u&&d>=4?Ee(c):1,h=C.size(n)/p,f=[{type:12,data:h},{type:12,data:t.dilations},{type:12,data:[t.strides[0],t.strides[1]]},{type:12,data:[t.pads[0],t.pads[1]]},{type:12,data:d}];Zt(t,f),f.push(...W(s,[l[0],l[1],l[2],l[3]/p]));let g=a?["rank","rank","rank"]:["rank","rank"];f.push(...W([n[0],n[1],n[2],n[3]/p]));let m=i=>{let c=G("output",e[0].dataType,n.length,p),d=Ve(c.type.tensor),h=Xt(t,c.type.value,d),f=N("x",e[0].dataType,s.length),g=N("w",e[1].dataType,l.length,p),m=[f,g];a&&m.push(N("b",e[2].dataType,e[2].dims,p));let y=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:t.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];Jt(t,y);let b=u?`
      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[0]; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

        if (xHeight < 0u || xHeight >= uniforms.x_shape[1]) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[1]; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
          if (xWidth < 0u || xWidth >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[2]; wInChannel++) {
            let input_channel = in_channel_offset + wInChannel;
            let xVal = ${f.get("batch","xHeight","xWidth","input_channel")};
            let wVal = ${g.get("wHeight","wWidth","wInChannel","output_channel")};
            value += xVal * wVal;
          }
        }
      }
      `:`
      for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {
        let input_channel = in_channel_offset + wInChannel;
        for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {
          let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

          if (xHeight < 0u || xHeight >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {
            let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
            if (xWidth < 0u || xWidth >= uniforms.x_shape[3]) {
              continue;
            }

            let xVal = ${f.get("batch","input_channel","xHeight","xWidth")};
            let wVal = ${g.get("output_channel","wInChannel","wHeight","wWidth")};
            value += xVal * wVal;
          }
        }
      }
      `;return`
  ${i.registerUniforms(y).declareVariables(...m,c)}

  ${i.mainStart()}
    ${i.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let outputIndices = ${c.offsetToIndices("global_idx")};
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${u?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${u?1:2}], outputIndices[${u?2:3}]) * uniforms.strides - uniforms.pads;
    let group_id: u32 = output_channel * ${p} / uniforms.output_channels_per_group;
    var in_channel_offset = group_id * uniforms.w_shape[${u?2:1}];

    var value: ${c.type.value} = ${c.type.value}(0);
    ${b}
    ${o}
    ${h}
    ${c.setByOffset("global_idx","value")}
  }`};return{name:"GroupedConv",shaderCache:{hint:`${t.cacheKey}_${p}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:i?i(n):n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:f}),getShaderSource:m}},Mv=(e,t,n,i)=>{let a=e.length>2,o=Ee(n[3]),s=Ee(n[2]),l=C.size(n)/o/s,u=[e[0].dims[0],e[0].dims[1],e[0].dims[2],e[0].dims[3]/o],c=[e[1].dims[0],e[1].dims[1],e[1].dims[2],e[1].dims[3]/o],d=[n[0],n[1],n[2],n[3]/o],p=[{type:12,data:l},{type:6,data:[t.strides[0],t.strides[1]]},{type:6,data:[t.pads[0],t.pads[1]]}];Zt(t,p),p.push(...W(u,c,d));let h=(s-1)*t.strides[1]+c[1],f=n=>{let i=G("output",e[0].dataType,d.length,o),l=Ve(i.type.tensor),p=Xt(t,i.type.value,l),f=N("x",e[0].dataType,u.length,o),g=N("w",e[1].dataType,c.length,o),m=[f,g];a&&m.push(N("b",e[2].dataType,e[2].dims,o));let y=a?"value += b[output_channel];":"",b=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return Jt(t,b),`
  ${n.registerUniforms(b).declareVariables(...m,i)}
  ${n.mainStart()}
    ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let width0 = uniforms.output_shape[3];
    let output_channel = global_idx % width0;
    var index1 = global_idx / width0;
    let width1 = uniforms.output_shape[2] / ${s}u;
    let col = (index1 % width1) * ${s}u;
    index1 = index1 / width1;
    let row = index1 % uniforms.output_shape[1];
    let batch = index1 / uniforms.output_shape[1];

    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;

    var x_vals: array<${f.type.value}, ${h}>;
    var values: array<${i.type.value}, ${s}>;
    let input_channel = output_channel;
    // Use constant instead of uniform can give better performance for w's height/width.
    for (var w_height: u32 = 0u; w_height < ${c[0]}; w_height++) {
      let x_height = x_corner.x + i32(w_height);
      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {
        for (var i = 0; i < ${h}; i++) {
          let x_width = x_corner.y + i;
          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {
            x_vals[i] = ${f.get("batch","u32(x_height)","u32(x_width)","input_channel")};
          } else {
            x_vals[i] = ${f.type.value}(0);
          }
        }
        for (var w_width: u32 = 0u; w_width < ${c[1]}; w_width++) {
          let w_val = ${g.get("w_height","w_width","0","output_channel")};
          for (var i = 0u; i < ${s}u; i++) {
            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);
          }
        }
      }
    }

    for (var i = 0u; i < ${s}u; i++) {
      var value = values[i];
      ${y}
      ${p}
      ${i.set("batch","row","col + i","output_channel","value")};
    }
  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${t.cacheKey};${o};${s};${h};${c[0]};${c[1]}`,inputDependencies:a?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:i?i(n):n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:p}),getShaderSource:f}}}),Vv=k(()=>{ge(),Cv(),Rv(),ja(),Bv(),wr(),Ha(),Yn(),eE=(e,t,n,i,a,o)=>{let s=e[0],l=e.slice(o?1:2,o?3:4),u=l.length,c=t[0],d=t.slice(2).map((e,t)=>e+(e-1)*(n[t]-1)),p=l.map((e,t)=>e+i[t]+i[t+u]).map((e,t)=>Math.floor((e-d[t]+a[t])/a[t]));return p.splice(0,0,s),p.splice(o?3:1,0,c),p},Pc=[2,3,1,0],tE=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw Error("Conv requires 2 or 3 inputs");if(e[0].dims.length>5)throw Error("greater than 5D is not supported");if(e[0].dims.length!==e[1].dims.length)throw Error("filter does not have same dimension as input");if(e[0].dims["NHWC"===t.format?e[0].dims.length-1:1]!==e[1].dims[1]*t.group)throw Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(3===e.length&&(1!==e[2].dims.length||e[1].dims[0]!==e[2].dims[0]))throw Error("invalid bias");let n=e[0].dims.length-2;if(t.dilations.length!==n)throw Error(`dilations should be ${n}D`);if(t.strides.length!==n)throw Error(`strides should be ${n}D`);if(t.pads.length!==2*n)throw Error(`pads should be ${2*n}D`);if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw Error("invalid kernel shape")},Ec=(e,t)=>{let n=e.kernelShape.slice();n.length<t[1].dims.length-2&&n.push(...Array(t[1].dims.length-2-n.length).fill(0));for(let e=2;e<t[1].dims.length;++e)0===n[e-2]&&(n[e-2]=t[1].dims[e]);let i=e.pads.slice();Ur.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,n,i,"NHWC"===e.format,e.autoPad);let a=Object.assign({},e);return Object.assign(a,{kernelShape:n,pads:i}),a},Cc=e=>{let t=Ga(e),n=e.format;return{autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],format:n,dilations:e.dilations,group:e.group,kernelShape:e.kernel_shape,pads:e.pads,strides:e.strides,wIsConst:e.w_is_const(),...t,cacheKey:`${e.format};${t.activation};`}},Fv=(e,t,n,i)=>{let a="NHWC"===n.format,o=eE(t[0].dims,t[1].dims,n.dilations,n.pads,n.strides,a);if(1!==n.group){let s=[t[0]];if(a){let i=e.kernelCustomData.wT??e.compute(at(t[1],Pc),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=i),s.push(i)}else s.push(t[1]);3===t.length&&s.push(t[2]),!e.adapterInfo.isArchitecture("ampere")&&a&&t[1].dims[0]===n.group&&1===t[1].dims[1]&&1===n.dilations[0]&&1===n.dilations[1]?e.compute(Mv(s,n,o,i),{inputs:s}):e.compute(zv(s,n,o,i),{inputs:s});return}let s=3===t.length,l=t[0].dims[a?1:2],u=t[0].dims[a?2:3],c=t[0].dims[a?3:1],d=t[1].dims[2],p=t[1].dims[3],h=o[a?1:2],f=o[a?2:3],g=o[a?3:1],m=a&&d===l&&p===u&&0===n.pads[0]&&0===n.pads[1];if(m||1===d&&1===p&&1===n.dilations[0]&&1===n.dilations[1]&&1===n.strides[0]&&1===n.strides[1]&&0===n.pads[0]&&0===n.pads[1]){let d=o[0],p,y,b,v=[];if(a){let i=e.kernelCustomData.wT??e.compute(at(t[1],Pc),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];if(n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=i),m){let e=l*u*c;p=t[0].reshape([1,d,e]),y=i.reshape([1,e,g]),b=[1,d,g]}else p=t[0].reshape([d,l*u,c]),y=i.reshape([1,c,g]),b=[d,h*f,g];v.push(p),v.push(y)}else p=t[0].reshape([d,c,l*u]),y=t[1].reshape([1,g,c]),b=[d,g,h*f],v.push(y),v.push(p);s&&v.push(t[2]);let x=b[2],w=v[0].dims[v[0].dims.length-1];x<8&&w<8?e.compute(Wa(v,n,o,b,a,i),{inputs:v}):e.compute(jo(v,n,o,b,a,i),{inputs:v});return}let y=!0,b=e.kernelCustomData.wT??e.compute(at(t[1],Pc),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=b);let v=[t[0],b];s&&v.push(t[2]);let x=a?h*f:g,w=a?g:h*f,_=d*p*c;e.compute(Ev(v,n,o,x,w,_,s,y,i),{inputs:v})},nE=(e,t)=>{let n="NHWC"===t.format,i=[e.inputs[0].reshape(n?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];3===e.inputs.length&&i.push(e.inputs[2]);let a=[0,t.pads[0],0,t.pads[1]],o=[1].concat(t.strides),s=[1].concat(t.dilations),l=[1].concat(t.kernelShape),u=Ec({...t,pads:a,strides:o,dilations:s,kernelShape:l},i);Fv(e,i,u,e=>n?[e[0],e[2],e[3]]:[e[0],e[1],e[3]])},rE=(e,t,n)=>{let i="NHWC"===n.format?"channelsLast":"channelsFirst",a=Ec(n,t),o="NOTSET"===n.autoPad?n.pads:n.autoPad,s=Nv(t[0].dims,t[1].dims,n.strides,n.dilations,o,!1,i);e.compute(Lv(t,a,s.outShape,[s.filterDepth,s.filterHeight,s.filterWidth],[s.padInfo.front,s.padInfo.top,s.padInfo.left],i))},Dc=(e,t)=>{if(tE(e.inputs,t),3===e.inputs[0].dims.length)nE(e,t);else if(5===e.inputs[0].dims.length)rE(e,e.inputs,t);else{let n=Ec(t,e.inputs);Fv(e,e.inputs,n)}}}),Uv=k(()=>{le(),Bn(),ge(),ye(),Gv=(e,t,n)=>{let i=e.length>2,a=t.outputShape,o="NHWC"===t.format,s=t.group,l=e[1].dims,u=l[2]/s,c=l[3],d=o?Ee(u):1,p=o&&1===c&&u>=4,h=p?4*Math.floor(u/4):Math.floor(u/d)*d,f=u-h,g=o?Ee(c):1,m=o?1===c?d:g:1,y=C.size(a)/g,b=[Math.ceil(y/64),1,1];_e("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${b}`);let v=["rank","rank"],x=[t.strides[0],t.strides[1]],w=[t.kernelShape[o?1:2],t.kernelShape[o?2:3]],_=[t.dilations[0],t.dilations[1]],S=[w[0]+(t.dilations[0]<=1?0:(t.kernelShape[o?1:2]-1)*(t.dilations[0]-1)),w[1]+(t.dilations[1]<=1?0:(t.kernelShape[o?2:3]-1)*(t.dilations[1]-1))],k=[S[0]-1-Math.floor((t.pads[0]+t.pads[2])/2),S[1]-1-Math.floor((t.pads[1]+t.pads[3])/2)],T=[{type:12,data:y},{type:12,data:x},{type:12,data:w},{type:12,data:_},{type:12,data:S},{type:6,data:k},{type:12,data:h},{type:12,data:u},{type:12,data:c},...W(e[0].dims,e[1].dims)];i&&(T.push(...W(e[2].dims)),v.push("rank")),T.push(...W(a));let E=t=>{let n=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:x.length},{name:"filter_dims",type:"u32",length:w.length},{name:"dilations",type:"u32",length:w.length},{name:"effective_filter_dims",type:"u32",length:S.length},{name:"pads",type:"i32",length:k.length},{name:"input_channels_per_group_int",type:"u32"},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],s=Ve(e[0].dataType),l=o?1:2,u=o?2:3,c=o?3:1,h=N("W",e[1].dataType,e[1].dims.length,m),y=N("Dy",e[0].dataType,e[0].dims.length,d),b=[y,h];i&&b.push(N("bias",e[2].dataType,[a[c]].length,g));let v=G("result",e[0].dataType,a.length,g),_=()=>{let e="";if(p)4===d?e+=`
        let xValue = ${y.getByOffset("x_offset")};
        let wValue = ${h.getByOffset("w_offset")};
        dotProd = dotProd + dot(xValue, wValue);
        x_offset += 1u;
        w_offset += 1u;`:2===d?e+=`
          dotProd = dotProd + dot(vec4<${s}>(${y.getByOffset("x_offset")}, ${y.getByOffset("x_offset + 1u")}), vec4<${s}>(${h.getByOffset("w_offset")}, ${h.getByOffset("w_offset + 1u")}));
          x_offset += 2u;
          w_offset += 2u;`:1===d&&(e+=`
          dotProd = dotProd + dot(vec4<${s}>(${y.getByOffset("x_offset")}, ${y.getByOffset("x_offset + 1u")}, ${y.getByOffset("x_offset + 2u")}, ${y.getByOffset("x_offset + 3u")}), vec4<${s}>(${h.getByOffset("w_offset")}, ${h.getByOffset("w_offset + 1u")}, ${h.getByOffset("w_offset + 2u")}, ${h.getByOffset("w_offset + 3u")}));
          x_offset += 4u;
          w_offset += 4u;`);else if(e+=`
                  let xValue = ${o?y.getByOffset(`${y.indicesToOffset(`${y.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${d}`):y.get("batch","inputChannel","idyR","idyC")};
        `,1===d)e+=`
          let w_offset = ${h.indicesToOffset(`${h.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)`)};
          let wValue = ${h.getByOffset(`w_offset / ${m}`)};
          dotProd = dotProd + xValue * wValue;`;else for(let t=0;t<d;t++)e+=`
            let wValue${t} = ${h.getByOffset(`${h.indicesToOffset(`${h.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel + ${t}, wOutChannel)`)} / ${m}`)};
            dotProd = dotProd + xValue[${t}] * wValue${t};`;return e},T=()=>{if(0===f)return"";if(!p)throw Error(`packInputAs4 ${p} is not true.`);let e="";if(1===d){e+="dotProd = dotProd";for(let t=0;t<f;t++)e+=`
            + ${y.getByOffset(`x_offset + ${t}`)} * ${h.getByOffset(`w_offset + ${t}`)}`;e+=";"}else if(2===d){if(2!==f)throw Error(`Invalid inputChannelsRemainder ${f}.`);e+=`
          let xValue = ${y.getByOffset("x_offset")};
          let wValue = ${h.getByOffset("w_offset")};
          dotProd = dotProd + dot(xValue, wValue);`}return e},E=`
            let outputIndices = ${v.offsetToIndices(`global_idx * ${g}`)};
            let batch = ${v.indicesGet("outputIndices",0)};
            let d1 = ${v.indicesGet("outputIndices",c)};
            let r = ${v.indicesGet("outputIndices",l)};
            let c = ${v.indicesGet("outputIndices",u)};
            let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;
            let dyRCorner = dyCorner.x;
            let dyCCorner = dyCorner.y;
            let groupId = d1 / uniforms.output_channels_per_group;
            let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;
            // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
            // ? = to be determined. : = across all values in that axis.
            var dotProd = ${v.type.value}(0.0);
            var wR: u32 = 0;
            if (uniforms.dilations.x == 1) {
              // Minimum wR >= 0 that satisfies (dyRCorner + wR) % (uniforms.strides.x) == 0
              wR = u32(((dyRCorner + i32(uniforms.strides.x) - 1) / i32(uniforms.strides.x)) * i32(uniforms.strides.x) - dyRCorner);
            }
            for (; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {
              if (wR % uniforms.dilations.x != 0) {
                continue;
              }
              let dyR = (${s}(dyRCorner) + ${s}(wR)) / ${s}(uniforms.strides[0]);
              let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;
              if (dyR < 0.0 || dyR >= ${s}(uniforms.Dy_shape[${l}]) || fract(dyR) > 0.0 ||
                  wRPerm < 0) {
                continue;
              }
              let idyR: u32 = u32(dyR);
              var wC: u32 = 0;
              if (uniforms.dilations.y == 1) {
                // Minimum wC >= 0 that satisfies (dyCCorner + wC) % (uniforms.strides.y) == 0
                wC = u32(((dyCCorner + i32(uniforms.strides.y) - 1) / i32(uniforms.strides.y)) * i32(uniforms.strides.y) - dyCCorner);
              }
              for (; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {
                if (wC % uniforms.dilations.y != 0) {
                  continue;
                }
                let dyC = (${s}(dyCCorner) + ${s}(wC)) / ${s}(uniforms.strides.y);
                let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;
                if (dyC < 0.0 || dyC >= ${s}(uniforms.Dy_shape[${u}]) ||
                    fract(dyC) > 0.0 || wCPerm < 0) {
                  continue;
                }
                let idyC: u32 = u32(dyC);
                var inputChannel = groupId * uniforms.input_channels_per_group;
                ${p?`
                var x_offset = ${y.indicesToOffset(`${y.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${d};
                var w_offset = ${h.indicesToOffset(`${h.type.indices}(wRPerm, wCPerm, inputChannel, wOutChannel)`)} / ${m};
                  `:""}
                for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group_int; d2 = d2 + ${p?4:d}) {
                  ${_()}
                  inputChannel = inputChannel + ${p?4:d};
                }
                ${T()}
                wC = wC + uniforms.strides.y - 1;
              }
              wR = wR + uniforms.strides[0] - 1;
            }
            let value = dotProd${i?` + bias[d1 / ${g}]`:""};
            ${v.setByOffset("global_idx","value")};
          `;return`
    ${t.registerUniforms(n).declareVariables(...b,v)}
      ${t.mainStart()}
      ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};
    ${E}}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${t.cacheKey};${d}${m}${g}${p}${f}`,inputDependencies:v},getRunData:()=>({dispatchGroup:{x:b[0],y:b[1],z:b[2]},outputs:[{dims:n?n(a):a,dataType:e[0].dataType}],programUniforms:T}),getShaderSource:E}}}),Kv=k(()=>{Uv(),wr(),Yn(),oE=(e,t,n,i,a,o)=>(e-1)*t+n+(i-1)*a+1-o,iE=(e,t,n,i,a)=>{let o=Math.floor(e/2);"SAME_UPPER"===t?(n[i]=o,n[a]=e-o):"SAME_LOWER"===t&&(n[i]=e-o,n[a]=o)},aE=(e,t,n,i,a,o,s,l,u,c)=>{let d=e.length-2,p=0===c.length;u.length<d&&u.push(...Array(d-u.length).fill(0));let h=e[0],f=t[l?3:1]*a;for(let a=0,h=e.length-d-!!l;a<d;++a,++h){let l=e[h],f=p?l*s[a]:c[a];iE(oE(l,s[a],o[a],t[h],n[a],f),i,o,a,a+d),p&&c.push(s[a]*(l-1)+u[a]+(t[h]-1)*n[a]+1-o[a]-o[a+d])}c.splice(0,0,h),c.splice(l?3:1,0,f)},Wv=(e,t)=>{let n=e.kernelShape.slice();if(0===e.kernelShape.length||0===e.kernelShape.reduce((e,t)=>e*t,1)){n.length=0;for(let e=2;e<t[1].dims.length;++e)n.push(t[1].dims[e])}let i="NHWC"===e.format;n.splice(0,0,t[1].dims[0]),n.splice(i?3:1,0,t[1].dims[1]);let a=e.pads.slice(),o=e.outputShape.slice(),s=e.outputPadding.slice(),l=t[0].dims,u=e.dilations.slice();0===u.reduce((e,t)=>e+t,0)&&(u=Array(t[0].dims.length-2).fill(1));let c=e.strides.slice();0===c.reduce((e,t)=>e+t,0)&&(c=Array(t[0].dims.length-2).fill(1)),aE(l,n,u,e.autoPad,e.group,a,c,i,s,o);let d=Object.assign({},e);return Object.assign(d,{kernelShape:n,pads:a,outputPadding:s,outputShape:o,dilations:u,strides:c}),d},Hv=e=>{let t=Ga(e),n=e.format,i=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],a=e.dilations,o=e.group,s=e.kernelShape,l=e.pads,u=e.strides,c=e.wIsConst();return{autoPad:i,format:n,dilations:a,group:o,kernelShape:s,outputPadding:e.outputPadding,outputShape:e.outputShape,pads:l,strides:u,wIsConst:c,...t,cacheKey:`${e.format};${t.activation};`}},sE=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length&&3!==e[0].dims.length)throw Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw Error("filter does not have same dimension as input");if(e[0].dims["NHWC"===t.format?e[0].dims.length-1:1]!==e[1].dims[0])throw Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let n=e[1].dims[1]*t.group;if(3===e.length&&(1!==e[2].dims.length||e[2].dims[0]!==n))throw Error("invalid bias");let i=e[0].dims.length-2;if(t.dilations.reduce((e,t)=>e+t,0)>0&&t.dilations.length!==i)throw Error(`dilations should be ${i}D`);if(t.strides.reduce((e,t)=>e+t,0)>0&&t.strides.length!==i)throw Error(`strides should be ${i}D`);if(t.pads.reduce((e,t)=>e+t,0)>0&&t.pads.length!==2*i)throw Error(`pads should be ${2*i}D`);if(t.outputPadding.length!==i&&0!==t.outputPadding.length)throw Error(`output_padding should be ${i}D`);if(t.kernelShape.reduce((e,t)=>e+t,0)>0&&0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw Error("invalid kernel shape");if(0!==t.outputShape.length&&t.outputShape.length!==e[0].dims.length-2)throw Error("invalid output shape")},jv=(e,t,n,i)=>{let a=e.kernelCustomData.wT??e.compute(at(t[1],[2,3,0,1]),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=a);let o=[t[0],a];3===t.length&&o.push(t[2]),e.compute(Gv(o,n,i),{inputs:o})},uE=(e,t)=>{let n="NHWC"===t.format,i=[e.inputs[0].reshape(n?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];3===e.inputs.length&&i.push(e.inputs[2]);let a=t.kernelShape;(0===a.length||0===a[0])&&(a=[e.inputs[1].dims[2]]);let o=t.dilations;(0===o.length||0===o[0])&&(o=[1]);let s=t.strides;(0===s.length||0===s[0])&&(s=[1]);let l=t.pads;0===l.length&&(l=[0,0]),l=[0,l[0],0,l[1]],s=[1].concat(s),o=[1].concat(o),a=[1].concat(a);let u=t.outputPadding;u=[0].concat(u);let c=Wv({...t,pads:l,strides:s,dilations:o,kernelShape:a,outputPadding:u},i);jv(e,i,c,e=>n?[e[0],e[2],e[3]]:[e[0],e[1],e[3]])},qv=(e,t)=>{if(sE(e.inputs,t),3===e.inputs[0].dims.length)uE(e,t);else{let n=Wv(t,e.inputs);jv(e,e.inputs,n)}}}),Jv=k(()=>{le(),ge(),Xe(),ye(),lE=(e,t,n,i)=>{let a=C.size(t),o=t.length,s=N("input",e,o),l=G("output",e,o),u=6===n.dataType?n.getInt32Array()[0]:Number(n.getBigInt64Array()[0]),c=C.normalizeAxis(u,o),d=e=>{let t=` i32(${s.indicesGet("inputIndices","uniforms.axis")}) `,n=Q("uniforms.input_shape","uniforms.axis",o),a=i.reverse?t+(i.exclusive?" + 1":""):"0",u=i.reverse?n:t+(i.exclusive?"":" + 1");return`
                ${e.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(s,l)}
                ${e.mainStart()}
                  ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
                  var inputIndices = ${l.offsetToIndices("global_idx")};
                  var sum = ${l.type.value}(0);
                  let first : i32 = ${a};
                  let last : i32 = ${u};
                  for (var i : i32 = first; i < last; i++) {
                    ${s.indicesSet("inputIndices","uniforms.axis","u32(i)")};
                    sum = sum + ${s.getByIndices("inputIndices")};
                  }
                  ${l.setByOffset("global_idx","sum")};
                }`};return{name:"CumSum",shaderCache:{hint:i.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:[{type:12,data:a},{type:12,data:c},...W(t,t)]}),getShaderSource:d}},Xv=(e,t)=>{let n=e.inputs[0].dims,i=e.inputs[0].dataType,a=e.inputs[1];e.compute(lE(i,n,a,t),{inputs:[0]})},Zv=e=>{let t=1===e.exclusive,n=1===e.reverse;return ce({exclusive:t,reverse:n})}}),e0=k(()=>{le(),ge(),Xe(),ye(),cE=e=>{if(!e||1!==e.length)throw Error("DepthToSpace requires 1 input.");if(4!==e[0].dims.length)throw Error("DepthToSpace requires 4D input.")},dE=(e,t,n,i)=>{let a=[];a.push(`fn perm(i: ${i.type.indices}) -> ${n.type.indices} {
    var a: ${n.type.indices};`);for(let i=0;i<t;++i)a.push(n.indicesSet("a",e[i],`i[${i}]`));return a.push("return a;}"),a.join(`
`)},pE=(e,t)=>{let n,i,a,o,s,l,u="NHWC"===t.format,c=t.blocksize,d="DCR"===t.mode;u?([n,i,a,o]=e.dims,s=d?[n,i,a,c,c,o/c**2]:[n,i,a,o/c**2,c,c],l=d?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([n,i,a,o]=[e.dims[0],e.dims[2],e.dims[3],e.dims[1]],s=d?[n,c,c,o/c**2,i,a]:[n,o/c**2,c,c,i,a],l=d?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let p=e.reshape(s),h=p.dims.length,f=e.dataType,g=N("a",f,h),m=G("output",f,h),y=e=>`
  ${e.registerUniform("output_size","u32").declareVariables(g,m)}

  ${dE(l,h,g,m)}

  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${m.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${m.setByOffset("global_idx",g.getByIndices("aIndices"))}
  }`;return{name:"DepthToSpace",shaderCache:{hint:`${e.dims};${t.blocksize};${t.mode}`,inputDependencies:["rank"]},getRunData:e=>{let t=u?[n,i*c,a*c,o/c**2]:[n,o/c**2,i*c,a*c],s=C.size(t),d=p.dims,h=C.sortBasedOnPerm(d,l);return{outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:[{type:12,data:s},...W(d,h)]}},getShaderSource:y}},Yv=(e,t)=>{cE(e.inputs),e.compute(pE(e.inputs[0],t))},Qv=e=>ce({blocksize:e.blocksize,mode:e.mode,format:e.format})}),i0=k(()=>{le(),ge(),Xe(),ye(),t0="^"+(Ka="("+(kc="[a-zA-Z]|\\.\\.\\.")+")+")+"$",hE="^"+("("+Ka+",)*")+Ka+"$",Nc=class{constructor(e=-1){this.symbolToIndices=new Map,this.inputIndex=e}addSymbol(e,t){let n=this.symbolToIndices.get(e);void 0===n?n=[t]:n.push(t),this.symbolToIndices.set(e,n)}},Lc=class{constructor(e,t){this.equation=t,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=[],this.outputDims=[];let[n,i]=t.includes("->")?t.split("->",2):[t,""];if(!n.match(RegExp(hE)))throw Error("Invalid LHS term");if(n.split(",").forEach((t,n)=>{let i=e[n].dims.slice();if(!t.match(RegExp(t0)))throw Error("Invalid LHS term");let a=this.processTerm(t,!0,i,n);this.lhs.push(a)}),""===i)i+=[...this.symbolToInfo.entries()].filter(([e,t])=>1===t.count||"..."===e).map(([e])=>e).join("");else if(!i.match(RegExp(Ka)))throw Error("Invalid RHS");i.match(RegExp(kc,"g"))?.forEach(e=>{if("..."===e)this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let t=this.symbolToInfo.get(e);if(void 0===t)throw Error("Invalid RHS symbol");this.outputDims.push(t.dimValue)}}),this.rhs=this.processTerm(i,!1,this.outputDims)}addSymbol(e,t,n){let i=this.symbolToInfo.get(e);if(void 0!==i){if(i.dimValue!==t&&1!==i.count)throw Error("Dimension mismatch");i.count++,i.inputIndices.push(n)}else i={count:1,dimValue:t,inputIndices:[n]};this.symbolToInfo.set(e,i)}processTerm(e,t,n,i=-1){let a=n.length,o=!1,s=[],l=0;if(!e.match(RegExp(t0))&&!t&&""!==e)throw Error("Invalid LHS term");let u=e.match(RegExp(kc,"g")),c=new Nc(i);return u?.forEach((e,d)=>{if("..."===e){if(o)throw Error("Only one ellipsis is allowed per input term");o=!0;let e=a-u.length+1;if(e<0)throw Error("Ellipsis out of bounds");if(s=n.slice(l,l+e),this.hasEllipsis){if(this.ellipsisDims.length!==s.length||this.ellipsisDims.toString()!==s.toString())throw Error("Ellipsis dimensions mismatch")}else if(t)this.hasEllipsis=!0,this.ellipsisDims=s;else throw Error("Ellipsis must be specified in the LHS");for(let e=0;e<s.length;e++){let t=String.fromCharCode(48+e);c.addSymbol(t,d+e),this.addSymbol(t,n[l++],i)}}else c.addSymbol(e,d+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(e,n[l++],i)}),c}},n0=e=>e+"_max",mE=(e,t,n,i)=>{let a=e.map(e=>e.length).map((e,n)=>N(`input${n}`,t,e)),o=C.size(i),s=G("output",t,i.length),l=[...n.symbolToInfo.keys()].filter(e=>!n.rhs.symbolToIndices.has(e)),u=e=>{let t=[],i="var prod = 1.0;",o="var sum = 0.0;",u="sum += prod;",c=[],d=[],p=[],h=[],f=n.symbolToInfo.size===n.rhs.symbolToIndices.size;n.symbolToInfo.forEach((e,i)=>{if(n.rhs.symbolToIndices.has(i)){let o=n.rhs.symbolToIndices.get(i)?.[0];void 0!==o&&n.lhs.forEach((n,l)=>{if(e.inputIndices.includes(l)){let e=n.symbolToIndices.get(i);if(void 0===e)throw Error("Invalid symbol error");e.forEach(e=>{t.push(`${a[l].indicesSet(`input${l}Indices`,e,s.indicesGet("outputIndices",o))}`)})}})}else n.lhs.forEach((t,n)=>{if(e.inputIndices.includes(n)){let e=t.symbolToIndices.get(i);if(void 0===e)throw Error("Invalid symbol error");e.forEach(e=>{c.push(`${a[n].indicesSet(`input${n}Indices`,e,`${i}`)}`)}),h.push(`prod *= ${a[n].getByIndices(`input${n}Indices`)};`)}}),d.push(`for(var ${i}: u32 = 0; ${i} < uniforms.${n0(i)}; ${i}++) {`),p.push("}")});let g=f?[...t,`let sum = ${a.map((e,t)=>e.getByIndices(`input${t}Indices`)).join(" * ")};`]:[...t,o,...d,...c,i,...h,u,...p];return`
            ${e.registerUniforms(l.map(e=>({name:`${n0(e)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...a,s)}

            ${e.mainStart()}
            ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
            var outputIndices = ${s.offsetToIndices("global_idx")};
            ${a.map((e,t)=>`var input${t}Indices: ${a[t].type.indices};`).join(`
`)}
            ${g.join(`
`)};
            ${s.setByOffset("global_idx","sum")};
          }`};return{name:"Einsum",shaderCache:{hint:n.equation,inputDependencies:e.map(()=>"rank")},getRunData:()=>{let a=l.filter(e=>n.symbolToInfo.has(e)).map(e=>({type:12,data:n.symbolToInfo.get(e)?.dimValue||0}));a.push({type:12,data:o});let s=e.map((e,t)=>[...W(e)]).reduce((e,t)=>e.concat(t),a);return s.push(...W(i)),{outputs:[{dims:i,dataType:t}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:s}},getShaderSource:u}},r0=(e,t)=>{let n=new Lc(e.inputs,t.equation),i=n.outputDims,a=e.inputs.map((e,t)=>e.dims);e.compute(mE(a,e.inputs[0].dataType,n,i))},o0=e=>{let t=e.equation.replace(/\s+/g,"");return ce({equation:t})}}),u0=k(()=>{le(),ge(),ye(),gE=e=>{if(!e||2!==e.length)throw Error("Expand requires 2 input.");let t=e[0].dims,n=Array.from(e[1].getBigInt64Array(),Number),i=n.length<t.length?0:n.length-t.length,a=t.length<n.length?0:t.length-n.length;for(;i<n.length&&a<t.length;++i,++a)if(n[i]!==t[a]&&1!==n[i]&&1!==t[a])throw Error("Expand requires shape to be broadcastable to input")},a0=(e,t)=>{let n=e.length-t.length,i=[];for(let t=0;t<n;++t)i.push(e[t]);for(let a=0;a<t.length;++a)i.push(1===t[a]?e[a+n]:t[a]);return i},bE=(e,t)=>e.length>t.length?a0(e,t):a0(t,e),yE=e=>{let t=e[0].dims,n=bE(t,Array.from(e[1].getBigInt64Array(),Number)),i=e[0].dataType,a=9===i||1===C.size(t),o=9===i||t.length>0&&t[t.length-1]%4==0?4:1,s=a||n.length>0&&n[n.length-1]%4==0?4:1,l=Math.ceil(C.size(n)/s),u=e=>{let a=N("input",i,t.length,o),l=G("output",i,n.length,s),u;if(9===i){let e=(e,t,n="")=>`
          let outputIndices${t} = ${l.offsetToIndices(`outputOffset + ${t}u`)};
          let offset${t} = ${a.broadcastedIndicesToOffset(`outputIndices${t}`,l)};
          let index${t} = offset${t} / 4u;
          let component${t} = offset${t} % 4u;
          ${e}[${t}] = ${n}(${a.getByOffset(`index${t}`)}[component${t}]);
        `;u=`
        let outputOffset = global_idx * ${s};
        var data = vec4<u32>(0);
        ${e("data",0,"u32")}
        ${e("data",1,"u32")}
        ${e("data",2,"u32")}
        ${e("data",3,"u32")}
        ${l.setByOffset("global_idx","data")}
      }`}else u=`
        let outputIndices = ${l.offsetToIndices(`global_idx * ${s}`)};
        let inputOffset = ${a.broadcastedIndicesToOffset("outputIndices",l)};
        let data = ${l.type.value}(${a.getByOffset(`inputOffset / ${o}`)});
        ${l.setByOffset("global_idx","data")}
      }`;return`
    ${e.registerUniform("vec_size","u32").declareVariables(a,l)}
    ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
    ${u}`},c=[{type:12,data:l},...W(t,n)];return{name:"Expand",shaderCache:{hint:`${n.length};${o}${s}`,inputDependencies:["rank"]},getShaderSource:u,getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:c})}},s0=e=>{gE(e.inputs),e.compute(yE(e.inputs),{inputs:[0]})}}),c0=k(()=>{le(),ge(),ye(),Va(),_E=e=>{let t=e[0].dataType,n=C.size(e[0].dims),i=C.size(e[1].dims),a=i%4==0,o=e=>{let n=N("x",t,[1],4),i=N("bias",t,[1],4),o=G("y",t,[1],4),s=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],l=e=>`
      let bias${e}_offset: u32 = (global_idx * 4 + ${e}) % uniforms.bias_size;
      let bias${e} = ${i.getByOffset(`bias${e}_offset / 4`)}[bias${e}_offset % 4];`,u=a?`
      let bias = ${i.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${l(0)}${l(1)}${l(2)}${l(3)}
      let bias = ${n.type.value}(bias0, bias1, bias2, bias3);`;return`${e.registerUniforms(s).declareVariables(n,i,o)}

    ${Sc(it(t))}

    ${e.mainStart(Wr)}
      ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}

      let x = ${n.getByOffset("global_idx")};
      ${u}
      let x_in = x + bias;
      ${o.setByOffset("global_idx",$c("x_in"))}
    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${a}`,inputDependencies:["type","type"]},getShaderSource:o,getRunData:e=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],programUniforms:[{type:12,data:Math.ceil(n/4)},{type:12,data:i}],dispatchGroup:{x:Math.ceil(n/Wr/4)}})}},l0=e=>{e.inputs.length<2||0===C.size(e.inputs[1].dims)?iv(e):e.compute(_E(e.inputs))}}),f0=k(()=>{le(),ge(),Xe(),ye(),vE=e=>{if(!e||2!==e.length)throw Error("Gather requires 2 inputs.")},wE=(e,t)=>{let n=e[0].dims,i=e[1].dims,a=n.length,o=C.normalizeAxis(t.axis,a),s=n.slice(0);s.splice(o,1,...i);let l=n[o],u=9===e[0].dataType?4:1,c=Math.ceil(C.size(s)/u),d=[{type:12,data:c},{type:6,data:l},{type:12,data:o},...W(e[0].dims,e[1].dims,s)],p=t=>{let n=N("data",e[0].dataType,e[0].dims.length,u),l=N("inputIndices",e[1].dataType,e[1].dims.length),c=G("output",e[0].dataType,s.length,u),d=e=>{let t=i.length,u=`var indicesIndices${e}  = ${l.type.indices}(0);`;for(let n=0;n<t;n++)u+=`${t>1?`indicesIndices${e}[${n}]`:`indicesIndices${e}`} = ${s.length>1?`outputIndices${e}[uniforms.axis + ${n}]`:`outputIndices${e}`};`;u+=`
          var idx${e} = ${l.getByIndices(`indicesIndices${e}`)};
          if (idx${e} < 0) {
            idx${e} = idx${e} + uniforms.axisDimLimit;
          }
          var dataIndices${e} : ${n.type.indices};
        `;for(let n=0,i=0;n<a;n++)n===o?(u+=`${a>1?`dataIndices${e}[${n}]`:`dataIndices${e}`} = u32(idx${e});`,i+=t):(u+=`${a>1?`dataIndices${e}[${n}]`:`dataIndices${e}`} = ${s.length>1?`outputIndices${e}[${i}]`:`outputIndices${e}`};`,i++);return u},p;if(9===e[0].dataType){let e=(e,t,i="")=>`
          let outputIndices${t} = ${c.offsetToIndices(`outputOffset + ${t}u`)};
          ${d(t)};
          let offset${t} = ${n.indicesToOffset(`dataIndices${t}`)};
          let index${t} = offset${t} / 4u;
          let component${t} = offset${t} % 4u;
          ${e}[${t}] = ${i}(${n.getByOffset(`index${t}`)}[component${t}]);
        `;p=`
        let outputOffset = global_idx * ${u};
        var value = vec4<u32>(0);
        ${e("value",0,"u32")}
        ${e("value",1,"u32")}
        ${e("value",2,"u32")}
        ${e("value",3,"u32")}
        ${c.setByOffset("global_idx","value")}
      `}else p=`
      let outputIndices = ${c.offsetToIndices("global_idx")};
      ${d("")};
      let value = ${n.getByIndices("dataIndices")};
      ${c.setByOffset("global_idx","value")};
      `;return`
      ${t.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(n,l,c)}
      ${t.mainStart()}
        ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        ${p}
      }`};return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:s,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:d}),getShaderSource:p}},d0=e=>ce({axis:e.axis}),p0=(e,t)=>{vE(e.inputs),e.compute(wE(e.inputs,t))}}),g0=k(()=>{le(),ge(),ye(),xE=(e,t,n,i,a,o,s,l,u)=>{let c=[{type:12,data:o},{type:12,data:i},{type:12,data:a},{type:12,data:n},{type:12,data:s},{type:12,data:l},{type:12,data:u}],d=[o];c.push(...W(t.dims,d));let p=e=>{let i=[N("indices_data",t.dataType,t.dims.length),G("input_slice_offsets_data",12,1,1)],o=[{name:"output_size",type:"u32"},{name:"batch_dims",type:"u32"},{name:"input_dims",type:"u32",length:a.length},{name:"sizes_from_slice_dims_data",type:"u32",length:n.length},{name:"num_slices_per_batch",type:"u32"},{name:"input_batch_stride",type:"u32"},{name:"num_slice_dims",type:"u32"}];return`
  ${e.registerUniforms(o).declareVariables(...i)}
  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let batch_idx = global_idx / uniforms.num_slices_per_batch;
    let base_offset = batch_idx * uniforms.input_batch_stride;

    let slice_indices_base_offset = global_idx * uniforms.num_slice_dims;
    var relative_slice_offset = 0;
    for (var dim_idx = 0u; dim_idx < uniforms.num_slice_dims; dim_idx ++) {
      var index = i32(indices_data[dim_idx + slice_indices_base_offset].x);
      let input_dim_idx = uniforms.batch_dims + dim_idx;
      if (index < 0) {
        ${1===a.length?"index += i32(uniforms.input_dims);":"index += i32(uniforms.input_dims[input_dim_idx]);"}
      }
      ${1===n.length?"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data);":"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data[dim_idx]);"}
    }

    input_slice_offsets_data[global_idx] =  base_offset + u32(relative_slice_offset);
  }`};return e.compute({name:"computeSliceOffsets",shaderCache:{hint:`${a.length}_${n.length}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:d,dataType:e.inputs[1].dataType}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:c}),getShaderSource:p},{inputs:[t],outputs:[-1]})[0]},h0=(e,t)=>{let n=e.inputs,i=n[0].dims,a=n[0].dataType,o=n[1].dims,s=o[o.length-1],l=C.sizeToDimension(o,o.length-1),u=C.sizeFromDimension(i,t.batchDims+s),c=C.sizeToDimension(i,t.batchDims),d=C.sizeFromDimension(i,t.batchDims),p=l/c,h=Array(s),f=u;for(let e=0;e<s;++e)h[s-1-e]=f,f*=i[t.batchDims+s-1-e];let g=xE(e,n[1],h,t.batchDims,i,l,p,d,s),m=t.batchDims+s;if(m>i.length)throw Error("last dimension of indices must not be larger than rank of input tensor");let y=o.slice(0,-1).concat(i.slice(m)),b=C.size(y),v=[{type:12,data:b},{type:12,data:u},...W(n[0].dims,g.dims,y)],x=e=>{let t=N("data",n[0].dataType,n[0].dims.length),i=N("slice_offsets",12,g.dims.length),a=G("output",n[0].dataType,y.length);return`
          ${e.registerUniform("output_size","u32").registerUniform("slice_size","u32").declareVariables(t,i,a)}
            ${e.mainStart()}
            ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let slice_offset = slice_offsets[global_idx / uniforms.slice_size];
          output[global_idx] = data[u32(slice_offset) + global_idx % uniforms.slice_size];
        }`};e.compute({name:"GatherND",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:y,dataType:a}],dispatchGroup:{x:Math.ceil(b/64)},programUniforms:v}),getShaderSource:x},{inputs:[n[0],g]})},m0=e=>({batchDims:e.batch_dims,cacheKey:""})}),_0=k(()=>{le(),ge(),Xe(),ye(),TE=(e,t)=>{if(e.length<3||e.length>4)throw Error("GatherBlockQuantized requires 3 or 4 inputs.");let n=C.normalizeAxis(t.quantizeAxis,e[0].dims.length),i=t.blockSize,a=e[0],o=e[2],s=4===e.length?e[3]:void 0;if(o.dims.length!==a.dims.length||!a.dims.map((e,t)=>t===n?Math.ceil(e/i)===o.dims[t]:e===o.dims[t]).reduce((e,t)=>e&&t,!0))throw Error("Scales must have the same rank as the input tensor and the dims should match except on gatherAxis.");if(s){if(s.dataType!==a.dataType)throw Error("Zero point must have the same data type as the input tensor.");if(s.dims.length!==o.dims.length||!s.dims.map((e,t)=>e===o.dims[t]).reduce((e,t)=>e&&t,!0))throw Error("Zero point must have the same rank as the input tensor and the dims should match except on quantizeAxis.")}},IE=(e,t)=>{let n=e[0].dims,i=e[1].dims,a=n.length,o=C.normalizeAxis(t.gatherAxis,a),s=C.normalizeAxis(t.quantizeAxis,a),l=n.slice(0);l.splice(o,1,...i);let u=C.size(l),c=e[2].dataType,d=22===e[0].dataType,p=[{type:12,data:u},{type:12,data:s},{type:12,data:o},{type:12,data:t.blockSize},...W(...e.map((e,t)=>e.dims),l)],h=t=>{let a=N("data",e[0].dataType,e[0].dims.length),s=N("inputIndices",e[1].dataType,e[1].dims.length),u=N("scales",e[2].dataType,e[2].dims.length),p=e.length>3?N("zeroPoint",e[3].dataType,e[3].dims.length):void 0,h=G("output",c,l.length),f=[a,s,u];p&&f.push(p);let g=[{name:"output_size",type:"u32"},{name:"quantize_axis",type:"u32"},{name:"gather_axis",type:"u32"},{name:"block_size",type:"u32"}];return`
        ${t.registerUniforms(g).declareVariables(...f,h)}
        ${t.mainStart()}
        let output_indices = ${h.offsetToIndices("global_idx")};
        var indices_indices = ${s.type.indices}(0);
        ${i.length>1?`
          for (var i: u32 = 0; i < ${i.length}; i++) {
            let index = ${h.indicesGet("output_indices","uniforms.gather_axis + i")};
            ${s.indicesSet("indices_indices","i","index")};
          }`:`indices_indices = ${h.indicesGet("output_indices","uniforms.gather_axis")};`};
        var data_indices = ${a.type.indices}(0);
        for (var i: u32 = 0; i < uniforms.gather_axis; i++) {
          let index = ${h.indicesGet("output_indices","i")};
          ${a.indicesSet("data_indices","i","index")};
        }
        var index_from_indices = ${s.getByIndices("indices_indices")};
        if (index_from_indices < 0) {
          index_from_indices += ${n[o]};
        }
        ${a.indicesSet("data_indices","uniforms.gather_axis","u32(index_from_indices)")};
        for (var i = uniforms.gather_axis + 1; i < ${l.length}; i++) {
          let index = ${h.indicesGet("output_indices",`i + ${i.length} - 1`)};
          ${a.indicesSet("data_indices","i","index")};
        }
        let data_offset = ${a.indicesToOffset("data_indices")};
        let data_index = data_offset % 8;
        // Convert 4-bit packed data to 8-bit packed data.
        let packed_4bit_quantized_data = ${a.getByOffset("data_offset / 8")};
        let packed_8bit_quantized_data = (packed_4bit_quantized_data >> (4 * (data_index % 2))) & 0x0f0f0f0f;
        let quantized_data_vec = ${d?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_quantized_data));
        let quantized_data = quantized_data_vec[data_index / 2];
        var scale_indices = data_indices;
        let quantize_axis_index = ${u.indicesGet("data_indices","uniforms.quantize_axis")} / uniforms.block_size;
        ${u.indicesSet("scale_indices","uniforms.quantize_axis","quantize_axis_index")};
        var scale = ${u.getByIndices("scale_indices")};
        ${p?`
              let zero_point_indices = scale_indices;
              let zero_point_offset = ${p.indicesToOffset("zero_point_indices")};
              let zero_point_index = zero_point_offset % 8;
              let packed_4bit_zero_points = ${p.getByOffset("zero_point_offset / 8")};
              let packed_8bit_zero_points = (packed_4bit_zero_points >> (4 * (zero_point_index % 2))) & 0x0f0f0f0f;
              let zero_point_vec = ${d?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_zero_points));
              let zero_point = zero_point_vec[zero_point_index / 2];`:"var zero_point = 0"};
        let dequantized_data = ${it(c)}(quantized_data - zero_point) * scale;
        ${h.setByOffset("global_idx","dequantized_data")};
    }`};return{name:"GatherBlockQuantized",shaderCache:{hint:`${t.cacheKey};${e.filter((e,t)=>1!==t).map(e=>e.dims.join("_")).join(";")}`,inputDependencies:Array.from({length:e.length},(e,t)=>"rank")},getRunData:()=>({outputs:[{dims:l,dataType:c}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:p}),getShaderSource:h}},b0=(e,t)=>{TE(e.inputs,t),e.compute(IE(e.inputs,t))},y0=e=>ce({blockSize:e.blockSize,gatherAxis:e.gatherAxis,quantizeAxis:e.quantizeAxis})}),x0=k(()=>{le(),ge(),Xe(),ye(),SE=e=>{if(!e||2!==e.length)throw Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw Error(`GatherElements requires that the data input and
                     indices input tensors be of same rank.`)},$E=(e,t)=>{let n=e[0].dims,i=e[0].dataType,a=n.length,o=e[1].dims,s=e[1].dataType,l=C.normalizeAxis(t.axis,a),u=n[l],c=o.slice(0),d=C.size(c),p=N("input",i,a),h=N("indicesInput",s,o.length),f=G("output",i,c.length),g=[{type:12,data:d},{type:6,data:u},{type:12,data:l}];return g.push(...W(n,o,c)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:c,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:g}),getShaderSource:e=>`
      ${e.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(p,h,f)}
      ${e.mainStart()}
      ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

      let outputIndices = ${f.offsetToIndices("global_idx")};

      var idx = ${h.getByOffset("global_idx")};
      if (idx < 0) {
        idx = idx + uniforms.axisDimLimit;
      }
      var inputIndices = ${p.type.indices}(outputIndices);
      ${p.indicesSet("inputIndices","uniforms.axis","u32(idx)")};
      let value = ${p.getByIndices("inputIndices")};

      ${f.setByOffset("global_idx","value")};
  }`}},v0=e=>ce({axis:e.axis}),w0=(e,t)=>{SE(e.inputs),e.compute($E(e.inputs,t))}}),S0=k(()=>{le(),ge(),ye(),AE=e=>{if(!e)throw Error("Input is missing");if(e.length<2||e.length>3)throw Error("Invaid input number.");if(3===e.length&&e[2].dims.length>2)throw Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||3===e.length&&e[0].dataType!==e[2].dataType)throw Error("Input types are mismatched")},OE=(e,t)=>{let n=e[0].dims.slice(),i=e[1].dims.slice(),[a,o,s]=Oa.getShapeOfGemmResult(n,t.transA,i,t.transB,3===e.length?e[2].dims:void 0),l=[a,o];if(!l)throw Error("Can't use gemm on the given tensors");let u=16,c=Math.ceil(o/16),d=Math.ceil(a/16),p=!0,h=C.size(l),f=[{type:12,data:p?c:h},{type:12,data:a},{type:12,data:o},{type:12,data:s},{type:1,data:t.alpha},{type:1,data:t.beta}],g=["type","type"];3===e.length&&(f.push(...W(e[2].dims)),g.push("rank")),f.push(...W(l));let m=n=>{let i="";t.transA&&t.transB?i="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?i="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?i="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":t.transA||t.transB||(i="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let a=1===t.alpha?"":"value *= uniforms.alpha;",o=N("a",e[0].dataType,e[0].dims),s=N("b",e[1].dataType,e[1].dims),u=o.type.value,c=null,d=[o,s];3===e.length&&(c=N("c",e[2].dataType,e[2].dims.length),d.push(c));let p=G("output",e[0].dataType,l.length);d.push(p);let h=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`
  ${n.registerUniforms(h).declareVariables(...d)}

  ${n.mainStart()}
    ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let m = global_idx / uniforms.N;
    let n = global_idx % uniforms.N;

    var value = ${u}(0);
    for (var k: u32 = 0u; k < uniforms.K; k++) {
      ${i}
    }

    ${a}
    ${null!=c?`let cOffset = ${c.broadcastedIndicesToOffset("vec2(m, n)",p)}; value += ${u}(uniforms.beta) * ${c.getByOffset("cOffset")};`:""}
    output[global_idx] = value;
  }`},y=n=>{let i=N("a",e[0].dataType,e[0].dims),a=N("b",e[1].dataType,e[1].dims),o=null,s=[i,a];3===e.length&&(o=N("c",e[2].dataType,e[2].dims.length),s.push(o));let c=G("output",e[0].dataType,l.length);s.push(c);let d=[{name:"num_tile_n",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}],p="",h="";t.transA&&t.transB?(h=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${i.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${a.type.value}(0);
      }
      `,p="value += tile_a[k][local_id.y] * tile_b[local_id.x][k];"):t.transA&&!t.transB?(h=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${i.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${a.type.value}(0);
      }
      `,p="value += tile_a[k][local_id.y] * tile_b[k][local_id.x];"):!t.transA&&t.transB?(h=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${i.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${a.type.value}(0);
      }
      `,p="value += tile_a[local_id.y][k] * tile_b[local_id.x][k];"):t.transA||t.transB||(h=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${i.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${a.type.value}(0);
      }
      `,p="value += tile_a[local_id.y][k] * tile_b[k][local_id.x];");let f=1===t.alpha?"":"value *= uniforms.alpha;";return`
  ${n.registerUniforms(d).declareVariables(...s)}
  var<workgroup> tile_a: array<array<${i.type.storage}, ${u}>, ${u}>;
  var<workgroup> tile_b: array<array<${a.type.storage}, ${u}>, ${u}>;
  ${n.mainStart([u,u,1])}
    let tile_col_start = (workgroup_index % uniforms.num_tile_n) * ${u};
    let tile_row_start = (workgroup_index / uniforms.num_tile_n) * ${u};
    let num_tiles = (uniforms.K - 1) / ${u} + 1;
    var k_start = 0u;
    var value = ${c.type.value}(0);
    for (var t: u32 = 0u; t < num_tiles; t++) {
      ${h}
      k_start = k_start + ${u};
      workgroupBarrier();

      for (var k: u32 = 0u; k < ${u}; k++) {
        ${p}
      }
      workgroupBarrier();
    }

    ${f}
    let m = tile_row_start + local_id.y;
    let n = tile_col_start + local_id.x;
    ${null!=o?`let cOffset = ${o.broadcastedIndicesToOffset("vec2(m, n)",c)}; value += ${c.type.value}(uniforms.beta) * ${o.getByOffset("cOffset")};`:""}
    if (m < uniforms.M && n < uniforms.N) {
      output[m * uniforms.N + n] = value;
    }
  }`};return p?{name:"GemmShared",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:l,dataType:e[0].dataType}],dispatchGroup:{x:c*d},programUniforms:f}),getShaderSource:y}:{name:"Gemm",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:l,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:f}),getShaderSource:m}},T0=e=>({transA:e.transA,transB:e.transB,alpha:e.alpha,beta:e.beta,cacheKey:`${e.transA};${e.transB};${1===e.alpha}`}),I0=(e,t)=>{AE(e.inputs),e.compute(OE(e.inputs,t))}}),O0=k(()=>{le(),ge(),Xe(),ye(),[Qn,xr,fo,ho]=[0,1,2,3],PE=e=>{if(4!==e[0].dims.length)throw Error("only 4-D tensor is supported.");if(e[0].dims.length!==e[1].dims.length)throw Error("input dimensions must be equal to grid dimensions");if(e[0].dims.length-2!==e[1].dims[e[1].dims.length-1])throw Error(`last dimension of grid must be equal to ${e[0].dims.length-2}`);if(e[0].dims[0]!==e[1].dims[0])throw Error("grid batch size must match input batch size")},EE=`
  fn gs_get_cubic_coeffs(x: f32) -> vec4<f32> {
    let cubic_alpha = -0.75f;
    let x_abs = abs(x);
    var coeffs: vec4<f32>;
    coeffs[0] = (((cubic_alpha * (x_abs + 1) - 5 * cubic_alpha) * (x_abs + 1) + 8 * cubic_alpha) * (x_abs + 1) - 4 * cubic_alpha);
    coeffs[1] = (((cubic_alpha + 2) * x_abs - (cubic_alpha + 3)) * x_abs * x_abs + 1);
    coeffs[2] = (((cubic_alpha + 2) * (1 - x_abs) - (cubic_alpha + 3)) * (1 - x_abs) * (1 - x_abs) + 1);
    coeffs[3] = (((cubic_alpha * (2 - x_abs) - 5 * cubic_alpha) * (2 - x_abs) + 8 * cubic_alpha) * (2 - x_abs) - 4 * cubic_alpha);
    return coeffs;
  }
`,CE=e=>`
  fn gs_bicubic_interpolate(p: mat4x4<${e}>, x: f32, y: f32) -> ${e} {
    var v: vec4<f32>;
    var coeffs = gs_get_cubic_coeffs(x);
    for (var i = 0; i < 4; i++) {
      v[i] = coeffs[0] * p[i][0] + coeffs[1] * p[i][1] + coeffs[2] * p[i][2] + coeffs[3] * p[i][3];
    }
    coeffs = gs_get_cubic_coeffs(y);
    let pixel = ${e}(coeffs[0] * v[0] + coeffs[1] * v[1] + coeffs[2] * v[2] + coeffs[3] * v[3]);
    return pixel;
  }
`,DE=e=>`
  fn gs_denormalize(n: f32, length: i32) -> f32 {
    ${0===e.alignCorners?`
    // alignCorners: false => [-1, 1] to [-0.5, length - 0.5]
    return ((n + 1.0) * f32(length) - 1.0) / 2.0;
    `:`
    // alignCorners: true => [-1, 1] to [0, length - 1]
    return (n + 1.0) / 2.0 * (f32(length - 1));
    `}
  }
`,kE=e=>`
  ${"reflection"===e.paddingMode?`
      fn gs_reflect(x: i32, x_min: f32, x_max: f32) -> u32 {
        var dx = 0.0;
        var fx = f32(x);
        let range = x_max - x_min;
        if (fx < x_min) {
          dx = x_min - fx;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_min + r;
          } else {
            fx = x_max - r;
          }
        } else if (fx > x_max) {
          dx = fx - x_max;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_max - r;
          } else {
            fx = x_min + r;
          }
        }
        return u32(fx);
      }`:""}
`,NE=(e,t,n)=>`
  fn pixel_at_grid(r: i32, c: i32, H: i32, W: i32, batch: u32, channel: u32, border: vec4<f32>) -> ${t} {
     var pixel = ${t}(0);
     var indices = vec4<u32>(0);
     indices[${Qn}] = batch;
     indices[${xr}] = channel;`+(()=>{switch(n.paddingMode){case"zeros":return`
          if (r >= 0 && r < H && c >=0 && c < W) {
            indices[${fo}] = u32(r);
            indices[${ho}] = u32(c);
          } else {
            return ${t}(0);
          }
        `;case"border":return`
          indices[${fo}] = u32(clamp(r, 0, H - 1));
          indices[${ho}] = u32(clamp(c, 0, W - 1));
        `;case"reflection":return`
          indices[${fo}] = gs_reflect(r, border[1], border[3]);
          indices[${ho}] = gs_reflect(c, border[0], border[2]);
        `;default:throw Error(`padding mode ${n.paddingMode} is not supported`)}})()+`
    return ${e.getByIndices("indices")};
  }
`,LE=(e,t,n)=>(()=>{switch(n.mode){case"nearest":return`
          let result = pixel_at_grid(i32(round(y)), i32(round(x)), H_in, W_in, indices[${Qn}], indices[${xr}], border);
        `;case"bilinear":return`
          let x1 = i32(floor(x));
          let y1 = i32(floor(y));
          let x2 = x1 + 1;
          let y2 = y1 + 1;

          let p11 = pixel_at_grid(y1, x1, H_in, W_in, indices[${Qn}], indices[${xr}], border);
          let p12 = pixel_at_grid(y1, x2, H_in, W_in, indices[${Qn}], indices[${xr}], border);
          let p21 = pixel_at_grid(y2, x1, H_in, W_in, indices[${Qn}], indices[${xr}], border);
          let p22 = pixel_at_grid(y2, x2, H_in, W_in, indices[${Qn}], indices[${xr}], border);

          let dx2 = ${t}(f32(x2) - x);
          let dx1 = ${t}(x - f32(x1));
          let dy2 = ${t}(f32(y2) - y);
          let dy1 = ${t}(y - f32(y1));
          let result = dy2 * (dx2 * p11 + dx1 * p12) + dy1 * (dx2 * p21 + dx1 * p22);
        `;case"bicubic":return`
          let x0 = i32(floor(x)) - 1;
          let y0 = i32(floor(y)) - 1;
          var p: mat4x4<${t}>;
          for (var h = 0; h < 4; h++) {
            for (var w = 0; w < 4; w++) {
              p[h][w] = pixel_at_grid(h + y0, w + x0, H_in, W_in, indices[${Qn}], indices[${xr}], border);
            }
          }

          let dx = x - f32(x0 + 1);
          let dy = y - f32(y0 + 1);
          let result = gs_bicubic_interpolate(p, dx, dy);
        `;default:throw Error(`mode ${n.mode} is not supported`)}})()+`${e.setByOffset("global_idx","result")}`,RE=(e,t)=>{let n=N("x",e[0].dataType,e[0].dims.length),i=[e[1].dims[0],e[1].dims[1],e[1].dims[2]],a=N("grid",e[1].dataType,i.length,2),o=[e[0].dims[0],e[0].dims[1],e[1].dims[1],e[1].dims[2]];"NHWC"===t.format&&(o=[e[0].dims[0],e[1].dims[1],e[1].dims[2],e[0].dims[3]],[Qn,xr,fo,ho]=[0,3,1,2]);let s=G("output",e[0].dataType,o.length),l=n.type.value,u=[{type:12,data:C.size(o)},...W(e[0].dims,i,o)],c=e=>`
  ${e.registerUniform("output_size","u32").declareVariables(n,a,s)}
  ${EE}
  ${CE(l)}
  ${DE(t)}
  ${kE(t)}
  ${NE(n,l,t)}

  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let H_in = i32(uniforms.x_shape[${fo}]);
      let W_in = i32(uniforms.x_shape[${ho}]);

      ${0===t.alignCorners?`
      let x_min = -0.5;
      let x_max = f32(W_in) - 0.5;
      let y_min = -0.5;
      let y_max = f32(H_in) - 0.5;
      `:`
      let x_min = 0.0;
      let x_max = f32(W_in) - 1.0;
      let y_min = 0.0;
      let y_max = f32(H_in) - 1.0;
      `};
      let border = vec4<f32>(x_min, y_min, x_max, y_max);

      let indices = ${s.offsetToIndices("global_idx")};
      var grid_indices = vec3<u32>(indices[${Qn}], indices[${fo}], indices[${ho}]);
      let nxy = ${a.getByIndices("grid_indices")};
      var x = gs_denormalize(f32(nxy[0]), W_in);
      var y = gs_denormalize(f32(nxy[1]), H_in);

      ${LE(s,l,t)}
  }`;return{name:"GridSample",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:["type","type"]},getRunData:e=>{let t=C.size(o);return{outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(t/64)},programUniforms:u}},getShaderSource:c}},$0=(e,t)=>{PE(e.inputs),e.compute(RE(e.inputs,t))},A0=e=>ce({alignCorners:e.align_corners,mode:e.mode,paddingMode:e.padding_mode,format:e.format})}),Rc=k(()=>{le(),ge(),Xe(),Na(),Ba(),ye(),Yn(),Tt=(e,t)=>e.length>t&&e[t].dims.length>0?e[t]:void 0,BE=(e,t)=>{let n,i=e[0],a=Tt(e,1),o=Tt(e,2),s=Tt(e,3),l=Tt(e,4),u=Tt(e,5),c=Tt(e,6),d=Tt(e,7);if(3!==i.dims.length&&5!==i.dims.length)throw Error("Input query is expected to have 3 or 5 dimensions");let p=i.dims[0],h=i.dims[1],f=3===i.dims.length?i.dims[2]:t.numHeads*i.dims[4],g=h,m=0,y=0,b=Math.floor(f/t.numHeads);if(c&&d&&C.size(c.dims)&&C.size(d.dims)){if(4!==c.dims.length)throw Error('Input "past_key" is expected to have 4 dimensions');if(c.dims[0]!==p||c.dims[1]!==t.numHeads||c.dims[3]!==b)throw Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(d.dims[0]!==p||d.dims[1]!==t.numHeads||d.dims[3]!==b)throw Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if(c.dims[2]!==d.dims[2])throw Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(4!==d.dims.length)throw Error('Input "past_value" is expected to have 4 dimensions');m=c.dims[2],y=c.dims[2]}else if(c&&C.size(c.dims)||d&&C.size(d.dims))throw Error('Input "past_key" and "past_value" shall be both present or both absent');if(a&&C.size(a.dims)>0){if(3!==i.dims.length)throw Error('Input "query" is expected to have 3 dimensions when key is given');if(a.dims.length<3||a.dims.length>5)throw Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(i.dims[0]!==a.dims[0])throw Error('Input "query" and "key" shall have same dim 0 (batch size)');if(3===a.dims.length){if(a.dims[2]!==i.dims[2])throw Error('Input "query" and "key" shall have same dim 2 (hidden_size)');n=2,g=a.dims[1]}else if(5===a.dims.length){if(a.dims[2]!==t.numHeads||2!==a.dims[3]||a.dims[4]!==b)throw Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(o)throw Error('Expect "value" be none when "key" has packed kv format.');n=5,g=a.dims[1]}else{if(a.dims[1]!==t.numHeads||a.dims[3]!==b)throw Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');n=0,g=a.dims[2]}}else{if(5!==i.dims.length)throw Error('Input "query" is expected to have 5 dimensions when key is empty');if(i.dims[2]!==t.numHeads||3!==i.dims[3])throw Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');n=3}if(s&&C.size(s.dims)>0){if(1!==s.dims.length)throw Error('Input "bias" is expected to have 1 dimension');if(a&&5===a.dims.length&&2===a.dims[3])throw Error("bias is not allowed for packed kv.")}let v=m+g,x=0;if(l&&C.size(l.dims)>0){x=8;let e=l.dims;throw 1===e.length?e[0]===p?x=1:e[0]===3*p+2&&(x=3):2===e.length&&e[0]===p&&e[1]===v&&(x=5),8===x?Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, total_sequence_length)'):Error("Mask not supported")}let w=!1,_=f;if(o&&C.size(o.dims)>0){if(3!==o.dims.length&&4!==o.dims.length)throw Error('Input "value" is expected to have 3 or 4 dimensions');if(i.dims[0]!==o.dims[0])throw Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(3===o.dims.length){if(g!==o.dims[1])throw Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');_=o.dims[2]}else{if(g!==o.dims[2])throw Error('Input "key" and "value" shall have the same dim 2 (kv_sequence_length)');_=o.dims[1]*o.dims[3],w=!0}}let S=!1;if(l&&C.size(l.dims)>0)throw Error("Key padding mask is not supported");if(u&&C.size(u.dims)>0){if(4!==u.dims.length)throw Error('Input "attention_bias" is expected to have 4 dimensions');if(u.dims[0]!==p||u.dims[1]!==t.numHeads||u.dims[2]!==h||u.dims[3]!==v)throw Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:p,sequenceLength:h,pastSequenceLength:m,kvSequenceLength:g,totalSequenceLength:v,maxSequenceLength:y,inputHiddenSize:0,hiddenSize:f,vHiddenSize:_,headSize:b,vHeadSize:Math.floor(_/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:x,scale:t.scale,broadcastResPosBias:S,passPastInKv:w,qkvFormat:n}},E0=e=>ce({...e}),P0=ce({perm:[0,2,1,3]}),FE=(e,t,n,i,a,o,s)=>{let l=[i,a,o],u=C.size(l),c=[{type:12,data:u},{type:12,data:s},{type:12,data:o}],d=e=>{let i=G("qkv_with_bias",t.dataType,l),a=N("qkv",t.dataType,l),o=N("bias",n.dataType,l),s=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`
  ${e.registerUniforms(s).declareVariables(a,o,i)}
  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;

    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];
  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:l,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:c}),getShaderSource:d},{inputs:[t,n],outputs:[-1]})[0]},qo=(e,t,n,i,a,o,s,l)=>{let u=o;if(!(s&&C.size(s.dims)>0))return 3===o.dims.length&&(u=o.reshape([t,i,n,a])),1===n||1===i?u:e.compute(at(u,P0.perm),{inputs:[u],outputs:[-1]})[0];if(1===i)throw Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return u=(u=FE(e,o,s,t,i,n*a,l)).reshape([t,i,n,a]),1===n||1===i?u:e.compute(at(u,P0.perm),{inputs:[u],outputs:[-1]})[0]},C0=(e,t)=>{let n=BE(e.inputs,t),i=e.inputs[0],a=Tt(e.inputs,1),o=Tt(e.inputs,2),s=Tt(e.inputs,3),l=Tt(e.inputs,4),u=Tt(e.inputs,5),c=Tt(e.inputs,6),d=Tt(e.inputs,7);if(5===i.dims.length)throw Error("Packed QKV is not implemented");if(a?.dims.length===5)throw Error("Packed KV is not implemented");let p=a&&o&&4===a.dims.length&&4===o.dims.length,h=qo(e,n.batchSize,n.numHeads,n.sequenceLength,n.headSize,i,s,0);if(p)return po(e,h,a,o,l,void 0,c,d,u,n);if(!a||!o)throw Error("key and value must be provided");let f=qo(e,n.batchSize,n.numHeads,n.kvSequenceLength,n.headSize,a,s,n.hiddenSize),g=qo(e,n.batchSize,n.numHeads,n.kvSequenceLength,n.vHeadSize,o,s,2*n.hiddenSize);po(e,h,f,g,l,void 0,c,d,u,n)}}),Mc=k(()=>{le(),ge(),Xe(),ye(),VE=e=>{if(!e||e.length<1)throw Error("too few inputs")},GE=(e,t)=>{let n=[],i=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(e=>n.push(Number(e))),i=n.length),ce({numOutputs:i,axis:t.axis,splitSizes:n})},UE=e=>`
fn calculateOutputIndex(index: u32) -> u32 {
    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {
    if (index < ${Q("uniforms.size_in_split_axis","i",e)}) {
        return i;
    }
    }
    return ${e}u;
}`,WE=e=>{let t=e.length,n=[];for(let i=0;i<t;++i){let a=e[i].setByIndices("indices","input[global_idx]");1===t?n.push(a):0===i?n.push(`if (output_number == ${i}u) { ${a} }`):i===t-1?n.push(`else { ${a} }`):n.push(`else if (output_number == ${i}) { ${a} }`)}return`
      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {
        ${n.join(`
`)}
      }`},zc=(e,t)=>{let n=e[0].dims,i=C.size(n),a=e[0].dataType,o=C.normalizeAxis(t.axis,n.length),s=Array(t.numOutputs),l=N("input",a,n.length),u=Array(t.numOutputs),c=[],d=[],p=0,h=[{type:12,data:i}];for(let i=0;i<t.numOutputs;i++){p+=t.splitSizes[i],u[i]=p;let l=n.slice();l[o]=t.splitSizes[i],d.push(l),s[i]=G(`output${i}`,a,l.length),c.push({dims:d[i],dataType:e[0].dataType})}h.push({type:12,data:u},...W(n,...d));let f=e=>`
  ${e.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",u.length).declareVariables(l,...s)}
  ${UE(u.length)}
  ${WE(s)}

  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}

    var indices = ${l.offsetToIndices("global_idx")};
    var index = ${l.indicesGet("indices",o)};
    let output_number = calculateOutputIndex(index);
    if (output_number != 0) {
      index -= ${Q("uniforms.size_in_split_axis","output_number - 1u",u.length)};
      ${l.indicesSet("indices",o,"index")};
    }
    writeBufferData(output_number, indices, global_idx);
  }`;return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:f,getRunData:()=>({outputs:c,dispatchGroup:{x:Math.ceil(i/64)},programUniforms:h})}},D0=(e,t)=>{VE(e.inputs);let n=1===e.inputs.length?t:GE(e.inputs,t);e.compute(zc(e.inputs,n),{inputs:[0]})},k0=e=>{let t=e.axis,n=e.splitSizes,i=e.numOutputs<0?n.length:e.numOutputs;if(i!==n.length)throw Error("numOutputs and splitSizes length must be equal");return ce({axis:t,numOutputs:i,splitSizes:n})}}),Bc=k(()=>{le(),ge(),Xe(),ye(),HE=(e,t)=>{let[n,i,a,o]=e,{numHeads:s,rotaryEmbeddingDim:l}=t;if(3!==n.dims.length&&4!==n.dims.length)throw Error(`Input 'x' is expected to have 3 or 4 dimensions, got ${n.dims.length}`);if(!C.areEqual(i.dims,[])&&!C.areEqual(i.dims,[1])&&2!==i.dims.length)throw Error(`Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ${i.dims.length}`);if(2!==a.dims.length)throw Error(`Input 'cos_cache' is expected to have 2 dimensions, got ${a.dims.length}`);if(2!==o.dims.length)throw Error(`Input 'sin_cache' is expected to have 2 dimensions, got ${o.dims.length}`);if(!C.areEqual(a.dims,o.dims))throw Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if(l>0&&0===s)throw Error("num_heads must be provided if rotary_embedding_dim is specified");let u=n.dims[0],c=n.dims[n.dims.length-2],d=a.dims[0],p=C.sizeFromDimension(n.dims,1)/c,h=0===l?2*a.dims[1]:p/s;if(l>h)throw Error("rotary_embedding_dim must be less than or equal to head_size");if(2===i.dims.length){if(u!==i.dims[0])throw Error(`Input 'position_ids' dimension 0 should be of size batch_size, got ${i.dims[0]}`);if(c!==i.dims[1])throw Error(`Input 'position_ids' dimension 1 should be of size sequence_length, got ${i.dims[1]}`)}if(h/2!==a.dims[1]&&l/2!==a.dims[1])throw Error(`Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${a.dims[1]}`);if(c>d)throw Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},Xa=(e,t)=>{let{interleaved:n,numHeads:i,rotaryEmbeddingDim:a,scale:o}=t,s=e[0].dims[0],l=C.sizeFromDimension(e[0].dims,1),u=e[0].dims[e[0].dims.length-2],c=l/u,d=e[2].dims[1],p=0===a?2*d:c/i,h=[s,u,c/p,p-d],f=C.computeStrides(h),g=[{type:1,data:o},{type:12,data:h},{type:12,data:f},...3===e[0].dims.length?Array({type:12,data:[l,c,p,1]}):[],...4===e[0].dims.length?Array({type:12,data:[l,p,u*p,1]}):[],...W(e[0].dims,e[1].dims,e[2].dims,e[3].dims,e[0].dims)],m=t=>{let i=N("input",e[0].dataType,e[0].dims.length),a=N("position_ids",e[1].dataType,e[1].dims.length),o=N("cos_cache",e[2].dataType,e[2].dims.length),s=N("sin_cache",e[3].dataType,e[3].dims.length),l=G("output",e[0].dataType,e[0].dims.length);return t.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:h.length},{name:"global_strides",type:"u32",length:f.length},{name:"input_output_strides",type:"u32",length:f.length}]),`
        ${t.declareVariables(i,a,o,s,l)}

        ${t.mainStart(Wr)}
          let half_rotary_emb_dim = uniforms.${o.name}_shape[1];
          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;
          let size = uniforms.global_shape[0] * uniforms.global_strides[0];
          ${t.guardAgainstOutOfBoundsWorkgroupSizes("size")}

          if (bsnh[3] < half_rotary_emb_dim) {
            let position_ids_idx =
                ${a.broadcastedIndicesToOffset("bsnh.xy",G("",a.type.tensor,2))};
            let position_id =
                u32(${a.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);
            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${n});
            let j = i + select(half_rotary_emb_dim, 1, ${n});
            let re = ${i.getByOffset("i")} * ${o.get("position_id","bsnh[3]")} -
                ${i.getByOffset("j")} * ${s.get("position_id","bsnh[3]")};
            ${l.setByOffset("i","re")}
            let im = ${i.getByOffset("i")} * ${s.get("position_id","bsnh[3]")} +
                ${i.getByOffset("j")} * ${o.get("position_id","bsnh[3]")};
            ${l.setByOffset("j","im")}
          } else {
            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;
            ${l.setByOffset("k",i.getByOffset("k"))}
          }
        }`};return{name:"RotaryEmbedding",shaderCache:{hint:ce({interleaved:n}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:m,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(C.size(h)/Wr)},programUniforms:g})}},N0=(e,t)=>{HE(e.inputs,t),e.compute(Xa(e.inputs,t))}}),z0=k(()=>{Xe(),le(),Ba(),Rc(),Mc(),Yn(),Bc(),ye(),jE=(e,t)=>{if(t.doRotary&&e.length<=7)throw Error("cos_cache and sin_cache inputs are required if do_rotary is specified");let n=e[0],i=e[1],a=e[2],o=e[3],s=e[4];if(0!==t.doRotary&&e.length<=7)throw Error("cos_cast and sin_cache are expected if do_rotary attribute is non-zero");if(-1!==t.localWindowSize)throw Error("Local attention is not supported");if(0!==t.softcap)throw Error("Softcap is not supported");if(0!==t.rotaryInterleaved)throw Error("Rotary interleaved is not supported");if(t.smoothSoftmax)throw Error("Smooth softmax is not supported");if(3!==n.dims.length&&5!==n.dims.length)throw Error("Input query is expected to have 3 or 5 dimensions");let l=!1,u=n.dims[0],c=n.dims[1],d=3===n.dims.length?l?n.dims[2]/3:n.dims[2]:t.numHeads*n.dims[4],p=c,h=0,f=!i||0===i.dims.length,g=Math.floor(f?d/(t.numHeads+2*t.kvNumHeads):d/t.numHeads);f&&(d=g*t.numHeads);let m=o&&0!==o.dims.length,y=s&&0!==s.dims.length;if(m&&4===o.dims.length&&o.dims[0]===u&&o.dims[1]!==t.kvNumHeads&&o.dims[2]===t.kvNumHeads&&o.dims[3]===g)throw Error("BSNH pastKey/pastValue is not supported");if(m&&y){if(4!==o.dims.length)throw Error('Input "past_key" is expected to have 4 dimensions');if(4!==s.dims.length)throw Error('Input "past_value" is expected to have 4 dimensions');h=o.dims[2]}else if(m||y)throw Error('Input "past_key" and "past_value" shall be both present or both absent');let b=1;if(i&&i.dims.length>0){if(3!==n.dims.length)throw Error('Input "query" is expected to have 3 dimensions when key is given');if(i.dims.length<3||i.dims.length>5)throw Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(n.dims[0]!==i.dims[0])throw Error('Input "query" and "key" shall have same dim 0 (batch size)');if(3===i.dims.length){if(n.dims[2]%i.dims[2]!=0)throw Error('Dimension 2 of "query" should be a multiple of "key"');p=i.dims[1]}else if(5===i.dims.length){if(i.dims[2]!==t.numHeads||2!==i.dims[3]||i.dims[4]!==g)throw Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(a)throw Error('Expect "value" be none when "key" has packed kv format.');p=i.dims[1]}else{if(i.dims[1]!==t.numHeads||i.dims[3]!==g)throw Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');p=i.dims[2]}}else{if(3!==n.dims.length&&5!==n.dims.length)throw Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(5===n.dims.length&&(n.dims[2]!==t.numHeads||3!==n.dims[3]))throw Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');b=3}let v=0,x=!1,w=t.kvNumHeads?g*t.kvNumHeads:d;if(a&&a.dims.length>0){if(3!==a.dims.length&&4!==a.dims.length)throw Error('Input "value" is expected to have 3 or 4 dimensions');if(n.dims[0]!==a.dims[0])throw Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(3===a.dims.length){if(p!==a.dims[1])throw Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');w=a.dims[2]}else{if(p!==a.dims[2])throw Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');w=a.dims[1]*a.dims[3],x=!0}}let _=e.length>4?e[5]:void 0;if(_&&1!==_.dims.length&&_.dims[0]!==u)throw Error('Input "seqlens" is expected to have 1 dimension and the same dim 0 as batch_size');return{batchSize:u,sequenceLength:c,pastSequenceLength:h,kvSequenceLength:p,totalSequenceLength:-1,maxSequenceLength:-1,inputHiddenSize:0,hiddenSize:d,vHiddenSize:w,headSize:g,vHeadSize:Math.floor(w/t.kvNumHeads),numHeads:t.numHeads,kvNumHeads:t.kvNumHeads,nReps:t.numHeads/t.kvNumHeads,pastPresentShareBuffer:!1,maskType:v,scale:t.scale,broadcastResPosBias:!1,passPastInKv:x,qkvFormat:b}},qE=ce({perm:[0,2,1,3]}),L0=(e,t,n)=>{let i=t,a=n.kvNumHeads;return 3===t.dims.length&&0!==n.kvSequenceLength&&(i=t.reshape([n.batchSize,n.kvSequenceLength,a,n.headSize]),i=e.compute(at(i,qE.perm),{inputs:[i],outputs:[-1]})[0]),i},KE=(e,t,n,i)=>{let a=7,o=[e*t],s=e*t,l=[{type:12,data:s},{type:12,data:t},{type:12,data:e}];return{name:"GeneratePositionIds",shaderCache:{hint:`${e};${t}`,inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:o,dataType:a}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:l}),getShaderSource:e=>{let t=N("seq_lens",n.dataType,n.dims),s=N("total_seq_lens",i.dataType,i.dims),l=G("pos_ids",a,o),u=[{name:"output_size",type:"u32"},{name:"sequence_length",type:"u32"},{name:"batch_size",type:"u32"}];return`
  ${e.registerUniforms(u).declareVariables(t,s,l)}
  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let total_sequence_length = u32(${s.getByOffset("0")});
    let is_subsequent_prompt = uniforms.sequence_length > 1 && uniforms.sequence_length != total_sequence_length;
    let is_first_prompt = !is_subsequent_prompt && uniforms.sequence_length == total_sequence_length;
    let batch_idx = global_idx / uniforms.sequence_length;
    let sequence_idx = i32(global_idx % uniforms.sequence_length);
    var pos_id: i32 = 0;
    let seqlen = ${t.getByOffset("batch_idx")};
    let total_seqlen = seqlen + 1;
    if (is_first_prompt) {
      if (sequence_idx < total_seqlen) {
        pos_id = sequence_idx;
      } else {
        pos_id = 1;
      }
      ${l.setByOffset("global_idx","pos_id")}
    } else if (is_subsequent_prompt) {
      let past_seqlen = total_seqlen - i32(uniforms.sequence_length);
      if (past_seqlen + sequence_idx < total_seqlen) {
        pos_id = past_seqlen + sequence_idx;
      } else {
        pos_id = 1;
      }
      ${l.setByOffset("global_idx","pos_id")}
    } else if (global_idx < uniforms.batch_size) {
      ${l.setByOffset("global_idx","seqlen")}
    };
  }
  `}}},R0=(e,t)=>{let n=jE(e.inputs,t);if(5===e.inputs[0].dims.length)throw Error("Packed QKV is not implemented");if(e.inputs[1]?.dims.length===5)throw Error("Packed KV is not implemented");let i=e.inputs[0],a=e.inputs[1]&&e.inputs[1].dims.length>0?e.inputs[1]:void 0,o=e.inputs[2]&&e.inputs[2].dims.length>0?e.inputs[2]:void 0,s=e.inputs[3]&&0!==e.inputs[3].dims.length?e.inputs[3]:void 0,l=e.inputs[4]&&0!==e.inputs[4].dims.length?e.inputs[4]:void 0,u=e.inputs.length>4?e.inputs[5]:void 0,c=e.inputs.length>5?e.inputs[6]:void 0,d=n.kvNumHeads?n.kvNumHeads:n.numHeads,p=ce({axis:2,numOutputs:3,splitSizes:[n.numHeads*n.headSize,d*n.headSize,d*n.headSize]}),[h,f,g]=a||o?[i,a,o]:e.compute(zc([i],p),{inputs:[i],outputs:[-1,-1,-1]}),m,y;if(t.doRotary){let i=e.compute(KE(n.batchSize,n.sequenceLength,u,c),{inputs:[u,c],outputs:[-1]})[0],a=e.inputs[7],o=e.inputs[8],s=ce({interleaved:0!==t.rotaryInterleaved,numHeads:n.numHeads,rotaryEmbeddingDim:0,scale:t.scale}),l=[h,i,a,o],d=[-1];m=e.compute(Xa(l,s),{inputs:l,outputs:d})[0],l.splice(0,1,f);let p=ce({interleaved:0!==t.rotaryInterleaved,numHeads:n.kvNumHeads,rotaryEmbeddingDim:0,scale:t.scale});y=e.compute(Xa(l,p),{inputs:l,outputs:d})[0]}let b=qo(e,n.batchSize,n.numHeads,n.sequenceLength,n.headSize,t.doRotary?m:h,void 0,0),v=L0(e,t.doRotary?y:f,n),x=L0(e,g,n);po(e,b,v,x,void 0,void 0,s,l,void 0,n,u,c)}}),F0=k(()=>{le(),ge(),Yn(),ye(),M0=(e,t,n,i,a,o,s,l)=>{let u=Ee(o),c=1===u?"f32":`vec${u}f`,d=1===u?"vec2f":`mat2x${u}f`,p=a*s,h=64;1===p&&(h=256);let f=[a,s,o/u],g=[a,s,2],m=["rank","type","type"],y=[];y.push(...W(f,g));let b=e=>{let a=N("x",t.dataType,3,u),o=[a,N("scale",n.dataType,n.dims),N("bias",i.dataType,i.dims),G("output",1,3,2)];return`
  var<workgroup> workgroup_shared : array<${d}, ${h}>;
  const workgroup_size = ${h}u;
  ${e.declareVariables(...o)}
  ${e.mainStart(h)}
    let batch = workgroup_index / uniforms.x_shape[1];
    let channel = workgroup_index % uniforms.x_shape[1];
    let hight = uniforms.x_shape[2];
    // initialize workgroup memory
    var sum = ${c}(0);
    var squared_sum = ${c}(0);
    for (var h = local_idx; h < hight; h += workgroup_size) {
      let value = ${c}(${a.get("batch","channel","h")});
      sum += value;
      squared_sum += value * value;
    }
    workgroup_shared[local_idx] = ${d}(sum, squared_sum);
    workgroupBarrier();

    for (var currSize = workgroup_size >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (local_idx < currSize) {
        workgroup_shared[local_idx] = workgroup_shared[local_idx] + workgroup_shared[local_idx + currSize];
      }
      workgroupBarrier();
    }
    if (local_idx == 0) {
      let sum_final = ${Kt("workgroup_shared[0][0]",u)} / f32(hight * ${u});
      let squared_sum_final = ${Kt("workgroup_shared[0][1]",u)} / f32(hight * ${u});

      let inv_std_dev = inverseSqrt(squared_sum_final - sum_final * sum_final + f32(${l}));
      let channel_scale = inv_std_dev * f32(scale[channel]);
      let channel_shift = f32(bias[channel]) - sum_final * channel_scale;
      output[workgroup_index] = vec2f(channel_scale, channel_shift);
    }
  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${u};${l};${h}`,inputDependencies:m},getRunData:()=>({outputs:[{dims:g,dataType:1}],dispatchGroup:{x:p},programUniforms:y}),getShaderSource:b},{inputs:[t,n,i],outputs:[-1]})[0]},XE=(e,t,n)=>{let i=t[0].dims,a=i,o=2,s=i[0],l=i[1],u=C.sizeFromDimension(i,o),c=Ee(u),d=C.size(a)/c,p=M0(e,t[0],t[1],t[2],s,u,l,n.epsilon),h=[s,l,u/c],f=[s,l],g=["type","none"],m=e=>{let n=N("x",t[0].dataType,h.length,c),i=N("scale_shift",1,f.length,2),a=G("output",t[0].dataType,h.length,c),o=[n,i,a];return`
  ${e.registerUniform("output_size","u32").declareVariables(...o)}
  ${e.mainStart()}
  ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let outputIndices = ${a.offsetToIndices("global_idx")};
      let batch = outputIndices[0];
      let channel = outputIndices[1];
      let scale_shift = ${i.getByIndices("vec2<u32>(batch, channel)")};
      let value = ${n.getByOffset("global_idx")} * ${a.type.value}(scale_shift.x) + ${a.type.value}(scale_shift.y);
      ${a.setByOffset("global_idx","value")};
  }`};e.compute({name:"InstanceNormalization",shaderCache:{hint:`${c}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:a,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:[{type:12,data:d},...W(h,f,h)]}),getShaderSource:m},{inputs:[t[0],p]})},ZE=(e,t,n)=>{let i=t[0].dims,a=i,o=i[0],s=i[i.length-1],l=C.sizeFromDimension(i,1)/s,u=Ee(s),c=C.size(a)/u,d=[{type:12,data:l},{type:12,data:Math.floor(s/u)}],p=["type","type"],h=!1,f=[0,i.length-1];for(let e=0;e<i.length-2;e++)h=h||1!==i[e+1],f.push(e+1);let g=(h=h&&1!==i[i.length-1])?e.compute(at(e.inputs[0],f),{inputs:[e.inputs[0]],outputs:[-1]})[0]:e.inputs[0].reshape(Array.from({length:i.length},(e,t)=>i[f[t]])),m=M0(e,g,t[1],t[2],o,l,s,n.epsilon),y=e=>{let n=Ve(t[0].dataType),i=1===u?"vec2f":`mat${u}x2f`,o=e=>{let t=0===e?"x":"y",i=1===u?"f32":`vec${u}f`;switch(u){case 1:return`${n}(${i}(scale.${t}))`;case 2:return`vec2<${n}>(${i}(scale[0].${t}, scale[1].${t}))`;case 4:return`vec4<${n}>(${i}(scale[0].${t}, scale[1].${t}, scale[2].${t}, scale[3].${t}))`;default:throw Error(`Not supported compoents ${u}`)}},s=N("input",t[0].dataType,t[0].dims,u),l=G("output",t[0].dataType,a,u);return`
  @group(0) @binding(0) var<storage, read> input : array<${s.type.storage}>;
  @group(0) @binding(1) var<storage, read> scale_input : array<${i}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${l.type.storage}>;
  struct Uniforms {H: u32, C : u32};
  @group(0) @binding(3) var<uniform> uniforms: Uniforms;

  ${e.mainStart()}
    let current_image_number = global_idx / (uniforms.C * uniforms.H);
    let current_channel_number = global_idx % uniforms.C;

    let scale_offset = current_image_number * uniforms.C + current_channel_number;
    let scale = scale_input[scale_offset];
    output[global_idx] = fma(input[global_idx], ${o(0)}, ${o(1)});
  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${u}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:a,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:d}),getShaderSource:y},{inputs:[t[0],m]})},B0=(e,t)=>{"NHWC"===t.format?ZE(e,e.inputs,t):XE(e,e.inputs,t)}}),G0=k(()=>{le(),ge(),ye(),JE=e=>{if(!e||e.length<2)throw Error("layerNorm requires at least 2 inputs.")},YE=(e,t,n)=>{let i=t.simplified,a=e[0].dims,o=e[1],s=!i&&e[2],l=a,u=C.normalizeAxis(t.axis,a.length),c=C.sizeToDimension(a,u),d=C.sizeFromDimension(a,u),p=C.size(o.dims),h=s?C.size(s.dims):0;if(p!==d||s&&h!==d)throw Error(`Size of X.shape()[axis:] == ${d}.
       Size of scale and bias (if provided) must match this.
       Got scale size of ${p} and bias size of ${h}`);let f=[];for(let e=0;e<a.length;++e)e<u?f.push(a[e]):f.push(1);let g=Ee(d),m=["type","type"],y=[{type:12,data:c},{type:1,data:d},{type:12,data:Math.floor(d/g)},{type:1,data:t.epsilon}];s&&m.push("type");let b=n>1,v=n>2,x=t=>{let n=Ve(e[0].dataType),a=[N("x",e[0].dataType,e[0].dims,g),N("scale",o.dataType,o.dims,g)];s&&a.push(N("bias",s.dataType,s.dims,g)),a.push(G("output",e[0].dataType,l,g)),b&&a.push(G("mean_data_output",1,f)),v&&a.push(G("inv_std_output",1,f));let u=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`
  ${t.registerUniforms(u).declareVariables(...a)}
  ${t.mainStart()}
    ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}
    let offset = global_idx * uniforms.norm_size_vectorized;
    var mean_vector = ${wc("f32",g)};
    var mean_square_vector = ${wc("f32",g)};

    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {
      let value = ${Hr(n,g,"x[h + offset]")};
      mean_vector += value;
      mean_square_vector += value * value;
    }
    let mean = ${Kt("mean_vector",g)} / uniforms.norm_size;
    let inv_std_dev = inverseSqrt(${Kt("mean_square_vector",g)} / uniforms.norm_size ${i?"":"- mean * mean"} + uniforms.epsilon);

    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {
      let f32input = ${Hr(n,g,"x[j + offset]")};
      let f32scale = ${Hr(n,g,"scale[j]")};
      output[j + offset] = ${a[0].type.value}((f32input ${i?"":"- mean"}) * inv_std_dev * f32scale
        ${s?`+ ${Hr(n,g,"bias[j]")}`:""}
      );
    }

    ${b?"mean_data_output[global_idx] = mean":""};
    ${v?"inv_std_output[global_idx] = inv_std_dev":""};
  }`},w=[{dims:l,dataType:e[0].dataType}];return b&&w.push({dims:f,dataType:1}),v&&w.push({dims:f,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${g};${n};${i}`,inputDependencies:m},getRunData:()=>({outputs:w,dispatchGroup:{x:Math.ceil(c/64)},programUniforms:y}),getShaderSource:x}},V0=(e,t)=>{JE(e.inputs),e.compute(YE(e.inputs,t,e.outputCount))}}),W0=k(()=>{ge(),Ha(),ja(),QE=e=>{if(!e||2!==e.length)throw Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw Error("shared dimension does not match.")},U0=e=>{QE(e.inputs);let t=Fn.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw Error("Can't use matmul on the given tensors");let n=t[t.length-1],i=e.inputs[0].dims[e.inputs[0].dims.length-1];if(n<8&&i<8)e.compute(Wa(e.inputs,{activation:""},t));else{let a=t[t.length-2],o=C.size(e.inputs[0].dims.slice(0,-2)),s=C.size(e.inputs[1].dims.slice(0,-2));if(1!==o&&1===a&&1===s){let a=e.inputs[0].reshape([1,o,i]),s=e.inputs[1].reshape([1,i,n]),l=[1,o,n],u=[a,s];e.compute(jo(u,{activation:""},t,l),{inputs:u})}else e.compute(jo(e.inputs,{activation:""},t))}}}),q0=k(()=>{le(),ge(),Xe(),ye(),eC=(e,t)=>{if(e.length<3||e.length>4)throw Error("MatMulNBits requires 3 or 4 inputs");let n=e[0],i=n.dims.length;if(n.dims[i-1]!==t.k)throw Error("The last dim of input shape does not match the k value");let a=Math.floor((t.k+t.blockSize-1)/t.blockSize),o=t.blockSize/8*t.bits,s=e[1];if(!C.areEqual(s.dims,[t.n,a,o]))throw Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let l=e[2].dims;if(C.size(l)!==t.n*a)throw Error("scales input size error.");if(4===e.length){let n=e[3].dims,i=t.n*(8===t.bits?a:Math.floor((a*t.bits+7)/8));if(C.size(n)!==i)throw Error("zeroPoints input size error.")}},tC=(e,t)=>{let n=e[0].dims,i=n.length,a=n[i-2],o=t.k,s=t.n,l=n.slice(0,i-2),u=C.size(l),c=e[1].dims[2]/4,d=e[0].dataType,p=Ee(t.k),h=Ee(c),f=Ee(s),g=l.concat([a,s]),m=a>1&&s/f%2==0?2:1,y=C.size(g)/f/m,b=64,v=[],x=[u,a,o/p],w=C.convertShape(e[1].dims).slice();w.splice(-1,1,c/h),v.push(...W(x)),v.push(...W(w)),v.push(...W(e[2].dims)),4===e.length&&v.push(...W(C.convertShape(e[3].dims)));let _=[u,a,s/f];v.push(...W(_));let S=n=>{let i=x.length,a=N("a",e[0].dataType,i,p),o=N("b",12,w.length,h),s=N("scales",e[2].dataType,e[2].dims.length),l=[a,o,s],u=4===e.length?N("zero_points",12,e[3].dims.length):void 0;u&&l.push(u);let d=_.length,g=G("output",e[0].dataType,d,f),y=Ve(e[0].dataType),v=(()=>{switch(p){case 1:return`array<${y}, 8>`;case 2:return`mat4x2<${y}>`;case 4:return`mat2x4<${y}>`;default:throw Error(`${p}-component is not supported.`)}})(),S=()=>{let e=`
          // reuse a data
            var input_offset = ${a.indicesToOffset(`${a.type.indices}(batch, row, word_offset)`)};
            var a_data: ${v};
            for (var j: u32 = 0; j < ${8/p}; j++) {
              a_data[j] = ${a.getByOffset("input_offset")};
              input_offset++;
            }
          `;for(let t=0;t<f*m;t++)e+=`
            b_value = ${1===h?`b${t}_data`:`b${t}_data[i]`};
            b_value_lower = unpack4xU8(b_value & b_mask);
            b_value_upper = unpack4xU8((b_value >> 4) & b_mask);
            b_quantized_values = ${v}(${Array.from({length:4},(e,t)=>`${y}(b_value_lower[${t}]), ${y}(b_value_upper[${t}])`).join(", ")});
            b_dequantized_values = ${1===p?`${v}(${Array.from({length:8},(e,n)=>`(b_quantized_values[${n}] - ${u?`zero_point${t}`:"zero_point"}) * scale${t}`).join(", ")});`:`(b_quantized_values - ${v}(${Array(8).fill(`${u?`zero_point${t}`:"zero_point"}`).join(",")})) * scale${t};`};
            workgroup_shared[local_id.x * ${m} + ${Math.floor(t/f)}]${f>1?`[${t%f}]`:""} += ${Array.from({length:8/p},(e,t)=>`${1===p?`a_data[${t}] * b_dequantized_values[${t}]`:`dot(a_data[${t}], b_dequantized_values[${t}])`}`).join(" + ")};
          `;return e},k=()=>{let e=`
            var col_index = col * ${f};
            ${u?`
            let zero_point_bytes_per_col = (nBlocksPerCol + 1) / 2;
            var zero_point_byte_count: u32;
            var zero_point_word_index: u32;
            var zero_point_byte_offset: u32;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            var zero_point_bits_offset: u32;
            var zero_point_word: u32;`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${y}(8);`}
            `;for(let t=0;t<f*m;t++)e+=`
            let scale${t} = ${s.getByOffset("col_index * nBlocksPerCol + block")};
            ${u?`
            zero_point_byte_count = col_index * zero_point_bytes_per_col + (block >> 0x1u);
            zero_point_word_index = zero_point_byte_count >> 0x2u;
            zero_point_byte_offset = zero_point_byte_count & 0x3u;
            zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            zero_point_word = ${u.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point${t} = ${y}((zero_point_word) & 0xFu);`:""}
            col_index += 1;`;return e},T=()=>{let e=`col_index = col * ${f};`;for(let t=0;t<f*m;t++)e+=`
            let b${t}_data = ${o.getByIndices(`${o.type.indices}(col_index, block, word)`)};
            col_index += 1;`;return e+`
            var b_value: u32;
            let b_mask: u32 = 0x0F0F0F0Fu;
            var b_value_lower: vec4<u32>;
            var b_value_upper: vec4<u32>;
            var b_quantized_values: ${v};
            var b_dequantized_values: ${v};`};return`
        var<workgroup> workgroup_shared: array<${g.type.value}, ${m*b}>;
        ${n.declareVariables(...l,g)}
        ${n.mainStart([b,1,1])}
          let output_indices = ${g.offsetToIndices(`(global_idx / ${b}) * ${m}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let nBlocksPerCol = uniforms.b_shape[1];

          for (var block = local_id.x; block < nBlocksPerCol; block += ${b}) {
            //process one block
            var word_offset: u32 = block * ${t.blockSize/p};
            ${k()}
            for (var word: u32 = 0; word < ${c}; word += ${h}) {
              ${T()}
              for (var i: u32 = 0; i < ${h}; i++) {
                ${S()}
                word_offset += ${8/p};
              }
            }
          }
          workgroupBarrier();

          if (local_id.x < ${m}) {
            var output_value: ${g.type.value} = ${g.type.value}(0);
            var workgroup_shared_offset: u32 = local_id.x;
            for (var b: u32 = 0u; b < ${b}u; b++) {
              output_value += workgroup_shared[workgroup_shared_offset];
              workgroup_shared_offset += ${m};
            }
            ${g.setByIndices(`${g.type.indices}(batch, row, col + local_id.x)`,"output_value")};
          }
        }`};return{name:"MatMulNBits",shaderCache:{hint:`${t.blockSize};${t.bits};${p};${h};${f};${m};${b}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:g,dataType:d}],dispatchGroup:{x:y},programUniforms:v}),getShaderSource:S}},nC=(e,t)=>{let n=e[0].dims,i=n.length,a=n[i-2],o=t.k,s=t.n,l=n.slice(0,i-2),u=C.size(l),c=e[1].dims[2]/4,d=e[0].dataType,p=Ee(t.k),h=Ee(c),f=l.concat([a,s]),g=128,m=s%8==0?8:s%4==0?4:1,y=128/m,b=y*h*8,v=b/p,x=b/t.blockSize,w=C.size(f)/m,_=[],S=[u,a,o/p],k=C.convertShape(e[1].dims).slice();k.splice(-1,1,c/h),_.push(...W(S)),_.push(...W(k)),_.push(...W(e[2].dims)),4===e.length&&_.push(...W(C.convertShape(e[3].dims)));let T=[u,a,s];_.push(...W(T));let E=n=>{let i=S.length,a=N("a",e[0].dataType,i,p),o=N("b",12,k.length,h),s=N("scales",e[2].dataType,e[2].dims.length),l=[a,o,s],u=4===e.length?N("zero_points",12,e[3].dims.length):void 0;u&&l.push(u);let c=T.length,d=G("output",e[0].dataType,c),f=Ve(e[0].dataType),b=()=>{switch(p){case 1:return`
          let a_data0 = vec4<${f}>(sub_a[word_offset], sub_a[word_offset + 1], sub_a[word_offset + 2], sub_a[word_offset + 3]);
          let a_data1 = vec4<${f}>(sub_a[word_offset + 4], sub_a[word_offset + 5], sub_a[word_offset + 6], sub_a[word_offset + 7]);`;case 2:return`
          let a_data0 = vec4<${f}>(sub_a[word_offset], sub_a[word_offset + 1]);
          let a_data1 = vec4<${f}>(sub_a[word_offset + 2], sub_a[word_offset + 3]);`;case 4:return`
          let a_data0 = sub_a[word_offset];
          let a_data1 = sub_a[word_offset + 1];`;default:throw Error(`${p}-component is not supported.`)}};return`
        var<workgroup> sub_a: array<${a.type.value}, ${v}>;
        var<workgroup> inter_results: array<array<${d.type.value}, ${y}>, ${m}>;
        ${n.declareVariables(...l,d)}
        ${n.mainStart([y,m,1])}
          let output_indices = ${d.offsetToIndices(`workgroup_index * ${m}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let n_blocks_per_col = uniforms.b_shape[1];
          let num_tiles =  (n_blocks_per_col - 1) / ${x} + 1;

          // Loop over shared dimension.
          for (var tile: u32 = 0; tile < num_tiles; tile += 1) {
            let a_col_start = tile * ${v};
            // load one tile A data into shared memory.
            for (var a_offset = local_idx; a_offset < ${v}; a_offset += ${g})
            {
              let a_col = a_col_start + a_offset;
              if (a_col < uniforms.a_shape[2])
              {
                sub_a[a_offset] = ${a.getByIndices(`${a.type.indices}(batch, row, a_col)`)};
              } else {
                sub_a[a_offset] = ${a.type.value}(0);
              }
            }
            workgroupBarrier();

            // each thread process one block
            let b_row = col + local_id.y;
            let block = tile * ${x} + local_id.x;
            ${u?`
            let zero_point_bytes_per_col = (n_blocks_per_col + 1) / 2;
            let zero_point_byte_count = b_row * zero_point_bytes_per_col + (block >> 0x1u);
            let zero_point_word_index = zero_point_byte_count >> 0x2u;
            let zero_point_byte_offset = zero_point_byte_count & 0x3u;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            let zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            let zero_point_word = ${u.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point = ${f}((zero_point_word) & 0xFu);`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${f}(8);`}
            let scale = ${s.getByOffset("b_row * n_blocks_per_col + block")};
            let b_data = ${o.getByIndices(`${o.type.indices}(b_row, block, 0)`)};
            var word_offset = local_id.x * ${t.blockSize/p};
            for (var i: u32 = 0; i < ${h}; i++) {
              ${b()}
              let b_value = ${1===h?"b_data":"b_data[i]"};
              let b_value_lower = unpack4xU8(b_value & 0x0F0F0F0Fu);
              let b_value_upper = unpack4xU8((b_value >> 4) & 0x0F0F0F0Fu);
              let b_quantized_values = mat2x4<${f}>(${Array.from({length:4},(e,t)=>`${f}(b_value_lower[${t}]), ${f}(b_value_upper[${t}])`).join(", ")});
              let b_dequantized_values = (b_quantized_values - mat2x4<${f}>(${Array(8).fill("zero_point").join(",")})) * scale;
              inter_results[local_id.y][local_id.x] += ${Array.from({length:2},(e,t)=>`dot(a_data${t}, b_dequantized_values[${t}])`).join(" + ")};
              word_offset += ${8/p};
            }
            workgroupBarrier();
          }

          if (local_idx < ${m}) {
            var output_value: ${d.type.value} = ${d.type.value}(0);
            for (var b = 0u; b < ${y}; b++) {
              output_value += inter_results[local_idx][b];
            }
            if (col + local_idx < uniforms.output_shape[2])
            {
              ${d.setByIndices(`${d.type.indices}(batch, row, col + local_idx)`,"output_value")}
            }
          }
        }`};return{name:"BlockwiseMatMulNBits32",shaderCache:{hint:`${t.blockSize};${p};${h};${y};${m}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:f,dataType:d}],dispatchGroup:{x:w},programUniforms:_}),getShaderSource:E}},H0=(e,t)=>{eC(e.inputs,t),32===t.blockSize&&e.adapterInfo.isVendor("intel")&&e.adapterInfo.isArchitecture("gen-12lp")?e.compute(nC(e.inputs,t)):e.compute(tC(e.inputs,t))},j0=e=>ce(e)}),X0=k(()=>{le(),ge(),ye(),rC=e=>{if(!e||e.length<1)throw Error("Too few inputs");if(1!==e[0].dataType&&10!==e[0].dataType)throw Error("Input type must be float or float16.");if(e.length>=2){let t=2*e[0].dims.length===e[1].dims[0];if(4===e.length&&(t=2*e[3].dims[0]===e[1].dims[0]),!t)throw Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},oC=(e,t,n)=>{let i="";for(let a=t-1;a>=0;--a)i+=`
            k = i32(${e.indicesGet("indices",a)}) - ${Q("uniforms.pads",a,n)};
            if (k < 0) {
              break;
            }
            if (k >= i32(${Q("uniforms.x_shape",a,t)})) {
              break;
            }
            offset += k * i32(${Q("uniforms.x_strides",a,t)});
        `;return`
          value = ${e.type.value}(uniforms.constant_value);
          for (var i = 0; i < 1; i++) {
            var offset = 0;
            var k = 0;
            ${i}
            value = x[offset];
          }
      `},iC=(e,t,n)=>{let i="";for(let a=t-1;a>=0;--a)i+=`
                k = i32(${e.indicesGet("indices",a)}) - ${Q("uniforms.pads",a,n)};
                if (k < 0) {
                  k = -k;
                }
                {
                  let _2n_1 = 2 * (i32(${Q("uniforms.x_shape",a,t)}) - 1);
                  k = k % _2n_1;
                  if(k >= i32(${Q("uniforms.x_shape",a,t)})) {
                    k = _2n_1 - k;
                  }
                }
                offset += k * i32(${Q("uniforms.x_strides",a,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${i}
              value = x[offset];
          `},aC=(e,t,n)=>{let i="";for(let a=t-1;a>=0;--a)i+=`
                k = i32(${e.indicesGet("indices",a)}) - ${Q("uniforms.pads",a,n)};
                if (k < 0) {
                  k = 0;
                }
                if (k >= i32(${Q("uniforms.x_shape",a,t)})) {
                  k = i32(${Q("uniforms.x_shape",a,t)}) - 1;
                }
                offset += k * i32(${Q("uniforms.x_strides",a,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${i}
              value = x[offset];
          `},sC=(e,t,n)=>{let i="";for(let a=t-1;a>=0;--a)i+=`
                k = i32(${e.indicesGet("indices",a)}) - ${Q("uniforms.pads",a,n)};
                if (k < 0)  {
                  k += i32(${Q("uniforms.x_shape",a,t)}]);
                }
                if (k >= i32(${Q("uniforms.x_shape",a,t)})) {
                  k -= i32(${Q("uniforms.x_shape",a,t)});
                }
                offset += k * i32(${Q("uniforms.x_strides",a,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${i}
              value = x[offset];
          `},uC=(e,t,n)=>{switch(n.mode){case 0:return oC(e,t,n.pads.length);case 1:return iC(e,t,n.pads.length);case 2:return aC(e,t,n.pads.length);case 3:return sC(e,t,n.pads.length);default:throw Error("Invalid mode")}},lC=(e,t)=>{let n=C.padShape(e[0].dims.slice(),t.pads),i=e[0].dims,a=[{type:12,data:C.size(n)},{type:6,data:t.pads}],o=e.length>=3&&e[2].data;0===t.mode&&a.push({type:o?e[2].dataType:1,data:t.value}),a.push(...W(e[0].dims,n));let s=["rank"],l=a=>{let s=G("output",e[0].dataType,n.length),l=N("x",e[0].dataType,i.length),u=l.type.value,c=uC(s,i.length,t),d=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return 0===t.mode&&d.push({name:"constant_value",type:o?u:"f32"}),`
            ${a.registerUniforms(d).declareVariables(l,s)}
            ${a.mainStart()}
            ${a.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

            let indices = ${s.offsetToIndices("global_idx")};

            var value = ${u}(0);
            ${c}
            output[global_idx] = value;
        }`};return{name:"Pad",shaderCache:{hint:`${t.mode}${o}`,inputDependencies:s},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(C.size(n)/64)},programUniforms:a}),getShaderSource:l}},cC=(e,t)=>{if(!(e.length>1))return t;{let n=e[1].getBigInt64Array(),i=e.length>=3&&e[2].data?10===e[2].dataType?e[2].getUint16Array()[0]:e[2].getFloat32Array()[0]:0,a=e[0].dims.length,o=new Int32Array(2*a).fill(0);if(e.length>=4){let t=e[3].getBigInt64Array();for(let e=0;e<t.length;e++)o[Number(t[e])]=Number(n[e]),o[Number(t[e])+a]=Number(n[e+t.length])}else n.forEach((e,t)=>o[Number(t)]=Number(e));let s=[];return o.forEach(e=>s.push(e)),{mode:t.mode,value:i,pads:s}}},K0=(e,t)=>{rC(e.inputs);let n=cC(e.inputs,t);e.compute(lC(e.inputs,n),{inputs:[0]})}}),pw=k(()=>{pt(),le(),ge(),ye(),Za=e=>{if(me.webgpu.validateInputContent&&(!e||1!==e.length))throw Error("Pool ops requires 1 input.")},Z0=(e,t,n)=>{let i="NHWC"===t.format,a=e.dims.slice();i&&a.splice(1,0,a.pop());let o=Object.hasOwnProperty.call(t,"dilations"),s=t.kernelShape.slice(),l=t.strides.slice(),u=o?t.dilations.slice():[],c=t.pads.slice();Ur.adjustPoolAttributes(n,a,s,l,u,c);let d=Ur.computePoolOutputShape(n,a,l,u,s,c,t.autoPad),p=Object.assign({},t);o?Object.assign(p,{kernelShape:s,strides:l,pads:c,dilations:u,cacheKey:t.cacheKey}):Object.assign(p,{kernelShape:s,strides:l,pads:c,cacheKey:t.cacheKey});let h=d.slice();return h.push(h.splice(1,1)[0]),[p,i?h:d]},J0=(e,t)=>{let n="NHWC"===t.format,i=[{type:12,data:C.size(e)},{type:12,data:C.size(t.kernelShape)}],a=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let e=t.kernelShape[t.kernelShape.length-1],n=t.strides[t.strides.length-1],o=t.pads[t.pads.length/2-1],s=t.pads[t.pads.length-1],l=!!(o+s);i.push({type:12,data:e},{type:12,data:n},{type:12,data:o},{type:12,data:s}),a.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let u=!1;if(2===t.kernelShape.length){let e=t.kernelShape[t.kernelShape.length-2],n=t.strides[t.strides.length-2],o=t.pads[t.pads.length/2-2],s=t.pads[t.pads.length-2];u=!!(o+s),i.push({type:12,data:e},{type:12,data:n},{type:12,data:o},{type:12,data:s}),a.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[i,a,!0,l,u]}{if(n)throw Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let e=C.computeStrides(t.kernelShape);return i.push({type:12,data:e},{type:12,data:t.pads},{type:12,data:t.strides}),a.push({name:"kernelStrides",type:"u32",length:e.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length}),[i,a,!!t.pads.reduce((e,t)=>e+t),!1,!1]}},Y0=(e,t,n,i,a,o,s,l,u,c,d,p)=>{let h="NHWC"===a.format,f=t.type.value,g=G("output",t.type.tensor,i);if(a.kernelShape.length<=2){let i="",c="",m="",y=n-(h?2:1);if(i=d?`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${y}] = indices[${y}] * uniforms.sw - uniforms.pwStart + i;
                  if (xIndices[${y}] < 0 || xIndices[${y}]
                      >= uniforms.x_shape[${y}]) {
                    pad++;
                    continue;
                  }
                  let x_val = x[${t.indicesToOffset("xIndices")}];
                  ${o}
                }`:`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${y}] = indices[${y}] * uniforms.sw - uniforms.pwStart + i;
                  let x_val = x[${t.indicesToOffset("xIndices")}];
                  ${o}
                }`,2===a.kernelShape.length){let e=n-(h?3:2);c=p?`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${e}] = indices[${e}] * uniforms.sh - uniforms.phStart + j;
                  if (xIndices[${e}] < 0 || xIndices[${e}] >= uniforms.x_shape[${e}]) {
                    pad += i32(uniforms.kw);
                    continue;
                  }
              `:`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${e}] = indices[${e}] * uniforms.sh - uniforms.phStart + j;
                `,m=`
              }
            `}return`
            ${e.registerUniforms(u).declareVariables(t,g)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

              let indices = ${g.offsetToIndices("global_idx")};
              var xIndices = ${g.offsetToIndices("global_idx")};

              var value = ${f}(${l});
              var pad = 0;
              ${c}
              ${i}
              ${m}
              ${s}

              output[global_idx] = value;
            }`}{if(h)throw Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let i=a.kernelShape.length,d=a.pads.length,p="";return p=c?`
                if (xIndices[j] >= uniforms.x_shape[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${t.indicesToOffset("xIndices")}];
                ${o}
              }`:`
              }
              let x_val = x[${t.indicesToOffset("xIndices")}];
              ${o}
            `,`
            ${e.registerUniforms(u).declareVariables(t,g)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
              let indices = ${g.offsetToIndices("global_idx")};
              var xIndices = ${g.offsetToIndices("global_idx")};

              var offsets: array<u32, ${i}>;

              var value = ${f}(${l});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {
                var offset = i;
                for (var j = 0u; j < ${i-1}u; j++) {
                  offsets[j] = offset / ${Q("uniforms.kernelStrides","j",i)};
                  offset -= offsets[j] * ${Q("uniforms.kernelStrides","j",i)};
                }
                offsets[${i-1}] = offset;

                isPad = false;
                for (var j = ${n-i}u; j < ${n}u; j++) {
                  xIndices[j] = indices[j] * ${Q("uniforms.strides",`j - ${n-i}u`,i)}
                    + offsets[j - ${n-i}u] - ${Q("uniforms.pads","j - 2u",d)};
                  ${p}
              }
              ${s}

              output[global_idx] = value;
            }`}},Q0=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,dC=e=>`${Q0(e)};${e.countIncludePad}`,pC=e=>`${Q0(e)};${e.storageOrder};${e.dilations}`,ew=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),tw=(e,t,n,i)=>{let[a,o]=Z0(t,i,n),s=N("x",t.dataType,t.dims.length),l=s.type.value,u="value += x_val;",c="";a.countIncludePad?c+=`value /= ${l}(uniforms.kernelSize);`:c+=`value /= ${l}(i32(uniforms.kernelSize) - pad);`;let[d,p,h,f,g]=J0(o,a);d.push(...W(t.dims,o));let m=["rank"];return{name:e,shaderCache:{hint:`${i.cacheKey};${h};${f};${g}`,inputDependencies:m},getRunData:()=>({outputs:[{dims:o,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(C.size(o)/64)},programUniforms:d}),getShaderSource:e=>Y0(e,s,t.dims.length,o.length,a,u,c,0,p,h,f,g)}},nw=e=>{let t=0!==e.count_include_pad,n=ew(e);if(0!==n.ceilMode)throw Error("using ceil() in shape computation is not yet supported for AveragePool");let i={countIncludePad:t,...n,cacheKey:""};return{...i,cacheKey:dC(i)}},rw=(e,t)=>{Za(e.inputs),e.compute(tw("AveragePool",e.inputs[0],!1,t))},ow={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},iw=e=>{let t=e.format;return{format:t,...ow,cacheKey:t}},aw=(e,t)=>{Za(e.inputs),e.compute(tw("GlobalAveragePool",e.inputs[0],!0,t))},sw=(e,t,n,i)=>{let[a,o]=Z0(t,i,n),s=`
      value = max(x_val, value);
    `,l="",u=N("x",t.dataType,t.dims.length),c=["rank"],[d,p,h,f,g]=J0(o,a);return d.push(...W(t.dims,o)),{name:e,shaderCache:{hint:`${i.cacheKey};${h};${f};${g}`,inputDependencies:c},getRunData:()=>({outputs:[{dims:o,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(C.size(o)/64)},programUniforms:d}),getShaderSource:e=>Y0(e,u,t.dims.length,o.length,a,s,l,10===t.dataType?-65504:-1e5,p,h,f,g)}},uw=(e,t)=>{Za(e.inputs),e.compute(sw("MaxPool",e.inputs[0],!1,t))},lw=e=>{let t=e.storage_order,n=e.dilations,i=ew(e);if(0!==t)throw Error("column major storage order is not yet supported for MaxPool");if(0!==i.ceilMode)throw Error("using ceil() in shape computation is not yet supported for MaxPool");let a={storageOrder:t,dilations:n,...i,cacheKey:""};return{...a,cacheKey:pC(a)}},cw=e=>{let t=e.format;return{format:t,...ow,cacheKey:t}},dw=(e,t)=>{Za(e.inputs),e.compute(sw("GlobalMaxPool",e.inputs[0],!0,t))}}),mw=k(()=>{le(),ge(),Xe(),ye(),hC=(e,t)=>{if(e.length<2||e.length>3)throw Error("DequantizeLinear requires 2 or 3 inputs.");if(3===e.length&&e[1].dims===e[2].dims)throw Error("x-scale and x-zero-point must have the same shape.");if(3===e.length&&e[0].dataType!==e[2].dataType)throw Error("x and x-zero-point must have the same data type.");if(6===e[0].dataType&&e.length>2)throw Error("In the case of dequantizing int32 there is no zero point.");if(0!==e[1].dims.length&&1!==e[1].dims.length&&e[1].dims.length!==e[0].dims.length)throw Error("scale input must be a scalar, a 1D tensor, or have the same rank as the input tensor.");if(e.length>2){if(e[0].dataType!==e[2].dataType)throw Error("x and x-zero-point must have the same data type.");if(e[1].dims.length!==e[2].dims.length)throw Error("scale and zero-point inputs must have the same rank.");if(!e[1].dims.map((t,n)=>t===e[2].dims[n]).reduce((e,t)=>e&&t,!0))throw Error("scale and zero-point inputs must have the same shape.")}if(t.blockSize>0){if(0===e[1].dims.length||1===e[1].dims.length&&1===e[1].dims[0])throw Error("blockSize must be set only for block quantization.");if(!e[1].dims.map((n,i)=>i===t.axis||n===e[0].dims[i]).reduce((e,t)=>e&&t,!0))throw Error("For block qunatization, scale input shape to match the input shape except for the axis");if(e[1].dims.length!==e[0].dims.length)throw Error("For block qunatization the scale input rank must be the same as the x rank.");let n=e[0].dims[t.axis],i=e[1].dims[t.axis];if(t.blockSize<Math.ceil(n/i)||t.blockSize>Math.ceil(n/(i-1)-1))throw Error("blockSize must be with in the range [ceil(dI / Si), ceil(dI / (Si - 1) - 1)].")}},mC=(e,t)=>{let n=C.normalizeAxis(t.axis,e[0].dims.length),i=e[0].dataType,a=3===i,o=e[0].dims,s=e[1].dataType,l=C.size(o),u=3===i||2===i,c=u?[Math.ceil(C.size(e[0].dims)/4)]:e[0].dims,d=e[1].dims,p=e.length>2?e[2]:void 0,h=p?u?[Math.ceil(C.size(p.dims)/4)]:p.dims:void 0,f=0===d.length||1===d.length&&1===d[0],g=!1===f&&1===d.length,m=Ee(l),y=f&&(!u||4===m),b=y?m:1,v=y&&!u?m:1,x=N("input",u?12:i,c.length,v),w=N("scale",s,d.length),_=p?N("zero_point",u?12:i,h.length):void 0,S=G("output",s,o.length,b),k=[x,w];_&&k.push(_);let T=[c,d];p&&T.push(h);let E=[{type:12,data:l/b},{type:12,data:n},{type:12,data:t.blockSize},...W(...T,o)],I=e=>{let t=[{name:"output_size",type:"u32"},{name:"axis",type:"u32"},{name:"block_size",type:"u32"}];return`
      ${e.registerUniforms(t).declareVariables(...k,S)}
      ${e.mainStart()}
          ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let output_indices = ${S.offsetToIndices("global_idx")};

          // Set input x
          ${u?`
            let input = ${x.getByOffset("global_idx / 4")};
            let x_vec = ${a?"unpack4xI8(input)":"unpack4xU8(input)"};
            let x_value = ${1===b?"x_vec[global_idx % 4]":"x_vec"};`:`let x_value = ${x.getByOffset("global_idx")};`};

          // Set scale input
          ${f?`let scale_value= ${w.getByOffset("0")}`:g?`
            let scale_index = ${S.indicesGet("output_indices","uniforms.axis")};
            let scale_value= ${w.getByOffset("scale_index")};`:`
            var scale_indices: ${w.type.indices} = output_indices;
            let index = ${w.indicesGet("scale_indices","uniforms.axis")} / uniforms.block_size;
            ${w.indicesSet("scale_indices","uniforms.axis","index")};
            let scale_value= ${w.getByIndices("scale_indices")};`};

          // Set zero-point input
          ${_?f?u?`
                let zero_point_input = ${_.getByOffset("0")};
                let zero_point_vec =  ${a?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value= zero_point_vec[0]`:`let zero_point_value = ${_.getByOffset("0")}`:g?u?`
                let zero_point_index = ${S.indicesGet("output_indices","uniforms.axis")};
                let zero_point_input = ${_.getByOffset("zero_point_index / 4")};
                let zero_point_vec =  ${a?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_index % 4]`:`
                let zero_point_index = ${S.indicesGet("output_indices","uniforms.axis")};
                let zero_point_value = ${_.getByOffset("zero_point_index")};`:u?`
                let zero_point_offset = ${w.indicesToOffset("scale_indices")};
                let zero_point_input = ${_.getByOffset("zero_point_offset / 4")};
                let zero_point_vec = ${a?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_offset % 4];`:`let zero_point_value = ${_.getByIndices("scale_indices")};`:`let zero_point_value = ${u?a?"i32":"u32":x.type.value}(0);`};
      // Compute and write output
      ${S.setByOffset("global_idx",`${S.type.value}(x_value - zero_point_value) * scale_value`)};
      }`};return{name:"DequantizeLinear",shaderCache:{hint:t.cacheKey,inputDependencies:_?["rank","rank","rank"]:["rank","rank"]},getShaderSource:I,getRunData:()=>({outputs:[{dims:o,dataType:s}],dispatchGroup:{x:Math.ceil(l/b/64),y:1,z:1},programUniforms:E})}},fw=(e,t)=>{hC(e.inputs,t),e.compute(mC(e.inputs,t))},hw=e=>ce({axis:e.axis,blockSize:e.blockSize})}),bw=k(()=>{pt(),le(),ye(),gC=(e,t,n)=>{let i=e===t,a=e<t&&n<0,o=e>t&&n>0;if(i||a||o)throw Error("Range these inputs' contents are invalid.")},bC=(e,t,n,i)=>{let a=Math.abs(Math.ceil((t-e)/n)),o=[a],s=a,l=[{type:12,data:s},{type:i,data:e},{type:i,data:n},...W(o)],u=e=>{let t=G("output",i,o.length),n=t.type.value,a=[{name:"outputSize",type:"u32"},{name:"start",type:n},{name:"delta",type:n}];return`
        ${e.registerUniforms(a).declareVariables(t)}
        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        output[global_idx] = uniforms.start + ${n}(global_idx) * uniforms.delta;
      }`};return{name:"Range",shaderCache:{hint:`${i}`},getShaderSource:u,getRunData:()=>({outputs:[{dims:o,dataType:i}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:l})}},gw=e=>{let t=0,n=0,i=0;6===e.inputs[0].dataType?(t=e.inputs[0].getInt32Array()[0],n=e.inputs[1].getInt32Array()[0],i=e.inputs[2].getInt32Array()[0]):1===e.inputs[0].dataType&&(t=e.inputs[0].getFloat32Array()[0],n=e.inputs[1].getFloat32Array()[0],i=e.inputs[2].getFloat32Array()[0]),me.webgpu.validateInputContent&&gC(t,n,i),e.compute(bC(t,n,i,e.inputs[0].dataType),{inputs:[]})}}),vw=k(()=>{le(),ge(),Xe(),ye(),yC=(e,t,n,i)=>{if("none"!==e&&"i32"!==i&&"u32"!==i&&"f32"!==i)throw Error(`Input ${i} is not supported with reduction ${e}.`);let a=`{
                var oldValue = 0;
                loop {
                  let newValueF32 =`,o=`;
                  let newValue = bitcast<i32>(newValueF32);
                  let res = atomicCompareExchangeWeak(&${t}, oldValue, newValue);
                  if res.exchanged {
                    break;
                  }
                  oldValue = res.old_value;
                }
              }`;switch(e){case"none":return`${t}=${n};`;case"add":return"i32"===i||"u32"===i?`atomicAdd(&${t}, bitcast<${i}>(${n}));`:`
              ${a}bitcast<${i}>(oldValue) + (${n})${o}`;case"max":return"i32"===i||"u32"===i?`atomicMax(&${t}, bitcast<${i}>(${n}));`:`
                ${a}max(bitcast<f32>(oldValue), (${n}))${o}`;case"min":return"i32"===i||"u32"===i?`atomicMin(&${t}, bitcast<${i}>(${n}));`:`${a}min(bitcast<${i}>(oldValue), (${n}))${o}`;case"mul":return`${a}(bitcast<${i}>(oldValue) * (${n}))${o}`;default:throw Error(`Reduction ${e} is not supported.`)}},_C=(e,t)=>{let n=e[0].dims,i=e[1].dims,a=n,o=1,s=Math.ceil(C.sizeToDimension(i,i.length-1)/o),l=i[i.length-1],u=C.sizeFromDimension(n,l),c=[{type:12,data:s},{type:12,data:l},{type:12,data:u},...W(e[1].dims,e[2].dims,a)],d=n=>{let i=N("indices",e[1].dataType,e[1].dims.length),s=N("updates",e[2].dataType,e[2].dims.length,o),l="none"!==t.reduction&&""!==t.reduction?jy("output",e[0].dataType,a.length):G("output",e[0].dataType,a.length,o);return`
      ${n.registerUniform("output_size","u32").registerUniform("last_index_dimension","u32").registerUniform("num_updates_elements","u32").declareVariables(i,s,l)}
      ${n.mainStart()}
        ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
  var data_offset = 0u;
  let indices_start = uniforms.last_index_dimension * global_idx;
  let indices_end = indices_start + uniforms.last_index_dimension;
  for (var i = indices_start; i < indices_end; i++) {
    var index = i32(indices[i].x);
    ${1===e[0].dims.length?`
    let element_count_dim = uniforms.output_strides;
    let dim_value = uniforms.output_shape;`:`
    let element_count_dim = uniforms.output_strides[i - indices_start];
    let dim_value = uniforms.output_shape[i - indices_start];`}
    if (index >= 0) {
      if (index >= i32(dim_value)) {
        index = i32(dim_value - 1);
      }
    } else {
      if (index < -i32(dim_value)) {
        index = 0;
      } else {
        index += i32(dim_value);
      }
    }
    data_offset += u32((u32(index) * element_count_dim));
  }

  for (var i = 0u; i < uniforms.num_updates_elements; i++) {
    let value = updates[uniforms.num_updates_elements * global_idx + i];
    ${yC(t.reduction,"output[data_offset + i]","value",l.type.value)}
  }

      }`};return{name:"ScatterND",shaderCache:{hint:`${t.cacheKey}_${t.reduction}`,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:c}),getShaderSource:d}},yw=e=>ce({reduction:e.reduction}),_w=(e,t)=>{e.compute(_C(e.inputs,t),{inputs:[e.inputs[1],e.inputs[2]],outputs:[]})}}),Sw=k(()=>{le(),ge(),Xe(),ye(),vC=(e,t)=>{if(e.every(e=>e>0||(()=>{throw Error("Resize requires scales input values to be positive")})),e.length>0){if("linear"===t.mode){if(2!==e.length&&3!==e.length&&(4!==e.length||1!==e[0]||1!==e[1])&&(4!==e.length||1!==e[0]||1!==e[3])&&(5!==e.length||1!==e[0]||1!==e[1]))throw Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and
            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if("cubic"===t.mode&&2!==e.length&&(4!==e.length||1!==e[0]||1!==e[1])&&(4!==e.length||1!==e[0]||1!==e[3]))throw Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},wC=(e,t,n)=>{t.every(e=>e>=0&&e<n||(()=>{throw Error("Resize requires axes input values to be positive and less than rank")}));let i=Array(n).fill(1);return t.forEach((t,n)=>i[t]=e[n]),i},xC=(e,t,n,i,a,o)=>{let[s,l,u]=n>10?[1,2,3]:[-1,e.length>1?1:-1,-1],c=e[0].dims.length;if(s>0&&e.length>s&&e[s].dims.length>0)e[s].getFloat32Array().forEach(e=>o.push(e));else if("tf_crop_and_resize"===t.coordinateTransformMode)throw Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(l>0&&e.length>l&&1===e[l].dims.length&&e[l].dims[0]>0){if(e[l].getFloat32Array().forEach(e=>i.push(e)),0!==i.length&&i.length!==c&&n>=18&&i.length!==t.axes.length)throw Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");vC(i,t),t.axes.length>0&&wC(i,t.axes,c).forEach((e,t)=>i[t]=e)}if(u>0&&e.length>u&&1===e[u].dims.length&&e[u].dims[0]>0&&(e[u].getBigInt64Array().forEach(e=>a.push(Number(e))),0!==a.length&&a.length!==c&&n>=18&&a.length!==t.axes.length))throw Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(0!==i.length&&i.length!==t.axes.length)throw Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(0!==a.length&&a.length!==t.axes.length)throw Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if("u">typeof i&&"u">typeof a&&i.length>0&&a.length>c)throw Error("Resize requires only of scales or sizes to be specified")},ww=(e,t,n,i)=>`
  // The whole part and the fractional part are calculated separately due to inaccuracy of floating
  // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an
  // offset-by-one error later in floor().
  let big = (${e}) * (${t});
  let whole = ${i}(big / (${n}));
  let fract = ${i}(big % (${n})) / ${i}(${n});
  return whole + fract;
`,TC=(e,t)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,
     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${t} { `+(()=>{switch(e){case"asymmetric":return`
          if (xScale < 1.0 || floor(xScale) != xScale) {
            return ${t}(xResized) / ${t}(xScale);
          } else {
            ${ww("xResized","lengthOriginal","lengthResized",t)}
          }
        `;case"pytorch_half_pixel":return`if (lengthResized > 1) {
                    return (${t}(xResized) + 0.5) / ${t}(xScale) - 0.5;
                  } else {
                    return 0.0;
                  }`;case"tf_half_pixel_for_nn":return`return (${t}(xResized) + 0.5) / ${t}(xScale);`;case"align_corners":return`if (lengthResized == 1) {
                    return 0.0;
                  } else {
                    ${ww("xResized","lengthOriginal - 1","lengthResized - 1",t)}
                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {
                    return ${t}(roiStart) * ${t}(lengthOriginal - 1) +
                        (${t}(xResized) * ${t}(roiEnd - roiStart) * ${t}(lengthOriginal - 1)) /
                        ${t}(lengthResized - 1);
                  } else {
                    return 0.5 * ${t}(roiStart + roiEnd) * ${t}(lengthOriginal - 1);
                  }`;case"half_pixel_symmetric":return`const outputWidth = ${t}xScale * ${t}(lengthResized);
                  const adjustment = ${t}(lengthResized) / outputWidth;
                  const center = ${t}(lengthOriginal) / 2;
                  const offset = center * (1 - adjustment);
                  return offset + ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;case"half_pixel":return`return ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;default:throw Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",IC=(e,t,n)=>`fn getNearestPixelFromOriginal(xOriginal: ${n}, isDownSample: bool) -> ${n} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw Error(`Nearest mode ${e} is not supported`)}})()+"}",SC=(e,t,n)=>{let i=Array(n).fill(0).concat(Array(n).fill(1)),a=0===e.length?i:e.slice();return t.length>0?(t.forEach((e,o)=>{i[e]=a[o],i[o+n]=a[t.length+o]}),i):a},$C=(e,t,n,i)=>{let a=[];if(n.length>0)if(i.length>0){if(e.forEach(e=>a.push(e)),Math.max(...i)>e.length)throw Error("axes is out of bound");i.forEach((e,t)=>a[e]=n[t])}else n.forEach(e=>a.push(e));else{if(0===t.length)throw Error("Resize requires either scales or sizes.");a=e.map((e,n)=>Math.round(e*t[n]))}return a},AC=(e,t,n)=>{let i=(()=>{switch(n.keepAspectRatioPolicy){case"not_larger":return n.axes.length>0?Math.min(...n.axes.map(e=>t[e]),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return n.axes.length>0?Math.max(...n.axes.map(e=>t[e]),5e-324):Math.max(...t,5e-324);default:throw Error(`Keep aspect ratio policy ${n.keepAspectRatioPolicy} is not supported`)}})();t.fill(1,0,t.length);let a=e.slice();return n.axes.length>0?(n.axes.forEach(e=>t[e]=i),n.axes.forEach(n=>a[n]=Math.round(e[n]*t[n]))):(t.fill(i,0,t.length),a.forEach((e,n)=>a[n]=Math.round(e*t[n]))),a},OC=(e,t,n,i,a)=>`
    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${n.length}> {
      var original_indices: array<${e.type.value}, ${n.length}>;
      for (var i:u32 = 0; i < ${n.length}; i++) {
        var output_index = ${e.indicesGet("output_indices","i")};
        var scale = ${Q("uniforms.scales","i",i)};
        var roi_low = ${Q("uniforms.roi","i",a)};
        var roi_hi = ${Q("uniforms.roi",`i + ${t.length}`,a)};
        if (scale == 1.0) {
          original_indices[i] = ${e.type.value}(output_index);
        } else {
          var input_shape_i = ${Q("uniforms.input_shape","i",t.length)};
          var output_shape_i = ${Q("uniforms.output_shape","i",n.length)};
          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                           input_shape_i, roi_low, roi_hi);
        }
      }
      return original_indices;
    }`,PC=(e,t,n,i,a,o,s)=>`
    fn calculateInputIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {
      var input_indices: ${e.type.indices};
      for (var i:u32 = 0; i < ${i.length}; i++) {
        var output_index = ${t.indicesGet("output_indices","i")};
        var input_index: u32;
        var scale = ${Q("uniforms.scales","i",a)};
        if (scale == 1.0) {
          input_index = output_index;
        } else {
          var roi_low = ${Q("uniforms.roi","i",o)};
          var roi_hi = ${Q("uniforms.roi",`i + ${n.length}`,o)};
          var input_shape_i = ${Q("uniforms.input_shape","i",n.length)};
          var output_shape_i = ${Q("uniforms.output_shape","i",i.length)};
          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                        input_shape_i, roi_low, roi_hi);
          if (!${s} || (original_idx >= 0 && original_idx < ${t.type.value}(input_shape_i))) {
            if (original_idx < 0) {
              input_index = 0;
            } else if (original_idx > ${t.type.value}(input_shape_i - 1)) {
              input_index = input_shape_i - 1;
            } else {
              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));
            }
          } else {
            input_index = u32(original_idx);
          }
        }
        ${e.indicesSet("input_indices","i","input_index")}
      }
      return input_indices;
    }`,EC=(e,t)=>`
    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {
      for (var i:u32 = 0; i < ${t.length}; i++) {
        var input_index = ${e.indicesGet("input_indices","i")};
        if (input_index < 0 || input_index >= ${Q("uniforms.input_shape","i",t.length)}) {
          return false;
        }
      }
      return true;
    }`,xw=(e,t,n,i)=>e.rank>i?`
    ${e.indicesSet("input_indices",t,"channel")};
    ${e.indicesSet("input_indices",n,"batch")};
`:"",CC=(e,t,n,i,a)=>{let[o,s,l,u]=2===n.length?[-1,0,1,-1]:[0,2,3,1],c=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${c} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",s,`max(0, min(row, ${n[s]} - 1))`)};
      ${e.indicesSet("input_indices",l,`max(0, min(col, ${n[l]} - 1))`)};
      ${xw(e,u,o,2)}
      return ${e.getByIndices("input_indices")};
    }

    fn bilinearInterpolation(output_indices: ${t.type.indices}) -> ${c} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var row:${c} = originalIndices[${s}];
      var col:${c} = originalIndices[${l}];
      ${i?`if (row < 0 || row > (${n[s]} - 1) || col < 0 || col > (${n[l]} - 1)) {
        return ${a};
      }`:""};
      row = max(0, min(row, ${n[s]} - 1));
      col = max(0, min(col, ${n[l]} - 1));
      var row1: u32 = u32(row);
      var col1: u32 = u32(col);
      var row2: u32 = u32(row + 1);
      var col2: u32 = u32(col + 1);
      var channel: u32 = ${n.length>2?`u32(originalIndices[${u}])`:"0"};
      var batch: u32 =  ${n.length>2?`u32(originalIndices[${o}])`:"0"};
      var x11: ${c} = getInputValue(batch, channel, row1, col1);
      var x12: ${c} = getInputValue(batch, channel, row1, col2);
      var x21: ${c} = getInputValue(batch, channel, row2, col1);
      var x22: ${c} = getInputValue(batch, channel, row2, col2);
      var dx1: ${c} = abs(row - ${c}(row1));
      var dx2: ${c} = abs(${c}(row2) - row);
      var dy1: ${c} = abs(col - ${c}(col1));
      var dy2: ${c} = abs(${c}(col2) - col);
      if (row1 == row2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (col1 == col2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);
    }`},DC=(e,t,n,i,a,o,s,l,u,c)=>{let d=2===n.length,p=!0,[h,f]=d?[0,1]:p?[2,3]:[1,2],g=e.type.value,m=s=>{let d=s===h?"row":"col";return`
      fn ${d}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${t.type.indices}) -> ${g} {
        var output_index = ${t.indicesGet("output_indices",s)};
        var originalIdx: ${g} = getOriginalCoordinateFromResizedCoordinate(output_index, ${a[s]},
        ${i[s]}, ${n[s]}, ${o[s]}, ${o[s]} + ${n.length});
        var fractOriginalIdx: ${g} = originalIdx - floor(originalIdx);
        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);

        if (${l} && (originalIdx < 0 || originalIdx > (${n[s]} - 1))) {
          return ${u};
        }
        var data: array<${g}, 4> = array<${g}, 4>(0.0, 0.0, 0.0, 0.0);
        for (var i: i32 = -1; i < 3; i++) {
          var ${d}: ${g} = originalIdx + ${g}(i);
          if (${d} < 0 || ${d} >= ${n[s]}) {
            ${c?`coefs[i + 1] = 0.0;
                        continue;`:l?`return ${u};`:`${d} = max(0, min(${d}, ${n[s]} - 1));`};
          }
        var input_indices_copy: ${e.type.indices} = input_indices;
          ${e.indicesSet("input_indices_copy",s,`u32(${d})`)};
          data[i + 1] = ${s===h?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};
        }
        return cubicInterpolation1D(data, coefs);
      }`};return`
    ${m(h)};
    ${m(f)};
  fn getCubicInterpolationCoefs(s: ${g}) -> array<${g}, 4> {
    var absS = abs(s);
    var coeffs: array<${g}, 4> = array<${g}, 4>(0.0, 0.0, 0.0, 0.0);
    var oneMinusAbsS: ${g} = 1.0 - absS;
    var twoMinusAbsS: ${g} = 2.0 - absS;
    var onePlusAbsS: ${g} = 1.0 + absS;
    coeffs[0] = ((${s} * onePlusAbsS - 5 * ${s}) * onePlusAbsS + 8 * ${s}) * onePlusAbsS - 4 * ${s};
    coeffs[1] = ((${s} + 2) * absS - (${s} + 3)) * absS * absS + 1;
    coeffs[2] = ((${s} + 2) * oneMinusAbsS - (${s} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;
    coeffs[3] = ((${s} * twoMinusAbsS - 5 * ${s}) * twoMinusAbsS + 8 * ${s}) * twoMinusAbsS - 4 * ${s};
    return coeffs;
  }

  fn cubicInterpolation1D(x: array<${g}, 4>, coefs: array<${g}, 4>) -> ${g} {
    var coefsSum: ${g} = coefs[0] + coefs[1] + coefs[2] + coefs[3];
    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;
  }

  fn bicubicInterpolation(output_indices: ${t.type.indices}) -> ${g} {
    var input_indices: ${e.type.indices} = output_indices;
    return colCubicInterpolation(input_indices, output_indices);
  }
    `},kC=(e,t,n,i,a)=>{let[o,s,l,u,c]=3===n.length?[-1,0,1,2,-1]:[0,2,3,4,1],d=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${d} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",s,`max(0, min(depth, ${n[s]} - 1))`)};
      ${e.indicesSet("input_indices",l,`max(0, min(height, ${n[l]} - 1))`)};
      ${e.indicesSet("input_indices",u,`max(0, min(width, ${n[u]} - 1))`)};
      ${xw(e,c,o,3)}
      return ${e.getByIndices("input_indices")};
    }

    fn trilinearInterpolation(output_indices: ${t.type.indices}) -> ${d} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var depth:${d} = originalIndices[${s}];
      var height:${d} = originalIndices[${l}];
      var width:${d} = originalIndices[${u}];
      ${i?`if (depth < 0 || depth > (${n[s]} - 1) || height < 0 || height > (${n[l]} - 1) || width < 0 || (width > ${n[u]} - 1)) {
      return ${a};
        }`:""};

    depth = max(0, min(depth, ${n[s]} - 1));
      height = max(0, min(height, ${n[l]} - 1));
      width = max(0, min(width, ${n[u]} - 1));
      var depth1: u32 = u32(depth);
      var height1: u32 = u32(height);
      var width1: u32 = u32(width);
      var depth2: u32 = u32(depth + 1);
      var height2: u32 = u32(height + 1);
      var width2: u32 = u32(width + 1);
      var channel: u32 = ${n.length>3?`u32(originalIndices[${c}])`:"0"};
      var batch: u32 =  ${n.length>3?`u32(originalIndices[${o}])`:"0"};

      var x111: ${d} = getInputValue(batch, channel, depth1, height1, width1);
      var x112: ${d} = getInputValue(batch, channel, depth1, height1, width2);
      var x121: ${d} = getInputValue(batch, channel, depth1, height2, width1);
      var x122: ${d} = getInputValue(batch, channel, depth1, height2, width2);
      var x211: ${d} = getInputValue(batch, channel, depth2, height1, width1);
      var x212: ${d} = getInputValue(batch, channel, depth2, height1, width2);
      var x221: ${d} = getInputValue(batch, channel, depth2, height2, width1);
      var x222: ${d} = getInputValue(batch, channel, depth2, height2, width2);
      var dx1: ${d} = abs(depth - ${d}(depth1));
      var dx2: ${d} = abs(${d}(depth2) - depth);
      var dy1: ${d} = abs(height - ${d}(height1));
      var dy2: ${d} = abs(${d}(height2) - height);
      var dz1: ${d} = abs(width - ${d}(width1));
      var dz2: ${d} = abs(${d}(width2) - width);
      if (depth1 == depth2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (height1 == height2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      if (width1 == width2) {
        dz1 = 0.5;
        dz2 = 0.5;
      }
      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +
              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);
    }`},NC=(e,t,n,i,a,o)=>{let s=e.dims,l=SC(o,t.axes,s.length),u=$C(s,i,a,t.axes),c=i.slice();0===i.length&&(c=s.map((e,t)=>0===e?1:u[t]/e),"stretch"!==t.keepAspectRatioPolicy&&(u=AC(s,c,t)));let d=G("output",e.dataType,u.length),p=N("input",e.dataType,s.length),h=C.size(u),f=s.length===u.length&&s.every((e,t)=>e===u[t]),g="tf_crop_and_resize"===t.coordinateTransformMode,m=t.extrapolationValue,y=p.type.value,b=e=>`
      ${f?"":`
      ${TC(t.coordinateTransformMode,y)};
      ${(()=>{switch(t.mode){case"nearest":return`
              ${EC(p,s)};
              ${IC(t.nearestMode,n,y)};
              ${PC(p,d,s,u,c.length,l.length,g)};
              `;case"linear":return`
              ${OC(d,s,u,c.length,l.length)};
              ${(()=>{if(2===s.length||4===s.length)return`${CC(p,d,s,g,m)}`;if(3===s.length||5===s.length)return`${kC(p,d,s,g,m)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};
            `;case"cubic":return`
            ${(()=>{if(2===s.length||4===s.length)return`${DC(p,d,s,u,c,l,t.cubicCoeffA,g,t.extrapolationValue,t.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};
            `;default:throw Error("Invalid resize mode")}})()};
      `}
      ${e.registerUniform("output_size","u32").registerUniform("scales","f32",c.length).registerUniform("roi","f32",l.length).declareVariables(p,d)}
      ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
        ${f?"output[global_idx] = input[global_idx];":`
        let output_indices = ${d.offsetToIndices("global_idx")};
        var input_indices: ${p.type.indices};
        ${(()=>{switch(t.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);
                if (checkInputIndices(input_indices)) {
                  output[global_idx] = ${p.getByIndices("input_indices")};
                } else {
                  output[global_idx] = ${t.extrapolationValue};
                }`;case"linear":return`output[global_idx] = ${2===s.length||4===s.length?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${t.mode}`)}})()};
`}
      }`;return{name:"Resize",shaderCache:{hint:`${t.cacheKey}|${n}|${c.length>0?"cubic"===t.mode?c:c.length:""}|${a.length>0?a:""}|${l.length>0?l:""}|${f}|${"nearest"===t.mode?s.length:s}`,inputDependencies:["rank"]},getShaderSource:b,getRunData:()=>({outputs:[{dims:u,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:[{type:12,data:h},{type:1,data:c},{type:1,data:l},...W(s,u)]})}},LC=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},Tw=(e,t)=>{let n=[],i=[],a=[],o=LC(e);if(0!==t.antialias)throw Error("Only default value (0) for Antialias attribute is supported");xC(e.inputs,t,o,n,i,a),e.compute(NC(e.inputs[0],t,o,n,i,a),{inputs:[0]})},Iw=e=>{let t=e.antialias,n=e.axes,i=e.coordinateTransformMode,a=e.cubicCoeffA,o=0!==e.excludeOutside,s=e.extrapolationValue,l=e.keepAspectRatioPolicy,u=e.mode,c=""===e.nearestMode?"simple":e.nearestMode;return ce({antialias:t,axes:n,coordinateTransformMode:i,cubicCoeffA:a,excludeOutside:o,extrapolationValue:s,keepAspectRatioPolicy:l,mode:u,nearestMode:c})}}),Aw=k(()=>{le(),ge(),ye(),RC=e=>{if(!e||e.length<3)throw Error("layerNorm requires at least 3 inputs.");let t=e[0],n=e[1],i=e[2];if(t.dataType!==n.dataType||t.dataType!==i.dataType)throw Error("All inputs must have the same data type");if(3!==t.dims.length&&2!==t.dims.length)throw Error("Input must be 2D or 3D");if(3!==n.dims.length&&2!==n.dims.length)throw Error("Skip must be 2D or 3D");let a=t.dims[t.dims.length-1],o=t.dims[t.dims.length-2];if(n.dims[n.dims.length-1]!==a)throw Error("Skip must have the same hidden size as input");if(n.dims[n.dims.length-2]!==o)throw Error("Skip must have the same sequence length as input");if(1!==i.dims.length)throw Error("Gamma must be 1D");if(i.dims[i.dims.length-1]!==a)throw Error("Gamma must have the same hidden size as input");if(e.length>3){let t=e[3];if(1!==t.dims.length)throw Error("Beta must be 1D");if(t.dims[t.dims.length-1]!==a)throw Error("Beta must have the same hidden size as input")}if(e.length>4){let t=e[4];if(1!==t.dims.length)throw Error("Bias must be 1D");if(t.dims[t.dims.length-1]!==a)throw Error("Bias must have the same hidden size as input")}},zC=(e,t,n,i)=>{let a=t.simplified,o=e[0].dims,s=C.size(o),l=o,u=s,c=o.slice(-1)[0],d=i?o.slice(0,-1).concat(1):[],p=!a&&e.length>3,h=e.length>4,f=i&&n>1,g=i&&n>2,m=n>3,y=64,b=Ee(c),v=[{type:12,data:u},{type:12,data:b},{type:12,data:c},{type:1,data:t.epsilon}],x=t=>{let n=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],i=[N("x",e[0].dataType,e[0].dims,b),N("skip",e[1].dataType,e[1].dims,b),N("gamma",e[2].dataType,e[2].dims,b)];p&&i.push(N("beta",e[3].dataType,e[3].dims,b)),h&&i.push(N("bias",e[4].dataType,e[4].dims,b)),i.push(G("output",e[0].dataType,l,b)),f&&i.push(G("mean_output",1,d)),g&&i.push(G("inv_std_output",1,d)),m&&i.push(G("input_skip_bias_sum",e[0].dataType,l,b));let o=Ve(e[0].dataType),s=Ve(1,b);return`

      ${t.registerUniforms(n).declareVariables(...i)}
      var<workgroup> sum_shared : array<${s}, ${y}>;
      var<workgroup> sum_squared_shared : array<${s}, ${y}>;

      ${t.mainStart([y,1,1])}
        let ix = local_id.x;
        let iy = global_id.x / ${y};

        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;
        var stride = hidden_size_vectorized / ${y};
        let offset = ix * stride + iy * hidden_size_vectorized;
        let offset1d = stride * ix;
        if (ix == ${y-1}) {
          stride = hidden_size_vectorized - stride * ix;
        }
        for (var i: u32 = 0; i < stride; i++) {
          let skip_value = skip[offset + i];
          let bias_value = ${h?"bias[offset1d + i]":o+"(0.0)"};
          let input_value = x[offset + i];
          let value = input_value + skip_value + bias_value;
          ${m?"input_skip_bias_sum[offset + i] = value;":""}
          output[offset + i] = value;
          let f32_value = ${Hr(o,b,"value")};
          sum_shared[ix] += f32_value;
          sum_squared_shared[ix] += f32_value * f32_value;
        }
        workgroupBarrier();

        var reduce_size : u32 = ${y};
        for (var curr_size = reduce_size >> 1;  curr_size > 0; curr_size = reduce_size >> 1) {
          reduce_size = curr_size + (reduce_size & 1);
          if (ix < curr_size) {
            sum_shared[ix] += sum_shared[ix + reduce_size];
            sum_squared_shared[ix] += sum_squared_shared[ix + reduce_size];
          }
          workgroupBarrier();
        }

        let sum = sum_shared[0];
        let square_sum = sum_squared_shared[0];
        let mean = ${Kt("sum",b)} / f32(uniforms.hidden_size);
        let inv_std_dev = inverseSqrt(${Kt("square_sum",b)} / f32(uniforms.hidden_size) ${a?"":"- mean * mean"} + uniforms.epsilon);
        ${f?"mean_output[global_idx] = mean;":""}
        ${g?"inv_std_output[global_idx] = inv_std_dev;":""}

        for (var i: u32 = 0; i < stride; i++) {
          output[offset + i] = (output[offset + i] ${a?"":`- ${o}(mean)`}) *
            ${o}(inv_std_dev) * gamma[offset1d + i]
            ${p?"+ beta[offset1d + i]":""};
        }
      }`},w=[{dims:l,dataType:e[0].dataType}];return n>1&&w.push({dims:d,dataType:1}),n>2&&w.push({dims:d,dataType:1}),n>3&&w.push({dims:o,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${b};${f};${g};${m}`,inputDependencies:e.map((e,t)=>"type")},getShaderSource:x,getRunData:()=>({outputs:w,dispatchGroup:{x:Math.ceil(u/c)},programUniforms:v})}},$w=(e,t)=>{RC(e.inputs);let n=[0];e.outputCount>1&&n.push(-3),e.outputCount>2&&n.push(-3),e.outputCount>3&&n.push(3),e.compute(zC(e.inputs,t,e.outputCount,!1),{outputs:n})}}),Cw=k(()=>{le(),ge(),Xe(),ye(),MC=(e,t)=>{if(!e||e.length<1)throw Error("too few inputs");if(0!==t.axes.length){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw Error("starts and ends must have the same length");e.slice(1).forEach((t,n)=>{if(6!==e[n+1].dataType&&7!==e[n+1].dataType)throw Error(`Input ${n} must be an array of int32 or int64`)})},Ja=(e,t)=>{let n=[];if(e.length>t)if(7===e[t].dataType)e[t].getBigInt64Array().forEach(e=>n.push(Number(e)));else if(6===e[t].dataType)e[t].getInt32Array().forEach(e=>n.push(Number(e)));else throw Error(`Input ${t} must be an array of int32 or int64`);return n},BC=(e,t)=>{if(!(e.length>1))return t;{let t=Ja(e,1),n=Ja(e,2),i=Ja(e,3);return 0===i.length&&(i=[...Array(e[0].dims.length).keys()]),ce({starts:t,ends:n,axes:i})}},Ow=(e,t,n,i,a)=>{let o=e;return e<0&&(o+=n[i[t]]),a[t]<0?Math.max(0,Math.min(o,n[i[t]]-1)):Math.max(0,Math.min(o,n[i[t]]))},FC=(e,t,n)=>`fn calculateInputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {
          var input_indices: ${e.type.indices};
          var carry = 0u;
          for (var i = ${n.length-1}; i >= 0; i--) {
            let input_shape_i = ${Q("uniforms.input_shape","i",n.length)};
            let steps_i = ${Q("uniforms.steps","i",n.length)};
            let signs_i = ${Q("uniforms.signs","i",n.length)};
            let starts_i = ${Q("uniforms.starts","i",n.length)};
            var output_index = ${t.indicesGet("output_indices","i")};
            var input_index = output_index * steps_i + starts_i + carry;
            carry = input_index / input_shape_i;
            input_index = input_index % input_shape_i;
            if (signs_i < 0) {
              input_index = input_shape_i - input_index - 1u + starts_i;
            }
            ${e.indicesSet("input_indices","i","input_index")};
          }
          return input_indices;
      }`,VC=(e,t)=>{let n=e[0].dims,i=C.size(n),a=t.axes.length>0?C.normalizeAxes(t.axes,n.length):[...Array(n.length).keys()],o=Ja(e,4);o.forEach(e=>0!==e||(()=>{throw Error("step cannot be 0")})),0===o.length&&(o=Array(a.length).fill(1));let s=t.starts.map((e,t)=>Ow(e,t,n,a,o)),l=t.ends.map((e,t)=>Ow(e,t,n,a,o));if(a.length!==s.length||a.length!==l.length)throw Error("start, ends and axes should have the same number of elements");if(a.length!==n.length)for(let e=0;e<n.length;++e)a.includes(e)||(s.splice(e,0,0),l.splice(e,0,n[e]),o.splice(e,0,1));let u=o.map(e=>Math.sign(e));o.forEach((e,t,n)=>{if(e<0){let i=(l[t]-s[t])/e,a=s[t],u=a+i*o[t];s[t]=u,l[t]=a,n[t]=-e}});let c=n.slice(0);a.forEach((e,t)=>{c[e]=Math.ceil((l[e]-s[e])/o[e])});let d={dims:c,dataType:e[0].dataType},p=G("output",e[0].dataType,c.length),h=N("input",e[0].dataType,e[0].dims.length),f=C.size(c),g=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:s.length},{name:"signs",type:"i32",length:u.length},{name:"steps",type:"u32",length:o.length}],m=[{type:12,data:f},{type:12,data:s},{type:6,data:u},{type:12,data:o},...W(e[0].dims,c)],y=e=>`
      ${e.registerUniforms(g).declareVariables(h,p)}
        ${FC(h,p,n)}
        ${e.mainStart()}
          ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
          let output_indices = ${p.offsetToIndices("global_idx")};
          let input_indices = calculateInputIndices(output_indices);
          ${p.setByOffset("global_idx",h.getByIndices("input_indices"))}
      }`;return{name:"Slice",shaderCache:{hint:`${u.length}_${s.length}_${o.length}`,inputDependencies:["rank"]},getShaderSource:y,getRunData:()=>({outputs:[d],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:m})}},Pw=(e,t)=>{MC(e.inputs,t);let n=BC(e.inputs,t);e.compute(VC(e.inputs,n),{inputs:[0]})},Ew=e=>{let t=e.starts,n=e.ends,i=e.axes;return ce({starts:t,ends:n,axes:i})}}),Nw=k(()=>{le(),ge(),Xe(),Yn(),ye(),GC=e=>{if(!e||1!==e.length)throw Error("Softmax op requires 1 input.")},UC=(e,t)=>{let n=e.inputs[0],i=n.dims,a=C.size(i),o=i.length,s=C.normalizeAxis(t.axis,o),l=s<i.length-1,u,c=[];l?((c=Array.from({length:o},(e,t)=>t))[s]=o-1,c[o-1]=s,u=e.compute(at(n,c),{inputs:[n],outputs:[-1]})[0]):u=n;let d=u.dims,p=d[o-1],h=a/p,f=Ee(p),g=p/f,m=64;1===h&&(m=256);let y=(e,t)=>4===t?`max(max(${e}.x, ${e}.y), max(${e}.z, ${e}.w))`:2===t?`max(${e}.x, ${e}.y)`:3===t?`max(max(${e}.x, ${e}.y), ${e}.z)`:e,b=N("x",u.dataType,u.dims,f),v=G("result",u.dataType,u.dims,f),x=b.type.value,w="f32"===Ve(u.dataType)?`var threadMax = ${x}(-3.402823e+38f);`:`var threadMax = ${x}(-65504.0h);`,_=e=>`
      var<workgroup> rowMaxShared : ${x};
      var<workgroup> rowSumShared : ${x};
      var<workgroup> threadShared : array<${x}, ${m}>;

      fn getValue(row: i32, col: i32, row_stride: i32) -> ${x} {
        let index = row * row_stride + col;
        return x[index];
      }

      fn setValue(row: i32, col: i32, row_stride: i32, value: ${x}) {
        let index = row * row_stride + col;
        result[index] = value;
      }
      ${e.registerUniform("packedCols","i32").declareVariables(b,v)}
      ${e.mainStart(m)}
        let gindex = i32(global_idx);
        let lindex = i32(local_idx);
        const wg = ${m};
        let row = gindex / wg;
        let cols = uniforms.packedCols;
        let row_stride : i32 = uniforms.packedCols;

        // find the rows max
        ${w}
        for (var col = lindex; col < cols; col += wg) {
          let value = getValue(row, col, row_stride);
          threadMax = max(threadMax, value);
        }
        if (lindex < cols) {
          threadShared[lindex] = threadMax;
        }
        workgroupBarrier();

        var reduceSize = min(cols, wg);
        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
          reduceSize = currSize + (reduceSize & 1);
          if (lindex < currSize) {
            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowMaxShared = ${x}(${y("threadShared[0]",f)});
        }
        workgroupBarrier();

        // find the rows sum
        var threadSum = ${x}(0.0);
        for (var col = lindex; col < cols; col += wg) {
          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);
          threadSum += subExp;
        }
        threadShared[lindex] = threadSum;
        workgroupBarrier();

        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {
          if (lindex < currSize) {
            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowSumShared = ${x}(${Kt("threadShared[0]",f)});
        }
        workgroupBarrier();

        // calculate final value for each element in the row
        for (var col = lindex; col < cols; col += wg) {
          var value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;
          // max operation protects against NaN since all values should be >=0
          value = max(value, ${x}(0.0));
          setValue(row, col, row_stride, value);
        }
      }`,S=e.compute({name:"Softmax",shaderCache:{hint:`${f};${m}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:d,dataType:u.dataType}],dispatchGroup:{x:h},programUniforms:[{type:6,data:g}]}),getShaderSource:_},{inputs:[u],outputs:[l?-1:0]})[0];l&&e.compute(at(S,c),{inputs:[S]})},Dw=(e,t)=>{GC(e.inputs),UC(e,t)},kw=e=>ce({axis:e.axis})}),zw=k(()=>{le(),ge(),ye(),Lw=e=>Array.from(e.getBigInt64Array(),Number),WC=e=>{if(!e||2!==e.length)throw Error("Tile requires 2 inputs.");if(1!==e[0].dataType&&10!==e[0].dataType&&6!==e[0].dataType&&12!==e[0].dataType)throw Error("Tile only support float, float16, int32, and uint32 data types");if(7!==e[1].dataType)throw Error("Tile `repeats` input should be of int64 data type");if(1!==e[1].dims.length)throw Error("Tile `repeats` input should be 1-D");if(Lw(e[1]).length!==e[0].dims.length)throw Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},HC=(e,t)=>{let n=[];for(let i=0;i<e.length;++i)n.push(e[i]*t[i]);return n},jC=(e,t)=>{let n=e[0].dims,i=t??Lw(e[1]),a=HC(n,i),o=C.size(a),s=e[0].dataType,l=N("input",s,n.length),u=G("output",s,a.length);return{name:"Tile",shaderCache:{hint:`${i}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:[{type:12,data:o},...W(e[0].dims,a)]}),getShaderSource:e=>`
      const inputShape = ${l.indices(...n)};
      ${e.registerUniform("output_size","u32").declareVariables(l,u)}
      ${e.mainStart()}
      ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let output_indices = ${u.offsetToIndices("global_idx")};
      var input_indices: ${l.type.indices};
      for (var i = 0; i < ${n.length}; i++) {
        let input_dim_i = ${l.indicesGet("uniforms.input_shape","i")};
        let input_dim_value = ${u.indicesGet("output_indices","i")}  % input_dim_i;

        ${l.indicesSet("input_indices","i","input_dim_value")}
      }
      ${u.setByOffset("global_idx",l.getByIndices("input_indices"))}
    }`}},Rw=e=>{WC(e.inputs),e.compute(jC(e.inputs),{inputs:[0]})}}),Bw=k(()=>{le(),ge(),ye(),qC=(e,t,n,i,a)=>{let o=G("output_data",a,n.length,4),s=N("a_data",t[1].dataType,t[1].dims.length,4),l=N("b_data",t[2].dataType,t[2].dims.length,4),u=N("c_data",t[0].dataType,t[0].dims.length,4),c,d=(e,t,n)=>`select(${t}, ${e}, ${n})`;if(i){let e=(e,t,n="")=>{let i=`a_data[index_a${t}][component_a${t}]`,a=`b_data[index_b${t}][component_b${t}]`,c=`bool(c_data[index_c${t}] & (0xffu << (component_c${t} * 8)))`;return`
            let output_indices${t} = ${o.offsetToIndices(`global_idx * 4u + ${t}u`)};
            let offset_a${t} = ${s.broadcastedIndicesToOffset(`output_indices${t}`,o)};
            let offset_b${t} = ${l.broadcastedIndicesToOffset(`output_indices${t}`,o)};
            let offset_c${t} = ${u.broadcastedIndicesToOffset(`output_indices${t}`,o)};
            let index_a${t} = offset_a${t} / 4u;
            let index_b${t} = offset_b${t} / 4u;
            let index_c${t} = offset_c${t} / 4u;
            let component_a${t} = offset_a${t} % 4u;
            let component_b${t} = offset_b${t} % 4u;
            let component_c${t} = offset_c${t} % 4u;
            ${e}[${t}] = ${n}(${d(i,a,c)});
          `};c=9===a?`
            var data = vec4<u32>(0);
            ${e("data",0,"u32")}
            ${e("data",1,"u32")}
            ${e("data",2,"u32")}
            ${e("data",3,"u32")}
            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:`
            ${e("output_data[global_idx]",0)}
            ${e("output_data[global_idx]",1)}
            ${e("output_data[global_idx]",2)}
            ${e("output_data[global_idx]",3)}
          `}else c=o.setByOffset("global_idx",d(s.getByOffset("global_idx"),l.getByOffset("global_idx"),u.getByOffset("global_idx")));return`
        ${e.registerUniform("vec_size","u32").declareVariables(u,s,l,o)}
        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${c}
      }`},KC=e=>{let t=e[1].dims,n=e[2].dims,i=e[0].dims,a=e[1].dataType,o=!(C.areEqual(t,n)&&C.areEqual(n,i)),s=t,l=C.size(t);if(o){let e=Fn.calcShape(Fn.calcShape(t,n,!1),i,!1);if(!e)throw Error("Can't perform where op on the given tensors");s=e,l=C.size(s)}let u=Math.ceil(l/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:t=>qC(t,e,s,o,a),getRunData:()=>({outputs:[{dims:s,dataType:a}],dispatchGroup:{x:Math.ceil(l/64/4)},programUniforms:[{type:12,data:u},...W(i,t,n,s)]})}},Mw=e=>{e.compute(KC(e.inputs))}}),Vw=k(()=>{w_(),Ba(),I_(),$_(),dv(),xv(),Sv(),Vv(),Kv(),Jv(),e0(),i0(),u0(),c0(),f0(),g0(),_0(),x0(),S0(),O0(),z0(),F0(),G0(),W0(),q0(),Rc(),X0(),pw(),mw(),bw(),vw(),za(),Sw(),Bc(),Aw(),Cw(),Nw(),Mc(),zw(),Yn(),Va(),Bw(),Fw=new Map([["Abs",[A_]],["Acos",[O_]],["Acosh",[P_]],["Add",[pv]],["ArgMax",[v_,Tc]],["ArgMin",[__,Tc]],["Asin",[E_]],["Asinh",[C_]],["Atan",[D_]],["Atanh",[k_]],["Attention",[x_]],["AveragePool",[rw,nw]],["BatchNormalization",[T_]],["BiasAdd",[S_]],["BiasSplitGelu",[cv]],["Cast",[L_,N_]],["Ceil",[z_]],["Clip",[R_]],["Concat",[Tv,Iv]],["Conv",[Dc,Cc]],["ConvTranspose",[qv,Hv]],["Cos",[M_]],["Cosh",[B_]],["CumSum",[Xv,Zv]],["DepthToSpace",[Yv,Qv]],["DequantizeLinear",[fw,hw]],["Div",[fv]],["Einsum",[r0,o0]],["Elu",[F_,Wo]],["Equal",[hv]],["Erf",[V_]],["Exp",[G_]],["Expand",[s0]],["FastGelu",[l0]],["Floor",[U_]],["FusedConv",[Dc,Cc]],["Gather",[p0,d0]],["GatherElements",[w0,v0]],["GatherBlockQuantized",[b0,y0]],["GatherND",[h0,m0]],["Gelu",[W_]],["Gemm",[I0,T0]],["GlobalAveragePool",[aw,iw]],["GlobalMaxPool",[dw,cw]],["Greater",[yv]],["GreaterOrEqual",[vv]],["GridSample",[$0,A0]],["GroupQueryAttention",[R0]],["HardSigmoid",[Y_,J_]],["InstanceNormalization",[B0]],["LayerNormalization",[V0]],["LeakyRelu",[H_,Wo]],["Less",[_v]],["LessOrEqual",[wv]],["Log",[sv]],["MatMul",[U0]],["MatMulNBits",[H0,j0]],["MaxPool",[uw,lw]],["Mul",[mv]],["MultiHeadAttention",[C0,E0]],["Neg",[q_]],["Not",[j_]],["Pad",[K0]],["Pow",[gv]],["QuickGelu",[uv,Wo]],["Range",[gw]],["Reciprocal",[K_]],["ReduceMin",[f_]],["ReduceMean",[u_]],["ReduceMax",[p_]],["ReduceSum",[m_]],["ReduceProd",[h_]],["ReduceL1",[l_]],["ReduceL2",[c_]],["ReduceLogSum",[b_]],["ReduceLogSumExp",[d_]],["ReduceSumSquare",[g_]],["Relu",[X_]],["Resize",[Tw,Iw]],["RotaryEmbedding",[N0]],["ScatterND",[_w,yw]],["Sigmoid",[Z_]],["Sin",[Q_]],["Sinh",[ev]],["Slice",[Pw,Ew]],["SkipLayerNormalization",[$w]],["Split",[D0,k0]],["Sqrt",[tv]],["Softmax",[Dw,kw]],["Sub",[bv]],["Tan",[nv]],["Tanh",[ov]],["ThresholdedRelu",[av,Wo]],["Tile",[Rw]],["Transpose",[Xy,Zy]],["Where",[Mw]]])}),Gw=k(()=>{pt(),Bn(),ye(),Ya=class{constructor(e){this.backend=e,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,n,i,a){$t(e.programInfo.name);let o=this.backend.device,s=this.backend.getComputePassEncoder();this.backend.writeTimestamp(2*this.backend.pendingDispatchNumber);let l=[];for(let e of t)l.push({binding:l.length,resource:{buffer:e.buffer}});for(let e of n)l.push({binding:l.length,resource:{buffer:e.buffer}});a&&l.push({binding:l.length,resource:a});let u=o.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:l,label:e.programInfo.name});if("capturing"===this.backend.sessionStatus){let t={kernelId:this.backend.currentKernelId,computePipeline:e.computePipeline,bindGroup:u,dispatchGroup:i};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(t)}s.setPipeline(e.computePipeline),s.setBindGroup(0,u),s.dispatchWorkgroups(...i),this.backend.writeTimestamp(2*this.backend.pendingDispatchNumber+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||"at-passes"===this.backend.queryType)&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),yt(e.programInfo.name)}dispose(){}build(e,t){$t(e.name);let n=this.backend.device,i=[];[{feature:"shader-f16",extension:"f16"},{feature:"subgroups",extension:"subgroups"}].forEach(e=>{n.features.has(e.feature)&&i.push(`enable ${e.extension};`)});let a=qy(t,this.backend.device.limits),o=e.getShaderSource(a),s=`${i.join(`
`)}
${a.additionalImplementations}
${o}`,l=n.createShaderModule({code:s,label:e.name});_e("verbose",()=>`[WebGPU] ${e.name} shader code: ${s}`);let u=n.createComputePipeline({compute:{module:l,entryPoint:"main"},layout:"auto",label:e.name});return yt(e.name),{programInfo:e,computePipeline:u,uniformVariablesInfo:a.variablesInfo}}normalizeDispatchGroupSize(e){let t="number"==typeof e?e:e.x,n="number"==typeof e?1:e.y||1,i="number"==typeof e?1:e.z||1,a=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(t<=a&&n<=a&&i<=a)return[t,n,i];let o=t*n*i,s=Math.ceil(Math.sqrt(o));if(!(s>a))return[s,s,1];if((s=Math.ceil(Math.cbrt(o)))>a)throw Error("Total dispatch size exceeds WebGPU maximum.");return[s,s,s]}}}),Uw={};$r(Uw,{WebGpuBackend:()=>Vc});var XC,ZC,Fc,Vc,Ww=k(()=>{pt(),le(),Bn(),dc(),Hy(),Vw(),Gw(),XC=(e,t)=>{if(t.length!==e.length)throw Error(`inputDependencies length ${t.length} is not equal to inputTensors length ${e.length}.`);let n=[];for(let i=0;i<e.length;++i){let a=e[i].dataType;switch(t[i]){case"none":n.push("");break;case"type":n.push(`${a}`);break;case"rank":{let t=e[i].dims.length;n.push(`${a};${t}`);break}case"dims":{let t=e[i].dims.join(",");n.push(`${a};${t}`);break}default:throw Error(`unsupported input dependency: ${t[i]}`)}}return n.join("|")},ZC=(e,t,n)=>{let i=e.name;return e.shaderCache?.hint&&(i+="["+e.shaderCache.hint+"]"),i+=":"+n+`:${XC(t,e.shaderCache?.inputDependencies??Array(t.length).fill("dims"))}`},Fc=class{constructor(e){e&&(this.architecture=e.architecture,this.vendor=e.vendor)}isArchitecture(e){return this.architecture===e}isVendor(e){return this.vendor===e}},Vc=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(null===this.currentKernelId)throw Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e}async initialize(e,t){this.env=e;let n=[],i={requiredLimits:{maxComputeWorkgroupStorageSize:t.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:t.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:t.limits.maxStorageBufferBindingSize,maxBufferSize:t.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:t.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:t.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:t.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:t.limits.maxComputeWorkgroupSizeZ},requiredFeatures:n},a=e=>t.features.has(e)&&n.push(e)&&!0;a("chromium-experimental-timestamp-query-inside-passes")||a("timestamp-query"),a("shader-f16"),a("subgroups"),this.device=await t.requestDevice(i),this.adapterInfo=new Fc(t.info||await t.requestAdapterInfo()),this.gpuDataManager=Wy(this),this.programManager=new Ya(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,Aa(e.logLevel,!!e.debug),this.device.onuncapturederror=e=>{e.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${e.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:t,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){"u">typeof this.querySet&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let e=this.getCommandEncoder(),t={};"at-passes"===this.queryType&&(t.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:2*this.pendingDispatchNumber,endOfPassWriteIndex:2*this.pendingDispatchNumber+1}),this.computePassEncoder=e.beginComputePass(t)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){let e;this.commandEncoder&&($t(),this.endComputePass(),"none"!==this.queryType&&(this.commandEncoder.resolveQuerySet(this.querySet,0,2*this.pendingDispatchNumber,this.queryResolveBuffer,0),e=this.device.createBuffer({size:2*this.pendingDispatchNumber*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(e,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,2*this.pendingDispatchNumber*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,"none"!==this.queryType&&e.mapAsync(GPUMapMode.READ).then(()=>{let t=new BigUint64Array(e.getMappedRange()),n=this.pendingQueries.get(e);for(let e=0;e<t.length/2;e++){let i=n[e],a=i.kernelId,o=this.kernels.get(a),s=o.kernelType,l=o.kernelName,u=i.programName,c=i.inputTensorViews,d=i.outputTensorViews,p=t[2*e],h=t[2*e+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=p);let f=Number(p-this.queryTimeBase),g=Number(h-this.queryTimeBase);if(!Number.isSafeInteger(f)||!Number.isSafeInteger(g))throw RangeError("incorrect timestamp range");if(this.env.webgpu.profiling?.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:c.map(e=>({dims:e.dims,dataType:Mn(e.dataType)})),outputsMetadata:d.map(e=>({dims:e.dims,dataType:Mn(e.dataType)})),kernelId:a,kernelType:s,kernelName:l,programName:u,startTime:f,endTime:g});else{let e="";c.forEach((t,n)=>{e+=`input[${n}]: [${t.dims}] | ${Mn(t.dataType)}, `});let t="";d.forEach((e,n)=>{t+=`output[${n}]: [${e.dims}] | ${Mn(e.dataType)}, `}),console.log(`[profiling] kernel "${a}|${s}|${l}|${u}" ${e}${t}start time: ${f} ns, execution time: ${g-f} ns`)}li("GPU",`${u}::${p}::${h}`)}e.unmap(),this.pendingQueries.delete(e)}),yt())}run(e,t,n,i,a,o){let s;$t(e.name);let l=[];for(let e=0;e<t.length;++e){let n=t[e].data;if(0===n)continue;let i=this.gpuDataManager.get(n);if(!i)throw Error(`no GPU data for input: ${n}`);l.push(i)}let{outputs:u,dispatchGroup:c,programUniforms:d}=e.getRunData(t),p=0===n.length?u.map((e,t)=>t):n;if(p.length!==u.length)throw Error(`Output size ${p.length} must be equal to ${u.length}.`);let h=[],f=[];for(let e=0;e<u.length;++e){if(!Number.isInteger(p[e])||p[e]<-3||p[e]>=o)throw Error(`Invalid output index: ${p[e]}`);if(-3===p[e])continue;let t=-1===p[e],n=-2===p[e],s=t||n?a(u[e].dataType,u[e].dims):i(p[e],u[e].dataType,u[e].dims);if(h.push(s),0===s.data)continue;let l=this.gpuDataManager.get(s.data);if(!l)throw Error(`no GPU data for output: ${s.data}`);if(t&&this.temporaryData.push(l),n){let e=this.kernelPersistentData.get(this.currentKernelId);e||(e=[],this.kernelPersistentData.set(this.currentKernelId,e)),e.push(l)}f.push(l)}if(l.length!==t.length||f.length!==h.length){if(0===f.length)return yt(e.name),h;throw Error(`Program ${e.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}if(d){let e=0,t=[];d.forEach(n=>{let i="number"==typeof n.data?[n.data]:n.data;if(0===i.length)return;let a=10===n.type?2:4,o,s;10===n.type?(s=i.length>4?16:i.length>2?8:i.length*a,o=i.length>4?16:a*i.length):(s=i.length<=2?i.length*a:16,o=16),e=Math.ceil(e/s)*s,t.push(e);let l=10===n.type?8:4;e+=i.length>4?Math.ceil(i.length/l)*o:i.length*a});let n=new ArrayBuffer(e=16*Math.ceil(e/16));d.forEach((e,i)=>{let a=t[i],o="number"==typeof e.data?[e.data]:e.data;if(6===e.type)new Int32Array(n,a,o.length).set(o);else if(12===e.type)new Uint32Array(n,a,o.length).set(o);else if(10===e.type)new Uint16Array(n,a,o.length).set(o);else if(1===e.type)new Float32Array(n,a,o.length).set(o);else throw Error(`Unsupported uniform type: ${Mn(e.type)}`)});let i=this.gpuDataManager.create(e,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(i.buffer,0,n,0,e),this.gpuDataManager.release(i.id),s={offset:0,size:e,buffer:i.buffer}}let g=this.programManager.normalizeDispatchGroupSize(c),m=ZC(e,t,1===g[1]&&1===g[2]),y=this.programManager.getArtifact(m);if(y||(y=this.programManager.build(e,g),this.programManager.setArtifact(m,y),_e("info",()=>`[artifact] key: ${m}, programName: ${e.name}`)),d&&y.uniformVariablesInfo){if(d.length!==y.uniformVariablesInfo.length)throw Error(`Uniform variables count mismatch: expect ${y.uniformVariablesInfo.length}, got ${d.length} in program "${y.programInfo.name}".`);for(let e=0;e<d.length;e++){let t=d[e],n=t.type,i="number"==typeof t.data?1:t.data.length,[a,o]=y.uniformVariablesInfo[e];if(n!==a||i!==o)throw Error(`Uniform variable ${e} mismatch: expect type ${a} with size ${o}, got type ${n} with size ${i} in program "${y.programInfo.name}".`)}}if(_e("info",()=>`[ProgramManager] run "${e.name}" (key=${m}) with ${g[0]}x${g[1]}x${g[2]}`),"none"!==this.queryType||"capturing"===this.sessionStatus){let e={kernelId:this.currentKernelId,programName:y.programInfo.name,inputTensorViews:t,outputTensorViews:h};this.pendingKernels.push(e),"capturing"===this.sessionStatus&&this.capturedPendingKernels.get(this.currentSessionId).push(e)}return this.programManager.run(y,l,f,g,s),yt(e.name),h}upload(e,t){this.gpuDataManager.upload(e,t)}memcpy(e,t){this.gpuDataManager.memcpy(e,t)}async download(e,t){await this.gpuDataManager.download(e,t)}alloc(e){return this.gpuDataManager.create(e).id}free(e){return this.gpuDataManager.release(e)}createKernel(e,t,n,i){let a=Fw.get(e);if(!a)throw Error(`kernel not implemented: ${e}`);let o={kernelType:e,kernelName:i,kernelEntry:a[0],attributes:[a[1],n]};this.kernels.set(t,o)}releaseKernel(e){let t=this.kernelPersistentData.get(e);if(t){for(let e of t)this.gpuDataManager.release(e.id);this.kernelPersistentData.delete(e)}this.kernelCustomData.delete(e),this.kernels.delete(e)}computeKernel(e,t,n){let i=this.kernels.get(e);if(!i)throw Error(`kernel not created: ${e}`);let a=i.kernelType,o=i.kernelName,s=i.kernelEntry,l=i.attributes;if(null!==this.currentKernelId)throw Error(`kernel "[${a}] ${o}" is not allowed to be called recursively`);this.currentKernelId=e,l[0]&&(l[1]=l[0](l[1]),l[0]=void 0),_e("info",()=>`[WebGPU] Start to run kernel "[${a}] ${o}"...`);let u=this.env.debug;this.temporaryData=[];try{return u&&this.device.pushErrorScope("validation"),s(t,l[1]),0}catch(e){return n.push(Promise.resolve(`[WebGPU] Kernel "[${a}] ${o}" failed. ${e}`)),1}finally{for(let e of(u&&n.push(this.device.popErrorScope().then(e=>e?`GPU validation error for kernel "[${a}] ${o}": ${e.message}`:null)),this.temporaryData))this.gpuDataManager.release(e.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(e,t,n,i){let a=this.sessionExternalDataMapping.get(e);a||(a=new Map,this.sessionExternalDataMapping.set(e,a));let o=a.get(t),s=this.gpuDataManager.registerExternalBuffer(n,i,o);return a.set(t,[s,n]),s}unregisterBuffers(e){let t=this.sessionExternalDataMapping.get(e);t&&(t.forEach(e=>this.gpuDataManager.unregisterExternalBuffer(e[0])),this.sessionExternalDataMapping.delete(e))}getBuffer(e){let t=this.gpuDataManager.get(e);if(!t)throw Error(`no GPU data for buffer: ${e}`);return t.buffer}createDownloader(e,t,n){return async()=>{let i=await bc(this,e,t);return Pa(i.buffer,n)}}writeTimestamp(e){"inside-passes"===this.queryType&&this.computePassEncoder.writeTimestamp(this.querySet,e)}setQueryType(){this.queryType="none",(this.env.webgpu.profiling?.mode==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),"none"!==this.queryType&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:2*this.maxDispatchNumber}),this.queryResolveBuffer=this.device.createBuffer({size:2*this.maxDispatchNumber*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){_e("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){_e("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){_e("info","replay"),this.sessionStatus="replaying";let e=this.capturedCommandList.get(this.currentSessionId),t=this.capturedPendingKernels.get(this.currentSessionId),n=e.length;this.pendingKernels=[];for(let i=0;i<n;i++){let n=this.getComputePassEncoder(),a=e[i];this.writeTimestamp(2*this.pendingDispatchNumber),n.setPipeline(a.computePipeline),n.setBindGroup(0,a.bindGroup),n.dispatchWorkgroups(...a.dispatchGroup),this.writeTimestamp(2*this.pendingDispatchNumber+1),this.pendingDispatchNumber++,"none"!==this.queryType&&this.pendingKernels.push(t[i]),(this.pendingDispatchNumber>=this.maxDispatchNumber||"at-passes"===this.queryType)&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onCreateSession(){this.gpuDataManager.onCreateSession()}onReleaseSession(e){this.unregisterBuffers(e),this.capturedCommandList.has(e)&&this.capturedCommandList.delete(e),this.capturedPendingKernels.has(e)&&this.capturedPendingKernels.delete(e),this.gpuDataManager.onReleaseSession(e)}onRunStart(e){this.currentSessionId=e,this.setQueryType()}}}),Hw={};$r(Hw,{init:()=>JC});var Ko,Gc,JC,YC,ma,ga,jr,QC,qw,Fo,ba,ya,Kw,_a,va,wa,qr,Ft,Xo,es,ts,Qa,Uc,Wc,mo,go,t3,Xw,Zw,Jw,Yw,Qw,ex,tx,nx,n3,ns,jw=k(()=>{le(),Bn(),ge(),Fy(),Ko=class e{constructor(e,t,n,i){this.module=e,this.dataType=t,this.data=n,this.dims=i}getFloat32Array(){if(1!==this.dataType)throw Error("Invalid data type");let e=C.size(this.dims);return 0===e?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,e)}getBigInt64Array(){if(7!==this.dataType)throw Error("Invalid data type");let e=C.size(this.dims);return 0===e?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,e)}getInt32Array(){if(6!==this.dataType)throw Error("Invalid data type");let e=C.size(this.dims);return 0===e?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,e)}getUint16Array(){if(10!==this.dataType&&4!==this.dataType)throw Error("Invalid data type");let e=C.size(this.dims);return 0===e?new Uint16Array:new Uint16Array(this.module.HEAP8.buffer,this.data,e)}reshape(t){if(C.size(t)!==C.size(this.dims))throw Error("Invalid new shape");return new e(this.module,this.dataType,this.data,t)}},Gc=class{constructor(e,t,n){this.module=e,this.backend=t,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=t.adapterInfo;let i=e.PTR_SIZE,a=n/e.PTR_SIZE,o=4===i?"i32":"i64";this.opKernelContext=Number(e.getValue(i*a++,o));let s=Number(e.getValue(i*a++,o));this.outputCount=Number(e.getValue(i*a++,o)),this.customDataOffset=Number(e.getValue(i*a++,"*")),this.customDataSize=Number(e.getValue(i*a++,o));let l=[];for(let t=0;t<s;t++){let t=Number(e.getValue(i*a++,o)),n=Number(e.getValue(i*a++,"*")),s=Number(e.getValue(i*a++,o)),u=[];for(let t=0;t<s;t++)u.push(Number(e.getValue(i*a++,o)));l.push(new Ko(e,t,n,u))}this.inputs=l}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(e,t){let n=t?.inputs?.map(e=>"number"==typeof e?this.inputs[e]:e)??this.inputs,i=t?.outputs??[],a=(e,t,n)=>new Ko(this.module,t,this.output(e,n),n),o=(e,t)=>{let n=vr(e,t);if(!n)throw Error(`Unsupported data type: ${e}`);let i=n>0?this.backend.gpuDataManager.create(n).id:0;return new Ko(this.module,e,i,t)};return this.backend.run(e,n,i,a,o,this.outputCount)}output(e,t){let n=this.module.stackSave();try{let n=this.module.PTR_SIZE,i=4===n?"i32":"i64",a=this.module.stackAlloc((1+t.length)*n);this.module.setValue(a,t.length,i);for(let e=0;e<t.length;e++)this.module.setValue(a+n*(e+1),t[e],i);return this.module._JsepOutput(this.opKernelContext,e,a)}catch(n){throw Error(`Failed to generate kernel's output[${e}] with dims [${t}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${n}`)}finally{this.module.stackRestore(n)}}},JC=async(e,t,n,i)=>{let a=t.jsepInit;if(!a)throw Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if("webgpu"===e){let e=new(Ww(),Jr(Uw)).WebGpuBackend;await e.initialize(n,i),a("webgpu",[e,t=>e.alloc(Number(t)),t=>e.free(t),(n,i,a,o=!1)=>{if(o)_e("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${Number(n)}, dst=${Number(i)}, size=${Number(a)}`),e.memcpy(Number(n),Number(i));else{_e("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${Number(n)}, gpuDataId=${Number(i)}, size=${Number(a)}`);let o=t.HEAPU8.subarray(Number(n>>>0),Number(n>>>0)+Number(a));e.upload(Number(i),o)}},async(n,i,a)=>{_e("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${n}, dataOffset=${i}, size=${a}`),await e.download(Number(n),()=>t.HEAPU8.subarray(Number(i)>>>0,Number(i+a)>>>0))},(n,i,a)=>e.createKernel(n,Number(i),a,t.UTF8ToString(t._JsepGetNodeName(Number(i)))),t=>e.releaseKernel(t),(n,i,a,o)=>{_e("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${a}, kernel=${n}, contextDataOffset=${i}`);let s=new Gc(t,e,Number(i));return e.computeKernel(Number(n),s,o)},()=>e.captureBegin(),()=>e.captureEnd(),()=>e.replay()])}else{let e=new ka(n);a("webnn",[e,()=>e.reserveTensorId(),t=>e.releaseTensorId(t),async(t,n,i,a,o)=>e.ensureTensor(t,n,i,a,o),(t,n)=>{e.uploadTensor(t,n)},async(t,n)=>e.downloadTensor(t,n),(t,n)=>e.registerMLContext(t,n),!!n.trace])}}}),rc=k(()=>{pt(),Ay(),Py(),le(),yr(),Ta(),lc(),YC=(e,t)=>{0!==Be()._OrtInit(e,t)&&Ne("Can't initialize onnxruntime.")},ma=async e=>{YC(e.wasm.numThreads,Go(e.logLevel))},ga=async(e,t)=>{Be().asyncInit?.();let n=e.webgpu.adapter;if("webgpu"===t){if(typeof navigator>"u"||!navigator.gpu)throw Error("WebGPU is not supported in current environment");if(n){if("object"!=typeof n.limits||"object"!=typeof n.features||"function"!=typeof n.requestDevice)throw Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let t=e.webgpu.powerPreference;if(void 0!==t&&"low-power"!==t&&"high-performance"!==t)throw Error(`Invalid powerPreference setting: "${t}"`);let i=e.webgpu.forceFallbackAdapter;if(void 0!==i&&"boolean"!=typeof i)throw Error(`Invalid forceFallbackAdapter setting: "${i}"`);if(!(n=await navigator.gpu.requestAdapter({powerPreference:t,forceFallbackAdapter:i})))throw Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}}if("webnn"===t&&(typeof navigator>"u"||!navigator.ml))throw Error("WebNN is not supported in current environment");{let i=(jw(),Jr(Hw)).init;"webgpu"===t&&await i("webgpu",Be(),e,n),"webnn"===t&&await i("webnn",Be(),e)}},jr=new Map,QC=e=>{let t=Be(),n=t.stackSave();try{let n=t.PTR_SIZE,i=t.stackAlloc(2*n);0!==t._OrtGetInputOutputCount(e,i,i+n)&&Ne("Can't get session input/output count.");let a=4===n?"i32":"i64";return[Number(t.getValue(i,a)),Number(t.getValue(i+n,a))]}finally{t.stackRestore(n)}},qw=(e,t)=>{let n=Be(),i=n.stackSave(),a=0;try{let i=n.PTR_SIZE,o=n.stackAlloc(2*i);0!==n._OrtGetInputOutputMetadata(e,t,o,o+i)&&Ne("Can't get session input/output metadata.");let s=Number(n.getValue(o,"*"));a=Number(n.getValue(o+i,"*"));let l=n.HEAP32[a/4];if(0===l)return[s,0];let u=n.HEAPU32[a/4+1],c=[];for(let e=0;e<u;e++){let t=Number(n.getValue(a+8+e*i,"*"));c.push(0!==t?n.UTF8ToString(t):Number(n.getValue(a+8+(e+u)*i,"*")))}return[s,l,c]}finally{n.stackRestore(i),0!==a&&n._OrtFree(a)}},Fo=e=>{let t=Be(),n=t._malloc(e.byteLength);if(0===n)throw Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,n),[n,e.byteLength]},ba=async(e,t)=>{let n,i,a=Be();Array.isArray(e)?[n,i]=e:e.buffer===a.HEAPU8.buffer?[n,i]=[e.byteOffset,e.byteLength]:[n,i]=Fo(e);let o=0,s=0,l=0,u=[],c=[],d=[];try{if([s,u]=await Oy(t),t?.externalData&&a.mountExternalData){let e=[];for(let n of t.externalData){let t="string"==typeof n?n:n.path;e.push(Uo("string"==typeof n?n:n.data).then(e=>{a.mountExternalData(t,e)}))}await Promise.all(e)}for(let e of t?.executionProviders??[])if(("string"==typeof e?e:e.name)==="webnn"){if(a.shouldTransferToMLTensor=!1,"string"!=typeof e){let t=e,n=t?.context,i=t?.gpuDevice,o=t?.deviceType,s=t?.powerPreference;n?a.currentContext=n:i?a.currentContext=await a.webnnCreateMLContext(i):a.currentContext=await a.webnnCreateMLContext({deviceType:o,powerPreference:s})}else a.currentContext=await a.webnnCreateMLContext();break}o=await a._OrtCreateSession(n,i,s),a.webgpuOnCreateSession?.(o),0===o&&Ne("Can't create a session."),a.jsepOnCreateSession?.(),a.currentContext&&(a.webnnRegisterMLContext(o,a.currentContext),a.currentContext=void 0,a.shouldTransferToMLTensor=!0);let[e,p]=QC(o),h=!!t?.enableGraphCapture,f=[],g=[],m=[],y=[],b=[];for(let t=0;t<e;t++){let[e,n,i]=qw(o,t);0===e&&Ne("Can't get an input name."),c.push(e);let s=a.UTF8ToString(e);f.push(s),m.push(0===n?{name:s,isTensor:!1}:{name:s,isTensor:!0,type:Mn(n),shape:i})}for(let n=0;n<p;n++){let[i,s,l]=qw(o,n+e);0===i&&Ne("Can't get an output name."),d.push(i);let u=a.UTF8ToString(i);g.push(u),y.push(0===s?{name:u,isTensor:!1}:{name:u,isTensor:!0,type:Mn(s),shape:l});{if(h&&t?.preferredOutputLocation===void 0){b.push("gpu-buffer");continue}let e="string"==typeof t?.preferredOutputLocation?t.preferredOutputLocation:t?.preferredOutputLocation?.[u]??"cpu",n=a.webnnIsGraphOutput;if("cpu"===e&&n&&n(o,u)){b.push("ml-tensor-cpu-output");continue}if("cpu"!==e&&"cpu-pinned"!==e&&"gpu-buffer"!==e&&"ml-tensor"!==e)throw Error(`Not supported preferred output location: ${e}.`);if(h&&"gpu-buffer"!==e)throw Error(`Not supported preferred output location: ${e}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);b.push(e)}}let v=null;return b.some(e=>"gpu-buffer"===e||"ml-tensor"===e||"ml-tensor-cpu-output"===e)&&(l=a._OrtCreateBinding(o),0===l&&Ne("Can't create IO binding."),v={handle:l,outputPreferredLocations:b,outputPreferredLocationsEncoded:b.map(e=>"ml-tensor-cpu-output"===e?"ml-tensor":e).map(e=>uc(e))}),jr.set(o,[o,c,d,v,h,!1]),[o,f,g,m,y]}catch(e){throw c.forEach(e=>a._OrtFree(e)),d.forEach(e=>a._OrtFree(e)),0!==l&&0!==a._OrtReleaseBinding(l)&&Ne("Can't release IO binding."),0!==o&&0!==a._OrtReleaseSession(o)&&Ne("Can't release session."),e}finally{a._free(n),0!==s&&0!==a._OrtReleaseSessionOptions(s)&&Ne("Can't release session options."),u.forEach(e=>a._free(e)),a.unmountExternalData?.()}},ya=e=>{let t=Be(),n=jr.get(e);if(!n)throw Error(`cannot release session. invalid session id: ${e}`);let[i,a,o,s,l]=n;s&&(l&&0!==t._OrtClearBoundOutputs(s.handle)&&Ne("Can't clear bound outputs."),0!==t._OrtReleaseBinding(s.handle)&&Ne("Can't release IO binding.")),t.jsepOnReleaseSession?.(e),t.webnnOnReleaseSession?.(e),t.webgpuOnReleaseSession?.(e),a.forEach(e=>t._OrtFree(e)),o.forEach(e=>t._OrtFree(e)),0!==t._OrtReleaseSession(i)&&Ne("Can't release session."),jr.delete(e)},Kw=async(e,t,n,i,a,o,s=!1)=>{if(!e)return void t.push(0);let l=Be(),u=l.PTR_SIZE,c=e[0],d=e[1],p=e[3],h=p,f,g;if("string"===c&&("gpu-buffer"===p||"ml-tensor"===p))throw Error("String tensor is not supported on GPU.");if(s&&"gpu-buffer"!==p)throw Error(`External buffer must be provided for input/output index ${o} when enableGraphCapture is true.`);if("gpu-buffer"===p){let t=e[2].gpuBuffer;g=vr(_r(c),d);{let e=l.jsepRegisterBuffer;if(!e)throw Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');f=e(i,o,t,g)}}else if("ml-tensor"===p){let t=e[2].mlTensor;g=vr(_r(c),d);let n=l.webnnRegisterMLTensor;if(!n)throw Error('Tensor location "ml-tensor" is not supported without using WebNN.');f=n(i,t,_r(c),d)}else{let t=e[2];if(Array.isArray(t)){g=u*t.length,f=l._malloc(g),n.push(f);for(let e=0;e<t.length;e++){if("string"!=typeof t[e])throw TypeError(`tensor data at index ${e} is not a string`);l.setValue(f+e*u,Pt(t[e],n),"*")}}else{let e=l.webnnIsGraphInput,o=l.webnnIsGraphOutput;if("string"!==c&&e&&o){let s=l.UTF8ToString(a);if(e(i,s)||o(i,s)){let e=_r(c);g=vr(e,d),h="ml-tensor";let n=l.webnnCreateTemporaryTensor,a=l.webnnUploadTensor;if(!n||!a)throw Error('Tensor location "ml-tensor" is not supported without using WebNN.');let o=await n(i,e,d);a(o,new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),f=o}else g=t.byteLength,f=l._malloc(g),n.push(f),l.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,g),f)}else g=t.byteLength,f=l._malloc(g),n.push(f),l.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,g),f)}}let m=l.stackSave(),y=l.stackAlloc(4*d.length);try{d.forEach((e,t)=>l.setValue(y+t*u,e,4===u?"i32":"i64"));let e=l._OrtCreateTensor(_r(c),f,g,y,d.length,uc(h));0===e&&Ne(`Can't create tensor for input/output. session=${i}, index=${o}.`),t.push(e)}finally{l.stackRestore(m)}},_a=async(e,t,n,i,a,o)=>{let s=Be(),l=s.PTR_SIZE,u=jr.get(e);if(!u)throw Error(`cannot run inference. invalid session id: ${e}`);let c=u[0],d=u[1],p=u[2],h=u[3],f=u[4],g=u[5],m=t.length,y=i.length,b=0,v=[],x=[],w=[],_=[],S=s.stackSave(),k=s.stackAlloc(m*l),T=s.stackAlloc(m*l),C=s.stackAlloc(y*l),E=s.stackAlloc(y*l);try{let u;[b,v]=$y(o),ur("wasm prepareInputOutputTensor");for(let i=0;i<m;i++)await Kw(n[i],x,_,e,d[t[i]],t[i],f);for(let t=0;t<y;t++)await Kw(a[t],w,_,e,p[i[t]],m+i[t],f);lr("wasm prepareInputOutputTensor");for(let e=0;e<m;e++)s.setValue(k+e*l,x[e],"*"),s.setValue(T+e*l,d[t[e]],"*");for(let e=0;e<y;e++)s.setValue(C+e*l,w[e],"*"),s.setValue(E+e*l,p[i[e]],"*");if(h&&!g){let{handle:n,outputPreferredLocations:o,outputPreferredLocationsEncoded:l}=h;if(d.length!==m)throw Error(`input count from feeds (${m}) is expected to be always equal to model's input count (${d.length}).`);ur("wasm bindInputsOutputs");for(let i=0;i<m;i++){let a=t[i];await s._OrtBindInput(n,d[a],x[i])!==0&&Ne(`Can't bind input[${i}] for session=${e}.`)}for(let t=0;t<y;t++){let u=i[t];a[t]?.[3]?0!==s._OrtBindOutput(n,p[u],w[t],0)&&Ne(`Can't bind pre-allocated output[${t}] for session=${e}.`):0!==s._OrtBindOutput(n,p[u],0,l[u])&&Ne(`Can't bind output[${t}] to ${o[t]} for session=${e}.`)}lr("wasm bindInputsOutputs"),jr.set(e,[c,d,p,h,f,!0])}s.jsepOnRunStart?.(c),s.webnnOnRunStart?.(c),u=h?await s._OrtRunWithBinding(c,h.handle,y,C,b):await s._OrtRun(c,T,k,m,E,y,C,b),0!==u&&Ne("failed to call OrtRun().");let S=[],I=[];ur("wasm ProcessOutputTensor");for(let t=0;t<y;t++){let n=Number(s.getValue(C+t*l,"*"));if(n===w[t]){S.push(a[t]);continue}let o=s.stackSave(),u=s.stackAlloc(4*l),c=!1,d,p=0;try{0!==s._OrtGetTensorData(n,u,u+l,u+2*l,u+3*l)&&Ne(`Can't access output tensor data on index ${t}.`);let a=4===l?"i32":"i64",o=Number(s.getValue(u,a));p=s.getValue(u+l,"*");let f=s.getValue(u+2*l,"*"),g=Number(s.getValue(u+3*l,a)),m=[];for(let e=0;e<g;e++)m.push(Number(s.getValue(f+e*l,a)));0!==s._OrtFree(f)&&Ne("Can't free memory for tensor dims.");let y=m.reduce((e,t)=>e*t,1);d=Mn(o);let b=h?.outputPreferredLocations[i[t]];if("string"===d){if("gpu-buffer"===b||"ml-tensor"===b)throw Error("String tensor is not supported on GPU.");let e=[];for(let t=0;t<y;t++){let n=s.getValue(p+t*l,"*"),i=s.getValue(p+(t+1)*l,"*"),a=t===y-1?void 0:i-n;e.push(s.UTF8ToString(n,a))}S.push([d,m,e,"cpu"])}else if("gpu-buffer"===b&&y>0){let e=s.jsepGetBuffer;if(!e)throw Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let t=e(p),i=vr(o,y);if(void 0===i||!Sa(d))throw Error(`Unsupported data type: ${d}`);c=!0,S.push([d,m,{gpuBuffer:t,download:s.jsepCreateDownloader(t,i,d),dispose:()=>{0!==s._OrtReleaseTensor(n)&&Ne("Can't release tensor.")}},"gpu-buffer"])}else if("ml-tensor"===b&&y>0){let t=s.webnnEnsureTensor,i=s.webnnIsGraphInputOutputTypeSupported;if(!t||!i)throw Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(void 0===vr(o,y)||!$a(d))throw Error(`Unsupported data type: ${d}`);if(!i(e,d,!1))throw Error(`preferredLocation "ml-tensor" for ${d} output is not supported by current WebNN Context.`);let a=await t(e,p,o,m,!1);c=!0,S.push([d,m,{mlTensor:a,download:s.webnnCreateMLTensorDownloader(p,d),dispose:()=>{s.webnnReleaseTensorId(p),s._OrtReleaseTensor(n)}},"ml-tensor"])}else if("ml-tensor-cpu-output"===b&&y>0){let e=s.webnnCreateMLTensorDownloader(p,d)(),t=S.length;c=!0,I.push((async()=>{let i=[t,await e];return s.webnnReleaseTensorId(p),s._OrtReleaseTensor(n),i})()),S.push([d,m,[],"cpu"])}else{let e=new(co(d))(y);new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(s.HEAPU8.subarray(p,p+e.byteLength)),S.push([d,m,e,"cpu"])}}finally{s.stackRestore(o),"string"===d&&p&&s._free(p),c||s._OrtReleaseTensor(n)}}for(let[t,n]of(h&&!f&&(0!==s._OrtClearBoundOutputs(h.handle)&&Ne("Can't clear bound outputs."),jr.set(e,[c,d,p,h,f,!1])),await Promise.all(I)))S[t][2]=n;return lr("wasm ProcessOutputTensor"),S}finally{s.webnnOnRunEnd?.(c),s.stackRestore(S),x.forEach(e=>s._OrtReleaseTensor(e)),w.forEach(e=>s._OrtReleaseTensor(e)),_.forEach(e=>s._free(e)),0!==b&&s._OrtReleaseRunOptions(b),v.forEach(e=>s._free(e))}},va=e=>{let t=Be(),n=jr.get(e);if(!n)throw Error("invalid session id");let i=n[0],a=t._OrtEndProfiling(i);0===a&&Ne("Can't get an profile file name."),t._OrtFree(a)},wa=e=>{let t=[];for(let n of e){let e=n[2];!Array.isArray(e)&&"buffer"in e&&t.push(e.buffer)}return t}}),Hc=k(()=>{pt(),rc(),yr(),fa(),qr=()=>!!me.wasm.proxy&&"u">typeof document,Xo=!1,es=!1,ts=!1,Wc=new Map,mo=(e,t)=>{let n=Wc.get(e);n?n.push(t):Wc.set(e,[t])},go=()=>{if(Xo||!es||ts||!Ft)throw Error("worker not ready")},t3=e=>{switch(e.data.type){case"init-wasm":Xo=!1,e.data.err?(ts=!0,Uc[1](e.data.err)):(es=!0,Uc[0]()),Qa&&(URL.revokeObjectURL(Qa),Qa=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let t=Wc.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out)}}},Xw=async()=>{if(!es){if(Xo)throw Error("multiple calls to 'initWasm()' detected.");if(ts)throw Error("previous call to 'initWasm()' failed.");if(Xo=!0,qr())return new Promise((e,t)=>{Ft?.terminate(),Ty().then(([n,i])=>{try{(Ft=i).onerror=e=>t(e),Ft.onmessage=t3,Uc=[e,t];let a={type:"init-wasm",in:me};!a.in.wasm.wasmPaths&&(n||ic)&&(a.in.wasm.wasmPaths={wasm:new URL(__webpack_require__(681),__webpack_require__.b).href}),Ft.postMessage(a),Qa=n}catch(e){t(e)}},t)});try{await ha(me.wasm),await ma(me),es=!0}catch(e){throw ts=!0,e}finally{Xo=!1}}},Zw=async e=>{if(qr())return go(),new Promise((t,n)=>{mo("init-ep",[t,n]);let i={type:"init-ep",in:{epName:e,env:me}};Ft.postMessage(i)});await ga(me,e)},Jw=async e=>qr()?(go(),new Promise((t,n)=>{mo("copy-from",[t,n]);let i={type:"copy-from",in:{buffer:e}};Ft.postMessage(i,[e.buffer])})):Fo(e),Yw=async(e,t)=>{if(!qr())return ba(e,t);if(t?.preferredOutputLocation)throw Error('session option "preferredOutputLocation" is not supported for proxy.');return go(),new Promise((n,i)=>{mo("create",[n,i]);let a={type:"create",in:{model:e,options:{...t}}},o=[];e instanceof Uint8Array&&o.push(e.buffer),Ft.postMessage(a,o)})},Qw=async e=>{if(qr())return go(),new Promise((t,n)=>{mo("release",[t,n]);let i={type:"release",in:e};Ft.postMessage(i)});ya(e)},ex=async(e,t,n,i,a,o)=>{if(!qr())return _a(e,t,n,i,a,o);if(n.some(e=>"cpu"!==e[3]))throw Error("input tensor on GPU is not supported for proxy.");if(a.some(e=>e))throw Error("pre-allocated output tensor is not supported for proxy.");return go(),new Promise((a,s)=>{mo("run",[a,s]);let l=n,u={type:"run",in:{sessionId:e,inputIndices:t,inputs:l,outputIndices:i,options:o}};Ft.postMessage(u,wa(l))})},tx=async e=>{if(qr())return go(),new Promise((t,n)=>{mo("end-profiling",[t,n]);let i={type:"end-profiling",in:e};Ft.postMessage(i)});va(e)}}),rx=k(()=>{pt(),Hc(),le(),pa(),lc(),nx=(e,t)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[e.type,e.dims,{mlTensor:e.mlTensor},"ml-tensor"];default:throw Error(`invalid data location: ${e.location} for ${t()}`)}},n3=e=>{switch(e[3]){case"cpu":return new St(e[0],e[2],e[1]);case"gpu-buffer":{let t=e[0];if(!Sa(t))throw Error(`not supported data type: ${t} for deserializing GPU tensor`);let{gpuBuffer:n,download:i,dispose:a}=e[2];return St.fromGpuBuffer(n,{dataType:t,dims:e[1],download:i,dispose:a})}case"ml-tensor":{let t=e[0];if(!$a(t))throw Error(`not supported data type: ${t} for deserializing MLTensor tensor`);let{mlTensor:n,download:i,dispose:a}=e[2];return St.fromMLTensor(n,{dataType:t,dims:e[1],download:i,dispose:a})}default:throw Error(`invalid data location: ${e[3]}`)}},ns=class{async fetchModelAndCopyToWasmMemory(e){return Jw(await Uo(e))}async loadModel(e,t){let n;$t(),n="string"==typeof e?await this.fetchModelAndCopyToWasmMemory(e):e,[this.sessionId,this.inputNames,this.outputNames,this.inputMetadata,this.outputMetadata]=await Yw(n,t),yt()}async dispose(){return Qw(this.sessionId)}async run(e,t,n){$t();let i=[],a=[];Object.entries(e).forEach(e=>{let t=e[0],n=e[1],o=this.inputNames.indexOf(t);if(-1===o)throw Error(`invalid input '${t}'`);i.push(n),a.push(o)});let o=[],s=[];Object.entries(t).forEach(e=>{let t=e[0],n=e[1],i=this.outputNames.indexOf(t);if(-1===i)throw Error(`invalid output '${t}'`);o.push(n),s.push(i)});let l=i.map((e,t)=>nx(e,()=>`input "${this.inputNames[a[t]]}"`)),u=o.map((e,t)=>e?nx(e,()=>`output "${this.outputNames[s[t]]}"`):null),c=await ex(this.sessionId,a,l,s,u,n),d={};for(let e=0;e<c.length;e++)d[this.outputNames[s[e]]]=o[e]??n3(c[e]);return yt(),d}startProfiling(){}endProfiling(){tx(this.sessionId)}}}),ix={};$r(ix,{OnnxruntimeWebAssemblyBackend:()=>rs,initializeFlags:()=>ox,wasmBackend:()=>r3});var ox,rs,r3,ax=k(()=>{pt(),Hc(),rx(),ox=()=>{("number"!=typeof me.wasm.initTimeout||me.wasm.initTimeout<0)&&(me.wasm.initTimeout=0);let e=me.wasm.simd;if("boolean"!=typeof e&&void 0!==e&&"fixed"!==e&&"relaxed"!==e&&(console.warn(`Property "env.wasm.simd" is set to unknown value "${e}". Reset it to \`false\` and ignore SIMD feature checking.`),me.wasm.simd=!1),"boolean"!=typeof me.wasm.proxy&&(me.wasm.proxy=!1),"boolean"!=typeof me.wasm.trace&&(me.wasm.trace=!1),"number"!=typeof me.wasm.numThreads||!Number.isInteger(me.wasm.numThreads)||me.wasm.numThreads<=0)if("u">typeof self&&!self.crossOriginIsolated)me.wasm.numThreads=1;else{let e=typeof navigator>"u"?Os("node:os").cpus().length:navigator.hardwareConcurrency;me.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},r3=new(rs=class{async init(e){ox(),await Xw(),await Zw(e)}async createInferenceSessionHandler(e,t){let n=new ns;return await n.loadModel(e,t),n}})});pt(),pt(),pt();var Dp="1.23.2",zq=Ns;{let r=(cy(),Jr(ly)).onnxjsBackend;sr("webgl",r,-10)}{let r=(ax(),Jr(ix)).wasmBackend;sr("webgpu",r,5),sr("webnn",r,5),sr("cpu",r,10),sr("wasm",r,10)}Object.defineProperty(me.versions,"web",{value:Dp,enumerable:!0})}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,(()=>{var e="function"==typeof Symbol,t=e?Symbol("rspack queues"):"__rspack_queues",n=__webpack_require__.aE=e?Symbol("rspack exports"):"__webpack_exports__",i=e?Symbol("rspack error"):"__rspack_error",a=e?Symbol("rspack done"):"__rspack_done",o=__webpack_require__.zS=e?Symbol("rspack defer"):"__rspack_defer",s=e=>{e&&e.d<1&&(e.d=1,e.forEach(e=>e.r--),e.forEach(e=>e.r--?e.r++:e()))},l=e=>e.map(e=>{if(null!==e&&"object"==typeof e){if(!e[t]&&e[o]){var l=e[o];if(!l.some(e=>{var t=__webpack_module_cache__[e];return!t||!1===t[a]}))return e;var u=e;e={then(e){Promise.all(l.map(__webpack_require__)).then(()=>e(u))}}}if(e[t])return e;if(e.then){var c=[];c.d=0,e.then(e=>{d[n]=e,s(c)},e=>{d[i]=e,s(c)});var d={};return d[o]=!1,d[t]=e=>e(c),d}}var p={};return p[t]=()=>{},p[n]=e,p});__webpack_require__.a=(e,u,c)=>{c&&((d=[]).d=-1);var d,p,h,f,g=new Set,m=e.exports,y=new Promise((e,t)=>{f=t,h=e});y[n]=m,y[t]=e=>{d&&e(d),g.forEach(e),y.catch(()=>{})},e.exports=y,u(e=>{p=l(e);var a,s=()=>p.map(e=>{if(e[o])return e;if(e[i])throw e[i];return e[n]}),u=new Promise(e=>{(a=()=>e(s)).r=0;var n=e=>e!==d&&!g.has(e)&&(g.add(e),e&&!e.d&&(a.r++,e.push(a)));p.map(e=>e[o]||e[t](n))});return a.r?u:s()},e=>(e?f(y[i]=e):h(m),s(d),y[a]=!0)),d&&d.d<0&&(d.d=0)}})(),(()=>{__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t}})(),(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;__webpack_require__.t=function(n,i){if(1&i&&(n=this(n)),8&i||"object"==typeof n&&n&&(4&i&&n.__esModule||16&i&&"function"==typeof n.then))return n;var a=Object.create(null);__webpack_require__.r(a);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&n;("object"==typeof s||"function"==typeof s)&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>{o[e]=()=>n[e]});return o.default=()=>n,__webpack_require__.d(a,o),a}})(),(()=>{__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}})(),(()=>{__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce((t,n)=>(__webpack_require__.f[n](e,t),t),[]))})(),(()=>{__webpack_require__.u=e=>"static/js/async/"+e+"."+({0:"a4a89d81",128:"1909ab33",138:"e1e226bd",151:"f9ff9fd2",214:"6d0e2d4a",266:"644264b5",472:"699ccb2b",891:"e26d3efc",906:"46dfaab0",91:"87c94897"})[e]+".js"})(),(()=>{__webpack_require__.miniCssF=e=>""+e+".css"})(),(()=>{__webpack_require__.g=(()=>{if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}})()})(),(()=>{__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="@kaya/web:";__webpack_require__.l=function(n,i,a,o){if(e[n])return void e[n].push(i);if(void 0!==a)for(var s,l,u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==n||d.getAttribute("data-rspack")==t+a){s=d;break}}s||(l=!0,(s=document.createElement("script")).timeout=120,__webpack_require__.nc&&s.setAttribute("nonce",__webpack_require__.nc),s.setAttribute("data-rspack",t+a),s.src=n),e[n]=[i];var p=function(t,i){s.onerror=s.onload=null,clearTimeout(h);var a=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach(function(e){return e(i)}),t)return t(i)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),l&&document.head.appendChild(s)}})(),(()=>{__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{__webpack_require__.p="/kaya/next/"})(),(()=>{__webpack_require__.v=function(e,t,n,i){var a=fetch(__webpack_require__.p+"static/wasm/"+n.slice(0,8)+".module.wasm"),o=function(){return a.then(function(e){return e.arrayBuffer()}).then(function(e){return WebAssembly.instantiate(e,i)}).then(function(t){return Object.assign(e,t.instance.exports)})};return a.then(function(t){return"function"==typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(t,i).then(function(t){return Object.assign(e,t.instance.exports)},function(e){if("application/wasm"!==t.headers.get("Content-Type"))return console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e),o();throw e}):o()})}})(),(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={410:0};__webpack_require__.f.j=function(t,n){var i=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var a=new Promise((n,a)=>i=e[t]=[n,a]);n.push(i[2]=a);var o=__webpack_require__.p+__webpack_require__.u(t),s=Error(),l=function(n){if(__webpack_require__.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,i[1](s)}};__webpack_require__.l(o,l,"chunk-"+t,t)}};var t=(t,n)=>{var i,a,[o,s,l]=n,u=0;if(o.some(t=>0!==e[t])){for(i in s)__webpack_require__.o(s,i)&&(__webpack_require__.m[i]=s[i]);l&&l(__webpack_require__)}for(t&&t(n);u<o.length;u++)a=o[u],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunk_kaya_web=self.webpackChunk_kaya_web||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var __webpack_exports__={};(()=>{"use strict";let e,t,n;var i,a,o,s,l,u,c,d,p,h,f,g={};__webpack_require__.r(g),__webpack_require__.d(g,{boolean:()=>bz,booleanish:()=>bj,commaOrSpaceSeparated:()=>bU,commaSeparated:()=>bB,number:()=>bL,overloadedBoolean:()=>bR,spaceSeparated:()=>bF});var m={};__webpack_require__.r(m),__webpack_require__.d(m,{attentionMarkers:()=>wX,contentInitial:()=>wV,disable:()=>wZ,document:()=>wU,flow:()=>wH,flowInitial:()=>wG,insideSpan:()=>wK,string:()=>wW,text:()=>wq});var y={};__webpack_require__.r(y),__webpack_require__.d(y,{T_:()=>CO,$s:()=>Cy,as:()=>CS,Mi:()=>CT,IO:()=>CC,ES:()=>CM,Bf:()=>Cz,ls:()=>CN,yQ:()=>CA,qh:()=>C_,Lx:()=>Cv,K9:()=>Cw,WZ:()=>Cb,J4:()=>Cx,FS:()=>CP,fm:()=>CD,GG:()=>Ck});var b={};__webpack_require__.r(b),__webpack_require__.d(b,{FILE:()=>Ou,HTML:()=>Op,TEXT:()=>Od,URL:()=>Oc});var v=__webpack_require__(85),x=__webpack_require__(41),w=__webpack_require__.t(x,2),_=__webpack_require__(873);let S=(0,x.createContext)(void 0),k="kaya-theme",T=e=>{let{children:t}=e,[n,i]=(0,x.useState)(()=>{if("undefined"!=typeof window){let e=localStorage.getItem(k);if("dark"===e||"light"===e)return e}return"dark"});(0,x.useEffect)(()=>{"undefined"!=typeof window&&(document.documentElement.setAttribute("data-theme",n),localStorage.setItem(k,n))},[n]);let a=()=>{i(e=>"dark"===e?"light":"dark")},o=e=>{i(e)};return(0,v.jsx)(S.Provider,{value:{theme:n,toggleTheme:a,setTheme:o},children:t})},C=()=>{let e=(0,x.useContext)(S);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e};var E=__webpack_require__(990);class I{static new(){let e=5381;return t=>{for(let n=0;n<t.length;n++)e=33*e^t.charCodeAt(n);return e}}}class ${get(e){if(null==e)return null;if(e in this._idAliases)return this.get(this._idAliases[e]);if(e in this._nodeCache)return this._nodeCache[e];let t=this.base.get(e);if(null==t)return this._nodeCache[e]=null,null;let n={...t,data:{...t.data},children:[...t.children]};if(null!=t.parentId){let i=this.get(t.parentId);if(i){let t=i.children.findIndex(t=>t.id===e);t>=0&&(i.children[t]=n)}}return this._nodeCache[e]=n,this.root.id===e&&(this.root=n),n}_getLevel(e){let t=-1,n=this.get(e),i=new Set;for(;null!=n;){if(i.has(n.id)){console.error("Circular reference detected in game tree at _getLevel!",n.id);break}i.add(n.id),t++,n=this.get(n.parentId)}return t}appendNode(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.base.getId();if(!this.UNSAFE_appendNodeWithId(e,i,t,n))return null;if(!(i in this._idAliases))return i;let a=this._idAliases[i];return delete this._idAliases[i],a}UNSAFE_appendNodeWithId(e,t,n){let{disableMerging:i=!1}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=this.get(e);if(null==a)return!1;let[o,s]=(()=>{if(!i)for(let e of a.children){let t=this.base.merger(e,n);if(null!=t)return[e.id,t]}return[null,null]})();if(null!=o){let e=this.get(o);e&&(e.data=s),t!==o&&(this._idAliases[t]=o)}else{let i={id:t,data:n,parentId:e,children:[]};a.children.push(i),this._nodeCache[t]=i,this._structureHashCache=null,null!=this._heightCache&&this._getLevel(e)===this._heightCache-1&&this._heightCache++}return!0}removeNode(e){let t=this.get(e);if(null==t)return!1;let n=t.parentId;if(null==n)throw Error("Cannot remove root node");let i=this.get(n);if(null==i)return!1;let a=i.children.findIndex(t=>t.id===e);return a>=0&&(i.children.splice(a,1),this._nodeCache[e]=null,this._structureHashCache=null,this._heightCache=null,!0)}shiftNode(e,t){if(!["left","right","main"].includes(t))throw Error("Invalid value for direction, only 'left', 'right', or 'main' allowed");let n=this.get(e);if(null==n)return null;let{parentId:i}=n,a=this.get(i);if(null==a)return null;let o=a.children.findIndex(t=>t.id===e);if(o<0)return null;let s="left"===t?Math.max(o-1,0):"right"===t?Math.min(o+1,a.children.length):0;if(o!==s){let[e]=a.children.splice(o,1);a.children.splice(s,0,e)}return this._structureHashCache=null,s}makeRoot(e){if(e===this.root.id)return!0;let t=this.get(e);return null!=t&&(t.parentId=null,this.root=t,this._passOnNodeCache=!1,this._heightCache=null,this._structureHashCache=null,!0)}addToProperty(e,t,n){let i=this.get(e);if(null==i)return!1;let a=i.data;return t in a?a[t].includes(n)||(a[t]=[...a[t],n]):a[t]=[n],!0}removeFromProperty(e,t,n){let i=this.get(e);if(null==i)return!1;let a=i.data;return t in a&&(a[t]=a[t].filter(e=>e!==n),0===a[t].length&&delete a[t],!0)}updateProperty(e,t,n){let i=this.get(e);return null!=i&&(null==n||0===n.length?delete i.data[t]:i.data[t]=n,!0)}removeProperty(e,t){return this.updateProperty(e,t,null)}constructor(e){(0,E._)(this,"base",void 0),(0,E._)(this,"root",void 0),(0,E._)(this,"_passOnNodeCache",void 0),(0,E._)(this,"_nodeCache",void 0),(0,E._)(this,"_idAliases",void 0),(0,E._)(this,"_heightCache",void 0),(0,E._)(this,"_structureHashCache",void 0),this.base=e,this.root=e.root,this._passOnNodeCache=!0,this._nodeCache={},this._idAliases=e._idAliases,this._heightCache=e._heightCache,this._structureHashCache=e._structureHashCache}}class O{get(e){let t=null;if(null==e)return t;if(e in this._idAliases)return this.get(this._idAliases[e]);if(e in this._nodeCache)t=this._nodeCache[e];else{let n=t=>{if(this._nodeCache[t.id]=t,t.id===e)return t;for(let e of t.children){let t=n(e);if(null!=t)return t}return null};t=n(this.root)}if(null==t)return this._nodeCache[e]=null,null;for(let e of t.children)this._nodeCache[e.id]=e;return t}*getSequence(e){let t=this.get(e);if(null==t)return;yield t;let n=new Set;for(n.add(t.id);1===t.children.length;){if(t=t.children[0],n.has(t.id)){console.error("Circular reference detected in getSequence!",t.id);break}for(let e of(n.add(t.id),this._nodeCache[t.id]=t,t.children))this._nodeCache[e.id]=e;yield t}}mutate(e){let t=new $(this);if(e(t),t.root===this.root)return this;let n=new O({getId:this.getId,merger:this.merger,root:t.root});return t._passOnNodeCache&&(n._nodeCache=t._nodeCache),n._idAliases=t._idAliases,n._structureHashCache=t._structureHashCache,n._heightCache=t._heightCache,n}navigate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.get(e);if(null==i)return null;if(0===t)return i;if(t<0&&null!=i.parentId)return this.navigate(i.parentId,t+1,n);let a=null!=n[i.id]?n[i.id]:i.children.length>0?i.children[0].id:null;return null==a?null:this.navigate(a,t-1,n)}*listNodes(){function*e(t){for(let n of(yield t,t.children))yield*e(n)}yield*e(this.root)}*listNodesHorizontally(e,t){if(1!==Math.abs(t))throw Error("Invalid value for step, only -1 or 1 allowed");let n=this.getLevel(e);if(null==n)return;let i=[...this.getSection(n)],a=i.findIndex(t=>t.id===e);for(;null!=i[a];){for(;0<=a&&a<i.length;)yield i[a],a+=t;n+=t,i=t>0?[].concat(...i.map(e=>e.children)):[...this.getSection(n)],a=t>0?0:i.length-1}}*listNodesVertically(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(1!==Math.abs(t))throw Error("Invalid value for step, only -1 or 1 allowed");let i=this.get(e),a=new Set;for(;null!=i;){if(a.has(i.id)){console.error("Circular reference detected in listNodesVertically!",i.id);break}a.add(i.id),yield i,i=this.navigate(i.id,t,n)}}*listCurrentNodes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};yield*this.listNodesVertically(this.root.id,1,e)}*listMainNodes(){yield*this.listCurrentNodes({})}getLevel(e){let t=-1;for(let n of this.listNodesVertically(e,-1,{}))t++;return t<0?null:t}*getSection(e){if(!(e<0)){if(0===e)return void(yield this.root);for(let t of this.getSection(e-1))yield*t.children}}getCurrentHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=0,n=this.root,i=new Set;for(;null!=n;){if(i.has(n.id)){console.error("Circular reference detected in getCurrentHeight!",n.id);break}i.add(n.id),t++,n=null==e[n.id]?n.children[0]:n.children.find(t=>t.id===e[n.id])}return t}getHeight(){if(null==this._heightCache){let e=t=>{let n=0;for(let i of t.children)n=Math.max(n,e(i));return n+1};this._heightCache=e(this.root)}return this._heightCache}getStructureHash(){if(null==this._structureHashCache){let e=I.new(),t=n=>(e("["+JSON.stringify(n.id)+","),n.children.forEach(t),e("]"));this._structureHashCache=t(this.root)}return(this._structureHashCache>>>0)+""}getHash(){if(null==this._hashCache){let e=I.new(),t=n=>(e("["+JSON.stringify(n.data)+","),n.children.forEach(t),e("]"));this._hashCache=t(this.root)}return(this._hashCache>>>0)+""}onCurrentLine(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(let n of this.listNodesVertically(e,-1,{})){let{parentId:e}=n;if(null!=e&&t[e]!==n.id&&(null!=t[e]||this.get(e).children[0]!==n))return!1}return!0}onMainLine(e){return this.onCurrentLine(e,{})}toJSON(){return this.root}constructor({getId:e,merger:t,root:n}={}){(0,E._)(this,"getId",void 0),(0,E._)(this,"merger",void 0),(0,E._)(this,"root",void 0),(0,E._)(this,"_nodeCache",void 0),(0,E._)(this,"_idAliases",void 0),(0,E._)(this,"_heightCache",void 0),(0,E._)(this,"_hashCache",void 0),(0,E._)(this,"_structureHashCache",void 0);const i={id:0,data:{},parentId:null,children:[],...n||{}};if(e)this.getId=e;else{let e=-1;const t=n=>{let i="number"==typeof n.id?n.id:-1;i>e&&(e=i),n.children.forEach(t)};t(i);let n=e+1;this.getId=()=>n++}this.merger=t||(()=>null),this.root=i,this._nodeCache={},this._idAliases={},this._heightCache=null,this._hashCache=null,this._structureHashCache=null}}let A="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function N(e){return e.toString().replace(/\\/g,"\\\\").replace(/\]/g,"\\]")}function P(e){let t=[],n=!1,i=e.replace(/\r/g,"");for(let e=0;e<i.length;e++)n?("\n"!==i[e]&&t.push(i[e]),n=!1):"\\"!==i[e]?t.push(i[e]):n=!0;return t.join("")}function D(e){return 2!==e.length?[-1,-1]:[A.indexOf(e[0]),A.indexOf(e[1])]}function M(e){return e&&2===e.length?[e.charCodeAt(0)-97,e.charCodeAt(1)-97]:null}function z(e){let[t,n]=e;return -1===t||-1===n?"":String.fromCharCode(97+t)+String.fromCharCode(97+n)}function j(e){let t=e.indexOf(":");if(t<0)return[D(e)];let[n,i]=D(e.slice(0,t)),[a,o]=D(e.slice(t+1)),s=[];for(let e=Math.min(n,a);e<=Math.max(n,a);e++)for(let t=Math.min(i,o);t<=Math.max(i,o);t++)s.push([e,t]);return s}function R(e){let t=new Map;if(e.MA)for(let n of e.MA)for(let[e,i]of j(n))e>=0&&i>=0&&t.set(`${e},${i}`,{type:"cross"});if(e.TR)for(let n of e.TR)for(let[e,i]of j(n))e>=0&&i>=0&&t.set(`${e},${i}`,{type:"triangle"});if(e.CR)for(let n of e.CR)for(let[e,i]of j(n))e>=0&&i>=0&&t.set(`${e},${i}`,{type:"circle"});if(e.SQ)for(let n of e.SQ)for(let[e,i]of j(n))e>=0&&i>=0&&t.set(`${e},${i}`,{type:"square"});if(e.LB)for(let n of e.LB){let e=n.indexOf(":");if(e>=0){let i=n.slice(0,e),a=n.slice(e+1),[o,s]=D(i);o>=0&&s>=0&&t.set(`${o},${s}`,{type:"label",label:a})}}return t}function*L(e){let t=e.length,n=0,i=0,a=0;for(;n<t;){let o=n,s=i,l=a,u=e[n];if(/\s/.test(u)){"\n"===u?(i++,a=0):a++,n++;continue}if("("===u||")"===u){yield{type:"parenthesis",value:u,row:s,col:l,pos:o,progress:o/(t-1)},n++,a++;continue}if(";"===u){yield{type:"semicolon",value:u,row:s,col:l,pos:o,progress:o/(t-1)},n++,a++;continue}if(/[A-Za-z]/.test(u)){let i="";for(;n<t&&/[A-Za-z]/.test(e[n]);)i+=e[n],n++,a++;yield{type:"prop_ident",value:i,row:s,col:l,pos:o,progress:o/(t-1)};continue}if("["===u){let u="[";n++,a++;let c=!1;for(;n<t;){let t=e[n];if(u+=t,"\n"===t?(i++,a=0):a++,!c&&"]"===t){n++;break}c="\\"===t&&!c,n++}yield{type:"c_value_type",value:u,row:s,col:l,pos:o,progress:o/(t-1)};continue}yield{type:"invalid",value:u,row:s,col:l,pos:o,progress:o/(t-1)},n++,a++}}class F{peek(){return null===this.peeked&&(this.peeked=this.iterator.next()),this.peeked}next(){if(null!==this.peeked){let e=this.peeked;return this.peeked=null,e}return this.iterator.next()}constructor(e){(0,E._)(this,"iterator",void 0),(0,E._)(this,"peeked",null),this.iterator=e[Symbol.iterator]()}}function B(e,t,n){let{getId:i,dictionary:a,onProgress:o,onNodeCreated:s}=n,l=null,u=null,c=null;for(;!e.peek().done;){let{type:n,value:o,row:d,col:p}=e.peek().value;if("parenthesis"===n&&"("===o)break;if("parenthesis"===n&&")"===o)return null!==u&&s({node:u}),l;if("semicolon"===n||null===u){let e=u;u={id:i(),data:{},parentId:null===e?t:e.id,children:[]},null!==a&&(a[String(u.id)]=u),null!==e?(s({node:e}),e.children.push(u)):l=u}if("semicolon"===n);else if("prop_ident"===n){if(null!==u){let e=o===o.toUpperCase()?o:o.split("").filter(e=>e.toUpperCase()===e).join("");""!==e?(e in u.data||(u.data[e]=[]),c=u.data[e]):c=null}}else if("c_value_type"===n)null!==c&&c.push(P(o.slice(1,-1)));else if("invalid"===n)throw Error(`Unexpected token at ${d+1}:${p+1}`);else throw Error(`Unexpected token type '${n}' at ${d+1}:${p+1}`);e.next()}for(null===u?l={id:null,data:{},parentId:null,children:[]}:s({node:u});!e.peek().done;){let{type:t,value:i,progress:a}=e.peek().value;if("parenthesis"===t&&"("===i){e.next();let t=u??l,i=B(e,(null==t?void 0:t.id)??null,n);null!==i&&null!==t&&t.children.push(i)}else if("parenthesis"===t&&")"===i){o({progress:a});break}e.next()}return l}function U(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(()=>{let e=0;return()=>e++})(),i={getId:t.getId??n,dictionary:t.dictionary??null,onProgress:t.onProgress??(()=>{}),onNodeCreated:t.onNodeCreated??(()=>{})},a=B(new F(e),null,i);return a?null==a.id?a.children:[a]:[]}function V(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return U(L(e),t)}function G(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{value:0},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(i.has(e))throw Error("SGF file contains circular references");i.add(e);let a=e.id??t.value++,o={};for(let[t,n]of Object.entries(e.data))Array.isArray(n)&&(o[t]=n.map(e=>{if("string"==typeof e){let n=e.replace(/\[object Object\\?\]/g,"").trim();return("B"===t||"W"===t)&&""===n&&""===e?"":n}return e}).filter(e=>"B"===t||"W"===t||""!==e));return{id:a,data:o,parentId:n,children:e.children.map(e=>G(e,t,a,i))}}function H(e){var t,n,i,a,o,s,l,u,c,d,p,h,f,g,m,y;let b,v={boardSize:19};if(!e)return v;let{data:x}=e;return(null==(t=x.TM)?void 0:t[0])?(b=x.TM[0],(null==(y=x.OT)?void 0:y[0])&&(b+=` ${x.OT[0]}`)):(null==(n=x.OT)?void 0:n[0])&&(b=x.OT[0]),{playerBlack:null==(i=x.PB)?void 0:i[0],playerWhite:null==(a=x.PW)?void 0:a[0],rankBlack:null==(o=x.BR)?void 0:o[0],rankWhite:null==(s=x.WR)?void 0:s[0],gameName:null==(l=x.GN)?void 0:l[0],eventName:null==(u=x.EV)?void 0:u[0],komi:(null==(c=x.KM)?void 0:c[0])?parseFloat(x.KM[0]):void 0,handicap:(null==(d=x.HA)?void 0:d[0])?parseInt(x.HA[0],10):void 0,boardSize:(null==(p=x.SZ)?void 0:p[0])?parseInt(x.SZ[0],10):19,date:null==(h=x.DT)?void 0:h[0],result:null==(f=x.RE)?void 0:f[0],rules:null==(g=x.RU)?void 0:g[0],timeControl:b,place:null==(m=x.PC)?void 0:m[0]}}function W(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{linebreak:n="\n",indent:i="  ",level:a=0}=t;if(Array.isArray(e))return W({data:{},id:null,parentId:null,children:e},t);let o=e,s=[],l=""!==n?i.repeat(a):"";if(o.data&&Object.keys(o.data).length>0){for(let e in s.push(l,";"),o.data)e.toUpperCase()===e&&s.push(e,"[",o.data[e].map(N).join("]["),"]");s.push(n)}if(o.children.length>1||o.children.length>0&&0===a){for(let e of(s.push(l),o.children))s.push("(",n,W(e,{linebreak:n,indent:i,level:a+1}),l,")");s.push(n)}else 1===o.children.length&&s.push(W(o.children[0],{linebreak:n,indent:i,level:a}));return s.join("")}class q{static fromDimensions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return new q(Array.from({length:t},()=>Array(e).fill(0)))}get(e){var t;let[n,i]=e;return(null==(t=this.signMap[i])?void 0:t[n])??null}set(e,t){let[n,i]=e;return this.has(e)&&(this.signMap[i]=this.signMap[i].slice(),this.signMap[i][n]=t),this}has(e){let[t,n]=e;return t>=0&&t<this.width&&n>=0&&n<this.height}clear(){return this.signMap=this.signMap.map(e=>e.map(()=>0)),this}makeMove(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{preventSuicide:i=!1,preventOverwrite:a=!1,preventKo:o=!1,disableKoCheck:s=!1,mutate:l=!1}=n,u=l?this:this.clone();if(0===e||!this.has(t))return u;if(a&&this.get(t))throw Error("Overwrite prevented");let c=e>0?1:-1;if(o&&this._koInfo.sign===c&&this.vertexEquals(this._koInfo.vertex,t))throw Error("Ko prevented");u.set(t,c);let d=u.getNeighbors(t),p=[];for(let e of d.filter(e=>u.get(e)===-c&&!u.hasLiberties(e)))if(0!==u.get(e))for(let t of u.getChain(e))u.set(t,0).setCaptures(c,e=>e+1),p.push(t);if(s)u._koInfo={sign:0,vertex:[-1,-1]};else{let e=u.getLiberties(t),n=1===p.length&&1===e.length&&this.vertexEquals(e[0],p[0])&&d.every(e=>u.get(e)!==c);if(u._koInfo={sign:n?-c:0,vertex:n?p[0]:[-1,-1]},0===p.length&&0===e.length){if(i)throw Error("Suicide prevented");for(let e of u.getChain(t))u.set(e,0).setCaptures(-c,e=>e+1)}}return u}analyzeMove(e,t){let n=0===e||!this.has(t),i=!n&&!!this.get(t),a=this._koInfo.sign===e&&this.vertexEquals(this._koInfo.vertex,t);if(n||i)return{pass:n,overwrite:i,capturing:!1,suicide:!1,ko:a,valid:!1};let o=this.clone(),s=e>0?1:-1;o.set(t,s);let l=o.getNeighbors(t),u=[];for(let e of l)if(o.get(e)===-s&&!o.hasLiberties(e)){let t=o.getChain(e);u.some(e=>e.some(e=>t.some(t=>o.vertexEquals(e,t))))||u.push(t)}let c=u.length>0;for(let e of u)for(let t of e)o.set(t,0);let d=!o.hasLiberties(t),p=!d&&!a;return{pass:n,overwrite:i,capturing:c,suicide:d,ko:a,valid:p}}getCaptures(e){return 1===e?this._captures[0]:this._captures[1]}setCaptures(e,t){let n=+(1!==e);return this._captures[n]="function"==typeof t?t(this._captures[n]):t,this}isSquare(){return this.width===this.height}isEmpty(){return this.signMap.every(e=>e.every(e=>!e))}isValid(){let e={};for(let t=0;t<this.width;t++)for(let n=0;n<this.height;n++){let i=[t,n],a=i.toString();if(0!==this.get(i)&&!e[a]){if(!this.hasLiberties(i))return!1;this.getChain(i).forEach(t=>{e[t.toString()]=!0})}}return!0}getDistance(e,t){return Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1])}getNeighbors(e){let[t,n]=e;return[[t-1,n],[t+1,n],[t,n-1],[t,n+1]].filter(e=>this.has(e))}getConnectedComponent(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!this.has(e)||!t(e))return n;let i=e.toString();if(n.some(e=>e.toString()===i))return n;for(let i of(n.push(e),this.getNeighbors(e)))this.getConnectedComponent(i,t,n);return n}getChain(e){let t=this.get(e);return null===t||0===t?[]:this.getConnectedComponent(e,e=>this.get(e)===t)}getRelatedChains(e){let t=this.get(e);if(null===t||0===t)return[];let n=[];for(let i of this.getNeighbors(e))if(this.get(i)===t){let e=this.getChain(i);n.some(t=>t.some(t=>e.some(e=>this.vertexEquals(t,e))))||n.push(e)}return n.flat()}getLiberties(e){let t=this.get(e);if(!this.has(e)||0===t)return[];let n=this.getChain(e),i=[],a={};for(let e of n)for(let t of this.getNeighbors(e)){let e=t.toString();0!==this.get(t)||a[e]||(i.push(t),a[e]=!0)}return i}hasLiberties(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.get(e);if(!this.has(e)||0===n)return!1;let i=e.toString();if(t[i])return!1;let a=this.getNeighbors(e);return!!a.some(e=>0===this.get(e))||(t[i]=!0,a.filter(e=>this.get(e)===n).some(e=>this.hasLiberties(e,t)))}clone(){let e=new q(this.signMap.slice());return e._captures=[this._captures[0],this._captures[1]],e._koInfo={sign:this._koInfo.sign,vertex:[this._koInfo.vertex[0],this._koInfo.vertex[1]]},e}equals(e){if(e.width!==this.width||e.height!==this.height||this._captures[0]!==e._captures[0]||this._captures[1]!==e._captures[1]||this._koInfo.sign!==e._koInfo.sign||this._koInfo.vertex[0]!==e._koInfo.vertex[0]||this._koInfo.vertex[1]!==e._koInfo.vertex[1])return!1;for(let t=0;t<this.height;t++){let n=this.signMap[t],i=e.signMap[t];if(n!==i){for(let e=0;e<this.width;e++)if(n[e]!==i[e])return!1}}return!0}diff(e){if(e.width!==this.width||e.height!==this.height)return null;let t=[];for(let n=0;n<this.width;n++)for(let i=0;i<this.height;i++){let a=e.get([n,i]);this.get([n,i])!==a&&t.push([n,i])}return t}stringifyVertex(e){let t="ABCDEFGHJKLMNOPQRSTUVWXYZ";return this.has(e)?t[e[0]]+(this.height-e[1]):""}parseVertex(e){let t="ABCDEFGHJKLMNOPQRSTUVWXYZ";if(e.length<2)return[-1,-1];let n=[t.indexOf(e[0].toUpperCase()),this.height-parseInt(e.slice(1),10)];return this.has(n)?n:[-1,-1]}getHandicapPlacement(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{tygem:n=!1}=t;if(6>=Math.min(this.width,this.height)||e<2)return[];let i=this.width>=13?3:2,a=this.height>=13?3:2,o=this.width-i-1,s=this.height-a-1,l=(this.width-1)/2,u=(this.height-1)/2,c=n?[[i,s],[o,a],[i,a],[o,s]]:[[i,s],[o,a],[o,s],[i,a]];return this.width%2!=0&&this.height%2!=0&&7!==this.width&&7!==this.height?(5===e&&c.push([l,u]),c.push([i,u],[o,u]),7===e&&c.push([l,u]),c.push([l,a],[l,s],[l,u])):this.width%2!=0&&7!==this.width?c.push([l,a],[l,s]):this.height%2!=0&&7!==this.height&&c.push([i,u],[o,u]),c.slice(0,e)}vertexEquals(e,t){return e[0]===t[0]&&e[1]===t[1]}constructor(e=[]){if((0,E._)(this,"signMap",void 0),(0,E._)(this,"width",void 0),(0,E._)(this,"height",void 0),(0,E._)(this,"_captures",void 0),(0,E._)(this,"_koInfo",void 0),this.signMap=e,this.height=e.length,this.width=0===this.height?0:e[0].length,e.some(e=>e.length!==this.width))throw Error("signMap is not well-formed");this._captures=[0,0],this._koInfo={sign:0,vertex:[-1,-1]}}}function K(e,t){let n,i;if(t<2||t>9)return[];19===e?(n=3,i=9):13===e?(n=3,i=6):9===e?(n=2,i=4):(n=e>=13?3:2,i=Math.floor(e/2));let a=[[e-1-n,n],[n,e-1-n],[e-1-n,e-1-n],[n,n],[i,i],[n,i],[e-1-n,i],[i,n],[i,e-1-n]];return({2:[0,1],3:[0,1,2],4:[0,1,2,3],5:[0,1,2,3,4],6:[0,1,2,3,5,6],7:[0,1,2,3,5,6,4],8:[0,1,2,3,5,6,7,8],9:[0,1,2,3,5,6,7,8,4]})[t].map(e=>a[e])}function X(e,t){let n=[],i=new Set,a=new Set;function o(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(s>1e4)return void n.push(`Maximum depth exceeded at node ${t}`);if(i.has(t))return void n.push(`Circular reference detected: node ${t} visited twice (path includes this node)`);i.add(t);let l=e.get(t);if(!l)return void n.push(`Node ${t} not found in tree`);for(let e of(a.has(l.id)&&n.push(`Duplicate node ID: ${l.id} (appears multiple times in tree structure)`),a.add(l.id),l.children))e.parentId!==l.id&&n.push(`Child ${e.id} has wrong parentId: ${e.parentId} (should be ${l.id})`),o(e.id,s+1)}try{o(t)}catch(e){n.push(`Validation error: ${e}`)}return n}let Z=new Map,Y=200,Q=new Map,J=500;function ee(){Z.clear(),Q.clear()}function et(e,t){let n=[],i=t;for(;null!==i;){let t=e.get(i);if(!t)break;n.push(t),i=t.parentId}return n.reverse()}function en(e,t,n){if(null==t)return q.fromDimensions(n);let i=`${t}-${n}`,a=Z.get(i);if(a)return Z.delete(i),Z.set(i,a),a;let o=et(e,t),s=q.fromDimensions(n),l=-1;for(let e=o.length-1;e>=0;e--){let t=`${o[e].id}-${n}`,i=Z.get(t);if(i){s=i,l=e;break}}let u=-1===l;for(let e=l+1;e<o.length;e++){var c,d;let t=o[e],{data:i}=t,a=e%20==0||e===o.length-1,l=u,p=!1;if(i.AB||i.AW||i.AE){for(let e of(l||(s=s.clone(),u=!0),i.AB||[])){let t=M(e);t&&s.set(t,1)}for(let e of i.AW||[]){let t=M(e);t&&s.set(t,-1)}for(let e of i.AE||[]){let t=M(e);t&&s.set(t,0)}}let h=(null==(c=i.B)?void 0:c[0])||(null==(d=i.W)?void 0:d[0]);if(h){let e=M(h);if(e&&e[0]>=0&&e[1]>=0){let t=i.B?1:-1;try{s=s.makeMove(t,e,{mutate:l,disableKoCheck:p}),u=!0}catch{}}}if(a){let e=`${t.id}-${n}`;if(!Z.has(e)){if(Z.size>=Y){let e=Z.keys().next().value;e&&Z.delete(e)}Z.set(e,s)}u=!1}}return s}function er(){let[e,t]=(0,x.useState)(null),[n,i]=(0,x.useState)(()=>`game-${Date.now()}`),[a,o]=(0,x.useState)(null),[s,l]=(0,x.useState)(null),[u,c]=(0,x.useState)(null),[d,p]=(0,x.useState)(!1),h=(0,x.useRef)(null),f=null!==e&&e!==h.current,g=(0,x.useCallback)(()=>{h.current=e},[e]),m=(0,x.useCallback)(t=>{t?h.current=null:h.current=e},[e]),[y,b]=(0,x.useState)(!1),[v,w]=(0,x.useState)(0),[_,S]=(0,x.useState)(""),k=(0,x.useMemo)(()=>e&&null!=s?H(e.get(s)):{boardSize:19},[e,s]);(0,x.useEffect)(()=>{if(e||d)return;if("undefined"!=typeof window&&window.localStorage)try{let e=localStorage.getItem("kaya-auto-save");if(e){let{sgf:n,currentNodeId:i,fileName:a}=JSON.parse(e);if(n)try{let e=V(n);if(e&&e.length>0){let n={value:0},s=G(e[0],n,null),u=new O({root:s}),d=X(u,s.id);if(d.length>0)throw console.error("\uD83D\uDD34 Tree integrity issues after restoration:",d),Error("Corrupted tree detected");ee(),t(u),h.current=u,l(s.id),o(i??s.id),c(a??null),p(!0);return}}catch(e){console.error("Failed to parse auto-saved SGF:",e)}}}catch(e){console.error("Failed to restore game:",e),localStorage.removeItem("kaya-auto-save")}let n=new O({root:{id:0,data:{SZ:["19"],KM:["6.5"]},parentId:null,children:[]}});ee(),t(n),h.current=n,l(0),o(0),p(!0)},[e,d]);let T=(0,x.useCallback)(e=>{try{b(!0),w(0),S("Parsing SGF..."),setTimeout(()=>{try{let n=V(e,{onProgress:e=>{let{progress:t}=e;return w(.5*t)}});if(!n||0===n.length)throw Error("Invalid SGF content");S("Building game tree...");let a={value:0},s=G(n[0],a,null);w(.9);let u=new O({root:s}),c=X(u,s.id);if(c.length>0)throw console.error("Tree integrity issues:",c),Error("Tree validation failed: "+c[0]);ee(),t(u),h.current=u,l(s.id);let d=s.data.MA||s.data.TR||s.data.CR||s.data.SQ||s.data.LB,p=s.data.B||s.data.W,f=s.children.length>3;if(f&&!p&&!d&&s.children.length>0)o(s.children[0].id);else if(d||f)o(s.id);else{let e=s;for(;e.children.length>0;)e=e.children[0];o(e.id)}i(`game-${Date.now()}`),w(1),S("Done")}catch(e){console.error("Error loading SGF:",e),alert("Failed to load SGF file")}finally{b(!1)}},10)}catch(e){console.error("Error initiating SGF load:",e),b(!1)}},[]),C=(0,x.useCallback)(async e=>new Promise((n,a)=>{try{b(!0),w(0),S("Parsing SGF..."),setTimeout(()=>{try{let a=V(e,{onProgress:e=>{let{progress:t}=e;return w(.5*t)}});if(!a||0===a.length)throw Error("Invalid SGF content");S("Building game tree...");let s={value:0},u=G(a[0],s,null);w(.9);let c=new O({root:u}),d=X(c,u.id);if(d.length>0)throw Error("Tree validation failed: "+d[0]);ee(),t(c),h.current=c,l(u.id);let p=u.data.MA||u.data.TR||u.data.CR||u.data.SQ||u.data.LB,f=u.data.B||u.data.W,g=u.children.length>3;if(g&&!f&&!p&&u.children.length>0)o(u.children[0].id);else if(p||g)o(u.id);else{let e=u;for(;e.children.length>0;)e=e.children[0];o(e.id)}i(`game-${Date.now()}`),w(1),S("Done"),n()}catch(e){a(e)}finally{b(!1)}},10)}catch(e){b(!1),a(e)}}),[]),E=(0,x.useCallback)(e=>{let n=new Date,a=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`,s={SZ:[(null==e?void 0:e.boardSize)?String(e.boardSize):"19"],KM:[(null==e?void 0:e.komi)?String(e.komi):"6.5"],GM:["1"],FF:["4"],CA:["UTF-8"],AP:["Kaya:0.1.0"],DT:[a]};if((null==e?void 0:e.playerBlack)&&(s.PB=[e.playerBlack]),(null==e?void 0:e.playerWhite)&&(s.PW=[e.playerWhite]),(null==e?void 0:e.rankBlack)&&(s.BR=[e.rankBlack]),(null==e?void 0:e.rankWhite)&&(s.WR=[e.rankWhite]),(null==e?void 0:e.handicap)&&e.handicap>0){s.HA=[String(e.handicap)];let t=K(e.boardSize||19,e.handicap);t.length>0&&(s.AB=t.map(e=>z(e))),s.PL=["W"]}let u=new O({root:{id:0,data:s,parentId:null,children:[]}});ee(),t(u),h.current=u,l(0),o(0),c("Untitled Game.sgf"),i(`game-${Date.now()}`)},[]),I=(0,x.useCallback)(()=>{if(!e||null===s)return"";let t=e.get(s);return t?W([t]):""},[e,s]),$=(0,x.useCallback)(n=>{e&&null!==s&&t(e=>e?e.mutate(e=>{e.get(s)&&(void 0!==n.playerBlack&&e.updateProperty(s,"PB",[n.playerBlack]),void 0!==n.playerWhite&&e.updateProperty(s,"PW",[n.playerWhite]),void 0!==n.rankBlack&&e.updateProperty(s,"BR",[n.rankBlack]),void 0!==n.rankWhite&&e.updateProperty(s,"WR",[n.rankWhite]),void 0!==n.komi&&e.updateProperty(s,"KM",[String(n.komi)]),void 0!==n.gameName&&e.updateProperty(s,"GN",[n.gameName]),void 0!==n.eventName&&e.updateProperty(s,"EV",[n.eventName]),void 0!==n.date&&e.updateProperty(s,"DT",[n.date]),void 0!==n.result&&e.updateProperty(s,"RE",[n.result]))}):null)},[e,s]);return{gameTree:e,setGameTree:t,gameId:n,currentNodeId:a,setCurrentNodeId:o,rootId:s,setRootId:l,filename:u,setFilename:c,isInitialized:d,isLoadingSGF:y,loadingProgress:v,loadingMessage:_,loadSGF:T,loadSGFAsync:C,createNewGame:E,saveSGF:I,updateGameInfo:$,gameInfo:k,isDirty:f,setIsDirty:m,markClean:g}}function ei(e){let{gameTree:t,currentNodeId:n,gameInfo:i,editMode:a=!1}=e,o=(0,x.useRef)(null),s=(0,x.useMemo)(()=>{let e=t?en(t,n,i.boardSize):q.fromDimensions(19);return o.current&&o.current.equals(e)?o.current:(o.current=e,e)},[t,n,i.boardSize]),l=(0,x.useMemo)(()=>t&&null!==n?t.get(n):null,[t,n]),u=(0,x.useMemo)(()=>{if(!l)return null;let e=R(l.data);if(a){let t=t=>{if(t)for(let n of t){let t=M(n);if(t&&t[0]>=0){let n=`${t[0]},${t[1]}`;e.has(n)||e.set(n,{type:"setup"})}}};t(l.data.AB),t(l.data.AW)}if(0===e.size)return null;let t=i.boardSize,n=Array(t).fill(null).map(()=>Array(t).fill(null));for(let[i,a]of e.entries()){let[e,o]=i.split(",").map(Number);e>=0&&e<t&&o>=0&&o<t&&(n[o][e]=a)}return n},[l,i.boardSize,a]),c=(0,x.useMemo)(()=>l&&t&&0!==l.children.length&&l.children[0]||null,[l,t]);return{currentBoard:s,currentNode:l,markerMap:u,nextMoveNode:c,moveNumber:(0,x.useMemo)(()=>t&&null!==n?et(t,n).filter(e=>e.data.B||e.data.W).length:0,[t,n])}}let ea=12,eo=()=>"undefined"!=typeof performance?performance.now():Date.now(),es=()=>{if("undefined"==typeof window)return!1;let e=window.__KAYA_ENABLE_PERF_LOGS;return"boolean"==typeof e&&e};function el(e,t,n){if(!es()||t<ea)return;let i=t>45?"\uD83D\uDC22":"",a=n?` ${n}`:"";console.log(`${i} ${e}${a}: ${t.toFixed(1)}ms`)}function eu(e){let{gameTree:t,currentNodeId:n,rootId:i,setCurrentNodeId:a}=e,o=(0,x.useRef)(new Map),s=(0,x.useRef)(new Map),l=(0,x.useCallback)((e,t)=>{o.current.set(t,{label:e,start:eo()})},[]),u=(0,x.useCallback)((e,t)=>{null==e||null!=t&&s.current.set(e,t)},[]),c=(0,x.useCallback)(e=>{if(!e||0===e.children.length)return null;let t=s.current.get(e.id);if(void 0!==t){let n=e.children.find(e=>e.id===t);if(n)return n}return e.children[0]??null},[]),d=(0,x.useCallback)(()=>{s.current.clear(),o.current.clear()},[]),p=(0,x.useMemo)(()=>t&&null!==n?t.get(n):null,[t,n]),h=(0,x.useMemo)(()=>p?c(p):null,[p,c]);(0,x.useEffect)(()=>{p&&null!==p.parentId&&void 0!==p.parentId&&u(p.parentId,p.id)},[p,u]),(0,x.useEffect)(()=>{if(null===n)return;let e=o.current.get(n);if(!e||e.stateCommittedAt)return;let t=eo();e.stateCommittedAt=t,el(`${e.label}  ${n}`,t-e.start,"state")},[n]);let f=(0,x.useMemo)(()=>{if(!p)return[];let e=p.children;if(0===e.length)return[];let t=Array(e.length);for(let a=0;a<e.length;a++){var n,i;let o=e[a],s=(null==(n=o.data.B)?void 0:n[0])?`B[${o.data.B[0]}]`:(null==(i=o.data.W)?void 0:i[0])?`W[${o.data.W[0]}]`:"";t[a]={nodeId:o.id,move:s}}return t},[p]),g=(0,x.useMemo)(()=>null!==p&&null!==p.parentId,[p]),m=(0,x.useMemo)(()=>null!==p&&p.children.length>0,[p]),y=(0,x.useCallback)(e=>{if(!t||e===n)return;let i=t.get(e);i&&(u(i.parentId,i.id),l("goToNode",e),a(e))},[t,n,l,u,a]);(0,x.useCallback)(()=>{if((null==p?void 0:p.parentId)===null||(null==p?void 0:p.parentId)===void 0)return;let e=p.parentId;l("goBack",e),a(e)},[p,l,a]),(0,x.useCallback)(()=>{if(!p)return;let e=c(p);e&&(u(p.id,e.id),l("goForward",e.id),a(e.id))},[p,l,u,c,a]);let b=(0,x.useCallback)(e=>{if(!t||null===n||e<=0)return;let i=n,o=t.get(i);for(let n=0;n<e&&o&&null!==o.parentId&&void 0!==o.parentId;n++)i=o.parentId,o=t.get(i);i!==n&&(l(`goBackSteps(${e})`,i),a(i))},[t,n,l,a]),v=(0,x.useCallback)(e=>{if(!t||null===n||e<=0)return;let i=n,o=t.get(i);for(let n=0;n<e&&o;n++){let e=c(o);if(!e)break;u(o.id,e.id),i=e.id,o=t.get(i)}i!==n&&(l(`goForwardSteps(${e})`,i),a(i))},[t,n,l,u,c,a]),w=(0,x.useCallback)(()=>{null!==i&&n!==i&&(l("goToStart",i),a(i))},[i,n,l,a]),_=(0,x.useCallback)(()=>{if(!t||null===n)return;let e=n,i=t.get(e),o=new Set;for(;i&&i.children.length>0;){if(o.has(e)){console.error("Circular reference detected in goToEnd!",e);break}o.add(e);let n=c(i);if(!n)break;u(i.id,n.id),e=n.id,i=t.get(e)}e!==n&&(l("goToEnd",e),a(e))},[t,n,l,u,c,a]),S=(0,x.useCallback)(e=>{if(!t||null==i)return;let n=t.get(i),o=0;for(;n&&o<e;){let e=c(n);if(!e)break;((n=e).data.B||n.data.W)&&o++}n&&(l(`navigateToMove(${e})`,n.id),a(n.id))},[t,i,c,l,a]),k=(0,x.useCallback)(()=>{if(!t||null==n)return;let e=t.get(n);for(;e;){let t=c(e);if(!t||(e=t).children.length>1)break}e&&e.id!==n&&(l("navigateToNextFork",e.id),a(e.id))},[t,n,c,l,a]),T=(0,x.useCallback)(()=>{if(!t||null==n)return;let e=t.get(n);for(;e&&e.parentId;){let n=t.get(e.parentId);if(!n||(e=n).children.length>1)break}e&&e.id!==n&&(l("navigateToPreviousFork",e.id),a(e.id))},[t,n,l,a]),C=(0,x.useCallback)(()=>{t&&null!=i&&(l("navigateToMainLine",i),a(i))},[t,i,l,a]),E=(0,x.useCallback)(()=>{if(!t||!p||null===p.parentId||void 0===p.parentId)return;let e=t.get(p.parentId);if(!e||e.children.length<=1)return;let n=e.children,i=n.findIndex(e=>e.id===p.id);if(-1===i)return;let o=(i-1+n.length)%n.length,s=n[o].id;l("goToPreviousSibling",s),a(s)},[t,p,l,a]),I=(0,x.useCallback)(()=>{if(!t||!p||null===p.parentId||void 0===p.parentId)return;let e=t.get(p.parentId);if(!e||e.children.length<=1)return;let n=e.children,i=n.findIndex(e=>e.id===p.id);if(-1===i)return;let o=(i+1)%n.length,s=n[o].id;l("goToNextSibling",s),a(s)},[t,p,l,a]),$=(0,x.useCallback)(e=>{if(!t||!p||null===p.parentId||void 0===p.parentId)return;let n=t.get(p.parentId);if(!n||n.children.length<=1)return;let i=n.children,o=Math.max(0,Math.min(e-1,i.length-1)),s=i[o].id;l(`goToSiblingIndex(${e})`,s),a(s)},[t,p,l,a]),O=(0,x.useMemo)(()=>{if(!t||!p||null===p.parentId||void 0===p.parentId)return{hasSiblings:!1,currentIndex:0,totalSiblings:0};let e=t.get(p.parentId);if(!e)return{hasSiblings:!1,currentIndex:0,totalSiblings:0};let n=e.children,i=n.findIndex(e=>e.id===p.id);return{hasSiblings:n.length>1,currentIndex:i+1,totalSiblings:n.length}},[t,p]),A=(0,x.useCallback)(()=>{if(!t||!p)return null;let e=p,n=0;for(;e&&null!==e.parentId&&void 0!==e.parentId;){let i=t.get(e.parentId);if(!i)break;if(i.children.length>1)return{branchRootNode:e,forkNode:i,depthFromBranchRoot:n};(e.data.B||e.data.W)&&n++,e=i}return null},[t,p]),N=(0,x.useMemo)(()=>{if(!t||!p)return{hasBranches:!1,currentIndex:0,totalBranches:0,isAtFork:!1,depthFromBranchRoot:0,forkNodeId:null,branchRootId:null};let e=A();if(!e)return{hasBranches:!1,currentIndex:0,totalBranches:0,isAtFork:!1,depthFromBranchRoot:0,forkNodeId:null,branchRootId:null};let{branchRootNode:n,forkNode:i,depthFromBranchRoot:a}=e,o=i.children,s=o.findIndex(e=>e.id===n.id);return{hasBranches:o.length>1,currentIndex:s+1,totalBranches:o.length,isAtFork:0===a,depthFromBranchRoot:a,forkNodeId:i.id,branchRootId:n.id}},[t,p,A]),P=(0,x.useCallback)(e=>{let n;if(!t||!N.hasBranches||null===N.forkNodeId)return;let i=t.get(N.forkNodeId);if(!i||i.children.length<=1)return;let o=i.children,s=N.currentIndex-1;n="next"===e?(s+1)%o.length:(s-1+o.length)%o.length;let c=o[n];if(!c)return;if(0===N.depthFromBranchRoot){l(`switchBranch(${e})`,c.id),u(i.id,c.id),a(c.id);return}let d=c,p=0,h=N.depthFromBranchRoot;for(;p<h&&d.children.length>0;){let e=d.children[0];if(!e)break;((d=e).data.B||d.data.W)&&p++}l(`switchBranch(${e})`,d.id),u(i.id,c.id),a(d.id)},[t,N,l,u,a]),D=(0,x.useCallback)(e=>{if(!t||!N.hasBranches||null===N.forkNodeId)return;let n=t.get(N.forkNodeId);if(!n||n.children.length<=1)return;let i=n.children,o=Math.max(0,Math.min(e-1,i.length-1)),s=i[o];if(!s)return;if(0===N.depthFromBranchRoot){l(`switchToBranchIndex(${e})`,s.id),u(n.id,s.id),a(s.id);return}let c=s,d=0,p=N.depthFromBranchRoot;for(;d<p&&c.children.length>0;){let e=c.children[0];if(!e)break;((c=e).data.B||c.data.W)&&d++}l(`switchToBranchIndex(${e})`,c.id),u(n.id,s.id),a(c.id)},[t,N,l,u,a]);return{currentNode:p,nextMoveNode:h,variations:f,canGoBack:g,canGoForward:m,totalMovesInBranch:(0,x.useMemo)(()=>{if(!t||null==i)return 0;let e=t.get(i),n=0;for(;e;){(e.data.B||e.data.W)&&n++;let t=c(e);if(!t)break;e=t}return n},[t,i,c,n]),navigate:y,navigateBackward:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return b(e)},navigateForward:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return v(e)},navigateUp:()=>b(10),navigateDown:()=>v(10),navigateToStart:w,navigateToEnd:_,navigateToMove:S,navigateToNextFork:k,navigateToPreviousFork:T,navigateToMainLine:C,goToPreviousSibling:E,goToNextSibling:I,goToSiblingIndex:$,siblingInfo:O,branchInfo:N,switchBranch:P,switchToBranchIndex:D,resetNavigation:d,markNavigationStart:l,rememberActiveBranch:u,navigationTimingsRef:o}}function ec(e){let{gameTree:t,setGameTree:n,currentNodeId:i,setCurrentNodeId:a,gameInfo:o,editMode:s,editTool:l,stoneToolColor:u,currentBoard:c,setIsDirty:d}=e,[p,h]=(0,x.useState)(null),f=(0,x.useCallback)((e,o)=>{var s;if(!t||null===i)return;let l=z(e);if(null==l)return;let u=1===o?"B":"W",c={[u]:[l]},p=`playMove ${u}[${l||"pass"}]`,h=eo(),f=t.get(i),g=null==f?void 0:f.children.find(e=>{var t;return(null==(t=e.data[u])?void 0:t[0])===l});if(g){a(g.id),el(p,eo()-h,"reuse-total");return}let m=eo(),y=t.mutate(e=>{e.appendNode(i,c)});el(p,eo()-m,"mutate"),n(y),d(!0);let b=null==(s=y.get(i))?void 0:s.children.find(e=>{var t;return(null==(t=e.data[u])?void 0:t[0])===l});b&&a(b.id)},[t,i,n,a,d]),g=(0,x.useCallback)((e,a)=>{if(!t||null===i)return;let o=z(e);if(null==o)return;let s=1===a?"AB":-1===a?"AW":"AE";n(t.mutate(e=>{let t=e.get(i);if(!t)return;let n=t.data[s]||[];for(let l of(n.includes(o)||e.updateProperty(i,s,[...n,o]),1===a?["AW","AE"]:-1===a?["AB","AE"]:["AB","AW"]))if(t.data[l]){let n=t.data[l].filter(e=>e!==o);n.length!==t.data[l].length&&e.updateProperty(i,l,n)}})),d(!0),Z.clear()},[t,i,n,d]),m=(0,x.useCallback)(()=>{t&&null!==i&&(n(t.mutate(e=>{e.removeProperty(i,"AB"),e.removeProperty(i,"AW"),e.removeProperty(i,"AE")})),d(!0),Z.clear())},[t,i,n,d]),y=(0,x.useCallback)((e,a)=>{if(!t||null===i)return;let o=z(e);null==o||(n(t.mutate(e=>{let t,n,s,l=e.get(i);if(!l)return;if(null===a){for(let t of["TR","SQ","CR","MA","LB"])if(l.data[t]){let n=l.data[t].filter(e=>"LB"===t?!e.startsWith(`${o}:`):e!==o);e.updateProperty(i,t,n)}return}"string"==typeof a?t=a:(t=a.type||"",n=a.label||void 0);let u=o;switch(t){case"triangle":s="TR";break;case"square":s="SQ";break;case"circle":s="CR";break;case"cross":s="MA";break;case"label":s="LB",u=`${o}:${n}`;break;case"label-alpha":s="LB";let c=(l.data.LB||[]).map(e=>e.split(":")[1]),d="A";for(let e of"ABCDEFGHIJKLMNOPQRSTUVWXYZ")if(!c.includes(e)){d=e;break}u=`${o}:${d}`;break;case"label-num":s="LB";let p=(l.data.LB||[]).map(e=>parseInt(e.split(":")[1],10)).filter(e=>!isNaN(e)),h=1;for(;p.includes(h);)h++;u=`${o}:${h}`;break;default:return}for(let t of["TR","SQ","CR","MA","LB"].filter(e=>e!==s))if(l.data[t]){let n=l.data[t].filter(e=>"LB"===t?!e.startsWith(`${o}:`):e!==o);n.length!==l.data[t].length&&e.updateProperty(i,t,n)}let f=l.data[s]||[];if(f.some(e=>"LB"===s?e.startsWith(`${o}:`):e===o)){if("LB"===s){let t=f.map(e=>e.startsWith(`${o}:`)?u:e);e.updateProperty(i,s,t)}}else e.updateProperty(i,s,[...f,u])})),d(!0))},[t,i,n,d]),b=(0,x.useCallback)(()=>{t&&null!==i&&(n(t.mutate(e=>{for(let t of["TR","SQ","CR","MA","LB"])e.removeProperty(i,t)})),d(!0))},[t,i,n,d]),v=(0,x.useCallback)(e=>{t&&null!==i&&(n(t.mutate(t=>{t.updateProperty(i,"N",[e])})),d(!0))},[t,i,n,d]),w=(0,x.useCallback)(e=>{t&&null!==i&&(n(t.mutate(t=>{t.updateProperty(i,"C",[e])})),d(!0))},[t,i,n,d]),_=(0,x.useCallback)(()=>{if(!t||null===i)return;let e=t.get(i);if(!e||!e.parentId)return;let o=e.parentId;n(t.mutate(e=>{e.removeNode(i)})),a(o),d(!0)},[t,i,n,a,d]),S=(0,x.useCallback)(()=>{if(!t||null===i)return;let e=t.get(i);e&&h(e)},[t,i]),k=(0,x.useCallback)(()=>{t&&null!==i&&p&&(n(t.mutate(e=>{let t=(n,i)=>{e.appendNode(i,n.data);let a=e.get(i);if(!a||0===a.children.length)return;let o=a.children[a.children.length-1];for(let e of n.children)t(e,o.id)};t(p,i)})),d(!0))},[t,i,p,n,d]),T=(0,x.useCallback)(()=>{S(),_()},[S,_]),C=(0,x.useCallback)(()=>{console.warn("flattenVariations not implemented")},[]),E=(0,x.useCallback)(()=>{t&&null!==i&&(n(t.mutate(e=>{let t=i;for(;t;){let n=e.get(t);if(!n||!n.parentId)break;e.shiftNode(t,"main"),t=n.parentId}})),d(!0))},[t,i,n,d]);return{makeMove:f,addSetupStone:g,addMarker:y,setNodeName:v,setNodeComment:w,deleteNode:_,cutNode:T,copyNode:S,pasteNode:k,flattenVariations:C,makeMainVariation:E,shiftVariation:(0,x.useCallback)(e=>{t&&null!==i&&(n(t.mutate(t=>{t.shiftNode(i,e)})),d(!0))},[t,i,n,d]),copiedBranch:p,clearSetupStones:m,clearAllMarkersAndLabels:b,deleteOtherBranches:(0,x.useCallback)(()=>{if(!t||null===i)return;let e=new Set,a=i;for(;null!==a;){e.add(a);let n=t.get(a);a=(null==n?void 0:n.parentId)??null}let o=n=>{let i=t.get(n);if(i)for(let t of i.children)e.add(t.id),o(t.id)};o(i);let s=[],l=i;for(;null!==l;){let n=t.get(l);if(!n||null===n.parentId)break;let i=t.get(n.parentId);if(i)for(let t of i.children)e.has(t.id)||s.push(t.id);l=n.parentId}0===s.length||(n(t.mutate(e=>{for(let t of s)e.removeNode(t)})),d(!0),Z.clear())},[t,i,n,d])}}function ed(){let[e,t]=(0,x.useState)(!1),[n,i]=(0,x.useState)(!1),[a,o]=(0,x.useState)("alternate"),[s,l]=(0,x.useState)(1),u=(0,x.useCallback)(()=>{t(e=>!e)},[]);return{editMode:e,setEditMode:t,editPlayMode:n,setEditPlayMode:i,editTool:a,setEditTool:o,stoneToolColor:s,setStoneToolColor:l,toggleEditMode:u}}let ep=null,eh=null;async function ef(){return ep||eh||(eh=(async()=>(ep=await __webpack_require__.e("266").then(__webpack_require__.bind(__webpack_require__,209)),console.log("[@kaya/deadstones]  Loaded Rust WASM module"),ep))())}function eg(e){return{flatData:Int8Array.from(e.flat()),width:e.length>0?e[0].length:0}}function em(e,t){return Array.from(e).map(e=>{let n=e%t,i=(e-n)/t;return[n,i]})}async function ey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=await ef(),{finished:i=!1,iterations:a=100}=t,{flatData:o,width:s}=eg(e),l=Date.now();return em(n.guess(o,s,i,a,l),s)}function eb(e,t){var n;let i=e.length,a=(null==(n=e[0])?void 0:n.length)||0,o=e.map((e,n)=>e.map((e,i)=>{let a=`${i},${n}`;return t.has(a)?0:e})),s=new Set,l=Array.from({length:i},()=>Array(a).fill(0)),u=0,c=0;for(let e=0;e<i;e++)for(let t=0;t<a;t++){let n=`${t},${e}`;if(0===o[e][t]&&!s.has(n)){let n=ev(o,[t,e],s),i=ex(o,n);for(let e of n)l[e[1]][e[0]]=i;1===i?u+=n.length:-1===i&&(c+=n.length)}}return{blackTerritory:u,whiteTerritory:c,territories:l}}function ev(e,t,n){var i;let a=e.length,o=(null==(i=e[0])?void 0:i.length)||0,s=[],l=[t];for(;l.length>0;){let[t,i]=l.pop(),u=`${t},${i}`;n.has(u)||t<0||t>=o||i<0||i>=a||0!==e[i][t]||(n.add(u),s.push([t,i]),l.push([t+1,i],[t-1,i],[t,i+1],[t,i-1]))}return s}function ex(e,t){var n;let i=e.length,a=(null==(n=e[0])?void 0:n.length)||0,o=!1,s=!1;for(let[n,l]of t)for(let[t,u]of[[n+1,l],[n-1,l],[n,l+1],[n,l-1]]){if(t<0||t>=a||u<0||u>=i)continue;let n=e[u][t];1===n&&(o=!0),-1===n&&(s=!0)}return o&&!s?1:s&&!o?-1:0}function ew(e,t){let n=0,i=0;return t.forEach(t=>{var a;let[o,s]=t.split(",").map(Number),l=null==(a=e[s])?void 0:a[o];1===l&&n++,-1===l&&i++}),{blackDeadStones:n,whiteDeadStones:i}}function e_(e){let{currentBoard:t,gameInfo:n}=e,[i,a]=(0,x.useState)(!1),[o,s]=(0,x.useState)(new Set),[l,u]=(0,x.useState)(!1),[c,d]=(0,x.useState)(null),[p,h]=(0,x.useState)(null);(0,x.useCallback)(e=>`${e[0]},${e[1]}`,[]);let f=(0,x.useCallback)(async()=>{if(t)try{u(!0);let e=await ey(t.signMap,{finished:!0,iterations:100}),i=new Set;e.forEach(e=>i.add(e.toString())),s(i);let a=eb(t.signMap,i),o=0,l=0;i.forEach(e=>{let[n,i]=e.split(",").map(Number),a=t.get([n,i]);1===a?o++:-1===a&&l++});let c=parseFloat(String(n.komi||0)),p=t.getCaptures(1)+l,f=t.getCaptures(-1)+o,g={black:{territory:a.blackTerritory,captures:p,total:a.blackTerritory+p},white:{territory:a.whiteTerritory,captures:f,komi:c,total:a.whiteTerritory+f+c},winner:a.blackTerritory+p>a.whiteTerritory+f+c?"Black":"White",diff:Math.abs(a.blackTerritory+p-(a.whiteTerritory+f+c))};d(a.territories),h(g)}catch(e){console.error("Auto-score failed:",e)}finally{u(!1)}},[t,n.komi]);(0,x.useEffect)(()=>{i?f():(s(new Set),d(null),h(null))},[i,f]);let g=(0,x.useCallback)(e=>{if(!t)return;let i=Array.isArray(e[0])?e:[e],a=new Set(o);i.forEach(e=>{let t=e.toString();a.has(t)?a.delete(t):a.add(t)}),s(a);let l=eb(t.signMap,a),u=0,c=0;a.forEach(e=>{let[n,i]=e.split(",").map(Number),a=t.get([n,i]);1===a?u++:-1===a&&c++});let p=parseFloat(String(n.komi||0)),f=t.getCaptures(1)+c,g=t.getCaptures(-1)+u,m={black:{territory:l.blackTerritory,captures:f,total:l.blackTerritory+f},white:{territory:l.whiteTerritory,captures:g,komi:p,total:l.whiteTerritory+g+p},winner:l.blackTerritory+f>l.whiteTerritory+g+p?"Black":"White",diff:Math.abs(l.blackTerritory+f-(l.whiteTerritory+g+p))};d(l.territories),h(m)},[t,o,n.komi]);return{scoreMode:i,setScoreMode:a,scoreResult:p,deadStones:o,toggleDeadStone:g,autoScore:f,resetScore:(0,x.useCallback)(()=>{s(new Set),d(null),h(null)},[]),territoryMap:c,isEstimating:l}}let eS="KayaDB",ek="models",eT="model_metadata",eC="model_library",eE="selected_model",eI=2;function e$(){return new Promise((e,t)=>{let n=indexedDB.open(eS,eI);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(ek)||t.createObjectStore(ek),t.objectStoreNames.contains(eT)||t.createObjectStore(eT)}})}async function eO(e,t){let n=await e$();return new Promise((i,a)=>{let o=n.transaction(ek,"readwrite").objectStore(ek).put(t,e);o.onerror=()=>a(o.error),o.onsuccess=()=>i()})}async function eA(e){let t=await e$();return new Promise((n,i)=>{let a=t.transaction(ek,"readonly").objectStore(ek).get(e);a.onerror=()=>i(a.error),a.onsuccess=()=>n(a.result||null)})}async function eN(e){let t=await e$();return new Promise((n,i)=>{let a=t.transaction(ek,"readwrite").objectStore(ek).delete(e);a.onerror=()=>i(a.error),a.onsuccess=()=>n()})}async function eP(e){let t=await e$();return new Promise((n,i)=>{let a=t.transaction(eT,"readwrite").objectStore(eT).put(e,eC);a.onerror=()=>i(a.error),a.onsuccess=()=>n()})}async function eD(){let e=await e$();return new Promise((t,n)=>{let i=e.transaction(eT,"readonly").objectStore(eT).get(eC);i.onerror=()=>n(i.error),i.onsuccess=()=>t(i.result||[])})}async function eM(e){let t=await e$();return new Promise((n,i)=>{let a=t.transaction(eT,"readwrite").objectStore(eT),o=e?a.put(e,eE):a.delete(eE);o.onerror=()=>i(o.error),o.onsuccess=()=>n()})}async function ez(){let e=await e$();return new Promise((t,n)=>{let i=e.transaction(eT,"readonly").objectStore(eT).get(eE);i.onerror=()=>n(i.error),i.onsuccess=()=>t(i.result||null)})}async function ej(){let e=await e$();return new Promise((t,n)=>{let i=e.transaction(ek,"readonly").objectStore(ek).getAllKeys();i.onerror=()=>n(i.error),i.onsuccess=()=>t(i.result)})}let eR=null;function eL(){return null!==eR||"undefined"!=typeof window&&"__TAURI_INTERNALS__"in window}async function eF(e,t){if(!eR)return console.error("Tauri API not available"),null;try{let n=await eR.save({defaultPath:t,filters:[{name:"SGF Files",extensions:["sgf"]}]});if(!n)return null;return await eR.writeTextFile(n,e),n.split("/").pop()||n.split("\\").pop()||t}catch(e){return console.error("Tauri save error:",e),alert(`Failed to save file: ${e}`),null}}async function eB(e,t){try{let n=new Blob([e],{type:"application/x-go-sgf"}),i=URL.createObjectURL(n),a=document.createElement("a");return a.href=i,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i),t}catch(e){return console.error("Web save error:",e),alert(`Failed to save file: ${e}`),null}}async function eU(e,t){return eL()?await eF(e,t):await eB(e,t)}var eV=__webpack_require__(296);let eG="Request cancelled";async function eH(e,t){let n=t?.signal;if(n?.aborted)throw Error(eG);let i=t?.maxRedirections,a=t?.connectTimeout,o=t?.proxy,s=t?.danger;t&&(delete t.maxRedirections,delete t.connectTimeout,delete t.proxy,delete t.danger);let l=t?.headers?t.headers instanceof Headers?t.headers:new Headers(t.headers):new Headers,u=new Request(e,t),c=await u.arrayBuffer(),d=0!==c.byteLength?Array.from(new Uint8Array(c)):null;for(let[e,t]of u.headers)l.get(e)||l.set(e,t);let p=(l instanceof Headers?Array.from(l.entries()):Array.isArray(l)?l:Object.entries(l)).map(([e,t])=>[e,"string"==typeof t?t:t.toString()]);if(n?.aborted)throw Error(eG);let h=await (0,eV.lA)("plugin:http|fetch",{clientConfig:{method:u.method,url:u.url,headers:p,data:d,maxRedirections:i,connectTimeout:a,proxy:o,danger:s}}),f=()=>(0,eV.lA)("plugin:http|fetch_cancel",{rid:h});if(n?.aborted)throw f(),Error(eG);n?.addEventListener("abort",()=>void f());let{status:g,statusText:m,url:y,headers:b,rid:v}=await (0,eV.lA)("plugin:http|fetch_send",{rid:h}),x=new Response([101,103,204,205,304].includes(g)?null:new ReadableStream({start:e=>{let t=new eV.c3;t.onmessage=t=>{if(n?.aborted)return void e.error(eG);let i=new Uint8Array(t),a=i[i.byteLength-1],o=i.slice(0,i.byteLength-1);1==a?e.close():e.enqueue(o)},(0,eV.lA)("plugin:http|fetch_read_body",{rid:v,streamChannel:t}).catch(t=>{e.error(t)})}}),{status:g,statusText:m});return Object.defineProperty(x,"url",{value:y}),Object.defineProperty(x,"headers",{value:new Headers(b)}),x}let eW="kaya-ai-settings",eq="0.2.2",eK=`https://huggingface.co/kaya-go/kaya/resolve/${eq}`;function eX(e,t){return`${eK}/${e}/${e}.${t}.onnx`}let eZ=[{name:"kata1-b28c512nbt-adam-s11165M-d5387M",displayName:"kata1-b28c512nbt-s11165M",description:"Strongest network",recommended:!0,isDefault:!0},{name:"kata1-b28c512nbt-s12043015936-d5616446734",displayName:"kata1-b28c512nbt-s12043M",description:"Latest checkpoint (Dec 2025)"}],eY=[{quantization:"fp32",label:"Full Precision (fp32)",description:"Highest accuracy, largest file size",size:"~280 MB"},{quantization:"fp16",label:"Half Precision (fp16)",description:"Good balance of accuracy and size",size:"~140 MB"},{quantization:"uint8",label:"Quantized (uint8)",description:"Smallest size, slightly reduced accuracy",size:"~75 MB"}];function eQ(e,t){let n=0===e?"strongest":"latest",i="fp32"===t?"":"fp16"===t?"-fp16":"-quant";return`katago-${n}${i}`}function eJ(e){let t=e.match(/^katago-(strongest|latest)(-fp16|-quant)?$/);return t?{baseModelIndex:+("strongest"!==t[1]),quantization:"-fp16"===t[2]?"fp16":"-quant"===t[2]?"uint8":"fp32"}:null}let e0=eZ.flatMap((e,t)=>eY.map((n,i)=>{let a=eQ(t,n.quantization);return{id:a,name:`${e.displayName}${"fp32"===n.quantization?"":` (${n.quantization})`}`,description:`${e.description}${"fp32"===n.quantization?"":` - ${n.description.toLowerCase()}`}`,url:eX(e.name,n.quantization),size:n.size,predefinedId:a,baseModelIndex:t,quantization:n.quantization,...0===i&&e.recommended?{recommended:!0}:{},...0===i&&e.isDefault?{isDefault:!0}:{}}}));function e1(){return"undefined"!=typeof navigator&&!!navigator.gpu}function e2(){return"undefined"!=typeof window&&"__TAURI_INTERNALS__"in window}function e3(){return e2()?"native":"wasm"}let e4={minProb:.01,maxTopMoves:5,backend:"wasm",saveAnalysisToSgf:!0};function e6(){let e=e1(),t=e2(),n=e3();try{let i=localStorage.getItem(eW);if(i){let a=JSON.parse(i),o=a.backend;return"native"!==o&&"native-cpu"!==o||t?["native","native-cpu","webgpu","webgl","wasm"].includes(o)?"webgpu"!==o||e||(o="wasm"):o=n:(console.log("[AI Settings] Native backend not available on web, falling back to wasm"),o="wasm"),{minProb:"number"==typeof a.minProb&&a.minProb>=0&&a.minProb<=1?a.minProb:e4.minProb,maxTopMoves:"number"==typeof a.maxTopMoves&&a.maxTopMoves>=1&&a.maxTopMoves<=10?a.maxTopMoves:e4.maxTopMoves,backend:o,saveAnalysisToSgf:"boolean"==typeof a.saveAnalysisToSgf?a.saveAnalysisToSgf:e4.saveAnalysisToSgf}}}catch(e){console.warn("Failed to load AI settings from localStorage:",e)}return{...e4,backend:n}}function e5(e){try{localStorage.setItem(eW,JSON.stringify(e))}catch(e){console.warn("Failed to save AI settings to localStorage:",e)}}function e8(e,t){if("pass"===e.toLowerCase())return null;let n="ABCDEFGHJKLMNOPQRSTUVWXYZ";if(e.length<2)return null;let i=n.indexOf(e[0].toUpperCase()),a=t-parseInt(e.slice(1),10);return i<0||i>=t||a<0||a>=t?null:[i,a]}function e7(e){let{currentBoard:t}=e,[n,i]=(0,x.useState)(null),[a,o]=(0,x.useState)(!1),[s,l]=(0,x.useState)(!1),[u,c]=(0,x.useState)(!1),[d,p]=(0,x.useState)(null),[h,f]=(0,x.useState)(!1),[g,m]=(0,x.useState)(null),[y,b]=(0,x.useState)(e6),v=(0,x.useCallback)(e=>{m(e)},[]),w=g,[_,S]=(0,x.useState)("ready"),k=(0,x.useRef)(new Map),[T,C]=(0,x.useState)(0),E=(0,x.useCallback)(()=>{C(k.current.size)},[]),[I,$]=(0,x.useState)([]),[O,A]=(0,x.useState)(null),N=(0,x.useRef)(new Set);(0,x.useEffect)(()=>{(async()=>{try{let e=await eD(),t=await ej(),n=await ez(),i=[];for(let n of e0){let a=e.find(e=>e.id===n.id),o=t.includes(n.id);i.push({id:n.id,name:n.name,description:n.description,url:n.url,predefinedId:n.predefinedId,recommended:n.recommended,isDefault:n.isDefault,baseModelIndex:n.baseModelIndex,quantization:n.quantization,isDownloaded:o,size:null==a?void 0:a.size,date:null==a?void 0:a.date})}for(let n of e.filter(e=>e.isUserModel))t.includes(n.id)&&i.push({id:n.id,name:n.name,description:n.description,size:n.size,date:n.date,isDownloaded:!0,isUserModel:!0});if($(i),n&&i.some(e=>e.id===n&&e.isDownloaded))A(n);else{let e=i.find(e=>"strongest"===e.predefinedId&&e.isDownloaded)||i.find(e=>e.isDownloaded);e&&(A(e.id),await eM(e.id))}o(!0)}catch(e){console.error("Failed to initialize model library:",e),o(!0)}})()},[]),(0,x.useEffect)(()=>{if(!O||!a)return void i(null);let e=I.find(e=>e.id===O);e&&e.isDownloaded?i({data:O,name:e.name,size:e.size,date:e.date}):i(null)},[O,a,I]);let P=(0,x.useCallback)(async e=>{let t=I.find(t=>t.id===e);if(!(!t||!t.url||N.current.has(e))){N.current.add(e),$(t=>t.map(t=>t.id===e?{...t,isDownloading:!0,downloadProgress:0}:t));try{var n;let i=null,a=null;if(eL())try{i=await eH(t.url)}catch(e){a=e}else try{console.log(`[ModelDownload] Downloading: ${t.url}`);let e=await fetch(t.url);e.ok?(console.log("[ModelDownload] Success"),i=e):console.warn(`[ModelDownload] Failed: ${e.status} ${e.statusText}`)}catch(e){a=e,console.warn("[ModelDownload] Network error:",e)}if(!i||!i.ok)throw Error(`Failed to download: ${(null==i?void 0:i.statusText)||(null==a?void 0:a.message)||"Unknown error"}`);let o=i.headers.get("Content-Length"),s=o?parseInt(o,10):0,l=0,u=null==(n=i.body)?void 0:n.getReader();if(!u)throw Error("ReadableStream not supported");let c=[];for(;;){let{done:t,value:n}=await u.read();if(t)break;if(c.push(n),l+=n.length,s){let t=Math.round(l/s*100);$(n=>n.map(n=>n.id===e?{...n,downloadProgress:t}:n))}}let d=c.reduce((e,t)=>e+t.length,0),p=new ArrayBuffer(d),h=new Uint8Array(p),f=0;for(let e of c)h.set(e,f),f+=e.length;c.length=0,await eO(e,p);let g=await eD(),m={id:e,name:t.name,description:t.description,size:p.byteLength,date:Date.now(),predefinedId:t.predefinedId,url:t.url},y=g.findIndex(t=>t.id===e);y>=0?g[y]=m:g.push(m),await eP(g),$(t=>t.map(t=>t.id===e?{...t,isDownloaded:!0,isDownloading:!1,downloadProgress:void 0,size:p.byteLength,date:Date.now()}:t)),A(e),await eM(e)}catch(t){throw console.error("Failed to download model:",t),$(t=>t.map(t=>t.id===e?{...t,isDownloading:!1,downloadProgress:void 0}:t)),t}finally{N.current.delete(e)}}},[I,O]),D=(0,x.useCallback)(async e=>{try{if(await eN(e),eL())try{var t,n,a;let i=window,o=(null==(n=i.__TAURI__)||null==(t=n.core)?void 0:t.invoke)||(null==(a=i.__TAURI_INTERNALS__)?void 0:a.invoke);"function"==typeof o&&await o("onnx_delete_cached_model",{modelId:e})}catch(e){console.warn("Failed to delete model from Tauri cache:",e)}let o=await eD(),s=I.find(t=>t.id===e);if(null==s?void 0:s.isUserModel){let t=o.filter(t=>t.id!==e);await eP(t),$(t=>t.filter(t=>t.id!==e))}else $(t=>t.map(t=>t.id===e?{...t,isDownloaded:!1,size:void 0,date:void 0}:t));O===e&&(A(null),await eM(null),i(null))}catch(e){throw console.error("Failed to delete model:",e),e}},[I,O]),M=(0,x.useCallback)(async e=>{let t=`user-${Date.now()}-${e.name}`,n=await e.arrayBuffer();await eO(t,n);let i=await eD(),a={id:t,name:e.name,description:"User uploaded model",size:e.size,date:Date.now(),isUserModel:!0};i.push(a),await eP(i);let o={id:t,name:e.name,description:"User uploaded model",size:e.size,date:Date.now(),isDownloaded:!0,isUserModel:!0};$(e=>[...e,o]),A(t),await eM(t)},[]),z=(0,x.useCallback)(async e=>{A(e),await eM(e)},[]),j=(0,x.useCallback)(async e=>{e&&e.data instanceof File?await M(e.data):e||(A(null),await eM(null),i(null))},[M]),R=(0,x.useCallback)(e=>{b(t=>{let n={...t,...e};return e5(n),n})},[]),[L,F]=(0,x.useState)(!1),[B,U]=(0,x.useState)(!1),[V,G]=(0,x.useState)(!1),H=(0,x.useCallback)((e,t,n)=>!e&&!t&&!n,[]),W=(0,x.useMemo)(()=>I.some(e=>e.isDownloaded),[I]);(0,x.useEffect)(()=>{if(W&&d){let e=d;p(null),"analysisBar"===e?(G(!0),U(!0),c(!0)):"ownership"===e?(F(!0),c(!0)):"topMoves"===e&&(U(!0),c(!0))}},[W,d]);let q=(0,x.useCallback)(()=>{if(!L&&!W){p("ownership"),l(!0);return}F(e=>{let t=!e;return t&&!u?c(!0):!t&&u&&H(!e,B,V)&&c(!1),t})},[u,c,B,V,L,W,l,H]),K=(0,x.useCallback)(()=>{if(!B&&!W){p("topMoves"),l(!0);return}U(e=>{let t=!e;return t&&!u?c(!0):!t&&u&&H(L,!e,V)&&c(!1),t})},[u,c,L,V,B,W,l,H]),X=(0,x.useCallback)(()=>{if(!V&&!W){p("analysisBar"),l(!0);return}G(e=>{let t=!e;return U(t),t&&!u?c(!0):!t&&u&&H(L,!1,!1)&&c(!1),t})},[u,c,L,V,W,l,H]),Z=(0,x.useMemo)(()=>(null==w?void 0:w.winRate)??null,[w]),Y=(0,x.useMemo)(()=>(null==w?void 0:w.scoreLead)??null,[w]),Q=(0,x.useMemo)(()=>{var e,n;return(null==w||null==(n=w.moveSuggestions)||null==(e=n[0])?void 0:e.move)?e8(w.moveSuggestions[0].move,t.width):null},[w,t.width]);return{customAIModel:n,setCustomAIModel:j,isModelLoaded:a,isAIConfigOpen:s,setAIConfigOpen:l,analysisMode:u,setAnalysisMode:c,isAnalyzing:h,setIsAnalyzing:f,analysisResult:w,setAnalysisResult:v,showOwnership:L,toggleOwnership:q,showTopMoves:B,toggleTopMoves:K,showAnalysisBar:V,setShowAnalysisBar:G,toggleShowAnalysisBar:X,aiSettings:y,setAISettings:R,winRate:Z,scoreLead:Y,bestMove:Q,engineState:_,analysisCache:k,analysisCacheSize:T,updateAnalysisCacheSize:E,modelLibrary:I,selectedModelId:O,setSelectedModelId:z,downloadModel:P,deleteModel:D,uploadModel:M}}function e9(e,t){return t?{...e,scoreLead:(t.scoreLead+e.scoreLead)/2,winRate:(t.winRate+e.winRate)/2}:e}function te(e,t,n,i){let a=i.slice(-5).map(e=>`${e.color}:${e.x},${e.y}`);return JSON.stringify({board:`${e.length}:${e.map(e=>e.join(",")).join(";")}`,nextToPlay:t,komi:n,history:a})}function tt(e,t){if("pass"===e||"PASS"===e)return null;let n=e.charCodeAt(0)-65;return[n>=8?n-1:n,t-parseInt(e.slice(1),10)]}function tn(e){return e>=.7?9:e>=.6?8:e>=.4?7:e>=.1?6:5}function tr(e){return`${(100*e).toFixed(1)}%`}function ti(e){return{board:q.fromDimensions(e),history:[],nextToPlay:"B"}}function ta(e,t,n){let{board:i,history:a,nextToPlay:o}=e,{data:s}=t;if(s.PL?o=s.PL[0]:s.B?o="W":s.W?o="B":0===n&&(o=s.HA&&parseInt(s.HA[0])>=2?"W":"B"),s.AB||s.AW||s.AE,s.AB||s.AW||s.AE){for(let e of s.AB||[]){let t=M(e);t&&i.set(t,1)}for(let e of s.AW||[]){let t=M(e);t&&i.set(t,-1)}for(let e of s.AE||[]){let t=M(e);t&&i.set(t,0)}}let l=null,u=!1;if(s.B){let e=M(s.B[0]);e?l={color:1,x:e[0],y:e[1]}:void 0!==s.B[0]&&(l={color:1,x:-1,y:-1},u=!0)}else if(s.W){let e=M(s.W[0]);e?l={color:-1,x:e[0],y:e[1]}:void 0!==s.W[0]&&(l={color:-1,x:-1,y:-1},u=!0)}let c=[...a];if(l)if(u)c.push(l);else try{i=i.makeMove(l.color,[l.x,l.y],{disableKoCheck:!1,mutate:!0}),c.push(l)}catch(e){}return{board:i,history:c,nextToPlay:o}}let to="KA",ts="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+$";function tl(e){let t="";for(let n of e)t+=ts[Math.floor((Math.max(-1,Math.min(1,n))+1)*31.5)]||"0";return t}function tu(e){let t=[];for(let n=0;n<e.length;n++){let i=e[n],a=ts.indexOf(i);if(-1===a){t.push(0);continue}let o=a/31.5-1;t.push(o)}return t}function tc(e){let t={w:Number(e.winRate.toFixed(4)),s:Number(e.scoreLead.toFixed(2)),m:e.moveSuggestions.map(e=>({m:e.move,p:Number(e.probability.toFixed(4))}))};return void 0!==e.visits&&(t.v=e.visits),e.ownership&&e.ownership.length>0&&(t.o=tl(e.ownership)),JSON.stringify(t)}function td(e,t){try{let n=JSON.parse(e),i=n.m.map(e=>({move:e.m,probability:e.p})),a={winRate:n.w,scoreLead:n.s,visits:n.v,currentTurn:t,moveSuggestions:i};return n.o&&(a.ownership=tu(n.o)),a}catch(e){return console.warn("Failed to parse Kaya Analysis data:",e),null}}function tp(e,t){let n={...e};return n[to]=[tc(t)],n}function th(e,t,n,i){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=n,s=[...a],l=0;if(e.data.AB||e.data.AW||e.data.AE){for(let t of(o=o.clone(),e.data.AB||[])){let e=M(t);e&&o.set(e,1)}for(let t of e.data.AW||[]){let e=M(t);e&&o.set(e,-1)}for(let t of e.data.AE||[]){let e=M(t);e&&o.set(e,0)}}if(e.data.B){let t=M(e.data.B[0]);if(t)try{o=o.makeMove(1,t,{disableKoCheck:!1}),s.push({color:1,x:t[0],y:t[1]})}catch{}else void 0!==e.data.B[0]&&s.push({color:1,x:-1,y:-1});l=1}else if(e.data.W){let t=M(e.data.W[0]);if(t)try{o=o.makeMove(-1,t,{disableKoCheck:!1}),s.push({color:-1,x:t[0],y:t[1]})}catch{}else void 0!==e.data.W[0]&&s.push({color:-1,x:-1,y:-1});l=-1}let u="B";1===l?u="W":-1===l?u="B":e.data.PL&&e.data.PL[0]?u="W"===e.data.PL[0]?"W":"B":e.data.HA&&parseInt(e.data.HA[0])>=2&&(u="W");let c=te(o.signMap,u,i,s),d=t.get(c),p={...e.data};delete p[to],d&&(p=tp(p,d));let h=e.children.map(e=>th(e,t,o,i,s));return{...e,data:p,children:h}}function tf(e,t,n,i){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=0,s=n,l=[...a],u=0;if(e.data.AB||e.data.AW||e.data.AE){for(let t of(s=s.clone(),e.data.AB||[])){let e=M(t);e&&s.set(e,1)}for(let t of e.data.AW||[]){let e=M(t);e&&s.set(e,-1)}for(let t of e.data.AE||[]){let e=M(t);e&&s.set(e,0)}}if(e.data.B){let t=M(e.data.B[0]);if(t)try{s=s.makeMove(1,t,{disableKoCheck:!1}),l.push({color:1,x:t[0],y:t[1]})}catch{}else void 0!==e.data.B[0]&&l.push({color:1,x:-1,y:-1});u=1}else if(e.data.W){let t=M(e.data.W[0]);if(t)try{s=s.makeMove(-1,t,{disableKoCheck:!1}),l.push({color:-1,x:t[0],y:t[1]})}catch{}else void 0!==e.data.W[0]&&l.push({color:-1,x:-1,y:-1});u=-1}let c="B";if(1===u?c="W":-1===u?c="B":e.data.PL&&e.data.PL[0]?c="W"===e.data.PL[0]?"W":"B":e.data.HA&&parseInt(e.data.HA[0])>=2&&(c="W"),e.data[to]&&e.data[to][0]){let n=td(e.data[to][0],c);if(n){let e=te(s.signMap,c,i,l);t.set(e,n),o++}}for(let n of e.children)o+=tf(n,t,s,i,l);return o}let tg="kaya-auto-save",tm="kaya-auto-save-timestamp",ty=2e3;function tb(e,t,n,i,a,o,s,l){if(!e||null===t)return!1;try{let u=e.get(t);if(!u)return!1;if(o){let e=q.fromDimensions(s??19),t=(null==a?void 0:a.current)??new Map;u=th(u,t,e,l??7.5)}let c={sgf:W([u]),fileName:n||"untitled.sgf",currentNodeId:i,timestamp:new Date().toISOString()},d=JSON.stringify(c),p=5242880;if(d.length>p)return console.warn("Auto-save skipped: Game too large for localStorage (max 5MB)"),"too-large";if("undefined"!=typeof window)try{return localStorage.setItem(tg,d),localStorage.setItem(tm,c.timestamp),!0}catch(e){if(e instanceof DOMException&&("QuotaExceededError"===e.name||22===e.code||1014===e.code)){console.warn("localStorage quota exceeded, clearing auto-save"),localStorage.removeItem(tg),localStorage.removeItem(tm);try{return localStorage.setItem(tg,d),localStorage.setItem(tm,c.timestamp),!0}catch(e){return console.warn("Auto-save failed even after clearing:",e),"too-large"}}throw e}}catch(e){console.warn("Failed to auto-save game:",e)}return!1}function tv(){if("undefined"==typeof window)return null;try{let e=localStorage.getItem(tg);if(!e)return null;return JSON.parse(e)}catch(e){return console.warn("Failed to load auto-saved game:",e),null}}function tx(){"undefined"!=typeof window&&(localStorage.removeItem(tg),localStorage.removeItem(tm))}function tw(e){let{gameTree:t,rootId:n,fileName:i,currentNodeId:a,onAutoSaveDisabled:o,analysisCache:s,saveAnalysisToSgf:l,boardSize:u,komi:c,analysisCacheSize:d}=e,[p,h]=(0,x.useState)(!1),[f,g]=(0,x.useState)(null),m=(0,x.useRef)(null),y=(0,x.useRef)(null);return(0,x.useEffect)(()=>{tv()&&h(!0)},[]),(0,x.useEffect)(()=>{if(!t||null===n)return;let e={treeHash:t.getHash(),nodeId:a,cacheSize:d??0};if(!y.current||y.current.treeHash!==e.treeHash||y.current.nodeId!==e.nodeId||y.current.cacheSize!==e.cacheSize)return m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{let d=tb(t,n,i,a,s,l,u,c);!0===d?(y.current=e,g(new Date)):"too-large"===d&&o&&o(),m.current=null},ty),()=>{m.current&&clearTimeout(m.current)}},[t,n,i,a,o,s,l,u,c,d]),(0,x.useEffect)(()=>{let e=()=>{t&&n&&"too-large"===tb(t,n,i,a,s,l,u,c)&&o&&o()};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e),e()}},[t,n,i,a,o,s,l,u,c]),{hasAutoSavedGame:p,lastSaveTime:f,loadAutoSavedGame:tv,clearAutoSave:tx,triggerAutoSave:(0,x.useCallback)(()=>{if(!t||null===n)return;let e=tb(t,n,i,a,s,l,u,c);!0===e?(y.current={treeHash:t.getHash(),nodeId:a,cacheSize:d??0},g(new Date)):"too-large"===e&&o&&o()},[t,n,i,a,s,l,u,c,d,o])}}let t_=JSON.parse('[{"name":"Low Chinese Opening","anchors":[[[10,2],1],[[3,3],1],[[16,3],1]],"vertices":[[[0,0],0],[[1,0],0],[[2,0],0],[[3,0],0],[[4,0],0],[[5,0],0],[[6,0],0],[[7,0],0],[[8,0],0],[[9,0],0],[[10,0],0],[[11,0],0],[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[0,1],0],[[1,1],0],[[2,1],0],[[3,1],0],[[4,1],0],[[5,1],0],[[6,1],0],[[7,1],0],[[8,1],0],[[9,1],0],[[10,1],0],[[11,1],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[0,2],0],[[1,2],0],[[2,2],0],[[3,2],0],[[4,2],0],[[5,2],0],[[6,2],0],[[7,2],0],[[8,2],0],[[9,2],0],[[11,2],0],[[12,2],0],[[13,2],0],[[14,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[0,3],0],[[1,3],0],[[2,3],0],[[4,3],0],[[5,3],0],[[6,3],0],[[7,3],0],[[8,3],0],[[9,3],0],[[10,3],0],[[11,3],0],[[12,3],0],[[13,3],0],[[14,3],0],[[15,3],0],[[17,3],0],[[18,3],0],[[0,4],0],[[1,4],0],[[2,4],0],[[3,4],0],[[4,4],0],[[5,4],0],[[6,4],0],[[7,4],0],[[8,4],0],[[9,4],0],[[10,4],0],[[11,4],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[3,3],1],[[10,2],1],[[16,3],1]],"url":"https://senseis.xmp.net/?ChineseFuseki","size":"19","type":"corner"},{"name":"High Chinese Opening","anchors":[[[3,3],1],[[10,3],1],[[16,3],1]],"vertices":[[[0,0],0],[[1,0],0],[[2,0],0],[[3,0],0],[[4,0],0],[[5,0],0],[[6,0],0],[[7,0],0],[[8,0],0],[[9,0],0],[[10,0],0],[[11,0],0],[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[0,1],0],[[1,1],0],[[2,1],0],[[3,1],0],[[4,1],0],[[5,1],0],[[6,1],0],[[7,1],0],[[8,1],0],[[9,1],0],[[10,1],0],[[11,1],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[0,2],0],[[1,2],0],[[2,2],0],[[3,2],0],[[4,2],0],[[5,2],0],[[6,2],0],[[7,2],0],[[8,2],0],[[9,2],0],[[10,2],0],[[11,2],0],[[12,2],0],[[13,2],0],[[14,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[0,3],0],[[1,3],0],[[2,3],0],[[4,3],0],[[5,3],0],[[6,3],0],[[7,3],0],[[8,3],0],[[9,3],0],[[11,3],0],[[12,3],0],[[13,3],0],[[14,3],0],[[15,3],0],[[17,3],0],[[18,3],0],[[0,4],0],[[1,4],0],[[2,4],0],[[3,4],0],[[4,4],0],[[5,4],0],[[6,4],0],[[7,4],0],[[8,4],0],[[9,4],0],[[10,4],0],[[11,4],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[3,3],1],[[10,3],1],[[16,3],1]],"url":"https://senseis.xmp.net/?ChineseFuseki","size":"19","type":"corner"},{"name":"Orthodox Opening","anchors":[[[15,2],1],[[3,3],1],[[16,4],1]],"vertices":[[[0,0],0],[[1,0],0],[[2,0],0],[[3,0],0],[[4,0],0],[[5,0],0],[[6,0],0],[[7,0],0],[[8,0],0],[[9,0],0],[[10,0],0],[[11,0],0],[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[0,1],0],[[1,1],0],[[2,1],0],[[3,1],0],[[4,1],0],[[5,1],0],[[6,1],0],[[7,1],0],[[8,1],0],[[9,1],0],[[10,1],0],[[11,1],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[0,2],0],[[1,2],0],[[2,2],0],[[3,2],0],[[4,2],0],[[5,2],0],[[6,2],0],[[7,2],0],[[8,2],0],[[9,2],0],[[10,2],0],[[11,2],0],[[12,2],0],[[13,2],0],[[14,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[0,3],0],[[1,3],0],[[2,3],0],[[4,3],0],[[5,3],0],[[6,3],0],[[7,3],0],[[8,3],0],[[9,3],0],[[10,3],0],[[11,3],0],[[12,3],0],[[13,3],0],[[14,3],0],[[15,3],0],[[16,3],0],[[17,3],0],[[18,3],0],[[0,4],0],[[1,4],0],[[2,4],0],[[3,4],0],[[4,4],0],[[5,4],0],[[6,4],0],[[7,4],0],[[8,4],0],[[9,4],0],[[10,4],0],[[11,4],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[17,4],0],[[18,4],0],[[0,5],0],[[1,5],0],[[2,5],0],[[3,5],0],[[4,5],0],[[5,5],0],[[6,5],0],[[7,5],0],[[8,5],0],[[9,5],0],[[10,5],0],[[11,5],0],[[12,5],0],[[13,5],0],[[14,5],0],[[15,5],0],[[16,5],0],[[17,5],0],[[18,5],0],[[3,3],1],[[15,2],1],[[16,4],1]],"url":"https://senseis.xmp.net/?OrthodoxFuseki","size":"19","type":"corner"},{"name":"Enclosure Opening","anchors":[[[15,2],1],[[2,3],1],[[16,4],1]],"vertices":[[[0,0],0],[[1,0],0],[[2,0],0],[[3,0],0],[[4,0],0],[[5,0],0],[[6,0],0],[[7,0],0],[[8,0],0],[[9,0],0],[[10,0],0],[[11,0],0],[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[0,1],0],[[1,1],0],[[2,1],0],[[3,1],0],[[4,1],0],[[5,1],0],[[6,1],0],[[7,1],0],[[8,1],0],[[9,1],0],[[10,1],0],[[11,1],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[0,2],0],[[1,2],0],[[2,2],0],[[3,2],0],[[4,2],0],[[5,2],0],[[6,2],0],[[7,2],0],[[8,2],0],[[9,2],0],[[10,2],0],[[11,2],0],[[12,2],0],[[13,2],0],[[14,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[0,3],0],[[1,3],0],[[3,3],0],[[4,3],0],[[5,3],0],[[6,3],0],[[7,3],0],[[8,3],0],[[9,3],0],[[10,3],0],[[11,3],0],[[12,3],0],[[13,3],0],[[14,3],0],[[15,3],0],[[16,3],0],[[17,3],0],[[18,3],0],[[0,4],0],[[1,4],0],[[2,4],0],[[3,4],0],[[4,4],0],[[5,4],0],[[6,4],0],[[7,4],0],[[8,4],0],[[9,4],0],[[10,4],0],[[11,4],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[17,4],0],[[18,4],0],[[0,5],0],[[1,5],0],[[2,5],0],[[3,5],0],[[4,5],0],[[5,5],0],[[6,5],0],[[7,5],0],[[8,5],0],[[9,5],0],[[10,5],0],[[11,5],0],[[12,5],0],[[13,5],0],[[14,5],0],[[15,5],0],[[16,5],0],[[17,5],0],[[18,5],0],[[2,3],1],[[15,2],1],[[16,4],1]],"url":"https://senseis.xmp.net/?ParallelFusekiBlackEnclosure","size":"19","type":"corner"},{"name":"Kobayashi Opening","anchors":[[[3,2],1],[[13,2],1],[[9,3],1],[[15,3],-1]],"vertices":[[[15,3],-1],[[0,0],0],[[1,0],0],[[2,0],0],[[3,0],0],[[4,0],0],[[5,0],0],[[6,0],0],[[7,0],0],[[8,0],0],[[9,0],0],[[10,0],0],[[11,0],0],[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[0,1],0],[[1,1],0],[[2,1],0],[[3,1],0],[[4,1],0],[[5,1],0],[[6,1],0],[[7,1],0],[[8,1],0],[[9,1],0],[[10,1],0],[[11,1],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[0,2],0],[[1,2],0],[[2,2],0],[[4,2],0],[[5,2],0],[[6,2],0],[[7,2],0],[[8,2],0],[[9,2],0],[[10,2],0],[[11,2],0],[[12,2],0],[[14,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[0,3],0],[[1,3],0],[[2,3],0],[[3,3],0],[[4,3],0],[[5,3],0],[[6,3],0],[[7,3],0],[[8,3],0],[[10,3],0],[[11,3],0],[[12,3],0],[[13,3],0],[[14,3],0],[[16,3],0],[[17,3],0],[[18,3],0],[[0,4],0],[[1,4],0],[[2,4],0],[[3,4],0],[[4,4],0],[[5,4],0],[[6,4],0],[[7,4],0],[[8,4],0],[[9,4],0],[[10,4],0],[[11,4],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[3,2],1],[[13,2],1],[[9,3],1]],"url":"https://senseis.xmp.net/?KobayashiFuseki","size":"19","type":"corner"},{"name":"Small Chinese Opening","anchors":[[[8,2],1],[[13,2],1],[[2,3],1],[[15,3],-1]],"vertices":[[[15,3],-1],[[0,0],0],[[1,0],0],[[2,0],0],[[3,0],0],[[4,0],0],[[5,0],0],[[6,0],0],[[7,0],0],[[8,0],0],[[9,0],0],[[10,0],0],[[11,0],0],[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[0,1],0],[[1,1],0],[[2,1],0],[[3,1],0],[[4,1],0],[[5,1],0],[[6,1],0],[[7,1],0],[[8,1],0],[[9,1],0],[[10,1],0],[[11,1],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[0,2],0],[[1,2],0],[[2,2],0],[[3,2],0],[[4,2],0],[[5,2],0],[[6,2],0],[[7,2],0],[[9,2],0],[[10,2],0],[[11,2],0],[[12,2],0],[[14,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[0,3],0],[[1,3],0],[[3,3],0],[[4,3],0],[[5,3],0],[[6,3],0],[[7,3],0],[[8,3],0],[[9,3],0],[[10,3],0],[[11,3],0],[[12,3],0],[[13,3],0],[[14,3],0],[[16,3],0],[[17,3],0],[[18,3],0],[[0,4],0],[[1,4],0],[[2,4],0],[[3,4],0],[[4,4],0],[[5,4],0],[[6,4],0],[[7,4],0],[[8,4],0],[[9,4],0],[[10,4],0],[[11,4],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[2,3],1],[[13,2],1],[[8,2],1]],"url":"https://senseis.xmp.net/?SmallChineseFuseki","size":"19","type":"corner"},{"name":"Micro Chinese Opening","anchors":[[[7,2],1],[[13,2],1],[[2,3],1],[[15,3],-1]],"vertices":[[[15,3],-1],[[0,0],0],[[1,0],0],[[2,0],0],[[3,0],0],[[4,0],0],[[5,0],0],[[6,0],0],[[7,0],0],[[8,0],0],[[9,0],0],[[10,0],0],[[11,0],0],[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[0,1],0],[[1,1],0],[[2,1],0],[[3,1],0],[[4,1],0],[[5,1],0],[[6,1],0],[[7,1],0],[[8,1],0],[[9,1],0],[[10,1],0],[[11,1],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[0,2],0],[[1,2],0],[[2,2],0],[[3,2],0],[[4,2],0],[[5,2],0],[[6,2],0],[[8,2],0],[[9,2],0],[[10,2],0],[[11,2],0],[[12,2],0],[[14,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[0,3],0],[[1,3],0],[[3,3],0],[[4,3],0],[[5,3],0],[[6,3],0],[[7,3],0],[[8,3],0],[[9,3],0],[[10,3],0],[[11,3],0],[[12,3],0],[[13,3],0],[[14,3],0],[[16,3],0],[[17,3],0],[[18,3],0],[[0,4],0],[[1,4],0],[[2,4],0],[[3,4],0],[[4,4],0],[[5,4],0],[[6,4],0],[[7,4],0],[[8,4],0],[[9,4],0],[[10,4],0],[[11,4],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[2,3],1],[[7,2],1],[[13,2],1]],"url":"https://senseis.xmp.net/?MicroChinese","size":"19","type":"corner"},{"name":"Sanrensei Opening","anchors":[[[3,3],1],[[9,3],1],[[15,3],1]],"vertices":[[[0,0],0],[[1,0],0],[[2,0],0],[[3,0],0],[[4,0],0],[[5,0],0],[[6,0],0],[[7,0],0],[[8,0],0],[[9,0],0],[[10,0],0],[[11,0],0],[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[0,1],0],[[1,1],0],[[2,1],0],[[3,1],0],[[4,1],0],[[5,1],0],[[6,1],0],[[7,1],0],[[8,1],0],[[9,1],0],[[10,1],0],[[11,1],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[0,2],0],[[1,2],0],[[2,2],0],[[3,2],0],[[4,2],0],[[5,2],0],[[6,2],0],[[7,2],0],[[8,2],0],[[9,2],0],[[10,2],0],[[11,2],0],[[12,2],0],[[13,2],0],[[14,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[0,3],0],[[1,3],0],[[2,3],0],[[4,3],0],[[5,3],0],[[6,3],0],[[7,3],0],[[8,3],0],[[10,3],0],[[11,3],0],[[12,3],0],[[13,3],0],[[14,3],0],[[16,3],0],[[17,3],0],[[18,3],0],[[0,4],0],[[1,4],0],[[2,4],0],[[3,4],0],[[4,4],0],[[5,4],0],[[6,4],0],[[7,4],0],[[8,4],0],[[9,4],0],[[10,4],0],[[11,4],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[15,3],1],[[9,3],1],[[3,3],1]],"url":"https://senseis.xmp.net/?SanrenseiFuseki","size":"19","type":"corner"},{"name":"Nirensei Opening","anchors":[[[3,3],1],[[15,3],1]],"vertices":[[[0,0],0],[[1,0],0],[[2,0],0],[[3,0],0],[[4,0],0],[[5,0],0],[[6,0],0],[[7,0],0],[[8,0],0],[[9,0],0],[[10,0],0],[[11,0],0],[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[0,1],0],[[1,1],0],[[2,1],0],[[3,1],0],[[4,1],0],[[5,1],0],[[6,1],0],[[7,1],0],[[8,1],0],[[9,1],0],[[10,1],0],[[11,1],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[0,2],0],[[1,2],0],[[2,2],0],[[3,2],0],[[4,2],0],[[5,2],0],[[6,2],0],[[7,2],0],[[8,2],0],[[9,2],0],[[10,2],0],[[11,2],0],[[12,2],0],[[13,2],0],[[14,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[0,3],0],[[1,3],0],[[2,3],0],[[4,3],0],[[5,3],0],[[6,3],0],[[7,3],0],[[8,3],0],[[9,3],0],[[10,3],0],[[11,3],0],[[12,3],0],[[13,3],0],[[14,3],0],[[16,3],0],[[17,3],0],[[18,3],0],[[0,4],0],[[1,4],0],[[2,4],0],[[3,4],0],[[4,4],0],[[5,4],0],[[6,4],0],[[7,4],0],[[8,4],0],[[9,4],0],[[10,4],0],[[11,4],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[3,3],1],[[15,3],1]],"url":"https://senseis.xmp.net/?NirenseiFuseki","size":"19","type":"corner"},{"name":"Shsaku Opening","anchors":[[[3,2],-1],[[14,2],-1],[[16,3],1],[[15,4],1],[[16,14],-1],[[2,15],1],[[15,16],1]],"vertices":[[[3,2],-1],[[14,2],-1],[[16,14],-1],[[0,0],0],[[1,0],0],[[2,0],0],[[3,0],0],[[4,0],0],[[5,0],0],[[6,0],0],[[7,0],0],[[8,0],0],[[9,0],0],[[10,0],0],[[11,0],0],[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[0,1],0],[[1,1],0],[[2,1],0],[[3,1],0],[[4,1],0],[[5,1],0],[[6,1],0],[[7,1],0],[[8,1],0],[[9,1],0],[[10,1],0],[[11,1],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[0,2],0],[[1,2],0],[[2,2],0],[[4,2],0],[[5,2],0],[[6,2],0],[[7,2],0],[[8,2],0],[[9,2],0],[[10,2],0],[[11,2],0],[[12,2],0],[[13,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[0,3],0],[[1,3],0],[[2,3],0],[[3,3],0],[[4,3],0],[[5,3],0],[[6,3],0],[[7,3],0],[[8,3],0],[[9,3],0],[[10,3],0],[[11,3],0],[[12,3],0],[[13,3],0],[[14,3],0],[[15,3],0],[[17,3],0],[[18,3],0],[[0,4],0],[[1,4],0],[[2,4],0],[[3,4],0],[[4,4],0],[[5,4],0],[[6,4],0],[[7,4],0],[[8,4],0],[[9,4],0],[[10,4],0],[[11,4],0],[[12,4],0],[[13,4],0],[[14,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[0,5],0],[[1,5],0],[[2,5],0],[[3,5],0],[[4,5],0],[[5,5],0],[[6,5],0],[[7,5],0],[[8,5],0],[[9,5],0],[[10,5],0],[[11,5],0],[[12,5],0],[[13,5],0],[[14,5],0],[[15,5],0],[[16,5],0],[[17,5],0],[[18,5],0],[[0,6],0],[[1,6],0],[[2,6],0],[[3,6],0],[[4,6],0],[[5,6],0],[[6,6],0],[[7,6],0],[[8,6],0],[[9,6],0],[[10,6],0],[[11,6],0],[[12,6],0],[[13,6],0],[[14,6],0],[[15,6],0],[[16,6],0],[[17,6],0],[[18,6],0],[[0,7],0],[[1,7],0],[[2,7],0],[[3,7],0],[[4,7],0],[[5,7],0],[[6,7],0],[[7,7],0],[[8,7],0],[[9,7],0],[[10,7],0],[[11,7],0],[[12,7],0],[[13,7],0],[[14,7],0],[[15,7],0],[[16,7],0],[[17,7],0],[[18,7],0],[[0,8],0],[[1,8],0],[[2,8],0],[[3,8],0],[[4,8],0],[[5,8],0],[[6,8],0],[[7,8],0],[[8,8],0],[[9,8],0],[[10,8],0],[[11,8],0],[[12,8],0],[[13,8],0],[[14,8],0],[[15,8],0],[[16,8],0],[[17,8],0],[[18,8],0],[[0,9],0],[[1,9],0],[[2,9],0],[[3,9],0],[[4,9],0],[[5,9],0],[[6,9],0],[[7,9],0],[[8,9],0],[[9,9],0],[[10,9],0],[[11,9],0],[[12,9],0],[[13,9],0],[[14,9],0],[[15,9],0],[[16,9],0],[[17,9],0],[[18,9],0],[[0,10],0],[[1,10],0],[[2,10],0],[[3,10],0],[[4,10],0],[[5,10],0],[[6,10],0],[[7,10],0],[[8,10],0],[[9,10],0],[[10,10],0],[[11,10],0],[[12,10],0],[[13,10],0],[[14,10],0],[[15,10],0],[[16,10],0],[[17,10],0],[[18,10],0],[[0,11],0],[[1,11],0],[[2,11],0],[[3,11],0],[[4,11],0],[[5,11],0],[[6,11],0],[[7,11],0],[[8,11],0],[[9,11],0],[[10,11],0],[[11,11],0],[[12,11],0],[[13,11],0],[[14,11],0],[[15,11],0],[[16,11],0],[[17,11],0],[[18,11],0],[[0,12],0],[[1,12],0],[[2,12],0],[[3,12],0],[[4,12],0],[[5,12],0],[[6,12],0],[[7,12],0],[[8,12],0],[[9,12],0],[[10,12],0],[[11,12],0],[[12,12],0],[[13,12],0],[[14,12],0],[[15,12],0],[[16,12],0],[[17,12],0],[[18,12],0],[[0,13],0],[[1,13],0],[[2,13],0],[[3,13],0],[[4,13],0],[[5,13],0],[[6,13],0],[[7,13],0],[[8,13],0],[[9,13],0],[[10,13],0],[[11,13],0],[[12,13],0],[[13,13],0],[[14,13],0],[[15,13],0],[[16,13],0],[[17,13],0],[[18,13],0],[[0,14],0],[[1,14],0],[[2,14],0],[[3,14],0],[[4,14],0],[[5,14],0],[[6,14],0],[[7,14],0],[[8,14],0],[[9,14],0],[[10,14],0],[[11,14],0],[[12,14],0],[[13,14],0],[[14,14],0],[[15,14],0],[[17,14],0],[[18,14],0],[[0,15],0],[[1,15],0],[[3,15],0],[[4,15],0],[[5,15],0],[[6,15],0],[[7,15],0],[[8,15],0],[[9,15],0],[[10,15],0],[[11,15],0],[[12,15],0],[[13,15],0],[[14,15],0],[[15,15],0],[[16,15],0],[[17,15],0],[[18,15],0],[[0,16],0],[[1,16],0],[[2,16],0],[[3,16],0],[[4,16],0],[[5,16],0],[[6,16],0],[[7,16],0],[[8,16],0],[[9,16],0],[[10,16],0],[[11,16],0],[[12,16],0],[[13,16],0],[[14,16],0],[[16,16],0],[[17,16],0],[[18,16],0],[[0,17],0],[[1,17],0],[[2,17],0],[[3,17],0],[[4,17],0],[[5,17],0],[[6,17],0],[[7,17],0],[[8,17],0],[[9,17],0],[[10,17],0],[[11,17],0],[[12,17],0],[[13,17],0],[[14,17],0],[[15,17],0],[[16,17],0],[[17,17],0],[[18,17],0],[[0,18],0],[[1,18],0],[[2,18],0],[[3,18],0],[[4,18],0],[[5,18],0],[[6,18],0],[[7,18],0],[[8,18],0],[[9,18],0],[[10,18],0],[[11,18],0],[[12,18],0],[[13,18],0],[[14,18],0],[[15,18],0],[[16,18],0],[[17,18],0],[[18,18],0],[[16,3],1],[[15,16],1],[[2,15],1],[[15,4],1]],"url":"https://senseis.xmp.net/?ShusakuFuseki","size":"19","type":"corner"},{"name":"Low Approach","anchors":[[[14,2],1]],"vertices":[[[16,3],-1],[[13,0],0],[[13,1],0],[[13,2],0],[[13,3],0],[[13,4],0],[[14,0],0],[[14,1],0],[[14,3],0],[[14,4],0],[[15,0],0],[[15,1],0],[[15,2],0],[[15,3],0],[[15,4],0],[[16,0],0],[[16,1],0],[[16,2],0],[[16,4],0],[[17,0],0],[[17,1],0],[[17,2],0],[[17,3],0],[[17,4],0],[[18,0],0],[[18,1],0],[[18,2],0],[[18,3],0],[[18,4],0],[[14,2],1]],"url":"https://senseis.xmp.net/?34PointLowApproach","type":"corner"},{"name":"Low Approach","anchors":[[[13,2],1]],"vertices":[[[15,3],-1],[[12,0],0],[[12,1],0],[[12,2],0],[[12,3],0],[[12,4],0],[[13,0],0],[[13,1],0],[[13,3],0],[[13,4],0],[[14,0],0],[[14,1],0],[[14,2],0],[[14,3],0],[[14,4],0],[[15,0],0],[[15,1],0],[[15,2],0],[[15,4],0],[[16,0],0],[[16,1],0],[[16,2],0],[[16,3],0],[[16,4],0],[[17,0],0],[[17,1],0],[[17,2],0],[[17,3],0],[[17,4],0],[[18,0],0],[[18,1],0],[[18,2],0],[[18,3],0],[[18,4],0],[[13,2],1]],"url":"https://senseis.xmp.net/?44PointLowApproach","type":"corner"},{"name":"High Approach","anchors":[[[14,3],1]],"vertices":[[[16,3],-1],[[13,0],0],[[13,1],0],[[13,2],0],[[13,3],0],[[13,4],0],[[14,0],0],[[14,1],0],[[14,2],0],[[14,4],0],[[15,0],0],[[15,1],0],[[15,2],0],[[15,3],0],[[15,4],0],[[16,0],0],[[16,1],0],[[16,2],0],[[16,4],0],[[17,0],0],[[17,1],0],[[17,2],0],[[17,3],0],[[17,4],0],[[18,0],0],[[18,1],0],[[18,2],0],[[18,3],0],[[18,4],0],[[14,3],1]],"url":"https://senseis.xmp.net/?34PointHighApproach","type":"corner"},{"name":"High Approach","anchors":[[[13,3],1]],"vertices":[[[15,3],-1],[[12,0],0],[[12,1],0],[[12,2],0],[[12,3],0],[[12,4],0],[[13,0],0],[[13,1],0],[[13,2],0],[[13,4],0],[[14,0],0],[[14,1],0],[[14,2],0],[[14,3],0],[[14,4],0],[[15,0],0],[[15,1],0],[[15,2],0],[[15,4],0],[[16,0],0],[[16,1],0],[[16,2],0],[[16,3],0],[[16,4],0],[[17,0],0],[[17,1],0],[[17,2],0],[[17,3],0],[[17,4],0],[[18,0],0],[[18,1],0],[[18,2],0],[[18,3],0],[[18,4],0],[[13,3],1]],"url":"https://senseis.xmp.net/?44PointHighApproach","type":"corner"},{"name":"Low Enclosure","anchors":[[[14,2],1],[[16,3],1]],"vertices":[[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[13,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[13,3],0],[[14,3],0],[[15,3],0],[[17,3],0],[[18,3],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[14,2],1],[[16,3],1]],"url":"https://senseis.xmp.net/?3453Enclosure","type":"corner"},{"name":"Low Enclosure","anchors":[[[13,2],1],[[15,3],1]],"vertices":[[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[12,2],0],[[14,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[12,3],0],[[13,3],0],[[14,3],0],[[16,3],0],[[17,3],0],[[18,3],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[13,2],1],[[15,3],1]],"url":"https://senseis.xmp.net/?4463Enclosure","type":"corner"},{"name":"High Enclosure","anchors":[[[14,3],1],[[16,3],1]],"vertices":[[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[13,2],0],[[14,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[13,3],0],[[15,3],0],[[17,3],0],[[18,3],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[14,3],1],[[16,3],1]],"url":"https://senseis.xmp.net/?3454Enclosure","type":"corner"},{"name":"High Enclosure","anchors":[[[13,3],1],[[15,3],1]],"vertices":[[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[12,2],0],[[13,2],0],[[14,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[12,3],0],[[14,3],0],[[16,3],0],[[17,3],0],[[18,3],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[13,3],1],[[15,3],1]],"url":"https://senseis.xmp.net/?4464Enclosure","type":"corner"},{"name":"Low Enclosure","anchors":[[[13,2],1],[[16,3],1]],"vertices":[[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[12,2],0],[[14,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[12,3],0],[[13,3],0],[[14,3],0],[[15,3],0],[[17,3],0],[[18,3],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[13,2],1],[[16,3],1]],"url":"https://senseis.xmp.net/?3463Enclosure","type":"corner"},{"name":"Low Enclosure","anchors":[[[12,2],1],[[15,3],1]],"vertices":[[[11,0],0],[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[11,1],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[11,2],0],[[13,2],0],[[14,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[11,3],0],[[12,3],0],[[13,3],0],[[14,3],0],[[16,3],0],[[17,3],0],[[18,3],0],[[11,4],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[12,2],1],[[15,3],1]],"url":"https://senseis.xmp.net/?4473Enclosure","type":"corner"},{"name":"High Enclosure","anchors":[[[13,3],1],[[16,3],1]],"vertices":[[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[12,2],0],[[13,2],0],[[14,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[12,3],0],[[14,3],0],[[15,3],0],[[17,3],0],[[18,3],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[13,3],1],[[16,3],1]],"url":"https://senseis.xmp.net/?3464Enclosure","type":"corner"},{"name":"High Enclosure","anchors":[[[12,3],1],[[15,3],1]],"vertices":[[[11,0],0],[[12,0],0],[[13,0],0],[[14,0],0],[[15,0],0],[[16,0],0],[[17,0],0],[[18,0],0],[[11,1],0],[[12,1],0],[[13,1],0],[[14,1],0],[[15,1],0],[[16,1],0],[[17,1],0],[[18,1],0],[[11,2],0],[[12,2],0],[[13,2],0],[[14,2],0],[[15,2],0],[[16,2],0],[[17,2],0],[[18,2],0],[[11,3],0],[[13,3],0],[[14,3],0],[[16,3],0],[[17,3],0],[[18,3],0],[[11,4],0],[[12,4],0],[[13,4],0],[[14,4],0],[[15,4],0],[[16,4],0],[[17,4],0],[[18,4],0],[[12,3],1],[[15,3],1]],"url":"https://senseis.xmp.net/?4474Enclosure","type":"corner"},{"name":"Mouth Shape","anchors":[[[3,3],1],[[5,3],1],[[3,4],1],[[4,5],1],[[5,5],1]],"vertices":[[[4,2],0],[[4,3],0],[[5,4],0],[[6,4],0],[[3,3],1],[[3,4],1],[[4,5],1],[[5,5],1],[[5,3],1]],"url":"https://senseis.xmp.net/?MouthShape"},{"name":"Table Shape","anchors":[[[3,3],1],[[5,3],1],[[3,4],1],[[5,5],1]],"vertices":[[[4,3],0],[[4,4],0],[[5,4],0],[[6,4],0],[[3,3],1],[[3,4],1],[[5,3],1],[[5,5],1]],"url":"https://senseis.xmp.net/?TableShape"},{"name":"Tippy Table","anchors":[[[5,6],1]],"vertices":[[[3,4],0],[[4,4],0],[[4,5],0],[[5,5],0],[[3,3],1],[[4,3],1],[[3,5],1],[[5,6],1]],"url":"https://senseis.xmp.net/?TippyTable"},{"name":"Bamboo Joint","anchors":[[[3,3],1],[[4,3],1],[[3,5],1],[[4,5],1]],"vertices":[[[3,4],0],[[4,4],0],[[3,3],1],[[4,3],1],[[3,5],1],[[4,5],1]],"url":"https://senseis.xmp.net/?BambooJoint"},{"name":"Trapezium","anchors":[[[5,3],1],[[6,4],1]],"vertices":[[[4,3],0],[[6,3],0],[[4,4],0],[[5,4],0],[[5,5],0],[[3,3],1],[[3,4],1],[[5,3],1],[[6,4],1]],"url":"https://senseis.xmp.net/?TrapeziumShape"},{"name":"Diamond","anchors":[[[3,3],1],[[2,4],1],[[4,4],1],[[3,5],1]],"vertices":[[[3,4],0],[[3,3],1],[[2,4],1],[[4,4],1],[[3,5],1]],"url":"https://senseis.xmp.net/?Diamond"},{"name":"Tigers Mouth","anchors":[[[3,3],1],[[5,3],1],[[4,4],1]],"vertices":[[[4,2],0],[[4,3],0],[[3,3],1],[[4,4],1],[[5,3],1]],"url":"https://senseis.xmp.net/?TigersMouth"},{"name":"Empty Triangle","anchors":[[[3,3],1],[[4,3],1],[[3,4],1]],"vertices":[[[4,4],0],[[3,3],1],[[3,4],1],[[4,3],1]],"url":"https://senseis.xmp.net/?EmptyTriangle"},{"name":"Turn","anchors":[[[3,3],1],[[4,4],1]],"vertices":[[[3,4],-1],[[3,3],1],[[4,3],1],[[4,4],1]],"url":"https://senseis.xmp.net/?Turn"},{"name":"Stretch","anchors":[[[3,3],1],[[3,4],1]],"vertices":[[[3,3],1],[[3,4],1]],"url":"https://senseis.xmp.net/?Stretch"},{"name":"Diagonal","anchors":[[[3,3],1],[[4,4],1]],"vertices":[[[4,3],0],[[3,4],0],[[3,3],1],[[4,4],1]],"url":"https://senseis.xmp.net/?Kosumi"},{"name":"Wedge","anchors":[[[3,3],1]],"vertices":[[[4,3],-1],[[2,3],-1],[[3,2],0],[[3,4],0],[[3,3],1]],"url":"https://senseis.xmp.net/?Wedge"},{"name":"Hane","anchors":[[[3,3],1],[[4,4],1]],"vertices":[[[4,3],-1],[[3,4],0],[[3,3],1],[[4,4],1]],"url":"https://senseis.xmp.net/?Hane"},{"name":"Cut","anchors":[[[3,3],1],[[4,4],1]],"vertices":[[[4,3],-1],[[3,4],-1],[[3,3],1],[[4,4],1]],"url":"https://senseis.xmp.net/?Cut"},{"name":"Square","anchors":[[[3,3],1],[[3,5],1],[[5,3],1],[[5,5],1]],"vertices":[[[3,4],0],[[4,3],0],[[4,4],0],[[5,4],0],[[3,3],1],[[5,3],1],[[5,5],1],[[3,5],1]],"url":"https://senseis.xmp.net/?SquareGoodShape"},{"name":"Throwing Star","anchors":[[[3,3],1],[[4,5],1],[[5,2],1],[[6,4],1]],"vertices":[[[3,4],0],[[4,2],0],[[4,3],0],[[4,4],0],[[5,3],0],[[5,4],0],[[5,5],0],[[6,3],0],[[3,3],1],[[4,5],1],[[5,2],1],[[6,4],1]],"url":"https://senseis.xmp.net/?ThrowingStarShape"},{"name":"Parallelogram","anchors":[[[3,3],1],[[5,4],1],[[3,5],1],[[5,6],1]],"vertices":[[[4,4],0],[[4,5],0],[[3,3],1],[[5,4],1],[[3,5],1],[[5,6],1]],"url":"https://senseis.xmp.net/?Parallelogram"},{"name":"Dogs Head","anchors":[[[3,3],1],[[5,4],1],[[3,5],1]],"vertices":[[[4,3],0],[[3,4],0],[[4,4],0],[[4,5],0],[[3,3],1],[[3,5],1],[[5,4],1]],"url":"https://senseis.xmp.net/?SakeBottleShape"},{"name":"Horses Head","anchors":[[[3,3],1],[[6,4],1],[[3,5],1]],"vertices":[[[4,3],0],[[3,4],0],[[4,4],0],[[5,4],0],[[4,5],0],[[3,3],1],[[3,5],1],[[6,4],1]],"url":"https://senseis.xmp.net/?HorseHead"},{"name":"Attachment","anchors":[[[3,3],1]],"vertices":[[[4,3],-1],[[3,2],0],[[4,2],0],[[3,4],0],[[4,4],0],[[3,3],1]],"url":"https://senseis.xmp.net/?Attachment"},{"name":"One-Point Jump","anchors":[[[3,3],1],[[5,3],1]],"vertices":[[[4,3],0],[[3,3],1],[[5,3],1]],"url":"https://senseis.xmp.net/?OnePointJump"},{"name":"Big Bulge","anchors":[[[3,3],1],[[5,4],1],[[4,6],1]],"vertices":[[[4,4],0],[[4,5],0],[[3,3],1],[[5,4],1],[[4,6],1]],"url":"https://senseis.xmp.net/?BigBulge"},{"name":"Small Knight","anchors":[[[3,3],1],[[5,4],1]],"vertices":[[[4,3],0],[[4,4],0],[[3,3],1],[[5,4],1]],"url":"https://senseis.xmp.net/?Keima"},{"name":"Two-Point Jump","anchors":[[[3,3],1],[[6,3],1]],"vertices":[[[4,3],0],[[5,3],0],[[3,3],1],[[6,3],1]],"url":"https://senseis.xmp.net/?TwoPointJump"},{"name":"Large Knight","anchors":[[[3,3],1],[[6,4],1]],"vertices":[[[4,3],0],[[5,3],0],[[4,4],0],[[5,4],0],[[3,3],1],[[6,4],1]],"url":"https://senseis.xmp.net/?LargeKnightsMove"},{"name":"3-3 Point Invasion","anchors":[[[16,2],1]],"vertices":[[[15,3],-1],[[13,0],0],[[13,1],0],[[13,2],0],[[13,3],0],[[14,0],0],[[14,1],0],[[14,2],0],[[14,3],0],[[14,4],0],[[15,0],0],[[15,1],0],[[15,2],0],[[15,4],0],[[15,5],0],[[16,0],0],[[16,1],0],[[16,3],0],[[16,4],0],[[16,5],0],[[17,0],0],[[17,1],0],[[17,2],0],[[17,3],0],[[17,4],0],[[17,5],0],[[18,0],0],[[18,1],0],[[18,2],0],[[18,3],0],[[18,4],0],[[18,5],0],[[16,2],1]],"url":"https://senseis.xmp.net/?SanSanInvasion","type":"corner"},{"name":"Shoulder Hit","anchors":[[[3,3],1]],"vertices":[[[4,4],-1],[[2,2],0],[[3,2],0],[[4,2],0],[[2,3],0],[[4,3],0],[[2,4],0],[[3,4],0],[[3,3],1]],"url":"https://senseis.xmp.net/?ShoulderHit"},{"name":"Diagonal Jump","anchors":[[[3,3],1],[[5,5],1]],"vertices":[[[4,3],0],[[3,4],0],[[4,4],0],[[5,4],0],[[4,5],0],[[3,3],1],[[5,5],1]],"url":"https://senseis.xmp.net/?DiagonalJump"},{"name":"3-4 Point","anchors":[[[16,3],1]],"vertices":[[[13,0],0],[[13,1],0],[[13,2],0],[[13,3],0],[[14,0],0],[[14,1],0],[[14,2],0],[[14,3],0],[[14,4],0],[[15,0],0],[[15,1],0],[[15,2],0],[[15,3],0],[[15,4],0],[[15,5],0],[[16,0],0],[[16,1],0],[[16,2],0],[[16,4],0],[[16,5],0],[[17,0],0],[[17,1],0],[[17,2],0],[[17,3],0],[[17,4],0],[[17,5],0],[[18,0],0],[[18,1],0],[[18,2],0],[[18,3],0],[[18,4],0],[[18,5],0],[[16,3],1]],"url":"https://senseis.xmp.net/?Komoku","type":"corner"},{"name":"4-4 Point","anchors":[[[15,3],1]],"vertices":[[[13,0],0],[[13,1],0],[[13,2],0],[[13,3],0],[[14,0],0],[[14,1],0],[[14,2],0],[[14,3],0],[[14,4],0],[[15,0],0],[[15,1],0],[[15,2],0],[[15,4],0],[[15,5],0],[[16,0],0],[[16,1],0],[[16,2],0],[[16,3],0],[[16,4],0],[[16,5],0],[[17,0],0],[[17,1],0],[[17,2],0],[[17,3],0],[[17,4],0],[[17,5],0],[[18,0],0],[[18,1],0],[[18,2],0],[[18,3],0],[[18,4],0],[[18,5],0],[[15,3],1]],"url":"https://senseis.xmp.net/?44Point","type":"corner"},{"name":"3-3 Point","anchors":[[[16,2],1]],"vertices":[[[13,0],0],[[13,1],0],[[13,2],0],[[13,3],0],[[14,0],0],[[14,1],0],[[14,2],0],[[14,3],0],[[14,4],0],[[15,0],0],[[15,1],0],[[15,2],0],[[15,3],0],[[15,4],0],[[15,5],0],[[16,0],0],[[16,1],0],[[16,3],0],[[16,4],0],[[16,5],0],[[17,0],0],[[17,1],0],[[17,2],0],[[17,3],0],[[17,4],0],[[17,5],0],[[18,0],0],[[18,1],0],[[18,2],0],[[18,3],0],[[18,4],0],[[18,5],0],[[16,2],1]],"url":"https://senseis.xmp.net/?Sansan","type":"corner"},{"name":"3-5 Point","anchors":[[[16,4],1]],"vertices":[[[13,0],0],[[13,1],0],[[13,2],0],[[13,3],0],[[14,0],0],[[14,1],0],[[14,2],0],[[14,3],0],[[14,4],0],[[15,0],0],[[15,1],0],[[15,2],0],[[15,3],0],[[15,4],0],[[15,5],0],[[16,0],0],[[16,1],0],[[16,2],0],[[16,3],0],[[16,5],0],[[17,0],0],[[17,1],0],[[17,2],0],[[17,3],0],[[17,4],0],[[17,5],0],[[18,0],0],[[18,1],0],[[18,2],0],[[18,3],0],[[18,4],0],[[18,5],0],[[16,4],1]],"url":"https://senseis.xmp.net/?Mokuhazushi","type":"corner"},{"name":"4-5 Point","anchors":[[[15,4],1]],"vertices":[[[13,0],0],[[13,1],0],[[13,2],0],[[13,3],0],[[14,0],0],[[14,1],0],[[14,2],0],[[14,3],0],[[14,4],0],[[15,0],0],[[15,1],0],[[15,2],0],[[15,3],0],[[15,5],0],[[16,0],0],[[16,1],0],[[16,2],0],[[16,3],0],[[16,4],0],[[16,5],0],[[17,0],0],[[17,1],0],[[17,2],0],[[17,3],0],[[17,4],0],[[17,5],0],[[18,0],0],[[18,1],0],[[18,2],0],[[18,3],0],[[18,4],0],[[18,5],0],[[15,4],1]],"url":"https://senseis.xmp.net/?Takamoku","type":"corner"},{"name":"6-3 Point","anchors":[[[16,5],1]],"vertices":[[[13,0],0],[[13,1],0],[[13,2],0],[[13,3],0],[[14,0],0],[[14,1],0],[[14,2],0],[[14,3],0],[[14,4],0],[[15,0],0],[[15,1],0],[[15,2],0],[[15,3],0],[[15,4],0],[[15,5],0],[[16,0],0],[[16,1],0],[[16,2],0],[[16,3],0],[[16,4],0],[[17,0],0],[[17,1],0],[[17,2],0],[[17,3],0],[[17,4],0],[[17,5],0],[[18,0],0],[[18,1],0],[[18,2],0],[[18,3],0],[[18,4],0],[[18,5],0],[[16,5],1]],"url":"https://senseis.xmp.net/?Omokuhazushi","type":"corner"},{"name":"6-4 Point","anchors":[[[15,5],1]],"vertices":[[[13,0],0],[[13,1],0],[[13,2],0],[[13,3],0],[[14,0],0],[[14,1],0],[[14,2],0],[[14,3],0],[[14,4],0],[[15,0],0],[[15,1],0],[[15,2],0],[[15,3],0],[[15,4],0],[[16,0],0],[[16,1],0],[[16,2],0],[[16,3],0],[[16,4],0],[[16,5],0],[[17,0],0],[[17,1],0],[[17,2],0],[[17,3],0],[[17,4],0],[[17,5],0],[[18,0],0],[[18,1],0],[[18,2],0],[[18,3],0],[[18,4],0],[[18,5],0],[[15,5],1]],"url":"https://senseis.xmp.net/?Otakamoku","type":"corner"},{"name":"5-5 Point","anchors":[[[14,4],1]],"vertices":[[[13,0],0],[[13,1],0],[[13,2],0],[[13,3],0],[[14,0],0],[[14,1],0],[[14,2],0],[[14,3],0],[[15,0],0],[[15,1],0],[[15,2],0],[[15,3],0],[[15,4],0],[[15,5],0],[[16,0],0],[[16,1],0],[[16,2],0],[[16,3],0],[[16,4],0],[[16,5],0],[[17,0],0],[[17,1],0],[[17,2],0],[[17,3],0],[[17,4],0],[[17,5],0],[[18,0],0],[[18,1],0],[[18,2],0],[[18,3],0],[[18,4],0],[[18,5],0],[[14,4],1]],"url":"https://senseis.xmp.net/?Gonogo","type":"corner"}]');function tS(e,t){return(e%t+t)%t}function tk(e){return t=>t[0]===e[0]&&t[1]===e[1]}function tT(e,t,n){let[i,a]=e;return i>=0&&a>=0&&i<t&&a<n}function tC(e,t,n){let[i,a]=e;return[[i-1,a],[i+1,a],[i,a-1],[i,a+1]].filter(e=>tT(e,t,n)).map(e=>e)}function tE(e,t){let[n,i]=e,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=t.length,l=tC([n,i],0===s?0:t[0].length,s),u=t[i][n];for(let[e,s]of(a.push([n,i]),l)){if(o.length>=3)break;if(!(t[s][e]===-u||a.some(tk([e,s])))){if(0===t[s][e]&&!o.some(tk([e,s]))){o.push([e,s]);continue}tE([e,s],t,a,o)}}return o.length}function tI(e){let[t,n]=e;return[[t,n],[-t,n],[t,-n],[-t,-n],[n,t],[-n,t],[n,-t],[-n,-t]]}function t$(e,t,n){let[i,a]=[t-1,n-1];return tI(e).map(e=>{let[t,n]=e;return[tS(t,i),tS(n,a)]}).filter(e=>tT(e,t,n))}function tO(e,t){if(7>=Math.min(e,t))return[];let[n,i]=[e,t].map(e=>e>=13?3:2),[a,o]=[e-n-1,t-i-1],[s,l]=[e,t].map(e=>(e-1)/2),u=[];return e%2!=0&&u.push([s,i],[s,o]),t%2!=0&&u.push([n,l],[a,l]),u}function*tA(e,t,n){let i=e.length,a=0===i?0:e[0].length;if(!tT(t,a,i)||null!=n.size&&(a!==i||a!==+n.size))return;let[o,s]=t,l=e[s][o];if(0===l)return;let u=tk(t);for(let[[c,d],p]of n.anchors||[]){if("corner"===n.type&&!t$([c,d],a,i).some(u))continue;let h=Array(8).fill(!0);for(let[[t,u],f]of n.vertices){let n=tI([t-c,u-d]);for(let t=0;t<n.length;t++){if(!h[t])continue;let[u,c]=[o+n[t][0],s+n[t][1]];tT([u,c],a,i)&&e[c][u]===f*l*p||(h[t]=!1)}if(!h.includes(!0))break}for(let e=0;e<h.length;e++){if(!h[e])continue;let i=n=>{let[i,a]=n;return tI([i-c,a-d])[e].map((e,n)=>t[n]+e)};yield{symmetryIndex:e,invert:l!==p,anchors:(n.anchors||[]).map(e=>{let[t]=e;return i(t)}),vertices:n.vertices.map(e=>{let[t]=e;return i(t)})}}}}function tN(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{library:a=null}=i,o=e.length,s=0===o?0:e[0].length,l=0===t||null==n||!tT(n,s,o),u=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{pattern:{name:e,url:i,anchors:l?[]:[[n,t]],vertices:[]},match:{symmetryIndex:0,invert:!1,anchors:l?[]:[n],vertices:[]}}};if(l)return u("Pass","https://senseis.xmp.net/?Pass");let[c,d]=n;if(0!==e[d][c])return null;let p=a||t_,h=tk(n),f=tC(n,s,o);for(let[n,i]of f){if(e[i][n]!==-t)continue;let a=tE([n,i],e);if(1===a)return u("Take");if(2===a)return u("Atari","https://senseis.xmp.net/?Atari")}let g=e.map((e,n)=>d!==n?e:e.map((e,n)=>c!==n?e:t));if(0===tE(n,g))return u("Suicide","https://senseis.xmp.net/?Suicide");let m=f.filter(n=>{let[i,a]=n;return e[a][i]===t});if(m.length===f.length)return u("Fill");if(m.length>=2)return u("Connect");for(let e of p)for(let t of tA(g,n,e))return{pattern:e,match:t};return h([(s-1)/2,(o-1)/2])?u("Tengen","https://senseis.xmp.net/?Tengen"):tO(s,o).some(h)?u("Hoshi","https://senseis.xmp.net/?StarPoint"):null}function tP(e){let{gameTree:t,currentNodeId:n,currentNode:i,gameInfo:a}=e,[o,s]=(0,x.useState)(()=>{if("undefined"!=typeof window&&window.localStorage){let e=localStorage.getItem("kaya-pattern-matching-enabled");return null===e||"true"===e}return!0});(0,x.useEffect)(()=>{"undefined"!=typeof window&&window.localStorage&&localStorage.setItem("kaya-pattern-matching-enabled",String(o))},[o]);let[l,u]=(0,x.useState)(n),c=(0,x.useRef)(null);(0,x.useEffect)(()=>(c.current&&clearTimeout(c.current),c.current=window.setTimeout(()=>{u(n)},500),()=>{c.current&&clearTimeout(c.current)}),[n]);let{moveName:d,moveUrl:p}=(0,x.useMemo)(()=>{var e,s;if(!o||l!==n||!i||!t||null===l)return{moveName:null,moveUrl:null};let u=(null==(e=i.data.B)?void 0:e[0])||(null==(s=i.data.W)?void 0:s[0]);if(!u)return{moveName:null,moveUrl:null};let c=i.parentId;if(null==c)return{moveName:null,moveUrl:null};let d=`${l}-${a.boardSize}`,p=Q.get(d);if(p)return p;let h=en(t,c,a.boardSize),f=M(u);if(!f)return{moveName:null,moveUrl:null};let g=i.data.B?1:-1,m=tN(h.signMap,g,f),y={moveName:(null==m?void 0:m.pattern.name)??null,moveUrl:(null==m?void 0:m.pattern.url)??null};if(Q.size>=J){let e=Q.keys().next().value;e&&Q.delete(e)}return Q.set(d,y),y},[l,n,i,t,a.boardSize,o]);return{moveName:d,moveUrl:p,patternMatchingEnabled:o,setPatternMatchingEnabled:s}}let tD=100;function tM(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{maxHistorySize:t=tD}=e,n=(0,x.useRef)([]),i=(0,x.useRef)([]),[a,o]=(0,x.useState)(0),[s,l]=(0,x.useState)(0),u=(0,x.useCallback)((e,a)=>{let s={tree:e,currentNodeId:a};n.current.push(s),n.current.length>t&&n.current.shift(),i.current=[],o(n.current.length),l(0)},[t]),c=(0,x.useCallback)(()=>{if(0===n.current.length)return null;let e=n.current.pop();return o(n.current.length),e},[]),d=(0,x.useCallback)(()=>{if(0===i.current.length)return null;let e=i.current.pop();return l(i.current.length),e},[]),p=(0,x.useCallback)((e,n)=>{let a={tree:e,currentNodeId:n};i.current.push(a),i.current.length>t&&i.current.shift(),l(i.current.length)},[t]);return{pushHistory:u,undo:c,redo:d,canUndo:a>0,canRedo:s>0,clearHistory:(0,x.useCallback)(()=>{n.current=[],i.current=[],o(0),l(0)},[]),undoCount:a,redoCount:s,pushToRedo:p}}let tz="kaya-game-settings",tj={fuzzyStonePlacement:!0};function tR(){try{let e=localStorage.getItem(tz);if(e){let t=JSON.parse(e);return{fuzzyStonePlacement:"boolean"==typeof t.fuzzyStonePlacement?t.fuzzyStonePlacement:tj.fuzzyStonePlacement}}}catch(e){console.warn("Failed to load game settings from localStorage:",e)}return{...tj}}function tL(e){try{localStorage.setItem(tz,JSON.stringify(e))}catch(e){console.warn("Failed to save game settings to localStorage:",e)}}function tF(){let[e,t]=(0,x.useState)(tR);return{gameSettings:e,setGameSettings:(0,x.useCallback)(e=>{t(t=>{let n={...t,...e};return tL(n),n})},[])}}function tB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is,n=tQ(),i=(0,x.useRef)(e(n)),a=e(n);return t(i.current,a)||(i.current=a),i.current}function tU(e,t){if(e===t)return!0;let n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(let i of n)if(e[i]!==t[i])return!1;return!0}function tV(){return tB((0,x.useCallback)(e=>({gameTree:e.gameTree,currentNodeId:e.currentNodeId,rootId:e.rootId}),[]),tU)}function tG(){return tB((0,x.useCallback)(e=>({canGoBack:e.canGoBack,canGoForward:e.canGoForward,moveNumber:e.moveNumber,totalMovesInBranch:e.totalMovesInBranch,variations:e.variations,siblingInfo:e.siblingInfo,branchInfo:e.branchInfo,switchBranch:e.switchBranch,switchToBranchIndex:e.switchToBranchIndex,navigate:e.navigate,navigateForward:e.navigateForward,navigateBackward:e.navigateBackward,navigateToStart:e.navigateToStart,navigateToEnd:e.navigateToEnd,navigateUp:e.navigateUp,navigateDown:e.navigateDown,navigateToMove:e.navigateToMove,goToPreviousSibling:e.goToPreviousSibling,goToNextSibling:e.goToNextSibling,goToSiblingIndex:e.goToSiblingIndex,goToNode:e.goToNode,goBack:e.goBack,goForward:e.goForward,goBackSteps:e.goBackSteps,goForwardSteps:e.goForwardSteps,goToStart:e.goToStart,goToEnd:e.goToEnd}),[]),tU)}function tH(){return tB((0,x.useCallback)(e=>({currentBoard:e.currentBoard,currentNode:e.currentNode,nextMoveNode:e.nextMoveNode,markerMap:e.markerMap,gameInfo:e.gameInfo,updateGameInfo:e.updateGameInfo,moveNumber:e.moveNumber,gameId:e.gameId,analysisCacheSize:e.analysisCacheSize,gameSettings:e.gameSettings,setGameSettings:e.setGameSettings}),[]),tU)}function tW(){return tB((0,x.useCallback)(e=>({playMove:e.playMove,resign:e.resign,placeStoneDirect:e.placeStoneDirect,removeSetupStone:e.removeSetupStone}),[]),tU)}function tq(){return tB((0,x.useCallback)(e=>({editMode:e.editMode,setEditMode:e.setEditMode,toggleEditMode:e.toggleEditMode,editTool:e.editTool,setEditTool:e.setEditTool,stoneToolColor:e.stoneToolColor,setStoneToolColor:e.setStoneToolColor,editPlayMode:e.editPlayMode,setEditPlayMode:e.setEditPlayMode,addSetupStone:e.addSetupStone,addMarker:e.addMarker,removeMarker:e.removeMarker,setNodeName:e.setNodeName,setNodeComment:e.setNodeComment,deleteNode:e.deleteNode,cutNode:e.cutNode,copyNode:e.copyNode,pasteNode:e.pasteNode,copiedBranch:e.copiedBranch,copyBranch:e.copyBranch,pasteBranch:e.pasteBranch,deleteBranch:e.deleteBranch,clearAllMarkersAndLabels:e.clearAllMarkersAndLabels,clearSetupStones:e.clearSetupStones,makeMainVariation:e.makeMainVariation,shiftVariation:e.shiftVariation,deleteOtherBranches:e.deleteOtherBranches,undo:e.undo,redo:e.redo,canUndo:e.canUndo,canRedo:e.canRedo}),[]),tU)}function tK(){return tB((0,x.useCallback)(e=>({scoringMode:e.scoringMode,toggleScoringMode:e.toggleScoringMode,scoreResult:e.scoreResult,deadStones:e.deadStones,toggleDeadStone:e.toggleDeadStone,toggleDeadStones:e.toggleDeadStones,autoScore:e.autoScore,resetScore:e.resetScore,territoryMap:e.territoryMap,autoEstimateDeadStones:e.autoEstimateDeadStones,clearDeadStones:e.clearDeadStones,isEstimating:e.isEstimating}),[]),tU)}function tX(){return tB((0,x.useCallback)(e=>({analysisMode:e.analysisMode,setAnalysisMode:e.setAnalysisMode,toggleAnalysisMode:e.toggleAnalysisMode,analysisResult:e.analysisResult,isAnalyzing:e.isAnalyzing,winRate:e.winRate,scoreLead:e.scoreLead,bestMove:e.bestMove,engineState:e.engineState,aiSettings:e.aiSettings,setAISettings:e.setAISettings,customAIModel:e.customAIModel,setCustomAIModel:e.setCustomAIModel,isModelLoaded:e.isModelLoaded,isAIConfigOpen:e.isAIConfigOpen,setAIConfigOpen:e.setAIConfigOpen,showOwnership:e.showOwnership,toggleOwnership:e.toggleOwnership,showTopMoves:e.showTopMoves,toggleTopMoves:e.toggleTopMoves,showAnalysisBar:e.showAnalysisBar,setShowAnalysisBar:e.setShowAnalysisBar,toggleShowAnalysisBar:e.toggleShowAnalysisBar,modelLibrary:e.modelLibrary,selectedModelId:e.selectedModelId,setSelectedModelId:e.setSelectedModelId,downloadModel:e.downloadModel,deleteModel:e.deleteModel,uploadModel:e.uploadModel}),[]),tU)}function tZ(){return tB((0,x.useCallback)(e=>({filename:e.filename,setFilename:e.setFilename,isDirty:e.isDirty,setIsDirty:e.setIsDirty,loadSGF:e.loadSGF,loadSGFAsync:e.loadSGFAsync,saveSGF:e.saveSGF,createNewGame:e.createNewGame,isLoadingSGF:e.isLoadingSGF,loadingProgress:e.loadingProgress,loadingMessage:e.loadingMessage,lastSaveTime:e.lastSaveTime,triggerAutoSave:e.triggerAutoSave,fileName:e.fileName,setFileName:e.setFileName,exportSGF:e.exportSGF,newGame:e.newGame,isSaving:e.isSaving}),[]),tU)}let tY=(0,x.createContext)(null),tQ=()=>{let e=(0,x.useContext)(tY);if(!e)throw Error("useGameTree must be used within a GameTreeProvider");return e},tJ=e=>{let{children:t,onAutoSaveDisabled:n}=e,{gameTree:i,setGameTree:a,currentNodeId:o,setCurrentNodeId:s,gameId:l,rootId:u,gameInfo:c,loadSGF:d,loadSGFAsync:p,isLoadingSGF:h,loadingProgress:f,loadingMessage:g,createNewGame:m,saveSGF:y,updateGameInfo:b,filename:w,setFilename:_,isDirty:S,setIsDirty:k,isInitialized:T}=er(),[C,E]=x.useState(0),I=tM({maxHistorySize:100}),$=(0,x.useRef)([]),[O,A]=x.useState(0),N=(0,x.useCallback)(e=>{i&&null!==o&&(I.pushHistory(i,o),$.current=[],A(0)),a(e)},[i,o,I,a]),P=(0,x.useCallback)(()=>{if(!I.canUndo||!i||null===o)return;$.current.push({tree:i,currentNodeId:o}),A($.current.length);let e=I.undo();e&&(a(e.tree),s(e.currentNodeId))},[I,i,o,a,s]),D=(0,x.useCallback)(()=>{if(0===$.current.length||!i||null===o)return;I.pushHistory(i,o);let e=$.current.pop();A($.current.length),a(e.tree),s(e.currentNodeId)},[I,i,o,a,s]),M=I.canUndo,z=O>0,{editMode:j,setEditMode:R,editPlayMode:L,setEditPlayMode:F,editTool:B,setEditTool:U,stoneToolColor:G,setStoneToolColor:K,toggleEditMode:X}=ed(),{currentBoard:Z,currentNode:Y,nextMoveNode:Q,markerMap:J,moveNumber:ee}=ei({gameTree:i,currentNodeId:o,gameInfo:c,editMode:j}),{navigate:et,navigateToMove:en,navigateForward:ea,navigateBackward:eo,navigateUp:es,navigateDown:el,navigateToStart:ep,navigateToEnd:eh,navigateToNextFork:ef,navigateToPreviousFork:eg,navigateToMainLine:em,goToPreviousSibling:ey,goToNextSibling:eb,goToSiblingIndex:ev,siblingInfo:ex,branchInfo:ew,switchBranch:eS,switchToBranchIndex:ek,canGoBack:eT,canGoForward:eC,variations:eE,totalMovesInBranch:eI}=eu({gameTree:i,currentNodeId:o,setCurrentNodeId:s,rootId:u}),{makeMove:e$,addSetupStone:eO,addMarker:eA,setNodeName:eN,setNodeComment:eP,deleteNode:eD,cutNode:eM,copyNode:ez,pasteNode:ej,flattenVariations:eR,makeMainVariation:eL,shiftVariation:eF,copiedBranch:eB,clearSetupStones:eU,clearAllMarkersAndLabels:eV,deleteOtherBranches:eG}=ec({gameTree:i,setGameTree:N,currentNodeId:o,setCurrentNodeId:s,gameInfo:c,editMode:j,editTool:B,stoneToolColor:G,currentBoard:Z,setIsDirty:k}),{scoreMode:eH,setScoreMode:eW,scoreResult:eq,deadStones:eK,toggleDeadStone:eX,autoScore:eZ,resetScore:eY,territoryMap:eQ}=e_({currentBoard:Z,gameInfo:c}),{analysisMode:eJ,setAnalysisMode:e0,aiSettings:e1,setAISettings:e2,customAIModel:e3,setCustomAIModel:e4,isModelLoaded:e6,isAIConfigOpen:e5,setAIConfigOpen:e8,analysisResult:e9,setAnalysisResult:te,isAnalyzing:tt,winRate:tn,scoreLead:tr,bestMove:ti,engineState:ta,showOwnership:to,toggleOwnership:ts,showTopMoves:tl,toggleTopMoves:tu,showAnalysisBar:tc,setShowAnalysisBar:td,toggleShowAnalysisBar:tp,analysisCache:tg,analysisCacheSize:tm,updateAnalysisCacheSize:ty,modelLibrary:tb,selectedModelId:tv,setSelectedModelId:tx,downloadModel:t_,deleteModel:tS,uploadModel:tk}=e7({currentBoard:Z,gameInfo:c,currentNode:Y}),{gameSettings:tT,setGameSettings:tC}=tF(),{moveName:tE,moveUrl:tI,patternMatchingEnabled:t$,setPatternMatchingEnabled:tO}=tP({gameTree:i,currentNodeId:o,currentNode:Y,gameInfo:c});x.useEffect(()=>{0===tm&&C>0&&E(0)},[tm,C]);let tA=(0,x.useMemo)(()=>e1.saveAnalysisToSgf&&tm>C,[e1.saveAnalysisToSgf,tm,C]),tN=S||tA,tD=(0,x.useCallback)(e=>{k(e),e||(ty(),E(tg.current.size))},[k,tg,ty]),tz=(0,x.useCallback)(e=>{let t;"B"===e||1===e?t=1:"W"===e||-1===e||(null==Y?void 0:Y.data.B)?t=-1:(null==Y||Y.data.W,t=1),b({result:1===t?"W+R":"B+R"})},[Y,b]),tj=x.useCallback(()=>{if(!i||null===u)return"";if(!e1.saveAnalysisToSgf)return y();let e=i.get(u);if(!e)return"";let t=q.fromDimensions(c.boardSize),n=c.komi??7.5;return W([th(e,tg.current,t,n)])},[i,u,e1.saveAnalysisToSgf,tg,c,y]),tR=x.useCallback(e=>{if(tg.current.clear(),I.clearHistory(),$.current=[],A(0),e1.saveAnalysisToSgf)try{let t=V(e);if(t.length>0){let e=H(t[0]),n=e.boardSize??19,i=e.komi??7.5,a=q.fromDimensions(n),o=tf(t[0],tg.current,a,i);o>0&&(console.log(`[SGF] Loaded ${o} analyzed positions from file`),ty())}}catch(e){console.warn("Failed to extract analysis from SGF:",e)}d(e),E(tg.current.size)},[e1.saveAnalysisToSgf,tg,d,ty,I]),tL=x.useCallback(async e=>{if(tg.current.clear(),I.clearHistory(),$.current=[],A(0),e1.saveAnalysisToSgf)try{let t=V(e);if(t.length>0){let e=H(t[0]),n=e.boardSize??19,i=e.komi??7.5,a=q.fromDimensions(n),o=tf(t[0],tg.current,a,i);o>0&&(console.log(`[SGF] Loaded ${o} analyzed positions from file`),ty())}}catch(e){console.warn("Failed to extract analysis from SGF:",e)}await p(e),E(tg.current.size)},[e1.saveAnalysisToSgf,tg,p,ty,I]),tB=x.useCallback(e=>{tg.current.clear(),I.clearHistory(),$.current=[],A(0),m(e),E(0)},[tg,m,I]),tU=x.useRef(!1);x.useEffect(()=>{if(T&&!tU.current&&i&&null!=u&&e1.saveAnalysisToSgf){tU.current=!0;try{let e=i.get(u);if(!e)return;let t=c.boardSize??19,n=c.komi??7.5,a=q.fromDimensions(t),o=tf(e,tg.current,a,n);o>0&&(console.log(`[LocalStorage] Restored ${o} analyzed positions from auto-save`),ty(),E(tg.current.size))}catch(e){console.warn("Failed to extract analysis from restored game:",e)}}},[T,i,u,e1.saveAnalysisToSgf,c,tg,ty]);let{lastSaveTime:tV,triggerAutoSave:tG}=tw({gameTree:i,rootId:u,fileName:w,currentNodeId:o,onAutoSaveDisabled:n,analysisCache:tg,saveAnalysisToSgf:e1.saveAnalysisToSgf,boardSize:c.boardSize??19,komi:c.komi??7.5,analysisCacheSize:tm}),tH=(0,x.useMemo)(()=>({gameTree:i,currentNodeId:o,rootId:u,currentBoard:Z,currentNode:Y,nextMoveNode:Q,gameInfo:c,markerMap:J,customAIModel:e3,setCustomAIModel:e4,isModelLoaded:e6,aiSettings:e1,setAISettings:e2,isAIConfigOpen:e5,setAIConfigOpen:e8,analysisCache:tg,analysisCacheSize:tm,updateAnalysisCacheSize:ty,gameSettings:tT,setGameSettings:tC,modelLibrary:tb,selectedModelId:tv,setSelectedModelId:tx,downloadModel:t_,deleteModel:tS,uploadModel:tk,moveNumber:ee,totalMovesInBranch:eI,variations:eE,canGoBack:eT,canGoForward:eC,navigate:et,navigateToMove:en,navigateForward:ea,navigateBackward:eo,navigateUp:es,navigateDown:el,navigateToStart:ep,navigateToEnd:eh,navigateToNextFork:ef,navigateToPreviousFork:eg,navigateToMainLine:em,goToPreviousSibling:ey,goToNextSibling:eb,goToSiblingIndex:ev,siblingInfo:ex,branchInfo:ew,switchBranch:eS,switchToBranchIndex:ek,makeMove:e$,createNewGame:tB,loadSGF:tR,saveSGF:tj,updateGameInfo:b,editMode:j,setEditMode:R,editTool:B,setEditTool:U,stoneToolColor:G,setStoneToolColor:K,addSetupStone:eO,addMarker:eA,setNodeName:eN,setNodeComment:eP,deleteNode:eD,cutNode:eM,copyNode:ez,pasteNode:ej,flattenVariations:eR,makeMainVariation:eL,shiftVariation:eF,toggleEditMode:X,scoreMode:eH,setScoreMode:eW,scoreResult:eq,deadStones:eK,toggleDeadStone:eX,autoScore:eZ,resetScore:eY,territoryMap:eQ,analysisMode:eJ,setAnalysisMode:e0,analysisResult:e9,setAnalysisResult:te,isAnalyzing:tt,winRate:tn,scoreLead:tr,bestMove:ti,engineState:ta,showOwnership:to,toggleOwnership:ts,showTopMoves:tl,toggleTopMoves:tu,showAnalysisBar:tc,setShowAnalysisBar:td,toggleShowAnalysisBar:tp,filename:w,setFilename:_,isDirty:tN,setIsDirty:tD,gameId:l,setFileName:_,goToNode:s,playMove:e$,resign:tz,goBack:()=>eo(1),goForward:()=>ea(1),goBackSteps:e=>eo(e),goForwardSteps:e=>ea(e),goToStart:ep,goToEnd:eh,scoringMode:eH,toggleScoringMode:()=>eW(e=>!e),autoEstimateDeadStones:eZ,clearDeadStones:eY,isEstimating:!1,toggleAnalysisMode:()=>e0(e=>!e),updateComment:eP,editPlayMode:L,setEditPlayMode:F,copiedBranch:eB,copyBranch:ez,pasteBranch:ej,deleteBranch:eD,removeMarker:e=>eA(e,null),clearAllMarkersAndLabels:eV,clearSetupStones:eU,loadSGFAsync:tL,exportSGF:tj,newGame:tB,fileName:w,isSaving:!1,lastSaveTime:tV,triggerAutoSave:tG,isLoadingSGF:h,loadingProgress:f,loadingMessage:g,toggleDeadStones:eX,placeStoneDirect:eO,removeSetupStone:e=>eO(e,0),undo:P,redo:D,canUndo:M,canRedo:z,deleteOtherBranches:eG,moveName:tE,moveUrl:tI,patternMatchingEnabled:t$,setPatternMatchingEnabled:tO,togglePatternMatching:()=>tO(e=>!e)}),[i,o,u,Z,Y,Q,c,J,e3,e6,e1,e5,tT,tb,tv,ee,eE,eT,eC,et,en,ea,eo,es,el,ep,eh,ef,eg,em,ey,eb,ev,ex,ew,eS,ek,e$,tB,tR,tj,b,j,L,B,G,eO,eU,eV,eA,eN,eP,eD,eM,ez,ej,eR,eL,eF,X,eB,eH,eq,eK,eX,eZ,eY,eJ,e9,tt,tn,tr,ti,ta,w,tN,tE,tI,t$,tO,tV,tG,P,D,M,z,eG]);return(0,v.jsx)(tY.Provider,{value:tH,children:t})};var t0=__webpack_require__(255);__webpack_require__(907),t0.N;class t1 extends Error{constructor(){super("Analysis aborted"),this.name="AbortedError"}}class t2 extends t0.N{debugLog(e,t){this.debugEnabled&&(t?console.log("[WorkerEngine][debug]",e,t):console.log("[WorkerEngine][debug]",e))}async initialize(){return this.initPromise||(this.initPromise=new Promise((e,t)=>{let n=i=>{"init_success"===i.data.type?(this.worker.removeEventListener("message",n),this.initialized=!0,i.data.runtimeInfo&&(this.runtimeInfo=i.data.runtimeInfo),this.debugLog("init-success",{runtimeInfo:this.runtimeInfo}),e()):"error"!==i.data.type||i.data.id||(this.worker.removeEventListener("message",n),t(Error(i.data.error)))};this.worker.addEventListener("message",n),this.debugLog("init-request"),this.worker.postMessage({type:"init",config:this.config})})),this.initPromise}getCapabilities(){return{name:"KataGo (Worker)",version:"1.0.0",supportedBoardSizes:[],supportsParallel:!0,providesPV:!1,providesWinRate:!1,providesScoreLead:!0}}getRuntimeInfo(){return this.runtimeInfo??{backend:"wasm",inputDataType:"float32",didFallback:!1}}async analyzePosition(e,t){return new Promise((n,i)=>{let a=this.nextRequestId++;this.debugLog("analyze-request",{id:a});let o=setTimeout(()=>{this.pendingRequests.has(a)&&(this.pendingRequests.delete(a),i(Error("Analysis timed out")),this.debugLog("analyze-timeout",{id:a}))},6e4);this.pendingRequests.set(a,{resolve:n,reject:i,timeout:o}),this.worker.postMessage({type:"analyze",id:a,signMap:e,options:t})})}async analyzeBatch(e){return new Promise((t,n)=>{let i=this.nextRequestId++;this.debugLog("batch-request",{id:i,batchSize:e.length});let a=setTimeout(()=>{this.pendingRequests.has(i)&&(this.pendingRequests.delete(i),n(Error("Batch analysis timed out")),this.debugLog("batch-timeout",{id:i}))},6e4);this.pendingRequests.set(i,{resolve:t,reject:n,timeout:a}),this.worker.postMessage({type:"analyzeBatch",id:i,inputs:e})})}clearCache(){super.clearCache(),this.worker.postMessage({type:"clearCache"}),this.debugLog("clear-cache-request")}async dispose(){return new Promise(e=>{let t=n=>{"dispose_success"===n.data.type&&(this.worker.removeEventListener("message",t),this.worker.terminate(),this.initialized=!1,e())};this.worker.addEventListener("message",t),this.worker.postMessage({type:"dispose"})})}abortPendingRequests(){for(let[e,t]of(this.debugLog("abort-all",{pending:this.pendingRequests.size}),this.pendingRequests))clearTimeout(t.timeout),t.reject(new t1),this.debugLog("abort-request",{id:e});this.pendingRequests.clear()}constructor(e,t){super(t),(0,E._)(this,"worker",void 0),(0,E._)(this,"pendingRequests",void 0),(0,E._)(this,"nextRequestId",0),(0,E._)(this,"initPromise",null),(0,E._)(this,"debugEnabled",!1),(0,E._)(this,"runtimeInfo",null),this.worker=e,this.pendingRequests=new Map,this.debugEnabled=!!t.debug,this.worker.onmessage=e=>{let t=e.data;if(this.debugLog("worker-message",{type:t.type,id:t.id}),"init_success"===t.type);else if("analyze_success"===t.type){let e=this.pendingRequests.get(t.id);e&&(clearTimeout(e.timeout),e.resolve(t.result),this.pendingRequests.delete(t.id),this.debugLog("analyze-resolve",{id:t.id}))}else if("analyzeBatch_success"===t.type){let e=this.pendingRequests.get(t.id);if(e){var n;clearTimeout(e.timeout),e.resolve(t.results),this.pendingRequests.delete(t.id),this.debugLog("batch-resolve",{id:t.id,batchSize:null==(n=t.results)?void 0:n.length})}}else if("dispose_success"===t.type);else if("error"===t.type)if(void 0!==t.id){let e=this.pendingRequests.get(t.id);e&&(clearTimeout(e.timeout),e.reject(Error(t.error)),this.pendingRequests.delete(t.id),this.debugLog("request-error",{id:t.id,error:t.error}))}else console.error("Worker error:",t.error)}}}function t3(){try{return"undefined"!=typeof window&&null!==window&&("__TAURI_INTERNALS__"in window||"__TAURI__"in window)}catch{return!1}}async function t4(e,t){let n=e.engineType??"auto";if("native"===n||"auto"===n&&t3()){if(!t3())throw Error("TauriEngine is only available in Tauri desktop apps");console.log("[createEngine] Using native TauriEngine");let{TauriEngine:t}=await __webpack_require__.e("906").then(__webpack_require__.bind(__webpack_require__,161)),n=new t({modelBuffer:e.modelBuffer,modelPath:e.modelPath,modelId:e.modelId,executionProvider:e.executionProvider??"auto",enableCache:e.enableCache??!0,maxMoves:e.maxMoves??10,debug:e.debug,onProgress:e.onProgress});return await n.initialize(),n}{if(!t&&!e.modelBuffer)throw Error("WorkerEngine requires a workerFactory or modelBuffer");console.log("[createEngine] Using WorkerEngine (ONNX Runtime Web)");let n=new t2(t?t():new Worker(new URL(__webpack_require__.p+__webpack_require__.u("472"),__webpack_require__.b),Object.assign({},{type:"module"},{type:void 0})),{modelBuffer:e.modelBuffer,wasmPath:e.wasmPath??"/wasm/",executionProviders:e.executionProviders??["webgpu","wasm"],numThreads:e.numThreads??Math.min(8,navigator.hardwareConcurrency||4),enableCache:e.enableCache??!0,maxMoves:e.maxMoves??10,debug:e.debug});return await n.initialize(),n}}let t6=null,t5=null,t8=null,t7=(0,x.createContext)(null);function t9(){let e=(0,x.useContext)(t7);if(!e)throw Error("useAIEngine must be used within an AIEngineProvider");return e}let ne=e=>{let{children:t}=e,{customAIModel:n,isModelLoaded:i,aiSettings:a,setAISettings:o,setAIConfigOpen:s}=tQ(),[l,u]=(0,x.useState)(null),[c,d]=(0,x.useState)(!1),[p,h]=(0,x.useState)(null),[f,g]=(0,x.useState)(null),[m,y]=(0,x.useState)(null),b=(0,x.useRef)(!1),w=(0,x.useCallback)(async()=>{if(t6){try{await t6.dispose()}catch(e){console.error("[AIEngine] Failed to dispose engine:",e)}t6=null,t5=null,t8=null}u(null),h(null)},[]),_=(0,x.useCallback)(async()=>{let e={modelName:(null==n?void 0:n.name)||"default",backend:a.backend},t=!t8||t8.modelName!==e.modelName||t8.backend!==e.backend;if(t6&&!t){u(t6),h(null);return}if(!i||!n)return void s(!0);if(b.current&&t5){try{let e=await t5;u(e),h(null)}catch{}return}b.current=!0,d(!0),h(null);try{t6&&t&&(await t6.dispose(),t6=null,t5=null),t5||(t5=(async()=>{var e,t;let i,o,s,l=n.data;if(l instanceof File)i=await l.arrayBuffer();else if(l instanceof ArrayBuffer)i=l;else if("string"==typeof l){let e=await eA(l);if(!e)throw Error(`Model not found in storage: ${l}`);i=e}else throw Error("Invalid model data type");let u=eL(),c="web";u&&("native"===a.backend||"native-cpu"===a.backend)&&(c="native");let d=(e={MODE:"production",DEV:!1,PROD:!0,BASE_URL:"/",ASSET_PREFIX:"/kaya/next"},void 0===e)?void 0:e.VITE_ASSET_PREFIX;o=u?"/wasm/":d&&"/"!==d?d.endsWith("/")?`${d}wasm/`:`${d}/wasm/`:new URL("wasm/",document.baseURI||window.location.href).href,s="webgpu"===a.backend?["webgpu","wasm"]:["wasm"];let p=await t4({modelBuffer:i,modelId:(null==n||null==(t=n.name)?void 0:t.replace(/[^a-zA-Z0-9-_]/g,"_"))??"default",executionProvider:"native-cpu"===a.backend?"cpu":"auto",engineType:c,wasmPath:o,executionProviders:s,maxMoves:10,enableCache:!0,numThreads:Math.min(8,navigator.hardwareConcurrency||4),onProgress:e=>{y({stage:e.stage,progress:e.progress,message:e.message})}},()=>new Worker(new URL(__webpack_require__.p+__webpack_require__.u("91"),__webpack_require__.b),Object.assign({},{type:"module"},{type:void 0})));return y(null),p})());let i=await t5;t6=i,t8=e;let s=i.getRuntimeInfo();if(s.didFallback&&s.requestedBackend){let e=s.backend,t=s.requestedBackend;console.log(`[AIEngine] Backend fallback: ${t} -> ${e}`),o({backend:e}),g(`Backend switched from ${t.toUpperCase()} to ${e.toUpperCase()} for compatibility.`),setTimeout(()=>g(null),5e3)}u(i),h(null)}catch(t){let e=t instanceof Error?t.message:String(t);h(`Failed to initialize AI engine: ${e}`),console.error("[AIEngine] Initialization failed:",t),t5=null,t8=null}finally{d(!1),b.current=!1}},[n,i,a.backend,s,o]);(0,x.useEffect)(()=>{!i||!n||l||c||p||_()},[i,n,l,c,p,_]),(0,x.useEffect)(()=>{if(l&&t8){let e=a.backend;t8.backend!==e&&_()}},[a.backend,l,_]);let S={engine:l,isEngineReady:null!==l,isInitializing:c,error:p,nativeUploadProgress:m,backendFallbackMessage:f,initializeEngine:_,disposeEngine:w};return(0,v.jsx)(t7.Provider,{value:S,children:t})},nt=!1,nn=0,nr=null,ni=(0,x.createContext)(null);function na(){let e=(0,x.useContext)(ni);if(!e)throw Error("useAIAnalysis must be used within a AIAnalysisProvider");return e}let no=e=>{let{children:t}=e,{currentBoard:n,analysisMode:i,setAnalysisMode:a,moveNumber:o,gameId:s,customAIModel:l,gameTree:u,currentNodeId:c,aiSettings:d,gameInfo:p,analysisCache:h,analysisCacheSize:f,updateAnalysisCacheSize:g,analysisResult:m,setAnalysisResult:y,showOwnership:b,toggleOwnership:w,showTopMoves:_,toggleTopMoves:S,setIsDirty:k,isLoadingSGF:T}=tQ(),{engine:C,isEngineReady:E,isInitializing:I,error:$,nativeUploadProgress:O,backendFallbackMessage:A}=t9(),[N,P]=(0,x.useState)(!1),[D,M]=(0,x.useState)(null),[z,j]=(0,x.useState)(!1),[R,L]=(0,x.useState)(!1),[F,B]=(0,x.useState)(0),[U,V]=(0,x.useState)(0),[G,H]=(0,x.useState)(0),[W,q]=(0,x.useState)(null),[K,X]=(0,x.useState)(null),[Y,Q]=(0,x.useState)(!1),J=(0,x.useRef)(!1),ee=(0,x.useRef)(c),en=(0,x.useRef)(z);(0,x.useEffect)(()=>{g()},[g,s]);let er=(0,x.useCallback)(()=>{h.current.size>0&&d.saveAnalysisToSgf&&k(!0),h.current.clear(),g(),y(null),nn++,C&&C.clearCache()},[h,g,y,C,d.saveAnalysisToSgf,k]);(0,x.useEffect)(()=>{ee.current=c},[c]),(0,x.useEffect)(()=>{en.current=z},[z]);let ei=(0,x.useRef)(!0),ea=(0,x.useRef)(null);(0,x.useEffect)(()=>{let e=(null==l?void 0:l.name)??null;if(null===ea.current){ea.current=e;return}ea.current!==e&&(h.current.clear(),ea.current=e)},[l,h]);let eo=(0,x.useRef)(void 0),es=(0,x.useRef)(!1);(0,x.useEffect)(()=>{let e=null==p?void 0:p.komi,t=es.current;if(es.current=T,void 0===eo.current||T||t&&!T){eo.current=e;return}eo.current!==e&&(h.current.clear(),g(),y(null),eo.current=e)},[null==p?void 0:p.komi,h,g,y,T]);let el=(0,x.useCallback)(async()=>{if(nt&&nr===c)return;if(nt=!0,nr=c,!i||en.current||!C||!u||null==c){nt=!1;return}let e=n.signMap.length,t=(null==p?void 0:p.komi)??7.5,a=et(u,c),s=a.length-1,l={prev:null,current:null},d=ti(e);for(let e=0;e<a.length;e++){let n=te((d=ta(d,a[e],e)).board.signMap,d.nextToPlay,t,d.history);e===s-1&&s>0?l.prev={state:{...d,board:d.board.clone(),history:[...d.history]},cacheKey:n,index:e}:e===s&&(l.current={state:{...d,board:d.board.clone(),history:[...d.history]},cacheKey:n,index:e})}let f={prev:l.prev?h.current.get(l.prev.cacheKey)??null:null,current:h.current.get(l.current.cacheKey)??null};if(f.current&&(!l.prev||null!==f.prev)){y(e9(f.current,f.prev)),nt=!1;return}let m=++nn,b=performance.now();P(!0),M(null);try{let e=[];l.prev&&!f.prev&&e.push({key:"prev",signMap:l.prev.state.board.signMap,options:{history:l.prev.state.history,nextToPlay:l.prev.state.nextToPlay,komi:t},cacheKey:l.prev.cacheKey}),f.current||e.push({key:"current",signMap:l.current.state.board.signMap,options:{history:l.current.state.history,nextToPlay:l.current.state.nextToPlay,komi:t},cacheKey:l.current.cacheKey});let n={};if(e.length>0){if(1===e.length){let t=e[0],i=await C.analyze(t.signMap,t.options);n[t.key]=i,h.current.set(t.cacheKey,i)}else{let t=e.map(e=>({signMap:e.signMap,options:e.options}));(await C.analyzeBatch(t)).forEach((t,i)=>{let a=e[i];n[a.key]=t,h.current.set(a.cacheKey,t)})}g()}if(m===nn){let t={prev:f.prev??n.prev??null,current:f.current??n.current},i=e9(t.current,t.prev);y(i);let a=performance.now()-b,s=t.current,u=l.current.state.history.length,c=s.moveSuggestions.slice(0,5).map(e=>({move:e.move,prob:`${(100*e.probability).toFixed(1)}%`})),d=l.current.state.board.signMap,p=0,h=0;for(let e of d)for(let t of e)1===t?p++:-1===t&&h++;let g=[];for(let e of s.moveSuggestions.slice(0,5)){let t=e.move;if(t&&t.length>=2&&"pass"!==t){let e=t.charCodeAt(0)-65-(t.charCodeAt(0)>73),n=parseInt(t.slice(1))-1;if(n>=0&&n<d.length&&e>=0&&e<d.length){var v;let i=d.length-1-n,a=null==(v=d[i])?void 0:v[e];1===a?g.push({move:t,occupied:"B"}):-1===a&&g.push({move:t,occupied:"W"})}}}console.log("[AI] Live analysis:",{move:o,inferences:e.length,cached:{prev:!!f.prev,current:!!f.current},historyMoves:u,stonesOnBoard:{black:p,white:h,total:p+h},nextToPlay:l.current.state.nextToPlay,winRate:`${(100*s.winRate).toFixed(1)}%`,scoreLead:s.scoreLead.toFixed(1),topMoves:c,...g.length>0?{WARNING_INVALID_MOVES:g}:{},durationMs:Math.round(a),msPerInference:e.length>0?Math.round(a/e.length):0})}}catch(e){if(m===nn){let t=e instanceof Error?e.message:String(e);M(`Analysis failed: ${t}`),console.error("AI analysis failed:",e)}}finally{nt=!1,nr=null,m===nn&&P(!1)}},[C,i,n,u,c,o,p,h,g,y]),eu=(0,x.useCallback)(()=>{if(!u||null==c)return!1;let e=n.signMap.length,t=(null==p?void 0:p.komi)??7.5,i=et(u,c),a=i.length-1,o=[],s=ti(e);for(let e=0;e<i.length;e++)if(s=ta(s,i[e],e),e===a-1||e===a){let n=te(s.board.signMap,s.nextToPlay,t,s.history);o.push({index:e,key:n})}let l=o.find(e=>e.index===a);if(!l||!h.current.has(l.key))return!1;let d=h.current.get(l.key),f=o.find(e=>e.index===a-1);return y(e9(d,f?h.current.get(f.key)??null:null)),!0},[u,c,n,p,h,y]),ec=(0,x.useCallback)(async()=>{if(u&&null!=c){if(!i){Q(!0),a(!0);return}if(!C)return void Q(!0);Q(!1),en.current=!0,X(null),nn++,P(!1),C instanceof t2&&C.abortPendingRequests(),Z.size>0&&Z.clear(),j(!0),B(0),q(null),J.current=!1;try{let e=et(u,c),t=Array.from(u.listNodesVertically(c,1)).slice(1),i=[...e,...t];H(i.length);let a=n.signMap.length,o=(null==p?void 0:p.komi)??7.5,s=ti(a),l=[];for(let e=0;e<i.length;e++){let t=i[e];s=ta(s,t,e);let n=te(s.board.signMap,s.nextToPlay,o,s.history);h.current.has(n)||l.push({index:e,signMap:s.board.clone().signMap,history:[...s.history],nextToPlay:s.nextToPlay,cacheKey:n})}let d=i.length-l.length;if(0===l.length){X(`All ${i.length} positions are already analyzed`),setTimeout(()=>X(null),3e3);return}let f=d,m=8,y=0,b=0;B(Math.round(f/i.length*100)),V(f);for(let e=0;e<l.length&&!J.current;e+=m){let t=l.slice(e,e+m),n=t.map(e=>({signMap:e.signMap,options:{history:e.history,nextToPlay:e.nextToPlay,komi:o}}));try{let a=performance.now(),o=await C.analyzeBatch(n),s=performance.now()-a;y+=s;let u=(b+=t.length)/y*1e3,c=l.length-(e+t.length),d=c/u,p=d<60?`${Math.round(d)}s`:`${Math.floor(d/60)}m ${Math.round(d%60)}s`;q(c>0?p:null);let m=t.map(e=>e.index),v=Math.min(...m),x=Math.max(...m),w=o.map((e,n)=>{let i=t[n],a=e.moveSuggestions.slice(0,3).map(e=>({move:e.move,prob:`${(100*e.probability).toFixed(1)}%`}));return{move:i.index,nextToPlay:i.nextToPlay,winRate:`${(100*e.winRate).toFixed(1)}%`,scoreLead:e.scoreLead.toFixed(1),topMoves:a}});console.log("[AI] Batch analysis:",{moves:1===t.length?v:`${v}-${x}`,positions:t.length,durationMs:Math.round(s),msPerMove:Math.round(s/t.length),progress:`${f+t.length}/${i.length}`,eta:c>0?p:"done",results:w}),o.forEach((e,n)=>{let a=t[n];h.current.set(a.cacheKey,e);let o=ee.current,s=i.findIndex(e=>String(e.id)===String(o));a.index===s&&eu()}),g(),f+=t.length,B(Math.round(f/i.length*100)),V(f)}catch(e){console.error("[BatchAnalysis] Batch failed:",e);break}}}catch(e){console.error("[BatchAnalysis] Failed:",e),X("Analysis failed")}finally{j(!1),L(!1),en.current=!1,q(null),Q(!1),eu()}}},[u,c,i,C,n,p,h,eu,a,g]),ed=(0,x.useCallback)(()=>{z&&(J.current=!0,L(!0))},[z]);(0,x.useEffect)(()=>{i&&C&&!z&&!nt?eu()||(y(null),el()):i||y(null)},[i,C,c,z,eu,el,y]),(0,x.useEffect)(()=>{Y&&C&&i&&ec()},[Y,C,i,ec]);let ep=(0,x.useMemo)(()=>{if(!m||!_)return null;let e=n.signMap.length,t=Array(e).fill(null).map(()=>Array(e).fill(null));if(m.moveSuggestions){let a=m.moveSuggestions.filter(e=>e.probability>=d.minProb),o=0;for(let s of a){var i;if(o>=d.maxTopMoves)break;let a=tt(s.move,e);if(!a)continue;let[l,u]=a;if(l<0||l>=e||u<0||u>=e||(null==(i=n.signMap[u])?void 0:i[l])!==0)continue;let c=tn(s.probability),p=tr(s.probability),h=`${p}`;t[u][l]={strength:c,text:h},o++}}return t},[m,n.signMap.length,d.maxTopMoves,d.minProb,_]),eh=(0,x.useMemo)(()=>{if(!b||!(null==m?void 0:m.ownership))return null;let e=n.signMap.length,t=Array(e).fill(null).map(()=>Array(e).fill(0)),i=m.ownership;for(let o=0;o<e;o++)for(let s=0;s<e;s++){var a;if((null==(a=n.signMap[o])?void 0:a[s])!==0)continue;let l=o*e+s;l<i.length&&(t[o][s]=i[l])}return t},[b,m,n.signMap.length]);(0,x.useEffect)(()=>{if(ei.current){ei.current=!1;return}en.current&&(J.current=!0,L(!0)),M(null),j(!1),L(!1),B(0),V(0),H(0),q(null)},[s]);let ef={heatMap:ep,ownershipMap:eh,showOwnership:b,toggleOwnership:w,showTopMoves:_,toggleTopMoves:S,isInitializing:I,isAnalyzing:N,error:D||$,analysisResult:m,analyzeFullGame:ec,stopFullGameAnalysis:ed,isFullGameAnalyzing:z,isStopping:R,fullGameProgress:F,fullGameCurrentMove:U,fullGameTotalMoves:G,fullGameETA:W,allAnalyzedMessage:K,analysisCacheSize:f,clearAnalysisCache:er,pendingFullGameAnalysis:Y,nativeUploadProgress:O,backendFallbackMessage:A};return(0,v.jsx)(ni.Provider,{value:ef,children:t})},ns=(0,x.createContext)(void 0),nl=()=>{let e=(0,x.useContext)(ns);if(!e)throw Error("useGameControllerManager must be used within GameControllerManagerProvider");return e},nu=e=>{let{children:t}=e,[n,i]=(0,x.useState)(new Set),a=(0,x.useRef)(new Set),o=(0,x.useCallback)(e=>{i(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},[]),s=(0,x.useCallback)(e=>n.has(e),[n]);return(0,x.useEffect)(()=>{let e=window.gameControl;if(!e)return;let t=()=>{let t=new Set(Object.keys(e.getGamepads()).map(Number));i(e=>{let n=new Set(e),i=!1;for(let o of e)t.has(o)||(n.delete(o),a.current.delete(o),i=!0);for(let e of t)a.current.has(e)||(a.current.add(e),n.add(e),i=!0);return i?n:e})};t(),e.on("connect",t);let n=setInterval(t,1e3);return()=>{clearInterval(n)}},[]),(0,v.jsx)(ns.Provider,{value:{activeControllerIds:n,toggleController:o,isControllerActive:s},children:t})},nc={buttonA:0,buttonB:1,start:9,select:8,shoulderLeft:4,shoulderRight:5,triggerLeft:6,triggerRight:7,useDpadAxis:!1},nd={"Vendor: 2dc8 Product: 5112":{buttonA:0,buttonB:1,start:11,select:10,shoulderLeft:6,shoulderRight:7,triggerLeft:8,triggerRight:9,dpadAxisIndex:9,dpadMap:{up:-1,down:.14286,left:.71429,right:-.42857},useDpadAxis:!0,rightStickXAxis:2,rightStickYAxis:5}};function np(e){if(!e||"string"!=typeof e)return nc;for(let[t,n]of Object.entries(nd))if(e.includes(t))return n;return nc}function nh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{onStateChange:t,enabled:n=!0}=e,{isControllerActive:i}=nl();(0,x.useEffect)(()=>{if(!n)return;let e=window.gameControl;if(!e)return;let a=new Map,o=new Map,s=e=>(a.has(e)||a.set(e,{moveX:0,moveY:0,navX:0,navY:0,buttonA:!1,buttonB:!1,buttonStart:!1,buttonSelect:!1,shoulderLeft:!1,shoulderRight:!1,triggerLeft:!1,triggerRight:!1,connected:!1,name:"",type:""}),a.get(e)),l=e=>{i(e)&&t&&t({...s(e)})},u=e=>{var t;let n=Number(e.id),a=s(n);a.connected=!0;let u=o.get(n);u&&(u.stick&&clearInterval(u.stick),u.axis&&clearInterval(u.axis),u.rightStick&&clearInterval(u.rightStick)),o.set(n,{isUsingStick:!1});let c=e.gamepad||(navigator.getGamepads?navigator.getGamepads()[e.id]:null)||(null==(t=window.gamepads)?void 0:t[e.id]),d=c&&c.id||(e.id&&"string"==typeof e.id?e.id:"Unknown");a.name=d,a.type=e.mapping||"standard";let p=np(d),h=()=>i(n),f=(e,t)=>{h()&&(s(n)[e]=t,l(n))};p.useDpadAxis||(e.before("button12",()=>{h()&&(s(n).moveY=-1,l(n))}),e.after("button12",()=>{h()&&(s(n).moveY=0,l(n))}),e.before("button13",()=>{h()&&(s(n).moveY=1,l(n))}),e.after("button13",()=>{h()&&(s(n).moveY=0,l(n))}),e.before("button14",()=>{h()&&(s(n).moveX=-1,l(n))}),e.after("button14",()=>{h()&&(s(n).moveX=0,l(n))}),e.before("button15",()=>{h()&&(s(n).moveX=1,l(n))}),e.after("button15",()=>{h()&&(s(n).moveX=0,l(n))}));let g=setInterval(()=>{if(!h())return;let e=(navigator.getGamepads?navigator.getGamepads():[])[n];if(!e||!e.axes)return;let t=s(n),i=o.get(n),a=.5,u=e.axes[0]||0,c=e.axes[1]||0,d=0,p=0;Math.abs(u)>a||Math.abs(c)>a?(d=Math.abs(u)>a?Math.sign(u):0,p=Math.abs(c)>a?Math.sign(c):0,i&&(i.isUsingStick=!0)):i&&(i.isUsingStick=!1),(t.moveX!==d||t.moveY!==p)&&(t.moveX=d,t.moveY=p,l(n))},150);o.get(n).stick=g;let m=p.rightStickXAxis??2,y=p.rightStickYAxis??3,b=setInterval(()=>{if(!h())return;let e=(navigator.getGamepads?navigator.getGamepads():[])[n];if(!e||!e.axes)return;let t=s(n),i=.5,a=e.axes[m]||0,o=e.axes[y]||0,u=0,c=0;Math.abs(a)>i&&(u=Math.sign(a)),Math.abs(o)>i&&(c=Math.sign(o)),(t.navX!==u||t.navY!==c)&&(t.navX=u,t.navY=c,l(n))},150);if(o.get(n).rightStick=b,e.before(`button${p.buttonA}`,()=>{f("buttonA",!0)}),e.after(`button${p.buttonA}`,()=>{f("buttonA",!1)}),e.before(`button${p.buttonB}`,()=>{f("buttonB",!0)}),e.after(`button${p.buttonB}`,()=>{f("buttonB",!1)}),e.before(`button${p.start}`,()=>{f("buttonStart",!0)}),e.after(`button${p.start}`,()=>{f("buttonStart",!1)}),e.before(`button${p.select}`,()=>{f("buttonSelect",!0)}),e.after(`button${p.select}`,()=>{f("buttonSelect",!1)}),e.before(`button${p.shoulderLeft}`,()=>{f("shoulderLeft",!0)}),e.after(`button${p.shoulderLeft}`,()=>{f("shoulderLeft",!1)}),e.before(`button${p.shoulderRight}`,()=>{f("shoulderRight",!0)}),e.after(`button${p.shoulderRight}`,()=>{f("shoulderRight",!1)}),e.before(`button${p.triggerLeft}`,()=>{f("triggerLeft",!0)}),e.after(`button${p.triggerLeft}`,()=>{f("triggerLeft",!1)}),e.before(`button${p.triggerRight}`,()=>{f("triggerRight",!0)}),e.after(`button${p.triggerRight}`,()=>{f("triggerRight",!1)}),void 0!==p.dpadAxisIndex&&p.dpadMap){let e=p.dpadAxisIndex,t=p.dpadMap,i=1.28571,a=setInterval(()=>{if(!h())return;let a=o.get(n);if(null==a?void 0:a.isUsingStick)return;let u=(navigator.getGamepads?navigator.getGamepads():[])[n];if(!u||!u.axes)return;let c=s(n),d=u.axes[e],p=.08,f=0,g=0;Math.abs(d-i)>.2&&(Math.abs(d-t.up)<p?g=-1:Math.abs(d-t.down)<p?g=1:Math.abs(d-t.left)<p?f=-1:Math.abs(d-t.right)<p&&(f=1)),(c.moveX!==f||c.moveY!==g)&&(c.moveX=f,c.moveY=g,l(n))},100);o.get(n).axis=a}l(n)};e.on("connect",e=>{u(e)});let c=e.getGamepads();for(let e in c)c[e]&&u(c[e]);return()=>{for(let e of o.values())e.stick&&clearInterval(e.stick),e.axis&&clearInterval(e.axis),e.rightStick&&clearInterval(e.rightStick);o.clear()}},[n,t,i])}let nf=(0,x.createContext)(void 0),ng=()=>{let e=(0,x.useContext)(nf);if(!e)throw Error("useBoardNavigation must be used within BoardNavigationProvider");return e},nm=e=>{let{children:t}=e,{playMove:n,goBack:i,goForward:a,goBackSteps:o,goForwardSteps:s,canGoBack:l,canGoForward:u,currentBoard:c,moveNumber:d,editMode:p,setEditMode:h,toggleShowAnalysisBar:f,branchInfo:g,switchBranch:m}=tQ(),y=c.signMap.length,[b,w]=(0,x.useState)(!1),[_,S]=(0,x.useState)(9),[k,T]=(0,x.useState)(9),[C,E]=(0,x.useState)(null);(0,x.useEffect)(()=>{if(0===d&&c.isEmpty()){let e=Math.floor(y/2);S(e),T(e)}},[d,c,y]),(0,x.useEffect)(()=>{S(e=>Math.min(e,y-1)),T(e=>Math.min(e,y-1))},[y]);let I=(0,x.useCallback)(e=>{o(e)},[o]),$=(0,x.useCallback)(e=>{s(e)},[s]),O=(0,x.useCallback)(()=>{w(e=>!e)},[]),A=(0,x.useCallback)((e,t)=>{b&&(S(t=>(t+e+y)%y),T(e=>(e+t+y)%y))},[b,y]),N=(0,x.useCallback)((e,t)=>{b&&(S(Math.max(0,Math.min(y-1,e))),T(Math.max(0,Math.min(y-1,t))))},[b,y]),P=(0,x.useCallback)(()=>{b&&(C?C():n([_,k],d%2==0?1:-1))},[b,_,k,n,d,C]);(0,x.useEffect)(()=>{if(!b)return;let e=e=>{if(!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)&&!e.target.isContentEditable)switch(e.key){case"ArrowUp":e.preventDefault(),A(0,-1);break;case"ArrowDown":e.preventDefault(),A(0,1);break;case"ArrowLeft":e.preventDefault(),A(-1,0);break;case"ArrowRight":e.preventDefault(),A(1,0);break;case" ":case"Enter":e.preventDefault(),P();break;case"PageUp":e.preventDefault(),l&&i();break;case"PageDown":e.preventDefault(),u&&a()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[b,A,P,l,u,i,a]);let D=(0,x.useRef)(0),M=(0,x.useRef)(0),z=(0,x.useRef)(0),j=(0,x.useRef)({x:0,y:0}),R=(0,x.useRef)({buttonA:!1,buttonB:!1,buttonStart:!1,buttonSelect:!1,shoulderLeft:!1,shoulderRight:!1,triggerLeft:!1,triggerRight:!1}),L=(0,x.useRef)({x:0,y:0});nh({enabled:!0,onStateChange:e=>{if(!e.connected||(e.buttonStart&&!R.current.buttonStart&&w(e=>!e),R.current.buttonStart=e.buttonStart,e.buttonSelect&&!R.current.buttonSelect&&f(),R.current.buttonSelect=e.buttonSelect,!b))return;let t=Date.now(),n=50,o=50,s=100;(e.moveX!==j.current.x||e.moveY!==j.current.y)&&(t-D.current>n&&(0!==e.moveX||0!==e.moveY)&&(A(e.moveX,e.moveY),D.current=t),j.current={x:e.moveX,y:e.moveY});let c=e.buttonA||e.buttonB,d=R.current.buttonA||R.current.buttonB;c&&!d&&t-z.current>s&&(P(),z.current=t),R.current.buttonA=e.buttonA,R.current.buttonB=e.buttonB,t-M.current>o&&(e.shoulderLeft&&!R.current.shoulderLeft?!l||e.triggerLeft||e.triggerRight||(i(),M.current=t):e.shoulderRight&&!R.current.shoulderRight?!u||e.triggerLeft||e.triggerRight||(a(),M.current=t):e.triggerLeft&&!R.current.triggerLeft?l&&(I(10),M.current=t+200):e.triggerRight&&!R.current.triggerRight&&u&&($(10),M.current=t+200)),R.current.shoulderLeft=e.shoulderLeft,R.current.shoulderRight=e.shoulderRight,R.current.triggerLeft=e.triggerLeft,R.current.triggerRight=e.triggerRight,(e.navX!==L.current.x||e.navY!==L.current.y)&&(t-M.current>o&&(-1===e.navX&&-1!==L.current.x?l&&(i(),M.current=t):1===e.navX&&1!==L.current.x&&u&&(a(),M.current=t),-1===e.navY&&-1!==L.current.y?g.hasBranches&&(m("next"),M.current=t):1===e.navY&&1!==L.current.y&&g.hasBranches&&(m("previous"),M.current=t)),L.current={x:e.navX,y:e.navY})}});let F={navigationMode:b,toggleNavigationMode:O,cursorX:_,cursorY:k,moveCursor:A,setCursorPosition:N,performAction:P,setActionHandler:E};return(0,v.jsx)(nf.Provider,{value:F,children:t})},ny=(0,x.createContext)(null);function nb(){let e=(0,x.useContext)(ny);return e||{isTauriDragging:!1,isOverLibrary:!1,setTauriDragging:()=>{},setOverLibrary:()=>{}}}let nv=e=>"string"==typeof e,nx=()=>{let e,t,n=new Promise((n,i)=>{e=n,t=i});return n.resolve=e,n.reject=t,n},nw=e=>null==e?"":""+e,n_=(e,t,n)=>{e.forEach(e=>{t[e]&&(n[e]=t[e])})},nS=/###/g,nk=e=>e&&e.indexOf("###")>-1?e.replace(nS,"."):e,nT=e=>!e||nv(e),nC=(e,t,n)=>{let i=nv(t)?t.split("."):t,a=0;for(;a<i.length-1;){if(nT(e))return{};let t=nk(i[a]);!e[t]&&n&&(e[t]=new n),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++a}return nT(e)?{}:{obj:e,k:nk(i[a])}},nE=(e,t,n)=>{let{obj:i,k:a}=nC(e,t,Object);if(void 0!==i||1===t.length){i[a]=n;return}let o=t[t.length-1],s=t.slice(0,t.length-1),l=nC(e,s,Object);for(;void 0===l.obj&&s.length;)o=`${s[s.length-1]}.${o}`,l=nC(e,s=s.slice(0,s.length-1),Object),l?.obj&&void 0!==l.obj[`${l.k}.${o}`]&&(l.obj=void 0);l.obj[`${l.k}.${o}`]=n},nI=(e,t,n,i)=>{let{obj:a,k:o}=nC(e,t,Object);a[o]=a[o]||[],a[o].push(n)},n$=(e,t)=>{let{obj:n,k:i}=nC(e,t);if(n&&Object.prototype.hasOwnProperty.call(n,i))return n[i]},nO=(e,t,n)=>{let i=n$(e,n);return void 0!==i?i:n$(t,n)},nA=(e,t,n)=>{for(let i in t)"__proto__"!==i&&"constructor"!==i&&(i in e?nv(e[i])||e[i]instanceof String||nv(t[i])||t[i]instanceof String?n&&(e[i]=t[i]):nA(e[i],t[i],n):e[i]=t[i]);return e},nN=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var nP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};let nD=e=>nv(e)?e.replace(/[&<>"'\/]/g,e=>nP[e]):e;class nM{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){let t=this.regExpMap.get(e);if(void 0!==t)return t;let n=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,n),this.regExpQueue.push(e),n}}let nz=[" ",",","?","!",";"],nj=new nM(20),nR=(e,t,n)=>{t=t||"",n=n||"";let i=nz.filter(e=>0>t.indexOf(e)&&0>n.indexOf(e));if(0===i.length)return!0;let a=nj.getRegExp(`(${i.map(e=>"?"===e?"\\?":e).join("|")})`),o=!a.test(e);if(!o){let t=e.indexOf(n);t>0&&!a.test(e.substring(0,t))&&(o=!0)}return o},nL=(e,t,n=".")=>{if(!e)return;if(e[t]){if(!Object.prototype.hasOwnProperty.call(e,t))return;return e[t]}let i=t.split(n),a=e;for(let e=0;e<i.length;){let t;if(!a||"object"!=typeof a)return;let o="";for(let s=e;s<i.length;++s)if(s!==e&&(o+=n),o+=i[s],void 0!==(t=a[o])){if(["string","number","boolean"].indexOf(typeof t)>-1&&s<i.length-1)continue;e+=s-e+1;break}a=t}return a},nF=e=>e?.replace("_","-"),nB={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console?.[e]?.apply?.(console,t)}};class nU{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||nB,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,n,i){return i&&!this.debug?null:(nv(e[0])&&(e[0]=`${n}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new nU(this.logger,{...{prefix:`${this.prefix}:${e}:`},...this.options})}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new nU(this.logger,e)}}var nV=new nU;class nG{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(e=>{this.observers[e]||(this.observers[e]=new Map);let n=this.observers[e].get(t)||0;this.observers[e].set(t,n+1)}),this}off(e,t){if(this.observers[e]){if(!t)return void delete this.observers[e];this.observers[e].delete(t)}}emit(e,...t){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([e,n])=>{for(let i=0;i<n;i++)e(...t)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([n,i])=>{for(let a=0;a<i;a++)n.apply(n,[e,...t])})}}class nH extends nG{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){0>this.options.ns.indexOf(e)&&this.options.ns.push(e)}removeNamespaces(e){let t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,n,i={}){let a,o=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator,s=void 0!==i.ignoreJSONStructure?i.ignoreJSONStructure:this.options.ignoreJSONStructure;e.indexOf(".")>-1?a=e.split("."):(a=[e,t],n&&(Array.isArray(n)?a.push(...n):nv(n)&&o?a.push(...n.split(o)):a.push(n)));let l=n$(this.data,a);return(!l&&!t&&!n&&e.indexOf(".")>-1&&(e=a[0],t=a[1],n=a.slice(2).join(".")),!l&&s&&nv(n))?nL(this.data?.[e]?.[t],n,o):l}addResource(e,t,n,i,a={silent:!1}){let o=void 0!==a.keySeparator?a.keySeparator:this.options.keySeparator,s=[e,t];n&&(s=s.concat(o?n.split(o):n)),e.indexOf(".")>-1&&(s=e.split("."),i=t,t=s[1]),this.addNamespaces(t),nE(this.data,s,i),a.silent||this.emit("added",e,t,n,i)}addResources(e,t,n,i={silent:!1}){for(let i in n)(nv(n[i])||Array.isArray(n[i]))&&this.addResource(e,t,i,n[i],{silent:!0});i.silent||this.emit("added",e,t,n)}addResourceBundle(e,t,n,i,a,o={silent:!1,skipCopy:!1}){let s=[e,t];e.indexOf(".")>-1&&(s=e.split("."),i=n,n=t,t=s[1]),this.addNamespaces(t);let l=n$(this.data,s)||{};o.skipCopy||(n=JSON.parse(JSON.stringify(n))),i?nA(l,n,a):l={...l,...n},nE(this.data,s,l),o.silent||this.emit("added",e,t,n)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){let t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(e=>t[e]&&Object.keys(t[e]).length>0)}toJSON(){return this.data}}var nW={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,n,i,a){return e.forEach(e=>{t=this.processors[e]?.process(t,n,i,a)??t}),t}};let nq=Symbol("i18next/PATH_KEY");function nK(){let e,t=[],n=Object.create(null);return n.get=(i,a)=>(e?.revoke?.(),a===nq)?t:(t.push(a),(e=Proxy.revocable(i,n)).proxy),Proxy.revocable(Object.create(null),n).proxy}function nX(e,t){let{[nq]:n}=e(nK());return n.join(t?.keySeparator??".")}let nZ={},nY=e=>!nv(e)&&"boolean"!=typeof e&&"number"!=typeof e;class nQ extends nG{constructor(e,t={}){super(),n_(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=nV.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){let n={...t};if(null==e)return!1;let i=this.resolve(e,n);if(i?.res===void 0)return!1;let a=nY(i.res);return!1!==n.returnObjects||!a}extractFromKey(e,t){let n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");let i=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,a=t.ns||this.options.defaultNS||[],o=n&&e.indexOf(n)>-1,s=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!nR(e,n,i);if(o&&!s){let t=e.match(this.interpolator.nestingRegexp);if(t&&t.length>0)return{key:e,namespaces:nv(a)?[a]:a};let o=e.split(n);(n!==i||n===i&&this.options.ns.indexOf(o[0])>-1)&&(a=o.shift()),e=o.join(i)}return{key:e,namespaces:nv(a)?[a]:a}}translate(e,t,n){let i="object"==typeof t?{...t}:t;if("object"!=typeof i&&this.options.overloadTranslationOptionHandler&&(i=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof i&&(i={...i}),i||(i={}),null==e)return"";"function"==typeof e&&(e=nX(e,{...this.options,...i})),Array.isArray(e)||(e=[String(e)]);let a=void 0!==i.returnDetails?i.returnDetails:this.options.returnDetails,o=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator,{key:s,namespaces:l}=this.extractFromKey(e[e.length-1],i),u=l[l.length-1],c=void 0!==i.nsSeparator?i.nsSeparator:this.options.nsSeparator;void 0===c&&(c=":");let d=i.lng||this.language,p=i.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(d?.toLowerCase()==="cimode")return p?a?{res:`${u}${c}${s}`,usedKey:s,exactUsedKey:s,usedLng:d,usedNS:u,usedParams:this.getUsedParamsDetails(i)}:`${u}${c}${s}`:a?{res:s,usedKey:s,exactUsedKey:s,usedLng:d,usedNS:u,usedParams:this.getUsedParamsDetails(i)}:s;let h=this.resolve(e,i),f=h?.res,g=h?.usedKey||s,m=h?.exactUsedKey||s,y=["[object Number]","[object Function]","[object RegExp]"],b=void 0!==i.joinArrays?i.joinArrays:this.options.joinArrays,v=!this.i18nFormat||this.i18nFormat.handleAsObject,x=void 0!==i.count&&!nv(i.count),w=nQ.hasDefaultValue(i),_=x?this.pluralResolver.getSuffix(d,i.count,i):"",S=i.ordinal&&x?this.pluralResolver.getSuffix(d,i.count,{ordinal:!1}):"",k=x&&!i.ordinal&&0===i.count,T=k&&i[`defaultValue${this.options.pluralSeparator}zero`]||i[`defaultValue${_}`]||i[`defaultValue${S}`]||i.defaultValue,C=f;v&&!f&&w&&(C=T);let E=nY(C),I=Object.prototype.toString.apply(C);if(v&&C&&E&&0>y.indexOf(I)&&!(nv(b)&&Array.isArray(C))){if(!i.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");let e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,C,{...i,ns:l}):`key '${s} (${this.language})' returned an object instead of string.`;return a?(h.res=e,h.usedParams=this.getUsedParamsDetails(i),h):e}if(o){let e=Array.isArray(C),t=e?[]:{},n=e?m:g;for(let e in C)if(Object.prototype.hasOwnProperty.call(C,e)){let a=`${n}${o}${e}`;w&&!f?t[e]=this.translate(a,{...i,defaultValue:nY(T)?T[e]:void 0,...{joinArrays:!1,ns:l}}):t[e]=this.translate(a,{...i,joinArrays:!1,ns:l}),t[e]===a&&(t[e]=C[e])}f=t}}else if(v&&nv(b)&&Array.isArray(f))(f=f.join(b))&&(f=this.extendTranslation(f,e,i,n));else{let t=!1,a=!1;!this.isValidLookup(f)&&w&&(t=!0,f=T),this.isValidLookup(f)||(a=!0,f=s);let l=(i.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&a?void 0:f,p=w&&T!==f&&this.options.updateMissing;if(a||t||p){if(this.logger.log(p?"updateKey":"missingKey",d,u,s,p?T:f),o){let e=this.resolve(s,{...i,keySeparator:!1});e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[],t=this.languageUtils.getFallbackCodes(this.options.fallbackLng,i.lng||this.language);if("fallback"===this.options.saveMissingTo&&t&&t[0])for(let n=0;n<t.length;n++)e.push(t[n]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(i.lng||this.language):e.push(i.lng||this.language);let n=(e,t,n)=>{let a=w&&n!==f?n:l;this.options.missingKeyHandler?this.options.missingKeyHandler(e,u,t,a,p,i):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(e,u,t,a,p,i),this.emit("missingKey",e,u,t,f)};this.options.saveMissing&&(this.options.saveMissingPlurals&&x?e.forEach(e=>{let t=this.pluralResolver.getSuffixes(e,i);k&&i[`defaultValue${this.options.pluralSeparator}zero`]&&0>t.indexOf(`${this.options.pluralSeparator}zero`)&&t.push(`${this.options.pluralSeparator}zero`),t.forEach(t=>{n([e],s+t,i[`defaultValue${t}`]||T)})}):n(e,s,T))}f=this.extendTranslation(f,e,i,h,n),a&&f===s&&this.options.appendNamespaceToMissingKey&&(f=`${u}${c}${s}`),(a||t)&&this.options.parseMissingKeyHandler&&(f=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${u}${c}${s}`:s,t?f:void 0,i))}return a?(h.res=f,h.usedParams=this.getUsedParamsDetails(i),h):f}extendTranslation(e,t,n,i,a){if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){let o;n.interpolation&&this.interpolator.init({...n,...{interpolation:{...this.options.interpolation,...n.interpolation}}});let s=nv(e)&&(n?.interpolation?.skipOnVariables!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);if(s){let t=e.match(this.interpolator.nestingRegexp);o=t&&t.length}let l=n.replace&&!nv(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(l={...this.options.interpolation.defaultVariables,...l}),e=this.interpolator.interpolate(e,l,n.lng||this.language||i.usedLng,n),s){let t=e.match(this.interpolator.nestingRegexp);o<(t&&t.length)&&(n.nest=!1)}!n.lng&&i&&i.res&&(n.lng=this.language||i.usedLng),!1!==n.nest&&(e=this.interpolator.nest(e,(...e)=>a?.[0]!==e[0]||n.context?this.translate(...e,t):(this.logger.warn(`It seems you are nesting recursively key: ${e[0]} in key: ${t[0]}`),null),n)),n.interpolation&&this.interpolator.reset()}let o=n.postProcess||this.options.postProcess,s=nv(o)?[o]:o;return null!=e&&s?.length&&!1!==n.applyPostProcessor&&(e=nW.handle(s,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),e}resolve(e,t={}){let n,i,a,o,s;return nv(e)&&(e=[e]),e.forEach(e=>{if(this.isValidLookup(n))return;let l=this.extractFromKey(e,t),u=l.key;i=u;let c=l.namespaces;this.options.fallbackNS&&(c=c.concat(this.options.fallbackNS));let d=void 0!==t.count&&!nv(t.count),p=d&&!t.ordinal&&0===t.count,h=void 0!==t.context&&(nv(t.context)||"number"==typeof t.context)&&""!==t.context,f=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);c.forEach(e=>{this.isValidLookup(n)||(s=e,!nZ[`${f[0]}-${e}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(s)&&(nZ[`${f[0]}-${e}`]=!0,this.logger.warn(`key "${i}" for languages "${f.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),f.forEach(i=>{let s;if(this.isValidLookup(n))return;o=i;let l=[u];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(l,u,i,e,t);else{let e;d&&(e=this.pluralResolver.getSuffix(i,t.count,t));let n=`${this.options.pluralSeparator}zero`,a=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(d&&(t.ordinal&&0===e.indexOf(a)&&l.push(u+e.replace(a,this.options.pluralSeparator)),l.push(u+e),p&&l.push(u+n)),h){let i=`${u}${this.options.contextSeparator||"_"}${t.context}`;l.push(i),d&&(t.ordinal&&0===e.indexOf(a)&&l.push(i+e.replace(a,this.options.pluralSeparator)),l.push(i+e),p&&l.push(i+n))}}for(;s=l.pop();)this.isValidLookup(n)||(a=s,n=this.getResource(i,e,s,t))}))})}),{res:n,usedKey:i,exactUsedKey:a,usedLng:o,usedNS:s}}isValidLookup(e){return void 0!==e&&!(!this.options.returnNull&&null===e)&&!(!this.options.returnEmptyString&&""===e)}getResource(e,t,n,i={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,t,n,i):this.resourceStore.getResource(e,t,n,i)}getUsedParamsDetails(e={}){let t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=e.replace&&!nv(e.replace),i=n?e.replace:e;if(n&&void 0!==e.count&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!n)for(let e of(i={...i},t))delete i[e];return i}static hasDefaultValue(e){let t="defaultValue";for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t===n.substring(0,t.length)&&void 0!==e[n])return!0;return!1}}class nJ{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=nV.create("languageUtils")}getScriptPartFromCode(e){if(!(e=nF(e))||0>e.indexOf("-"))return null;let t=e.split("-");return 2===t.length||(t.pop(),"x"===t[t.length-1].toLowerCase())?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(!(e=nF(e))||0>e.indexOf("-"))return e;let t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(nv(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch(e){}return(t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t)?t:this.options.lowerCaseLng?e.toLowerCase():e}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){let t;return e?(e.forEach(e=>{if(t)return;let n=this.formatLanguageCode(e);(!this.options.supportedLngs||this.isSupportedCode(n))&&(t=n)}),!t&&this.options.supportedLngs&&e.forEach(e=>{if(t)return;let n=this.getScriptPartFromCode(e);if(this.isSupportedCode(n))return t=n;let i=this.getLanguagePartFromCode(e);if(this.isSupportedCode(i))return t=i;t=this.options.supportedLngs.find(e=>{if(e===i||!(0>e.indexOf("-")&&0>i.indexOf("-"))&&(e.indexOf("-")>0&&0>i.indexOf("-")&&e.substring(0,e.indexOf("-"))===i||0===e.indexOf(i)&&i.length>1))return e})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t):null}getFallbackCodes(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),nv(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}toResolveHierarchy(e,t){let n=this.getFallbackCodes((!1===t?[]:t)||this.options.fallbackLng||[],e),i=[],a=e=>{e&&(this.isSupportedCode(e)?i.push(e):this.logger.warn(`rejecting language code not found in supportedLngs: ${e}`))};return nv(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&a(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&a(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&a(this.getLanguagePartFromCode(e))):nv(e)&&a(this.formatLanguageCode(e)),n.forEach(e=>{0>i.indexOf(e)&&a(this.formatLanguageCode(e))}),i}}let n0={zero:0,one:1,two:2,few:3,many:4,other:5},n1={select:e=>1===e?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class n2{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=nV.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){let n,i=nF("dev"===e?"en":e),a=t.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:i,type:a});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];try{n=new Intl.PluralRules(i,{type:a})}catch(a){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),n1;if(!e.match(/-|_/))return n1;let i=this.languageUtils.getLanguagePartFromCode(e);n=this.getRule(i,t)}return this.pluralRulesCache[o]=n,n}needsPlural(e,t={}){let n=this.getRule(e,t);return n||(n=this.getRule("dev",t)),n?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,t,n={}){return this.getSuffixes(e,n).map(e=>`${t}${e}`)}getSuffixes(e,t={}){let n=this.getRule(e,t);return(n||(n=this.getRule("dev",t)),n)?n.resolvedOptions().pluralCategories.sort((e,t)=>n0[e]-n0[t]).map(e=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${e}`):[]}getSuffix(e,t,n={}){let i=this.getRule(e,n);return i?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${i.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,n))}}let n3=(e,t,n,i=".",a=!0)=>{let o=nO(e,t,n);return!o&&a&&nv(n)&&void 0===(o=nL(e,n,i))&&(o=nL(t,n,i)),o},n4=e=>e.replace(/\$/g,"$$$$");class n6{constructor(e={}){this.logger=nV.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(e=>e),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});let{escape:t,escapeValue:n,useRawValueToEscape:i,prefix:a,prefixEscaped:o,suffix:s,suffixEscaped:l,formatSeparator:u,unescapeSuffix:c,unescapePrefix:d,nestingPrefix:p,nestingPrefixEscaped:h,nestingSuffix:f,nestingSuffixEscaped:g,nestingOptionsSeparator:m,maxReplaces:y,alwaysFormat:b}=e.interpolation;this.escape=void 0!==t?t:nD,this.escapeValue=void 0===n||n,this.useRawValueToEscape=void 0!==i&&i,this.prefix=a?nN(a):o||"{{",this.suffix=s?nN(s):l||"}}",this.formatSeparator=u||",",this.unescapePrefix=c?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":c||"",this.nestingPrefix=p?nN(p):h||nN("$t("),this.nestingSuffix=f?nN(f):g||nN(")"),this.nestingOptionsSeparator=m||",",this.maxReplaces=y||1e3,this.alwaysFormat=void 0!==b&&b,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){let e=(e,t)=>e?.source===t?(e.lastIndex=0,e):RegExp(t,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,t,n,i){let a,o,s,l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=e=>{if(0>e.indexOf(this.formatSeparator)){let a=n3(t,l,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(a,void 0,n,{...i,...t,interpolationkey:e}):a}let a=e.split(this.formatSeparator),o=a.shift().trim(),s=a.join(this.formatSeparator).trim();return this.format(n3(t,l,o,this.options.keySeparator,this.options.ignoreJSONStructure),s,n,{...i,...t,interpolationkey:o})};this.resetRegExp();let c=i?.missingInterpolationHandler||this.options.missingInterpolationHandler,d=i?.interpolation?.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>n4(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?n4(this.escape(e)):n4(e)}].forEach(t=>{for(s=0;a=t.regex.exec(e);){let n=a[1].trim();if(void 0===(o=u(n)))if("function"==typeof c){let t=c(e,a,i);o=nv(t)?t:""}else if(i&&Object.prototype.hasOwnProperty.call(i,n))o="";else if(d){o=a[0];continue}else this.logger.warn(`missed to pass in variable ${n} for interpolating ${e}`),o="";else nv(o)||this.useRawValueToEscape||(o=nw(o));let l=t.safeValue(o);if(e=e.replace(a[0],l),d?(t.regex.lastIndex+=o.length,t.regex.lastIndex-=a[0].length):t.regex.lastIndex=0,++s>=this.maxReplaces)break}}),e}nest(e,t,n={}){let i,a,o,s=(e,t)=>{let n=this.nestingOptionsSeparator;if(0>e.indexOf(n))return e;let i=e.split(RegExp(`${n}[ ]*{`)),a=`{${i[1]}`;e=i[0];let s=(a=this.interpolate(a,o)).match(/'/g),l=a.match(/"/g);((s?.length??0)%2!=0||l)&&l.length%2==0||(a=a.replace(/'/g,'"'));try{o=JSON.parse(a),t&&(o={...t,...o})}catch(t){return this.logger.warn(`failed parsing options string in nesting for key ${e}`,t),`${e}${n}${a}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,e};for(;i=this.nestingRegexp.exec(e);){let l=[];(o=(o={...n}).replace&&!nv(o.replace)?o.replace:o).applyPostProcessor=!1,delete o.defaultValue;let u=/{.*}/.test(i[1])?i[1].lastIndexOf("}")+1:i[1].indexOf(this.formatSeparator);if(-1!==u&&(l=i[1].slice(u).split(this.formatSeparator).map(e=>e.trim()).filter(Boolean),i[1]=i[1].slice(0,u)),(a=t(s.call(this,i[1].trim(),o),o))&&i[0]===e&&!nv(a))return a;nv(a)||(a=nw(a)),a||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${e}`),a=""),l.length&&(a=l.reduce((e,t)=>this.format(e,t,n.lng,{...n,interpolationkey:i[1].trim()}),a.trim())),e=e.replace(i[0],a),this.regexp.lastIndex=0}return e}}let n5=e=>{let t=e.toLowerCase().trim(),n={};if(e.indexOf("(")>-1){let i=e.split("(");t=i[0].toLowerCase().trim();let a=i[1].substring(0,i[1].length-1);"currency"===t&&0>a.indexOf(":")?n.currency||(n.currency=a.trim()):"relativetime"===t&&0>a.indexOf(":")?n.range||(n.range=a.trim()):a.split(";").forEach(e=>{if(e){let[t,...i]=e.split(":"),a=i.join(":").trim().replace(/^'+|'+$/g,""),o=t.trim();n[o]||(n[o]=a),"false"===a&&(n[o]=!1),"true"===a&&(n[o]=!0),isNaN(a)||(n[o]=parseInt(a,10))}})}return{formatName:t,formatOptions:n}},n8=e=>{let t={};return(n,i,a)=>{let o=a;a&&a.interpolationkey&&a.formatParams&&a.formatParams[a.interpolationkey]&&a[a.interpolationkey]&&(o={...o,[a.interpolationkey]:void 0});let s=i+JSON.stringify(o),l=t[s];return l||(l=e(nF(i),a),t[s]=l),l(n)}},n7=e=>(t,n,i)=>e(nF(n),i)(t);class n9{constructor(e={}){this.logger=nV.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";let n=t.cacheInBuiltFormats?n8:n7;this.formats={number:n((e,t)=>{let n=new Intl.NumberFormat(e,{...t});return e=>n.format(e)}),currency:n((e,t)=>{let n=new Intl.NumberFormat(e,{...t,style:"currency"});return e=>n.format(e)}),datetime:n((e,t)=>{let n=new Intl.DateTimeFormat(e,{...t});return e=>n.format(e)}),relativetime:n((e,t)=>{let n=new Intl.RelativeTimeFormat(e,{...t});return e=>n.format(e,t.range||"day")}),list:n((e,t)=>{let n=new Intl.ListFormat(e,{...t});return e=>n.format(e)})}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=n8(t)}format(e,t,n,i={}){let a=t.split(this.formatSeparator);if(a.length>1&&a[0].indexOf("(")>1&&0>a[0].indexOf(")")&&a.find(e=>e.indexOf(")")>-1)){let e=a.findIndex(e=>e.indexOf(")")>-1);a[0]=[a[0],...a.splice(1,e)].join(this.formatSeparator)}return a.reduce((e,t)=>{let{formatName:a,formatOptions:o}=n5(t);if(this.formats[a]){let t=e;try{let s=i?.formatParams?.[i.interpolationkey]||{},l=s.locale||s.lng||i.locale||i.lng||n;t=this.formats[a](e,l,{...o,...i,...s})}catch(e){this.logger.warn(e)}return t}return this.logger.warn(`there was no format function for ${a}`),e},e)}}let re=(e,t)=>{void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)};class rt extends nG{constructor(e,t,n,i={}){super(),this.backend=e,this.store=t,this.services=n,this.languageUtils=n.languageUtils,this.options=i,this.logger=nV.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(n,i.backend,i)}queueLoad(e,t,n,i){let a={},o={},s={},l={};return e.forEach(e=>{let i=!0;t.forEach(t=>{let s=`${e}|${t}`;!n.reload&&this.store.hasResourceBundle(e,t)?this.state[s]=2:this.state[s]<0||(1===this.state[s]?void 0===o[s]&&(o[s]=!0):(this.state[s]=1,i=!1,void 0===o[s]&&(o[s]=!0),void 0===a[s]&&(a[s]=!0),void 0===l[t]&&(l[t]=!0)))}),i||(s[e]=!0)}),(Object.keys(a).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(a),pending:Object.keys(o),toLoadLanguages:Object.keys(s),toLoadNamespaces:Object.keys(l)}}loaded(e,t,n){let i=e.split("|"),a=i[0],o=i[1];t&&this.emit("failedLoading",a,o,t),!t&&n&&this.store.addResourceBundle(a,o,n,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&n&&(this.state[e]=0);let s={};this.queue.forEach(n=>{nI(n.loaded,[a],o),re(n,e),t&&n.errors.push(t),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach(e=>{s[e]||(s[e]={});let t=n.loaded[e];t.length&&t.forEach(t=>{void 0===s[e][t]&&(s[e][t]=!0)})}),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())}),this.emit("loaded",s),this.queue=this.queue.filter(e=>!e.done)}read(e,t,n,i=0,a=this.retryTimeout,o){if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:e,ns:t,fcName:n,tried:i,wait:a,callback:o});this.readingCalls++;let s=(s,l)=>{if(this.readingCalls--,this.waitingReads.length>0){let e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}s&&l&&i<this.maxRetries?setTimeout(()=>{this.read.call(this,e,t,n,i+1,2*a,o)},a):o(s,l)},l=this.backend[n].bind(this.backend);if(2===l.length){try{let n=l(e,t);n&&"function"==typeof n.then?n.then(e=>s(null,e)).catch(s):s(null,n)}catch(e){s(e)}return}return l(e,t,s)}prepareLoading(e,t,n={},i){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();nv(e)&&(e=this.languageUtils.toResolveHierarchy(e)),nv(t)&&(t=[t]);let a=this.queueLoad(e,t,n,i);if(!a.toLoad.length)return a.pending.length||i(),null;a.toLoad.forEach(e=>{this.loadOne(e)})}load(e,t,n){this.prepareLoading(e,t,{},n)}reload(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}loadOne(e,t=""){let n=e.split("|"),i=n[0],a=n[1];this.read(i,a,"read",void 0,void 0,(n,o)=>{n&&this.logger.warn(`${t}loading namespace ${a} for language ${i} failed`,n),!n&&o&&this.logger.log(`${t}loaded namespace ${a} for language ${i}`,o),this.loaded(e,n,o)})}saveMissing(e,t,n,i,a,o={},s=()=>{}){if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(t))return void this.logger.warn(`did not save key "${n}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");if(null!=n&&""!==n){if(this.backend?.create){let l={...o,isUpdate:a},u=this.backend.create.bind(this.backend);if(u.length<6)try{let a;(a=5===u.length?u(e,t,n,i,l):u(e,t,n,i))&&"function"==typeof a.then?a.then(e=>s(null,e)).catch(s):s(null,a)}catch(e){s(e)}else u(e,t,n,i,s,l)}e&&e[0]&&this.store.addResource(e[0],t,n,i)}}}let rn=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if("object"==typeof e[1]&&(t=e[1]),nv(e[1])&&(t.defaultValue=e[1]),nv(e[2])&&(t.tDescription=e[2]),"object"==typeof e[2]||"object"==typeof e[3]){let n=e[3]||e[2];Object.keys(n).forEach(e=>{t[e]=n[e]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),rr=e=>(nv(e.ns)&&(e.ns=[e.ns]),nv(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),nv(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs?.indexOf?.("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),"boolean"==typeof e.initImmediate&&(e.initAsync=e.initImmediate),e),ri=()=>{},ra=e=>{Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(t=>{"function"==typeof e[t]&&(e[t]=e[t].bind(e))})};class ro extends nG{constructor(e={},t){if(super(),this.options=rr(e),this.services={},this.logger=nV,this.modules={external:[]},ra(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(e={},t){this.isInitializing=!0,"function"==typeof e&&(t=e,e={}),null==e.defaultNS&&e.ns&&(nv(e.ns)?e.defaultNS=e.ns:0>e.ns.indexOf("translation")&&(e.defaultNS=e.ns[0]));let n=rn();this.options={...n,...this.options,...rr(e)},this.options.interpolation={...n.interpolation,...this.options.interpolation},void 0!==e.keySeparator&&(this.options.userDefinedKeySeparator=e.keySeparator),void 0!==e.nsSeparator&&(this.options.userDefinedNsSeparator=e.nsSeparator),"function"!=typeof this.options.overloadTranslationOptionHandler&&(this.options.overloadTranslationOptionHandler=n.overloadTranslationOptionHandler);let i=e=>e?"function"==typeof e?new e:e:null;if(!this.options.isClone){let e;this.modules.logger?nV.init(i(this.modules.logger),this.options):nV.init(null,this.options),e=this.modules.formatter?this.modules.formatter:n9;let t=new nJ(this.options);this.store=new nH(this.options.resources,this.options);let a=this.services;a.logger=nV,a.resourceStore=this.store,a.languageUtils=t,a.pluralResolver=new n2(t,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==n.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),e&&(!this.options.interpolation.format||this.options.interpolation.format===n.interpolation.format)&&(a.formatter=i(e),a.formatter.init&&a.formatter.init(a,this.options),this.options.interpolation.format=a.formatter.format.bind(a.formatter)),a.interpolator=new n6(this.options),a.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},a.backendConnector=new rt(i(this.modules.backend),a.resourceStore,a,this.options),a.backendConnector.on("*",(e,...t)=>{this.emit(e,...t)}),this.modules.languageDetector&&(a.languageDetector=i(this.modules.languageDetector),a.languageDetector.init&&a.languageDetector.init(a,this.options.detection,this.options)),this.modules.i18nFormat&&(a.i18nFormat=i(this.modules.i18nFormat),a.i18nFormat.init&&a.i18nFormat.init(this)),this.translator=new nQ(this.services,this.options),this.translator.on("*",(e,...t)=>{this.emit(e,...t)}),this.modules.external.forEach(e=>{e.init&&e.init(this)})}if(this.format=this.options.interpolation.format,t||(t=ri),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){let e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(e=>{this[e]=(...t)=>this.store[e](...t)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(e=>{this[e]=(...t)=>(this.store[e](...t),this)});let a=nx(),o=()=>{let e=(e,n)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),a.resolve(n),t(e,n)};if(this.languages&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initAsync?o():setTimeout(o,0),a}loadResources(e,t=ri){let n=t,i=nv(e)?e:this.language;if("function"==typeof e&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(i?.toLowerCase()==="cimode"&&(!this.options.preload||0===this.options.preload.length))return n();let e=[],t=t=>{t&&"cimode"!==t&&this.services.languageUtils.toResolveHierarchy(t).forEach(t=>{"cimode"!==t&&0>e.indexOf(t)&&e.push(t)})};i?t(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(e=>t(e)),this.options.preload?.forEach?.(e=>t(e)),this.services.backendConnector.load(e,this.options.ns,e=>{e||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),n(e)})}else n(null)}reloadResources(e,t,n){let i=nx();return"function"==typeof e&&(n=e,e=void 0),"function"==typeof t&&(n=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),n||(n=ri),this.services.backendConnector.reload(e,t,e=>{i.resolve(),n(e)}),i}use(e){if(!e)throw Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&nW.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1)){for(let e=0;e<this.languages.length;e++){let t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}!this.resolvedLanguage&&0>this.languages.indexOf(e)&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;let n=nx();this.emit("languageChanging",e);let i=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},a=(a,o)=>{o?this.isLanguageChangingTo===e&&(i(o),this.translator.changeLanguage(o),this.isLanguageChangingTo=void 0,this.emit("languageChanged",o),this.logger.log("languageChanged",o)):this.isLanguageChangingTo=void 0,n.resolve((...e)=>this.t(...e)),t&&t(a,(...e)=>this.t(...e))},o=t=>{e||t||!this.services.languageDetector||(t=[]);let n=nv(t)?t:t&&t[0],o=this.store.hasLanguageSomeTranslations(n)?n:this.services.languageUtils.getBestMatchFromCodes(nv(t)?[t]:t);o&&(this.language||i(o),this.translator.language||this.translator.changeLanguage(o),this.services.languageDetector?.cacheUserLanguage?.(o)),this.loadResources(o,e=>{a(e,o)})};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e):o(this.services.languageDetector.detect()),n}getFixedT(e,t,n){let i=(e,t,...a)=>{let o,s;(o="object"!=typeof t?this.options.overloadTranslationOptionHandler([e,t].concat(a)):{...t}).lng=o.lng||i.lng,o.lngs=o.lngs||i.lngs,o.ns=o.ns||i.ns,""!==o.keyPrefix&&(o.keyPrefix=o.keyPrefix||n||i.keyPrefix);let l=this.options.keySeparator||".";return o.keyPrefix&&Array.isArray(e)?s=e.map(e=>("function"==typeof e&&(e=nX(e,{...this.options,...t})),`${o.keyPrefix}${l}${e}`)):("function"==typeof e&&(e=nX(e,{...this.options,...t})),s=o.keyPrefix?`${o.keyPrefix}${l}${e}`:e),this.t(s,o)};return nv(e)?i.lng=e:i.lngs=e,i.ns=t,i.keyPrefix=n,i}t(...e){return this.translator?.translate(...e)}exists(...e){return this.translator?.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;let n=t.lng||this.resolvedLanguage||this.languages[0],i=!!this.options&&this.options.fallbackLng,a=this.languages[this.languages.length-1];if("cimode"===n.toLowerCase())return!0;let o=(e,t)=>{let n=this.services.backendConnector.state[`${e}|${t}`];return -1===n||0===n||2===n};if(t.precheck){let e=t.precheck(this,o);if(void 0!==e)return e}return!!(this.hasResourceBundle(n,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(n,e)&&(!i||o(a,e)))}loadNamespaces(e,t){let n=nx();return this.options.ns?(nv(e)&&(e=[e]),e.forEach(e=>{0>this.options.ns.indexOf(e)&&this.options.ns.push(e)}),this.loadResources(e=>{n.resolve(),t&&t(e)}),n):(t&&t(),Promise.resolve())}loadLanguages(e,t){let n=nx();nv(e)&&(e=[e]);let i=this.options.preload||[],a=e.filter(e=>0>i.indexOf(e)&&this.services.languageUtils.isSupportedCode(e));return a.length?(this.options.preload=i.concat(a),this.loadResources(e=>{n.resolve(),t&&t(e)}),n):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!e)return"rtl";try{let t=new Intl.Locale(e);if(t&&t.getTextInfo){let e=t.getTextInfo();if(e&&e.direction)return e.direction}}catch(e){}let t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=this.services?.languageUtils||new nJ(rn());return e.toLowerCase().indexOf("-latn")>1?"ltr":t.indexOf(n.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){let n=new ro(e,t);return n.createInstance=ro.createInstance,n}cloneInstance(e={},t=ri){let n=e.forkResourceStore;n&&delete e.forkResourceStore;let i={...this.options,...e,isClone:!0},a=new ro(i);return(void 0!==e.debug||void 0!==e.prefix)&&(a.logger=a.logger.clone(e)),["store","services","language"].forEach(e=>{a[e]=this[e]}),a.services={...this.services},a.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},n&&(a.store=new nH(Object.keys(this.store.data).reduce((e,t)=>(e[t]={...this.store.data[t]},e[t]=Object.keys(e[t]).reduce((n,i)=>(n[i]={...e[t][i]},n),e[t]),e),{}),i),a.services.resourceStore=a.store),e.interpolation&&(a.services.interpolator=new n6(i)),a.translator=new nQ(a.services,i),a.translator.on("*",(e,...t)=>{a.emit(e,...t)}),a.init(i,t),a.translator.options=i,a.translator.backendConnector.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}let rs=ro.createInstance();rs.createInstance,rs.dir,rs.init,rs.loadResources,rs.reloadResources,rs.use,rs.changeLanguage,rs.getFixedT,rs.t,rs.exists,rs.setDefaultNamespace,rs.hasLoadedNamespace,rs.loadNamespaces,rs.loadLanguages,__webpack_require__(2);function rl(e,t){switch(t.type){case"text":return e+t.content;case"tag":return e+="<"+t.name+(t.attrs?function(e){var t=[];for(var n in e)t.push(n+'="'+e[n]+'"');return t.length?" "+t.join(" "):""}(t.attrs):"")+(t.voidElement?"/>":">"),t.voidElement?e:e+t.children.reduce(rl,"")+"</"+t.name+">";case"comment":return e+"\x3c!--"+t.comment+"--\x3e"}}Object.create(null);let ru=(e,t)=>{if(!e)return!1;let n=e.props?.children??e.children;return t?n.length>0:!!n},rc=e=>{if(!e)return[];let t=e.props?.children??e.children;return e.props?.i18nIsDynamicList?rp(t):t},rd=e=>Array.isArray(e)&&e.every(isValidElement),rp=e=>Array.isArray(e)?e:[e],rh=(e,t)=>{let n={...t};return n.props=Object.assign(e.props,t.props),n},rf=(e,t=[],n={})=>{if(!e)return e;let i=[...t,...Object.keys(n)],a="",o=0;for(;o<e.length;)if("<"===e[o]){let t=!1,n=e.slice(o).match(/^<\/(\d+|[a-zA-Z][a-zA-Z0-9-]*)>/);if(n){let e=n[1];(/^\d+$/.test(e)||i.includes(e))&&(t=!0,a+=n[0],o+=n[0].length)}if(!t){let n=e.slice(o).match(/^<(\d+|[a-zA-Z][a-zA-Z0-9-]*)(\s+[\w-]+(?:=(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s*(\/)?>/);if(n){let e=n[1];(/^\d+$/.test(e)||i.includes(e))&&(t=!0,a+=n[0],o+=n[0].length)}}t||(a+="&lt;",o+=1)}else a+=e[o],o+=1;return a},rg=(e,t,n)=>{let i=e.key||t,a=cloneElement(e,{key:i});if(!a.props||!a.props.children||0>n.indexOf(`${t}/>`)&&0>n.indexOf(`${t} />`))return a;function o(){return createElement(Fragment,null,a)}return createElement(o,{key:i})},rm=(e,t)=>e.map((e,n)=>rg(e,n,t)),ry=(e,t)=>{let n={};return Object.keys(e).forEach(i=>{Object.assign(n,{[i]:rg(e[i],i,t)})}),n},rb=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,rv={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"\xa9","&#169;":"\xa9","&reg;":"\xae","&#174;":"\xae","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},rx=e=>rv[e],rw={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:e=>e.replace(rb,rx),transDefaultProps:void 0},r_=(e={})=>{rw={...rw,...e}},rS=()=>rw,rk=t=>{e=t},rT=()=>e,rC=(0,x.createContext)();class rE{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(e=>{this.usedNamespaces[e]||(this.usedNamespaces[e]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}let rI=(e,t,n,i)=>{let a=[n,{code:t,...i||{}}];if(e?.services?.logger?.forward)return e.services.logger.forward(a,"warn","react-i18next::",!0);rM(a[0])&&(a[0]=`react-i18next:: ${a[0]}`),e?.services?.logger?.warn?e.services.logger.warn(...a):console?.warn&&console.warn(...a)},r$={},rO=(e,t,n,i)=>{rM(n)&&r$[n]||(rM(n)&&(r$[n]=new Date),rI(e,t,n,i))},rA=(e,t)=>()=>{if(e.isInitialized)t();else{let n=()=>{setTimeout(()=>{e.off("initialized",n)},0),t()};e.on("initialized",n)}},rN=(e,t,n)=>{e.loadNamespaces(t,rA(e,n))},rP=(e,t,n,i)=>{if(rM(n)&&(n=[n]),e.options.preload&&e.options.preload.indexOf(t)>-1)return rN(e,n,i);n.forEach(t=>{0>e.options.ns.indexOf(t)&&e.options.ns.push(t)}),e.loadLanguages(t,rA(e,i))},rD=(e,t,n={})=>t.languages&&t.languages.length?t.hasLoadedNamespace(e,{lng:n.lng,precheck:(t,i)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!i(t.isLanguageChangingTo,e))return!1}}):(rO(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0),rM=e=>"string"==typeof e,rz=e=>"object"==typeof e&&null!==e;class rj extends Error{constructor(e,t,n){super(e),this.name="TranslationParserError",this.position=t,this.translationString=n,Error.captureStackTrace&&Error.captureStackTrace(this,rj)}}let rR={"&nbsp;":"\xa0","&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&copy;":"\xa9","&reg;":"\xae","&trade;":"","&hellip;":"","&ndash;":"","&mdash;":"","&lsquo;":"","&rsquo;":"","&sbquo;":"","&ldquo;":"","&rdquo;":"","&bdquo;":"","&dagger;":"","&Dagger;":"","&bull;":"","&prime;":"","&Prime;":"","&lsaquo;":"","&rsaquo;":"","&sect;":"\xa7","&para;":"\xb6","&middot;":"\xb7","&ensp;":"","&emsp;":"","&thinsp;":"","&euro;":"","&pound;":"\xa3","&yen;":"\xa5","&cent;":"\xa2","&curren;":"\xa4","&times;":"\xd7","&divide;":"\xf7","&minus;":"","&plusmn;":"\xb1","&ne;":"","&le;":"","&ge;":"","&asymp;":"","&equiv;":"","&infin;":"","&int;":"","&sum;":"","&prod;":"","&radic;":"","&part;":"","&permil;":"","&deg;":"\xb0","&micro;":"\xb5","&larr;":"","&uarr;":"","&rarr;":"","&darr;":"","&harr;":"","&crarr;":"","&lArr;":"","&uArr;":"","&rArr;":"","&dArr;":"","&hArr;":"","&alpha;":"","&beta;":"","&gamma;":"","&delta;":"","&epsilon;":"","&zeta;":"","&eta;":"","&theta;":"","&iota;":"","&kappa;":"","&lambda;":"","&mu;":"","&nu;":"","&xi;":"","&omicron;":"","&pi;":"","&rho;":"","&sigma;":"","&tau;":"","&upsilon;":"","&phi;":"","&chi;":"","&psi;":"","&omega;":"","&Alpha;":"","&Beta;":"","&Gamma;":"","&Delta;":"","&Epsilon;":"","&Zeta;":"","&Eta;":"","&Theta;":"","&Iota;":"","&Kappa;":"","&Lambda;":"","&Mu;":"","&Nu;":"","&Xi;":"","&Omicron;":"","&Pi;":"","&Rho;":"","&Sigma;":"","&Tau;":"","&Upsilon;":"","&Phi;":"","&Chi;":"","&Psi;":"","&Omega;":"","&Agrave;":"\xc0","&Aacute;":"\xc1","&Acirc;":"\xc2","&Atilde;":"\xc3","&Auml;":"\xc4","&Aring;":"\xc5","&AElig;":"\xc6","&Ccedil;":"\xc7","&Egrave;":"\xc8","&Eacute;":"\xc9","&Ecirc;":"\xca","&Euml;":"\xcb","&Igrave;":"\xcc","&Iacute;":"\xcd","&Icirc;":"\xce","&Iuml;":"\xcf","&ETH;":"\xd0","&Ntilde;":"\xd1","&Ograve;":"\xd2","&Oacute;":"\xd3","&Ocirc;":"\xd4","&Otilde;":"\xd5","&Ouml;":"\xd6","&Oslash;":"\xd8","&Ugrave;":"\xd9","&Uacute;":"\xda","&Ucirc;":"\xdb","&Uuml;":"\xdc","&Yacute;":"\xdd","&THORN;":"\xde","&szlig;":"\xdf","&agrave;":"\xe0","&aacute;":"\xe1","&acirc;":"\xe2","&atilde;":"\xe3","&auml;":"\xe4","&aring;":"\xe5","&aelig;":"\xe6","&ccedil;":"\xe7","&egrave;":"\xe8","&eacute;":"\xe9","&ecirc;":"\xea","&euml;":"\xeb","&igrave;":"\xec","&iacute;":"\xed","&icirc;":"\xee","&iuml;":"\xef","&eth;":"\xf0","&ntilde;":"\xf1","&ograve;":"\xf2","&oacute;":"\xf3","&ocirc;":"\xf4","&otilde;":"\xf5","&ouml;":"\xf6","&oslash;":"\xf8","&ugrave;":"\xf9","&uacute;":"\xfa","&ucirc;":"\xfb","&uuml;":"\xfc","&yacute;":"\xfd","&thorn;":"\xfe","&yuml;":"\xff","&iexcl;":"\xa1","&iquest;":"\xbf","&fnof;":"","&circ;":"","&tilde;":"","&OElig;":"","&oelig;":"","&Scaron;":"","&scaron;":"","&Yuml;":"","&ordf;":"\xaa","&ordm;":"\xba","&macr;":"\xaf","&acute;":"\xb4","&cedil;":"\xb8","&sup1;":"\xb9","&sup2;":"\xb2","&sup3;":"\xb3","&frac14;":"\xbc","&frac12;":"\xbd","&frac34;":"\xbe","&spades;":"","&clubs;":"","&hearts;":"","&diams;":"","&loz;":"","&oline;":"","&frasl;":"","&weierp;":"","&image;":"","&real;":"","&alefsym;":""},rL=RegExp(Object.keys(rR).map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|"),"g"),rF=e=>e.replace(rL,e=>rR[e]).replace(/&#(\d+);/g,(e,t)=>String.fromCharCode(parseInt(t,10))).replace(/&#x([0-9a-fA-F]+);/g,(e,t)=>String.fromCharCode(parseInt(t,16))),rB=e=>{let t=[],n=0,i="",a=()=>{i&&(t.push({type:"Text",value:i,position:n-i.length}),i="")};for(;n<e.length;){let o=e[n];if("<"===o){let s=e.slice(n).match(/^<(\d+)>/);if(s)a(),t.push({type:"TagOpen",value:s[0],position:n,tagNumber:parseInt(s[1],10)}),n+=s[0].length;else{let s=e.slice(n).match(/^<\/(\d+)>/);s?(a(),t.push({type:"TagClose",value:s[0],position:n,tagNumber:parseInt(s[1],10)}),n+=s[0].length):(i+=o,n+=1)}}else i+=o,n+=1}return a(),t},rU=(e,t,n)=>{let{type:i,props:a={}}=e;if(a.children&&Array.isArray(a.children)&&n){let{children:e,...n}=a;return x.createElement(i,n,...t)}return 0===t.length?x.createElement(i,a):1===t.length?x.createElement(i,a,t[0]):x.createElement(i,a,...t)},rV=(e,t=[])=>{if(!e)return[];let n=rB(e),i=[],a=[],o=new Set,s=()=>{if(0===a.length)return t;let e=a[a.length-1];return e.declaration.props?.children&&Array.isArray(e.declaration.props.children)?e.declaration.props.children:e.declarations};if(n.forEach(t=>{switch(t.type){case"Text":{let e=rF(t.value);(a.length>0?a[a.length-1].children:i).push(e)}break;case"TagOpen":{let{tagNumber:e}=t,n=s(),l=n[e];if(!l){o.add(e);let t=`<${e}>`;(a.length>0?a[a.length-1].children:i).push(t);break}a.push({tagNumber:e,children:[],position:t.position,declaration:l,declarations:n})}break;case"TagClose":{let{tagNumber:n}=t;if(o.has(n)){let e=`</${n}>`;(a.length>0?a[a.length-1].children:i).push(e),o.delete(n);break}if(0===a.length)throw new rj(`Unexpected closing tag </${n}> at position ${t.position}`,t.position,e);let s=a.pop();if(s.tagNumber!==n)throw new rj(`Mismatched tags: expected </${s.tagNumber}> but got </${n}> at position ${t.position}`,t.position,e);let l=rU(s.declaration,s.children,s.declarations);(a.length>0?a[a.length-1].children:i).push(l)}}}),a.length>0){let t=a[a.length-1];throw new rj(`Unclosed tag <${t.tagNumber}> at position ${t.position}`,t.position,e)}return i};function rG({i18nKey:e,defaultTranslation:t,content:n,ns:i,values:a={},i18n:o,t:s}){let l=o||rT();if(!l)return rO(l,"NO_I18NEXT_INSTANCE","IcuTrans: You need to pass in an i18next instance using i18nextReactModule",{i18nKey:e}),x.createElement(x.Fragment,{},t);let u=s||l.t?.bind(l)||(e=>e),c=i||u.ns||l.options?.defaultNS;c=rM(c)?[c]:c||["translation"];let d=a;l.options?.interpolation?.defaultVariables&&(d=a&&Object.keys(a).length>0?{...a,...l.options.interpolation.defaultVariables}:{...l.options.interpolation.defaultVariables});let p=u(e,{defaultValue:t,...d,ns:c});try{let e=rV(p,n);return x.createElement(x.Fragment,{},...e)}catch(t){return rI(l,"ICU_TRANS_RENDER_ERROR",`IcuTrans component error for key "${e}": ${t.message}`,{i18nKey:e,error:t}),x.createElement(x.Fragment,{},p)}}rG.displayName="IcuTransWithoutContext";var rH=__webpack_require__(139);let rW={t:(e,t)=>rM(t)?t:rz(t)&&rM(t.defaultValue)?t.defaultValue:Array.isArray(e)?e[e.length-1]:e,ready:!1},rq=()=>()=>{},rK=(e,t={})=>{let{i18n:n}=t,{i18n:i,defaultNS:a}=(0,x.useContext)(rC)||{},o=n||i||rT();o&&!o.reportNamespaces&&(o.reportNamespaces=new rE),o||rO(o,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");let s=(0,x.useMemo)(()=>({...rS(),...o?.options?.react,...t}),[o,t]),{useSuspense:l,keyPrefix:u}=s,c=e||a||o?.options?.defaultNS,d=rM(c)?[c]:c||["translation"],p=(0,x.useMemo)(()=>d,d);o?.reportNamespaces?.addUsedNamespaces?.(p);let h=(0,x.useRef)(0),f=(0,x.useCallback)(e=>{if(!o)return rq;let{bindI18n:t,bindI18nStore:n}=s,i=()=>{h.current+=1,e()};return t&&o.on(t,i),n&&o.store.on(n,i),()=>{t&&t.split(" ").forEach(e=>o.off(e,i)),n&&n.split(" ").forEach(e=>o.store.off(e,i))}},[o,s]),g=(0,x.useRef)(),m=(0,x.useCallback)(()=>{if(!o)return rW;let e=!!(o.isInitialized||o.initializedStoreOnce)&&p.every(e=>rD(e,o,s)),n=t.lng||o.language,i=h.current,a=g.current;if(a&&a.ready===e&&a.lng===n&&a.keyPrefix===u&&a.revision===i)return a;let l={t:o.getFixedT(n,"fallback"===s.nsMode?p:p[0],u),ready:e,lng:n,keyPrefix:u,revision:i};return g.current=l,l},[o,p,u,s,t.lng]),[y,b]=(0,x.useState)(0),{t:v,ready:w}=(0,rH.useSyncExternalStore)(f,m,m);(0,x.useEffect)(()=>{if(o&&!w&&!l){let e=()=>b(e=>e+1);t.lng?rP(o,t.lng,p,e):rN(o,p,e)}},[o,t.lng,p,w,l,y]);let _=o||{},S=(0,x.useRef)(null),k=(0,x.useRef)(),T=e=>{let t=Object.getOwnPropertyDescriptors(e);t.__original&&delete t.__original;let n=Object.create(Object.getPrototypeOf(e),t);if(!Object.prototype.hasOwnProperty.call(n,"__original"))try{Object.defineProperty(n,"__original",{value:e,writable:!1,enumerable:!1,configurable:!1})}catch(e){}return n},C=(0,x.useMemo)(()=>{let e=_,t=e?.language,n=e;e&&(S.current&&S.current.__original===e?k.current!==t?(S.current=n=T(e),k.current=t):n=S.current:(S.current=n=T(e),k.current=t));let i=[v,n,w];return i.t=v,i.i18n=n,i.ready=w,i},[v,_,w,_.resolvedLanguage,_.language,_.languages]);if(o&&l&&!w)throw new Promise(e=>{let n=()=>e();t.lng?rP(o,t.lng,p,n):rN(o,p,n)});return C};function rX({i18n:e,defaultNS:t,children:n}){let i=(0,x.useMemo)(()=>({i18n:e,defaultNS:t}),[e,t]);return(0,x.createElement)(rC.Provider,{value:i},n)}let rZ={type:"3rdParty",init(e){r_(e.options.react),rk(e)}},rY=(0,x.createContext)(null);rY.displayName="PanelGroupContext";let rQ="data-panel-group",rJ="data-panel-group-direction",r0="data-panel-group-id",r1="data-panel",r2="data-panel-collapsible",r3="data-panel-id",r4="data-panel-size",r6="data-resize-handle",r5="data-resize-handle-active",r8="data-panel-resize-handle-enabled",r7="data-panel-resize-handle-id",r9="data-resize-handle-state",ie=10,it=x.useLayoutEffect,ir=w["useId".toString()],ii="function"==typeof ir?ir:()=>null,ia=0;function io(e=null){let t=ii(),n=(0,x.useRef)(e||t||null);return null===n.current&&(n.current=""+ia++),null!=e?e:n.current}function is({children:e,className:t="",collapsedSize:n,collapsible:i,defaultSize:a,forwardedRef:o,id:s,maxSize:l,minSize:u,onCollapse:c,onExpand:d,onResize:p,order:h,style:f,tagName:g="div",...m}){let y=(0,x.useContext)(rY);if(null===y)throw Error("Panel components must be rendered within a PanelGroup container");let{collapsePanel:b,expandPanel:v,getPanelSize:w,getPanelStyle:_,groupId:S,isPanelCollapsed:k,reevaluatePanelConstraints:T,registerPanel:C,resizePanel:E,unregisterPanel:I}=y,$=io(s),O=(0,x.useRef)({callbacks:{onCollapse:c,onExpand:d,onResize:p},constraints:{collapsedSize:n,collapsible:i,defaultSize:a,maxSize:l,minSize:u},id:$,idIsFromProps:void 0!==s,order:h});(0,x.useRef)({didLogMissingDefaultSizeWarning:!1}),it(()=>{let{callbacks:e,constraints:t}=O.current,o={...t};O.current.id=$,O.current.idIsFromProps=void 0!==s,O.current.order=h,e.onCollapse=c,e.onExpand=d,e.onResize=p,t.collapsedSize=n,t.collapsible=i,t.defaultSize=a,t.maxSize=l,t.minSize=u,(o.collapsedSize!==t.collapsedSize||o.collapsible!==t.collapsible||o.maxSize!==t.maxSize||o.minSize!==t.minSize)&&T(O.current,o)}),it(()=>{let e=O.current;return C(e),()=>{I(e)}},[h,$,C,I]),(0,x.useImperativeHandle)(o,()=>({collapse:()=>{b(O.current)},expand:e=>{v(O.current,e)},getId:()=>$,getSize:()=>w(O.current),isCollapsed:()=>k(O.current),isExpanded:()=>!k(O.current),resize:e=>{E(O.current,e)}}),[b,v,w,k,$,E]);let A=_(O.current,a);return(0,x.createElement)(g,{...m,children:e,className:t,id:$,style:{...A,...f},[r0]:S,[r1]:"",[r2]:i||void 0,[r3]:$,[r4]:parseFloat(""+A.flexGrow).toFixed(1)})}let il=(0,x.forwardRef)((e,t)=>(0,x.createElement)(is,{...e,forwardedRef:t}));function iu(){return t}is.displayName="Panel",il.displayName="forwardRef(Panel)";let ic=null,id=!0,ip=null,ih=-1,ig=null;function im(e,t,n){let i=(t&iN)!=0,a=(t&iP)!=0,o=(t&iD)!=0,s=(t&iM)!=0;if(ip)return ip({exceedsHorizontalMaximum:a,exceedsHorizontalMinimum:i,exceedsVerticalMaximum:s,exceedsVerticalMinimum:o,intersectsHorizontalDragHandle:"horizontal"===e||"intersection"===e,intersectsVerticalDragHandle:"vertical"===e||"intersection"===e,isPointerDown:n});if(t){if(i)if(o)return"se-resize";else if(s)return"ne-resize";else return"e-resize";else if(a)if(o)return"sw-resize";else if(s)return"nw-resize";else return"w-resize";else if(o)return"s-resize";else if(s)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function iy(){null!==ig&&(document.head.removeChild(ig),ic=null,ig=null,ih=-1)}function ib(e,t,n){var i,a,o;if(!id)return;let s=im(e,t,n);if(ic!==s){if(ic=s,null===ig){ig=document.createElement("style");let e=iu();e&&ig.setAttribute("nonce",e),document.head.appendChild(ig)}ih>=0&&(null==(o=ig.sheet)||o.removeRule(ih)),ih=null!=(i=null==(a=ig.sheet)?void 0:a.insertRule(`*{cursor: ${s} !important;}`))?i:-1}}function iv(e){return"keydown"===e.type}function ix(e){return e.type.startsWith("pointer")}function iw(e){return e.type.startsWith("mouse")}function i_(e){if(ix(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(iw(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}function iS(e,t,n){return n?e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y:e.x<=t.x+t.width&&e.x+e.width>=t.x&&e.y<=t.y+t.height&&e.y+e.height>=t.y}function ik(e,t){let n;if(e===t)throw Error("Cannot compare node with itself");let i={a:iO(e),b:iO(t)};for(;i.a.at(-1)===i.b.at(-1);)e=i.a.pop(),t=i.b.pop(),n=e;iJ(n,"Stacking order can only be calculated for elements with a common ancestor");let a={a:i$(iI(i.a)),b:i$(iI(i.b))};if(a.a===a.b){let e=n.childNodes,t={a:i.a.at(-1),b:i.b.at(-1)},a=e.length;for(;a--;){let n=e[a];if(n===t.a)return 1;if(n===t.b)return -1}}return Math.sign(a.a-a.b)}let iT=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function iC(e){var t;let n=getComputedStyle(null!=(t=iA(e))?t:e).display;return"flex"===n||"inline-flex"===n}function iE(e){let t=getComputedStyle(e);return!!("fixed"===t.position||"auto"!==t.zIndex&&("static"!==t.position||iC(e))||1>+t.opacity||"transform"in t&&"none"!==t.transform||"webkitTransform"in t&&"none"!==t.webkitTransform||"mixBlendMode"in t&&"normal"!==t.mixBlendMode||"filter"in t&&"none"!==t.filter||"webkitFilter"in t&&"none"!==t.webkitFilter||"isolation"in t&&"isolate"===t.isolation||iT.test(t.willChange))||"touch"===t.webkitOverflowScrolling}function iI(e){let t=e.length;for(;t--;){let n=e[t];if(iJ(n,"Missing node"),iE(n))return n}return null}function i$(e){return e&&Number(getComputedStyle(e).zIndex)||0}function iO(e){let t=[];for(;e;)t.push(e),e=iA(e);return t}function iA(e){let{parentNode:t}=e;return t&&t instanceof ShadowRoot?t.host:t}let iN=1,iP=2,iD=4,iM=8,iz="coarse"===function(){if("function"==typeof matchMedia)return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}(),ij=[],iR=!1,iL=new Map,iF=new Map,iB=new Set;function iU(e,t,n,i,a){var o;let{ownerDocument:s}=t,l={direction:n,element:t,hitAreaMargins:i,setResizeHandlerState:a},u=null!=(o=iL.get(s))?o:0;return iL.set(s,u+1),iB.add(l),iZ(),function(){var t;iF.delete(e),iB.delete(l);let n=null!=(t=iL.get(s))?t:1;if(iL.set(s,n-1),iZ(),1===n&&iL.delete(s),ij.includes(l)){let e=ij.indexOf(l);e>=0&&ij.splice(e,1),iX(),a("up",!0,null)}}}function iV(e){let{target:t}=e,{x:n,y:i}=i_(e);iR=!0,iq({target:t,x:n,y:i}),iZ(),ij.length>0&&(iY("down",e),iX(),e.preventDefault(),iW(t)||e.stopImmediatePropagation())}function iG(e){let{x:t,y:n}=i_(e);if(iR&&"pointerleave"!==e.type&&0===e.buttons&&(iR=!1,iY("up",e)),!iR){let{target:i}=e;iq({target:i,x:t,y:n})}iY("move",e),iX(),ij.length>0&&e.preventDefault()}function iH(e){let{target:t}=e,{x:n,y:i}=i_(e);iF.clear(),iR=!1,ij.length>0&&(e.preventDefault(),iW(t)||e.stopImmediatePropagation()),iY("up",e),iq({target:t,x:n,y:i}),iX(),iZ()}function iW(e){let t=e;for(;t;){if(t.hasAttribute(r6))return!0;t=t.parentElement}return!1}function iq({target:e,x:t,y:n}){ij.splice(0);let i=null;(e instanceof HTMLElement||e instanceof SVGElement)&&(i=e),iB.forEach(e=>{let{element:a,hitAreaMargins:o}=e,s=a.getBoundingClientRect(),{bottom:l,left:u,right:c,top:d}=s,p=iz?o.coarse:o.fine;if(t>=u-p&&t<=c+p&&n>=d-p&&n<=l+p){if(null!==i&&document.contains(i)&&a!==i&&!a.contains(i)&&!i.contains(a)&&ik(i,a)>0){let e=i,t=!1;for(;e&&!e.contains(a);){if(iS(e.getBoundingClientRect(),s,!0)){t=!0;break}e=e.parentElement}if(t)return}ij.push(e)}})}function iK(e,t){iF.set(e,t)}function iX(){let e=!1,t=!1;ij.forEach(n=>{let{direction:i}=n;"horizontal"===i?e=!0:t=!0});let n=0;iF.forEach(e=>{n|=e}),e&&t?ib("intersection",n,iR):e?ib("horizontal",n,iR):t?ib("vertical",n,iR):iy()}function iZ(){var e;null==(e=n)||e.abort();let t={capture:!0,signal:(n=new AbortController).signal};iB.size&&(iR?(ij.length>0&&iL.forEach((e,n)=>{let{body:i}=n;e>0&&(i.addEventListener("contextmenu",iH,t),i.addEventListener("pointerleave",iG,t),i.addEventListener("pointermove",iG,t))}),iL.forEach((e,n)=>{let{body:i}=n;i.addEventListener("pointerup",iH,t),i.addEventListener("pointercancel",iH,t)})):iL.forEach((e,n)=>{let{body:i}=n;e>0&&(i.addEventListener("pointerdown",iV,t),i.addEventListener("pointermove",iG,t))}))}function iY(e,t){iB.forEach(n=>{let{setResizeHandlerState:i}=n;i(e,ij.includes(n),t)})}function iQ(){let[e,t]=(0,x.useState)(0);return(0,x.useCallback)(()=>t(e=>e+1),[])}function iJ(e,t){if(!e)throw console.error(t),Error(t)}function i0(e,t,n=ie){return e.toFixed(n)===t.toFixed(n)?0:e>t?1:-1}function i1(e,t,n=ie){return 0===i0(e,t,n)}function i2(e,t,n){return 0===i0(e,t,n)}function i3(e,t,n){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!i2(e[i],t[i],n))return!1;return!0}function i4({panelConstraints:e,panelIndex:t,size:n}){let i=e[t];iJ(null!=i,`Panel constraints not found for index ${t}`);let{collapsedSize:a=0,collapsible:o,maxSize:s=100,minSize:l=0}=i;return 0>i0(n,l)&&(n=o&&0>i0(n,(a+l)/2)?a:l),n=parseFloat((n=Math.min(s,n)).toFixed(ie))}function i6({delta:e,initialLayout:t,panelConstraints:n,pivotIndices:i,prevLayout:a,trigger:o}){if(i2(e,0))return t;let s=[...t],[l,u]=i;iJ(null!=l,"Invalid first pivot index"),iJ(null!=u,"Invalid second pivot index");let c=0;if("keyboard"===o){{let i=e<0?u:l,a=n[i];iJ(a,`Panel constraints not found for index ${i}`);let{collapsedSize:o=0,collapsible:s,minSize:c=0}=a;if(s){let n=t[i];if(iJ(null!=n,`Previous layout not found for panel index ${i}`),i2(n,o)){let t=c-n;i0(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}{let i=e<0?l:u,a=n[i];iJ(a,`No panel constraints found for index ${i}`);let{collapsedSize:o=0,collapsible:s,minSize:c=0}=a;if(s){let n=t[i];if(iJ(null!=n,`Previous layout not found for panel index ${i}`),i2(n,c)){let t=n-o;i0(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}}{let i=e<0?1:-1,a=e<0?u:l,o=0;for(;;){let e=t[a];if(iJ(null!=e,`Previous layout not found for panel index ${a}`),o+=i4({panelConstraints:n,panelIndex:a,size:100})-e,(a+=i)<0||a>=n.length)break}let s=Math.min(Math.abs(e),Math.abs(o));e=e<0?0-s:s}{let i=e<0?l:u;for(;i>=0&&i<n.length;){let a=Math.abs(e)-Math.abs(c),o=t[i];iJ(null!=o,`Previous layout not found for panel index ${i}`);let l=i4({panelConstraints:n,panelIndex:i,size:o-a});if(!i2(o,l)&&(c+=o-l,s[i]=l,c.toFixed(3).localeCompare(Math.abs(e).toFixed(3),void 0,{numeric:!0})>=0))break;e<0?i--:i++}}if(i3(a,s))return a;{let i=e<0?u:l,a=t[i];iJ(null!=a,`Previous layout not found for panel index ${i}`);let o=a+c,d=i4({panelConstraints:n,panelIndex:i,size:o});if(s[i]=d,!i2(d,o)){let t=o-d,i=e<0?u:l;for(;i>=0&&i<n.length;){let a=s[i];iJ(null!=a,`Previous layout not found for panel index ${i}`);let o=i4({panelConstraints:n,panelIndex:i,size:a+t});if(i2(a,o)||(t-=o-a,s[i]=o),i2(t,0))break;e>0?i--:i++}}}return i2(s.reduce((e,t)=>t+e,0),100)?s:a}function i5({layout:e,panelsArray:t,pivotIndices:n}){let i=0,a=100,o=0,s=0,l=n[0];return iJ(null!=l,"No pivot index found"),t.forEach((e,t)=>{let{constraints:n}=e,{maxSize:u=100,minSize:c=0}=n;t===l?(i=c,a=u):(o+=c,s+=u)}),{valueMax:Math.min(a,100-o),valueMin:Math.max(i,100-s),valueNow:e[l]}}function i8(e,t=document){return Array.from(t.querySelectorAll(`[${r7}][data-panel-group-id="${e}"]`))}function i7(e,t,n=document){let i=i8(e,n).findIndex(e=>e.getAttribute(r7)===t);return null!=i?i:null}function i9(e,t,n){let i=i7(e,t,n);return null!=i?[i,i+1]:[-1,-1]}function ae(e){return e instanceof HTMLElement||"object"==typeof e&&null!==e&&"tagName"in e&&"getAttribute"in e}function at(e,t=document){if(ae(t)&&t.dataset.panelGroupId==e)return t;let n=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return n||null}function an(e,t=document){let n=t.querySelector(`[${r7}="${e}"]`);return n||null}function ar(e,t,n,i=document){var a,o,s,l;let u=an(t,i),c=i8(e,i),d=u?c.indexOf(u):-1;return[null!=(a=null==(o=n[d])?void 0:o.id)?a:null,null!=(s=null==(l=n[d+1])?void 0:l.id)?s:null]}function ai({committedValuesRef:e,eagerValuesRef:t,groupId:n,layout:i,panelDataArray:a,panelGroupElement:o,setLayout:s}){(0,x.useRef)({didWarnAboutMissingResizeHandle:!1}),it(()=>{if(!o)return;let e=i8(n,o);for(let t=0;t<a.length-1;t++){let{valueMax:n,valueMin:o,valueNow:s}=i5({layout:i,panelsArray:a,pivotIndices:[t,t+1]}),l=e[t];if(null==l);else{let e=a[t];iJ(e,`No panel data found for index "${t}"`),l.setAttribute("aria-controls",e.id),l.setAttribute("aria-valuemax",""+Math.round(n)),l.setAttribute("aria-valuemin",""+Math.round(o)),l.setAttribute("aria-valuenow",null!=s?""+Math.round(s):"")}}return()=>{e.forEach((e,t)=>{e.removeAttribute("aria-controls"),e.removeAttribute("aria-valuemax"),e.removeAttribute("aria-valuemin"),e.removeAttribute("aria-valuenow")})}},[n,i,a,o]),(0,x.useEffect)(()=>{if(!o)return;let e=t.current;iJ(e,"Eager values not found");let{panelDataArray:a}=e;iJ(null!=at(n,o),`No group found for id "${n}"`);let l=i8(n,o);iJ(l,`No resize handles found for group id "${n}"`);let u=l.map(e=>{let t=e.getAttribute(r7);iJ(t,"Resize handle element has no handle id attribute");let[l,u]=ar(n,t,a,o);if(null==l||null==u)return()=>{};let c=e=>{if(!e.defaultPrevented&&"Enter"===e.key){e.preventDefault();let u=a.findIndex(e=>e.id===l);if(u>=0){let e=a[u];iJ(e,`No panel data found for index ${u}`);let l=i[u],{collapsedSize:c=0,collapsible:d,minSize:p=0}=e.constraints;if(null!=l&&d){let e=i6({delta:i2(l,c)?p-c:c-l,initialLayout:i,panelConstraints:a.map(e=>e.constraints),pivotIndices:i9(n,t,o),prevLayout:i,trigger:"keyboard"});i!==e&&s(e)}}}};return e.addEventListener("keydown",c),()=>{e.removeEventListener("keydown",c)}});return()=>{u.forEach(e=>e())}},[o,e,t,n,i,a,s])}function aa(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function ao(e,t){let n="horizontal"===e,{x:i,y:a}=i_(t);return n?i:a}function as(e,t,n,i,a){let o="horizontal"===n,s=an(t,a);iJ(s,`No resize handle element found for id "${t}"`);let l=s.getAttribute(r0);iJ(l,"Resize handle element has no group id attribute");let{initialCursorPosition:u}=i,c=ao(n,e),d=at(l,a);iJ(d,`No group element found for id "${l}"`);let p=d.getBoundingClientRect();return(c-u)/(o?p.width:p.height)*100}function al(e,t,n,i,a,o){if(iv(e)){let t="horizontal"===n,i=0;i=e.shiftKey?100:null!=a?a:10;let o=0;switch(e.key){case"ArrowDown":o=t?0:i;break;case"ArrowLeft":o=t?-i:0;break;case"ArrowRight":o=t?i:0;break;case"ArrowUp":o=t?0:-i;break;case"End":o=100;break;case"Home":o=-100}return o}return null==i?0:as(e,t,n,i,o)}function au({panelDataArray:e}){let t=Array(e.length),n=e.map(e=>e.constraints),i=0,a=100;for(let o=0;o<e.length;o++){let e=n[o];iJ(e,`Panel constraints not found for index ${o}`);let{defaultSize:s}=e;null!=s&&(i++,t[o]=s,a-=s)}for(let o=0;o<e.length;o++){let s=n[o];iJ(s,`Panel constraints not found for index ${o}`);let{defaultSize:l}=s;if(null!=l)continue;let u=a/(e.length-i);i++,t[o]=u,a-=u}return t}function ac(e,t,n){t.forEach((t,i)=>{let a=e[i];iJ(a,`Panel data not found for index ${i}`);let{callbacks:o,constraints:s,id:l}=a,{collapsedSize:u=0,collapsible:c}=s,d=n[l];if(null==d||t!==d){n[l]=t;let{onCollapse:e,onExpand:i,onResize:a}=o;a&&a(t,d),c&&(e||i)&&(i&&(null==d||i1(d,u))&&!i1(t,u)&&i(),e&&(null==d||!i1(d,u))&&i1(t,u)&&e())}})}function ad(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function ap({defaultSize:e,dragState:t,layout:n,panelData:i,panelIndex:a,precision:o=3}){let s,l=n[a];return{flexBasis:0,flexGrow:s=null==l?void 0!=e?e.toFixed(o):"1":1===i.length?"1":l.toFixed(o),flexShrink:1,overflow:"hidden",pointerEvents:null!==t?"none":void 0}}function ah(e,t=10){let n=null;return(...i)=>{null!==n&&clearTimeout(n),n=setTimeout(()=>{e(...i)},t)}}function af(e){try{if("undefined"!=typeof localStorage)e.getItem=e=>localStorage.getItem(e),e.setItem=(e,t)=>{localStorage.setItem(e,t)};else throw Error("localStorage not supported in this environment")}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function ag(e){return`react-resizable-panels:${e}`}function am(e){return e.map(e=>{let{constraints:t,id:n,idIsFromProps:i,order:a}=e;return i?n:a?`${a}:${JSON.stringify(t)}`:JSON.stringify(t)}).sort((e,t)=>e.localeCompare(t)).join(",")}function ay(e,t){try{let n=ag(e),i=t.getItem(n);if(i){let e=JSON.parse(i);if("object"==typeof e&&null!=e)return e}}catch(e){}return null}function ab(e,t,n){var i,a;return null!=(a=(null!=(i=ay(e,n))?i:{})[am(t)])?a:null}function av(e,t,n,i,a){var o;let s=ag(e),l=am(t),u=null!=(o=ay(e,a))?o:{};u[l]={expandToSizes:Object.fromEntries(n.entries()),layout:i};try{a.setItem(s,JSON.stringify(u))}catch(e){console.error(e)}}function ax({layout:e,panelConstraints:t}){let n=[...e],i=n.reduce((e,t)=>e+t,0);if(n.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${n.map(e=>`${e}%`).join(", ")}`);if(!i2(i,100)&&n.length>0)for(let e=0;e<t.length;e++){let t=n[e];iJ(null!=t,`No layout data found for index ${e}`);let a=100/i*t;n[e]=a}let a=0;for(let e=0;e<t.length;e++){let i=n[e];iJ(null!=i,`No layout data found for index ${e}`);let o=i4({panelConstraints:t,panelIndex:e,size:i});i!=o&&(a+=i-o,n[e]=o)}if(!i2(a,0))for(let e=0;e<t.length;e++){let i=n[e];iJ(null!=i,`No layout data found for index ${e}`);let o=i4({panelConstraints:t,panelIndex:e,size:i+a});if(i!==o&&(a-=o-i,n[e]=o,i2(a,0)))break}return n}let aw=100,a_={getItem:e=>(af(a_),a_.getItem(e)),setItem:(e,t)=>{af(a_),a_.setItem(e,t)}},aS={};function ak({autoSaveId:e=null,children:t,className:n="",direction:i,forwardedRef:a,id:o=null,onLayout:s=null,keyboardResizeBy:l=null,storage:u=a_,style:c,tagName:d="div",...p}){let h=io(o),f=(0,x.useRef)(null),[g,m]=(0,x.useState)(null),[y,b]=(0,x.useState)([]),v=iQ(),w=(0,x.useRef)({}),_=(0,x.useRef)(new Map),S=(0,x.useRef)(0),k=(0,x.useRef)({autoSaveId:e,direction:i,dragState:g,id:h,keyboardResizeBy:l,onLayout:s,storage:u}),T=(0,x.useRef)({layout:y,panelDataArray:[],panelDataArrayChanged:!1});(0,x.useRef)({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),(0,x.useImperativeHandle)(a,()=>({getId:()=>k.current.id,getLayout:()=>{let{layout:e}=T.current;return e},setLayout:e=>{let{onLayout:t}=k.current,{layout:n,panelDataArray:i}=T.current,a=ax({layout:e,panelConstraints:i.map(e=>e.constraints)});aa(n,a)||(b(a),T.current.layout=a,t&&t(a),ac(i,a,w.current))}}),[]),it(()=>{k.current.autoSaveId=e,k.current.direction=i,k.current.dragState=g,k.current.id=h,k.current.onLayout=s,k.current.storage=u}),ai({committedValuesRef:k,eagerValuesRef:T,groupId:h,layout:y,panelDataArray:T.current.panelDataArray,setLayout:b,panelGroupElement:f.current}),(0,x.useEffect)(()=>{let{panelDataArray:t}=T.current;if(e){if(0===y.length||y.length!==t.length)return;let n=aS[e];null==n&&(n=ah(av,aw),aS[e]=n),n(e,[...t],new Map(_.current),y,u)}},[e,y,u]),(0,x.useEffect)(()=>{});let C=(0,x.useCallback)(e=>{let{onLayout:t}=k.current,{layout:n,panelDataArray:i}=T.current;if(e.constraints.collapsible){let a=i.map(e=>e.constraints),{collapsedSize:o=0,panelSize:s,pivotIndices:l}=aE(i,e,n);if(iJ(null!=s,`Panel size not found for panel "${e.id}"`),!i1(s,o)){_.current.set(e.id,s);let u=i6({delta:aC(i,e)===i.length-1?s-o:o-s,initialLayout:n,panelConstraints:a,pivotIndices:l,prevLayout:n,trigger:"imperative-api"});ad(n,u)||(b(u),T.current.layout=u,t&&t(u),ac(i,u,w.current))}}},[]),E=(0,x.useCallback)((e,t)=>{let{onLayout:n}=k.current,{layout:i,panelDataArray:a}=T.current;if(e.constraints.collapsible){let o=a.map(e=>e.constraints),{collapsedSize:s=0,panelSize:l=0,minSize:u=0,pivotIndices:c}=aE(a,e,i),d=null!=t?t:u;if(i1(l,s)){let t=_.current.get(e.id),s=null!=t&&t>=d?t:d,u=i6({delta:aC(a,e)===a.length-1?l-s:s-l,initialLayout:i,panelConstraints:o,pivotIndices:c,prevLayout:i,trigger:"imperative-api"});ad(i,u)||(b(u),T.current.layout=u,n&&n(u),ac(a,u,w.current))}}},[]),I=(0,x.useCallback)(e=>{let{layout:t,panelDataArray:n}=T.current,{panelSize:i}=aE(n,e,t);return iJ(null!=i,`Panel size not found for panel "${e.id}"`),i},[]),$=(0,x.useCallback)((e,t)=>{let{panelDataArray:n}=T.current,i=aC(n,e);return ap({defaultSize:t,dragState:g,layout:y,panelData:n,panelIndex:i})},[g,y]),O=(0,x.useCallback)(e=>{let{layout:t,panelDataArray:n}=T.current,{collapsedSize:i=0,collapsible:a,panelSize:o}=aE(n,e,t);return iJ(null!=o,`Panel size not found for panel "${e.id}"`),!0===a&&i1(o,i)},[]),A=(0,x.useCallback)(e=>{let{layout:t,panelDataArray:n}=T.current,{collapsedSize:i=0,collapsible:a,panelSize:o}=aE(n,e,t);return iJ(null!=o,`Panel size not found for panel "${e.id}"`),!a||i0(o,i)>0},[]),N=(0,x.useCallback)(e=>{let{panelDataArray:t}=T.current;t.push(e),t.sort((e,t)=>{let n=e.order,i=t.order;return null==n&&null==i?0:null==n?-1:null==i?1:n-i}),T.current.panelDataArrayChanged=!0,v()},[v]);it(()=>{if(T.current.panelDataArrayChanged){T.current.panelDataArrayChanged=!1;let{autoSaveId:e,onLayout:t,storage:n}=k.current,{layout:i,panelDataArray:a}=T.current,o=null;if(e){let t=ab(e,a,n);t&&(_.current=new Map(Object.entries(t.expandToSizes)),o=t.layout)}null==o&&(o=au({panelDataArray:a}));let s=ax({layout:o,panelConstraints:a.map(e=>e.constraints)});aa(i,s)||(b(s),T.current.layout=s,t&&t(s),ac(a,s,w.current))}}),it(()=>{let e=T.current;return()=>{e.layout=[]}},[]);let P=(0,x.useCallback)(e=>{let t=!1,n=f.current;return n&&"rtl"===window.getComputedStyle(n,null).getPropertyValue("direction")&&(t=!0),function(n){n.preventDefault();let i=f.current;if(!i)return()=>null;let{direction:a,dragState:o,id:s,keyboardResizeBy:l,onLayout:u}=k.current,{layout:c,panelDataArray:d}=T.current,{initialLayout:p}=null!=o?o:{},h=i9(s,e,i),g=al(n,e,a,o,l,i),m="horizontal"===a;m&&t&&(g=-g);let y=i6({delta:g,initialLayout:null!=p?p:c,panelConstraints:d.map(e=>e.constraints),pivotIndices:h,prevLayout:c,trigger:iv(n)?"keyboard":"mouse-or-touch"}),v=!ad(c,y);(ix(n)||iw(n))&&S.current!=g&&(S.current=g,v||0===g?iK(e,0):m?iK(e,g<0?iN:iP):iK(e,g<0?iD:iM)),v&&(b(y),T.current.layout=y,u&&u(y),ac(d,y,w.current))}},[]),D=(0,x.useCallback)((e,t)=>{let{onLayout:n}=k.current,{layout:i,panelDataArray:a}=T.current,o=a.map(e=>e.constraints),{panelSize:s,pivotIndices:l}=aE(a,e,i);iJ(null!=s,`Panel size not found for panel "${e.id}"`);let u=i6({delta:aC(a,e)===a.length-1?s-t:t-s,initialLayout:i,panelConstraints:o,pivotIndices:l,prevLayout:i,trigger:"imperative-api"});ad(i,u)||(b(u),T.current.layout=u,n&&n(u),ac(a,u,w.current))},[]),M=(0,x.useCallback)((e,t)=>{let{layout:n,panelDataArray:i}=T.current,{collapsedSize:a=0,collapsible:o}=t,{collapsedSize:s=0,collapsible:l,maxSize:u=100,minSize:c=0}=e.constraints,{panelSize:d}=aE(i,e,n);null!=d&&(o&&l&&i1(d,a)?i1(a,s)||D(e,s):d<c?D(e,c):d>u&&D(e,u))},[D]),z=(0,x.useCallback)((e,t)=>{let{direction:n}=k.current,{layout:i}=T.current;if(!f.current)return;let a=an(e,f.current);iJ(a,`Drag handle element not found for id "${e}"`);let o=ao(n,t);m({dragHandleId:e,dragHandleRect:a.getBoundingClientRect(),initialCursorPosition:o,initialLayout:i})},[]),j=(0,x.useCallback)(()=>{m(null)},[]),R=(0,x.useCallback)(e=>{let{panelDataArray:t}=T.current,n=aC(t,e);n>=0&&(t.splice(n,1),delete w.current[e.id],T.current.panelDataArrayChanged=!0,v())},[v]),L=(0,x.useMemo)(()=>({collapsePanel:C,direction:i,dragState:g,expandPanel:E,getPanelSize:I,getPanelStyle:$,groupId:h,isPanelCollapsed:O,isPanelExpanded:A,reevaluatePanelConstraints:M,registerPanel:N,registerResizeHandle:P,resizePanel:D,startDragging:z,stopDragging:j,unregisterPanel:R,panelGroupElement:f.current}),[C,g,i,E,I,$,h,O,A,M,N,P,D,z,j,R]),F={display:"flex",flexDirection:"horizontal"===i?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return(0,x.createElement)(rY.Provider,{value:L},(0,x.createElement)(d,{...p,children:t,className:n,id:o,ref:f,style:{...F,...c},[rQ]:"",[rJ]:i,[r0]:h}))}let aT=(0,x.forwardRef)((e,t)=>(0,x.createElement)(ak,{...e,forwardedRef:t}));function aC(e,t){return e.findIndex(e=>e===t||e.id===t.id)}function aE(e,t,n){let i=aC(e,t),a=i===e.length-1?[i-1,i]:[i,i+1],o=n[i];return{...t.constraints,panelSize:o,pivotIndices:a}}function aI({disabled:e,handleId:t,resizeHandler:n,panelGroupElement:i}){(0,x.useEffect)(()=>{if(e||null==n||null==i)return;let a=an(t,i);if(null==a)return;let o=e=>{if(!e.defaultPrevented)switch(e.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":e.preventDefault(),n(e);break;case"F6":{e.preventDefault();let n=a.getAttribute(r0);iJ(n,`No group element found for id "${n}"`);let o=i8(n,i),s=i7(n,t,i);iJ(null!==s,`No resize element found for id "${t}"`);let l=e.shiftKey?s>0?s-1:o.length-1:s+1<o.length?s+1:0;o[l].focus()}}};return a.addEventListener("keydown",o),()=>{a.removeEventListener("keydown",o)}},[i,e,t,n])}function a$({children:e=null,className:t="",disabled:n=!1,hitAreaMargins:i,id:a,onBlur:o,onClick:s,onDragging:l,onFocus:u,onPointerDown:c,onPointerUp:d,style:p={},tabIndex:h=0,tagName:f="div",...g}){var m,y;let b=(0,x.useRef)(null),v=(0,x.useRef)({onClick:s,onDragging:l,onPointerDown:c,onPointerUp:d});(0,x.useEffect)(()=>{v.current.onClick=s,v.current.onDragging=l,v.current.onPointerDown=c,v.current.onPointerUp=d});let w=(0,x.useContext)(rY);if(null===w)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");let{direction:_,groupId:S,registerResizeHandle:k,startDragging:T,stopDragging:C,panelGroupElement:E}=w,I=io(a),[$,O]=(0,x.useState)("inactive"),[A,N]=(0,x.useState)(!1),[P,D]=(0,x.useState)(null),M=(0,x.useRef)({state:$});it(()=>{M.current.state=$}),(0,x.useEffect)(()=>{if(n)D(null);else{let e=k(I);D(()=>e)}},[n,I,k]);let z=null!=(m=null==i?void 0:i.coarse)?m:15,j=null!=(y=null==i?void 0:i.fine)?y:5;(0,x.useEffect)(()=>{if(n||null==P)return;let e=b.current;iJ(e,"Element ref not attached");let t=!1,i=(e,n,i)=>{if(!n)return void O("inactive");switch(e){case"down":{O("drag"),t=!1,iJ(i,'Expected event to be defined for "down" action'),T(I,i);let{onDragging:e,onPointerDown:n}=v.current;null==e||e(!0),null==n||n();break}case"move":{let{state:e}=M.current;t=!0,"drag"!==e&&O("hover"),iJ(i,'Expected event to be defined for "move" action'),P(i);break}case"up":{O("hover"),C();let{onClick:e,onDragging:n,onPointerUp:i}=v.current;null==n||n(!1),null==i||i(),t||null==e||e()}}};return iU(I,e,_,{coarse:z,fine:j},i)},[z,_,n,j,k,I,P,T,C]),aI({disabled:n,handleId:I,resizeHandler:P,panelGroupElement:E});let R={touchAction:"none",userSelect:"none"};return(0,x.createElement)(f,{...g,children:e,className:t,id:a,onBlur:()=>{N(!1),null==o||o()},onFocus:()=>{N(!0),null==u||u()},ref:b,role:"separator",style:{...R,...p},tabIndex:h,[rJ]:_,[r0]:S,[r6]:"",[r5]:"drag"===$?"pointer":A?"keyboard":void 0,[r8]:!n,[r7]:I,[r9]:$})}ak.displayName="PanelGroup",aT.displayName="forwardRef(PanelGroup)",a$.displayName="PanelResizeHandle";var aO={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},aA=x.createContext&&x.createContext(aO),aN=["attr","size","title"];function aP(e,t){if(null==e)return{};var n,i,a=aD(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function aD(e,t){if(null==e)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function aM(){return(aM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function az(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function aj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?az(Object(n),!0).forEach(function(t){aR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):az(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function aR(e,t,n){return(t=aL(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aL(e){var t=aF(e,"string");return"symbol"==typeof t?t:t+""}function aF(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function aB(e){return e&&e.map((e,t)=>x.createElement(e.tag,aj({key:t},e.attr),aB(e.child)))}function aU(e){return t=>x.createElement(aV,aM({attr:aj({},e.attr)},t),aB(e.child))}function aV(e){var t=t=>{var n,{attr:i,size:a,title:o}=e,s=aP(e,aN),l=a||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),x.createElement("svg",aM({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,s,{className:n,style:aj(aj({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),o&&x.createElement("title",null,o),e.children)};return void 0!==aA?x.createElement(aA.Consumer,null,e=>t(e)):t(aO)}function aG(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M5 3h14"},child:[]},{tag:"path",attr:{d:"m18 13-6-6-6 6"},child:[]},{tag:"path",attr:{d:"M12 7v14"},child:[]}]})(e)}function aH(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"},child:[]},{tag:"line",attr:{x1:"12",x2:"12",y1:"7",y2:"13"},child:[]},{tag:"line",attr:{x1:"15",x2:"9",y1:"10",y2:"10"},child:[]}]})(e)}function aW(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 8V4H8"},child:[]},{tag:"rect",attr:{width:"16",height:"12",x:"4",y:"8",rx:"2"},child:[]},{tag:"path",attr:{d:"M2 14h2"},child:[]},{tag:"path",attr:{d:"M20 14h2"},child:[]},{tag:"path",attr:{d:"M15 13v2"},child:[]},{tag:"path",attr:{d:"M9 13v2"},child:[]}]})(e)}function aq(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"},child:[]},{tag:"path",attr:{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"},child:[]},{tag:"path",attr:{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"},child:[]},{tag:"path",attr:{d:"M17.599 6.5a3 3 0 0 0 .399-1.375"},child:[]},{tag:"path",attr:{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5"},child:[]},{tag:"path",attr:{d:"M3.477 10.896a4 4 0 0 1 .585-.396"},child:[]},{tag:"path",attr:{d:"M19.938 10.5a4 4 0 0 1 .585.396"},child:[]},{tag:"path",attr:{d:"M6 18a4 4 0 0 1-1.967-.516"},child:[]},{tag:"path",attr:{d:"M19.967 17.484A4 4 0 0 1 18 18"},child:[]}]})(e)}function aK(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m8 2 1.88 1.88"},child:[]},{tag:"path",attr:{d:"M14.12 3.88 16 2"},child:[]},{tag:"path",attr:{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1"},child:[]},{tag:"path",attr:{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6"},child:[]},{tag:"path",attr:{d:"M12 20v-9"},child:[]},{tag:"path",attr:{d:"M6.53 9C4.6 8.8 3 7.1 3 5"},child:[]},{tag:"path",attr:{d:"M6 13H2"},child:[]},{tag:"path",attr:{d:"M3 21c0-2.1 1.7-3.9 3.8-4"},child:[]},{tag:"path",attr:{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4"},child:[]},{tag:"path",attr:{d:"M22 13h-4"},child:[]},{tag:"path",attr:{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4"},child:[]}]})(e)}function aX(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{width:"16",height:"20",x:"4",y:"2",rx:"2"},child:[]},{tag:"line",attr:{x1:"8",x2:"16",y1:"6",y2:"6"},child:[]},{tag:"line",attr:{x1:"16",x2:"16",y1:"14",y2:"18"},child:[]},{tag:"path",attr:{d:"M16 10h.01"},child:[]},{tag:"path",attr:{d:"M12 10h.01"},child:[]},{tag:"path",attr:{d:"M8 10h.01"},child:[]},{tag:"path",attr:{d:"M12 14h.01"},child:[]},{tag:"path",attr:{d:"M8 14h.01"},child:[]},{tag:"path",attr:{d:"M12 18h.01"},child:[]},{tag:"path",attr:{d:"M8 18h.01"},child:[]}]})(e)}function aZ(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 3v16a2 2 0 0 0 2 2h16"},child:[]},{tag:"path",attr:{d:"m19 9-5 5-4-4-3 3"},child:[]}]})(e)}function aY(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 6 9 17l-5-5"},child:[]}]})(e)}function aQ(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m6 9 6 6 6-6"},child:[]}]})(e)}function aJ(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m15 18-6-6 6-6"},child:[]}]})(e)}function a0(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m9 18 6-6-6-6"},child:[]}]})(e)}function a1(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m18 15-6-6-6 6"},child:[]}]})(e)}function a2(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]}]})(e)}function a3(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"},child:[]},{tag:"path",attr:{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"},child:[]},{tag:"path",attr:{d:"m17 10 4 4-4 4"},child:[]}]})(e)}function a4(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"},child:[]}]})(e)}function a6(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{width:"16",height:"16",x:"4",y:"4",rx:"2"},child:[]},{tag:"rect",attr:{width:"6",height:"6",x:"9",y:"9",rx:"1"},child:[]},{tag:"path",attr:{d:"M15 2v2"},child:[]},{tag:"path",attr:{d:"M15 20v2"},child:[]},{tag:"path",attr:{d:"M2 15h2"},child:[]},{tag:"path",attr:{d:"M2 9h2"},child:[]},{tag:"path",attr:{d:"M20 15h2"},child:[]},{tag:"path",attr:{d:"M20 9h2"},child:[]},{tag:"path",attr:{d:"M9 2v2"},child:[]},{tag:"path",attr:{d:"M9 20v2"},child:[]}]})(e)}function a5(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"7 10 12 15 17 10"},child:[]},{tag:"line",attr:{x1:"12",x2:"12",y1:"15",y2:"3"},child:[]}]})(e)}function a8(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"1"},child:[]},{tag:"circle",attr:{cx:"19",cy:"12",r:"1"},child:[]},{tag:"circle",attr:{cx:"5",cy:"12",r:"1"},child:[]}]})(e)}function a7(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21"},child:[]},{tag:"path",attr:{d:"M22 21H7"},child:[]},{tag:"path",attr:{d:"m5 11 9 9"},child:[]}]})(e)}function a9(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M15 3h6v6"},child:[]},{tag:"path",attr:{d:"M10 14 21 3"},child:[]},{tag:"path",attr:{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"},child:[]}]})(e)}function oe(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49"},child:[]},{tag:"path",attr:{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242"},child:[]},{tag:"path",attr:{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143"},child:[]},{tag:"path",attr:{d:"m2 2 20 20"},child:[]}]})(e)}function ot(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]}]})(e)}function on(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"13 19 22 12 13 5 13 19"},child:[]},{tag:"polygon",attr:{points:"2 19 11 12 2 5 2 19"},child:[]}]})(e)}function or(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"},child:[]},{tag:"path",attr:{d:"M14 2v4a2 2 0 0 0 2 2h4"},child:[]}]})(e)}function oi(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"},child:[]},{tag:"line",attr:{x1:"4",x2:"4",y1:"22",y2:"15"},child:[]}]})(e)}function oa(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2"},child:[]}]})(e)}function oo(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 10v6"},child:[]},{tag:"path",attr:{d:"M9 13h6"},child:[]},{tag:"path",attr:{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"},child:[]}]})(e)}function os(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"},child:[]}]})(e)}function ol(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"6",x2:"10",y1:"11",y2:"11"},child:[]},{tag:"line",attr:{x1:"8",x2:"8",y1:"9",y2:"13"},child:[]},{tag:"line",attr:{x1:"15",x2:"15.01",y1:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"18",x2:"18.01",y1:"10",y2:"10"},child:[]},{tag:"path",attr:{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z"},child:[]}]})(e)}function ou(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"6",x2:"6",y1:"3",y2:"15"},child:[]},{tag:"circle",attr:{cx:"18",cy:"6",r:"3"},child:[]},{tag:"circle",attr:{cx:"6",cy:"18",r:"3"},child:[]},{tag:"path",attr:{d:"M18 9a9 9 0 0 1-9 9"},child:[]}]})(e)}function oc(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"},child:[]},{tag:"path",attr:{d:"M9 18c-4.51 2-5-2-7-2"},child:[]}]})(e)}function od(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"path",attr:{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"},child:[]},{tag:"path",attr:{d:"M2 12h20"},child:[]}]})(e)}function op(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"4",x2:"20",y1:"9",y2:"9"},child:[]},{tag:"line",attr:{x1:"4",x2:"20",y1:"15",y2:"15"},child:[]},{tag:"line",attr:{x1:"10",x2:"8",y1:"3",y2:"21"},child:[]},{tag:"line",attr:{x1:"16",x2:"14",y1:"3",y2:"21"},child:[]}]})(e)}function oh(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"path",attr:{d:"M12 16v-4"},child:[]},{tag:"path",attr:{d:"M12 8h.01"},child:[]}]})(e)}function of(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z"},child:[]},{tag:"path",attr:{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65"},child:[]},{tag:"path",attr:{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65"},child:[]}]})(e)}function og(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{width:"7",height:"9",x:"3",y:"3",rx:"1"},child:[]},{tag:"rect",attr:{width:"7",height:"5",x:"14",y:"3",rx:"1"},child:[]},{tag:"rect",attr:{width:"7",height:"9",x:"14",y:"12",rx:"1"},child:[]},{tag:"rect",attr:{width:"7",height:"5",x:"3",y:"16",rx:"1"},child:[]}]})(e)}function om(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{width:"7",height:"7",x:"3",y:"3",rx:"1"},child:[]},{tag:"rect",attr:{width:"7",height:"7",x:"14",y:"3",rx:"1"},child:[]},{tag:"rect",attr:{width:"7",height:"7",x:"14",y:"14",rx:"1"},child:[]},{tag:"rect",attr:{width:"7",height:"7",x:"3",y:"14",rx:"1"},child:[]}]})(e)}function oy(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m16 6 4 14"},child:[]},{tag:"path",attr:{d:"M12 6v14"},child:[]},{tag:"path",attr:{d:"M8 8v12"},child:[]},{tag:"path",attr:{d:"M4 4v16"},child:[]}]})(e)}function ob(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 2v4"},child:[]},{tag:"path",attr:{d:"m16.2 7.8 2.9-2.9"},child:[]},{tag:"path",attr:{d:"M18 12h4"},child:[]},{tag:"path",attr:{d:"m16.2 16.2 2.9 2.9"},child:[]},{tag:"path",attr:{d:"M12 18v4"},child:[]},{tag:"path",attr:{d:"m4.9 19.1 2.9-2.9"},child:[]},{tag:"path",attr:{d:"M2 12h4"},child:[]},{tag:"path",attr:{d:"m4.9 4.9 2.9 2.9"},child:[]}]})(e)}function ov(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"2",x2:"5",y1:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"19",x2:"22",y1:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",x2:"12",y1:"2",y2:"5"},child:[]},{tag:"line",attr:{x1:"12",x2:"12",y1:"19",y2:"22"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"7"},child:[]}]})(e)}function ox(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z"},child:[]},{tag:"path",attr:{d:"M15 5.764v15"},child:[]},{tag:"path",attr:{d:"M9 3.236v15"},child:[]}]})(e)}function ow(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M8 3H5a2 2 0 0 0-2 2v3"},child:[]},{tag:"path",attr:{d:"M21 8V5a2 2 0 0 0-2-2h-3"},child:[]},{tag:"path",attr:{d:"M3 16v3a2 2 0 0 0 2 2h3"},child:[]},{tag:"path",attr:{d:"M16 21h3a2 2 0 0 0 2-2v-3"},child:[]}]})(e)}function o_(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"4",x2:"20",y1:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"4",x2:"20",y1:"6",y2:"6"},child:[]},{tag:"line",attr:{x1:"4",x2:"20",y1:"18",y2:"18"},child:[]}]})(e)}function oS(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"},child:[]}]})(e)}function ok(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M8 3v3a2 2 0 0 1-2 2H3"},child:[]},{tag:"path",attr:{d:"M21 8h-3a2 2 0 0 1-2-2V3"},child:[]},{tag:"path",attr:{d:"M3 16h3a2 2 0 0 1 2 2v3"},child:[]},{tag:"path",attr:{d:"M16 21v-3a2 2 0 0 1 2-2h3"},child:[]}]})(e)}function oT(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"},child:[]}]})(e)}function oC(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{width:"18",height:"18",x:"3",y:"3",rx:"2"},child:[]},{tag:"path",attr:{d:"M15 3v18"},child:[]}]})(e)}function oE(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{width:"18",height:"18",x:"3",y:"3",rx:"2"},child:[]},{tag:"path",attr:{d:"M3 9h18"},child:[]},{tag:"path",attr:{d:"m9 16 3-3 3 3"},child:[]}]})(e)}function oI(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"},child:[]},{tag:"path",attr:{d:"m15 5 4 4"},child:[]}]})(e)}function o$(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"6 3 20 12 6 21 6 3"},child:[]}]})(e)}function oO(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M5 12h14"},child:[]},{tag:"path",attr:{d:"M12 5v14"},child:[]}]})(e)}function oA(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m15 14 5-5-5-5"},child:[]},{tag:"path",attr:{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13"},child:[]}]})(e)}function oN(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"},child:[]},{tag:"path",attr:{d:"M21 3v5h-5"},child:[]},{tag:"path",attr:{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"},child:[]},{tag:"path",attr:{d:"M8 16H3v5"},child:[]}]})(e)}function oP(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"11 19 2 12 11 5 11 19"},child:[]},{tag:"polygon",attr:{points:"22 19 13 12 22 5 22 19"},child:[]}]})(e)}function oD(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"},child:[]},{tag:"path",attr:{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"},child:[]},{tag:"path",attr:{d:"M7 3v4a1 1 0 0 0 1 1h7"},child:[]}]})(e)}function oM(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"6",cy:"6",r:"3"},child:[]},{tag:"path",attr:{d:"M8.12 8.12 12 12"},child:[]},{tag:"path",attr:{d:"M20 4 8.12 15.88"},child:[]},{tag:"circle",attr:{cx:"6",cy:"18",r:"3"},child:[]},{tag:"path",attr:{d:"M14.8 14.8 20 20"},child:[]}]})(e)}function oz(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]}]})(e)}function oj(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"19 20 9 12 19 4 19 20"},child:[]},{tag:"line",attr:{x1:"5",x2:"5",y1:"19",y2:"5"},child:[]}]})(e)}function oR(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"5 4 15 12 5 20 5 4"},child:[]},{tag:"line",attr:{x1:"19",x2:"19",y1:"5",y2:"19"},child:[]}]})(e)}function oL(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z"},child:[]},{tag:"path",attr:{d:"M20 3v4"},child:[]},{tag:"path",attr:{d:"M22 5h-4"},child:[]},{tag:"path",attr:{d:"M4 17v2"},child:[]},{tag:"path",attr:{d:"M5 18H3"},child:[]}]})(e)}function oF(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{width:"18",height:"18",x:"3",y:"3",rx:"2"},child:[]}]})(e)}function oB(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"4"},child:[]},{tag:"path",attr:{d:"M12 2v2"},child:[]},{tag:"path",attr:{d:"M12 20v2"},child:[]},{tag:"path",attr:{d:"m4.93 4.93 1.41 1.41"},child:[]},{tag:"path",attr:{d:"m17.66 17.66 1.41 1.41"},child:[]},{tag:"path",attr:{d:"M2 12h2"},child:[]},{tag:"path",attr:{d:"M20 12h2"},child:[]},{tag:"path",attr:{d:"m6.34 17.66-1.41 1.41"},child:[]},{tag:"path",attr:{d:"m19.07 4.93-1.41 1.41"},child:[]}]})(e)}function oU(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 6h18"},child:[]},{tag:"path",attr:{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"},child:[]},{tag:"path",attr:{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"},child:[]},{tag:"line",attr:{x1:"10",x2:"10",y1:"11",y2:"17"},child:[]},{tag:"line",attr:{x1:"14",x2:"14",y1:"11",y2:"17"},child:[]}]})(e)}function oV(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 6h18"},child:[]},{tag:"path",attr:{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"},child:[]},{tag:"path",attr:{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"},child:[]}]})(e)}function oG(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"},child:[]},{tag:"path",attr:{d:"M12 9v4"},child:[]},{tag:"path",attr:{d:"M12 17h.01"},child:[]}]})(e)}function oH(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"},child:[]}]})(e)}function oW(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"4 7 4 4 20 4 20 7"},child:[]},{tag:"line",attr:{x1:"9",x2:"15",y1:"20",y2:"20"},child:[]},{tag:"line",attr:{x1:"12",x2:"12",y1:"4",y2:"20"},child:[]}]})(e)}function oq(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 14 4 9l5-5"},child:[]},{tag:"path",attr:{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11"},child:[]}]})(e)}function oK(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"17 8 12 3 7 8"},child:[]},{tag:"line",attr:{x1:"12",x2:"12",y1:"3",y2:"15"},child:[]}]})(e)}function oX(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z"},child:[]},{tag:"path",attr:{d:"M16 9a5 5 0 0 1 0 6"},child:[]},{tag:"path",attr:{d:"M19.364 18.364a9 9 0 0 0 0-12.728"},child:[]}]})(e)}function oZ(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z"},child:[]},{tag:"line",attr:{x1:"22",x2:"16",y1:"9",y2:"15"},child:[]},{tag:"line",attr:{x1:"16",x2:"22",y1:"9",y2:"15"},child:[]}]})(e)}function oY(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 6 6 18"},child:[]},{tag:"path",attr:{d:"m6 6 12 12"},child:[]}]})(e)}function oQ(e){return aU({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"},child:[]}]})(e)}function oJ(e){let[t,n]=(0,x.useState)(()=>"undefined"!=typeof window&&window.matchMedia(e).matches);return(0,x.useEffect)(()=>{if("undefined"==typeof window)return;let t=window.matchMedia(e),i=e=>{n(e.matches)};return n(t.matches),t.addEventListener("change",i),()=>{t.removeEventListener("change",i)}},[e]),t}let o0=768,o1=1025;function o2(){let e=oJ(`(max-width: ${o0-1}px)`),t=oJ("(max-height: 500px)"),n=oJ(`(min-width: ${o0}px) and (max-width: ${o1-1}px)`);return e||t?"mobile":n?"tablet":"desktop"}function o3(){let[e,t]=(0,x.useState)(()=>"undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0));return(0,x.useEffect)(()=>{let e=()=>{t("ontouchstart"in window||navigator.maxTouchPoints>0)};return window.addEventListener("touchstart",e,{once:!0}),()=>{window.removeEventListener("touchstart",e)}},[]),e}function o4(){return oJ("(orientation: landscape)")?"landscape":"portrait"}let o6=e=>{let{activeTab:t,onTabChange:n,showAnalysis:i=!0,commentBadge:a}=e,{t:o}=rK(),s=[{id:"board",label:o("mobileTab.board"),icon:(0,v.jsx)(om,{size:20})},{id:"info",label:o("mobileTab.info"),icon:(0,v.jsx)(oh,{size:20})},{id:"tree",label:o("mobileTab.tree"),icon:(0,v.jsx)(ou,{size:20})}];return i&&s.push({id:"analysis",label:o("mobileTab.analysis"),icon:(0,v.jsx)(aq,{size:20})}),s.push({id:"library",label:o("mobileTab.library"),icon:(0,v.jsx)(oy,{size:20})}),(0,v.jsx)("nav",{className:"mobile-tab-bar",role:"tablist",children:s.map(e=>(0,v.jsxs)("button",{className:`mobile-tab ${t===e.id?"active":""}`,onClick:()=>n(e.id),role:"tab","aria-selected":t===e.id,"aria-label":e.label,children:[(0,v.jsxs)("span",{className:"mobile-tab-icon",children:[e.icon,"info"===e.id&&a&&a>0&&(0,v.jsx)("span",{className:"mobile-tab-badge",children:a>9?"9+":a})]}),(0,v.jsx)("span",{className:"mobile-tab-label",children:e.label})]},e.id))})};o6.displayName="MobileTabBar";let o5="kaya-sidebar-panels",o8="kaya-left-panels",o7={gameTree:!0,gameInfo:!0,comment:!0},o9={library:!0,analysisGraph:!0},se=e=>{let{title:t,icon:n,isVisible:i,onToggle:a,headerActions:o}=e;return(0,v.jsxs)("div",{className:"sidebar-section-header collapsible-header",children:[(0,v.jsxs)("button",{className:"collapse-toggle",onClick:a,title:i?`Hide ${t} `:`Show ${t} `,children:[i?(0,v.jsx)(aQ,{size:14}):(0,v.jsx)(a0,{size:14}),(0,v.jsx)("span",{className:"section-icon",children:n}),(0,v.jsx)("h3",{children:t})]}),i&&o&&(0,v.jsx)("div",{className:"sidebar-section-actions",children:o})]})},st=e=>{let{libraryContent:t,analysisGraphContent:n,boardContent:i,gameTreeContent:a,gameInfoContent:o,commentContent:s,gameTreeHeaderActions:l,gameInfoHeaderActions:u,commentHeaderActions:c,showLibrary:d=!1,showSidebar:p=!0,onToggleLibrary:h,onToggleSidebar:f,activeMobileTab:g,onMobileTabChange:m}=e,{t:y}=rK(),b=o2(),w=o4(),_="mobile"===b||"tablet"===b,S="landscape"===w,[k,T]=(0,x.useState)("board"),C=g??k,E=m??T,[I,$]=(0,x.useState)(()=>{try{let e=localStorage.getItem(o5);if(e)return{...o7,...JSON.parse(e)}}catch{}return o7}),[O,A]=(0,x.useState)(()=>{try{let e=localStorage.getItem(o8);if(e)return{...o9,...JSON.parse(e)}}catch{}return o9});(0,x.useEffect)(()=>{localStorage.setItem(o5,JSON.stringify(I))},[I]),(0,x.useEffect)(()=>{localStorage.setItem(o8,JSON.stringify(O))},[O]);let N=(0,x.useCallback)(e=>{$(t=>({...t,[e]:!t[e]}))},[]),P=(0,x.useCallback)(e=>{A(t=>({...t,[e]:!t[e]}))},[]),D=[I.gameTree,I.gameInfo,I.comment].filter(Boolean).length,M=(e,t)=>{if(!e)return 0;if(1===D)return 100;if(2===D)return 50;switch(t){case"gameTree":return 50;case"gameInfo":return 35;case"comment":return 15;default:return 100/D}},z=[O.library,O.analysisGraph].filter(Boolean).length,j=e=>e&&e?2===z?60:100:0;if(_){let e=()=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"mobile-panel mobile-board-panel",style:{display:"board"===C?"flex":"none"},children:(0,v.jsx)("div",{className:"mobile-panel-content",children:i})}),(0,v.jsxs)("div",{className:"mobile-panel mobile-info-panel",style:{display:"info"===C?"flex":"none"},children:[(0,v.jsxs)("div",{className:"mobile-panel-header",children:[(0,v.jsx)(oh,{size:16}),(0,v.jsx)("span",{children:"Game Info"})]}),(0,v.jsxs)("div",{className:"mobile-panel-content mobile-info-content",children:[(0,v.jsx)("div",{className:"mobile-info-section",children:o||(0,v.jsx)("div",{className:"placeholder",children:"Game Info"})}),(0,v.jsxs)("div",{className:"mobile-comment-section",children:[(0,v.jsxs)("div",{className:"mobile-section-title",children:[(0,v.jsx)(oS,{size:14}),(0,v.jsx)("span",{children:"Comments"})]}),s||(0,v.jsx)("div",{className:"placeholder",children:"Comments"})]})]})]}),(0,v.jsxs)("div",{className:"mobile-panel mobile-tree-panel",style:{display:"tree"===C?"flex":"none"},children:[(0,v.jsxs)("div",{className:"mobile-panel-header",children:[(0,v.jsx)(ou,{size:16}),(0,v.jsx)("span",{children:"Game Tree"})]}),(0,v.jsx)("div",{className:"mobile-panel-content",children:a||(0,v.jsx)("div",{className:"placeholder",children:"Game Tree"})})]}),n&&(0,v.jsxs)("div",{className:"mobile-panel mobile-analysis-panel",style:{display:"analysis"===C?"flex":"none"},children:[(0,v.jsxs)("div",{className:"mobile-panel-header",children:[(0,v.jsx)(aq,{size:16}),(0,v.jsx)("span",{children:"Analysis"})]}),(0,v.jsx)("div",{className:"mobile-panel-content",children:n})]}),(0,v.jsxs)("div",{className:"mobile-panel mobile-library-panel",style:{display:"library"===C?"flex":"none"},children:[(0,v.jsxs)("div",{className:"mobile-panel-header",children:[(0,v.jsx)(oy,{size:16}),(0,v.jsx)("span",{children:"Library"})]}),(0,v.jsx)("div",{className:"mobile-panel-content",children:t||(0,v.jsx)("div",{className:"placeholder",children:"Library"})})]})]});return(0,v.jsxs)("div",{className:`mobile-layout ${S?"mobile-landscape":"mobile-portrait"} `,children:[(0,v.jsx)("div",{className:"mobile-layout-content",children:e()}),(0,v.jsx)(o6,{activeTab:C,onTabChange:E,showAnalysis:!!n})]})}return(0,v.jsxs)(aT,{direction:"horizontal",id:"main-layout",autoSaveId:"kaya-main-layout",className:"panel-group",children:[(t||n)&&(0,v.jsxs)(v.Fragment,{children:[d?(0,v.jsx)(il,{id:"left-panel",order:1,defaultSize:25,minSize:10,maxSize:50,className:"panel left-panel-container",children:(0,v.jsxs)(aT,{direction:"vertical",id:"left-panel-group",autoSaveId:"kaya-left-panel-group",children:[O.library&&t?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(il,{id:"library-section",order:1,defaultSize:j(O.library),minSize:15,className:"panel library-section",children:(0,v.jsxs)("div",{className:"left-panel-section",children:[(0,v.jsx)(se,{title:y("panels.library"),icon:(0,v.jsx)(oy,{size:14}),isVisible:O.library,onToggle:()=>P("library")}),(0,v.jsx)("div",{className:"left-panel-section-content",children:t})]})}),O.analysisGraph&&n&&(0,v.jsx)(a$,{className:"resize-handle resize-handle-horizontal"})]}):t?(0,v.jsx)("div",{className:"collapsed-section-bar",children:(0,v.jsx)(se,{title:y("panels.library"),icon:(0,v.jsx)(oy,{size:14}),isVisible:!1,onToggle:()=>P("library")})}):null,O.analysisGraph&&n?(0,v.jsx)(il,{id:"analysis-graph-section",order:2,defaultSize:2===z?40:100,minSize:15,className:"panel analysis-graph-section",children:(0,v.jsxs)("div",{className:"left-panel-section",children:[(0,v.jsx)(se,{title:y("panels.analysis"),icon:(0,v.jsx)(aZ,{size:14}),isVisible:O.analysisGraph,onToggle:()=>P("analysisGraph")}),(0,v.jsx)("div",{className:"left-panel-section-content",children:n})]})}):n?(0,v.jsx)("div",{className:"collapsed-section-bar",children:(0,v.jsx)(se,{title:y("panels.analysis"),icon:(0,v.jsx)(aZ,{size:14}),isVisible:!1,onToggle:()=>P("analysisGraph")})}):null]})}):(0,v.jsx)("div",{className:"library-collapsed-indicator",onClick:h,title:y("panels.showLibrary"),children:(0,v.jsx)(oy,{size:16})}),d&&(0,v.jsx)(a$,{className:"resize-handle resize-handle-vertical"})]}),(0,v.jsx)(il,{id:"board-panel",order:2,defaultSize:p?75:100,minSize:30,className:"panel board-panel",children:i||(0,v.jsx)("div",{className:"placeholder",children:"Board Placeholder"})}),p?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(a$,{className:"resize-handle resize-handle-vertical"}),(0,v.jsx)(il,{id:"sidebar-panel",order:3,defaultSize:25,minSize:20,maxSize:50,className:"panel sidebar-panel",children:(0,v.jsxs)(aT,{direction:"vertical",id:"sidebar-group",autoSaveId:"kaya-sidebar-group",children:[I.gameTree?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(il,{id:"game-tree-panel",order:1,defaultSize:M(I.gameTree,"gameTree"),minSize:10,className:"panel game-tree-section",children:(0,v.jsxs)("div",{className:"sidebar-section",children:[(0,v.jsx)(se,{title:y("panels.gameTree"),icon:(0,v.jsx)(ou,{size:14}),isVisible:I.gameTree,onToggle:()=>N("gameTree"),headerActions:l}),(0,v.jsx)("div",{className:"sidebar-section-content",children:a||(0,v.jsx)("div",{className:"placeholder",children:"Tree Placeholder"})})]})}),(I.gameInfo||I.comment)&&(0,v.jsx)(a$,{className:"resize-handle resize-handle-horizontal"})]}):(0,v.jsx)("div",{className:"collapsed-section-bar",children:(0,v.jsx)(se,{title:y("panels.gameTree"),icon:(0,v.jsx)(ou,{size:14}),isVisible:!1,onToggle:()=>N("gameTree")})}),I.gameInfo?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(il,{id:"game-info-panel",order:2,defaultSize:M(I.gameInfo,"gameInfo"),minSize:10,className:"panel game-info-section",children:(0,v.jsxs)("div",{className:"sidebar-section",children:[(0,v.jsx)(se,{title:y("panels.gameInfo"),icon:(0,v.jsx)(oh,{size:14}),isVisible:I.gameInfo,onToggle:()=>N("gameInfo"),headerActions:u}),(0,v.jsx)("div",{className:"sidebar-section-content",children:o||(0,v.jsx)("div",{className:"placeholder",children:"Game Info"})})]})}),I.comment&&(0,v.jsx)(a$,{className:"resize-handle resize-handle-horizontal"})]}):(0,v.jsx)("div",{className:"collapsed-section-bar",children:(0,v.jsx)(se,{title:y("panels.gameInfo"),icon:(0,v.jsx)(oh,{size:14}),isVisible:!1,onToggle:()=>N("gameInfo")})}),I.comment?(0,v.jsx)(il,{id:"comment-panel",order:3,defaultSize:M(I.comment,"comment"),minSize:10,className:"panel comments-section",children:(0,v.jsxs)("div",{className:"sidebar-section",children:[(0,v.jsx)(se,{title:y("panels.comment"),icon:(0,v.jsx)(oS,{size:14}),isVisible:I.comment,onToggle:()=>N("comment"),headerActions:c}),(0,v.jsx)("div",{className:"sidebar-section-content",children:s||(0,v.jsx)("div",{className:"placeholder",children:"Comments"})})]})}):(0,v.jsx)("div",{className:"collapsed-section-bar",children:(0,v.jsx)(se,{title:y("panels.comment"),icon:(0,v.jsx)(oS,{size:14}),isVisible:!1,onToggle:()=>N("comment")})})]})})]}):(0,v.jsx)("div",{className:"sidebar-collapsed-indicator",onClick:f,title:y("panels.showSidebar"),children:(0,v.jsx)(oC,{size:16})})]})},sn=!1,sr=e=>"undefined"!=typeof window?new URL(e,document.baseURI||window.location.href).href:e,si={move:Array.from({length:5},(e,t)=>sr(`assets/move-${t}.mp3`)),capture:Array.from({length:5},(e,t)=>sr(`assets/capture${t}.mp3`)),pass:sr("assets/pass.mp3"),newgame:sr("assets/newgame.mp3")},sa=null,so=new Map,ss=!1,sl=!1,su=null,sc=null,sd=500,sp=new Map,sh=50,sf=0,sg=0,sm=()=>{if(sa)return sa;try{let e=window.AudioContext||window.webkitAudioContext;e&&(sa=new e,sn&&console.log("[SOUND]  AudioContext created"))}catch(e){console.warn("[SOUND]  Failed to create AudioContext:",e)}return sa},sy=async()=>{if(sa&&"suspended"===sa.state)try{await sa.resume(),sn&&console.log("[SOUND]  AudioContext resumed")}catch(e){console.warn("[SOUND]  Failed to resume AudioContext:",e)}},sb=async e=>{let t=sm();if(!t)return null;try{let n=await fetch(e);if(!n.ok)throw Error(`HTTP ${n.status}`);let i=await n.arrayBuffer(),a=await t.decodeAudioData(i);return sn&&console.log(`[SOUND]  Loaded: ${e.split("/").pop()} (${a.duration.toFixed(2)}s)`),a}catch(t){return console.warn(`[SOUND]  Failed to load ${e}:`,t),null}},sv=async()=>{if(sl)return;if(su)return su;ss=!0,sn&&console.log("[SOUND] \uD83D\uDD04 Preloading all sounds...");let e=Object.values(si).flat();return su=Promise.all(e.map(async e=>{let t=await sb(e);t&&so.set(e,t)})).then(()=>{if(sl=!0,ss=!1,sn&&console.log(`[SOUND]  Preloaded ${so.size}/${e.length} sounds`),sc){let e=performance.now()-sc.timestamp;e<sd?(sn&&console.log(`[SOUND]  Playing pending sound after ${Math.round(e)}ms`),sx(sc.path)):sn&&console.log(`[SOUND]  Pending sound expired (${Math.round(e)}ms)`),sc=null}})},sx=e=>{let t=sa;if(!t){sn&&console.warn("[SOUND]  No AudioContext");return}let n=so.get(e);if(!n)return void(ss&&!sc?(sc={path:e,timestamp:performance.now()},sn&&console.log(`[SOUND]  Queued pending sound: ${e.split("/").pop()}`)):sn&&console.warn(`[SOUND]  Buffer not loaded: ${e.split("/").pop()}`));let i=t.createBufferSource();i.buffer=n,i.connect(t.destination),i.start(0),sn&&console.log(`[SOUND]  Playing: ${e.split("/").pop()}`)},sw="kaya-sound-enabled",s_=(()=>{if("undefined"!=typeof window){let e=localStorage.getItem(sw);if(null!==e)return"true"===e}return!0})(),sS=new Set,sk=e=>{s_=e,"undefined"!=typeof window&&localStorage.setItem(sw,String(e)),sS.forEach(e=>e())},sT=!1,sC=()=>{sa&&sl||(sm(),sv(),"undefined"!=typeof document&&(document.removeEventListener("click",sC,!0),document.removeEventListener("keydown",sC,!0),document.removeEventListener("touchstart",sC,!0),document.removeEventListener("mousedown",sC,!0)))};"undefined"==typeof document||sT||(sT=!0,document.addEventListener("click",sC,!0),document.addEventListener("keydown",sC,!0),document.addEventListener("touchstart",sC,!0),document.addEventListener("mousedown",sC,!0));let sE=()=>{let[e,t]=(0,x.useState)(s_);(0,x.useEffect)(()=>{let e=()=>{t(s_)};return sS.add(e),()=>{sS.delete(e)}},[]);let n=(0,x.useCallback)((e,t)=>{if(!s_)return;sy();let n=performance.now(),i=n-(sp.get(e)||0);if(i<sh){sn&&console.log(`[SOUND]  Skipped (debounce: ${Math.round(i)}ms)`);return}sp.set(e,n);let a="";switch(e){case"move":{let e=t??sf;sf=(sf+1)%5,a=si.move[e];break}case"capture":{let e=t??sg;sg=(sg+1)%5,a=si.capture[e];break}case"pass":a=si.pass;break;case"newgame":a=si.newgame}sx(a)},[]);return{soundEnabled:e,toggleSound:(0,x.useCallback)(()=>{sk(!s_)},[]),playSound:n}};var sI=JSON.parse('{"addToLibrary":"Add to Library","landing":{"tagline":"A modern Go game application","continue":"Continue Game","newGame":"New Game","library":"Game Library","dropSgfToOpen":"Drop SGF file to open"},"black":"Black:","boardSettings":"Board Settings","boardSize":"Board Size:","cancel":"Cancel","clickToRename":"Click to rename","commit":"Commit:","confirm":"Confirm","copySgf":"Copy SGF","copySgfToClipboard":"Copy SGF to Clipboard","createGame":"Create Game","darkMode":"Dark Mode","date":"Date:","discard":"Discard","enableSounds":"Enable Sounds","enterFullscreen":"Enter full screen","exitFullscreen":"Exit full screen","exportToDisk":"Export to Disk","extensionNote":"Extension .sgf will be added automatically","filename":"Filename:","game":"Game","gameSgf":"game.sgf","handicap":"Handicap:","hideLibrary":"Hide Library","hideMenu":"Hide Menu","hideSidebar":"Hide Sidebar","home":"Home","komi":"Komi:","language":"Language","learnMore":"Learn more on Sensei\'s Library","libraryRoot":"Library Root","lightMode":"Light Mode","menu":"Menu","moreActions":"More actions","muteSounds":"Mute Sounds","new":"New","newGame":"New Game","newGameEllipsis":"New Game...","open":"Open","openSgf":"Open SGF...","openSgfFile":"Open SGF File","pasteSgf":"Paste SGF","pasteSgfOrOgs":"Paste SGF or OGS URL from Clipboard","pasteSgfUrl":"Paste SGF/URL","patternDisabled":"Pattern matching disabled (click to enable)","patternEnabled":"Pattern matching enabled (click to disable)","playerName":"Player name","players":"Players","quickNewGame":"Quick New Game","rank":"Rank:","rankPlaceholder":"e.g. 5k, 3d","reportBug":"Report a bug or suggest a feature","reportIssue":"Report Issue","save":"Save","saveAs":"Save As...","saveAsShort":"Save As","saveGame":"Save Game","saveToFolder":"Save to folder:","saveToLibrary":"Save to Library","settings":"Settings","showLibrary":"Show Library","showSidebar":"Show Sidebar","startNewGame":"Start New Game?","startNewGameConfirm":"Current game will be lost if not saved. Are you sure you want to start a new game?","switchToDarkMode":"Switch to dark mode","switchToLightMode":"Switch to light mode","unsavedChanges":"Unsaved Changes","version":"Version:","viewCommit":"View commit on GitHub","viewOnGitHub":"View on GitHub","viewVersion":"View version on GitHub","white":"White:","unsavedChangesLost":"You have unsaved changes that will be lost. Continue anyway?","unsavedChangesPrompt":"You have unsaved changes. What would you like to do?","edit":"Edit","export":"Export","copy":"Copy","paste":"Paste","aiConfig":{"title":"Analysis Config","modelLibrary":"Model Library","modelLibraryDescription":"Select a model for AI analysis. Expand to choose quantization level.","active":"Active","recommended":"Recommended","default":"Default","downloaded":"downloaded","customModels":"Custom Models","downloadModel":"Download model","deleteModel":"Delete model to free space","uploadCustomModel":"Upload Custom Model","uploadCustomModelDescription":"Only .onnx models are supported. KataGo weights (.bin.gz or .bin) must be converted first using:","analysisOptions":"Analysis Options","inferenceBackend":"Inference Backend","inferenceBackendDescription":"Choose how the AI model runs. Native is fastest on desktop, WebGPU uses your graphics card, WASM runs on CPU (most compatible).","nativeAuto":"Native - Auto (GPU if available)","nativeCpu":"Native - CPU only","webgpu":"WebGPU (Browser GPU)","wasm":"WASM (Browser CPU)","maxTopMoves":"Max Top Moves","maxTopMovesDescription":"Maximum number of move suggestions to display on the board.","minProbability":"Min Probability","minProbabilityDescription":"Hide moves with probability below this threshold.","saveAnalysisToSgf":"Save Analysis to SGF","saveAnalysisToSgfDescription":"Embed AI analysis data (win rate, score, move suggestions) when saving SGF files. Increases file size but preserves your analysis.","modelUploadedSuccess":"Model uploaded successfully","modelUploadFailed":"Failed to upload model","modelDownloadedSuccess":"Model downloaded successfully","modelDownloadFailed":"Failed to download model","modelDeletedSuccess":"Model deleted","modelDeleteFailed":"Failed to delete model","getStartedTitle":"Get Started with AI Analysis","getStartedDescription":"Download a model to enable AI-powered move suggestions and game analysis.","downloadRecommended":"Download Recommended Model","downloading":"Downloading...","poweredBy":"AI engine powered by"},"kayaConfig":{"title":"Settings","close":"Close settings","analysisTab":"Analysis","gameTab":"Game","boardSettings":"Board Settings","fuzzyStonePlacement":"Fuzzy Stone Placement","fuzzyStonePlacementDescription":"Add slight random offsets to stone positions for a more natural, hand-placed appearance.","on":"On","off":"Off"},"analysis":{"toggleOwnership":"Toggle Ownership Heatmap","toggleTopMoves":"Toggle Top Moves","toggleWinRate":"Toggle Win Rate Graph","toggleScore":"Toggle Score Graph","winRate":"Win Rate","score":"Score","visualizationGroup":"Visualization Options","actionsGroup":"Analysis Actions","analyzeFullGame":"Analyze Full Game","stopAnalysis":"Stop Full Game Analysis","waitingForEngine":"Waiting for engine...","clearCache":"Clear Analysis Cache","clearCacheWithCount":"Clear {{count}} cached analysis results","noCachedAnalysis":"No cached analysis","analysisLegend":"Analysis Legend","positionsAnalyzed":"{{analyzed}} of {{total}} positions analyzed in current branch","initializingEngine":"Initializing Engine...","analyzing":"Analyzing...","stopping":"Stopping...","analyzingProgress":"Analyzing: {{progress}}%","stopAnalysisButton":"Stop analysis","analysisModeOn":"Analysis Mode On - Click to disable","analysisModeOff":"Analysis Mode Off - Click to enable"},"analysisLegend":{"title":"Analysis Legend","policyDescription":"Colors indicate the AI\'s <strong>Policy Probability</strong> for each move suggestion. This represents the neural network\'s confidence that a move is the best choice.","best":"Best","bestProb":"70% probability","great":"Great","greatProb":"60-70%","good":"Good","goodProb":"40-60%","okay":"Okay","okayProb":"10-40%","poor":"Poor","poorProb":"<10%","note":"The current ONNX KataGo implementation provides policy probabilities but does not include win rate or score lead for individual move suggestions. These metrics are only available for the current board position.","heatmapOwnership":"Heatmap Ownership","heatmapDescription":"The ownership heatmap shows the predicted territory control at the end of the game. Brighter colors indicate higher confidence that the area will belong to that player.","blackArea":"Black Area","whiteArea":"White Area"},"library":{"newFolder":"New Folder","importSgfZip":"Import SGF/ZIP","exportLibraryAsZip":"Export Library as ZIP","clearLibrary":"Clear Library","loading":"Loading...","emptyLibrary":"Your library is empty","emptyLibraryHint":"Drop SGF files here or right-click to create a folder","dropToAdd":"Drop to add to Library","itemsSelected":"{{count}} selected","duplicateSelected":"Duplicate selected","downloadSelected":"Download selected","deleteSelected":"Delete selected","clearSelection":"Clear selection","gamesCount":"{{count}} games","foldersCount":"{{count}} folders","deleteFolder":"Delete Folder","deleteFolderConfirm":"Delete folder \\"{{name}}\\" and all its contents?","deleteFile":"Delete File","deleteFileConfirm":"Delete \\"{{name}}\\"?","deleteItemsTitle":"Delete {{count}} Items","deleteItemsConfirm":"Delete {{count}} selected items? This cannot be undone.","clearLibraryTitle":"Clear Library","clearLibraryConfirm":"Delete all {{count}} items from your library? This cannot be undone.","load":"Load","rename":"Rename","duplicate":"Duplicate","download":"Download","moveToRoot":"Move to Root","delete":"Delete","duplicateItems":"Duplicate {{count}} Items","downloadItems":"Download {{count}} Items","deleteItems":"Delete {{count}} Items","create":"Create","unsavedChangesIndicator":"Unsaved changes"},"updater":{"checkForUpdates":"Check for Updates...","updateAvailable":"Update Available","versionAvailable":"Version {{version}} is available.","installing":"Installing update... Please wait.","skipVersion":"Skip this version","remindLater":"Remind me later","updateNow":"Update Now","noUpdateAvailable":"No Update Available","youAreOnLatest":"You are on the latest version.","checkFailed":"Failed to check for updates.","manualDownload":"Manual download:","updateInstalled":"Update Installed","restartPrompt":"The update has been installed. Restart now to apply changes?","restart":"Restart","later":"Later","updateFailed":"Update Failed","updateFailedMessage":"Failed to install the update. Please try again later or download the latest version manually from:"},"editToolbar":{"stones":"Stones","playMode":"Play mode","setupMode":"Setup mode","alternate":"Alternate","blackStone":"Black","black":"Black","whiteStone":"White","white":"White","pass":"Pass","clearSetupStones":"Clear Setup Stones","markers":"Markers","triangle":"Triangle","square":"Square","circle":"Circle","cross":"Cross","labelAlpha":"ABC","labelNum":"123","eraseMarker":"Erase","eraseAll":"Erase All","branch":"Branch","makeMainBranch":"Make Main Branch","copyBranch":"Copy","copy":"Copy","pasteBranch":"Paste","paste":"Paste","deleteCurrentBranch":"Delete Current Branch","deleteOtherBranches":"Delete Other Branches (keep only current path)","history":"History","undo":"Undo","redo":"Redo"},"gameInfo":{"game":"Game","untitled":"Untitled","date":"Date","datePlaceholder":"YYYY-MM-DD","place":"Place","placePlaceholder":"e.g., OGS, KGS","black":"Black","white":"White","blackRank":"Black Rank","whiteRank":"White Rank","rankPlaceholder":"e.g., 5k, 3d","komi":"Komi","komiPlaceholder":"6.5","handicap":"Handicap","handicapPlaceholder":"0","rules":"Rules","rulesPlaceholder":"e.g., Japanese, Chinese","time":"Time","timePlaceholder":"e.g., 900 5x30 byo-yomi","result":"Result","resultPlaceholder":"e.g., B+0.5, W+R","clickToAdd":"Click to add","editHint":"Click any field to edit. Press Enter to save, Escape to cancel.","editAllFields":"Edit all fields","exitEditMode":"Exit edit mode"},"comment":{"move":"Move {{number}}","moveNumber":"Move {{number}}","noMoveSelected":"No move selected","noComment":"No comment. Click to add one.","placeholder":"Enter comment (markdown supported)...","markdownHint":"Tip: Use markdown for formatting. Ctrl/Cmd+S to save, Esc to cancel.","enterHint":"Enter to save  Shift+Enter for new line  Esc to cancel","hint":"Tip: Use markdown for formatting. Ctrl/Cmd+S to save, Esc to cancel.","editComment":"Edit comment","save":"Save","cancel":"Cancel","saveShortcut":"Save (Cmd/Ctrl+S)","cancelShortcut":"Cancel (Esc)"},"gameTree":{"switchToVertical":"Switch to vertical layout","switchToHorizontal":"Switch to horizontal layout","hideMinimap":"Hide minimap","showMinimap":"Show minimap","centerOnPosition":"Center on current position"},"boardControls":{"captured":"captured","branch":"Branch","move":"Move","goToStart":"Go to start (Home)","goToEnd":"Go to end (End)","goBack10":"Go back 10 moves","goForward10":"Go forward 10 moves","previousMove":"Previous move ()","nextMove":"Next move ()","previousBranch":"Previous branch ()","nextBranch":"Next branch ()","clickToJumpMove":"Click to jump to move","clickToSetBranch":"Click to set branch ID","movesIntoBranch":"{{count}} moves into branch","resignGame":"Resign Game","resignConfirm":"{{player}} resigns. Are you sure?","resign":"Resign"},"scoring":{"clear":"Clear","clearAllDeadStones":"Clear all dead stones","territoryBlackTitle":"Black territory","territoryWhiteTitle":"White territory","capturesBlackTitle":"Black captures","capturesWhiteTitle":"White captures","deadStonesBlackTitle":"Black dead stones","deadStonesWhiteTitle":"White dead stones","komiTitle":"Komi (White\'s compensation)","markedAsDead":"{{count}} stone(s) marked as dead","autoEstimate":"Auto-estimate","autoEstimateDescription":"Auto-estimate dead stones using Monte Carlo simulation","estimating":"Estimating...","done":"Done","exitScoringMode":"Exit scoring mode (S)","territory":"Territory:","captures":"Captures:","deadStones":"Dead stones:","komi":"Komi:","total":"Total:","jigo":"Jigo (Draw)","winsBy":"{{player}} wins by {{points}} points","clickToToggle":"Click on stones to toggle dead/alive status","stonesMarkedDead":"{{count}} stone marked as dead","stonesMarkedDeadPlural":"{{count}} stones marked as dead"},"mobileTab":{"board":"Board","info":"Info","tree":"Tree","analysis":"Analysis","library":"Library"},"toast":{"exportedFile":"Exported \\"{{filename}}\\"","savedToLibrary":"Saved to library","savedFileToLibrary":"Saved \\"{{filename}}\\" to library","libraryFileNotFound":"Library file not found, saving as new...","failedToSave":"Failed to save to library","sgfCopied":"SGF copied to clipboard!","failedToCopy":"Failed to copy: {{error}}","clipboardEmpty":"Clipboard is empty","downloadingFromOgs":"Downloading game {{gameId}} from OGS...","gameLoadedFromOgs":"Game loaded from OGS ({{gameId}})!","gameLoadedFromClipboard":"Game loaded from clipboard!","failedToPaste":"Failed to paste: {{error}}","failedToLoadSgf":"Failed to load SGF file: {{error}}"},"loading":{"loadingSgfFile":"Loading SGF File"},"dropzone":{"dropToLoad":"Drop to load game","dropOnLibrary":"Drop on Library to save instead"},"languageSwitcher":{"changeLanguage":"Change language","selectLanguage":"Select Language"},"gameboardActions":{"pass":"Pass","resign":"Resign","score":"Score","scoring":"Scoring","analyze":"Analyze","analysis":"Analysis","navigate":"Navigate","edit":"Edit","show":"Show","hide":"Hide","enterScoringMode":"Enter scoring mode (S)","exitScoringMode":"Exit scoring mode (S)","showAnalysis":"Show analysis bar (A)","hideAnalysis":"Hide analysis bar (A)","analysisActiveHidden":"Analysis mode active (click to show panel)","enterNavigationMode":"Enter navigation mode (N)","exitNavigationMode":"Exit navigation mode (N)","enterEditMode":"Enter edit mode (E)","exitEditMode":"Exit edit mode (E)","showNextMove":"Show next move","hideNextMove":"Hide next move","suggestMove":"Suggest Move","suggestMoveTitle":"Ask AI to suggest a move (G)","suggesting":"Suggesting...","loadAiModelFirst":"Please load an AI model first","initializingAiEngine":"Initializing AI engine...","aiEngineInitializing":"AI engine is initializing, please try again","failedToGenerateMove":"Failed to generate AI move"},"analysisBar":{"uploadingModel":"Uploading model ({{progress}}%)","checkingCache":"Checking cache...","initializing":"Initializing...","loading":"Loading...","analyzing":"Analyzing...","winRate":"Win Rate","blackWinRate":"Black Win Rate","whiteWinRate":"White Win Rate","scoreLead":"Score Lead","analyzeFullGameLong":"Analyze Full Game (may take a few minutes for long games)"},"panels":{"library":"Library","analysis":"Analysis","gameTree":"Game Tree","gameInfo":"Game Info","comment":"Comment","showLibrary":"Show Library (Ctrl+L)","showSidebar":"Show Sidebar (Ctrl+B)"},"quickNewGameTooltip":"Quick New Game ({{size}}\xd7{{size}}) -  Erases current game without saving!","close":"Close","aboutKaya":"About Kaya","aboutDescription":"A beautiful Go game application with AI analysis powered by KataGo","aboutVersion":"Version","aboutCommit":"Commit","aboutBuildDate":"Build Date","aboutLicense":"License","aboutGitHub":"GitHub Repository","aboutReportIssue":"Report an Issue","aboutVersionNotAvailable":"Version information not available"}'),s$=JSON.parse('{"addToLibrary":"","landing":{"tagline":"","continue":"","newGame":"","library":"","dropSgfToOpen":" SGF "},"black":"","boardSettings":"","boardSize":"","cancel":"","clickToRename":"","commit":"","confirm":"","copySgf":" SGF","copySgfToClipboard":" SGF ","createGame":"","darkMode":"","date":"","discard":"","enableSounds":"","enterFullscreen":"","exitFullscreen":"","exportToDisk":"","extensionNote":" .sgf ","filename":"","game":"","gameSgf":"game.sgf","handicap":"","hideLibrary":"","hideMenu":"","hideSidebar":"","home":"","komi":"","language":"","learnMore":" Sensei\'s Library ","libraryRoot":"","lightMode":"","menu":"","moreActions":"","muteSounds":"","new":"","newGame":"","newGameEllipsis":"...","open":"","openSgf":" SGF...","openSgfFile":" SGF ","pasteSgf":" SGF","pasteSgfOrOgs":" SGF  OGS ","pasteSgfUrl":" SGF/","patternDisabled":"","patternEnabled":"","playerName":"","players":"","quickNewGame":"","rank":"","rankPlaceholder":" 5k, 3d","reportBug":"","reportIssue":"","save":"","saveAs":"...","saveAsShort":"","saveGame":"","saveToFolder":"","saveToLibrary":"","settings":"","showLibrary":"","showSidebar":"","startNewGame":"","startNewGameConfirm":"","switchToDarkMode":"","switchToLightMode":"","unsavedChanges":"","version":"","viewCommit":" GitHub ","viewOnGitHub":" GitHub ","viewVersion":" GitHub ","white":"","unsavedChangesLost":"","unsavedChangesPrompt":"","edit":"","export":"","copy":"","paste":"","aiConfig":{"title":"","modelLibrary":"","modelLibraryDescription":" AI ","active":"","recommended":"","default":"","downloaded":"","customModels":"","downloadModel":"","deleteModel":"","uploadCustomModel":"","uploadCustomModelDescription":" .onnx KataGo .bin.gz  .bin","analysisOptions":"","inferenceBackend":"","inferenceBackendDescription":" AI WebGPU WASM  CPU","nativeAuto":" -  GPU","nativeCpu":" -  CPU","webgpu":"WebGPU GPU","wasm":"WASM CPU","maxTopMoves":"","maxTopMovesDescription":"","minProbability":"","minProbabilityDescription":"","saveAnalysisToSgf":" SGF","saveAnalysisToSgfDescription":" SGF  AI ","modelUploadedSuccess":"","modelUploadFailed":"","modelDownloadedSuccess":"","modelDownloadFailed":"","modelDeletedSuccess":"","modelDeleteFailed":"","getStartedTitle":" AI ","getStartedDescription":" AI ","downloadRecommended":"","downloading":"...","poweredBy":"AI "},"kayaConfig":{"title":"","close":"","analysisTab":"","gameTab":"","boardSettings":"","fuzzyStonePlacement":"","fuzzyStonePlacementDescription":"","on":"","off":""},"analysis":{"toggleOwnership":"","toggleTopMoves":"","toggleWinRate":"","toggleScore":"","winRate":"","score":"","visualizationGroup":"","actionsGroup":"","analyzeFullGame":"","stopAnalysis":"","waitingForEngine":"...","clearCache":"","clearCacheWithCount":" {{count}} ","noCachedAnalysis":"","analysisLegend":"","positionsAnalyzed":" {{analyzed}} / {{total}} ","initializingEngine":"...","analyzing":"...","stopping":"...","analyzingProgress":"{{progress}}%","stopAnalysisButton":"","analysisModeOn":" - ","analysisModeOff":" - "},"analysisLegend":{"title":"","policyDescription":" AI <strong></strong>","best":"","bestProb":"70% ","great":"","greatProb":"60-70%","good":"","goodProb":"40-60%","okay":"","okayProb":"10-40%","poor":"","poorProb":"<10%","note":" ONNX KataGo ","heatmapOwnership":"","heatmapDescription":"","blackArea":"","whiteArea":""},"library":{"newFolder":"","importSgfZip":" SGF/ZIP","exportLibraryAsZip":" ZIP","clearLibrary":"","loading":"...","emptyLibrary":"","emptyLibraryHint":" SGF ","dropToAdd":"","itemsSelected":" {{count}} ","duplicateSelected":"","downloadSelected":"","deleteSelected":"","clearSelection":"","gamesCount":"{{count}} ","foldersCount":"{{count}} ","deleteFolder":"","deleteFolderConfirm":"{{name}}","deleteFile":"","deleteFileConfirm":"{{name}}","deleteItemsTitle":" {{count}} ","deleteItemsConfirm":" {{count}} ","clearLibraryTitle":"","clearLibraryConfirm":" {{count}} ","load":"","rename":"","duplicate":"","download":"","moveToRoot":"","delete":"","duplicateItems":" {{count}} ","downloadItems":" {{count}} ","deleteItems":" {{count}} ","create":"","unsavedChangesIndicator":""},"updater":{"checkForUpdates":"...","updateAvailable":"","versionAvailable":" {{version}} ","installing":"...","skipVersion":"","remindLater":"","updateNow":"","noUpdateAvailable":"","youAreOnLatest":"","checkFailed":"","manualDownload":"","updateInstalled":"","restartPrompt":"","restart":"","later":"","updateFailed":"","updateFailedMessage":""},"editToolbar":{"stones":"","playMode":"","setupMode":"","alternate":"","blackStone":"","black":"","whiteStone":"","white":"","pass":"","clearSetupStones":"","markers":"","triangle":"","square":"","circle":"","cross":"","labelAlpha":"ABC","labelNum":"123","eraseMarker":"","eraseAll":"","branch":"","makeMainBranch":"","copyBranch":"","copy":"","pasteBranch":"","paste":"","deleteCurrentBranch":"","deleteOtherBranches":"","history":"","undo":"","redo":""},"gameInfo":{"game":"","untitled":"","date":"","datePlaceholder":"YYYY-MM-DD","place":"","placePlaceholder":" OGSKGS","black":"","white":"","blackRank":"","whiteRank":"","rankPlaceholder":" 53","komi":"","komiPlaceholder":"6.5","handicap":"","handicapPlaceholder":"0","rules":"","rulesPlaceholder":" ","time":"","timePlaceholder":" 900 5x30 ","result":"","resultPlaceholder":" +0.5","clickToAdd":"","editHint":" Enter Escape ","editAllFields":"","exitEditMode":""},"comment":{"move":" {{number}} ","moveNumber":" {{number}} ","noMoveSelected":"","noComment":"","placeholder":" markdown...","markdownHint":" markdown Ctrl/Cmd+S Esc ","enterHint":"Enter   Shift+Enter   Esc ","hint":" markdown Ctrl/Cmd+S Esc ","editComment":"","save":"","cancel":"","saveShortcut":" (Cmd/Ctrl+S)","cancelShortcut":" (Esc)"},"gameTree":{"switchToVertical":"","switchToHorizontal":"","hideMinimap":"","showMinimap":"","centerOnPosition":""},"boardControls":{"captured":"","branch":"","move":"","goToStart":"Home","goToEnd":"End","goBack10":" 10 ","goForward10":" 10 ","previousMove":"","nextMove":"","previousBranch":"","nextBranch":"","clickToJumpMove":"","clickToSetBranch":" ID","movesIntoBranch":" {{count}} ","resignGame":"","resignConfirm":"{{player}} ","resign":""},"scoring":{"clear":"","clearAllDeadStones":"","territoryBlackTitle":"","territoryWhiteTitle":"","capturesBlackTitle":"","capturesWhiteTitle":"","deadStonesBlackTitle":"","deadStonesWhiteTitle":"","komiTitle":"","markedAsDead":"{{count}} ","autoEstimate":"","autoEstimateDescription":"","estimating":"...","done":"","exitScoringMode":"S","territory":"","captures":"","deadStones":"","komi":"","total":"","jigo":"","winsBy":"{{player}}  {{points}} ","clickToToggle":"/","stonesMarkedDead":"{{count}} ","stonesMarkedDeadPlural":"{{count}} "},"mobileTab":{"board":"","info":"","tree":"","analysis":"","library":""},"toast":{"exportedFile":"{{filename}}","savedToLibrary":"","savedFileToLibrary":"{{filename}}","libraryFileNotFound":"...","failedToSave":"","sgfCopied":"SGF ","failedToCopy":"{{error}}","clipboardEmpty":"","downloadingFromOgs":" OGS  {{gameId}}...","gameLoadedFromOgs":" OGS {{gameId}}","gameLoadedFromClipboard":"","failedToPaste":"{{error}}","failedToLoadSgf":" SGF {{error}}"},"loading":{"loadingSgfFile":" SGF "},"dropzone":{"dropToLoad":"","dropOnLibrary":""},"languageSwitcher":{"changeLanguage":"","selectLanguage":""},"gameboardActions":{"pass":"","resign":"","score":"","scoring":"","analyze":"","analysis":"","navigate":"","edit":"","show":"","hide":"","enterScoringMode":" (S)","exitScoringMode":" (S)","showAnalysis":" (A)","hideAnalysis":" (A)","analysisActiveHidden":"","enterNavigationMode":" (N)","exitNavigationMode":" (N)","enterEditMode":" (E)","exitEditMode":" (E)","showNextMove":"","hideNextMove":"","suggestMove":"","suggestMoveTitle":"AI (G)","suggesting":"...","loadAiModelFirst":"AI","initializingAiEngine":"AI...","aiEngineInitializing":"AI","failedToGenerateMove":"AI"},"analysisBar":{"uploadingModel":" ({{progress}}%)","checkingCache":"...","initializing":"...","loading":"...","analyzing":"...","winRate":"","blackWinRate":"","whiteWinRate":"","scoreLead":"","analyzeFullGameLong":""},"panels":{"library":"","analysis":"","gameTree":"","gameInfo":"","comment":"","showLibrary":" (Ctrl+L)","showSidebar":" (Ctrl+B)"},"quickNewGameTooltip":"{{size}}\xd7{{size}}-  ","close":"","aboutKaya":" Kaya","aboutDescription":" KataGo AI ","aboutVersion":"","aboutCommit":"","aboutBuildDate":"","aboutLicense":"","aboutGitHub":"GitHub ","aboutReportIssue":"","aboutVersionNotAvailable":""}'),sO=JSON.parse('{"addToLibrary":" ","landing":{"tagline":"  ","continue":" ","newGame":" ","library":" ","dropSgfToOpen":"SGF   "},"black":":","boardSettings":" ","boardSize":" :","cancel":"","clickToRename":"  ","commit":":","confirm":"","copySgf":"SGF ","copySgfToClipboard":"SGF  ","createGame":" ","darkMode":" ","date":":","discard":"","enableSounds":" ","enterFullscreen":" ","exitFullscreen":"  ","exportToDisk":" ","extensionNote":".sgf   ","filename":":","game":"","gameSgf":"game.sgf","handicap":":","hideLibrary":" ","hideMenu":" ","hideSidebar":" ","home":"","komi":":","language":"","learnMore":"Sensei\'s Library  ","libraryRoot":" ","lightMode":" ","menu":"","moreActions":"","muteSounds":" ","new":"","newGame":" ","newGameEllipsis":" ...","open":"","openSgf":"SGF ...","openSgfFile":"SGF  ","pasteSgf":"SGF ","pasteSgfOrOgs":"SGF  OGS URL ","pasteSgfUrl":"SGF/URL ","patternDisabled":"   ( )","patternEnabled":"   ( )","playerName":" ","players":"","quickNewGame":"  ","rank":"/:","rankPlaceholder":": 5, 3","reportBug":"    ","reportIssue":" ","save":"","saveAs":" ...","saveAsShort":" ","saveGame":" ","saveToFolder":" :","saveToLibrary":" ","settings":"","showLibrary":" ","showSidebar":" ","startNewGame":"  ?","startNewGameConfirm":"    .   ?","switchToDarkMode":"  ","switchToLightMode":"  ","unsavedChanges":"  ","version":":","viewCommit":"GitHub  ","viewOnGitHub":"GitHub ","viewVersion":"GitHub  ","white":":","unsavedChangesLost":"   . ?","unsavedChangesPrompt":"   .  ?","edit":"","export":"","copy":"","paste":"","aiConfig":{"title":" ","modelLibrary":" ","modelLibraryDescription":"AI    .    .","active":"","recommended":"","default":"","downloaded":"","customModels":"  ","downloadModel":" ","deleteModel":" ","uploadCustomModel":"  ","uploadCustomModelDescription":".onnx  . KataGo (.bin.gz  .bin)   :","analysisOptions":" ","inferenceBackend":" ","inferenceBackendDescription":"AI    .   , WebGPU GPU , WASM CPU(  ).","nativeAuto":" -  (GPU   )","nativeCpu":" - CPU","webgpu":"WebGPU ( GPU)","wasm":"WASM ( CPU)","maxTopMoves":"   ","maxTopMovesDescription":"     .","minProbability":" ","minProbabilityDescription":"     .","saveAnalysisToSgf":" SGF ","saveAnalysisToSgfDescription":"SGF   AI  (, ,  ) .      .","modelUploadedSuccess":"  ","modelUploadFailed":"  ","modelDownloadedSuccess":"  ","modelDownloadFailed":"  ","modelDeletedSuccess":"  ","modelDeleteFailed":"  ","getStartedTitle":"AI  ","getStartedDescription":"  AI       .","downloadRecommended":"  ","downloading":" ...","poweredBy":"AI :"},"kayaConfig":{"title":"","close":" ","analysisTab":"","gameTab":"","boardSettings":" ","fuzzyStonePlacement":" ","fuzzyStonePlacementDescription":"           .","on":"","off":""},"analysis":{"toggleOwnership":"  ","toggleTopMoves":"  ","toggleWinRate":"  ","toggleScore":"  ","winRate":"","score":"","visualizationGroup":" ","actionsGroup":" ","analyzeFullGame":"  ","stopAnalysis":"   ","waitingForEngine":"  ...","clearCache":"  ","clearCacheWithCount":"  {{count}} ","noCachedAnalysis":"  ","analysisLegend":" ","positionsAnalyzed":"  {{analyzed}}/{{total}}  ","initializingEngine":"  ...","analyzing":" ...","stopping":" ...","analyzingProgress":" : {{progress}}%","stopAnalysisButton":" ","analysisModeOn":"   -  ","analysisModeOff":"   -  "},"analysisLegend":{"title":" ","policyDescription":" AI     <strong> </strong> .      .","best":"","bestProb":"70% ","great":"","greatProb":"60-70%","good":"","goodProb":"40-60%","okay":"","okayProb":"10-40%","poor":"","poorProb":"<10%","note":" ONNX KataGo    ,       .      .","heatmapOwnership":" ","heatmapDescription":"      .       .","blackArea":" ","whiteArea":" "},"library":{"newFolder":" ","importSgfZip":"SGF/ZIP ","exportLibraryAsZip":" ZIP ","clearLibrary":" ","loading":" ...","emptyLibrary":"  ","emptyLibraryHint":"SGF     ","dropToAdd":"  ","itemsSelected":"{{count}} ","duplicateSelected":"  ","downloadSelected":"  ","deleteSelected":"  ","clearSelection":" ","gamesCount":"{{count}} ","foldersCount":"{{count}} ","deleteFolder":" ","deleteFolderConfirm":" \\"{{name}}\\"   ?","deleteFile":" ","deleteFileConfirm":"\\"{{name}}\\" ?","deleteItemsTitle":"{{count}} ","deleteItemsConfirm":" {{count}} ?     .","clearLibraryTitle":" ","clearLibraryConfirm":" {{count}}   ?     .","load":"","rename":" ","duplicate":"","download":"","moveToRoot":" ","delete":"","duplicateItems":"{{count}} ","downloadItems":"{{count}} ","deleteItems":"{{count}} ","create":"","unsavedChangesIndicator":"  "},"updater":{"checkForUpdates":" ...","updateAvailable":" ","versionAvailable":" {{version}}()   .","installing":"  ...  .","skipVersion":"  ","remindLater":" ","updateNow":" ","noUpdateAvailable":" ","youAreOnLatest":"   .","checkFailed":"  .","manualDownload":" :","updateInstalled":" ","restartPrompt":" .   ?","restart":"","later":"","updateFailed":" ","updateFailedMessage":"  .       :"},"editToolbar":{"stones":"","playMode":" ","setupMode":" ","alternate":"","blackStone":"","black":"","whiteStone":"","white":"","pass":"","clearSetupStones":"  ","markers":"","triangle":"","square":"","circle":"","cross":"\xd7","labelAlpha":"ABC","labelNum":"123","eraseMarker":"","eraseAll":" ","branch":"","makeMainBranch":" ","copyBranch":"","copy":"","pasteBranch":"","paste":"","deleteCurrentBranch":"  ","deleteOtherBranches":"   (  )","history":"","undo":" ","redo":" "},"gameInfo":{"game":"","untitled":" ","date":"","datePlaceholder":"YYYY-MM-DD","place":"","placePlaceholder":": OGS, KGS","black":"","white":"","blackRank":" /","whiteRank":" /","rankPlaceholder":": 5, 3","komi":"","komiPlaceholder":"6.5","handicap":"","handicapPlaceholder":"0","rules":"","rulesPlaceholder":":  ,  ","time":"","timePlaceholder":": 900 5x30 ","result":"","resultPlaceholder":": +0.5,  ","clickToAdd":" ","editHint":"  . Enter , Esc .","editAllFields":"  ","exitEditMode":"  "},"comment":{"move":"{{number}} ","moveNumber":"{{number}} ","noMoveSelected":"  ","noComment":" .  .","placeholder":"  ( )...","markdownHint":":    . Ctrl/Cmd+S , Esc .","enterHint":"Enter   Shift+Enter    Esc ","hint":":    . Ctrl/Cmd+S , Esc .","editComment":" ","save":"","cancel":"","saveShortcut":" (Cmd/Ctrl+S)","cancelShortcut":" (Esc)"},"gameTree":{"switchToVertical":"  ","switchToHorizontal":"  ","hideMinimap":" ","showMinimap":" ","centerOnPosition":"  "},"boardControls":{"captured":" ","branch":"","move":"","goToStart":" (Home)","goToEnd":" (End)","goBack10":"10 ","goForward10":"10 ","previousMove":"  ()","nextMove":"  ()","previousBranch":"  ()","nextBranch":"  ()","clickToJumpMove":"   ","clickToSetBranch":"  ID ","movesIntoBranch":"  {{count}}","resignGame":"","resignConfirm":"{{player}}() . ?","resign":""},"scoring":{"clear":"","clearAllDeadStones":"   ","territoryBlackTitle":" ","territoryWhiteTitle":" ","capturesBlackTitle":"  ","capturesWhiteTitle":"  ","deadStonesBlackTitle":"  ","deadStonesWhiteTitle":"  ","komiTitle":" ( )","markedAsDead":"{{count}}    ","autoEstimate":" ","autoEstimateDescription":"     ","estimating":" ...","done":"","exitScoringMode":"   (S)","territory":":","captures":" :","deadStones":" :","komi":":","total":":","jigo":"","winsBy":"{{player}} {{points}} ","clickToToggle":"   ","stonesMarkedDead":"{{count}}    ","stonesMarkedDeadPlural":"{{count}}    "},"mobileTab":{"board":"","info":"","tree":"","analysis":"","library":""},"toast":{"exportedFile":"\\"{{filename}}\\"  ","savedToLibrary":" ","savedFileToLibrary":"\\"{{filename}}\\"()  ","libraryFileNotFound":"    .   ...","failedToSave":"  ","sgfCopied":"SGF  !","failedToCopy":" : {{error}}","clipboardEmpty":"  ","downloadingFromOgs":"OGS  {{gameId}}  ...","gameLoadedFromOgs":"OGS   ({{gameId}})!","gameLoadedFromClipboard":"  !","failedToPaste":" : {{error}}","failedToLoadSgf":"SGF   : {{error}}"},"loading":{"loadingSgfFile":"SGF   "},"dropzone":{"dropToLoad":"  ","dropOnLibrary":"  "},"languageSwitcher":{"changeLanguage":" ","selectLanguage":" "},"gameboardActions":{"pass":"","resign":"","score":"","scoring":" ","analyze":"","analysis":"","navigate":"","edit":"","show":"","hide":"","enterScoringMode":"   (S)","exitScoringMode":"   (S)","showAnalysis":"   (A)","hideAnalysis":"   (A)","analysisActiveHidden":"   (  )","enterNavigationMode":"   (N)","exitNavigationMode":"   (N)","enterEditMode":"   (E)","exitEditMode":"   (E)","showNextMove":"  ","hideNextMove":"  ","suggestMove":" ","suggestMoveTitle":"AI    (G)","suggesting":" ...","loadAiModelFirst":" AI   ","initializingAiEngine":"AI   ...","aiEngineInitializing":"AI   .   ","failedToGenerateMove":"AI   "},"analysisBar":{"uploadingModel":"   ({{progress}}%)","checkingCache":"  ...","initializing":" ...","loading":" ...","analyzing":" ...","winRate":"","blackWinRate":" ","whiteWinRate":" ","scoreLead":"","analyzeFullGameLong":"   (    )"},"panels":{"library":"","analysis":"","gameTree":" ","gameInfo":" ","comment":"","showLibrary":"  (Ctrl+L)","showSidebar":"  (Ctrl+B)"},"quickNewGameTooltip":"   ({{size}}\xd7{{size}}) -      !","close":"","aboutKaya":"Kaya ","aboutDescription":"KataGo  AI     ","aboutVersion":"","aboutCommit":"","aboutBuildDate":" ","aboutLicense":"","aboutGitHub":"GitHub ","aboutReportIssue":" ","aboutVersionNotAvailable":"    "}'),sA=JSON.parse('{"addToLibrary":"","landing":{"tagline":"","continue":"","newGame":"","library":"","dropSgfToOpen":"SGF"},"black":":","boardSettings":"","boardSize":":","cancel":"","clickToRename":"","commit":":","confirm":"","copySgf":"SGF","copySgfToClipboard":"SGF","createGame":"","darkMode":"","date":":","discard":"","enableSounds":"","enterFullscreen":"","exitFullscreen":"","exportToDisk":"","extensionNote":".sgf","filename":":","game":"","gameSgf":"game.sgf","handicap":":","hideLibrary":"","hideMenu":"","hideSidebar":"","home":"","komi":":","language":"","learnMore":"Sensei\'s Library","libraryRoot":"","lightMode":"","menu":"","moreActions":"","muteSounds":"","new":"","newGame":"","newGameEllipsis":"...","open":"","openSgf":"SGF...","openSgfFile":"SGF","pasteSgf":"SGF","pasteSgfOrOgs":"SGFOGS URL","pasteSgfUrl":"SGF/URL","patternDisabled":"","patternEnabled":"","playerName":"","players":"","quickNewGame":"","rank":":","rankPlaceholder":": 5, 3","reportBug":"","reportIssue":"","save":"","saveAs":"...","saveAsShort":"","saveGame":"","saveToFolder":":","saveToLibrary":"","settings":"","showLibrary":"","showSidebar":"","startNewGame":"","startNewGameConfirm":"","switchToDarkMode":"","switchToLightMode":"","unsavedChanges":"","version":":","viewCommit":"GitHub","viewOnGitHub":"GitHub","viewVersion":"GitHub","white":":","unsavedChangesLost":"","unsavedChangesPrompt":"","edit":"","export":"","copy":"","paste":"","aiConfig":{"title":"","modelLibrary":"","modelLibraryDescription":"AI","active":"","recommended":"","default":"","downloaded":"","customModels":"","downloadModel":"","deleteModel":"","uploadCustomModel":"","uploadCustomModelDescription":".onnxKataGo.bin.gz.bin:","analysisOptions":"","inferenceBackend":"","inferenceBackendDescription":"AIWebGPUGPUWASMCPU","nativeAuto":" - GPU","nativeCpu":" - CPU","webgpu":"WebGPUGPU","wasm":"WASMCPU","maxTopMoves":"","maxTopMovesDescription":"","minProbability":"","minProbabilityDescription":"","saveAnalysisToSgf":"SGF","saveAnalysisToSgfDescription":"SGFAI","modelUploadedSuccess":"","modelUploadFailed":"","modelDownloadedSuccess":"","modelDownloadFailed":"","modelDeletedSuccess":"","modelDeleteFailed":"","getStartedTitle":"AI","getStartedDescription":"AI","downloadRecommended":"","downloading":"...","poweredBy":"AI:"},"kayaConfig":{"title":"","close":"","analysisTab":"","gameTab":"","boardSettings":"","fuzzyStonePlacement":"","fuzzyStonePlacementDescription":"","on":"","off":""},"analysis":{"toggleOwnership":"","toggleTopMoves":"","toggleWinRate":"","toggleScore":"","winRate":"","score":"","visualizationGroup":"","actionsGroup":"","analyzeFullGame":"","stopAnalysis":"","waitingForEngine":"...","clearCache":"","clearCacheWithCount":"{{count}}","noCachedAnalysis":"","analysisLegend":"","positionsAnalyzed":"{{analyzed}}/{{total}}","initializingEngine":"...","analyzing":"...","stopping":"...","analyzingProgress":": {{progress}}%","stopAnalysisButton":"","analysisModeOn":" - ","analysisModeOff":" - "},"analysisLegend":{"title":"","policyDescription":"AI<strong></strong>","best":"","bestProb":"70%","great":"","greatProb":"60-70%","good":"","goodProb":"40-60%","okay":"","okayProb":"10-40%","poor":"","poorProb":"<10%","note":"ONNX KataGo","heatmapOwnership":"","heatmapDescription":"","blackArea":"","whiteArea":""},"library":{"newFolder":"","importSgfZip":"SGF/ZIP","exportLibraryAsZip":"ZIP","clearLibrary":"","loading":"...","emptyLibrary":"","emptyLibraryHint":"SGF","dropToAdd":"","itemsSelected":"{{count}}","duplicateSelected":"","downloadSelected":"","deleteSelected":"","clearSelection":"","gamesCount":"{{count}}","foldersCount":"{{count}}","deleteFolder":"","deleteFolderConfirm":"{{name}}","deleteFile":"","deleteFileConfirm":"{{name}}","deleteItemsTitle":"{{count}}","deleteItemsConfirm":"{{count}}","clearLibraryTitle":"","clearLibraryConfirm":"{{count}}","load":"","rename":"","duplicate":"","download":"","moveToRoot":"","delete":"","duplicateItems":"{{count}}","downloadItems":"{{count}}","deleteItems":"{{count}}","create":"","unsavedChangesIndicator":""},"updater":{"checkForUpdates":"...","updateAvailable":"","versionAvailable":" {{version}} ","installing":"...","skipVersion":"","remindLater":"","updateNow":"","noUpdateAvailable":"","youAreOnLatest":"","checkFailed":"","manualDownload":"","updateInstalled":"","restartPrompt":"","restart":"","later":"","updateFailed":"","updateFailedMessage":""},"editToolbar":{"stones":"","playMode":"","setupMode":"","alternate":"","blackStone":"","black":"","whiteStone":"","white":"","pass":"","clearSetupStones":"","markers":"","triangle":"","square":"","circle":"","cross":"\xd7","labelAlpha":"ABC","labelNum":"123","eraseMarker":"","eraseAll":"","branch":"","makeMainBranch":"","copyBranch":"","copy":"","pasteBranch":"","paste":"","deleteCurrentBranch":"","deleteOtherBranches":"","history":"","undo":"","redo":""},"gameInfo":{"game":"","untitled":"","date":"","datePlaceholder":"YYYY-MM-DD","place":"","placePlaceholder":": OGS, KGS","black":"","white":"","blackRank":"","whiteRank":"","rankPlaceholder":": 5, 3","komi":"","komiPlaceholder":"6.5","handicap":"","handicapPlaceholder":"0","rules":"","rulesPlaceholder":": , ","time":"","timePlaceholder":": 900 5x30 ","result":"","resultPlaceholder":": +0.5, ","clickToAdd":"","editHint":"EnterEsc","editAllFields":"","exitEditMode":""},"comment":{"move":"{{number}}","moveNumber":"{{number}}","noMoveSelected":"","noComment":"","placeholder":"markdown...","markdownHint":": markdownCtrl/Cmd+SEsc","enterHint":"Enter  Shift+Enter  Esc","hint":": markdownCtrl/Cmd+SEsc","editComment":"","save":"","cancel":"","saveShortcut":" (Cmd/Ctrl+S)","cancelShortcut":" (Esc)"},"gameTree":{"switchToVertical":"","switchToHorizontal":"","hideMinimap":"","showMinimap":"","centerOnPosition":""},"boardControls":{"captured":"","branch":"","move":"","goToStart":"Home","goToEnd":"End","goBack10":"10","goForward10":"10","previousMove":"","nextMove":"","previousBranch":"","nextBranch":"","clickToJumpMove":"","clickToSetBranch":"ID","movesIntoBranch":"{{count}}","resignGame":"","resignConfirm":"{{player}}","resign":""},"scoring":{"clear":"","clearAllDeadStones":"","territoryBlackTitle":"","territoryWhiteTitle":"","capturesBlackTitle":"","capturesWhiteTitle":"","deadStonesBlackTitle":"","deadStonesWhiteTitle":"","komiTitle":"","markedAsDead":"{{count}}","autoEstimate":"","autoEstimateDescription":"","estimating":"...","done":"","exitScoringMode":"S","territory":":","captures":":","deadStones":":","komi":":","total":":","jigo":"","winsBy":"{{player}}{{points}}","clickToToggle":"","stonesMarkedDead":"{{count}}","stonesMarkedDeadPlural":"{{count}}"},"mobileTab":{"board":"","info":"","tree":"","analysis":"","library":""},"toast":{"exportedFile":"{{filename}}","savedToLibrary":"","savedFileToLibrary":"{{filename}}","libraryFileNotFound":"...","failedToSave":"","sgfCopied":"SGF","failedToCopy":": {{error}}","clipboardEmpty":"","downloadingFromOgs":"OGS{{gameId}}...","gameLoadedFromOgs":"OGS{{gameId}}","gameLoadedFromClipboard":"","failedToPaste":": {{error}}","failedToLoadSgf":"SGF: {{error}}"},"loading":{"loadingSgfFile":"SGF"},"dropzone":{"dropToLoad":"","dropOnLibrary":""},"languageSwitcher":{"changeLanguage":"","selectLanguage":""},"gameboardActions":{"pass":"","resign":"","score":"","scoring":"","analyze":"","analysis":"","navigate":"","edit":"","show":"","hide":"","enterScoringMode":" (S)","exitScoringMode":" (S)","showAnalysis":" (A)","hideAnalysis":" (A)","analysisActiveHidden":"","enterNavigationMode":" (N)","exitNavigationMode":" (N)","enterEditMode":" (E)","exitEditMode":" (E)","showNextMove":"","hideNextMove":"","suggestMove":"","suggestMoveTitle":"AI (G)","suggesting":"...","loadAiModelFirst":"AI","initializingAiEngine":"AI...","aiEngineInitializing":"AI","failedToGenerateMove":"AI"},"analysisBar":{"uploadingModel":" ({{progress}}%)","checkingCache":"...","initializing":"...","loading":"...","analyzing":"...","winRate":"","blackWinRate":"","whiteWinRate":"","scoreLead":"","analyzeFullGameLong":""},"panels":{"library":"","analysis":"","gameTree":"","gameInfo":"","comment":"","showLibrary":" (Ctrl+L)","showSidebar":" (Ctrl+B)"},"quickNewGameTooltip":"{{size}}\xd7{{size}}-  ","close":"","aboutKaya":"Kaya","aboutDescription":"KataGoAI","aboutVersion":"","aboutCommit":"","aboutBuildDate":"","aboutLicense":"","aboutGitHub":"GitHub","aboutReportIssue":"","aboutVersionNotAvailable":""}'),sN=JSON.parse('{"addToLibrary":"Ajouter","landing":{"tagline":"Une application de Go moderne","continue":"Continuer","newGame":"Nouvelle partie","library":"Biblioth\xe8que","dropSgfToOpen":"D\xe9poser un fichier SGF"},"black":"Noir :","boardSettings":"Param\xe8tres","boardSize":"Taille :","cancel":"Annuler","clickToRename":"Cliquer pour renommer","commit":"Commit :","confirm":"Confirmer","copySgf":"Copier SGF","copySgfToClipboard":"Copier le SGF","createGame":"Cr\xe9er","darkMode":"Mode sombre","date":"Date :","discard":"Abandonner","enableSounds":"Activer sons","enterFullscreen":"Plein \xe9cran","exitFullscreen":"Quitter plein \xe9cran","exportToDisk":"Exporter","extensionNote":"Extension .sgf ajout\xe9e automatiquement","filename":"Fichier :","game":"Partie","gameSgf":"partie.sgf","handicap":"Handicap :","hideLibrary":"Masquer","hideMenu":"Masquer menu","hideSidebar":"Masquer","home":"Accueil","komi":"Komi :","language":"Langue","learnMore":"En savoir plus","libraryRoot":"Biblioth\xe8que","lightMode":"Mode clair","menu":"Menu","moreActions":"Plus","muteSounds":"Couper sons","new":"Nouveau","newGame":"Nouvelle partie","newGameEllipsis":"Nouvelle partie...","open":"Ouvrir","openSgf":"Ouvrir SGF...","openSgfFile":"Ouvrir fichier SGF","pasteSgf":"Coller SGF","pasteSgfOrOgs":"Coller SGF ou URL OGS","pasteSgfUrl":"Coller SGF/URL","patternDisabled":"Motifs d\xe9sactiv\xe9s","patternEnabled":"Motifs activ\xe9s","playerName":"Nom du joueur","players":"Joueurs","quickNewGame":"Partie rapide","rank":"Rang :","rankPlaceholder":"ex. 5k, 3d","reportBug":"Signaler un bug","reportIssue":"Signaler","save":"Sauver","saveAs":"Enregistrer sous...","saveAsShort":"Enr. sous","saveGame":"Sauvegarder","saveToFolder":"Dossier :","saveToLibrary":"Sauver","settings":"Param\xe8tres","showLibrary":"Biblioth\xe8que","showSidebar":"Afficher","startNewGame":"Nouvelle partie ?","startNewGameConfirm":"La partie sera perdue si non sauvegard\xe9e. Continuer ?","switchToDarkMode":"Mode sombre","switchToLightMode":"Mode clair","unsavedChanges":"Non sauvegard\xe9","version":"Version :","viewCommit":"Voir commit","viewOnGitHub":"GitHub","viewVersion":"Voir version","white":"Blanc :","unsavedChangesLost":"Modifications non sauvegard\xe9es. Continuer ?","unsavedChangesPrompt":"Modifications non sauvegard\xe9es. Que faire ?","edit":"\xc9diter","export":"Exporter","copy":"Copier","paste":"Coller","aiConfig":{"title":"Configuration de l\'analyse","modelLibrary":"Biblioth\xe8que de mod\xe8les","modelLibraryDescription":"S\xe9lectionnez un mod\xe8le pour l\'analyse IA. D\xe9veloppez pour choisir le niveau de quantification.","active":"Actif","recommended":"Recommand\xe9","default":"Par d\xe9faut","downloaded":"t\xe9l\xe9charg\xe9(s)","customModels":"Mod\xe8les personnalis\xe9s","downloadModel":"T\xe9l\xe9charger le mod\xe8le","deleteModel":"Supprimer le mod\xe8le","uploadCustomModel":"Importer un mod\xe8le","uploadCustomModelDescription":"Seuls les mod\xe8les .onnx sont pris en charge. Les poids KataGo (.bin.gz ou .bin) doivent d\'abord \xeatre convertis avec :","analysisOptions":"Options d\'analyse","inferenceBackend":"Backend d\'inf\xe9rence","inferenceBackendDescription":"Choisissez comment le mod\xe8le s\'ex\xe9cute. Natif est le plus rapide, WebGPU utilise la carte graphique, WASM fonctionne sur CPU.","nativeAuto":"Natif - Auto (GPU si disponible)","nativeCpu":"Natif - CPU uniquement","webgpu":"WebGPU (GPU navigateur)","wasm":"WASM (CPU navigateur)","maxTopMoves":"Coups max affich\xe9s","maxTopMovesDescription":"Nombre maximum de suggestions de coups \xe0 afficher.","minProbability":"Probabilit\xe9 min","minProbabilityDescription":"Masquer les coups avec une probabilit\xe9 inf\xe9rieure.","saveAnalysisToSgf":"Sauver l\'analyse dans le SGF","saveAnalysisToSgfDescription":"Int\xe9grer les donn\xe9es d\'analyse IA lors de la sauvegarde. Augmente la taille du fichier.","modelUploadedSuccess":"Mod\xe8le import\xe9 avec succ\xe8s","modelUploadFailed":"\xc9chec de l\'import du mod\xe8le","modelDownloadedSuccess":"Mod\xe8le t\xe9l\xe9charg\xe9 avec succ\xe8s","modelDownloadFailed":"\xc9chec du t\xe9l\xe9chargement","modelDeletedSuccess":"Mod\xe8le supprim\xe9","modelDeleteFailed":"\xc9chec de la suppression","getStartedTitle":"D\xe9marrer l\'analyse IA","getStartedDescription":"T\xe9l\xe9chargez un mod\xe8le pour activer les suggestions de coups et l\'analyse de partie par l\'IA.","downloadRecommended":"T\xe9l\xe9charger le mod\xe8le recommand\xe9","downloading":"T\xe9l\xe9chargement...","poweredBy":"Moteur IA bas\xe9 sur"},"kayaConfig":{"title":"Param\xe8tres","close":"Fermer les param\xe8tres","analysisTab":"Analyse","gameTab":"Jeu","boardSettings":"Param\xe8tres du plateau","fuzzyStonePlacement":"Placement flou des pierres","fuzzyStonePlacementDescription":"Ajoute de l\xe9g\xe8res variations al\xe9atoires \xe0 la position des pierres pour un aspect plus naturel.","on":"Activ\xe9","off":"D\xe9sactiv\xe9"},"analysis":{"toggleOwnership":"Afficher/masquer la carte de territoire","toggleTopMoves":"Afficher/masquer les meilleurs coups","toggleWinRate":"Afficher/masquer le taux de victoire","toggleScore":"Afficher/masquer le score","winRate":"Taux de victoire","score":"Score","visualizationGroup":"Options de visualisation","actionsGroup":"Actions d\'analyse","analyzeFullGame":"Analyser la partie enti\xe8re","stopAnalysis":"Arr\xeater l\'analyse","waitingForEngine":"En attente du moteur...","clearCache":"Vider le cache d\'analyse","clearCacheWithCount":"Vider {{count}} r\xe9sultats en cache","noCachedAnalysis":"Pas d\'analyse en cache","analysisLegend":"L\xe9gende d\'analyse","positionsAnalyzed":"{{analyzed}} / {{total}} positions analys\xe9es","initializingEngine":"Initialisation du moteur...","analyzing":"Analyse en cours...","stopping":"Arr\xeat...","analyzingProgress":"Analyse : {{progress}}%","stopAnalysisButton":"Arr\xeater l\'analyse","analysisModeOn":"Mode analyse activ\xe9 - Cliquer pour d\xe9sactiver","analysisModeOff":"Mode analyse d\xe9sactiv\xe9 - Cliquer pour activer"},"analysisLegend":{"title":"L\xe9gende d\'analyse","policyDescription":"Les couleurs indiquent la <strong>probabilit\xe9</strong> de chaque coup sugg\xe9r\xe9 selon le r\xe9seau de neurones.","best":"Meilleur","bestProb":"70%","great":"Excellent","greatProb":"60-70%","good":"Bon","goodProb":"40-60%","okay":"Correct","okayProb":"10-40%","poor":"Faible","poorProb":"<10%","note":"L\'impl\xe9mentation ONNX fournit les probabilit\xe9s mais pas le taux de victoire ni l\'avantage au score pour chaque coup.","heatmapOwnership":"Carte de territoire","heatmapDescription":"La carte montre le territoire pr\xe9dit en fin de partie. Les couleurs vives indiquent une plus grande certitude.","blackArea":"Zone noire","whiteArea":"Zone blanche"},"library":{"newFolder":"Nouveau dossier","importSgfZip":"Importer SGF/ZIP","exportLibraryAsZip":"Exporter en ZIP","clearLibrary":"Vider la biblioth\xe8que","loading":"Chargement...","emptyLibrary":"Votre biblioth\xe8que est vide","emptyLibraryHint":"D\xe9posez des fichiers SGF ici ou clic droit pour cr\xe9er un dossier","dropToAdd":"D\xe9poser pour ajouter","itemsSelected":"{{count}} s\xe9lectionn\xe9(s)","duplicateSelected":"Dupliquer la s\xe9lection","downloadSelected":"T\xe9l\xe9charger la s\xe9lection","deleteSelected":"Supprimer la s\xe9lection","clearSelection":"D\xe9s\xe9lectionner","gamesCount":"{{count}} parties","foldersCount":"{{count}} dossiers","deleteFolder":"Supprimer le dossier","deleteFolderConfirm":"Supprimer le dossier \\"{{name}}\\" et tout son contenu ?","deleteFile":"Supprimer le fichier","deleteFileConfirm":"Supprimer \\"{{name}}\\" ?","deleteItemsTitle":"Supprimer {{count}} \xe9l\xe9ments","deleteItemsConfirm":"Supprimer {{count}} \xe9l\xe9ments ? Cette action est irr\xe9versible.","clearLibraryTitle":"Vider la biblioth\xe8que","clearLibraryConfirm":"Supprimer les {{count}} \xe9l\xe9ments ? Cette action est irr\xe9versible.","load":"Charger","rename":"Renommer","duplicate":"Dupliquer","download":"T\xe9l\xe9charger","moveToRoot":"D\xe9placer \xe0 la racine","delete":"Supprimer","duplicateItems":"Dupliquer {{count}} \xe9l\xe9ments","downloadItems":"T\xe9l\xe9charger {{count}} \xe9l\xe9ments","deleteItems":"Supprimer {{count}} \xe9l\xe9ments","create":"Cr\xe9er","unsavedChangesIndicator":"Modifications non sauvegard\xe9es"},"updater":{"checkForUpdates":"Rechercher les mises \xe0 jour...","updateAvailable":"Mise \xe0 jour disponible","versionAvailable":"La version {{version}} est disponible.","installing":"Installation en cours...","skipVersion":"Ignorer cette version","remindLater":"Me rappeler plus tard","updateNow":"Mettre \xe0 jour","noUpdateAvailable":"Pas de mise \xe0 jour","youAreOnLatest":"Vous avez la derni\xe8re version.","checkFailed":"\xc9chec de la v\xe9rification.","manualDownload":"T\xe9l\xe9chargement manuel :","updateInstalled":"Mise \xe0 jour install\xe9e","restartPrompt":"La mise \xe0 jour a \xe9t\xe9 install\xe9e. Red\xe9marrer maintenant ?","restart":"Red\xe9marrer","later":"Plus tard","updateFailed":"\xc9chec de la mise \xe0 jour","updateFailedMessage":"\xc9chec de l\'installation. T\xe9l\xe9chargez manuellement depuis :"},"editToolbar":{"stones":"Pierres","playMode":"Mode jeu","setupMode":"Mode placement","alternate":"Alterner","blackStone":"Noir","black":"Noir","whiteStone":"Blanc","white":"Blanc","pass":"Passer","clearSetupStones":"Effacer les pierres","markers":"Marqueurs","triangle":"Triangle","square":"Carr\xe9","circle":"Cercle","cross":"Croix","labelAlpha":"ABC","labelNum":"123","eraseMarker":"Effacer","eraseAll":"Tout effacer","branch":"Branche","makeMainBranch":"D\xe9finir comme branche principale","copyBranch":"Copier","copy":"Copier","pasteBranch":"Coller","paste":"Coller","deleteCurrentBranch":"Supprimer cette branche","deleteOtherBranches":"Supprimer les autres branches","history":"Historique","undo":"Annuler","redo":"R\xe9tablir"},"gameInfo":{"game":"Partie","untitled":"Sans titre","date":"Date","datePlaceholder":"AAAA-MM-JJ","place":"Lieu","placePlaceholder":"ex. OGS, KGS","black":"Noir","white":"Blanc","blackRank":"Rang Noir","whiteRank":"Rang Blanc","komi":"Komi","handicap":"Handicap","rules":"R\xe8gles","rulesPlaceholder":"ex. Japonaises, Chinoises","timeControl":"Temps","timePlaceholder":"ex. 900 5x30 byo-yomi","result":"R\xe9sultat","resultPlaceholder":"ex. N+0.5, B+R","clickToAdd":"Cliquez pour ajouter","editHint":"Cliquez sur un champ pour l\'\xe9diter. Entr\xe9e pour sauver, \xc9chap pour annuler.","editAllFields":"\xc9diter tous les champs","exitEditMode":"Quitter le mode \xe9dition"},"comment":{"move":"Coup {{number}}","moveNumber":"Coup {{number}}","noMoveSelected":"Aucun coup s\xe9lectionn\xe9","noComment":"Pas de commentaire. Cliquez pour en ajouter un.","placeholder":"Entrez un commentaire (markdown support\xe9)...","markdownHint":"Astuce : Utilisez le markdown. Ctrl/Cmd+S pour sauver, \xc9chap pour annuler.","enterHint":"Entr\xe9e pour sauvegarder  Maj+Entr\xe9e pour nouvelle ligne  \xc9chap pour annuler","hint":"Astuce : Utilisez le markdown. Ctrl/Cmd+S pour sauver, \xc9chap pour annuler.","editComment":"\xc9diter le commentaire","save":"Sauver","cancel":"Annuler","saveShortcut":"Sauver (Cmd/Ctrl+S)","cancelShortcut":"Annuler (\xc9chap)"},"gameTree":{"switchToVertical":"Passer en disposition verticale","switchToHorizontal":"Passer en disposition horizontale","hideMinimap":"Masquer la minimap","showMinimap":"Afficher la minimap","centerOnPosition":"Centrer sur la position actuelle"},"boardControls":{"captured":"captur\xe9(s)","branch":"Branche","move":"Coup","goToStart":"Aller au d\xe9but (D\xe9but)","goToEnd":"Aller \xe0 la fin (Fin)","goBack10":"Reculer de 10 coups","goForward10":"Avancer de 10 coups","previousMove":"Coup pr\xe9c\xe9dent ()","nextMove":"Coup suivant ()","previousBranch":"Branche pr\xe9c\xe9dente ()","nextBranch":"Branche suivante ()","clickToJumpMove":"Cliquez pour aller au coup","clickToSetBranch":"Cliquez pour d\xe9finir la branche","movesIntoBranch":"{{count}} coups dans la branche","resignGame":"Abandonner la partie","resignConfirm":"{{player}} abandonne. \xcates-vous s\xfbr ?","resign":"Abandonner"},"scoring":{"clear":"Effacer","clearAllDeadStones":"Effacer toutes les pierres mortes","territoryBlackTitle":"Territoire noir","territoryWhiteTitle":"Territoire blanc","capturesBlackTitle":"Captures noir","capturesWhiteTitle":"Captures blanc","deadStonesBlackTitle":"Pierres mortes noires","deadStonesWhiteTitle":"Pierres mortes blanches","komiTitle":"Komi (compensation blanc)","markedAsDead":"{{count}} pierre(s) marqu\xe9e(s) morte(s)","autoEstimate":"Auto-estimer","autoEstimateDescription":"Estimation automatique des pierres mortes par simulation Monte Carlo","estimating":"Estimation...","done":"Termin\xe9","exitScoringMode":"Quitter le mode score (S)","territory":"Territoire :","captures":"Captures :","deadStones":"Pierres mortes :","komi":"Komi :","total":"Total :","jigo":"Jigo (\xc9galit\xe9)","winsBy":"{{player}} gagne de {{points}} points","clickToToggle":"Cliquez sur les pierres pour basculer mort/vivant","stonesMarkedDead":"{{count}} pierre marqu\xe9e morte","stonesMarkedDeadPlural":"{{count}} pierres marqu\xe9es mortes"},"mobileTab":{"board":"Goban","info":"Info","tree":"Arbre","analysis":"Analyse","library":"Biblio"},"toast":{"exportedFile":"\\"{{filename}}\\" export\xe9","savedToLibrary":"Sauvegard\xe9 dans la biblioth\xe8que","savedFileToLibrary":"\\"{{filename}}\\" sauvegard\xe9","libraryFileNotFound":"Fichier introuvable, sauvegarde comme nouveau...","failedToSave":"\xc9chec de la sauvegarde","sgfCopied":"SGF copi\xe9 !","failedToCopy":"\xc9chec de la copie : {{error}}","clipboardEmpty":"Presse-papiers vide","downloadingFromOgs":"T\xe9l\xe9chargement de la partie {{gameId}} depuis OGS...","gameLoadedFromOgs":"Partie charg\xe9e depuis OGS ({{gameId}}) !","gameLoadedFromClipboard":"Partie charg\xe9e depuis le presse-papiers !","failedToPaste":"\xc9chec du collage : {{error}}","failedToLoadSgf":"\xc9chec du chargement SGF : {{error}}"},"loading":{"loadingSgfFile":"Chargement du fichier SGF"},"dropzone":{"dropToLoad":"D\xe9posez pour charger la partie","dropOnLibrary":"D\xe9posez sur la Biblioth\xe8que pour sauvegarder"},"languageSwitcher":{"changeLanguage":"Changer de langue","selectLanguage":"Choisir la langue"},"gameboardActions":{"pass":"Passer","resign":"Abandonner","score":"Score","scoring":"Score","analyze":"Analyser","analysis":"Analyse","navigate":"Naviguer","edit":"\xc9diter","show":"Afficher","hide":"Masquer","enterScoringMode":"Activer le mode score (S)","exitScoringMode":"Quitter le mode score (S)","showAnalysis":"Afficher la barre d\'analyse (A)","hideAnalysis":"Masquer la barre d\'analyse (A)","analysisActiveHidden":"Mode analyse actif (cliquez pour afficher)","enterNavigationMode":"Activer le mode navigation (N)","exitNavigationMode":"Quitter le mode navigation (N)","enterEditMode":"Activer le mode \xe9dition (E)","exitEditMode":"Quitter le mode \xe9dition (E)","showNextMove":"Afficher le prochain coup","hideNextMove":"Masquer le prochain coup","suggestMove":"Sugg\xe9rer un coup","suggestMoveTitle":"Demander \xe0 l\'IA de sugg\xe9rer un coup (G)","suggesting":"Suggestion...","loadAiModelFirst":"Veuillez d\'abord charger un mod\xe8le IA","initializingAiEngine":"Initialisation du moteur IA...","aiEngineInitializing":"Le moteur IA s\'initialise, veuillez r\xe9essayer","failedToGenerateMove":"\xc9chec de la g\xe9n\xe9ration du coup IA"},"analysisBar":{"uploadingModel":"T\xe9l\xe9versement du mod\xe8le ({{progress}}%)","checkingCache":"V\xe9rification du cache...","initializing":"Initialisation...","loading":"Chargement...","analyzing":"Analyse en cours...","winRate":"Taux de victoire","blackWinRate":"Victoire Noir","whiteWinRate":"Victoire Blanc","scoreLead":"Avantage","analyzeFullGameLong":"Analyser la partie enti\xe8re (peut prendre plusieurs minutes)"},"panels":{"library":"Biblioth\xe8que","analysis":"Analyse","gameTree":"Arbre de jeu","gameInfo":"Infos partie","comment":"Commentaire","showLibrary":"Afficher la biblioth\xe8que (Ctrl+L)","showSidebar":"Afficher le panneau lat\xe9ral (Ctrl+B)"},"quickNewGameTooltip":"Partie rapide ({{size}}\xd7{{size}}) -  Efface la partie sans sauvegarder !","close":"Fermer","aboutKaya":"\xc0 propos de Kaya","aboutDescription":"Une belle application de Go avec analyse IA propuls\xe9e par KataGo","aboutVersion":"Version","aboutCommit":"Commit","aboutBuildDate":"Date de compilation","aboutLicense":"Licence","aboutGitHub":"D\xe9p\xf4t GitHub","aboutReportIssue":"Signaler un probl\xe8me","aboutVersionNotAvailable":"Informations de version non disponibles"}'),sP=JSON.parse('{"addToLibrary":"Zur Bibliothek hinzuf\xfcgen","landing":{"tagline":"Eine moderne Go-Anwendung","continue":"Spiel fortsetzen","newGame":"Neues Spiel","library":"Spielbibliothek","dropSgfToOpen":"SGF-Datei zum \xd6ffnen ablegen"},"black":"Schwarz:","boardSettings":"Brett-Einstellungen","boardSize":"Brettgr\xf6\xdfe:","cancel":"Abbrechen","clickToRename":"Klicken zum Umbenennen","commit":"Commit:","confirm":"Best\xe4tigen","copySgf":"SGF kopieren","copySgfToClipboard":"SGF in Zwischenablage kopieren","createGame":"Spiel erstellen","darkMode":"Dunkelmodus","date":"Datum:","discard":"Verwerfen","enableSounds":"T\xf6ne aktivieren","enterFullscreen":"Vollbild","exitFullscreen":"Vollbild beenden","exportToDisk":"Auf Festplatte exportieren","extensionNote":"Die Erweiterung .sgf wird automatisch hinzugef\xfcgt","filename":"Dateiname:","game":"Spiel","gameSgf":"spiel.sgf","handicap":"Vorgabe:","hideLibrary":"Bibliothek ausblenden","hideMenu":"Men\xfc ausblenden","hideSidebar":"Seitenleiste ausblenden","home":"Startseite","komi":"Komi:","language":"Sprache","learnMore":"Mehr erfahren auf Sensei\'s Library","libraryRoot":"Bibliothek-Stammverzeichnis","lightMode":"Hellmodus","menu":"Men\xfc","moreActions":"Mehr","muteSounds":"Stumm","new":"Neu","newGame":"Neues Spiel","newGameEllipsis":"Neues Spiel...","open":"\xd6ffnen","openSgf":"SGF \xf6ffnen...","openSgfFile":"SGF-Datei \xf6ffnen","pasteSgf":"SGF einf\xfcgen","pasteSgfOrOgs":"SGF oder OGS-URL einf\xfcgen","pasteSgfUrl":"SGF/URL einf\xfcgen","patternDisabled":"Mustererkennung deaktiviert (klicken zum Aktivieren)","patternEnabled":"Mustererkennung aktiviert (klicken zum Deaktivieren)","playerName":"Spielername","players":"Spieler","quickNewGame":"Schnelles neues Spiel","rank":"Rang:","rankPlaceholder":"z.B. 5k, 3d","reportBug":"Fehler melden oder Funktion vorschlagen","reportIssue":"Problem melden","save":"Speichern","saveAs":"Speichern unter...","saveAsShort":"Speichern als","saveGame":"Spiel speichern","saveToFolder":"In Ordner speichern:","saveToLibrary":"In Bibliothek speichern","settings":"Einstellungen","showLibrary":"Bibliothek anzeigen","showSidebar":"Seitenleiste anzeigen","startNewGame":"Neues Spiel starten?","startNewGameConfirm":"Das aktuelle Spiel geht verloren, wenn es nicht gespeichert wird. M\xf6chten Sie wirklich ein neues Spiel starten?","switchToDarkMode":"Zum Dunkelmodus wechseln","switchToLightMode":"Zum Hellmodus wechseln","unsavedChanges":"Nicht gespeicherte \xc4nderungen","version":"Version:","viewCommit":"Commit auf GitHub ansehen","viewOnGitHub":"Auf GitHub ansehen","viewVersion":"Version auf GitHub ansehen","white":"Wei\xdf:","unsavedChangesLost":"Sie haben nicht gespeicherte \xc4nderungen, die verloren gehen. Trotzdem fortfahren?","unsavedChangesPrompt":"Sie haben nicht gespeicherte \xc4nderungen. Was m\xf6chten Sie tun?","edit":"Bearbeiten","export":"Exportieren","copy":"Kopieren","paste":"Einf\xfcgen","aiConfig":{"title":"Analyse-Einstellungen","modelLibrary":"Modellbibliothek","modelLibraryDescription":"W\xe4hlen Sie ein Modell f\xfcr die KI-Analyse. Erweitern Sie, um die Quantisierungsstufe auszuw\xe4hlen.","active":"Aktiv","recommended":"Empfohlen","default":"Standard","downloaded":"heruntergeladen","customModels":"Benutzerdefinierte Modelle","downloadModel":"Modell herunterladen","deleteModel":"Modell l\xf6schen","uploadCustomModel":"Eigenes Modell hochladen","uploadCustomModelDescription":"Nur .onnx-Modelle werden unterst\xfctzt. KataGo-Gewichte (.bin.gz oder .bin) m\xfcssen zuerst konvertiert werden mit:","analysisOptions":"Analyseoptionen","inferenceBackend":"Inferenz-Backend","inferenceBackendDescription":"W\xe4hlen Sie, wie das KI-Modell ausgef\xfchrt wird. Native ist am schnellsten, WebGPU nutzt die GPU, WASM nutzt die CPU (h\xf6chste Kompatibilit\xe4t).","nativeAuto":"Native - Automatisch (GPU wenn verf\xfcgbar)","nativeCpu":"Native - Nur CPU","webgpu":"WebGPU (Browser-GPU)","wasm":"WASM (Browser-CPU)","maxTopMoves":"Maximale Anzeigeanzahl","maxTopMovesDescription":"Maximale Anzahl der auf dem Brett angezeigten Zugkandidaten.","minProbability":"Minimale Wahrscheinlichkeit","minProbabilityDescription":"Z\xfcge mit einer Wahrscheinlichkeit unter diesem Schwellenwert ausblenden.","saveAnalysisToSgf":"Analyse in SGF speichern","saveAnalysisToSgfDescription":"KI-Analysedaten (Gewinnrate, Punkte, Z\xfcge) beim Speichern als SGF einbetten. Erh\xf6ht die Dateigr\xf6\xdfe, beh\xe4lt aber die Analyse bei.","modelUploadedSuccess":"Modell erfolgreich hochgeladen","modelUploadFailed":"Modell-Upload fehlgeschlagen","modelDownloadedSuccess":"Modell erfolgreich heruntergeladen","modelDownloadFailed":"Modell-Download fehlgeschlagen","modelDeletedSuccess":"Modell gel\xf6scht","modelDeleteFailed":"Modell l\xf6schen fehlgeschlagen","getStartedTitle":"KI-Analyse starten","getStartedDescription":"Laden Sie ein Modell herunter, um KI-gest\xfctzte Zugvorschl\xe4ge und Spielanalysen zu aktivieren.","downloadRecommended":"Empfohlenes Modell herunterladen","downloading":"Wird heruntergeladen...","poweredBy":"KI-Engine basiert auf"},"kayaConfig":{"title":"Einstellungen","close":"Einstellungen schlie\xdfen","analysisTab":"Analyse","gameTab":"Spiel","boardSettings":"Brett-Einstellungen","fuzzyStonePlacement":"Unscharfe Steinplatzierung","fuzzyStonePlacementDescription":"F\xfcgt leichte zuf\xe4llige Verschiebungen zu Steinpositionen hinzu f\xfcr ein nat\xfcrlicheres, handplatziertes Aussehen.","on":"Ein","off":"Aus"},"analysis":{"toggleOwnership":"Gebiets-Heatmap umschalten","toggleTopMoves":"Beste Z\xfcge umschalten","toggleWinRate":"Gewinnrate-Grafik umschalten","toggleScore":"Punkte-Grafik umschalten","winRate":"Gewinnrate","score":"Punkte","visualizationGroup":"Visualisierungsoptionen","actionsGroup":"Analyse-Aktionen","analyzeFullGame":"Gesamtes Spiel analysieren","stopAnalysis":"Analyse stoppen","waitingForEngine":"Warte auf Engine...","clearCache":"Analyse-Cache leeren","clearCacheWithCount":"{{count}} zwischengespeicherte Analysen l\xf6schen","noCachedAnalysis":"Keine zwischengespeicherten Analysen","analysisLegend":"Analyse-Legende","positionsAnalyzed":"{{analyzed}}/{{total}} Positionen in der aktuellen Variante analysiert","initializingEngine":"Engine wird initialisiert...","analyzing":"Analysiere...","stopping":"Stoppe...","analyzingProgress":"Analysiere: {{progress}}%","stopAnalysisButton":"Analyse stoppen","analysisModeOn":"Analyse-Modus aktiv - Klicken zum Deaktivieren","analysisModeOff":"Analyse-Modus inaktiv - Klicken zum Aktivieren"},"analysisLegend":{"title":"Analyse-Legende","policyDescription":"Farben zeigen die <strong>Richtlinien-Wahrscheinlichkeit</strong> der KI f\xfcr jeden Zugkandidaten an. Dies repr\xe4sentiert die Konfidenz des neuronalen Netzwerks, dass der Zug am besten ist.","best":"Bester","bestProb":"70% Wahrscheinlichkeit","great":"Gro\xdfartig","greatProb":"60-70%","good":"Gut","goodProb":"40-60%","okay":"Okay","okayProb":"10-40%","poor":"Schlecht","poorProb":"<10%","note":"Die aktuelle ONNX KataGo-Implementierung liefert Richtlinien-Wahrscheinlichkeiten, enth\xe4lt jedoch keine Gewinnrate oder Punkt-Unterschied f\xfcr einzelne Zugkandidaten. Diese sind nur f\xfcr die aktuelle Brettposition verf\xfcgbar.","heatmapOwnership":"Heatmap-Besitz","heatmapDescription":"Die Besitz-Heatmap zeigt das vorhergesagte Endgebiet. Hellere Farben zeigen eine h\xf6here Konfidenz an, dass der Bereich dem Spieler geh\xf6rt.","blackArea":"Schwarzes Gebiet","whiteArea":"Wei\xdfes Gebiet"},"library":{"newFolder":"Neuer Ordner","importSgfZip":"SGF/ZIP importieren","exportLibraryAsZip":"Bibliothek als ZIP exportieren","clearLibrary":"Bibliothek leeren","loading":"Wird geladen...","emptyLibrary":"Bibliothek ist leer","emptyLibraryHint":"SGF-Dateien hierher ziehen oder Rechtsklick f\xfcr neuen Ordner","dropToAdd":"Ablegen zum Hinzuf\xfcgen","itemsSelected":"{{count}} ausgew\xe4hlt","duplicateSelected":"Ausgew\xe4hlte duplizieren","downloadSelected":"Ausgew\xe4hlte herunterladen","deleteSelected":"Ausgew\xe4hlte l\xf6schen","clearSelection":"Auswahl aufheben","gamesCount":"{{count}} Spiele","foldersCount":"{{count}} Ordner","deleteFolder":"Ordner l\xf6schen","deleteFolderConfirm":"Ordner \\"{{name}}\\" und alle Inhalte l\xf6schen?","deleteFile":"Datei l\xf6schen","deleteFileConfirm":"\\"{{name}}\\" l\xf6schen?","deleteItemsTitle":"{{count}} Elemente l\xf6schen","deleteItemsConfirm":"{{count}} ausgew\xe4hlte Elemente l\xf6schen? Dies kann nicht r\xfcckg\xe4ngig gemacht werden.","clearLibraryTitle":"Bibliothek leeren","clearLibraryConfirm":"Alle {{count}} Elemente aus der Bibliothek l\xf6schen? Dies kann nicht r\xfcckg\xe4ngig gemacht werden.","load":"Laden","rename":"Umbenennen","duplicate":"Duplizieren","download":"Herunterladen","moveToRoot":"In Stammverzeichnis verschieben","delete":"L\xf6schen","duplicateItems":"{{count}} duplizieren","downloadItems":"{{count}} herunterladen","deleteItems":"{{count}} l\xf6schen","create":"Erstellen","unsavedChangesIndicator":"Nicht gespeicherte \xc4nderungen"},"updater":{"checkForUpdates":"Nach Updates suchen...","updateAvailable":"Update verf\xfcgbar","versionAvailable":"Version {{version}} ist verf\xfcgbar.","installing":"Update wird installiert...Bitte warten.","skipVersion":"Diese Version \xfcberspringen","remindLater":"Sp\xe4ter erinnern","updateNow":"Jetzt aktualisieren","noUpdateAvailable":"Kein Update verf\xfcgbar","youAreOnLatest":"Sie haben die neueste Version.","checkFailed":"Update-Pr\xfcfung fehlgeschlagen.","manualDownload":"Manueller Download:","updateInstalled":"Update installiert","restartPrompt":"Update wurde installiert. Jetzt neu starten, um die \xc4nderungen anzuwenden?","restart":"Neu starten","later":"Sp\xe4ter","updateFailed":"Update fehlgeschlagen","updateFailedMessage":"Update-Installation fehlgeschlagen. Bitte sp\xe4ter erneut versuchen oder die neueste Version manuell herunterladen:"},"editToolbar":{"stones":"Steine","playMode":"Spielmodus","setupMode":"Aufstellungsmodus","alternate":"Abwechselnd","blackStone":"Schwarz","black":"Schwarz","whiteStone":"Wei\xdf","white":"Wei\xdf","pass":"Passen","clearSetupStones":"Aufstellungssteine l\xf6schen","markers":"Markierungen","triangle":"Dreieck","square":"Quadrat","circle":"Kreis","cross":"\xd7","labelAlpha":"ABC","labelNum":"123","eraseMarker":"L\xf6schen","eraseAll":"Alle l\xf6schen","branch":"Variante","makeMainBranch":"Zur Hauptvariante machen","copyBranch":"Kopieren","copy":"Kopieren","pasteBranch":"Einf\xfcgen","paste":"Einf\xfcgen","deleteCurrentBranch":"Aktuelle Variante l\xf6schen","deleteOtherBranches":"Andere Varianten l\xf6schen (nur aktuelle Linie behalten)","history":"Verlauf","undo":"R\xfcckg\xe4ngig","redo":"Wiederholen"},"gameInfo":{"game":"Spiel","untitled":"Unbenannt","date":"Datum","datePlaceholder":"JJJJ-MM-TT","place":"Ort","placePlaceholder":"z.B. OGS, KGS","black":"Schwarz","white":"Wei\xdf","blackRank":"Rang Schwarz","whiteRank":"Rang Wei\xdf","komi":"Komi","handicap":"Vorgabe","rules":"Regeln","rulesPlaceholder":"z.B. Japanisch, Chinesisch","timeControl":"Zeitkontrolle","timePlaceholder":"z.B. 900 5x30 Byo-yomi","result":"Ergebnis","resultPlaceholder":"z.B. S+0.5, W+R","clickToAdd":"Klicken zum Hinzuf\xfcgen","editHint":"Klicken Sie auf ein Feld zum Bearbeiten. Enter zum Speichern, Esc zum Abbrechen.","editAllFields":"Alle Felder bearbeiten","exitEditMode":"Bearbeitungsmodus beenden"},"comment":{"move":"Zug {{number}}","moveNumber":"Zug {{number}}","noMoveSelected":"Kein Zug ausgew\xe4hlt","noComment":"Kein Kommentar. Klicken zum Hinzuf\xfcgen.","placeholder":"Kommentar eingeben (Markdown unterst\xfctzt)...","markdownHint":"Tipp: Markdown zur Formatierung verwenden. Strg/Cmd+S zum Speichern, Esc zum Abbrechen.","enterHint":"Enter zum Speichern  Shift+Enter f\xfcr neue Zeile  Esc zum Abbrechen","hint":"Tipp: Markdown zur Formatierung verwenden. Strg/Cmd+S zum Speichern, Esc zum Abbrechen.","editComment":"Kommentar bearbeiten","save":"Speichern","cancel":"Abbrechen","saveShortcut":"Speichern (Cmd/Strg+S)","cancelShortcut":"Abbrechen (Esc)"},"gameTree":{"switchToVertical":"Zu vertikalem Layout wechseln","switchToHorizontal":"Zu horizontalem Layout wechseln","hideMinimap":"Minimap ausblenden","showMinimap":"Minimap anzeigen","centerOnPosition":"Auf Position zentrieren"},"boardControls":{"captured":"Gefangen","branch":"Variante","move":"Zug","goToStart":"Zum Anfang (Pos1)","goToEnd":"Zum Ende (Ende)","goBack10":"10 Z\xfcge zur\xfcck","goForward10":"10 Z\xfcge vor","previousMove":"Vorheriger Zug ()","nextMove":"N\xe4chster Zug ()","previousBranch":"Vorherige Variante ()","nextBranch":"N\xe4chste Variante ()","clickToJumpMove":"Klicken zum Sprung zu Zug","clickToSetBranch":"Klicken zum Setzen der Varianten-ID","movesIntoBranch":"{{count}} Z\xfcge in Variante","resignGame":"Aufgeben","resignConfirm":"{{player}} wird aufgeben. Sind Sie sicher?","resign":"Aufgeben"},"scoring":{"clear":"L\xf6schen","clearAllDeadStones":"Alle toten Steine l\xf6schen","territoryBlackTitle":"Schwarzes Gebiet","territoryWhiteTitle":"Wei\xdfes Gebiet","capturesBlackTitle":"Schwarze Gefangene","capturesWhiteTitle":"Wei\xdfe Gefangene","deadStonesBlackTitle":"Schwarze tote Steine","deadStonesWhiteTitle":"Wei\xdfe tote Steine","komiTitle":"Komi (Wei\xdf-Kompensation)","markedAsDead":"{{count}} Stein(e) als tot markiert","autoEstimate":"Automatisch sch\xe4tzen","autoEstimateDescription":"Monte-Carlo-Simulation zur automatischen Erkennung toter Steine verwenden","estimating":"Sch\xe4tze...","done":"Fertig","exitScoringMode":"Wertungsmodus beenden (S)","territory":"Gebiet:","captures":"Gefangene:","deadStones":"Tote Steine:","komi":"Komi:","total":"Gesamt:","jigo":"Unentschieden","winsBy":"{{player}} gewinnt mit {{points}} Punkten","clickToToggle":"Klicken Sie auf Steine, um den Status umzuschalten","stonesMarkedDead":"{{count}} Stein als tot markiert","stonesMarkedDeadPlural":"{{count}} Steine als tot markiert"},"mobileTab":{"board":"Brett","info":"Info","tree":"Baum","analysis":"Analyse","library":"Bibliothek"},"toast":{"exportedFile":"\\"{{filename}}\\" exportiert","savedToLibrary":"In Bibliothek gespeichert","savedFileToLibrary":"\\"{{filename}}\\" in Bibliothek gespeichert","libraryFileNotFound":"Bibliotheksdatei nicht gefunden. Speichere als neue Datei...","failedToSave":"Speichern in Bibliothek fehlgeschlagen","sgfCopied":"SGF in Zwischenablage kopiert!","failedToCopy":"Kopieren fehlgeschlagen: {{error}}","clipboardEmpty":"Zwischenablage ist leer","downloadingFromOgs":"Lade Spiel {{gameId}} von OGS herunter...","gameLoadedFromOgs":"Spiel von OGS geladen ({{gameId}})!","gameLoadedFromClipboard":"Spiel aus Zwischenablage geladen!","failedToPaste":"Einf\xfcgen fehlgeschlagen: {{error}}","failedToLoadSgf":"SGF-Datei laden fehlgeschlagen: {{error}}"},"loading":{"loadingSgfFile":"SGF-Datei wird geladen"},"dropzone":{"dropToLoad":"Ablegen um Spiel zu laden","dropOnLibrary":"Auf Bibliothek ablegen um zu speichern"},"languageSwitcher":{"changeLanguage":"Sprache \xe4ndern","selectLanguage":"Sprache w\xe4hlen"},"gameboardActions":{"pass":"Passen","resign":"Aufgeben","score":"Wertung","scoring":"Wertung","analyze":"Analysieren","analysis":"Analyse","navigate":"Navigieren","edit":"Bearbeiten","show":"Zeigen","hide":"Verstecken","enterScoringMode":"Wertungsmodus aktivieren (S)","exitScoringMode":"Wertungsmodus beenden (S)","showAnalysis":"Analyseleiste anzeigen (A)","hideAnalysis":"Analyseleiste ausblenden (A)","analysisActiveHidden":"Analysemodus aktiv (klicken zum Anzeigen)","enterNavigationMode":"Navigationsmodus aktivieren (N)","exitNavigationMode":"Navigationsmodus beenden (N)","enterEditMode":"Bearbeitungsmodus aktivieren (E)","exitEditMode":"Bearbeitungsmodus beenden (E)","showNextMove":"N\xe4chsten Zug anzeigen","hideNextMove":"N\xe4chsten Zug ausblenden","suggestMove":"Zug vorschlagen","suggestMoveTitle":"KI nach einem Zug fragen (G)","suggesting":"Vorschlagen...","loadAiModelFirst":"Bitte laden Sie zuerst ein KI-Modell","initializingAiEngine":"KI-Engine wird initialisiert...","aiEngineInitializing":"KI-Engine wird initialisiert, bitte erneut versuchen","failedToGenerateMove":"Fehler bei der KI-Zugvorschlag"},"analysisBar":{"uploadingModel":"Modell wird hochgeladen ({{progress}}%)","checkingCache":"Cache wird \xfcberpr\xfcft...","initializing":"Initialisierung...","loading":"Laden...","analyzing":"Analysiere...","winRate":"Gewinnrate","blackWinRate":"Schwarz Gewinnrate","whiteWinRate":"Wei\xdf Gewinnrate","scoreLead":"Punktevorsprung","analyzeFullGameLong":"Gesamtes Spiel analysieren (kann bei langen Spielen einige Minuten dauern)"},"panels":{"library":"Bibliothek","analysis":"Analyse","gameTree":"Spielbaum","gameInfo":"Spielinfo","comment":"Kommentar","showLibrary":"Bibliothek anzeigen (Strg+L)","showSidebar":"Seitenleiste anzeigen (Strg+B)"},"quickNewGameTooltip":"Schnelles neues Spiel ({{size}}\xd7{{size}}) -  L\xf6scht aktuelles Spiel ohne Speichern!","close":"Schlie\xdfen","aboutKaya":"\xdcber Kaya","aboutDescription":"Eine sch\xf6ne Go-Anwendung mit KI-Analyse durch KataGo","aboutVersion":"Version","aboutCommit":"Commit","aboutBuildDate":"Erstellungsdatum","aboutLicense":"Lizenz","aboutGitHub":"GitHub-Repository","aboutReportIssue":"Problem melden","aboutVersionNotAvailable":"Versionsinformationen nicht verf\xfcgbar"}'),sD=JSON.parse('{"addToLibrary":"A\xf1adir a la biblioteca","landing":{"tagline":"Una aplicaci\xf3n moderna de Go","continue":"Continuar partida","newGame":"Nueva partida","library":"Biblioteca","dropSgfToOpen":"Arrastra un archivo SGF"},"black":"Negro:","boardSettings":"Configuraci\xf3n del tablero","boardSize":"Tama\xf1o del tablero:","cancel":"Cancelar","clickToRename":"Clic para renombrar","commit":"Commit:","confirm":"Confirmar","copySgf":"Copiar SGF","copySgfToClipboard":"Copiar SGF al portapapeles","createGame":"Crear partida","darkMode":"Modo oscuro","date":"Fecha:","discard":"Descartar","enableSounds":"Activar sonidos","enterFullscreen":"Pantalla completa","exitFullscreen":"Salir de pantalla completa","exportToDisk":"Exportar al disco","extensionNote":"La extensi\xf3n .sgf se a\xf1adir\xe1 autom\xe1ticamente","filename":"Nombre del archivo:","game":"Partida","gameSgf":"partida.sgf","handicap":"Handicap:","hideLibrary":"Ocultar biblioteca","hideMenu":"Ocultar men\xfa","hideSidebar":"Ocultar barra lateral","home":"Inicio","komi":"Komi:","language":"Idioma","learnMore":"M\xe1s informaci\xf3n en Sensei\'s Library","libraryRoot":"Ra\xedz de la biblioteca","lightMode":"Modo claro","menu":"Men\xfa","moreActions":"M\xe1s","muteSounds":"Silenciar","new":"Nuevo","newGame":"Nueva partida","newGameEllipsis":"Nueva partida...","open":"Abrir","openSgf":"Abrir SGF...","openSgfFile":"Abrir archivo SGF","pasteSgf":"Pegar SGF","pasteSgfOrOgs":"Pegar SGF o URL de OGS","pasteSgfUrl":"Pegar SGF/URL","patternDisabled":"Coincidencia de patrones desactivada (clic para activar)","patternEnabled":"Coincidencia de patrones activada (clic para desactivar)","playerName":"Nombre del jugador","players":"Jugadores","quickNewGame":"Nueva partida r\xe1pida","rank":"Rango:","rankPlaceholder":"ej. 5k, 3d","reportBug":"Reportar un error o sugerir una funci\xf3n","reportIssue":"Reportar problema","save":"Guardar","saveAs":"Guardar como...","saveAsShort":"Guardar como","saveGame":"Guardar partida","saveToFolder":"Guardar en carpeta:","saveToLibrary":"Guardar en biblioteca","settings":"Configuraci\xf3n","showLibrary":"Mostrar biblioteca","showSidebar":"Mostrar barra lateral","startNewGame":"\xbfIniciar nueva partida?","startNewGameConfirm":"La partida actual se perder\xe1 si no se guarda. \xbfEst\xe1s seguro de que quieres iniciar una nueva partida?","switchToDarkMode":"Cambiar a modo oscuro","switchToLightMode":"Cambiar a modo claro","unsavedChanges":"Cambios sin guardar","version":"Versi\xf3n:","viewCommit":"Ver commit en GitHub","viewOnGitHub":"Ver en GitHub","viewVersion":"Ver versi\xf3n en GitHub","white":"Blanco:","unsavedChangesLost":"Tienes cambios sin guardar que se perder\xe1n. \xbfContinuar de todos modos?","unsavedChangesPrompt":"Tienes cambios sin guardar. \xbfQu\xe9 deseas hacer?","edit":"Editar","export":"Exportar","copy":"Copiar","paste":"Pegar","aiConfig":{"title":"Configuraci\xf3n de an\xe1lisis","modelLibrary":"Biblioteca de modelos","modelLibraryDescription":"Selecciona un modelo para el an\xe1lisis de IA. Expande para elegir el nivel de cuantizaci\xf3n.","active":"Activo","recommended":"Recomendado","default":"Predeterminado","downloaded":"descargado(s)","customModels":"Modelos personalizados","downloadModel":"Descargar modelo","deleteModel":"Eliminar modelo","uploadCustomModel":"Subir modelo personalizado","uploadCustomModelDescription":"Solo se admiten modelos .onnx. Los pesos de KataGo (.bin.gz o .bin) deben convertirse primero usando:","analysisOptions":"Opciones de an\xe1lisis","inferenceBackend":"Backend de inferencia","inferenceBackendDescription":"Elige c\xf3mo ejecutar el modelo de IA. Native es el m\xe1s r\xe1pido, WebGPU usa la GPU, WASM usa la CPU (mayor compatibilidad).","nativeAuto":"Native - Autom\xe1tico (GPU si est\xe1 disponible)","nativeCpu":"Native - Solo CPU","webgpu":"WebGPU (GPU del navegador)","wasm":"WASM (CPU del navegador)","maxTopMoves":"M\xe1ximo de movimientos a mostrar","maxTopMovesDescription":"N\xfamero m\xe1ximo de movimientos candidatos a mostrar en el tablero.","minProbability":"Probabilidad m\xednima","minProbabilityDescription":"Ocultar movimientos con probabilidad por debajo de este umbral.","saveAnalysisToSgf":"Guardar an\xe1lisis en SGF","saveAnalysisToSgfDescription":"Incluir datos de an\xe1lisis de IA (tasa de victoria, puntos, movimientos) al guardar como SGF. Aumenta el tama\xf1o del archivo pero preserva el an\xe1lisis.","modelUploadedSuccess":"Modelo subido correctamente","modelUploadFailed":"Error al subir el modelo","modelDownloadedSuccess":"Modelo descargado correctamente","modelDownloadFailed":"Error al descargar el modelo","modelDeletedSuccess":"Modelo eliminado","modelDeleteFailed":"Error al eliminar el modelo","getStartedTitle":"Comenzar con el an\xe1lisis IA","getStartedDescription":"Descarga un modelo para activar las sugerencias de jugadas y el an\xe1lisis de partidas con IA.","downloadRecommended":"Descargar modelo recomendado","downloading":"Descargando...","poweredBy":"Motor de IA basado en"},"kayaConfig":{"title":"Configuraci\xf3n","close":"Cerrar configuraci\xf3n","analysisTab":"An\xe1lisis","gameTab":"Juego","boardSettings":"Configuraci\xf3n del tablero","fuzzyStonePlacement":"Colocaci\xf3n difusa de piedras","fuzzyStonePlacementDescription":"A\xf1ade peque\xf1os desplazamientos aleatorios a las posiciones de las piedras para una apariencia m\xe1s natural.","on":"Activado","off":"Desactivado"},"analysis":{"toggleOwnership":"Alternar mapa de calor de territorio","toggleTopMoves":"Alternar mejores movimientos","toggleWinRate":"Alternar gr\xe1fico de tasa de victoria","toggleScore":"Alternar gr\xe1fico de puntuaci\xf3n","winRate":"Tasa de victoria","score":"Puntuaci\xf3n","visualizationGroup":"Opciones de visualizaci\xf3n","actionsGroup":"Acciones de an\xe1lisis","analyzeFullGame":"Analizar partida completa","stopAnalysis":"Detener an\xe1lisis","waitingForEngine":"Esperando motor...","clearCache":"Limpiar cach\xe9 de an\xe1lisis","clearCacheWithCount":"Limpiar {{count}} an\xe1lisis en cach\xe9","noCachedAnalysis":"Sin an\xe1lisis en cach\xe9","analysisLegend":"Leyenda del an\xe1lisis","positionsAnalyzed":"{{analyzed}}/{{total}} posiciones analizadas en la variante actual","initializingEngine":"Inicializando motor...","analyzing":"Analizando...","stopping":"Deteniendo...","analyzingProgress":"Analizando: {{progress}}%","stopAnalysisButton":"Detener an\xe1lisis","analysisModeOn":"Modo an\xe1lisis activado - Haz clic para desactivar","analysisModeOff":"Modo an\xe1lisis desactivado - Haz clic para activar"},"analysisLegend":{"title":"Leyenda del an\xe1lisis","policyDescription":"Los colores indican la <strong>probabilidad de pol\xedtica</strong> de la IA para cada movimiento candidato. Representa la confianza de la red neuronal en que el movimiento es el mejor.","best":"Mejor","bestProb":"70% probabilidad","great":"Excelente","greatProb":"60-70%","good":"Bueno","goodProb":"40-60%","okay":"Aceptable","okayProb":"10-40%","poor":"Malo","poorProb":"<10%","note":"La implementaci\xf3n actual de ONNX KataGo proporciona probabilidades de pol\xedtica, pero no incluye tasa de victoria o diferencia de puntos para movimientos candidatos individuales. Estos solo est\xe1n disponibles para la posici\xf3n actual del tablero.","heatmapOwnership":"Propiedad del mapa de calor","heatmapDescription":"El mapa de calor de propiedad muestra el territorio predicho al final del juego. Los colores m\xe1s brillantes indican mayor confianza de que el \xe1rea pertenece al jugador.","blackArea":"Territorio negro","whiteArea":"Territorio blanco"},"library":{"newFolder":"Nueva carpeta","importSgfZip":"Importar SGF/ZIP","exportLibraryAsZip":"Exportar biblioteca como ZIP","clearLibrary":"Vaciar biblioteca","loading":"Cargando...","emptyLibrary":"La biblioteca est\xe1 vac\xeda","emptyLibraryHint":"Arrastra archivos SGF aqu\xed o haz clic derecho para crear una carpeta","dropToAdd":"Soltar para a\xf1adir","itemsSelected":"{{count}} seleccionados","duplicateSelected":"Duplicar seleccionados","downloadSelected":"Descargar seleccionados","deleteSelected":"Eliminar seleccionados","clearSelection":"Limpiar selecci\xf3n","gamesCount":"{{count}} partidas","foldersCount":"{{count}} carpetas","deleteFolder":"Eliminar carpeta","deleteFolderConfirm":"\xbfEliminar la carpeta \\"{{name}}\\" y todo su contenido?","deleteFile":"Eliminar archivo","deleteFileConfirm":"\xbfEliminar \\"{{name}}\\"?","deleteItemsTitle":"Eliminar {{count}} elementos","deleteItemsConfirm":"\xbfEliminar {{count}} elementos seleccionados? Esta acci\xf3n no se puede deshacer.","clearLibraryTitle":"Vaciar biblioteca","clearLibraryConfirm":"\xbfEliminar los {{count}} elementos de la biblioteca? Esta acci\xf3n no se puede deshacer.","load":"Cargar","rename":"Renombrar","duplicate":"Duplicar","download":"Descargar","moveToRoot":"Mover a la ra\xedz","delete":"Eliminar","duplicateItems":"Duplicar {{count}}","downloadItems":"Descargar {{count}}","deleteItems":"Eliminar {{count}}","create":"Crear","unsavedChangesIndicator":"Cambios sin guardar"},"updater":{"checkForUpdates":"Buscar actualizaciones...","updateAvailable":"Actualizaci\xf3n disponible","versionAvailable":"La versi\xf3n {{version}} est\xe1 disponible.","installing":"Instalando actualizaci\xf3n...Por favor espera.","skipVersion":"Omitir esta versi\xf3n","remindLater":"Recordar m\xe1s tarde","updateNow":"Actualizar ahora","noUpdateAvailable":"Sin actualizaciones disponibles","youAreOnLatest":"Tienes la \xfaltima versi\xf3n.","checkFailed":"Error al comprobar actualizaciones.","manualDownload":"Descarga manual:","updateInstalled":"Actualizaci\xf3n instalada","restartPrompt":"La actualizaci\xf3n se ha instalado. \xbfReiniciar ahora para aplicar los cambios?","restart":"Reiniciar","later":"M\xe1s tarde","updateFailed":"Error en la actualizaci\xf3n","updateFailedMessage":"Error al instalar la actualizaci\xf3n. Por favor, int\xe9ntalo de nuevo m\xe1s tarde o descarga la \xfaltima versi\xf3n manualmente:"},"editToolbar":{"stones":"Piedras","playMode":"Modo juego","setupMode":"Modo configuraci\xf3n","alternate":"Alternar","blackStone":"Negro","black":"Negro","whiteStone":"Blanco","white":"Blanco","pass":"Pasar","clearSetupStones":"Limpiar piedras de configuraci\xf3n","markers":"Marcadores","triangle":"Tri\xe1ngulo","square":"Cuadrado","circle":"C\xedrculo","cross":"\xd7","labelAlpha":"ABC","labelNum":"123","eraseMarker":"Borrar","eraseAll":"Borrar todo","branch":"Variante","makeMainBranch":"Hacer variante principal","copyBranch":"Copiar","copy":"Copiar","pasteBranch":"Pegar","paste":"Pegar","deleteCurrentBranch":"Eliminar variante actual","deleteOtherBranches":"Eliminar otras variantes (mantener solo la l\xednea actual)","history":"Historial","undo":"Deshacer","redo":"Rehacer"},"gameInfo":{"game":"Partida","untitled":"Sin t\xedtulo","date":"Fecha","datePlaceholder":"AAAA-MM-DD","place":"Lugar","placePlaceholder":"ej. OGS, KGS","black":"Negro","white":"Blanco","blackRank":"Rango de Negro","whiteRank":"Rango de Blanco","komi":"Komi","handicap":"Handicap","rules":"Reglas","rulesPlaceholder":"ej. Japonesas, Chinas","timeControl":"Control de tiempo","timePlaceholder":"ej. 900 5x30 byo-yomi","result":"Resultado","resultPlaceholder":"ej. N+0.5, B+R","clickToAdd":"Clic para a\xf1adir","editHint":"Haz clic en un campo para editar. Enter para guardar, Esc para cancelar.","editAllFields":"Editar todos los campos","exitEditMode":"Salir del modo edici\xf3n"},"comment":{"move":"Movimiento {{number}}","moveNumber":"Movimiento {{number}}","noMoveSelected":"Ning\xfan movimiento seleccionado","noComment":"Sin comentario. Haz clic para a\xf1adir.","placeholder":"Escribe un comentario (markdown soportado)...","markdownHint":"Consejo: Usa markdown para formatear. Ctrl/Cmd+S para guardar, Esc para cancelar.","enterHint":"Enter para guardar  Shift+Enter para nueva l\xednea  Esc para cancelar","hint":"Consejo: Usa markdown para formatear. Ctrl/Cmd+S para guardar, Esc para cancelar.","editComment":"Editar comentario","save":"Guardar","cancel":"Cancelar","saveShortcut":"Guardar (Cmd/Ctrl+S)","cancelShortcut":"Cancelar (Esc)"},"gameTree":{"switchToVertical":"Cambiar a disposici\xf3n vertical","switchToHorizontal":"Cambiar a disposici\xf3n horizontal","hideMinimap":"Ocultar minimapa","showMinimap":"Mostrar minimapa","centerOnPosition":"Centrar en posici\xf3n"},"boardControls":{"captured":"Capturadas","branch":"Variante","move":"Movimiento","goToStart":"Ir al inicio (Inicio)","goToEnd":"Ir al final (Fin)","goBack10":"Retroceder 10 movimientos","goForward10":"Avanzar 10 movimientos","previousMove":"Movimiento anterior ()","nextMove":"Siguiente movimiento ()","previousBranch":"Variante anterior ()","nextBranch":"Siguiente variante ()","clickToJumpMove":"Clic para ir al movimiento","clickToSetBranch":"Clic para establecer ID de variante","movesIntoBranch":"{{count}} movimientos en variante","resignGame":"Rendirse","resignConfirm":"{{player}} se va a rendir. \xbfEst\xe1s seguro?","resign":"Rendirse"},"scoring":{"clear":"Limpiar","clearAllDeadStones":"Limpiar todas las piedras muertas","territoryBlackTitle":"Territorio negro","territoryWhiteTitle":"Territorio blanco","capturesBlackTitle":"Capturas negras","capturesWhiteTitle":"Capturas blancas","deadStonesBlackTitle":"Piedras negras muertas","deadStonesWhiteTitle":"Piedras blancas muertas","komiTitle":"Komi (compensaci\xf3n blancas)","markedAsDead":"{{count}} piedra(s) marcada(s) como muerta(s)","autoEstimate":"Estimar autom\xe1ticamente","autoEstimateDescription":"Usar simulaci\xf3n Monte Carlo para detectar autom\xe1ticamente piedras muertas","estimating":"Estimando...","done":"Hecho","exitScoringMode":"Salir del modo puntuaci\xf3n (S)","territory":"Territorio:","captures":"Capturas:","deadStones":"Piedras muertas:","komi":"Komi:","total":"Total:","jigo":"Empate","winsBy":"{{player}} gana por {{points}} puntos","clickToToggle":"Haz clic en las piedras para cambiar su estado","stonesMarkedDead":"{{count}} piedra marcada como muerta","stonesMarkedDeadPlural":"{{count}} piedras marcadas como muertas"},"mobileTab":{"board":"Tablero","info":"Info","tree":"\xc1rbol","analysis":"An\xe1lisis","library":"Biblioteca"},"toast":{"exportedFile":"\\"{{filename}}\\" exportado","savedToLibrary":"Guardado en la biblioteca","savedFileToLibrary":"\\"{{filename}}\\" guardado en la biblioteca","libraryFileNotFound":"Archivo de biblioteca no encontrado. Guardando como nuevo...","failedToSave":"Error al guardar en la biblioteca","sgfCopied":"\xa1SGF copiado al portapapeles!","failedToCopy":"Error al copiar: {{error}}","clipboardEmpty":"El portapapeles est\xe1 vac\xedo","downloadingFromOgs":"Descargando partida {{gameId}} de OGS...","gameLoadedFromOgs":"\xa1Partida cargada desde OGS ({{gameId}})!","gameLoadedFromClipboard":"\xa1Partida cargada desde el portapapeles!","failedToPaste":"Error al pegar: {{error}}","failedToLoadSgf":"Error al cargar el archivo SGF: {{error}}"},"loading":{"loadingSgfFile":"Cargando archivo SGF"},"dropzone":{"dropToLoad":"Suelta para cargar la partida","dropOnLibrary":"Suelta en la Biblioteca para guardar"},"languageSwitcher":{"changeLanguage":"Cambiar idioma","selectLanguage":"Seleccionar idioma"},"gameboardActions":{"pass":"Pasar","resign":"Rendirse","score":"Puntuaci\xf3n","scoring":"Puntuaci\xf3n","analyze":"Analizar","analysis":"An\xe1lisis","navigate":"Navegar","edit":"Editar","show":"Mostrar","hide":"Ocultar","enterScoringMode":"Activar modo puntuaci\xf3n (S)","exitScoringMode":"Salir del modo puntuaci\xf3n (S)","showAnalysis":"Mostrar barra de an\xe1lisis (A)","hideAnalysis":"Ocultar barra de an\xe1lisis (A)","analysisActiveHidden":"Modo de an\xe1lisis activo (clic para mostrar panel)","enterNavigationMode":"Activar modo navegaci\xf3n (N)","exitNavigationMode":"Salir del modo navegaci\xf3n (N)","enterEditMode":"Activar modo edici\xf3n (E)","exitEditMode":"Salir del modo edici\xf3n (E)","showNextMove":"Mostrar siguiente movimiento","hideNextMove":"Ocultar siguiente movimiento","suggestMove":"Sugerir jugada","suggestMoveTitle":"Pedir a la IA que sugiera una jugada (G)","suggesting":"Sugiriendo...","loadAiModelFirst":"Por favor, carga primero un modelo de IA","initializingAiEngine":"Inicializando motor de IA...","aiEngineInitializing":"El motor de IA se est\xe1 inicializando, int\xe9ntalo de nuevo","failedToGenerateMove":"Error al generar jugada de IA"},"analysisBar":{"uploadingModel":"Subiendo modelo ({{progress}}%)","checkingCache":"Verificando cach\xe9...","initializing":"Inicializando...","loading":"Cargando...","analyzing":"Analizando...","winRate":"Tasa de victoria","blackWinRate":"Victoria Negras","whiteWinRate":"Victoria Blancas","scoreLead":"Ventaja","analyzeFullGameLong":"Analizar partida completa (puede tardar varios minutos)"},"panels":{"library":"Biblioteca","analysis":"An\xe1lisis","gameTree":"\xc1rbol de juego","gameInfo":"Info partida","comment":"Comentario","showLibrary":"Mostrar biblioteca (Ctrl+L)","showSidebar":"Mostrar barra lateral (Ctrl+B)"},"quickNewGameTooltip":"Nueva partida r\xe1pida ({{size}}\xd7{{size}}) -  \xa1Elimina la partida actual sin guardar!","close":"Cerrar","aboutKaya":"Acerca de Kaya","aboutDescription":"Una hermosa aplicaci\xf3n de Go con an\xe1lisis de IA impulsado por KataGo","aboutVersion":"Versi\xf3n","aboutCommit":"Commit","aboutBuildDate":"Fecha de compilaci\xf3n","aboutLicense":"Licencia","aboutGitHub":"Repositorio de GitHub","aboutReportIssue":"Reportar un problema","aboutVersionNotAvailable":"Informaci\xf3n de versi\xf3n no disponible"}'),sM=JSON.parse('{"addToLibrary":"Aggiungi alla libreria","landing":{"tagline":"Un\'applicazione moderna per il Go","continue":"Continua partita","newGame":"Nuova partita","library":"Libreria","dropSgfToOpen":"Trascina un file SGF"},"black":"Nero:","boardSettings":"Impostazioni tavola","boardSize":"Dimensione tavola:","cancel":"Annulla","clickToRename":"Clicca per rinominare","commit":"Commit:","confirm":"Conferma","copySgf":"Copia SGF","copySgfToClipboard":"Copia SGF negli appunti","createGame":"Crea partita","darkMode":"Modalit\xe0 scura","date":"Data:","discard":"Scarta","enableSounds":"Attiva suoni","enterFullscreen":"Schermo intero","exitFullscreen":"Esci da schermo intero","exportToDisk":"Esporta su disco","extensionNote":"L\'estensione .sgf verr\xe0 aggiunta automaticamente","filename":"Nome file:","game":"Partita","gameSgf":"partita.sgf","handicap":"Handicap:","hideLibrary":"Nascondi libreria","hideMenu":"Nascondi menu","hideSidebar":"Nascondi barra laterale","home":"Home","komi":"Komi:","language":"Lingua","learnMore":"Scopri di pi\xf9 su Sensei\'s Library","libraryRoot":"Radice libreria","lightMode":"Modalit\xe0 chiara","menu":"Menu","moreActions":"Altro","muteSounds":"Muto","new":"Nuovo","newGame":"Nuova partita","newGameEllipsis":"Nuova partita...","open":"Apri","openSgf":"Apri SGF...","openSgfFile":"Apri file SGF","pasteSgf":"Incolla SGF","pasteSgfOrOgs":"Incolla SGF o URL OGS","pasteSgfUrl":"Incolla SGF/URL","patternDisabled":"Corrispondenza pattern disattivata (clicca per attivare)","patternEnabled":"Corrispondenza pattern attivata (clicca per disattivare)","playerName":"Nome giocatore","players":"Giocatori","quickNewGame":"Nuova partita veloce","rank":"Grado:","rankPlaceholder":"es. 5k, 3d","reportBug":"Segnala un bug o suggerisci una funzionalit\xe0","reportIssue":"Segnala problema","save":"Salva","saveAs":"Salva con nome...","saveAsShort":"Salva come","saveGame":"Salva partita","saveToFolder":"Salva nella cartella:","saveToLibrary":"Salva nella libreria","settings":"Impostazioni","showLibrary":"Mostra libreria","showSidebar":"Mostra barra laterale","startNewGame":"Iniziare nuova partita?","startNewGameConfirm":"La partita corrente andr\xe0 persa se non viene salvata. Sei sicuro di voler iniziare una nuova partita?","switchToDarkMode":"Passa alla modalit\xe0 scura","switchToLightMode":"Passa alla modalit\xe0 chiara","unsavedChanges":"Modifiche non salvate","version":"Versione:","viewCommit":"Visualizza commit su GitHub","viewOnGitHub":"Visualizza su GitHub","viewVersion":"Visualizza versione su GitHub","white":"Bianco:","unsavedChangesLost":"Hai modifiche non salvate che andranno perse. Continuare comunque?","unsavedChangesPrompt":"Hai modifiche non salvate. Cosa vuoi fare?","edit":"Modifica","export":"Esporta","copy":"Copia","paste":"Incolla","aiConfig":{"title":"Impostazioni analisi","modelLibrary":"Libreria modelli","modelLibraryDescription":"Seleziona un modello per l\'analisi IA. Espandi per scegliere il livello di quantizzazione.","active":"Attivo","recommended":"Consigliato","default":"Predefinito","downloaded":"scaricato/i","customModels":"Modelli personalizzati","downloadModel":"Scarica modello","deleteModel":"Elimina modello","uploadCustomModel":"Carica modello personalizzato","uploadCustomModelDescription":"Sono supportati solo modelli .onnx. I pesi KataGo (.bin.gz o .bin) devono essere prima convertiti usando:","analysisOptions":"Opzioni di analisi","inferenceBackend":"Backend di inferenza","inferenceBackendDescription":"Scegli come eseguire il modello IA. Native \xe8 il pi\xf9 veloce, WebGPU usa la GPU, WASM usa la CPU (massima compatibilit\xe0).","nativeAuto":"Native - Automatico (GPU se disponibile)","nativeCpu":"Native - Solo CPU","webgpu":"WebGPU (GPU browser)","wasm":"WASM (CPU browser)","maxTopMoves":"Massimo mosse da mostrare","maxTopMovesDescription":"Numero massimo di mosse candidate da mostrare sulla tavola.","minProbability":"Probabilit\xe0 minima","minProbabilityDescription":"Nascondere le mosse con probabilit\xe0 sotto questa soglia.","saveAnalysisToSgf":"Salva analisi in SGF","saveAnalysisToSgfDescription":"Incorpora i dati di analisi IA (percentuale vittoria, punti, mosse) quando salvi come SGF. Aumenta la dimensione del file ma preserva l\'analisi.","modelUploadedSuccess":"Modello caricato con successo","modelUploadFailed":"Caricamento modello fallito","modelDownloadedSuccess":"Modello scaricato con successo","modelDownloadFailed":"Download modello fallito","modelDeletedSuccess":"Modello eliminato","modelDeleteFailed":"Eliminazione modello fallita","getStartedTitle":"Inizia con l\'analisi IA","getStartedDescription":"Scarica un modello per attivare i suggerimenti di mosse e l\'analisi delle partite con l\'IA.","downloadRecommended":"Scarica il modello consigliato","downloading":"Download in corso...","poweredBy":"Motore IA basato su"},"kayaConfig":{"title":"Impostazioni","close":"Chiudi impostazioni","analysisTab":"Analisi","gameTab":"Gioco","boardSettings":"Impostazioni della tavola","fuzzyStonePlacement":"Posizionamento sfocato delle pietre","fuzzyStonePlacementDescription":"Aggiunge leggeri spostamenti casuali alle posizioni delle pietre per un aspetto pi\xf9 naturale.","on":"Attivo","off":"Disattivo"},"analysis":{"toggleOwnership":"Attiva/disattiva mappa di calore territorio","toggleTopMoves":"Attiva/disattiva migliori mosse","toggleWinRate":"Attiva/disattiva grafico tasso vittoria","toggleScore":"Attiva/disattiva grafico punteggio","winRate":"Tasso vittoria","score":"Punteggio","visualizationGroup":"Opzioni di visualizzazione","actionsGroup":"Azioni di analisi","analyzeFullGame":"Analizza partita completa","stopAnalysis":"Ferma analisi","waitingForEngine":"In attesa del motore...","clearCache":"Svuota cache analisi","clearCacheWithCount":"Svuota {{count}} analisi in cache","noCachedAnalysis":"Nessuna analisi in cache","analysisLegend":"Legenda analisi","positionsAnalyzed":"{{analyzed}}/{{total}} posizioni analizzate nella variante corrente","initializingEngine":"Inizializzazione motore...","analyzing":"Analizzando...","stopping":"Fermando...","analyzingProgress":"Analizzando: {{progress}}%","stopAnalysisButton":"Ferma analisi","analysisModeOn":"Modalit\xe0 analisi attiva - Clicca per disattivare","analysisModeOff":"Modalit\xe0 analisi disattiva - Clicca per attivare"},"analysisLegend":{"title":"Legenda analisi","policyDescription":"I colori indicano la <strong>probabilit\xe0 di policy</strong> dell\'IA per ogni mossa candidata. Rappresenta la confidenza della rete neurale che la mossa sia la migliore.","best":"Migliore","bestProb":"70% probabilit\xe0","great":"Ottima","greatProb":"60-70%","good":"Buona","goodProb":"40-60%","okay":"Accettabile","okayProb":"10-40%","poor":"Scarsa","poorProb":"<10%","note":"L\'implementazione ONNX KataGo attuale fornisce probabilit\xe0 di policy, ma non include percentuale di vittoria o differenza punti per le singole mosse candidate. Questi sono disponibili solo per la posizione corrente della tavola.","heatmapOwnership":"Propriet\xe0 mappa di calore","heatmapDescription":"La mappa di calore propriet\xe0 mostra il territorio previsto a fine partita. Colori pi\xf9 intensi indicano maggiore confidenza che l\'area appartenga al giocatore.","blackArea":"Territorio nero","whiteArea":"Territorio bianco"},"library":{"newFolder":"Nuova cartella","importSgfZip":"Importa SGF/ZIP","exportLibraryAsZip":"Esporta libreria come ZIP","clearLibrary":"Svuota libreria","loading":"Caricamento...","emptyLibrary":"La libreria \xe8 vuota","emptyLibraryHint":"Trascina file SGF qui o clicca destro per creare una cartella","dropToAdd":"Rilascia per aggiungere","itemsSelected":"{{count}} selezionati","duplicateSelected":"Duplica selezionati","downloadSelected":"Scarica selezionati","deleteSelected":"Elimina selezionati","clearSelection":"Cancella selezione","gamesCount":"{{count}} partite","foldersCount":"{{count}} cartelle","deleteFolder":"Elimina cartella","deleteFolderConfirm":"Eliminare la cartella \\"{{name}}\\" e tutto il suo contenuto?","deleteFile":"Elimina file","deleteFileConfirm":"Eliminare \\"{{name}}\\"?","deleteItemsTitle":"Elimina {{count}} elementi","deleteItemsConfirm":"Eliminare {{count}} elementi selezionati? Questa azione non pu\xf2 essere annullata.","clearLibraryTitle":"Svuota libreria","clearLibraryConfirm":"Eliminare tutti i {{count}} elementi dalla libreria? Questa azione non pu\xf2 essere annullata.","load":"Carica","rename":"Rinomina","duplicate":"Duplica","download":"Scarica","moveToRoot":"Sposta alla radice","delete":"Elimina","duplicateItems":"Duplica {{count}}","downloadItems":"Scarica {{count}}","deleteItems":"Elimina {{count}}","create":"Crea","unsavedChangesIndicator":"Modifiche non salvate"},"updater":{"checkForUpdates":"Controlla aggiornamenti...","updateAvailable":"Aggiornamento disponibile","versionAvailable":"La versione {{version}} \xe8 disponibile.","installing":"Installazione aggiornamento...Attendere.","skipVersion":"Salta questa versione","remindLater":"Ricorda pi\xf9 tardi","updateNow":"Aggiorna ora","noUpdateAvailable":"Nessun aggiornamento disponibile","youAreOnLatest":"Hai l\'ultima versione.","checkFailed":"Controllo aggiornamenti fallito.","manualDownload":"Download manuale:","updateInstalled":"Aggiornamento installato","restartPrompt":"L\'aggiornamento \xe8 stato installato. Riavviare ora per applicare le modifiche?","restart":"Riavvia","later":"Pi\xf9 tardi","updateFailed":"Aggiornamento fallito","updateFailedMessage":"Installazione aggiornamento fallita. Riprova pi\xf9 tardi o scarica manualmente l\'ultima versione:"},"editToolbar":{"stones":"Pietre","playMode":"Modalit\xe0 gioco","setupMode":"Modalit\xe0 configurazione","alternate":"Alternato","blackStone":"Nero","black":"Nero","whiteStone":"Bianco","white":"Bianco","pass":"Passa","clearSetupStones":"Cancella pietre configurazione","markers":"Marcatori","triangle":"Triangolo","square":"Quadrato","circle":"Cerchio","cross":"\xd7","labelAlpha":"ABC","labelNum":"123","eraseMarker":"Cancella","eraseAll":"Cancella tutto","branch":"Variante","makeMainBranch":"Rendi variante principale","copyBranch":"Copia","copy":"Copia","pasteBranch":"Incolla","paste":"Incolla","deleteCurrentBranch":"Elimina variante corrente","deleteOtherBranches":"Elimina altre varianti (mantieni solo linea corrente)","history":"Cronologia","undo":"Annulla","redo":"Ripeti"},"gameInfo":{"game":"Partita","untitled":"Senza titolo","date":"Data","datePlaceholder":"AAAA-MM-GG","place":"Luogo","placePlaceholder":"es. OGS, KGS","black":"Nero","white":"Bianco","blackRank":"Grado Nero","whiteRank":"Grado Bianco","komi":"Komi","handicap":"Handicap","rules":"Regole","rulesPlaceholder":"es. Giapponesi, Cinesi","timeControl":"Controllo tempo","timePlaceholder":"es. 900 5x30 byo-yomi","result":"Risultato","resultPlaceholder":"es. N+0.5, B+R","clickToAdd":"Clicca per aggiungere","editHint":"Clicca su un campo per modificare. Invio per salvare, Esc per annullare.","editAllFields":"Modifica tutti i campi","exitEditMode":"Esci dalla modalit\xe0 modifica"},"comment":{"move":"Mossa {{number}}","moveNumber":"Mossa {{number}}","noMoveSelected":"Nessuna mossa selezionata","noComment":"Nessun commento. Clicca per aggiungere.","placeholder":"Scrivi un commento (markdown supportato)...","markdownHint":"Suggerimento: Usa markdown per formattare. Ctrl/Cmd+S per salvare, Esc per annullare.","enterHint":"Invio per salvare  Shift+Invio per nuova riga  Esc per annullare","hint":"Suggerimento: Usa markdown per formattare. Ctrl/Cmd+S per salvare, Esc per annullare.","editComment":"Modifica commento","save":"Salva","cancel":"Annulla","saveShortcut":"Salva (Cmd/Ctrl+S)","cancelShortcut":"Annulla (Esc)"},"gameTree":{"switchToVertical":"Passa a layout verticale","switchToHorizontal":"Passa a layout orizzontale","hideMinimap":"Nascondi minimappa","showMinimap":"Mostra minimappa","centerOnPosition":"Centra sulla posizione"},"boardControls":{"captured":"Catturate","branch":"Variante","move":"Mossa","goToStart":"Vai all\'inizio (Home)","goToEnd":"Vai alla fine (Fine)","goBack10":"Indietro di 10 mosse","goForward10":"Avanti di 10 mosse","previousMove":"Mossa precedente ()","nextMove":"Mossa successiva ()","previousBranch":"Variante precedente ()","nextBranch":"Variante successiva ()","clickToJumpMove":"Clicca per saltare alla mossa","clickToSetBranch":"Clicca per impostare ID variante","movesIntoBranch":"{{count}} mosse nella variante","resignGame":"Abbandona","resignConfirm":"{{player}} sta per abbandonare. Sei sicuro?","resign":"Abbandona"},"scoring":{"clear":"Cancella","clearAllDeadStones":"Cancella tutte le pietre morte","territoryBlackTitle":"Territorio nero","territoryWhiteTitle":"Territorio bianco","capturesBlackTitle":"Catture nere","capturesWhiteTitle":"Catture bianche","deadStonesBlackTitle":"Pietre nere morte","deadStonesWhiteTitle":"Pietre bianche morte","komiTitle":"Komi (compensazione bianco)","markedAsDead":"{{count}} pietra/e segnata/e come morta/e","autoEstimate":"Stima automatica","autoEstimateDescription":"Usa simulazione Monte Carlo per rilevare automaticamente le pietre morte","estimating":"Stimando...","done":"Fatto","exitScoringMode":"Esci dalla modalit\xe0 punteggio (S)","territory":"Territorio:","captures":"Catture:","deadStones":"Pietre morte:","komi":"Komi:","total":"Totale:","jigo":"Pareggio","winsBy":"{{player}} vince di {{points}} punti","clickToToggle":"Clicca sulle pietre per cambiare stato","stonesMarkedDead":"{{count}} pietra segnata come morta","stonesMarkedDeadPlural":"{{count}} pietre segnate come morte"},"mobileTab":{"board":"Tavola","info":"Info","tree":"Albero","analysis":"Analisi","library":"Libreria"},"toast":{"exportedFile":"\\"{{filename}}\\" esportato","savedToLibrary":"Salvato nella libreria","savedFileToLibrary":"\\"{{filename}}\\" salvato nella libreria","libraryFileNotFound":"File libreria non trovato. Salvataggio come nuovo...","failedToSave":"Salvataggio nella libreria fallito","sgfCopied":"SGF copiato negli appunti!","failedToCopy":"Copia fallita: {{error}}","clipboardEmpty":"Gli appunti sono vuoti","downloadingFromOgs":"Scaricamento partita {{gameId}} da OGS...","gameLoadedFromOgs":"Partita caricata da OGS ({{gameId}})!","gameLoadedFromClipboard":"Partita caricata dagli appunti!","failedToPaste":"Incolla fallito: {{error}}","failedToLoadSgf":"Caricamento file SGF fallito: {{error}}"},"loading":{"loadingSgfFile":"Caricamento file SGF"},"dropzone":{"dropToLoad":"Rilascia per caricare la partita","dropOnLibrary":"Rilascia sulla Libreria per salvare"},"languageSwitcher":{"changeLanguage":"Cambia lingua","selectLanguage":"Seleziona lingua"},"gameboardActions":{"pass":"Passa","resign":"Abbandona","score":"Punteggio","scoring":"Punteggio","analyze":"Analizza","analysis":"Analisi","navigate":"Naviga","edit":"Modifica","show":"Mostra","hide":"Nascondi","enterScoringMode":"Attiva modalit\xe0 punteggio (S)","exitScoringMode":"Esci dalla modalit\xe0 punteggio (S)","showAnalysis":"Mostra barra analisi (A)","hideAnalysis":"Nascondi barra analisi (A)","analysisActiveHidden":"Modalit\xe0 analisi attiva (clicca per mostrare pannello)","enterNavigationMode":"Attiva modalit\xe0 navigazione (N)","exitNavigationMode":"Esci dalla modalit\xe0 navigazione (N)","enterEditMode":"Attiva modalit\xe0 modifica (E)","exitEditMode":"Esci dalla modalit\xe0 modifica (E)","showNextMove":"Mostra prossima mossa","hideNextMove":"Nascondi prossima mossa","suggestMove":"Suggerisci mossa","suggestMoveTitle":"Chiedi all\'IA di suggerire una mossa (G)","suggesting":"Suggerendo...","loadAiModelFirst":"Carica prima un modello AI","initializingAiEngine":"Inizializzazione motore AI...","aiEngineInitializing":"Il motore AI si sta inizializzando, riprova","failedToGenerateMove":"Generazione mossa AI fallita"},"analysisBar":{"uploadingModel":"Caricamento modello ({{progress}}%)","checkingCache":"Verifica cache...","initializing":"Inizializzazione...","loading":"Caricamento...","analyzing":"Analisi in corso...","winRate":"Tasso vittoria","blackWinRate":"Vittoria Nero","whiteWinRate":"Vittoria Bianco","scoreLead":"Vantaggio","analyzeFullGameLong":"Analizza partita completa (pu\xf2 richiedere diversi minuti)"},"panels":{"library":"Libreria","analysis":"Analisi","gameTree":"Albero di gioco","gameInfo":"Info partita","comment":"Commento","showLibrary":"Mostra libreria (Ctrl+L)","showSidebar":"Mostra barra laterale (Ctrl+B)"},"quickNewGameTooltip":"Nuova partita veloce ({{size}}\xd7{{size}}) -  Elimina la partita corrente senza salvare!","close":"Chiudi","aboutKaya":"Informazioni su Kaya","aboutDescription":"Una bella applicazione di Go con analisi IA alimentata da KataGo","aboutVersion":"Versione","aboutCommit":"Commit","aboutBuildDate":"Data di compilazione","aboutLicense":"Licenza","aboutGitHub":"Repository GitHub","aboutReportIssue":"Segnala un problema","aboutVersionNotAvailable":"Informazioni sulla versione non disponibili"}');let sz={en:"English",zh:"",ko:"",ja:"",fr:"Fran\xe7ais",de:"Deutsch",es:"Espa\xf1ol",it:"Italiano"},sj="en",sR="kaya-locale";function sL(){if("undefined"!=typeof window){let e=localStorage.getItem(sR);if(e&&e in sz)return e;let t=navigator.language.split("-")[0];if(t in sz)return t}return sj}let sF={en:sI,zh:s$,ko:sO,ja:sA,fr:sN,de:sP,es:sD,it:sM};async function sB(e){if(!rs.hasResourceBundle(e,"translation")){let t=sF[e];t&&rs.addResourceBundle(e,"translation",t)}await rs.changeLanguage(e),"undefined"!=typeof window&&localStorage.setItem(sR,e)}rs.use(rZ).init({resources:{en:{translation:sI}},lng:sL(),fallbackLng:sj,interpolation:{escapeValue:!1},react:{useSuspense:!1,bindI18n:"languageChanged loaded",bindI18nStore:"added removed"}});let sU=(0,x.createContext)(null);function sV(){let e=(0,x.useContext)(sU);if(!e)throw Error("useI18n must be used within an I18nProvider");return e}function sG(e){let{children:t}=e,[n,i]=(0,x.useState)(()=>{let e=rs.language;return e in sz?e:sj}),[a,o]=(0,x.useState)(!0);(0,x.useEffect)(()=>{(async()=>{let e=sL();await sB(e),i(e),o(!1)})()},[]),(0,x.useEffect)(()=>{let e=e=>{e in sz&&i(e)};return rs.on("languageChanged",e),()=>{rs.off("languageChanged",e)}},[]);let s=(0,x.useCallback)(async e=>{if(e!==n){o(!0);try{await sB(e)}finally{o(!1)}}},[n]),l={locale:n,setLocale:s,locales:sz,isLoading:a};return(0,v.jsx)(sU.Provider,{value:l,children:t})}function sH(e){let{children:t}=e;return(0,v.jsx)(rX,{i18n:rs,children:(0,v.jsx)(sG,{children:t})})}let sW={en:"\uD83C\uDDFA\uD83C\uDDF8",zh:"\uD83C\uDDE8\uD83C\uDDF3",ko:"\uD83C\uDDF0\uD83C\uDDF7",ja:"\uD83C\uDDEF\uD83C\uDDF5",fr:"\uD83C\uDDEB\uD83C\uDDF7",de:"\uD83C\uDDE9\uD83C\uDDEA",es:"\uD83C\uDDEA\uD83C\uDDF8",it:"\uD83C\uDDEE\uD83C\uDDF9"},sq=e=>{let{isOpen:t,onClose:n,versionData:i,onNewGame:a,onQuickNewGame:o,onOpen:s,onSave:l,onSaveAs:u,onExport:c,onCopySGF:d,onPasteSGF:p,onGoHome:h,isDirty:f=!1,isInLibrary:g=!1}=e,{theme:m,toggleTheme:y}=C(),{soundEnabled:b,toggleSound:w}=sE(),{t:_}=rK(),{locale:S,setLocale:k,locales:T}=sV(),[E,I]=(0,x.useState)(!1);if(!t)return null;let $=async e=>{await k(e),I(!1)};return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"mobile-menu-overlay",onClick:n}),(0,v.jsxs)("div",{className:`mobile-menu ${t?"open":""}`,children:[(0,v.jsxs)("div",{className:"mobile-menu-header",children:[(0,v.jsxs)("h2",{className:"mobile-menu-title",children:["Kaya",(null==i?void 0:i.version)&&(0,v.jsxs)("span",{className:"mobile-menu-version-tag",children:["v",i.version]})]}),(0,v.jsx)("button",{className:"mobile-menu-close",onClick:n,children:(0,v.jsx)(oY,{size:24})})]}),(0,v.jsxs)("div",{className:"mobile-menu-content",children:[(0,v.jsxs)("div",{className:"mobile-menu-section",children:[(0,v.jsx)("h3",{className:"mobile-menu-section-title",children:_("game")}),h&&(0,v.jsxs)("button",{className:"mobile-menu-item",onClick:()=>{h(),n()},children:[(0,v.jsx)(og,{size:20}),(0,v.jsx)("span",{children:_("home")})]}),(0,v.jsxs)("button",{className:"mobile-menu-item",onClick:()=>{o(),n()},children:[(0,v.jsx)(oQ,{size:20}),(0,v.jsx)("span",{children:_("quickNewGame")})]}),(0,v.jsxs)("button",{className:"mobile-menu-item",onClick:()=>{a(),n()},children:[(0,v.jsx)(oO,{size:20}),(0,v.jsx)("span",{children:_("newGameEllipsis")})]}),(0,v.jsxs)("button",{className:"mobile-menu-item",onClick:()=>{s(),n()},children:[(0,v.jsx)(oa,{size:20}),(0,v.jsx)("span",{children:_("openSgf")})]}),(0,v.jsxs)("button",{className:"mobile-menu-item",onClick:()=>{l(),n()},disabled:!f&&g,children:[(0,v.jsx)(oD,{size:20}),(0,v.jsx)("span",{children:_("save")})]}),(0,v.jsxs)("button",{className:"mobile-menu-item",onClick:()=>{u(),n()},children:[(0,v.jsx)(aH,{size:20}),(0,v.jsx)("span",{children:_("saveAs")})]}),(0,v.jsxs)("button",{className:"mobile-menu-item",onClick:()=>{c(),n()},children:[(0,v.jsx)(a5,{size:20}),(0,v.jsx)("span",{children:_("exportToDisk")})]})]}),(0,v.jsxs)("div",{className:"mobile-menu-section",children:[(0,v.jsx)("h3",{className:"mobile-menu-section-title",children:_("edit")}),(0,v.jsxs)("button",{className:"mobile-menu-item",onClick:()=>{d(),n()},children:[(0,v.jsx)(a4,{size:20}),(0,v.jsx)("span",{children:_("copySgf")})]}),(0,v.jsxs)("button",{className:"mobile-menu-item",onClick:()=>{p(),n()},children:[(0,v.jsx)(a3,{size:20}),(0,v.jsx)("span",{children:_("pasteSgf")})]})]}),(0,v.jsxs)("div",{className:"mobile-menu-section",children:[(0,v.jsx)("h3",{className:"mobile-menu-section-title",children:_("settings")}),(0,v.jsxs)("button",{className:"mobile-menu-item",onClick:y,children:["dark"===m?(0,v.jsx)(oB,{size:20}):(0,v.jsx)(oT,{size:20}),(0,v.jsx)("span",{children:_("dark"===m?"lightMode":"darkMode")})]}),(0,v.jsxs)("button",{className:"mobile-menu-item",onClick:w,children:[b?(0,v.jsx)(oX,{size:20}):(0,v.jsx)(oZ,{size:20}),(0,v.jsx)("span",{children:_(b?"muteSounds":"enableSounds")})]}),(0,v.jsxs)("button",{className:"mobile-menu-item mobile-menu-item-expandable",onClick:()=>I(!E),children:[(0,v.jsx)(od,{size:20}),(0,v.jsx)("span",{children:_("language")}),(0,v.jsxs)("span",{className:"mobile-menu-item-value",children:[sW[S]," ",T[S]]}),(0,v.jsx)(a0,{size:16,className:`mobile-menu-chevron ${E?"expanded":""}`})]}),E&&(0,v.jsx)("div",{className:"mobile-menu-submenu",children:Object.entries(T).map(e=>{let[t,n]=e;return(0,v.jsxs)("button",{className:`mobile-menu-submenu-item ${t===S?"active":""}`,onClick:()=>$(t),children:[(0,v.jsx)("span",{className:"mobile-menu-flag",children:sW[t]}),(0,v.jsx)("span",{className:"mobile-menu-language-name",children:n}),t===S&&(0,v.jsx)(aY,{size:16,className:"mobile-menu-check"})]},t)})})]}),(0,v.jsx)("div",{className:"mobile-menu-section",children:(0,v.jsxs)("a",{href:"https://github.com/kaya-go/kaya",target:"_blank",rel:"noopener noreferrer",className:"mobile-menu-item",children:[(0,v.jsx)(oc,{size:20}),(0,v.jsx)("span",{children:"GitHub"})]})})]}),(0,v.jsx)("div",{className:"mobile-menu-footer",children:i&&(0,v.jsxs)("div",{className:"mobile-menu-version-info",children:[(0,v.jsxs)("div",{children:[_("version")," ",i.version]}),i.gitHash&&(0,v.jsxs)("div",{children:[_("commit")," ",i.gitHash.substring(0,7)]}),i.buildDate&&(0,v.jsxs)("div",{children:[_("date")," ",new Date(i.buildDate).toLocaleDateString()]})]})})]})]})};function sK(){return`${Date.now()}-${Math.random().toString(36).substring(2,9)}`}function sX(){return Date.now()}function sZ(e){try{var t,n,i,a,o,s,l,u,c,d,p;let h=V(e);if(!h||0===h.length)return{};let f=h[0],g=f.data||{},m=0,y=e=>{var t,n;for(let i of(((null==(t=e.data)?void 0:t.B)||(null==(n=e.data)?void 0:n.W))&&m++,e.children||[]))y(i)};return y(f),{gameName:null==(t=g.GN)?void 0:t[0],blackPlayer:null==(n=g.PB)?void 0:n[0],whitePlayer:null==(i=g.PW)?void 0:i[0],blackRank:null==(a=g.BR)?void 0:a[0],whiteRank:null==(o=g.WR)?void 0:o[0],result:null==(s=g.RE)?void 0:s[0],date:null==(l=g.DT)?void 0:l[0],event:null==(u=g.EV)?void 0:u[0],boardSize:(null==(c=g.SZ)?void 0:c[0])?parseInt(g.SZ[0],10):19,komi:(null==(d=g.KM)?void 0:d[0])?parseFloat(g.KM[0]):void 0,handicap:(null==(p=g.HA)?void 0:p[0])?parseInt(g.HA[0],10):void 0,moveCount:m}}catch{return{}}}function sY(e){try{let t=V(e);return t&&t.length>0}catch{return!1}}function sQ(e){return e.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g," ").trim()}function sJ(e){let t=e.lastIndexOf(".");return t>=0?e.substring(t):""}function s0(e){let t=e.lastIndexOf(".");return t>=0?e.substring(0,t):e}function s1(e){return".sgf"===sJ(e).toLowerCase()?e:`${s0(e)}.sgf`}function s2(e){return e<1024?`${e} B`:e<1048576?`${(e/1024).toFixed(1)} KB`:`${(e/1048576).toFixed(1)} MB`}function s3(e,t,n){let i=e.toLowerCase();return t.some(e=>e.name.toLowerCase()===i&&e.id!==n)}function s4(e,t,n){if(!s3(e,t,n))return e;let i=1,a=`${e} (${i})`;for(;s3(a,t,n);)i++,a=`${e} (${i})`;return a}let s6="kaya-library",s5=1,s8="items",s7="kaya-library-sgf-extension-migrated";class s9{async initialize(){if(this.db)return;if(this.initError)throw this.initError;if(this.initPromise)return this.initPromise;if("undefined"==typeof indexedDB)throw this.initError=Error("IndexedDB is not available. Library storage requires IndexedDB support."),this.initError;let e=1e4;return this.initPromise=new Promise((t,n)=>{let i=null,a=!1,o=(e,o)=>{a||(a=!0,i&&(clearTimeout(i),i=null),e?t():(this.initError=o||Error("Database initialization failed"),this.initPromise=null,n(this.initError)))};i=setTimeout(()=>{o(!1,Error("Database initialization timed out. This may happen in private/incognito browsing mode with strict privacy settings."))},e);try{let e=indexedDB.open(s6,s5);e.onerror=()=>{o(!1,Error("Failed to open library database. This may happen in private/incognito browsing mode."))},e.onsuccess=async()=>{this.db=e.result,this.db.onclose=()=>{this.db=null,this.initPromise=null},this.db.onerror=()=>{console.error("IndexedDB error occurred")};try{await this.migrateSgfExtensions()}catch(e){console.warn("Migration warning:",e)}o(!0)},e.onupgradeneeded=e=>{let t=e.target.result;if(!t.objectStoreNames.contains(s8)){let e=t.createObjectStore(s8,{keyPath:"id"});e.createIndex("parentId","parentId",{unique:!1}),e.createIndex("type","type",{unique:!1}),e.createIndex("name","name",{unique:!1}),e.createIndex("updatedAt","updatedAt",{unique:!1})}},e.onblocked=()=>{o(!1,Error("Database is blocked. Please close other tabs using this application."))}}catch(e){o(!1,e instanceof Error?e:Error("Failed to initialize database"))}}),this.initPromise}async ensureInitialized(){if(!this.db){if(this.initPromise)return void await this.initPromise;if(this.initError)throw this.initError;await this.initialize()}}async migrateSgfExtensions(){if("undefined"!=typeof localStorage&&localStorage.getItem(s7)||!this.db)return;let e=this.getStore("readwrite"),t=await this.request(e.getAll()),n=0;for(let e of t)if("file"===e.type&&".sgf"!==sJ(e.name).toLowerCase()){e.name=`${e.name}.sgf`;let t=this.getStore("readwrite");await this.request(t.put(e)),n++}n>0&&console.log(`Migrated ${n} library files to include .sgf extension`),"undefined"!=typeof localStorage&&localStorage.setItem(s7,"true")}getStore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"readonly";if(!this.db)throw Error("Database not initialized. Please wait for initialization to complete.");return this.db.transaction(s8,e).objectStore(s8)}request(e){return new Promise((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=()=>n(e.error)})}async getItems(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;await this.ensureInitialized();let n=this.getStore(),i=n.index("parentId");return null===t&&IDBKeyRange.only("__root__"),(e=null===t?(await this.request(n.getAll())).filter(e=>null===e.parentId):await this.request(i.getAll(t))).sort((e,t)=>e.type!==t.type?"folder"===e.type?-1:1:e.name.localeCompare(t.name))}async getAllItems(){await this.ensureInitialized();let e=this.getStore();return this.request(e.getAll())}async getItem(e){await this.ensureInitialized();let t=this.getStore();return this.request(t.get(e))}async createFile(e){await this.ensureInitialized();let{name:t,content:n,parentId:i=null}=e;if(!sY(n))throw Error("Invalid SGF content");let a=await this.getItems(i),o=s4(s1(sQ(t)),a),s=sZ(n),l=sX(),u={id:sK(),name:o,type:"file",parentId:i,createdAt:l,updatedAt:l,content:n,metadata:s,size:new Blob([n]).size},c=this.getStore("readwrite");return await this.request(c.add(u)),i&&await this.updateFolderCount(i),u}async createFolder(e){await this.ensureInitialized();let{name:t,parentId:n=null}=e,i=await this.getItems(n),a=s4(sQ(t),i),o=sX(),s={id:sK(),name:a,type:"folder",parentId:n,createdAt:o,updatedAt:o,itemCount:0},l=this.getStore("readwrite");return await this.request(l.add(s)),n&&await this.updateFolderCount(n),s}async updateFile(e,t){await this.ensureInitialized();let n=await this.getItem(e);if(!n||"file"!==n.type)throw Error("File not found");if(!sY(t))throw Error("Invalid SGF content");let i=sZ(t),a={...n,content:t,metadata:i,size:new Blob([t]).size,updatedAt:sX()},o=this.getStore("readwrite");return await this.request(o.put(a)),a}async renameItem(e){await this.ensureInitialized();let{itemId:t,newName:n}=e,i=await this.getItem(t);if(!i)throw Error("Item not found");let a=await this.getItems(i.parentId),o=s4(sQ(n),a,t),s={...i,name:o,updatedAt:sX()},l=this.getStore("readwrite");return await this.request(l.put(s)),s}async moveItem(e){await this.ensureInitialized();let{itemId:t,newParentId:n}=e,i=await this.getItem(t);if(!i)throw Error("Item not found");if("folder"===i.type&&n&&await this.isDescendant(n,t))throw Error("Cannot move a folder into its own descendant");let a=i.parentId,o=await this.getItems(n),s=s4(i.name,o,t),l={...i,name:s,parentId:n,updatedAt:sX()},u=this.getStore("readwrite");return await this.request(u.put(l)),a&&await this.updateFolderCount(a),n&&await this.updateFolderCount(n),l}async deleteItem(e){await this.ensureInitialized();let t=await this.getItem(e);if(!t)return;let n=t.parentId;if("folder"===t.type)for(let t of(await this.getItems(e)))await this.deleteItem(t.id);let i=this.getStore("readwrite");await this.request(i.delete(e)),n&&await this.updateFolderCount(n)}async importZip(e){await this.ensureInitialized();let t={success:!1,imported:0,failed:0,errors:[]};try{let n=(await __webpack_require__.e("214").then(__webpack_require__.t.bind(__webpack_require__,461,23))).default,i=await n.loadAsync(e),a=new Map,o=new Set;for(let e of(i.forEach((e,t)=>{let n=e.split("/"),i="";for(let e=0;e<n.length-1;e++)i+=(i?"/":"")+n[e],o.add(i)}),Array.from(o).sort((e,t)=>e.split("/").length-t.split("/").length))){let n=e.split("/"),i=n[n.length-1],o=n.slice(0,-1).join("/"),s=o&&a.get(o)||null;try{let t=await this.createFolder({name:i,parentId:s});a.set(e,t.id)}catch(n){t.errors.push(`Failed to create folder: ${e}`)}}let s=[];for(let{path:e,file:n}of(i.forEach((e,t)=>{!t.dir&&e.toLowerCase().endsWith(".sgf")&&s.push({path:e,file:t})}),s))try{let i=await n.async("string"),o=e.split("/"),s=o[o.length-1],l=o.slice(0,-1).join("/"),u=l&&a.get(l)||null;await this.createFile({name:s1(s),content:i,parentId:u}),t.imported++}catch(n){t.failed++,t.errors.push(`Failed to import: ${e} - ${n instanceof Error?n.message:"Unknown error"}`)}t.success=t.imported>0}catch(e){t.errors.push(`Failed to read ZIP file: ${e instanceof Error?e.message:"Unknown error"}`)}return t}async exportZip(){await this.ensureInitialized();try{let e=new(await __webpack_require__.e("214").then(__webpack_require__.t.bind(__webpack_require__,461,23))).default,t=await this.getAllItems(),n=new Map,i=e=>{if(n.has(e.id))return n.get(e.id);let a=e.name;if(e.parentId){let n=t.find(t=>t.id===e.parentId);n&&(a=i(n)+"/"+a)}return n.set(e.id,a),a};for(let n of t){let t=i(n);"file"===n.type&&e.file(t,n.content)}let a=await e.generateAsync({type:"blob"});return{success:!0,data:a}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getStats(){await this.ensureInitialized();let e=await this.getAllItems(),t=0,n=0,i=0;for(let a of e)"file"===a.type?(t++,i+=a.size):n++;return{totalFiles:t,totalFolders:n,totalSize:i}}async clear(){await this.ensureInitialized();let e=this.getStore("readwrite");await this.request(e.clear())}async updateFolderCount(e){let t=await this.getItem(e);if(!t||"folder"!==t.type)return;let n=await this.getItems(e),i={...t,itemCount:n.length,updatedAt:sX()},a=this.getStore("readwrite");await this.request(a.put(i))}async isDescendant(e,t){let n=e;for(;n;){if(n===t)return!0;let e=await this.getItem(n);n=(null==e?void 0:e.parentId)||null}return!1}constructor(){(0,E._)(this,"db",null),(0,E._)(this,"initPromise",null),(0,E._)(this,"initError",null)}}let le=null;function lt(){return le||(le=new s9),le}async function ln(){let e=lt();await e.initialize()}let lr=e=>{let{isOpen:t,canSave:n,onAction:i}=e,{t:a}=rK();return t?(0,v.jsx)("div",{className:"unsaved-changes-overlay",onClick:()=>i("cancel"),children:(0,v.jsxs)("div",{className:"unsaved-changes-dialog",onClick:e=>e.stopPropagation(),children:[(0,v.jsx)("div",{className:"unsaved-changes-header",children:(0,v.jsx)("h2",{children:a("unsavedChanges")})}),(0,v.jsx)("div",{className:"unsaved-changes-content",children:n?(0,v.jsx)("p",{children:a("unsavedChangesPrompt")}):(0,v.jsx)("p",{children:a("unsavedChangesLost")})}),(0,v.jsxs)("div",{className:"unsaved-changes-actions",children:[(0,v.jsxs)("button",{className:"unsaved-changes-btn cancel",onClick:()=>i("cancel"),children:[(0,v.jsx)(oY,{size:16}),a("cancel")]}),(0,v.jsxs)("button",{className:"unsaved-changes-btn discard",onClick:()=>i("discard"),children:[(0,v.jsx)(oU,{size:16}),a("discard")]}),n&&(0,v.jsxs)("button",{className:"unsaved-changes-btn save",onClick:()=>i("save"),children:[(0,v.jsx)(oD,{size:16}),a("save")]})]})]})}):null},li=(0,x.createContext)(null),la="kaya-library-loaded-file-id";function lo(e){let{children:t,onFileOpen:n,getCurrentGameContent:i,getIsDirty:a,onSaveComplete:o}=e,[s,l]=(0,x.useState)(!1),[u,c]=(0,x.useState)(!0),[d,p]=(0,x.useState)([]),[h,f]=(0,x.useState)(null),[g,m]=(0,x.useState)(new Set),[y,b]=(0,x.useState)(new Set),[w,_]=(0,x.useState)(()=>"undefined"!=typeof window&&localStorage.getItem(la)||null),[S,k]=(0,x.useState)(null),[T,C]=(0,x.useState)(null),[E,I]=(0,x.useState)(!1),[$,O]=(0,x.useState)(!1),A=(0,x.useRef)(null),N=(0,x.useCallback)(e=>{_(e),"undefined"!=typeof window&&(e?localStorage.setItem(la,String(e)):localStorage.removeItem(la))},[]);(0,x.useEffect)(()=>{(async()=>{try{await ln(),l(!0),C(null)}catch(e){C(e instanceof Error?e.message:"Failed to initialize library")}finally{c(!1)}})()},[]);let P=(0,x.useCallback)(async()=>{if(s){c(!0);try{let e=lt(),t=await e.getAllItems(),n=await e.getStats();p(t),k(n),C(null)}catch(e){C(e instanceof Error?e.message:"Failed to load library")}finally{c(!1)}}},[s]);(0,x.useEffect)(()=>{s&&P()},[s,P]);let D=(0,x.useCallback)(e=>{f(e),e?m(new Set([e])):m(new Set)},[]),M=(0,x.useCallback)(e=>{m(t=>{let n=new Set(t);return n.has(e)?(n.delete(e),n.size>0?f([...n][0]):f(null)):(n.add(e),f(e)),n})},[]),z=(0,x.useCallback)(()=>{let e=[];d.map(e=>[e.id,e]);let t=d.filter(e=>!e.parentId),n=e=>[...e].sort((e,t)=>e.type!==t.type?"folder"===e.type?-1:1:e.name.localeCompare(t.name)),i=a=>{for(let o of n(a?d.filter(e=>e.parentId===a):t))e.push(o),"folder"===o.type&&y.has(o.id)&&i(o.id)};return i(null),e},[d,y]),j=(0,x.useCallback)((e,t)=>{let n=z(),i=n.findIndex(t=>t.id===e),a=n.findIndex(e=>e.id===t);if(-1===i||-1===a)return;let o=Math.min(i,a),s=Math.max(i,a),l=new Set;for(let e=o;e<=s;e++)l.add(n[e].id);m(l),f(t)},[z]),R=(0,x.useCallback)(()=>{m(new Set),f(null)},[]),L=(0,x.useCallback)(e=>{b(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},[]),F=(0,x.useCallback)(e=>{b(t=>new Set([...t,e]))},[]),B=(0,x.useCallback)(e=>{b(t=>{let n=new Set(t);return n.delete(e),n})},[]),U=(0,x.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=lt(),i=await n.createFolder({name:e,parentId:t});return await P(),t&&F(t),i},[P,F]),V=(0,x.useCallback)(async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=lt(),a=await i.createFile({name:e,content:t,parentId:n});return await P(),n&&F(n),a},[P,F]),G=(0,x.useCallback)(async(e,t)=>{let n=lt();await n.renameItem({itemId:e,newName:t}),await P()},[P]),H=(0,x.useCallback)(async(e,t)=>{let n=lt();await n.moveItem({itemId:e,newParentId:t}),await P(),t&&F(t)},[P,F]),W=(0,x.useCallback)(async e=>{let t=lt();await t.deleteItem(e),h===e&&f(null),m(t=>{let n=new Set(t);return n.delete(e),n}),w===e&&N(null),await P()},[P,h,w,N]),q=(0,x.useCallback)(async e=>{let t=lt();for(let n of e)await t.deleteItem(n),w===n&&N(null);f(null),m(new Set),await P()},[P,w,N]),K=(0,x.useCallback)(e=>new Promise(t=>{A.current=t,O(e),I(!0)}),[]),X=(0,x.useCallback)(async e=>{if(I(!1),"save"===e&&w&&i){let e=i();if(e){let t=lt(),n=await t.getItem(w);n&&"file"===n.type&&(await t.updateFile(w,e),await P(),null==o||o())}}A.current&&(A.current(e),A.current=null)},[w,i,P,o]),Z=(0,x.useCallback)(async()=>{if(!a||!a())return!0;let e=!!(w&&i);return"cancel"!==await K(e)},[a,w,i,K]),Y=(0,x.useCallback)(async e=>{if(e===w||!await Z())return;let t=lt(),i=await t.getItem(e);if(i&&"file"===i.type&&n){let t=i.name.toLowerCase().endsWith(".sgf")?i.name:`${i.name}.sgf`;n(i.content,t),N(e)}},[n,w,Z]),Q=(0,x.useCallback)(()=>{N(null)},[]),J=(0,x.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!i)return null;let n=i();if(!n)return null;let a=await V(e,n,t);return a&&(N(a.id),null==o||o()),a},[i,V,o]),ee=(0,x.useCallback)(async(e,t)=>{let n=lt();await n.updateFile(e,t),await P()},[P]),et=(0,x.useCallback)(async()=>{if(!w||!i)return!1;let e=i();if(!e)return!1;let t=lt(),n=await t.getItem(w);return n&&"file"===n.type?(await t.updateFile(w,e),await P(),null==o||o(),!0):(N(null),!1)},[w,i,P,N,o]),en=(0,x.useCallback)(async e=>{let t=lt(),n=await t.importZip(e);return await P(),n},[P]),er=(0,x.useCallback)(async()=>{let e=lt(),t=await e.exportZip();if(t.success&&t.data){let e=URL.createObjectURL(t.data),n=document.createElement("a");n.href=e,n.download=`kaya-library-${new Date().toISOString().slice(0,10)}.zip`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(e)}else t.error&&C(t.error)},[]),ei=(0,x.useCallback)(async e=>{let t=lt(),n=await t.getItem(e);if(!n||"file"!==n.type)return;let i=new Blob([n.content],{type:"application/x-go-sgf"}),a=URL.createObjectURL(i),o=document.createElement("a");o.href=a,o.download=n.name.toLowerCase().endsWith(".sgf")?n.name:`${n.name}.sgf`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},[]),ea=(0,x.useCallback)(async e=>{let t=lt(),n=await t.getItem(e);if(n&&"folder"===n.type)try{let i=new(await __webpack_require__.e("214").then(__webpack_require__.t.bind(__webpack_require__,461,23))).default,a=await t.getAllItems(),o=new Map,s=(e,t)=>{if(e.parentId===t)return!0;if(null===e.parentId)return!1;let n=a.find(t=>t.id===e.parentId);return!!n&&s(n,t)},l=t=>{if(o.has(t.id))return o.get(t.id);let n=t.name;if(t.parentId&&t.parentId!==e){let e=a.find(e=>e.id===t.parentId);e&&(n=l(e)+"/"+n)}return o.set(t.id,n),n};for(let t of a)if("file"===t.type&&(t.parentId===e||s(t,e))){let e=l(t),a=n.name+"/"+e,o=t.name.toLowerCase().endsWith(".sgf")?a:`${a}.sgf`;i.file(o,t.content)}let u=await i.generateAsync({type:"blob"}),c=URL.createObjectURL(u),d=document.createElement("a");d.href=c,d.download=`${n.name}.zip`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c)}catch(e){C(`Failed to download folder: ${e instanceof Error?e.message:"Unknown error"}`)}},[]),eo=(0,x.useCallback)(async e=>{if(0!==e.length){if(1===e.length){let t=lt(),n=await t.getItem(e[0]);if(!n)return;"file"===n.type?await ei(e[0]):await ea(e[0]);return}try{let t=lt(),n=new(await __webpack_require__.e("214").then(__webpack_require__.t.bind(__webpack_require__,461,23))).default,i=await t.getAllItems(),a=new Map(i.map(e=>[e.id,e])),o=(e,t)=>{let n=a.get(e);return!!n&&(n.parentId===t||null!==n.parentId&&o(n.parentId,t))},s=e.filter(t=>!e.some(e=>e!==t&&o(t,e))),l=(e,t)=>{for(let a of i.filter(t=>t.parentId===e)){let e=t+"/"+a.name;if("file"===a.type){let t=a.name.toLowerCase().endsWith(".sgf")?e:`${e}.sgf`;n.file(t,a.content)}else l(a.id,e)}};for(let e of s){let t=a.get(e);if(t)if("file"===t.type){let e=t.name.toLowerCase().endsWith(".sgf")?t.name:`${t.name}.sgf`;n.file(e,t.content)}else l(t.id,t.name)}let u=await n.generateAsync({type:"blob"}),c=URL.createObjectURL(u),d=document.createElement("a");d.href=c,d.download=`kaya-selection-${new Date().toISOString().slice(0,10)}.zip`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c)}catch(e){C(`Failed to download items: ${e instanceof Error?e.message:"Unknown error"}`)}}},[ei,ea]),es=(0,x.useCallback)(async()=>{let e=lt();await e.clear(),f(null),b(new Set),await P()},[P]),el=(0,x.useCallback)(async e=>{let t=lt(),n=await t.getItem(e);if(!n)return null;let i=(await t.getItems(n.parentId)).map(e=>({name:e.name,id:e.id})),a=s4((e=>{if(e.toLowerCase().endsWith(".sgf")){let t=e.slice(0,-4);return`${t} (copy).sgf`}return`${e} (copy)`})(n.name),i);if("file"===n.type){let e=await t.createFile({name:a,content:n.content,parentId:n.parentId});return await P(),e}{let e=async(n,i)=>{for(let a of(await t.getItems(n)))if("file"===a.type)await t.createFile({name:a.name,content:a.content,parentId:i});else{let n=await t.createFolder({name:a.name,parentId:i});await e(a.id,n.id)}},i=await t.createFolder({name:a,parentId:n.parentId});return await e(n.id,i.id),await P(),i}},[P]),eu=(0,x.useCallback)(async e=>{let t=[];for(let n of e){let e=await el(n);e&&t.push(e)}return t},[el]),ec=(0,x.useMemo)(()=>({isInitialized:s,isLoading:u,items:d,selectedId:h,selectedIds:g,expandedIds:y,loadedFileId:w,stats:S,error:T,refresh:P,selectItem:D,toggleItemSelection:M,selectRange:j,clearSelection:R,toggleExpanded:L,expandFolder:F,collapseFolder:B,createFolder:U,createFile:V,renameItem:G,moveItem:H,deleteItem:W,deleteItems:q,openFile:Y,saveCurrentGame:J,updateFile:ee,updateLoadedFile:et,importZip:en,exportZip:er,downloadFile:ei,downloadFolder:ea,downloadItems:eo,clearLibrary:es,clearLoadedFile:Q,duplicateItem:el,duplicateItems:eu,checkUnsavedChanges:Z}),[s,u,d,h,g,y,w,S,T,P,D,M,j,R,L,F,B,U,V,G,H,W,q,Y,J,ee,et,en,er,ei,ea,eo,es,Q,el,eu,Z]);return(0,v.jsxs)(li.Provider,{value:ec,children:[t,(0,v.jsx)(lr,{isOpen:E,canSave:$,onAction:X})]})}function ls(){let e=(0,x.useContext)(li);if(!e)throw Error("useLibrary must be used within a LibraryProvider");return e}let ll=()=>{let[e,t]=(0,x.useState)([]),n=(0,x.useCallback)(()=>{var e,n;let i=(null==(e=(n=navigator).getGamepads)?void 0:e.call(n))??[],a=[];for(let e=0;e<i.length;e++){let t=i[e];t&&t.connected&&a.push({index:t.index,id:t.id,connected:t.connected})}t(a)},[]);return(0,x.useEffect)(()=>{n();let e=e=>{console.log("Gamepad connected:",e.gamepad.id,"at index",e.gamepad.index),n()},t=e=>{console.log("Gamepad disconnected:",e.gamepad.id,"at index",e.gamepad.index),n()};window.addEventListener("gamepadconnected",e),window.addEventListener("gamepaddisconnected",t);let i=setInterval(n,1e3);return()=>{window.removeEventListener("gamepadconnected",e),window.removeEventListener("gamepaddisconnected",t),clearInterval(i)}},[n]),{gamepads:e}},lu=()=>{let{gamepads:e}=ll(),{isControllerActive:t,toggleController:n}=nl();return 0===e.length?null:(0,v.jsx)("div",{className:"gamepad-indicator",children:e.map(e=>{let i=t(e.index);return(0,v.jsx)("button",{className:`gamepad-icon ${i?"active":"inactive"}`,onClick:()=>n(e.index),title:`${e.id}
${i?"Click to disable":"Click to enable"}`,"aria-label":`Gamepad ${e.index+1}: ${e.id}. ${i?"Active":"Inactive"}. Click to ${i?"disable":"enable"}.`,children:(0,v.jsx)(ol,{size:18})},e.index)})})},lc={en:"\uD83C\uDDFA\uD83C\uDDF8",zh:"\uD83C\uDDE8\uD83C\uDDF3",ko:"\uD83C\uDDF0\uD83C\uDDF7",ja:"\uD83C\uDDEF\uD83C\uDDF5",fr:"\uD83C\uDDEB\uD83C\uDDF7",de:"\uD83C\uDDE9\uD83C\uDDEA",es:"\uD83C\uDDEA\uD83C\uDDF8",it:"\uD83C\uDDEE\uD83C\uDDF9"},ld={en:"EN",zh:"",ko:"",ja:"",fr:"FR",de:"DE",es:"ES",it:"IT"};function lp(){let{t:e}=rK(),{locale:t,setLocale:n,locales:i,isLoading:a}=sV(),[o,s]=(0,x.useState)(!1),l=(0,x.useRef)(null);(0,x.useEffect)(()=>{let e=e=>{l.current&&!l.current.contains(e.target)&&s(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,x.useEffect)(()=>{let e=e=>{"Escape"===e.key&&o&&s(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[o]);let u=async e=>{e!==t&&await n(e),s(!1)},c=e=>{e.preventDefault(),e.stopPropagation(),s(!o)};return(0,v.jsxs)("div",{className:"language-switcher",ref:l,children:[(0,v.jsxs)("button",{className:"language-switcher-button",onClick:c,disabled:a,title:`${e("language")}: ${i[t]}`,"aria-label":e("languageSwitcher.changeLanguage"),"aria-expanded":o,"aria-haspopup":"listbox",type:"button",children:[(0,v.jsx)(od,{size:16}),(0,v.jsx)("span",{className:"language-switcher-code",children:ld[t]}),(0,v.jsx)(aQ,{size:12,className:`language-switcher-chevron ${o?"open":""}`})]}),o&&(0,v.jsxs)("div",{className:"language-switcher-dropdown",role:"listbox",children:[(0,v.jsx)("div",{className:"language-switcher-dropdown-header",children:e("languageSwitcher.selectLanguage")}),Object.entries(i).map(e=>{let[n,i]=e;return(0,v.jsxs)("button",{className:`language-switcher-option ${n===t?"active":""}`,onClick:()=>u(n),role:"option","aria-selected":n===t,type:"button",children:[(0,v.jsx)("span",{className:"language-flag",children:lc[n]}),(0,v.jsx)("span",{className:"language-name",children:i}),(0,v.jsx)("span",{className:"language-code-badge",children:ld[n]}),n===t&&(0,v.jsx)(aY,{size:14,className:"language-check"})]},n)})]})]})}let lh=e=>{let{isOpen:t,onClose:n,onConfirm:i}=e,{t:a}=rK(),[o,s]=(0,x.useState)(19),[l,u]=(0,x.useState)("Black"),[c,d]=(0,x.useState)("White"),[p,h]=(0,x.useState)(""),[f,g]=(0,x.useState)(""),[m,y]=(0,x.useState)(6.5),[b,w]=(0,x.useState)(0),_=()=>{i({boardSize:o,playerBlack:l,playerWhite:c,rankBlack:p,rankWhite:f,komi:m,handicap:b}),n()},S=e=>{e.target===e.currentTarget&&n()},k=e=>{e.stopPropagation()};return t?(0,v.jsx)("div",{className:"new-game-overlay visible",onClick:S,onWheel:k,children:(0,v.jsxs)("div",{className:"new-game-dialog",onClick:e=>e.stopPropagation(),children:[(0,v.jsx)("h2",{children:a("newGame")}),(0,v.jsxs)("div",{className:"form-section",children:[(0,v.jsx)("h3",{children:a("boardSettings")}),(0,v.jsxs)("div",{className:"form-row",children:[(0,v.jsx)("label",{htmlFor:"board-size",children:a("boardSize")}),(0,v.jsx)("div",{className:"board-size-options",children:[9,13,19].map(e=>(0,v.jsxs)("button",{type:"button",className:`size-button ${o===e?"active":""}`,onClick:()=>s(e),children:[e,"\xd7",e]},e))})]}),(0,v.jsxs)("div",{className:"form-row",children:[(0,v.jsx)("label",{htmlFor:"komi",children:a("komi")}),(0,v.jsx)("input",{id:"komi",type:"number",step:"0.5",value:m,onChange:e=>y(parseFloat(e.target.value))})]}),(0,v.jsxs)("div",{className:"form-row",children:[(0,v.jsx)("label",{htmlFor:"handicap",children:a("handicap")}),(0,v.jsx)("input",{id:"handicap",type:"number",min:"0",max:"9",value:b,onChange:e=>w(parseInt(e.target.value,10))})]})]}),(0,v.jsxs)("div",{className:"form-section",children:[(0,v.jsx)("h3",{children:a("players")}),(0,v.jsxs)("div",{className:"player-row",children:[(0,v.jsxs)("div",{className:"form-row",children:[(0,v.jsx)("label",{htmlFor:"player-black",children:a("black")}),(0,v.jsx)("input",{id:"player-black",type:"text",value:l,onChange:e=>u(e.target.value),placeholder:a("playerName")})]}),(0,v.jsxs)("div",{className:"form-row",children:[(0,v.jsx)("label",{htmlFor:"rank-black",children:a("rank")}),(0,v.jsx)("input",{id:"rank-black",type:"text",value:p,onChange:e=>h(e.target.value),placeholder:a("rankPlaceholder")})]})]}),(0,v.jsxs)("div",{className:"player-row",children:[(0,v.jsxs)("div",{className:"form-row",children:[(0,v.jsx)("label",{htmlFor:"player-white",children:a("white")}),(0,v.jsx)("input",{id:"player-white",type:"text",value:c,onChange:e=>d(e.target.value),placeholder:a("playerName")})]}),(0,v.jsxs)("div",{className:"form-row",children:[(0,v.jsx)("label",{htmlFor:"rank-white",children:a("rank")}),(0,v.jsx)("input",{id:"rank-white",type:"text",value:f,onChange:e=>g(e.target.value),placeholder:a("rankPlaceholder")})]})]})]}),(0,v.jsxs)("div",{className:"dialog-buttons",children:[(0,v.jsx)("button",{type:"button",className:"cancel-button",onClick:n,children:a("cancel")}),(0,v.jsx)("button",{type:"button",className:"confirm-button",onClick:_,children:a("createGame")})]})]})}):null},lf=e=>{let{isOpen:t,title:n,message:i,confirmLabel:a,cancelLabel:o,onConfirm:s,onCancel:l}=e,{t:u}=rK(),c=a??u("confirm"),d=o??u("cancel");return t?(0,v.jsx)("div",{className:"confirmation-overlay",children:(0,v.jsxs)("div",{className:"confirmation-dialog",children:[(0,v.jsx)("h2",{children:n}),(0,v.jsx)("p",{children:i}),(0,v.jsxs)("div",{className:"confirmation-actions",children:[(0,v.jsx)("button",{className:"cancel-button",onClick:l,children:d}),(0,v.jsx)("button",{className:"confirm-button",onClick:s,children:c})]})]})}):null},lg=e=>{let{isOpen:t,defaultFileName:n,libraryItems:i,selectedFolderId:a,onClose:o,onSave:s}=e,{t:l}=rK(),[u,c]=(0,x.useState)(n),[d,p]=(0,x.useState)(null),[h,f]=(0,x.useState)(new Set),g=(0,x.useRef)(null),m=(0,x.useMemo)(()=>{let e=i.filter(e=>"folder"===e.type),t=new Map;for(let n of e)t.set(n.id,{id:n.id,name:n.name,children:[]});let n=[];for(let i of e){let e=t.get(i.id);i.parentId&&t.has(i.parentId)?t.get(i.parentId).children.push(e):n.push(e)}let a=e=>{for(let t of(e.sort((e,t)=>e.name.localeCompare(t.name)),e))a(t.children)};return a(n),n},[i]);if((0,x.useEffect)(()=>{if(t){if(c(n),a){let e=i.find(e=>e.id===a);(null==e?void 0:e.type)==="folder"?p(a):(null==e?void 0:e.parentId)?p(e.parentId):p(null)}else p(null);setTimeout(()=>{var e,t;null==(e=g.current)||e.focus(),null==(t=g.current)||t.select()},0)}},[t,n,a,i]),!t)return null;let y=()=>{let e=u.trim();e&&(s(e.endsWith(".sgf")?e:`${e}.sgf`,d),o())},b=e=>{"Enter"!==e.key||e.shiftKey?"Escape"===e.key&&o():y()},w=e=>{f(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=h.has(e.id),i=d===e.id,a=e.children.length>0;return(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{className:`folder-item ${i?"selected":""}`,style:{paddingLeft:`${16*t+8}px`},onClick:()=>p(e.id),children:[a?(0,v.jsx)("span",{className:"folder-expand-icon",onClick:t=>{t.stopPropagation(),w(e.id)},children:n?(0,v.jsx)(aQ,{size:14}):(0,v.jsx)(a0,{size:14})}):(0,v.jsx)("span",{className:"folder-expand-placeholder"}),(0,v.jsx)("span",{className:"folder-icon",children:n?(0,v.jsx)(oa,{size:16}):(0,v.jsx)(os,{size:16})}),(0,v.jsx)("span",{className:"folder-name",children:e.name})]}),n&&e.children.map(e=>_(e,t+1))]},e.id)};return(0,v.jsx)("div",{className:"save-file-dialog-overlay",onClick:o,children:(0,v.jsxs)("div",{className:"save-file-dialog save-to-library-dialog",onClick:e=>e.stopPropagation(),children:[(0,v.jsx)("h2",{children:l("addToLibrary")}),(0,v.jsxs)("div",{className:"save-file-dialog-content",children:[(0,v.jsx)("label",{htmlFor:"filename",children:l("filename")}),(0,v.jsx)("input",{ref:g,id:"filename",type:"text",value:u,onChange:e=>c(e.target.value),onKeyDown:b,placeholder:l("gameSgf")}),(0,v.jsx)("small",{className:"save-file-dialog-hint",children:u.endsWith(".sgf")?"":l("extensionNote")}),(0,v.jsx)("label",{style:{marginTop:"16px"},children:l("saveToFolder")}),(0,v.jsxs)("div",{className:"folder-selector",children:[(0,v.jsxs)("div",{className:`folder-item root-folder ${null===d?"selected":""}`,onClick:()=>p(null),children:[(0,v.jsx)("span",{className:"folder-expand-placeholder"}),(0,v.jsx)("span",{className:"folder-icon",children:(0,v.jsx)(os,{size:16})}),(0,v.jsx)("span",{className:"folder-name",children:l("libraryRoot")})]}),m.map(e=>_(e))]})]}),(0,v.jsxs)("div",{className:"save-file-dialog-buttons",children:[(0,v.jsx)("button",{onClick:o,className:"button-secondary",children:l("cancel")}),(0,v.jsx)("button",{onClick:y,className:"button-primary",disabled:!u.trim(),children:l("saveToLibrary")})]})]})})},lm=(0,x.createContext)(null),ly=e=>{let{children:t}=e,[n,i]=(0,x.useState)([]),a=(0,x.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=`toast-${Date.now()}`;i(i=>[...i,{id:n,message:e,type:t}]),setTimeout(()=>{i(e=>e.filter(e=>e.id!==n))},3e3)},[]),o=(0,x.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e))},[]);return(0,v.jsx)(lm.Provider,{value:{messages:n,showToast:a,closeToast:o},children:t})},lb=()=>{let e=(0,x.useContext)(lm);if(!e)throw Error("useToast must be used within ToastProvider");return e},lv=e=>{let{messages:t,onClose:n}=e;return 0===t.length?null:(0,v.jsx)("div",{className:"toast-container",children:t.map(e=>{let{id:t,message:i,type:a}=e;return(0,v.jsxs)("div",{className:`toast toast-${a}`,children:[(0,v.jsx)("span",{children:i}),(0,v.jsx)("button",{onClick:()=>n(t),className:"toast-close",children:"\xd7"})]},t)})})};function lx(e){try{let n=V(e);if(n.length>0){var t;let e=null==(t=n[0].data.GN)?void 0:t[0];if(null==e?void 0:e.trim())return e.trim().replace(/[/\\?%*:|"<>]/g,"-")}}catch{}return"untitled"}function lw(e){if("ogs"===e.source&&e.gameId)return`ogs-${e.gameId}.sgf`;let t=lx(e.sgf);return`${t}.sgf`}function l_(e){try{let t=e.match(/online-go\.com\/game\/(\d+)/);return t?t[1]:null}catch{return null}}function lS(e){return null!==l_(e)}async function lk(e){let t=`https://online-go.com/api/v1/games/${e}/sgf`,n=await fetch(t,{method:"GET"});if(!n.ok)throw Error(`Failed to download OGS game ${e}: ${n.statusText}`);let i=await n.text();if(!i||0===i.trim().length)throw Error(`Empty SGF content received from OGS game ${e}`);return i}async function lT(e){let t=e.trim();if(t.startsWith("("))return{sgf:t,source:"direct"};let n=l_(t);return n?{sgf:await lk(n),source:"ogs",gameId:n}:{sgf:t,source:"direct"}}async function lC(){if(eL())try{let{readText:e}=await __webpack_require__.e("138").then(__webpack_require__.bind(__webpack_require__,57));return await e()??""}catch(e){console.warn("Tauri clipboard read failed, falling back to browser API:",e)}return navigator.clipboard.readText()}async function lE(e){if(eL())try{let{writeText:t}=await __webpack_require__.e("138").then(__webpack_require__.bind(__webpack_require__,57));await t(e);return}catch(e){console.warn("Tauri clipboard write failed, falling back to browser API:",e)}await navigator.clipboard.writeText(e)}var lI=__webpack_require__(144);let l$=()=>{let{t:e}=rK(),[t,n]=(0,x.useState)(null),[i,a]=(0,x.useState)(null),[o,s]=(0,x.useState)("analysis"),{aiSettings:l,setAISettings:u,gameSettings:c,setGameSettings:d,isAIConfigOpen:p,setAIConfigOpen:h,modelLibrary:f,selectedModelId:g,setSelectedModelId:m,downloadModel:y,deleteModel:b,uploadModel:w}=tQ(),{showToast:_}=lb(),S=(0,x.useRef)(null),k=(0,x.useMemo)(()=>{let e=new Map;for(let t of f)if(void 0!==t.baseModelIndex){let n=e.get(t.baseModelIndex)||[];n.push(t),e.set(t.baseModelIndex,n)}return e},[f]),T=(0,x.useMemo)(()=>f.filter(e=>void 0===e.baseModelIndex),[f]),C=(0,x.useRef)(!1);(0,x.useEffect)(()=>{if(g&&null===i&&!C.current){let e=eJ(g);e&&a(e.baseModelIndex)}},[g,i]);let E=e=>{C.current=!0,a(i===e?null:e)};(0,x.useEffect)(()=>{n(document.body)},[]),(0,x.useEffect)(()=>{if(!p)return;let e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}},[p]),(0,x.useEffect)(()=>{if(!p)return;let e=e=>{"Escape"===e.key&&h(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[p,h]);let I=()=>h(!1),$=async t=>{var n;let i=null==(n=t.target.files)?void 0:n[0];if(i)try{await w(i),_(e("aiConfig.modelUploadedSuccess"),"success")}catch(t){_(e("aiConfig.modelUploadFailed"),"error")}t.target.value=""},O=async t=>{try{await y(t),_(e("aiConfig.modelDownloadedSuccess"),"success")}catch(t){_(e("aiConfig.modelDownloadFailed"),"error")}},A=async t=>{try{await b(t),_(e("aiConfig.modelDeletedSuccess"),"success")}catch(t){_(e("aiConfig.modelDeleteFailed"),"error")}},N=async e=>{let t=f.find(t=>t.id===e);(null==t?void 0:t.isDownloaded)&&await m(e)},P=f.some(e=>e.isDownloading),D=f.some(e=>e.isDownloaded),M=(0,x.useMemo)(()=>{let e=eZ.findIndex(e=>e.recommended);return e>=0?eQ(e,"fp32"):null},[]),z=(0,x.useMemo)(()=>M&&f.find(e=>e.id===M)||null,[M,f]),j=async()=>{if(M)try{await y(M)}catch(t){_(e("aiConfig.modelDownloadFailed"),"error")}},R=()=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("section",{className:"kaya-config-section",children:[(0,v.jsxs)("div",{className:"section-header",children:[(0,v.jsx)(aq,{className:"section-icon"}),(0,v.jsx)("h3",{children:e("aiConfig.modelLibrary")})]}),(0,v.jsx)("div",{className:"config-note",style:{marginBottom:"12px"},children:e("aiConfig.modelLibraryDescription")}),!D&&(0,v.jsxs)("div",{className:"model-get-started-banner",children:[(0,v.jsxs)("div",{className:"get-started-content",children:[(0,v.jsx)(a5,{className:"get-started-icon"}),(0,v.jsxs)("div",{className:"get-started-text",children:[(0,v.jsx)("strong",{children:e("aiConfig.getStartedTitle")}),(0,v.jsx)("span",{children:e("aiConfig.getStartedDescription")})]})]}),(0,v.jsx)("button",{className:"get-started-btn",onClick:j,disabled:P,children:(null==z?void 0:z.isDownloading)?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ob,{className:"spinning",size:16}),e("aiConfig.downloading")," ",z.downloadProgress??0,"%"]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(a5,{size:16}),e("aiConfig.downloadRecommended")]})})]}),(0,v.jsxs)("div",{className:"model-library-list",children:[eZ.map((t,n)=>{let a=k.get(n)||[],o=i===n,s=a.some(e=>e.isDownloaded),l=a.some(e=>e.id===g),u=a.filter(e=>e.isDownloaded).length;return(0,v.jsxs)("div",{className:"model-base-group",children:[(0,v.jsxs)("div",{className:`model-base-header ${o?"expanded":""} ${l?"has-selected":""}`,onClick:()=>E(n),role:"button",tabIndex:0,children:[(0,v.jsx)("div",{className:"model-base-expand",children:o?(0,v.jsx)(aQ,{size:16}):(0,v.jsx)(a0,{size:16})}),(0,v.jsxs)("div",{className:"model-base-info",children:[(0,v.jsxs)("div",{className:"model-base-name",children:[t.displayName,t.recommended&&(0,v.jsx)("span",{className:"model-recommended-badge",children:e("aiConfig.recommended")})]}),(0,v.jsxs)("div",{className:"model-base-meta",children:[(0,v.jsx)("span",{className:"model-base-desc",children:t.description}),s&&(0,v.jsxs)("span",{className:"model-base-downloaded",children:[u,"/",a.length," ",e("aiConfig.downloaded")]})]})]})]}),o&&(0,v.jsx)("div",{className:"model-variants-list",children:eY.map(t=>{let n=a.find(e=>e.quantization===t.quantization);return n?(0,v.jsxs)("div",{className:`model-variant-item ${n.isDownloaded?"downloaded":""} ${g===n.id?"selected":""}`,onClick:()=>n.isDownloaded&&N(n.id),role:n.isDownloaded?"button":void 0,tabIndex:n.isDownloaded?0:void 0,children:[(0,v.jsxs)("div",{className:"model-variant-info",children:[(0,v.jsxs)("div",{className:"model-variant-name",children:[t.label,g===n.id&&(0,v.jsxs)("span",{className:"model-active-badge",children:[(0,v.jsx)(aY,{size:12})," ",e("aiConfig.active")]})]}),(0,v.jsxs)("div",{className:"model-variant-meta",children:[(0,v.jsx)("span",{className:"model-variant-desc",children:t.description}),(0,v.jsx)("span",{className:"model-variant-size",children:t.size})]})]}),(0,v.jsx)("div",{className:"model-library-actions",children:n.isDownloading?(0,v.jsxs)("div",{className:"model-download-progress",children:[(0,v.jsx)(ob,{className:"spinning",size:16}),(0,v.jsxs)("span",{children:[n.downloadProgress??0,"%"]})]}):n.isDownloaded?(0,v.jsx)("button",{className:"model-action-btn danger",onClick:e=>{e.stopPropagation(),A(n.id)},title:e("aiConfig.deleteModel"),children:(0,v.jsx)(oU,{size:16})}):(0,v.jsx)("button",{className:"model-action-btn primary",onClick:e=>{e.stopPropagation(),O(n.id)},disabled:P,title:e("aiConfig.downloadModel"),children:(0,v.jsx)(a5,{size:16})})})]},n.id):null})})]},n)}),T.length>0&&(0,v.jsxs)("div",{className:"model-base-group user-models",children:[(0,v.jsx)("div",{className:"model-base-header user-models-header",children:(0,v.jsx)("div",{className:"model-base-info",children:(0,v.jsx)("div",{className:"model-base-name",children:e("aiConfig.customModels")})})}),(0,v.jsx)("div",{className:"model-variants-list",children:T.map(t=>(0,v.jsxs)("div",{className:`model-variant-item ${t.isDownloaded?"downloaded":""} ${g===t.id?"selected":""}`,onClick:()=>t.isDownloaded&&N(t.id),role:t.isDownloaded?"button":void 0,tabIndex:t.isDownloaded?0:void 0,children:[(0,v.jsxs)("div",{className:"model-variant-info",children:[(0,v.jsxs)("div",{className:"model-variant-name",children:[t.name,g===t.id&&(0,v.jsxs)("span",{className:"model-active-badge",children:[(0,v.jsx)(aY,{size:12})," ",e("aiConfig.active")]})]}),(0,v.jsxs)("div",{className:"model-variant-meta",children:[(0,v.jsx)("span",{className:"model-variant-desc",children:t.description}),t.size&&(0,v.jsxs)("span",{className:"model-variant-size",children:[(t.size/1024/1024).toFixed(1)," MB"]})]})]}),(0,v.jsx)("div",{className:"model-library-actions",children:(0,v.jsx)("button",{className:"model-action-btn danger",onClick:e=>{e.stopPropagation(),A(t.id)},title:e("aiConfig.deleteModel"),children:(0,v.jsx)(oU,{size:16})})})]},t.id))})]})]}),(0,v.jsxs)("div",{className:"model-upload-section",children:[(0,v.jsx)("input",{type:"file",ref:S,onChange:$,accept:".onnx,.bin",style:{display:"none"}}),(0,v.jsxs)("button",{className:"model-upload-btn",onClick:()=>{var e;return null==(e=S.current)?void 0:e.click()},disabled:P,children:[(0,v.jsx)(oK,{size:16})," ",e("aiConfig.uploadCustomModel")]}),(0,v.jsxs)("p",{className:"model-upload-description",children:[e("aiConfig.uploadCustomModelDescription")," ",(0,v.jsx)("a",{href:"https://github.com/kaya-go/katago-onnx",target:"_blank",rel:"noopener noreferrer",children:"kaya-go/katago-onnx"})]})]})]}),(0,v.jsxs)("section",{className:"kaya-config-section",children:[(0,v.jsxs)("div",{className:"section-header",children:[(0,v.jsx)(oz,{className:"section-icon"}),(0,v.jsx)("h3",{children:e("aiConfig.analysisOptions")})]}),(0,v.jsxs)("div",{className:"settings-list",children:[(0,v.jsxs)("div",{className:"setting-item setting-item-full",children:[(0,v.jsxs)("div",{className:"setting-info",children:[(0,v.jsx)("label",{htmlFor:"backend-select",className:"setting-label",children:e("aiConfig.inferenceBackend")}),(0,v.jsx)("p",{className:"setting-description",children:e("aiConfig.inferenceBackendDescription")})]}),(0,v.jsxs)("select",{id:"backend-select",value:"webgpu"!==l.backend||"undefined"!=typeof navigator&&navigator.gpu?l.backend:"wasm",onChange:e=>u({backend:e.target.value}),className:"ai-select",children:[eL()&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("option",{value:"native",children:e("aiConfig.nativeAuto")}),(0,v.jsx)("option",{value:"native-cpu",children:e("aiConfig.nativeCpu")})]}),"undefined"!=typeof navigator&&navigator.gpu&&(0,v.jsx)("option",{value:"webgpu",children:e("aiConfig.webgpu")}),(0,v.jsx)("option",{value:"wasm",children:e("aiConfig.wasm")})]})]}),(0,v.jsxs)("div",{className:"setting-item",children:[(0,v.jsxs)("div",{className:"setting-info",children:[(0,v.jsxs)("label",{htmlFor:"max-top-moves-slider",className:"setting-label",children:[e("aiConfig.maxTopMoves"),(0,v.jsx)("span",{className:"setting-value",children:l.maxTopMoves})]}),(0,v.jsx)("p",{className:"setting-description",children:e("aiConfig.maxTopMovesDescription")})]}),(0,v.jsx)("input",{id:"max-top-moves-slider",type:"range",min:"1",max:"10",step:"1",value:l.maxTopMoves,onChange:e=>u({maxTopMoves:parseInt(e.target.value)}),className:"ai-slider"})]}),(0,v.jsxs)("div",{className:"setting-item",children:[(0,v.jsxs)("div",{className:"setting-info",children:[(0,v.jsxs)("label",{htmlFor:"min-prob-slider",className:"setting-label",children:[e("aiConfig.minProbability"),(0,v.jsxs)("span",{className:"setting-value",children:[(100*l.minProb).toFixed(0),"%"]})]}),(0,v.jsx)("p",{className:"setting-description",children:e("aiConfig.minProbabilityDescription")})]}),(0,v.jsx)("input",{id:"min-prob-slider",type:"range",min:"0",max:"0.5",step:"0.01",value:l.minProb,onChange:e=>u({minProb:parseFloat(e.target.value)}),className:"ai-slider"})]}),(0,v.jsxs)("div",{className:"setting-item setting-item-toggle setting-item-full",children:[(0,v.jsxs)("div",{className:"setting-info",children:[(0,v.jsx)("label",{htmlFor:"save-analysis-check",className:"setting-label",children:e("aiConfig.saveAnalysisToSgf")}),(0,v.jsx)("p",{className:"setting-description",children:e("aiConfig.saveAnalysisToSgfDescription")})]}),(0,v.jsxs)("div",{className:"toggle-with-label",children:[(0,v.jsx)("span",{className:`toggle-status ${l.saveAnalysisToSgf?"on":"off"}`,children:l.saveAnalysisToSgf?"On":"Off"}),(0,v.jsx)("button",{id:"save-analysis-check",type:"button",role:"switch","aria-checked":l.saveAnalysisToSgf,className:`toggle-switch ${l.saveAnalysisToSgf?"active":""}`,onClick:()=>u({saveAnalysisToSgf:!l.saveAnalysisToSgf}),children:(0,v.jsx)("span",{className:"toggle-switch-handle"})})]})]})]})]}),(0,v.jsxs)("div",{className:"ai-config-footer",children:[e("aiConfig.poweredBy")," ",(0,v.jsx)("a",{href:"https://github.com/lightvector/KataGo",target:"_blank",rel:"noopener noreferrer",children:"KataGo"})]})]}),L=()=>(0,v.jsxs)("section",{className:"kaya-config-section",children:[(0,v.jsxs)("div",{className:"section-header",children:[(0,v.jsx)(ol,{className:"section-icon"}),(0,v.jsx)("h3",{children:e("kayaConfig.boardSettings")})]}),(0,v.jsx)("div",{className:"settings-list",children:(0,v.jsxs)("div",{className:"setting-item setting-item-toggle setting-item-full",children:[(0,v.jsxs)("div",{className:"setting-info",children:[(0,v.jsx)("label",{htmlFor:"fuzzy-placement-check",className:"setting-label",children:e("kayaConfig.fuzzyStonePlacement")}),(0,v.jsx)("p",{className:"setting-description",children:e("kayaConfig.fuzzyStonePlacementDescription")})]}),(0,v.jsxs)("div",{className:"toggle-with-label",children:[(0,v.jsx)("span",{className:`toggle-status ${c.fuzzyStonePlacement?"on":"off"}`,children:c.fuzzyStonePlacement?"On":"Off"}),(0,v.jsx)("button",{id:"fuzzy-placement-check",type:"button",role:"switch","aria-checked":c.fuzzyStonePlacement,className:`toggle-switch ${c.fuzzyStonePlacement?"active":""}`,onClick:()=>d({fuzzyStonePlacement:!c.fuzzyStonePlacement}),children:(0,v.jsx)("span",{className:"toggle-switch-handle"})})]})]})})]}),F=(0,v.jsx)("div",{className:"kaya-config-modal-overlay",role:"dialog","aria-modal":"true","aria-label":e("kayaConfig.title"),onClick:I,children:(0,v.jsxs)("div",{className:"kaya-config-modal",onClick:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onWheel:e=>e.stopPropagation(),onTouchMove:e=>e.stopPropagation(),children:[(0,v.jsxs)("div",{className:"kaya-config-header",children:[(0,v.jsxs)("div",{className:"kaya-config-title",children:[(0,v.jsx)(oz,{className:"kaya-config-icon-main"}),(0,v.jsx)("h2",{children:e("kayaConfig.title")})]}),(0,v.jsx)("button",{className:"kaya-config-close",onClick:I,"aria-label":e("kayaConfig.close"),children:(0,v.jsx)(oY,{})})]}),(0,v.jsxs)("div",{className:"kaya-config-tabs",children:[(0,v.jsxs)("button",{className:`kaya-config-tab ${"analysis"===o?"active":""}`,onClick:()=>s("analysis"),children:[(0,v.jsx)(aq,{size:16}),e("kayaConfig.analysisTab")]}),(0,v.jsxs)("button",{className:`kaya-config-tab ${"game"===o?"active":""}`,onClick:()=>s("game"),children:[(0,v.jsx)(ol,{size:16}),e("kayaConfig.gameTab")]})]}),(0,v.jsx)("div",{className:"kaya-config-content",children:(0,v.jsxs)("div",{className:"kaya-config-container",children:["analysis"===o&&R(),"game"===o&&L()]})})]})});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("button",{className:"kaya-config-trigger",onClick:()=>h(!0),title:e("kayaConfig.title"),"aria-label":e("kayaConfig.title"),style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",borderRadius:"4px",border:"none",background:"transparent",color:"var(--text-secondary)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--bg-tertiary)",e.currentTarget.style.color="var(--text-primary)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="var(--text-secondary)"},children:(0,v.jsx)(a6,{size:20})}),p&&t&&(0,lI.createPortal)(F,t)]})},lO=e=>{let{showThemeToggle:t=!0,showLibrary:n,showSidebar:i,onToggleLibrary:a,onToggleSidebar:o,onHide:s,onGoHome:l,versionData:u}=e,{t:c}=rK(),{theme:d,toggleTheme:p}=C(),{soundEnabled:h,toggleSound:f}=sE(),{loadSGFAsync:g,exportSGF:m,newGame:y,fileName:b,setFileName:w,isDirty:_,triggerAutoSave:S}=tZ(),{currentBoard:k,gameInfo:T}=tH(),{makeMainVariation:E,undo:I,redo:$,canUndo:O,canRedo:A,editMode:N}=tq(),{clearLoadedFile:P,loadedFileId:D,renameItem:M,checkUnsavedChanges:z,updateLoadedFile:j,saveCurrentGame:R,items:L,selectedId:F}=ls(),B=(0,x.useRef)(null),U=(0,x.useRef)(null),[V,G]=(0,x.useState)(!1),[H,W]=(0,x.useState)(!1),[q,K]=(0,x.useState)(!1),[X,Z]=(0,x.useState)(!1),[Y,Q]=(0,x.useState)(""),[J,ee]=(0,x.useState)(!1),et=(0,x.useRef)(null),{messages:en,showToast:er,closeToast:ei}=lb(),[ea,eo]=(0,x.useState)(!1),[es,el]=(0,x.useState)(!1),eu=(0,x.useMemo)(()=>{var e,t;if(b)return b;if(T.gameName){let e=T.gameName.replace(/[/\\?%*:|"<>]/g,"-").trim();return e.endsWith(".sgf")?e:`${e}.sgf`}let n=null==(e=T.playerBlack)?void 0:e.trim(),i=null==(t=T.playerWhite)?void 0:t.trim();if(n&&i){let e=`${n} vs ${i}`.replace(/[/\\?%*:|"<>]/g,"-");return`${e}.sgf`}return"game.sgf"},[b,T.gameName,T.playerBlack,T.playerWhite]),ec=(0,x.useCallback)(async e=>{if(!await z())return;let t=new FileReader;t.onload=async t=>{var n;let i=null==(n=t.target)?void 0:n.result;if(i)try{await g(i),w(e.name),P()}catch(e){alert(`Failed to load SGF file: ${e}`)}},t.readAsText(e)},[g,w,P,z]),ed=(0,x.useCallback)(()=>{var e;null==(e=B.current)||e.click()},[]),ep=(0,x.useCallback)(e=>{var t;let n=null==(t=e.target.files)?void 0:t[0];n&&ec(n),B.current&&(B.current.value="")},[ec]),eh=(0,x.useCallback)(async e=>{let t=m(),n=e.endsWith(".sgf")?e:`${e}.sgf`,i=await eU(t,n);i&&(w(i),er(`Exported "${n}"`,"success"),S())},[m,w,er,S]),ef=(0,x.useCallback)(async()=>{D?await j()?(er("Saved to library","success"),S()):(er("Library file not found, saving as new...","info"),K(!0)):eu&&"game.sgf"!==eu?await R(eu,null)?(w(eu.endsWith(".sgf")?eu:`${eu}.sgf`),er(`Saved "${eu}" to library`,"success"),S()):er("Failed to save to library","error"):K(!0)},[D,j,eu,R,w,er,S]),eg=(0,x.useCallback)(()=>{K(!0)},[]),em=(0,x.useCallback)(()=>{eh(eu)},[eh,eu]),ey=(0,x.useCallback)(async(e,t)=>{await R(e,t)?(w(e.endsWith(".sgf")?e:`${e}.sgf`),er(`Saved "${e}" to library`,"success"),S()):er("Failed to save to library","error")},[R,w,er,S]),eb=(0,x.useCallback)(()=>{k.isEmpty()?G(!0):W(!0)},[k]),ev=(0,x.useCallback)(()=>{W(!1),G(!0)},[]),ex=(0,x.useCallback)(()=>{W(!1)},[]),ew=(0,x.useCallback)(()=>{b&&(Q(b),Z(!0))},[b]),e_=(0,x.useCallback)(e=>{Q(e.target.value)},[]),eS=(0,x.useCallback)(async()=>{if(Y.trim()){let e=Y.trim().endsWith(".sgf")?Y.trim():`${Y.trim()}.sgf`;if(w(e),D)try{await M(D,e)}catch(e){console.error("Failed to rename file in library:",e)}}Z(!1)},[Y,w,D,M]),ek=(0,x.useCallback)(e=>{e.stopPropagation(),"Enter"===e.key?(e.preventDefault(),eS()):"Escape"===e.key&&Z(!1)},[eS]);(0,x.useEffect)(()=>{X&&U.current&&(U.current.focus(),U.current.select())},[X]);let eT=(0,x.useCallback)(async()=>{await z()&&(y({boardSize:k.width,playerBlack:"Black",playerWhite:"White",rankBlack:"",rankWhite:"",komi:6.5,handicap:0}),P())},[y,k,P,z]),eC=(0,x.useCallback)(async e=>{await z()&&(y(e),P())},[y,P,z]),eE=(0,x.useCallback)(async()=>{try{let e=m();await lE(e),er("SGF copied to clipboard!","success"),S()}catch(e){er(`Failed to copy: ${e}`,"error")}},[m,er,S]),eI=(0,x.useCallback)(async()=>{try{let e=await lC();if(!e.trim()||!await z())return;let t=await lT(e);await g(t.sgf),w(lw(t)),P()}catch(e){console.error("Failed to paste:",e)}},[g,w,P,z]),e$=(0,x.useCallback)(async()=>{if(eL()||"undefined"!=typeof window&&("__TAURI__"in window||"__TAURI_INTERNALS__"in window)){try{let{getCurrentWindow:e}=await __webpack_require__.e("151").then(__webpack_require__.bind(__webpack_require__,362)),t=e(),n=await t.isFullscreen();await t.setFullscreen(!n),eo(!n)}catch(e){console.error("Failed to toggle fullscreen in Tauri:",e)}return}if(document.fullscreenElement||document.webkitFullscreenElement)document.exitFullscreen?(document.exitFullscreen(),eo(!1)):document.webkitExitFullscreen&&(document.webkitExitFullscreen(),eo(!1));else{let e=document.documentElement;e.requestFullscreen?(e.requestFullscreen().catch(e=>{console.error(`Error attempting to enable full-screen mode: ${e.message} (${e.name})`)}),eo(!0)):e.webkitRequestFullscreen?(e.webkitRequestFullscreen(),eo(!0)):console.warn("Fullscreen API is not supported in this environment")}},[]);return(0,x.useEffect)(()=>{let e=()=>{eo(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[]),(0,x.useEffect)(()=>{let e=e=>{et.current&&!et.current.contains(e.target)&&ee(!1)};if(J)return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[J]),(0,x.useEffect)(()=>{let e=e=>{!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)&&((e.ctrlKey||e.metaKey)&&"s"===e.key&&!e.shiftKey&&(e.preventDefault(),ef()),(e.ctrlKey||e.metaKey)&&"s"===e.key&&e.shiftKey&&(e.preventDefault(),eg()),(e.ctrlKey||e.metaKey)&&"m"===e.key.toLowerCase()&&e.shiftKey&&(e.preventDefault(),E()),(e.ctrlKey||e.metaKey)&&"z"===e.key.toLowerCase()&&!e.shiftKey&&(e.preventDefault(),O&&I()),((e.ctrlKey||e.metaKey)&&"z"===e.key.toLowerCase()&&e.shiftKey||(e.ctrlKey||e.metaKey)&&"y"===e.key.toLowerCase())&&(e.preventDefault(),A&&$()),"f"!==e.key.toLowerCase()||e.ctrlKey||e.metaKey||e.altKey?"s"!==e.key.toLowerCase()||e.ctrlKey||e.metaKey||e.altKey||!e.shiftKey||f():e$())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[eE,ef,eg,e$,f,E,I,$,O,A]),(0,v.jsxs)("header",{className:"app-header",children:[(0,v.jsx)("input",{ref:B,type:"file",accept:".sgf",style:{display:"none"},onChange:ep}),(0,v.jsxs)("div",{className:"header-file-controls",children:[(0,v.jsx)("button",{onClick:()=>el(!0),title:c("menu"),className:"header-mobile-menu-btn",children:(0,v.jsx)(o_,{size:24})}),(0,v.jsx)("button",{onClick:eT,title:`Quick New Game (${k.width}\xd7${k.height}) -  Erases current game without saving!`,className:"quick-new-button header-desktop-only",children:(0,v.jsx)(oQ,{size:18})}),(0,v.jsxs)("button",{onClick:eb,title:c("newGame"),className:"header-btn-primary header-desktop-only",children:[(0,v.jsx)(oO,{size:18})," ",(0,v.jsx)("span",{className:"btn-text",children:c("new")})]}),(0,v.jsxs)("button",{onClick:ed,title:c("openSgfFile"),className:"header-btn-primary header-desktop-only",children:[(0,v.jsx)(oa,{size:18})," ",(0,v.jsx)("span",{className:"btn-text",children:c("open")})]}),(0,v.jsxs)("button",{onClick:ef,title:`${c("saveToLibrary")} (Ctrl+S)`,className:"header-btn-primary header-desktop-only",disabled:!_&&null!==D,children:[(0,v.jsx)(oD,{size:18})," ",(0,v.jsx)("span",{className:"btn-text",children:c("save")})]}),(0,v.jsxs)("button",{onClick:eg,title:`${c("saveAs")} (Ctrl+Shift+S)`,className:"header-btn-primary header-desktop-only",children:[(0,v.jsx)(aH,{size:18})," ",(0,v.jsx)("span",{className:"btn-text",children:c("saveAsShort")})]}),(0,v.jsxs)("button",{onClick:em,title:c("exportToDisk"),className:"header-btn-primary header-desktop-only",children:[(0,v.jsx)(a5,{size:18})," ",(0,v.jsx)("span",{className:"btn-text",children:c("export")})]}),(0,v.jsxs)("div",{className:"header-secondary-actions",children:[(0,v.jsxs)("button",{onClick:eE,title:c("copySgfToClipboard"),className:"header-btn-secondary",children:[(0,v.jsx)(a4,{size:18})," ",(0,v.jsx)("span",{className:"btn-text",children:c("copy")})]}),(0,v.jsxs)("button",{onClick:eI,title:`${c("pasteSgfOrOgs")} (Ctrl+V)`,className:"header-btn-secondary",children:[(0,v.jsx)(a3,{size:18})," ",(0,v.jsx)("span",{className:"btn-text",children:c("paste")})]})]}),(0,v.jsxs)("div",{className:"header-more-menu-container",ref:et,children:[(0,v.jsx)("button",{className:"header-more-btn",onClick:()=>ee(!J),title:c("moreActions"),children:(0,v.jsx)(a8,{size:18})}),J&&(0,v.jsxs)("div",{className:"header-more-menu",children:[(0,v.jsxs)("button",{onClick:()=>{eE(),ee(!1)},children:[(0,v.jsx)(a4,{size:16})," ",c("copySgf")]}),(0,v.jsxs)("button",{onClick:()=>{eI(),ee(!1)},children:[(0,v.jsx)(a3,{size:16})," ",c("pasteSgfUrl")]})]})]}),b&&(X?(0,v.jsx)("input",{ref:U,type:"text",className:"header-filename-input",value:Y,onChange:e_,onBlur:eS,onKeyDown:ek,onKeyUp:e=>e.stopPropagation(),onKeyPress:e=>e.stopPropagation()}):(0,v.jsxs)("span",{className:"header-filename",onClick:ew,title:c("clickToRename"),children:[_&&(0,v.jsx)("span",{className:"header-dirty-indicator",title:c("unsavedChanges"),children:""}),b]}))]}),(0,v.jsxs)("div",{className:"header-right-group",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,v.jsx)(l$,{}),t&&(0,v.jsxs)("div",{className:"header-toggles",children:[a&&(0,v.jsx)("button",{className:`panel-toggle ${n?"active":""}`,onClick:a,title:n?`${c("hideLibrary")} (Ctrl+L)`:`${c("showLibrary")} (Ctrl+L)`,children:(0,v.jsx)(oy,{size:20})}),o&&(0,v.jsx)("button",{className:`panel-toggle ${i?"active":""}`,onClick:o,title:i?`${c("hideSidebar")} (Ctrl+B)`:`${c("showSidebar")} (Ctrl+B)`,children:(0,v.jsx)(oC,{size:20})}),(0,v.jsx)(lu,{}),(0,v.jsx)("button",{className:"fullscreen-toggle",onClick:e$,title:ea?`${c("exitFullscreen")} (F)`:`${c("enterFullscreen")} (F)`,children:ea?(0,v.jsx)(ok,{size:20}):(0,v.jsx)(ow,{size:20})}),(0,v.jsx)("button",{className:"theme-toggle",onClick:p,title:c("dark"===d?"switchToLightMode":"switchToDarkMode"),children:"dark"===d?(0,v.jsx)(oB,{size:20}):(0,v.jsx)(oT,{size:20})}),(0,v.jsx)("button",{className:"sound-toggle",onClick:f,title:h?`${c("muteSounds")} (S)`:`${c("enableSounds")} (S)`,children:h?(0,v.jsx)(oX,{size:20}):(0,v.jsx)(oZ,{size:20})}),(0,v.jsx)(lp,{}),(0,v.jsx)("a",{href:"https://github.com/kaya-go/kaya",target:"_blank",rel:"noopener noreferrer",title:c("viewOnGitHub"),children:(0,v.jsx)(oc,{size:20})}),s&&(0,v.jsx)("button",{onClick:s,title:`${c("hideMenu")} (Cmd/Ctrl+Shift+M)`,children:(0,v.jsx)(oE,{size:20})})]})]}),(0,v.jsx)(lv,{messages:en,onClose:ei}),(0,v.jsx)(lh,{isOpen:V,onClose:()=>G(!1),onConfirm:eC}),(0,v.jsx)(lf,{isOpen:H,title:c("startNewGame"),message:c("startNewGameConfirm"),confirmLabel:c("newGame"),onConfirm:ev,onCancel:ex}),(0,v.jsx)(lg,{isOpen:q,defaultFileName:eu,libraryItems:L,selectedFolderId:F,onClose:()=>K(!1),onSave:ey}),(0,v.jsx)(sq,{isOpen:es,onClose:()=>el(!1),versionData:u,onNewGame:()=>G(!0),onQuickNewGame:eT,onOpen:ed,onSave:ef,onSaveAs:eg,onExport:em,onCopySGF:eE,onPasteSGF:eI,onGoHome:l,isDirty:_,isInLibrary:null!==D})]})},lA="undefined"!=typeof window&&"__TAURI__"in window,lN=(e,t)=>{for(let n of document.elementsFromPoint(e,t))if(!n.closest(".app-dropzone-overlay")&&!n.closest(".library-drop-zone"))return null!==n.closest(".library-panel");return!1},lP=e=>e instanceof HTMLElement&&null!==e.closest(".library-panel"),lD=e=>{let{children:t,onFileDrop:n}=e,{t:i}=rK(),{loadSGF:a,loadSGFAsync:o,setFileName:s,setCustomAIModel:l}=tQ(),{clearLoadedFile:u,createFile:c,importZip:d,checkUnsavedChanges:p}=ls(),{setTauriDragging:h,setOverLibrary:f}=nb(),[g,m]=(0,x.useState)(!1),[y,b]=(0,x.useState)(!1),w=(0,x.useRef)(!1),_=(0,x.useRef)(!1),S=(0,x.useCallback)(e=>{m(e),h(e)},[h]),k=(0,x.useCallback)(e=>{b(e),f(e),w.current=e},[f]),T=(0,x.useCallback)(async e=>{try{if(lA){let t=await __webpack_require__.e("128").then(__webpack_require__.bind(__webpack_require__,427));if(e.endsWith(".onnx")){let n=await t.readFile(e),i=e.split(/[\/]/).pop()||"model.onnx";l({data:n.buffer,name:i,date:Date.now(),size:n.buffer.byteLength}),alert(`Loaded AI model: ${i}`);return}if(!await p())return;let n=await t.readTextFile(e);a(n);let i=e.split(/[\/]/).pop()||"unknown.sgf";s(i),u()}}catch(e){console.error("Failed to load file:",e),alert(`Failed to load file: ${e}`)}},[a,s,l,u,p]),C=(0,x.useCallback)(async e=>{try{if(lA){let t=await __webpack_require__.e("128").then(__webpack_require__.bind(__webpack_require__,427));if(e.endsWith(".sgf")){let n=await t.readTextFile(e),i=e.split(/[\/]/).pop()||"unknown.sgf";await c(i,n,null)}else{if(!e.endsWith(".zip"))return void alert("Only .sgf and .zip files can be added to the library");let n=await t.readFile(e);await d(n.buffer)}}}catch(e){console.error("Failed to import file to library:",e),alert(`Failed to import file: ${e}`)}},[c,d]);(0,x.useEffect)(()=>{let e;if(lA)return(async()=>{try{let{getCurrentWebviewWindow:t}=await __webpack_require__.e("0").then(__webpack_require__.bind(__webpack_require__,939)),n=t();e=await n.onDragDropEvent(e=>{let t=e.payload;if("over"===t.type){let e=t.position;e&&k(lN(e.x,e.y))}else if("drop"===t.type){let e=t.paths;if(!e||0===e.length){S(!1),k(!1);return}if(_.current)return;_.current=!0;let n=t.position,i=w.current;n&&(i=lN(n.x,n.y)),S(!1),k(!1);let a=e[0];i?a.endsWith(".sgf")||a.endsWith(".zip")?C(a):alert("Only .sgf and .zip files can be added to the library"):a.endsWith(".sgf")||a.endsWith(".onnx")?T(a):alert("Please drop a .sgf or .onnx file"),setTimeout(()=>{_.current=!1},100)}else"enter"===t.type?(_.current=!1,t.paths&&t.paths.length>0&&S(!0)):("leave"===t.type||"cancel"===t.type)&&(S(!1),k(!1))})}catch(e){console.error("AppDropZone: Failed to setup Tauri listeners:",e)}})(),()=>{e&&e()}},[T,C,S,k]),(0,x.useEffect)(()=>{let e=async e=>{var t;let n=e.target;if(n instanceof HTMLInputElement||n instanceof HTMLTextAreaElement||n.isContentEditable||n.closest('[contenteditable="true"]'))return;let i=null==(t=e.clipboardData)?void 0:t.getData("text/plain");if(!(null==i?void 0:i.trim()))return;let a=i.trim(),l=a.startsWith("("),c=lS(a);if(l||c){e.preventDefault();try{if(!await p())return;let e=await lT(a);await o(e.sgf),s(lw(e)),u()}catch(e){console.error("Failed to load pasted content:",e)}}};return document.addEventListener("paste",e),()=>document.removeEventListener("paste",e)},[o,s,u,p]),(0,x.useEffect)(()=>{let e=async e=>{if((e.ctrlKey||e.metaKey)&&"v"===e.key){let t=e.target;if(!(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||t.isContentEditable||t.closest('[contenteditable="true"]'))){e.preventDefault();try{let e=await lC();if(!(null==e?void 0:e.trim()))return;let t=e.trim(),n=t.startsWith("("),i=lS(t);if(!n&&!i||!await p())return;let a=await lT(t);await o(a.sgf),s(lw(a)),u()}catch(e){console.error("Failed to load pasted content:",e)}}}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[o,s,u,p]);let E=(0,x.useCallback)(async e=>{if(e.name.endsWith(".onnx")){l({data:e,name:e.name,date:e.lastModified,size:e.size}),alert(`Loaded AI model: ${e.name}`);return}if(n)return void n(e);if(!await p())return;let t=new FileReader;t.onload=t=>{var n;let i=null==(n=t.target)?void 0:n.result;if(i)try{a(i),s(e.name),u()}catch(e){alert(`Failed to load SGF file: ${e}`)}},t.readAsText(e)},[a,s,l,u,p]),I=(0,x.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),m(!0),b(lP(e.target))},[]),$=(0,x.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),b(lP(e.target))},[]),O=(0,x.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),e.currentTarget===e.target&&(m(!1),b(!1))},[]),A=(0,x.useCallback)(e=>{var t;if(e.preventDefault(),e.stopPropagation(),m(!1),b(!1),lP(e.target))return;let n=null==(t=e.dataTransfer.files)?void 0:t[0];n&&(n.name.endsWith(".sgf")||n.name.endsWith(".onnx"))?E(n):n&&alert("Please drop a .sgf or .onnx file")},[E]);return(0,v.jsxs)("div",{className:`app-dropzone-wrapper ${g?"dragging":""}`,onDragEnter:I,onDragOver:$,onDragLeave:O,onDrop:A,children:[t,g&&!y&&(0,v.jsx)("div",{className:"app-dropzone-overlay",children:(0,v.jsxs)("div",{className:"app-dropzone-content",children:[(0,v.jsx)("div",{className:"app-dropzone-icon",children:"\uD83D\uDCC1"}),(0,v.jsx)("div",{className:"app-dropzone-text",children:i("dropzone.dropToLoad")}),(0,v.jsx)("div",{className:"app-dropzone-hint",children:i("dropzone.dropOnLibrary")})]})})]})},lM=e=>{let{onNewGame:t,onContinue:n,onOpenLibrary:i,onFileDrop:a,version:o,hasSavedGame:s}=e,{t:l}=rK();return(0,v.jsx)(lD,{onFileDrop:a,children:(0,v.jsx)("div",{className:"landing-page",children:(0,v.jsxs)("div",{className:"landing-content",children:[(0,v.jsx)("h1",{className:"landing-title",children:"Kaya"}),(0,v.jsx)("p",{className:"landing-subtitle",children:l("landing.tagline")}),(0,v.jsxs)("div",{className:"landing-actions",children:[s&&n?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("button",{className:"landing-button primary",onClick:n,children:[(0,v.jsx)(o$,{size:24}),(0,v.jsx)("span",{children:l("landing.continue")})]}),(0,v.jsxs)("button",{className:"landing-button secondary",onClick:t,children:[(0,v.jsx)(o$,{size:24}),(0,v.jsx)("span",{children:l("landing.newGame")})]})]}):(0,v.jsxs)("button",{className:"landing-button primary",onClick:t,children:[(0,v.jsx)(o$,{size:24}),(0,v.jsx)("span",{children:l("landing.newGame")})]}),(0,v.jsxs)("button",{className:"landing-button secondary",onClick:i,children:[(0,v.jsx)(oy,{size:24}),(0,v.jsx)("span",{children:l("landing.library")})]}),(0,v.jsxs)("div",{className:"landing-drop-text",children:[(0,v.jsx)(oa,{size:16}),(0,v.jsx)("span",{children:l("landing.dropSgfToOpen")})]})]}),(0,v.jsxs)("div",{className:"landing-footer",children:["v",o||"0.0.0"]})]})})})},lz=x.memo(e=>{let{vertexSize:t,width:n,height:i,xs:a,ys:o,hoshis:s}=e,l=(0,x.useMemo)(()=>({width:n*t,height:i*t}),[n,i,t]),u=(0,x.useMemo)(()=>Math.max(2,t/8),[t]),c=t/2;return(0,v.jsx)("svg",{className:"shudan-grid",width:l.width,height:l.height,style:{position:"absolute",top:0,left:0},children:(0,v.jsxs)("g",{transform:`translate(${c}, ${c})`,children:[a.map(e=>(0,v.jsx)("line",{x1:e*t,y1:o[0]*t,x2:e*t,y2:o[o.length-1]*t,stroke:"currentColor",strokeWidth:1,opacity:.5},`v-${e}`)),o.map(e=>(0,v.jsx)("line",{x1:a[0]*t,y1:e*t,x2:a[a.length-1]*t,y2:e*t,stroke:"currentColor",strokeWidth:1,opacity:.5},`h-${e}`)),s.map(e=>{let[n,i]=e;return a.includes(n)&&o.includes(i)&&(0,v.jsx)("circle",{cx:n*t,cy:i*t,r:u,fill:"currentColor",opacity:.7},`hoshi-${n}-${i}`)})]})})});lz.displayName="Grid";let lj="ABCDEFGHJKLMNOPQRST".split("");function lR(e,t){return null==e||null==t?e===t:e[0]===t[0]&&e[1]===t[1]}function lL(e,t){if(6>Math.min(e,t))return[];let n=e<13?2:3,i=t<13?2:3,a=n,o=i,s=e-n-1,l=t-i-1,u=(e-1)/2,c=(t-1)/2,d=[];return 7!==e&&7!==t&&(d.push([a,o]),d.push([s,o]),d.push([a,l]),d.push([s,l])),e%2!=0&&t%2!=0&&e>=9&&t>=9&&(d.push([u,c]),e>=18&&(d.push([u,o]),d.push([u,l])),t>=18&&(d.push([a,c]),d.push([s,c]))),d}function lF(e,t){let n=[];for(let i=e;i<=t;i++)n.push(i);return n}function lB(e){return lj[e]||""}function lU(e){return t=>e-t}function lV(e){return Math.floor(Math.random()*(e+1))}function lG(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null==t)for(let t=0;t<e.length;t++)for(let n=0;n<e[0].length;n++)lG(e,[n,t]);else{let[n,i]=t,a=e[i][n];for(let[t,[o,s],l]of[[[1,5,8],[n-1,i],[3,7,6]],[[2,5,6],[n,i-1],[4,7,8]],[[3,7,6],[n+1,i],[1,5,8]],[[4,7,8],[n,i+1],[2,5,6]]])t.includes(a)&&e[s]&&l.includes(e[s][o])&&(e[s][o]=0)}return e}function lH(e){return lG(e.map(e=>e.map(e=>lV(8))))}function lW(e){return e.map(e=>e.map(e=>lV(4)))}function lq(e){let t=null,n=null,i=function(){for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];n=a,null===t&&(t=requestAnimationFrame(()=>{t=null,n&&e(...n)}))};return i.cancel=()=>{null!==t&&(cancelAnimationFrame(t),t=null),n=null},i}function lK(e){return({1:"translate(-0.1em, 0)",2:"translate(0, -0.1em)",3:"translate(0.1em, 0)",4:"translate(0, 0.1em)",5:"translate(-0.06em, -0.06em)",6:"translate(0.06em, -0.06em)",7:"translate(0.06em, 0.06em)",8:"translate(-0.06em, 0.06em)"})[e]||""}function lX(e,t,n,i){let a={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none",zIndex:20},o=i?"#fff"===t?"#000000":"#ffffff":"#000000";if("label"===e.type&&e.label)return(0,v.jsx)("div",{className:"shudan-marker shudan-marker-label",style:{...a,fontSize:Math.max(12,.65*n),fontWeight:"400",color:o,lineHeight:1,fontFamily:"Arial, sans-serif",textAlign:"center",padding:i?"0":"2px 4px",backgroundColor:i?"transparent":"rgba(255, 255, 255, 0.9)",borderRadius:i?"0":"3px"},children:e.label});let s=.85*n;return(0,v.jsxs)("svg",{className:`shudan-marker shudan-marker-${e.type}`,style:{...a,width:s,height:s},viewBox:"0 0 100 100",children:["cross"===e.type&&(0,v.jsxs)("g",{stroke:o,strokeWidth:12,strokeLinecap:"round",children:[(0,v.jsx)("line",{x1:"30",y1:"30",x2:"70",y2:"70"}),(0,v.jsx)("line",{x1:"70",y1:"30",x2:"30",y2:"70"})]}),"circle"===e.type&&(0,v.jsx)("circle",{cx:"50",cy:"50",r:"38",fill:"none",stroke:o,strokeWidth:10}),"triangle"===e.type&&(0,v.jsx)("polygon",{points:"50,12 88,80 12,80",fill:"none",stroke:o,strokeWidth:10,strokeLinejoin:"round"}),"square"===e.type&&(0,v.jsx)("rect",{x:"15",y:"15",width:"70",height:"70",fill:"none",stroke:o,strokeWidth:10}),"point"===e.type&&(0,v.jsx)("circle",{cx:"50",cy:"50",r:"20",fill:"#000000"}),"setup"===e.type&&(0,v.jsx)("rect",{x:"40",y:"40",width:"20",height:"20",fill:"#51CF66",rx:"2"})]})}let lZ=x.memo(e=>{let{x:t,y:n,sign:i,vertexSize:a,isLastMove:o,isNextMove:s,isDimmed:l,isDead:u,isCursor:c,showNextMovePreview:d,nextMovePlayer:p,shift:h,random:f,paint:g=0,paintOpacity:m,paintLeft:y=0,paintRight:b=0,paintTop:x=0,paintBottom:w=0,marker:_=null,heat:S=null}=e,k=1===p?"#000":"#fff",T=Math.abs(g)>.05,C=void 0!==m?m:.5*!!T,E=Math.abs(y)>.5,I=Math.abs(b)>.5,$=Math.abs(x)>.5,O=Math.abs(w)>.5,A=T&&E&&Math.sign(y)===Math.sign(g),N=T&&I&&Math.sign(b)===Math.sign(g),P=T&&$&&Math.sign(x)===Math.sign(g),D=T&&O&&Math.sign(w)===Math.sign(g);return(0,v.jsxs)("div",{className:`shudan-vertex shudan-sign_${1===i?1:-1===i?-1:0}${l?" shudan-dimmed":""}${T?` shudan-paint_${g>0?1:-1}`:""}${A?" shudan-paintedleft":""}${N?" shudan-paintedright":""}${P?" shudan-paintedtop":""}${D?" shudan-paintedbottom":""}${S&&S.strength>0?` shudan-heat_${S.strength}`:""}`,"data-x":t,"data-y":n,style:{position:"absolute",left:t*a-a/2,top:-a/2,width:a,height:a,cursor:"default","--shudan-paint-opacity":C},children:[T&&(0,v.jsx)("div",{className:"shudan-paint",style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none"}}),d&&(0,v.jsxs)("div",{className:"shudan-next-move-preview",style:{width:"100%",height:"100%",position:"relative"},children:[(0,v.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"50%",height:"50%",borderRadius:"50%",border:`2px solid ${1===p?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.5)"}`,backgroundColor:"transparent"}}),(0,v.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"30%",height:"30%",borderRadius:"50%",backgroundColor:k,opacity:.6}})]}),c&&(0,v.jsx)("div",{className:"shudan-cursor-marker",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80%",height:"80%",border:"3px solid var(--accent-primary, #3498db)",borderRadius:"4px",backgroundColor:"transparent",pointerEvents:"none",animation:"cursor-pulse 1.5s ease-in-out infinite",zIndex:100}}),0!==i&&(0,v.jsxs)("div",{className:`shudan-stone shudan-stone_${1===i?"black":"white"}${h?` shudan-shift_${h}`:""}${void 0!==f?` shudan-random_${f}`:""}${u?" dead":""}`,style:{position:"absolute",top:"50%",left:"50%",width:"90%",height:"90%",borderRadius:"50%",transform:h?`translate(-50%, -50%) ${lK(h)}`:"translate(-50%, -50%)"},children:[o&&!_&&(0,v.jsx)("div",{className:"shudan-last-move-marker",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"35%",height:"35%",borderRadius:"50%",backgroundColor:1===i?"#fff":"#000"}}),s&&!_&&(0,v.jsx)("div",{className:"shudan-next-move-marker",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"30%",height:"30%",borderRadius:"50%",backgroundColor:1===i?"#fff":"#000",opacity:.7}}),_&&lX(_,1===i?"#000":"#fff",a,!0)]}),0===i&&_&&lX(_,"",a,!1),S&&S.strength>=0&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:`shudan-heat shudan-heat_${S.strength}`,style:{zIndex:25}}),S.text&&(0,v.jsx)("div",{className:"shudan-heatlabel",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:Math.max(8,.3*a),fontWeight:"500",color:"#000000ff",lineHeight:1.2,fontFamily:"Arial, sans-serif",textAlign:"center",pointerEvents:"none",whiteSpace:"pre-line",zIndex:26},children:S.text})]})]})},(e,t)=>{var n,i,a,o,s,l,u,c;return e.sign===t.sign&&e.isDimmed===t.isDimmed&&e.isDead===t.isDead&&e.isLastMove===t.isLastMove&&e.isNextMove===t.isNextMove&&e.isCursor===t.isCursor&&e.showNextMovePreview===t.showNextMovePreview&&e.vertexSize===t.vertexSize&&e.shift===t.shift&&e.paint===t.paint&&e.paintLeft===t.paintLeft&&e.paintRight===t.paintRight&&e.paintTop===t.paintTop&&e.paintBottom===t.paintBottom&&(null==(n=e.marker)?void 0:n.type)===(null==(i=t.marker)?void 0:i.type)&&(null==(a=e.marker)?void 0:a.label)===(null==(o=t.marker)?void 0:o.label)&&(null==(s=e.heat)?void 0:s.strength)===(null==(l=t.heat)?void 0:l.strength)&&(null==(u=e.heat)?void 0:u.text)===(null==(c=t.heat)?void 0:c.text)});lZ.displayName="Vertex";let lY=x.memo(e=>{let{y:t,xs:n,row:i,vertexSize:a,lastMove:o,nextMove:s,cursorPosition:l,dimmedSet:u,nextMovePlayer:c,shiftMapRow:d,randomMapRow:p,paintMap:h,markerMapRow:f,heatMapRow:g,ownershipMapRow:m}=e;return(0,v.jsx)("div",{style:{height:a,position:"relative"},children:n.map(e=>{var n,y,b,x,w;let _=[e,t],S=i[e]??0,k=!!(s&&lR(_,s)),T=!!(null!=o&&lR(_,o)),C=!!(l&&lR(_,l)),E=u.has(`${e},${t}`),I=E,$=k&&0===S,O=(null==h||null==(n=h[t])?void 0:n[e])??0,A=(null==m?void 0:m[e])??0,N=Math.abs(O)>.5,P=Math.abs(A)>.05,D=N?O:P?A:0,M=N?.5:.6*Math.abs(A),z=(null==h||null==(y=h[t])?void 0:y[e-1])??0,j=(null==h||null==(b=h[t])?void 0:b[e+1])??0,R=(null==h||null==(x=h[t-1])?void 0:x[e])??0,L=(null==h||null==(w=h[t+1])?void 0:w[e])??0,F=(null==f?void 0:f[e])??null,B=(null==g?void 0:g[e])??null;return(0,v.jsx)(lZ,{x:e,y:t,sign:S,vertexSize:a,isLastMove:T,isNextMove:k,isCursor:C,isDimmed:E,isDead:I,showNextMovePreview:$,nextMovePlayer:c,shift:null==d?void 0:d[e],random:null==p?void 0:p[e],paint:D,paintOpacity:M,paintLeft:z,paintRight:j,paintTop:R,paintBottom:L,marker:F,heat:B},`vertex-${e}-${t}`)})})},(e,t)=>{if(e.row!==t.row||e.y!==t.y||e.vertexSize!==t.vertexSize||e.nextMovePlayer!==t.nextMovePlayer||e.dimmedSet!==t.dimmedSet||e.paintMap!==t.paintMap||e.markerMapRow!==t.markerMapRow||e.heatMapRow!==t.heatMapRow||e.shiftMapRow!==t.shiftMapRow||e.randomMapRow!==t.randomMapRow||e.ownershipMapRow!==t.ownershipMapRow)return!1;let n=(e,n)=>e!==n&&(!!e||!!n)&&(!e&&n?n[1]===t.y:e&&!n?e[1]===t.y:(e[0]!==n[0]||e[1]!==n[1])&&(e[1]===t.y||n[1]===t.y));return!(n(e.lastMove,t.lastMove)||n(e.nextMove,t.nextMove)||n(e.cursorPosition,t.cursorPosition))}),lQ=e=>{let{id:t,className:n="",style:i,vertexSize:a=24,signMap:o=[],showCoordinates:s=!0,coordX:l=lB,coordY:u,rangeX:c,rangeY:d,lastMove:p=null,nextMove:h=null,nextMovePlayer:f=1,currentPlayer:g=1,dimmedVertices:m=[],paintMap:y=null,fuzzyStonePlacement:b=!1,shiftMap:w,randomMap:_,gameId:S,cursorPosition:k=null,markerMap:T=null,ghostMarker:C=null,heatMap:E=null,ownershipMap:I=null,onVertexClick:$,onVertexMouseUp:O,onVertexMouseDown:A,onVertexMouseMove:N,onVertexRightClick:P,onVertexTouchStart:D,onVertexTouchMove:M,onVertexTouchEnd:z,onVertexTouchCancel:j}=e,R=x.useRef(null),L=x.useRef(null),[F,B]=x.useState(!1),U=x.useMemo(()=>{let e=new Set;return null==m||m.forEach(t=>{let[n,i]=t;return e.add(`${n},${i}`)}),e},[m]),V=o.length,G=V>0?o[0].length:0,H=x.useRef(null),W=x.useRef(null),q=x.useRef(null),K=x.useRef(null),X=void 0!==w&&void 0!==_,Z=x.useCallback(e=>{var t;if(R.current=e,!L.current)return;if(null===e){L.current.style.display="none",B(!1);return}let[n,i]=e,s=(null==(t=o[i])?void 0:t[n])===0;C||s?(L.current.style.display="block",L.current.style.left=`${n*a-a/2}px`,L.current.style.top=`${i*a-a/2}px`,B(!0)):(L.current.style.display="none",B(!1))},[o,a,C]);x.useEffect(()=>{R.current&&Z(R.current)},[o,Z]),x.useEffect(()=>{if(X||!b){H.current=null,W.current=null,q.current=null,K.current=null;return}let e=S!==q.current,t=!K.current||K.current.width!==G||K.current.height!==V,n=!H.current||!W.current;if(e||t||n){let e=Array(V).fill(null).map(()=>Array(G).fill(0));H.current=lH(e),W.current=lW(e),q.current=S??null,K.current={width:G,height:V}}},[b,S,V,G,X,w,_]);let Y=X?w:H.current,Q=X?_:W.current,J=u||lU(V),ee=x.useMemo(()=>c?lF(c[0],c[1]):lF(0,G-1),[G,c]),et=x.useMemo(()=>d?lF(d[0],d[1]):lF(0,V-1),[V,d]),en=x.useMemo(()=>lL(G,V),[G,V]),er=x.useMemo(()=>({width:G*a,height:V*a}),[G,V,a]),ei=x.useCallback(e=>{if(!$)return;let t=e.target.closest("[data-x][data-y]");if(t){let n=parseInt(t.getAttribute("data-x")||""),i=parseInt(t.getAttribute("data-y")||"");isNaN(n)||isNaN(i)||$(e,[n,i])}},[$]),ea=x.useCallback(e=>{if(!P)return;let t=e.target.closest("[data-x][data-y]");if(t){let n=parseInt(t.getAttribute("data-x")||""),i=parseInt(t.getAttribute("data-y")||"");isNaN(n)||isNaN(i)||P(e,[n,i])}},[P]),eo=x.useCallback(e=>{if(!O)return;let t=e.target.closest("[data-x][data-y]");if(t){let n=parseInt(t.getAttribute("data-x")||""),i=parseInt(t.getAttribute("data-y")||"");isNaN(n)||isNaN(i)||O(e,[n,i])}},[O]),es=x.useCallback(e=>{if(!A)return;let t=e.target.closest("[data-x][data-y]");if(t){let n=parseInt(t.getAttribute("data-x")||""),i=parseInt(t.getAttribute("data-y")||"");isNaN(n)||isNaN(i)||A(e,[n,i])}},[A]),el=x.useCallback(e=>{let t=e.target.closest("[data-x][data-y]");if(t){let n=parseInt(t.getAttribute("data-x")||""),i=parseInt(t.getAttribute("data-y")||"");isNaN(n)||isNaN(i)||(Z([n,i]),N&&N(e,[n,i]))}else Z(null)},[Z,N]),eu=x.useMemo(()=>lq(el),[el]);x.useEffect(()=>()=>{eu.cancel()},[eu]),x.useCallback((e,t)=>{$&&$(e,t)},[$]),x.useCallback((e,t)=>{O&&O(e,t)},[O]),x.useCallback((e,t)=>{A&&A(e,t)},[A]),x.useCallback(e=>{Z(e)},[Z]),x.useCallback(()=>{Z(null)},[Z]);let ec=x.useCallback(()=>{Z(null)},[Z]),ed=x.useCallback(e=>{let t=document.elementFromPoint(e.clientX,e.clientY);if(!t)return null;let n=t.closest("[data-x][data-y]");if(!n)return null;let i=parseInt(n.getAttribute("data-x")||""),a=parseInt(n.getAttribute("data-y")||"");return isNaN(i)||isNaN(a)||i<0||i>=G||a<0||a>=V?null:[i,a]},[G,V]),ep=x.useRef(null),eh=x.useCallback(e=>{if(1!==e.touches.length)return;let t=ed(e.touches[0]);t&&(ep.current={startVertex:t,currentVertex:t,startTime:Date.now(),moved:!1},Z(t),D&&D(e,t))},[ed,Z,D]),ef=x.useCallback(e=>{if(1!==e.touches.length||!ep.current)return;let t=ed(e.touches[0]),n=ep.current.currentVertex;t&&n&&(t[0]!==n[0]||t[1]!==n[1])&&(ep.current.moved=!0),ep.current.currentVertex=t,Z(t),M&&M(e,t)},[ed,Z,M]),eg=x.useMemo(()=>lq(ef),[ef]),em=x.useCallback(e=>{if(!ep.current)return;let{startVertex:t,currentVertex:n,startTime:i,moved:a}=ep.current,o=Date.now()-i;Z(null),z&&z(e,n),!a&&o<300&&t&&n&&t[0]===n[0]&&t[1]===n[1]&&$&&!z&&$(e,n),ep.current=null},[Z,z,$]),ey=x.useCallback(e=>{Z(null),ep.current=null,j&&j(e)},[Z,j]);x.useEffect(()=>()=>{eg.cancel()},[eg]);let eb={position:"relative",display:"inline-block",padding:a,paddingTop:.6*a,paddingBottom:.4*a,paddingLeft:.5*a,paddingRight:.5*a,boxSizing:"border-box",...i},ev={position:"relative",width:er.width,height:er.height};return(0,v.jsxs)("div",{id:t,className:`shudan-goban ${n}`.trim(),style:eb,children:[s&&(0,v.jsx)("div",{className:"shudan-coord-x",style:{display:"flex",height:.6*a,position:"relative",marginLeft:a},children:ee.map(e=>(0,v.jsx)("div",{style:{position:"absolute",left:e*a+a/2,width:a,transform:"translateX(-50%)",textAlign:"center",fontSize:Math.max(10,a/2),lineHeight:`${.6*a}px`,userSelect:"none"},children:l(e)},`coord-x-${e}`))}),(0,v.jsxs)("div",{style:{display:"flex"},children:[s&&(0,v.jsx)("div",{className:"shudan-coord-y",style:{display:"flex",flexDirection:"column",width:a,position:"relative",height:er.height,marginTop:a/2},children:et.map(e=>(0,v.jsx)("div",{style:{position:"absolute",top:e*a,height:a,transform:"translateY(-50%)",width:"100%",textAlign:"center",fontSize:Math.max(10,a/2),lineHeight:`${a}px`,userSelect:"none"},children:J(e)},`coord-y-${e}`))}),(0,v.jsxs)("div",{className:"shudan-content",style:ev,children:[(0,v.jsx)(lz,{vertexSize:a,width:G,height:V,xs:ee,ys:et,hoshis:en}),(0,v.jsxs)("div",{className:"shudan-vertices",style:{position:"absolute",top:a/2,left:a/2,width:"100%",height:"100%",touchAction:"none"},onClick:ei,onContextMenu:ea,onMouseUp:eo,onMouseDown:es,onMouseMove:eu,onMouseLeave:ec,onTouchStart:eh,onTouchMove:eg,onTouchEnd:em,onTouchCancel:ey,children:[x.useMemo(()=>et.map(e=>(0,v.jsx)(lY,{y:e,xs:ee,row:o[e]||[],vertexSize:a,lastMove:p,nextMove:h,cursorPosition:k,dimmedSet:U,nextMovePlayer:f,shiftMapRow:null==Y?void 0:Y[e],randomMapRow:null==Q?void 0:Q[e],paintMap:y||void 0,markerMapRow:null==T?void 0:T[e],heatMapRow:null==E?void 0:E[e],ownershipMapRow:null==I?void 0:I[e]},`row-${e}`)),[et,ee,a,o,h,p,k,U,f,Y,Q,y,T,E,I]),(0,v.jsx)("div",{ref:L,className:"shudan-ghost-stone-layer",style:{position:"absolute",left:0,top:0,width:a,height:a,pointerEvents:"none",zIndex:2,display:F?"block":"none"},children:C?"none"===C.type?null:(0,v.jsx)("div",{style:{opacity:.6,position:"absolute",top:0,left:0,width:"100%",height:"100%"},children:lX(C,"",a,!1)}):void 0!==g?(0,v.jsx)("div",{className:"shudan-ghost-stone",style:{width:"100%",height:"100%",borderRadius:"50%",backgroundColor:1===g?"#000":"#fff",opacity:.35}}):null})]})]}),s&&(0,v.jsx)("div",{className:"shudan-coord-y",style:{display:"flex",flexDirection:"column",width:a,position:"relative",height:er.height,marginTop:a/2},children:et.map(e=>(0,v.jsx)("div",{style:{position:"absolute",top:e*a,height:a,transform:"translateY(-50%)",width:"100%",textAlign:"center",fontSize:Math.max(10,a/2),lineHeight:`${a}px`,userSelect:"none"},children:J(e)},`coord-y-right-${e}`))})]}),s&&(0,v.jsx)("div",{className:"shudan-coord-x",style:{display:"flex",height:.6*a,position:"relative",marginLeft:a,marginTop:-(.3*a)},children:ee.map(e=>(0,v.jsx)("div",{style:{position:"absolute",left:e*a+a/2,width:a,transform:"translateX(-50%)",textAlign:"center",fontSize:Math.max(10,a/2),lineHeight:`${.6*a}px`,userSelect:"none"},children:l(e)},`coord-x-bottom-${e}`))})]})};function lJ(e,t){return Array.from({length:t},()=>Array.from({length:e},()=>0))}function l0(e){let{enabled:t,width:n,height:i,gameId:a}=e,o=(0,x.useRef)({shiftMap:null,randomMap:null}),s=(0,x.useRef)(null),l=(0,x.useCallback)(()=>{if(n<=0||i<=0){o.current={shiftMap:null,randomMap:null},s.current=null;return}let e=lJ(n,i);o.current={shiftMap:lH(e),randomMap:lW(e)},s.current={gameId:a??null,width:n,height:i}},[n,i,a]);return(0,x.useEffect)(()=>{if(!t){o.current={shiftMap:null,randomMap:null},s.current=null;return}let e=!s.current,u=s.current&&s.current.gameId!==(a??null),c=s.current&&(s.current.width!==n||s.current.height!==i);(e||u||c)&&l()},[t,a,n,i,l]),o.current}function l1(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{threshold:n=50,maxTime:i=300,preventDefault:a=!0,horizontalOnly:o=!1,verticalOnly:s=!1}=t,l=(0,x.useRef)(null);return{onTouchStart:(0,x.useCallback)(e=>{if(1!==e.touches.length)return;let t=e.touches[0];l.current={startX:t.clientX,startY:t.clientY,startTime:Date.now(),tracking:!0}},[]),onTouchMove:(0,x.useCallback)(e=>{var t;if(null==(t=l.current)?void 0:t.tracking){if(1!==e.touches.length){l.current=null;return}if(a){let t=e.touches[0],n=Math.abs(t.clientX-l.current.startX),i=Math.abs(t.clientY-l.current.startY);o&&n>i&&n>10?e.preventDefault():s&&i>n&&i>10&&e.preventDefault()}}},[a,o,s]),onTouchEnd:(0,x.useCallback)(t=>{var a,u,c,d,p,h;if(!(null==(a=l.current)?void 0:a.tracking))return;let{startX:f,startY:g,startTime:m}=l.current;l.current=null;let y=t.changedTouches[0];if(!y)return;let b=y.clientX,v=y.clientY,x=Date.now(),w=b-f,_=v-g,S=x-m;if(S>i)return;let k=Math.abs(w),T=Math.abs(_),C=null;if(o||!s&&k>T?k>=n&&(C=w>0?"right":"left"):(s||T>k)&&T>=n&&(C=_>0?"down":"up"),!C)return;let E={direction:C,deltaX:w,deltaY:_,velocity:Math.max(k,T)/S,duration:S};switch(C){case"left":null==(c=e.onSwipeLeft)||c.call(e,E);break;case"right":null==(d=e.onSwipeRight)||d.call(e,E);break;case"up":null==(p=e.onSwipeUp)||p.call(e,E);break;case"down":null==(h=e.onSwipeDown)||h.call(e,E)}null==(u=e.onSwipe)||u.call(e,E)},[e,n,i,o,s]),onTouchCancel:(0,x.useCallback)(()=>{l.current=null},[])}}function l2(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return l1(n?{onSwipeLeft:t,onSwipeRight:e}:{},{threshold:60,maxTime:400,horizontalOnly:!0,preventDefault:!0})}lQ.displayName="Goban";let l3=(0,x.memo)(()=>{let{t:e}=rK(),{goBack:t,goForward:n,goBackSteps:i,goForwardSteps:a,goToStart:o,goToEnd:s,goToPreviousSibling:l,goToNextSibling:u,goToSiblingIndex:c,navigateToMove:d,siblingInfo:p,branchInfo:h,switchBranch:f,switchToBranchIndex:g,canGoBack:m,canGoForward:y,moveNumber:b,totalMovesInBranch:w}=tG(),{currentBoard:_,currentNode:S,gameInfo:k}=tH(),{playMove:T,resign:C}=tW(),{scoringMode:E,toggleScoringMode:I,autoEstimateDeadStones:$,clearDeadStones:O,isEstimating:A}=tK(),{navigationMode:N}=ng(),[P,D]=(0,x.useState)(!1),[M,z]=(0,x.useState)(!1),[j,R]=(0,x.useState)(!1),[L,F]=(0,x.useState)(""),B=(0,x.useRef)(null);(0,x.useEffect)(()=>{(M||j)&&B.current&&(B.current.focus(),B.current.select())},[M,j]);let U=(0,x.useMemo)(()=>{var e;return(null==S?void 0:S.data.B)?-1:(null==S?void 0:S.data.W)?1:(null==S||null==(e=S.data.PL)?void 0:e[0])?"W"===S.data.PL[0]?-1:1:k.handicap&&k.handicap>=2?b%2==0?-1:1:b%2==0?1:-1},[S,k.handicap,b]),V=_.getCaptures(1),G=_.getCaptures(-1),H=k.playerBlack||e("gameInfo.black"),W=k.playerWhite||e("gameInfo.white"),q=k.rankBlack,K=k.rankWhite;(0,x.useEffect)(()=>{let e=!1,i=80,a=a=>{if(!(N||a.target instanceof HTMLInputElement||a.target instanceof HTMLTextAreaElement||a.target.isContentEditable)&&(!e||!a.repeat))switch(a.key){case"ArrowLeft":a.preventDefault(),m&&!e&&(e=!0,requestAnimationFrame(()=>t()),setTimeout(()=>{e=!1},i));break;case"ArrowRight":a.preventDefault(),y&&!e&&(e=!0,requestAnimationFrame(()=>n()),setTimeout(()=>{e=!1},i));break;case"ArrowUp":a.preventDefault(),!e&&h.hasBranches&&(e=!0,requestAnimationFrame(()=>f("next")),setTimeout(()=>{e=!1},i));break;case"ArrowDown":a.preventDefault(),!e&&h.hasBranches&&(e=!0,requestAnimationFrame(()=>f("previous")),setTimeout(()=>{e=!1},i));break;case"Home":a.preventDefault(),requestAnimationFrame(()=>o());break;case"End":a.preventDefault(),requestAnimationFrame(()=>s())}},l=!1,u=0,c=30,d=50,p=e=>{let i=e.target,a=i.closest(".gameboard-board-wrapper"),o=i.closest(".react-flow"),s=i.closest(".edit-toolbar, .score-estimator, .ai-analysis-config");(a||o)&&!s&&!l&&Math.abs(u+=e.deltaY)>c&&(l=!0,requestAnimationFrame(()=>{u<0&&m?t():u>0&&y&&n(),u=0}),setTimeout(()=>{l=!1},d))};return window.addEventListener("keydown",a),window.addEventListener("wheel",p,{passive:!0}),()=>{window.removeEventListener("keydown",a),window.removeEventListener("wheel",p)}},[m,y,t,n,o,s,f,h.hasBranches,N]),(0,x.useCallback)(()=>{T([-1,-1],U)},[T,U]),(0,x.useCallback)(()=>{D(!0)},[]);let X=(0,x.useCallback)(()=>{C(U),D(!1)},[U,C]),Z=(0,x.useCallback)(()=>{D(!1)},[]),Y=(0,x.useCallback)(()=>{F(String(b)),z(!0)},[b]),Q=(0,x.useCallback)(()=>{F(String(h.currentIndex)),R(!0)},[h.currentIndex]),J=(0,x.useCallback)(()=>{let e=parseInt(L,10);!isNaN(e)&&e>=0&&(M?d(e):j&&g(e)),z(!1),R(!1)},[L,M,j,d,g]),ee=(0,x.useCallback)(e=>{"Enter"===e.key?J():"Escape"===e.key&&(z(!1),R(!1)),e.stopPropagation()},[J]),et=(0,x.useCallback)(()=>{z(!1),R(!1)},[]);return(0,v.jsxs)("div",{className:"board-controls",children:[(0,v.jsxs)("div",{className:"player-info player-black",children:[(0,v.jsx)("div",{className:`player-indicator ${1===U?"active":""}`,style:{background:"radial-gradient(circle at 35% 35%, #555 0%, #222 30%, #000 100%)",boxShadow:"0 2px 3px rgba(0, 0, 0, 0.4)"}}),(0,v.jsxs)("div",{className:"player-details",children:[(0,v.jsxs)("div",{className:"player-name",children:[H,q&&(0,v.jsxs)("span",{className:"player-rank",children:[" (",q,")"]})]}),(0,v.jsxs)("div",{className:"player-captures",children:[V," ",e("boardControls.captured")]})]})]}),(0,v.jsx)("div",{className:"navigation-section",children:E?(0,v.jsxs)("div",{className:"scoring-controls-row",children:[(0,v.jsx)("button",{onClick:O,title:e("scoring.clearAllDeadStones"),className:"scoring-button",children:e("scoring.clear")}),(0,v.jsx)("button",{onClick:$,disabled:A,title:e("scoring.autoEstimateDescription"),className:"scoring-button scoring-auto",children:A?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ob,{size:18,className:"spinner"}),e("scoring.estimating")]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(aX,{size:18}),e("scoring.autoEstimate")]})}),(0,v.jsxs)("button",{onClick:I,title:e("scoring.exitScoringMode"),className:"scoring-button scoring-done",children:[(0,v.jsx)(oY,{size:18}),e("scoring.done")]})]}):(0,v.jsxs)(v.Fragment,{children:[h.hasBranches&&(0,v.jsxs)("div",{className:"branch-controls-row",children:[(0,v.jsx)("button",{onClick:()=>f("previous"),title:e("boardControls.previousBranch"),className:"branch-nav-button",children:(0,v.jsx)(aQ,{size:14})}),j?(0,v.jsxs)("div",{className:"branch-edit-container",children:[(0,v.jsx)("input",{ref:B,type:"number",min:"1",max:h.totalBranches,value:L,onChange:e=>F(e.target.value),onKeyDown:ee,onBlur:et,className:"edit-input edit-input-small"}),(0,v.jsxs)("span",{className:"branch-total",children:["/",h.totalBranches]})]}):(0,v.jsxs)("div",{className:"branch-info-display editable-value",onClick:Q,title:h.isAtFork?e("boardControls.clickToSetBranch"):`${e("boardControls.clickToSetBranch")} (${e("boardControls.movesIntoBranch",{count:h.depthFromBranchRoot})})`,children:[(0,v.jsx)("span",{className:"branch-label",children:e("boardControls.branch")}),(0,v.jsx)("span",{className:"branch-current",children:h.currentIndex}),(0,v.jsx)("span",{className:"branch-separator",children:"/"}),(0,v.jsx)("span",{className:"branch-total",children:h.totalBranches}),!h.isAtFork&&(0,v.jsxs)("span",{className:"branch-depth",title:e("boardControls.movesIntoBranch",{count:h.depthFromBranchRoot}),children:["+",h.depthFromBranchRoot]}),(0,v.jsx)(aX,{className:"edit-hint-icon",size:10})]}),(0,v.jsx)("button",{onClick:()=>f("next"),title:e("boardControls.nextBranch"),className:"branch-nav-button",children:(0,v.jsx)(a1,{size:14})})]}),(0,v.jsxs)("div",{className:"main-nav-row",children:[(0,v.jsx)("button",{onClick:o,disabled:!m,title:e("boardControls.goToStart"),className:"nav-button",children:(0,v.jsx)(oj,{size:20})}),(0,v.jsx)("button",{onClick:()=>i(10),disabled:!m,title:e("boardControls.goBack10"),className:"nav-button",children:(0,v.jsx)(oP,{size:20})}),(0,v.jsx)("button",{onClick:t,disabled:!m,title:e("boardControls.previousMove"),className:"nav-button",children:(0,v.jsx)(aJ,{size:20})}),(0,v.jsxs)("div",{className:"move-display",children:[(0,v.jsx)("div",{className:"move-number",children:M?(0,v.jsx)("input",{ref:B,type:"number",min:"0",value:L,onChange:e=>F(e.target.value),onKeyDown:ee,onBlur:et,className:"edit-input"}):(0,v.jsxs)("span",{onClick:Y,className:"editable-value move-number-display",title:e("boardControls.clickToJumpMove"),children:[e("boardControls.move")," ",b," / ",w,(0,v.jsx)(aX,{className:"edit-hint-icon",size:10})]})}),(0,v.jsxs)("div",{className:"current-player",children:[(0,v.jsx)("div",{className:"current-player-stone",style:{width:"10px",height:"10px",borderRadius:"50%",background:1===U?"radial-gradient(circle at 30% 30%, #555 0%, #000 100%)":"radial-gradient(circle at 30% 30%, #fff 0%, #f0f0f0 25%, #d5d5d5 60%, #bbb 100%)",boxShadow:"0 1px 2px rgba(0,0,0,0.3)",border:1===U?"1px solid rgba(255,255,255,0.1)":"1px solid rgba(0,0,0,0.1)"}}),e(1===U?"gameInfo.black":"gameInfo.white")]})]}),(0,v.jsx)("button",{onClick:n,disabled:!y,title:e("boardControls.nextMove"),className:"nav-button",children:(0,v.jsx)(a0,{size:20})}),(0,v.jsx)("button",{onClick:()=>a(10),disabled:!y,title:e("boardControls.goForward10"),className:"nav-button",children:(0,v.jsx)(on,{size:20})}),(0,v.jsx)("button",{onClick:s,disabled:!y,title:e("boardControls.goToEnd"),className:"nav-button",children:(0,v.jsx)(oR,{size:20})})]})]})}),(0,v.jsxs)("div",{className:"player-info player-white",children:[(0,v.jsxs)("div",{className:"player-details",children:[(0,v.jsxs)("div",{className:"player-name",children:[W,K&&(0,v.jsxs)("span",{className:"player-rank",children:[" (",K,")"]})]}),(0,v.jsxs)("div",{className:"player-captures",children:[G," ",e("boardControls.captured")]})]}),(0,v.jsx)("div",{className:`player-indicator ${-1===U?"active":""}`,style:{background:"radial-gradient(circle at 30% 30%, #fff 0%, #f0f0f0 25%, #d5d5d5 60%, #bbb 100%)",boxShadow:"0 2px 3px rgba(0, 0, 0, 0.3)"}})]}),(0,v.jsx)(lf,{isOpen:P,title:e("boardControls.resignGame"),message:e("boardControls.resignConfirm",{player:e(1===U?"gameInfo.black":"gameInfo.white")}),confirmLabel:e("boardControls.resign"),cancelLabel:e("cancel"),onConfirm:X,onCancel:Z})]})}),l4=e=>{let{scoreData:t,deadStones:n,playerBlack:i="Black",playerWhite:a="White",rankBlack:o,rankWhite:s}=e,{t:l}=rK(),u=(0,x.useMemo)(()=>{let{blackTerritory:e,whiteTerritory:n,blackCaptures:i,whiteCaptures:a,blackDeadStones:o,whiteDeadStones:s,komi:l}=t,u=e+i+s,c=n+a+o+l,d=u-c;return{blackScore:u,whiteScore:c,winner:d>0?"Black":d<0?"White":"Jigo",margin:Math.abs(d)}},[t]);return(0,v.jsx)("div",{className:"score-estimator",children:(0,v.jsxs)("div",{className:"score-estimator-content",children:[(0,v.jsxs)("div",{className:"score-section",children:[(0,v.jsxs)("div",{className:"score-player black",children:[(0,v.jsxs)("div",{className:"score-player-name",children:[i,o&&(0,v.jsxs)("span",{className:"score-player-rank",children:[" (",o,")"]})]}),(0,v.jsxs)("div",{className:"score-breakdown",children:[(0,v.jsxs)("div",{className:"score-item",title:l("scoring.territoryBlackTitle"),children:[(0,v.jsx)("span",{className:"score-label",children:l("scoring.territory")}),(0,v.jsx)("span",{className:"score-value",children:t.blackTerritory})]}),(0,v.jsxs)("div",{className:"score-item",title:l("scoring.capturesBlackTitle"),children:[(0,v.jsx)("span",{className:"score-label",children:l("scoring.captures")}),(0,v.jsx)("span",{className:"score-value",children:t.blackCaptures})]}),(0,v.jsxs)("div",{className:"score-item",title:l("scoring.deadStonesBlackTitle"),children:[(0,v.jsx)("span",{className:"score-label",children:l("scoring.deadStones")}),(0,v.jsx)("span",{className:"score-value",children:t.whiteDeadStones})]}),(0,v.jsxs)("div",{className:"score-item",style:{visibility:"hidden"},children:[(0,v.jsx)("span",{className:"score-label",children:"\xa0"}),(0,v.jsx)("span",{className:"score-value",children:"\xa0"})]})]}),(0,v.jsxs)("div",{className:"score-total",children:[(0,v.jsx)("span",{className:"score-label",children:l("scoring.total")}),(0,v.jsx)("span",{className:"score-value",children:u.blackScore})]})]}),(0,v.jsxs)("div",{className:"score-player white",children:[(0,v.jsxs)("div",{className:"score-player-name",children:[a,s&&(0,v.jsxs)("span",{className:"score-player-rank",children:[" (",s,")"]})]}),(0,v.jsxs)("div",{className:"score-breakdown",children:[(0,v.jsxs)("div",{className:"score-item",title:l("scoring.territoryWhiteTitle"),children:[(0,v.jsx)("span",{className:"score-label",children:l("scoring.territory")}),(0,v.jsx)("span",{className:"score-value",children:t.whiteTerritory})]}),(0,v.jsxs)("div",{className:"score-item",title:l("scoring.capturesWhiteTitle"),children:[(0,v.jsx)("span",{className:"score-label",children:l("scoring.captures")}),(0,v.jsx)("span",{className:"score-value",children:t.whiteCaptures})]}),(0,v.jsxs)("div",{className:"score-item",title:l("scoring.deadStonesWhiteTitle"),children:[(0,v.jsx)("span",{className:"score-label",children:l("scoring.deadStones")}),(0,v.jsx)("span",{className:"score-value",children:t.blackDeadStones})]}),(0,v.jsxs)("div",{className:"score-item",title:l("scoring.komiTitle"),children:[(0,v.jsx)("span",{className:"score-label",children:l("scoring.komi")}),(0,v.jsx)("span",{className:"score-value",children:t.komi})]})]}),(0,v.jsxs)("div",{className:"score-total",children:[(0,v.jsx)("span",{className:"score-label",children:l("scoring.total")}),(0,v.jsx)("span",{className:"score-value",children:u.whiteScore})]})]})]}),(0,v.jsx)("div",{className:"score-result",children:"Jigo"===u.winner?(0,v.jsx)("div",{className:"score-winner",children:l("scoring.jigo")}):(0,v.jsx)("div",{className:"score-winner",children:l("scoring.winsBy",{player:u.winner,points:u.margin})})}),(0,v.jsxs)("div",{className:"score-info",children:[(0,v.jsx)("p",{children:l("scoring.clickToToggle")}),(0,v.jsx)("p",{className:"score-dead-count",children:l("scoring.markedAsDead",{count:n.size})})]})]})})},l6=()=>{let{t:e}=rK(),{currentNode:t,gameInfo:n,moveNumber:i}=tH(),{playMove:a}=tW(),{editTool:o,setEditTool:s,editPlayMode:l,setEditPlayMode:u,copiedBranch:c,copyBranch:d,pasteBranch:p,deleteBranch:h,removeMarker:f,clearAllMarkersAndLabels:g,clearSetupStones:m,makeMainVariation:y,deleteOtherBranches:b,undo:w,redo:_,canUndo:S,canRedo:k}=tq(),T=x.useMemo(()=>{var e;return(null==t?void 0:t.data.B)?-1:(null==t?void 0:t.data.W)?1:(null==t||null==(e=t.data.PL)?void 0:e[0])?"W"===t.data.PL[0]?-1:1:n.handicap&&n.handicap>=2?i%2==0?-1:1:i%2==0?1:-1},[t,n.handicap,i]),C=[{label:e("editToolbar.stones"),actions:[{id:"toggle-mode",icon:(0,v.jsx)("div",{style:{fontSize:"9px",fontWeight:"bold",lineHeight:"1"},children:l?"B":"AB"}),label:e(l?"editToolbar.playMode":"editToolbar.setupMode"),disabled:!1}],tools:[{id:"alternate",icon:(0,v.jsx)(oN,{size:18}),label:e("editToolbar.alternate"),isToggle:!0},{id:"black",icon:(0,v.jsx)("div",{className:"stone-icon black-stone"}),label:e("editToolbar.black"),isToggle:!0},{id:"white",icon:(0,v.jsx)("div",{className:"stone-icon white-stone"}),label:e("editToolbar.white"),isToggle:!0}],extraActions:[{id:"pass",icon:(0,v.jsx)("div",{style:{fontSize:"11px",fontWeight:"bold"},children:e("editToolbar.pass")}),label:e("editToolbar.pass"),disabled:!1},{id:"clear-setup",icon:(0,v.jsx)(oV,{size:18}),label:e("editToolbar.clearSetupStones"),disabled:!1}]},{label:e("editToolbar.markers"),tools:[{id:"triangle",icon:(0,v.jsx)(oH,{size:18}),label:e("editToolbar.triangle"),isToggle:!0},{id:"square",icon:(0,v.jsx)(oF,{size:18}),label:e("editToolbar.square"),isToggle:!0},{id:"circle",icon:(0,v.jsx)(a2,{size:18}),label:e("editToolbar.circle"),isToggle:!0},{id:"cross",icon:(0,v.jsx)(oY,{size:18}),label:e("editToolbar.cross"),isToggle:!0},{id:"label-alpha",icon:(0,v.jsx)(oW,{size:18}),label:e("editToolbar.labelAlpha"),isToggle:!0},{id:"label-num",icon:(0,v.jsx)(op,{size:18}),label:e("editToolbar.labelNum"),isToggle:!0},{id:"erase-marker",icon:(0,v.jsx)(a7,{size:18}),label:e("editToolbar.eraseMarker"),isToggle:!0}],extraActions:[{id:"erase-all",icon:(0,v.jsx)(oV,{size:18}),label:e("editToolbar.eraseAll"),disabled:!1}]},{label:e("editToolbar.branch"),actions:[{id:"make-main",icon:(0,v.jsx)(aG,{size:18}),label:e("editToolbar.makeMainBranch"),disabled:!1},{id:"copy",icon:(0,v.jsx)(a4,{size:18}),label:e("editToolbar.copy"),disabled:!1},{id:"paste",icon:(0,v.jsx)(a3,{size:18}),label:e("editToolbar.paste"),disabled:!c},{id:"delete",icon:(0,v.jsx)(oU,{size:18}),label:e("editToolbar.deleteCurrentBranch"),disabled:!1},{id:"delete-others",icon:(0,v.jsx)(oM,{size:18}),label:e("editToolbar.deleteOtherBranches"),disabled:!1}]},{label:e("editToolbar.history"),actions:[{id:"undo",icon:(0,v.jsx)(oq,{size:18}),label:e("editToolbar.undo"),disabled:!S},{id:"redo",icon:(0,v.jsx)(oA,{size:18}),label:e("editToolbar.redo"),disabled:!k}]}],E=e=>{switch(e){case"toggle-mode":u(!l);break;case"pass":a([-1,-1],T);break;case"clear-setup":m();break;case"erase-all":g();break;case"make-main":y();break;case"copy":d();break;case"paste":p();break;case"delete":h();break;case"delete-others":b();break;case"undo":w();break;case"redo":_()}};return(0,v.jsx)("div",{className:"edit-toolbar edit-toolbar-section",children:C.map((e,t)=>{var n,i,a;return(0,v.jsxs)("div",{className:"edit-toolbar-group",children:[(0,v.jsx)("div",{className:"edit-toolbar-group-label",children:e.label}),(0,v.jsxs)("div",{className:"edit-toolbar-buttons",children:[null==(n=e.actions)?void 0:n.map(e=>(0,v.jsx)("button",{className:`edit-toolbar-button ${e.disabled?"disabled":""}`,onClick:()=>!e.disabled&&E(e.id),title:e.label,disabled:e.disabled,children:e.icon},e.id)),null==(i=e.tools)?void 0:i.map(e=>{let t="isToggle"in e&&e.isToggle&&o===e.id;return(0,v.jsx)("button",{className:`edit-toolbar-button ${t?"active":""}`,onClick:()=>s(e.id),title:e.label,children:e.icon},e.id)}),null==(a=e.extraActions)?void 0:a.map(e=>(0,v.jsx)("button",{className:`edit-toolbar-button ${e.disabled?"disabled":""}`,onClick:()=>!e.disabled&&E(e.id),title:e.label,disabled:e.disabled,children:e.icon},e.id))]}),t<C.length-1&&(0,v.jsx)("div",{className:"edit-toolbar-divider"})]},e.label)})})};function l5(e,t){if(!e||"string"!=typeof e)return null;let n=e.trim().toUpperCase();if("PASS"===n)return null;let i="ABCDEFGHJKLMNOPQRST";if(n.length<2)return null;let a=n[0],o=n.slice(1),s=i.indexOf(a);if(-1===s)return null;let l=parseInt(o,10);if(isNaN(l)||l<1||l>t)return null;let u=t-l;return s<0||s>=t||u<0||u>=t?null:[s,u]}let l8=e=>{let{isOpen:t,onClose:n}=e,{t:i}=rK();if(!t)return null;let a=[{color:"#17dea3",labelKey:"analysisLegend.best",probKey:"analysisLegend.bestProb"},{color:"#4998fe",labelKey:"analysisLegend.great",probKey:"analysisLegend.greatProb"},{color:"#6ed543",labelKey:"analysisLegend.good",probKey:"analysisLegend.goodProb"},{color:"#f1ad24",labelKey:"analysisLegend.okay",probKey:"analysisLegend.okayProb"},{color:"#fa412d",labelKey:"analysisLegend.poor",probKey:"analysisLegend.poorProb"}];return(0,lI.createPortal)((0,v.jsx)("div",{className:"move-strength-info-overlay",onClick:n,children:(0,v.jsxs)("div",{className:"move-strength-info-modal",onClick:e=>e.stopPropagation(),children:[(0,v.jsxs)("div",{className:"move-strength-info-header",children:[(0,v.jsx)("h3",{children:i("analysisLegend.title")}),(0,v.jsx)("button",{className:"move-strength-info-close",onClick:n,children:(0,v.jsx)(oY,{size:18})})]}),(0,v.jsxs)("div",{className:"move-strength-info-content",children:[(0,v.jsx)("p",{className:"move-strength-info-description",dangerouslySetInnerHTML:{__html:i("analysisLegend.policyDescription")}}),(0,v.jsx)("div",{className:"move-strength-legend",children:a.map(e=>(0,v.jsxs)("div",{className:"move-strength-item",children:[(0,v.jsx)("div",{className:"move-strength-swatch",style:{background:e.color}}),(0,v.jsxs)("div",{className:"move-strength-text",children:[(0,v.jsx)("strong",{children:i(e.labelKey)}),(0,v.jsx)("span",{children:i(e.probKey)})]})]},e.labelKey))}),(0,v.jsx)("div",{className:"move-strength-info-note",children:i("analysisLegend.note")}),(0,v.jsxs)("div",{className:"heatmap-legend",children:[(0,v.jsx)("h4",{children:i("analysisLegend.heatmapOwnership")}),(0,v.jsx)("p",{children:i("analysisLegend.heatmapDescription")}),(0,v.jsxs)("div",{className:"heatmap-legend-items",children:[(0,v.jsxs)("div",{className:"heatmap-legend-item",children:[(0,v.jsx)("div",{className:"heatmap-swatch black-area"}),(0,v.jsx)("span",{children:i("analysisLegend.blackArea")})]}),(0,v.jsxs)("div",{className:"heatmap-legend-item",children:[(0,v.jsx)("div",{className:"heatmap-swatch white-area"}),(0,v.jsx)("span",{children:i("analysisLegend.whiteArea")})]})]})]})]})]})}),document.body)},l7=(0,x.memo)(e=>{var t;let{onScoreData:n}=e,{t:i}=rK(),{currentBoard:a,currentNode:o,nextMoveNode:s,markerMap:l,gameInfo:u,moveNumber:c,gameId:d,gameSettings:p}=tH(),{playMove:h,resign:f,placeStoneDirect:g,removeSetupStone:m}=tW(),{scoringMode:y,deadStones:b,toggleDeadStones:w,toggleScoringMode:_,territoryMap:S}=tK(),{analysisMode:k,toggleAnalysisMode:T,showAnalysisBar:C,toggleShowAnalysisBar:E}=tX(),[I,$]=(0,x.useState)(!1),{editMode:O,toggleEditMode:A,editTool:N,editPlayMode:P,addMarker:D,removeMarker:z}=tq(),{goBack:j,goForward:R,canGoBack:L,canGoForward:F}=tG(),{navigationMode:B,cursorX:U,cursorY:V,toggleNavigationMode:G,setActionHandler:H}=ng(),[W,q]=(0,x.useState)(28),K=(0,x.useRef)(null),{soundEnabled:X,toggleSound:Z,playSound:Y}=sE(),Q=o3(),J="mobile"===o2(),ee=l2(j,R,Q&&!y&&!O),[et,en]=(0,x.useState)(!1),[er,ei]=(0,x.useState)(!1),[ea,eo]=(0,x.useState)(!1),[es,el]=(0,x.useState)(!1),{isModelLoaded:eu}=tQ(),{engine:ec,isEngineReady:ed,isInitializing:ep,initializeEngine:eh}=t9(),{showToast:ef}=lb(),eg=(0,x.useMemo)(()=>{var e,t;if(!et||!s)return null;let n=(null==(e=s.data.B)?void 0:e[0])||(null==(t=s.data.W)?void 0:t[0]);return n?M(n):null},[et,s]),em=(0,x.useMemo)(()=>{if(s)return s.data.B?1:-1},[s]),{heatMap:ey,ownershipMap:ev,showOwnership:ex,toggleOwnership:e_,showTopMoves:eS,toggleTopMoves:ek,isInitializing:eT,isAnalyzing:eC,error:eE,analysisResult:eI,analyzeFullGame:e$,stopFullGameAnalysis:eO,isFullGameAnalyzing:eA,isStopping:eN,fullGameProgress:eP,fullGameCurrentMove:eD,fullGameTotalMoves:eM,fullGameETA:ez,allAnalyzedMessage:ej,analysisCacheSize:eR,clearAnalysisCache:eL,pendingFullGameAnalysis:eF,nativeUploadProgress:eB,backendFallbackMessage:eU}=na(),eV=(0,x.useCallback)(e=>null==e?"":`${(100*e).toFixed(1)}%`,[]),eG=(0,x.useCallback)(e=>null==e?"":e.toFixed(1),[]),[eH,eW]=(0,x.useState)(-1),[eq,eK]=(0,x.useState)(!1),eX=(0,x.useRef)(new Set),eZ=(0,x.useRef)(!1),eY=a.signMap.length,eQ=(null==(t=a.signMap[0])?void 0:t.length)??eY;(0,x.useMemo)(()=>a.signMap,[a]);let eJ=p.fuzzyStonePlacement,{shiftMap:e0,randomMap:e1}=l0({enabled:eJ,width:eQ,height:eY,gameId:d}),e2=(0,x.useMemo)(()=>{var e;return(null==o?void 0:o.data.B)?-1:(null==o?void 0:o.data.W)?1:(null==o||null==(e=o.data.PL)?void 0:e[0])?"W"===o.data.PL[0]?-1:1:u.handicap&&u.handicap>=2?c%2==0?-1:1:c%2==0?1:-1},[o,u.handicap,c]),e3=(0,x.useMemo)(()=>!y&&(!O||"black"===N||"white"===N||"alternate"===N),[y,O,N]),e4=(0,x.useCallback)(()=>{A()},[A]),e6=(0,x.useMemo)(()=>{if(e3)return O?"black"===N?1:"white"===N?-1:"alternate"===N?-1===eH?1:-1:void 0:e2},[e3,O,N,e2,eH]),e5=(0,x.useMemo)(()=>{if(y)return{type:"none"};if(!O)return null;switch(N){case"triangle":return{type:"triangle"};case"square":return{type:"square"};case"circle":return{type:"circle"};case"cross":return{type:"cross"};case"label-alpha":return{type:"label",label:"A"};case"label-num":return{type:"label",label:"1"};default:return null}},[O,N,y]),e8=(0,x.useCallback)((e,t)=>{var n;let[i,a]=e,o=null==l||null==(n=l[a])?void 0:n[i];("triangle"===t||"square"===t||"circle"===t||"cross"===t)&&(null==o?void 0:o.type)===t?z(e):D(e,t)},[l,D,z]);(0,x.useEffect)(()=>{if(B){let e=()=>{var e;let t=[U,V],[n,i]=t;if(O){switch(N){case"black":P?h(t,1):g(t,1),Y("move");break;case"white":P?h(t,-1):g(t,-1),Y("move");break;case"alternate":{let e=-1===eH?1:-1;P?h(t,e):g(t,e),eW(e),Y("move");break}case"triangle":case"square":case"circle":case"cross":e8(t,N);break;case"label-alpha":case"label-num":D(t,N);break;case"erase-marker":z(t)}return}if((null==(e=a.signMap[i])?void 0:e[n])===0)try{let e=a.analyzeMove(e2,t);if(!e.valid)return;e.capturing?Y("capture"):Y("move"),h(t,e2)}catch(e){console.error("Invalid move:",e)}};H(()=>e)}else H(()=>null)},[B,U,V,a,e2,h,Y,H,O,N,P,eH,g,D,z,eW,e8]);let e7=x.useMemo(()=>{if(!o)return null;if(o.data.B&&o.data.B[0]){let e=o.data.B[0];if(2===e.length)return[e.charCodeAt(0)-97,e.charCodeAt(1)-97]}if(o.data.W&&o.data.W[0]){let e=o.data.W[0];if(2===e.length)return[e.charCodeAt(0)-97,e.charCodeAt(1)-97]}return null},[o]);(0,x.useEffect)(()=>{if(!K.current)return;let e=(e,t)=>Math.max(Math.min(Math.floor(e/Math.max(eQ+2,1)),Math.floor(t/Math.max(eY+2,1))),10),{width:t,height:n}=K.current.getBoundingClientRect();q(e(t,n));let i=new ResizeObserver(t=>{for(let n of t){let{width:t,height:i}=n.contentRect,a=e(t,i);q(e=>e===a?e:a)}});return i.observe(K.current),()=>{i.disconnect()}},[eQ,eY]);let e9=(0,x.useCallback)((e,t)=>{var n,i;if(y){let[e,n]=t;if(0!==(null==(i=a.signMap[n])?void 0:i[e])){let i=a.getChain(t),o=`${e},${n}`,s=b.has(o),l=i.filter(e=>{let[t,n]=e,i=`${t},${n}`;return s?b.has(i):!b.has(i)});l.length>0&&w(l)}return}if(O){let[e,n]=t;switch(N){case"black":P?h(t,1):g(t,1),Y("move");break;case"white":P?h(t,-1):g(t,-1),Y("move");break;case"alternate":{let e=-1===eH?1:-1;P?h(t,e):g(t,e),eW(e),Y("move");break}case"triangle":case"square":case"circle":case"cross":eZ.current||e8(t,N),eZ.current=!1;break;case"label-alpha":case"label-num":D(t,N);break;case"erase-marker":eZ.current||z(t),eZ.current=!1}return}let[o,s]=t;if((null==(n=a.signMap[s])?void 0:n[o])===0)try{let e=a.analyzeMove(e2,t);if(!e.valid)return;e.capturing?Y("capture"):Y("move"),h(t,e2)}catch(e){console.error("Invalid move:",e)}},[a,e2,h,Y,y,b,O,N,P,g,D,z,eH,eW,e8]),te=(0,x.useCallback)(()=>{h([-1,-1],e2)},[h,e2]),tt=(0,x.useCallback)(()=>{ei(!0)},[]),tn=(0,x.useCallback)(()=>{f(e2),ei(!1)},[e2,f]),tr=(0,x.useCallback)(()=>{ei(!1)},[]),ti=(0,x.useCallback)(async()=>{if(ec&&eu){eo(!0),el(!1);try{let e=a.signMap,t=1===e2?"B":"W",n=await ec.generateMove(e,{komi:u.komi??7.5,nextToPlay:t}),i=l5(n,a.width);null===i?h([-1,-1],e2):h(i,e2),Y("move")}catch(e){console.error("Failed to generate AI move:",e),ef(i("gameboardActions.failedToGenerateMove"),"error")}finally{eo(!1)}}},[ec,eu,a,e2,u.komi,h,Y,ef,i]),ta=(0,x.useCallback)(async()=>{eu?ed&&ec?await ti():(el(!0),eo(!0),eh(),ef(i("gameboardActions.initializingAiEngine"),"info")):ef(i("gameboardActions.loadAiModelFirst"),"error")},[eu,ed,ec,ti,ef,i,eh]);(0,x.useEffect)(()=>{es&&ed&&ec&&eu&&ti()},[es,ed,ec,eu,ti]);let to=(0,x.useMemo)(()=>{if(!y)return null;let{blackTerritory:e,whiteTerritory:t}=eb(a.signMap,b),{blackDeadStones:n,whiteDeadStones:i}=ew(a.signMap,b),o=a.getCaptures(1);return{blackTerritory:e,whiteTerritory:t,blackCaptures:o,whiteCaptures:a.getCaptures(-1),blackDeadStones:n,whiteDeadStones:i,komi:u.komi||6.5}},[y,a.signMap,a,b,u.komi]),ts=(0,x.useMemo)(()=>{if(!y)return[];let e=[];return b.forEach(t=>{let[n,i]=t.split(",").map(Number);e.push([n,i])}),e},[y,b]);(0,x.useEffect)(()=>{null==n||n(to)},[to,n]),(0,x.useEffect)(()=>{let e=e=>{if(!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)&&!e.target.isContentEditable&&!e.ctrlKey&&!e.altKey&&!e.metaKey)switch(e.key.toLowerCase()){case"e":e4();break;case"n":G();break;case"s":e.shiftKey||_();break;case"a":E();break;case"g":!eu||y||O||ea||ta()}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[e4,G,_,E,a.signMap.length,eu,y,O,ea,ta]);let tl=(0,x.useCallback)(e=>"triangle"===e||"square"===e||"circle"===e||"cross"===e||"erase-marker"===e,[]),tu=(0,x.useCallback)((e,t)=>{if(0!==e.button||!O||!tl(N))return;eZ.current=!0,eK(!0),eX.current.clear();let n=`${t[0]},${t[1]}`;eX.current.add(n),"erase-marker"===N?z(t):e8(t,N)},[O,N,tl,e8,z]),tc=(0,x.useCallback)((e,t)=>{if(!eq||!O||!tl(N))return;let n=`${t[0]},${t[1]}`;eX.current.has(n)||(eX.current.add(n),"erase-marker"===N?z(t):e8(t,N))},[eq,O,N,tl,e8,z]);(0,x.useEffect)(()=>{let e=()=>{eq&&(eK(!1),eX.current.clear())};return window.addEventListener("mouseup",e),()=>{window.removeEventListener("mouseup",e)}},[eq]);let td=(0,x.useCallback)((e,t)=>{var n,i;e.preventDefault();let[o,s]=t,u=null==l||null==(n=l[s])?void 0:n[o],c=(null==(i=a.signMap[s])?void 0:i[o])!==0;O?u&&"setup"!==u.type?z(t):((null==u?void 0:u.type)==="setup"||c)&&m(t):u&&"cross"===u.type?z(t):D(t,"cross")},[O,a.signMap,m,z,D,l]);return(0,v.jsxs)("div",{className:"gameboard-container",children:[(0,v.jsxs)("div",{className:"gameboard-actions-bar",children:[(0,v.jsxs)("button",{onClick:te,className:"gameboard-action-button gameboard-pass-button",title:i("gameboardActions.pass"),disabled:y||O,children:[(0,v.jsx)(oR,{size:16}),(0,v.jsx)("span",{className:"btn-text",children:i("gameboardActions.pass")})]}),(0,v.jsxs)("button",{onClick:tt,className:"gameboard-action-button gameboard-resign-button",title:i("gameboardActions.resign"),disabled:y||O,children:[(0,v.jsx)(oi,{size:16}),(0,v.jsx)("span",{className:"btn-text",children:i("gameboardActions.resign")})]}),(0,v.jsx)("div",{className:"gameboard-actions-spacer"}),(0,v.jsxs)("button",{onClick:_,className:`gameboard-action-button gameboard-score-button ${y?"active":""}`,title:y?i("gameboardActions.exitScoringMode"):i("gameboardActions.enterScoringMode"),children:[(0,v.jsx)(aX,{size:16}),(0,v.jsx)("span",{className:"btn-text",children:y?i("gameboardActions.scoring"):i("gameboardActions.score")})]}),(0,v.jsxs)("button",{onClick:E,className:`gameboard-action-button gameboard-analysis-button ${C?"active":""}`,title:C?i("gameboardActions.hideAnalysis"):i("gameboardActions.showAnalysis"),children:[(0,v.jsx)(aq,{size:16}),(0,v.jsx)("span",{className:"btn-text",children:C?i("gameboardActions.analysis"):i("gameboardActions.analyze")})]}),(0,v.jsxs)("button",{onClick:G,className:`gameboard-action-button gameboard-navigation-button ${B?"active":""}`,title:B?i("gameboardActions.exitNavigationMode"):i("gameboardActions.enterNavigationMode"),children:[(0,v.jsx)(ol,{size:16}),(0,v.jsx)("span",{className:"btn-text",children:i("gameboardActions.navigate")})]}),(0,v.jsxs)("button",{onClick:e4,className:`gameboard-action-button gameboard-edit-button ${O?"active":""}`,title:O?i("gameboardActions.exitEditMode"):i("gameboardActions.enterEditMode"),children:[(0,v.jsx)(oI,{size:16}),(0,v.jsx)("span",{className:"btn-text",children:i("gameboardActions.edit")})]}),(0,v.jsxs)("button",{onClick:()=>en(!et),className:`gameboard-action-button gameboard-next-move-button ${et?"active":""}`,title:et?i("gameboardActions.hideNextMove"):i("gameboardActions.showNextMove"),children:[et?(0,v.jsx)(oe,{size:16}):(0,v.jsx)(ot,{size:16}),(0,v.jsx)("span",{className:"btn-text",children:et?i("gameboardActions.hide"):i("gameboardActions.show")})]}),eu&&(0,v.jsxs)("button",{onClick:ta,disabled:ea||y||O,className:"gameboard-action-button gameboard-suggest-move-button",title:i("gameboardActions.suggestMoveTitle"),children:[ea?(0,v.jsx)(ob,{size:16,className:"spinner"}):(0,v.jsx)(aW,{size:16}),(0,v.jsx)("span",{className:"btn-text",children:ea?i("gameboardActions.suggesting"):i("gameboardActions.suggestMove")})]})]}),(C||eA)&&(0,v.jsx)("div",{className:"ai-analysis-summary",children:eE?(0,v.jsxs)("div",{className:"ai-analysis-summary__error",children:[(0,v.jsx)("span",{children:""})," ",eE]}):(0,v.jsxs)("div",{className:"ai-analysis-summary__container",style:{width:"100%",display:"flex",flexDirection:"column"},children:[(0,v.jsxs)("div",{className:"ai-analysis-summary__content",children:[(0,v.jsxs)("div",{className:"ai-analysis-summary__metrics-group",children:[(0,v.jsxs)("div",{className:"ai-analysis-summary__loading-indicator",style:{visibility:eT||eC?"visible":"hidden"},children:[(0,v.jsx)("span",{className:"ai-analysis-summary__spinner",children:""}),(0,v.jsx)("span",{className:"ai-analysis-summary__loading-text",children:eT?eB?"uploading"===eB.stage?i("analysisBar.uploadingModel",{progress:eB.progress}):"checking-cache"===eB.stage?i("analysisBar.checkingCache"):i("analysisBar.initializing"):i("analysisBar.loading"):i("analysisBar.analyzing")})]}),(0,v.jsxs)("div",{className:"ai-analysis-summary__metric",style:{minWidth:"90px"},children:[(0,v.jsx)("span",{className:"ai-analysis-summary__metric-value",children:eV(null==eI?void 0:eI.winRate)}),(0,v.jsx)("span",{className:"ai-analysis-summary__metric-label",children:i("analysisBar.blackWinRate")})]}),(0,v.jsx)("div",{className:"ai-analysis-summary__separator"}),(0,v.jsxs)("div",{className:"ai-analysis-summary__metric",style:{minWidth:"70px"},children:[(0,v.jsx)("span",{className:"ai-analysis-summary__metric-value",children:eI?(0,v.jsxs)(v.Fragment,{children:[eI.scoreLead>=0?"B+":"W+",eG(Math.abs(eI.scoreLead))]}):""}),(0,v.jsx)("span",{className:"ai-analysis-summary__metric-label",children:i("analysisBar.scoreLead")})]})]}),(0,v.jsxs)("div",{className:"ai-analysis-summary__actions",children:[(0,v.jsx)("button",{className:`gameboard-action-button gameboard-heatmap-button ${ex?"active":""}`,title:i("analysis.toggleOwnership"),onClick:e_,disabled:eT,children:(0,v.jsx)(ox,{})}),(0,v.jsx)("button",{className:`gameboard-action-button gameboard-topmoves-button ${eS?"active":""}`,title:i("analysis.toggleTopMoves"),onClick:ek,disabled:eT,children:(0,v.jsx)(of,{})}),(0,v.jsx)("button",{className:`gameboard-action-button ${eA?"active analyzing":""}`,title:eA?i("analysis.stopAnalysis"):eF?i("analysis.waitingForEngine"):i("analysisBar.analyzeFullGameLong"),onClick:eA?eO:e$,disabled:eT||eN||eF,children:eA?(0,v.jsx)(oF,{}):(0,v.jsx)(oQ,{})}),(0,v.jsx)("button",{className:"gameboard-action-button gameboard-clear-cache-button",title:eR>0?i("analysis.clearCacheWithCount",{count:eR}):i("analysis.noCachedAnalysis"),onClick:eL,disabled:0===eR||eA,children:(0,v.jsx)(oU,{})}),(0,v.jsx)("button",{className:"gameboard-action-button",title:i("analysis.analysisLegend"),onClick:()=>$(!0),children:(0,v.jsx)(oh,{})})]})]}),(0,v.jsxs)("div",{className:"ai-analysis-summary__progress-row",children:[(0,v.jsx)("span",{className:`ai-analysis-summary__progress ${ej?"ai-analysis-summary__progress--success":""}`,style:{opacity:eA||ej?1:0,display:eA||ej?"block":"none"},children:eN?i("analysis.stopping"):ej?` ${ej}`:eA?`${eD}/${eM} (${eP}%)${ez?`  ETA: ${ez}`:""}`:""}),eU&&(0,v.jsxs)("span",{className:"ai-analysis-summary__progress ai-analysis-summary__progress--warning",style:{display:"block",opacity:1},children:[" ",eU]})]})]})}),(0,v.jsxs)("div",{className:"gameboard-board-area",children:[(0,v.jsx)("div",{ref:K,className:"gameboard-board-wrapper",...ee,children:(0,v.jsx)(lQ,{gameId:d,vertexSize:W,signMap:a.signMap,showCoordinates:!0,fuzzyStonePlacement:eJ,shiftMap:e0,randomMap:e1,lastMove:e7,nextMove:eg,nextMovePlayer:em,currentPlayer:e6,onVertexClick:e9,onVertexMouseDown:tu,onVertexMouseMove:tc,dimmedVertices:ts,paintMap:S,markerMap:l??void 0,cursorPosition:B?[U,V]:null,ghostMarker:e5,heatMap:ey??void 0,ownershipMap:ev??void 0,onVertexRightClick:td},d)}),O&&(0,v.jsx)(l6,{})]}),(0,v.jsx)(l3,{}),J&&y&&to&&(0,v.jsx)("div",{style:{padding:"0.5rem",width:"100%"},children:(0,v.jsx)(l4,{scoreData:to,deadStones:b,playerBlack:u.playerBlack,playerWhite:u.playerWhite,rankBlack:u.rankBlack,rankWhite:u.rankWhite})}),(0,v.jsx)(l8,{isOpen:I,onClose:()=>$(!1)}),(0,v.jsx)(lf,{isOpen:er,title:i("boardControls.resignGame"),message:i("boardControls.resignConfirm",{player:1===e2?i("gameInfo.black"):i("gameInfo.white")}),confirmLabel:i("boardControls.resign"),cancelLabel:i("cancel"),onConfirm:tn,onCancel:tr})]})});function l9(e){if("string"==typeof e||"number"==typeof e)return""+e;let t="";if(Array.isArray(e))for(let n=0,i;n<e.length;n++)""!==(i=l9(e[n]))&&(t+=(t&&" ")+i);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var ue=__webpack_require__(121);let ut=e=>{let t,n=new Set,i=(e,i)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=i?i:"object"!=typeof a||null===a)?a:Object.assign({},t,a),n.forEach(n=>n(t,e))}},a=()=>t,o={setState:i,getState:a,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{n.clear()}},s=t=e(i,a,o);return o},un=e=>e?ut(e):ut,{useDebugValue:ur}=x,{useSyncExternalStoreWithSelector:ui}=ue,ua=e=>e;function uo(e,t=ua,n){let i=ui(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return ur(i),i}let us=(e,t)=>{let n=un(e),i=(e,i=t)=>uo(n,e,i);return Object.assign(i,n),i},ul=(e,t)=>e?us(e,t):us;function uu(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[n,i]of e)if(!Object.is(i,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}let n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let i of n)if(!Object.prototype.hasOwnProperty.call(t,i)||!Object.is(e[i],t[i]))return!1;return!0}var uc={value:()=>{}};function ud(){for(var e,t=0,n=arguments.length,i={};t<n;++t){if(!(e=arguments[t]+"")||e in i||/[\s.]/.test(e))throw Error("illegal type: "+e);i[e]=[]}return new up(i)}function up(e){this._=e}function uh(e,t){return e.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");if(i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),e&&!t.hasOwnProperty(e))throw Error("unknown type: "+e);return{type:e,name:n}})}function uf(e,t){for(var n,i=0,a=e.length;i<a;++i)if((n=e[i]).name===t)return n.value}function ug(e,t,n){for(var i=0,a=e.length;i<a;++i)if(e[i].name===t){e[i]=uc,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=n&&e.push({name:t,value:n}),e}up.prototype=ud.prototype={constructor:up,on:function(e,t){var n,i=this._,a=uh(e+"",i),o=-1,s=a.length;if(arguments.length<2){for(;++o<s;)if((n=(e=a[o]).type)&&(n=uf(i[n],e.name)))return n;return}if(null!=t&&"function"!=typeof t)throw Error("invalid callback: "+t);for(;++o<s;)if(n=(e=a[o]).type)i[n]=ug(i[n],e.name,t);else if(null==t)for(n in i)i[n]=ug(i[n],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new up(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,i,a=Array(n),o=0;o<n;++o)a[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw Error("unknown type: "+e);for(i=this._[e],o=0,n=i.length;o<n;++o)i[o].value.apply(t,a)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw Error("unknown type: "+e);for(var i=this._[e],a=0,o=i.length;a<o;++a)i[a].value.apply(t,n)}};let um=ud;function uy(){}function ub(e){return null==e?uy:function(){return this.querySelector(e)}}function uv(e){"function"!=typeof e&&(e=ub(e));for(var t=this._groups,n=t.length,i=Array(n),a=0;a<n;++a)for(var o,s,l=t[a],u=l.length,c=i[a]=Array(u),d=0;d<u;++d)(o=l[d])&&(s=e.call(o,o.__data__,d,l))&&("__data__"in o&&(s.__data__=o.__data__),c[d]=s);return new cG(i,this._parents)}function ux(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}function uw(){return[]}function u_(e){return null==e?uw:function(){return this.querySelectorAll(e)}}function uS(e){return function(){return ux(e.apply(this,arguments))}}function uk(e){e="function"==typeof e?uS(e):u_(e);for(var t=this._groups,n=t.length,i=[],a=[],o=0;o<n;++o)for(var s,l=t[o],u=l.length,c=0;c<u;++c)(s=l[c])&&(i.push(e.call(s,s.__data__,c,l)),a.push(s));return new cG(i,a)}function uT(e){return function(){return this.matches(e)}}function uC(e){return function(t){return t.matches(e)}}var uE=Array.prototype.find;function uI(e){return function(){return uE.call(this.children,e)}}function u$(){return this.firstElementChild}function uO(e){return this.select(null==e?u$:uI("function"==typeof e?e:uC(e)))}var uA=Array.prototype.filter;function uN(){return Array.from(this.children)}function uP(e){return function(){return uA.call(this.children,e)}}function uD(e){return this.selectAll(null==e?uN:uP("function"==typeof e?e:uC(e)))}function uM(e){"function"!=typeof e&&(e=uT(e));for(var t=this._groups,n=t.length,i=Array(n),a=0;a<n;++a)for(var o,s=t[a],l=s.length,u=i[a]=[],c=0;c<l;++c)(o=s[c])&&e.call(o,o.__data__,c,s)&&u.push(o);return new cG(i,this._parents)}function uz(e){return Array(e.length)}function uj(){return new cG(this._enter||this._groups.map(uz),this._parents)}function uR(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function uL(e){return function(){return e}}function uF(e,t,n,i,a,o){for(var s,l=0,u=t.length,c=o.length;l<c;++l)(s=t[l])?(s.__data__=o[l],i[l]=s):n[l]=new uR(e,o[l]);for(;l<u;++l)(s=t[l])&&(a[l]=s)}function uB(e,t,n,i,a,o,s){var l,u,c,d=new Map,p=t.length,h=o.length,f=Array(p);for(l=0;l<p;++l)(u=t[l])&&(f[l]=c=s.call(u,u.__data__,l,t)+"",d.has(c)?a[l]=u:d.set(c,u));for(l=0;l<h;++l)c=s.call(e,o[l],l,o)+"",(u=d.get(c))?(i[l]=u,u.__data__=o[l],d.delete(c)):n[l]=new uR(e,o[l]);for(l=0;l<p;++l)(u=t[l])&&d.get(f[l])===u&&(a[l]=u)}function uU(e){return e.__data__}function uV(e,t){if(!arguments.length)return Array.from(this,uU);var n=t?uB:uF,i=this._parents,a=this._groups;"function"!=typeof e&&(e=uL(e));for(var o=a.length,s=Array(o),l=Array(o),u=Array(o),c=0;c<o;++c){var d=i[c],p=a[c],h=p.length,f=uG(e.call(d,d&&d.__data__,c,i)),g=f.length,m=l[c]=Array(g),y=s[c]=Array(g);n(d,p,m,y,u[c]=Array(h),f,t);for(var b,v,x=0,w=0;x<g;++x)if(b=m[x]){for(x>=w&&(w=x+1);!(v=y[w])&&++w<g;);b._next=v||null}}return(s=new cG(s,i))._enter=l,s._exit=u,s}function uG(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function uH(){return new cG(this._exit||this._groups.map(uz),this._parents)}function uW(e,t,n){var i=this.enter(),a=this,o=this.exit();return"function"==typeof e?(i=e(i))&&(i=i.selection()):i=i.append(e+""),null!=t&&(a=t(a))&&(a=a.selection()),null==n?o.remove():n(o),i&&a?i.merge(a).order():a}function uq(e){for(var t=e.selection?e.selection():e,n=this._groups,i=t._groups,a=n.length,o=i.length,s=Math.min(a,o),l=Array(a),u=0;u<s;++u)for(var c,d=n[u],p=i[u],h=d.length,f=l[u]=Array(h),g=0;g<h;++g)(c=d[g]||p[g])&&(f[g]=c);for(;u<a;++u)l[u]=n[u];return new cG(l,this._parents)}function uK(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var i,a=e[t],o=a.length-1,s=a[o];--o>=0;)(i=a[o])&&(s&&4^i.compareDocumentPosition(s)&&s.parentNode.insertBefore(i,s),s=i);return this}function uX(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=uZ);for(var n=this._groups,i=n.length,a=Array(i),o=0;o<i;++o){for(var s,l=n[o],u=l.length,c=a[o]=Array(u),d=0;d<u;++d)(s=l[d])&&(c[d]=s);c.sort(t)}return new cG(a,this._parents).order()}function uZ(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function uY(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function uQ(){return Array.from(this)}function uJ(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],a=0,o=i.length;a<o;++a){var s=i[a];if(s)return s}return null}function u0(){let e=0;for(let t of this)++e;return e}function u1(){return!this.node()}function u2(e){for(var t=this._groups,n=0,i=t.length;n<i;++n)for(var a,o=t[n],s=0,l=o.length;s<l;++s)(a=o[s])&&e.call(a,a.__data__,s,o);return this}uR.prototype={constructor:uR,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var u3="http://www.w3.org/1999/xhtml";let u4={svg:"http://www.w3.org/2000/svg",xhtml:u3,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function u6(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),u4.hasOwnProperty(t)?{space:u4[t],local:e}:e}function u5(e){return function(){this.removeAttribute(e)}}function u8(e){return function(){this.removeAttributeNS(e.space,e.local)}}function u7(e,t){return function(){this.setAttribute(e,t)}}function u9(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function ce(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function ct(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function cn(e,t){var n=u6(e);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==t?n.local?u8:u5:"function"==typeof t?n.local?ct:ce:n.local?u9:u7)(n,t))}function cr(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ci(e){return function(){this.style.removeProperty(e)}}function ca(e,t,n){return function(){this.style.setProperty(e,t,n)}}function co(e,t,n){return function(){var i=t.apply(this,arguments);null==i?this.style.removeProperty(e):this.style.setProperty(e,i,n)}}function cs(e,t,n){return arguments.length>1?this.each((null==t?ci:"function"==typeof t?co:ca)(e,t,null==n?"":n)):cl(this.node(),e)}function cl(e,t){return e.style.getPropertyValue(t)||cr(e).getComputedStyle(e,null).getPropertyValue(t)}function cu(e){return function(){delete this[e]}}function cc(e,t){return function(){this[e]=t}}function cd(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function cp(e,t){return arguments.length>1?this.each((null==t?cu:"function"==typeof t?cd:cc)(e,t)):this.node()[e]}function ch(e){return e.trim().split(/^|\s+/)}function cf(e){return e.classList||new cg(e)}function cg(e){this._node=e,this._names=ch(e.getAttribute("class")||"")}function cm(e,t){for(var n=cf(e),i=-1,a=t.length;++i<a;)n.add(t[i])}function cy(e,t){for(var n=cf(e),i=-1,a=t.length;++i<a;)n.remove(t[i])}function cb(e){return function(){cm(this,e)}}function cv(e){return function(){cy(this,e)}}function cx(e,t){return function(){(t.apply(this,arguments)?cm:cy)(this,e)}}function cw(){this.textContent=""}function c_(e){return function(){this.textContent=e}}function cS(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function ck(){this.innerHTML=""}function cT(e){return function(){this.innerHTML=e}}function cC(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function cE(){this.nextSibling&&this.parentNode.appendChild(this)}function cI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function c$(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===u3&&t.documentElement.namespaceURI===u3?t.createElement(e):t.createElementNS(n,e)}}function cO(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function cA(e){var t=u6(e);return(t.local?cO:c$)(t)}function cN(){return null}function cP(){var e=this.parentNode;e&&e.removeChild(this)}function cD(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function cM(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function cz(e){return function(t){e.call(this,t,this.__data__)}}function cj(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function cR(e){return function(){var t=this.__on;if(t){for(var n,i=0,a=-1,o=t.length;i<o;++i)(n=t[i],e.type&&n.type!==e.type||n.name!==e.name)?t[++a]=n:this.removeEventListener(n.type,n.listener,n.options);++a?t.length=a:delete this.__on}}}function cL(e,t,n){return function(){var i,a=this.__on,o=cz(t);if(a){for(var s=0,l=a.length;s<l;++s)if((i=a[s]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=t;return}}this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},a?a.push(i):this.__on=[i]}}function cF(e,t,n){var i=cr(e),a=i.CustomEvent;"function"==typeof a?a=new a(t,n):(a=i.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function cB(e,t){return function(){return cF(this,e,t)}}function cU(e,t){return function(){return cF(this,e,t.apply(this,arguments))}}cg.prototype={add:function(e){0>this._names.indexOf(e)&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var cV=[null];function cG(e,t){this._groups=e,this._parents=t}function cH(){return new cG([[document.documentElement]],cV)}cG.prototype=cH.prototype={constructor:cG,select:uv,selectAll:uk,selectChild:uO,selectChildren:uD,filter:uM,data:uV,enter:uj,exit:uH,join:uW,merge:uq,selection:function(){return this},order:uK,sort:uX,call:uY,nodes:uQ,node:uJ,size:u0,empty:u1,each:u2,attr:cn,style:cs,property:cp,classed:function(e,t){var n=ch(e+"");if(arguments.length<2){for(var i=cf(this.node()),a=-1,o=n.length;++a<o;)if(!i.contains(n[a]))return!1;return!0}return this.each(("function"==typeof t?cx:t?cb:cv)(n,t))},text:function(e){return arguments.length?this.each(null==e?cw:("function"==typeof e?cS:c_)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?ck:("function"==typeof e?cC:cT)(e)):this.node().innerHTML},raise:function(){return this.each(cE)},lower:function(){return this.each(cI)},append:function(e){var t="function"==typeof e?e:cA(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:cA(e),i=null==t?cN:"function"==typeof t?t:ub(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(cP)},clone:function(e){return this.select(e?cM:cD)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var i,a,o=cj(e+""),s=o.length;if(arguments.length<2){var l=this.node().__on;if(l){for(var u,c=0,d=l.length;c<d;++c)for(i=0,u=l[c];i<s;++i)if((a=o[i]).type===u.type&&a.name===u.name)return u.value}return}for(i=0,l=t?cL:cR;i<s;++i)this.each(l(o[i],t,n));return this},dispatch:function(e,t){return this.each(("function"==typeof t?cU:cB)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i,a=e[t],o=0,s=a.length;o<s;++o)(i=a[o])&&(yield i)}};let cW=cH;function cq(e){return"string"==typeof e?new cG([[document.querySelector(e)]],[document.documentElement]):new cG([[e]],cV)}let cK={passive:!1},cX={capture:!0,passive:!1};function cZ(e){e.stopImmediatePropagation()}function cY(e){e.preventDefault(),e.stopImmediatePropagation()}function cQ(e){var t=e.document.documentElement,n=cq(e).on("dragstart.drag",cY,cX);"onselectstart"in t?n.on("selectstart.drag",cY,cX):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function cJ(e,t){var n=e.document.documentElement,i=cq(e).on("dragstart.drag",null);t&&(i.on("click.drag",cY,cX),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var c0=1e-12;function c1(e){return((e=Math.exp(e))+1/e)/2}function c2(e){return((e=Math.exp(e))-1/e)/2}function c3(e){return((e=Math.exp(2*e))-1)/(e+1)}let c4=function e(t,n,i){function a(e,a){var o,s,l=e[0],u=e[1],c=e[2],d=a[0],p=a[1],h=a[2],f=d-l,g=p-u,m=f*f+g*g;if(m<c0)s=Math.log(h/c)/t,o=function(e){return[l+e*f,u+e*g,c*Math.exp(t*e*s)]};else{var y=Math.sqrt(m),b=(h*h-c*c+i*m)/(2*c*n*y),v=(h*h-c*c-i*m)/(2*h*n*y),x=Math.log(Math.sqrt(b*b+1)-b);s=(Math.log(Math.sqrt(v*v+1)-v)-x)/t,o=function(e){var i=e*s,a=c1(x),o=c/(n*y)*(a*c3(t*i+x)-c2(x));return[l+o*f,u+o*g,c*a/c1(t*i+x)]}}return o.duration=1e3*s*t/Math.SQRT2,o}return a.rho=function(t){var n=Math.max(.001,+t),i=n*n,a=i*i;return e(n,i,a)},a}(Math.SQRT2,2,4);function c6(e){let t;for(;t=e.sourceEvent;)e=t;return e}function c5(e,t){if(e=c6(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}var c8,c7,c9=0,de=0,dt=0,dn=1e3,dr=0,di=0,da=0,ds="object"==typeof performance&&performance.now?performance:Date,dl="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function du(){return di||(dl(dc),di=ds.now()+da)}function dc(){di=0}function dd(){this._call=this._time=this._next=null}function dp(e,t,n){var i=new dd;return i.restart(e,t,n),i}function dh(){du(),++c9;for(var e,t=c8;t;)(e=di-t._time)>=0&&t._call.call(void 0,e),t=t._next;--c9}function df(){di=(dr=ds.now())+da,c9=de=0;try{dh()}finally{c9=0,dm(),di=0}}function dg(){var e=ds.now(),t=e-dr;t>dn&&(da-=t,dr=e)}function dm(){for(var e,t,n=c8,i=1/0;n;)n._call?(i>n._time&&(i=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:c8=t);c7=e,dy(i)}function dy(e){if(!c9){de&&(de=clearTimeout(de));var t=e-di;t>24?(e<1/0&&(de=setTimeout(df,e-ds.now()-da)),dt&&(dt=clearInterval(dt))):(dt||(dr=ds.now(),dt=setInterval(dg,dn)),c9=1,dl(df))}}function db(e,t,n){var i=new dd;return t=null==t?0:+t,i.restart(n=>{i.stop(),e(n+t)},t,n),i}dd.prototype=dp.prototype={constructor:dd,restart:function(e,t,n){if("function"!=typeof e)throw TypeError("callback is not a function");n=(null==n?du():+n)+(null==t?0:+t),this._next||c7===this||(c7?c7._next=this:c8=this,c7=this),this._call=e,this._time=n,dy()},stop:function(){this._call&&(this._call=null,this._time=1/0,dy())}};var dv=um("start","end","cancel","interrupt"),dx=[],dw=0,d_=1,dS=2,dk=3,dT=4,dC=5,dE=6;function dI(e,t,n,i,a,o){var s=e.__transition;if(s){if(n in s)return}else e.__transition={};dN(e,n,{name:t,index:i,group:a,on:dv,tween:dx,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:dw})}function d$(e,t){var n=dA(e,t);if(n.state>dw)throw Error("too late; already scheduled");return n}function dO(e,t){var n=dA(e,t);if(n.state>dk)throw Error("too late; already running");return n}function dA(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw Error("transition not found");return n}function dN(e,t,n){var i,a=e.__transition;function o(e){n.state=d_,n.timer.restart(s,n.delay,n.time),n.delay<=e&&s(e-n.delay)}function s(o){var c,d,p,h;if(n.state!==d_)return u();for(c in a)if((h=a[c]).name===n.name){if(h.state===dk)return db(s);h.state===dT?(h.state=dE,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete a[c]):+c<t&&(h.state=dE,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete a[c])}if(db(function(){n.state===dk&&(n.state=dT,n.timer.restart(l,n.delay,n.time),l(o))}),n.state=dS,n.on.call("start",e,e.__data__,n.index,n.group),n.state===dS){for(c=0,n.state=dk,i=Array(p=n.tween.length),d=-1;c<p;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=h);i.length=d+1}}function l(t){for(var a=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(u),n.state=dC,1),o=-1,s=i.length;++o<s;)i[o].call(e,a);n.state===dC&&(n.on.call("end",e,e.__data__,n.index,n.group),u())}function u(){for(var i in n.state=dE,n.timer.stop(),delete a[t],a)return;delete e.__transition}a[t]=n,n.timer=dp(o,0,n.time)}function dP(e,t){var n,i,a,o=e.__transition,s=!0;if(o){for(a in t=null==t?null:t+"",o){if((n=o[a]).name!==t){s=!1;continue}i=n.state>dS&&n.state<dC,n.state=dE,n.timer.stop(),n.on.call(i?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[a]}s&&delete e.__transition}}function dD(e){return this.each(function(){dP(this,e)})}function dM(e,t){return e*=1,t*=1,function(n){return e*(1-n)+t*n}}var dz=180/Math.PI,dj={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function dR(e,t,n,i,a,o){var s,l,u;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(u=e*n+t*i)&&(n-=e*u,i-=t*u),(l=Math.sqrt(n*n+i*i))&&(n/=l,i/=l,u/=l),e*i<t*n&&(e=-e,t=-t,u=-u,s=-s),{translateX:a,translateY:o,rotate:Math.atan2(t,e)*dz,skewX:Math.atan(u)*dz,scaleX:s,scaleY:l}}function dL(e){return null==e?dj:(i||(i=document.createElementNS("http://www.w3.org/2000/svg","g")),i.setAttribute("transform",e),e=i.transform.baseVal.consolidate())?dR((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):dj}function dF(e,t,n,i){function a(e){return e.length?e.pop()+" ":""}function o(e,i,a,o,s,l){if(e!==a||i!==o){var u=s.push("translate(",null,t,null,n);l.push({i:u-4,x:dM(e,a)},{i:u-2,x:dM(i,o)})}else(a||o)&&s.push("translate("+a+t+o+n)}function s(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(a(n)+"rotate(",null,i)-2,x:dM(e,t)})):t&&n.push(a(n)+"rotate("+t+i)}function l(e,t,n,o){e!==t?o.push({i:n.push(a(n)+"skewX(",null,i)-2,x:dM(e,t)}):t&&n.push(a(n)+"skewX("+t+i)}function u(e,t,n,i,o,s){if(e!==n||t!==i){var l=o.push(a(o)+"scale(",null,",",null,")");s.push({i:l-4,x:dM(e,n)},{i:l-2,x:dM(t,i)})}else(1!==n||1!==i)&&o.push(a(o)+"scale("+n+","+i+")")}return function(t,n){var i=[],a=[];return t=e(t),n=e(n),o(t.translateX,t.translateY,n.translateX,n.translateY,i,a),s(t.rotate,n.rotate,i,a),l(t.skewX,n.skewX,i,a),u(t.scaleX,t.scaleY,n.scaleX,n.scaleY,i,a),t=n=null,function(e){for(var t,n=-1,o=a.length;++n<o;)i[(t=a[n]).i]=t.x(e);return i.join("")}}}var dB=dF(function(e){let t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?dj:dR(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),dU=dF(dL,", ",")",")");function dV(e,t){var n,i;return function(){var a=dO(this,e),o=a.tween;if(o!==n){i=n=o;for(var s=0,l=i.length;s<l;++s)if(i[s].name===t){(i=i.slice()).splice(s,1);break}}a.tween=i}}function dG(e,t,n){var i,a;if("function"!=typeof n)throw Error();return function(){var o=dO(this,e),s=o.tween;if(s!==i){a=(i=s).slice();for(var l={name:t,value:n},u=0,c=a.length;u<c;++u)if(a[u].name===t){a[u]=l;break}u===c&&a.push(l)}o.tween=a}}function dH(e,t){var n=this._id;if(e+="",arguments.length<2){for(var i,a=dA(this.node(),n).tween,o=0,s=a.length;o<s;++o)if((i=a[o]).name===e)return i.value;return null}return this.each((null==t?dV:dG)(n,e,t))}function dW(e,t,n){var i=e._id;return e.each(function(){var e=dO(this,i);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return dA(e,i).value[t]}}function dq(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function dK(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function dX(){}var dZ=.7,dY=1.4285714285714286,dQ="\\s*([+-]?\\d+)\\s*",dJ="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",d0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",d1=/^#([0-9a-f]{3,8})$/,d2=RegExp(`^rgb\\(${dQ},${dQ},${dQ}\\)$`),d3=RegExp(`^rgb\\(${d0},${d0},${d0}\\)$`),d4=RegExp(`^rgba\\(${dQ},${dQ},${dQ},${dJ}\\)$`),d6=RegExp(`^rgba\\(${d0},${d0},${d0},${dJ}\\)$`),d5=RegExp(`^hsl\\(${dJ},${d0},${d0}\\)$`),d8=RegExp(`^hsla\\(${dJ},${d0},${d0},${dJ}\\)$`),d7={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function d9(){return this.rgb().formatHex()}function pe(){return this.rgb().formatRgb()}function pt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=d1.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?pn(t):3===n?new po(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?pr(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?pr(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=d2.exec(e))?new po(t[1],t[2],t[3],1):(t=d3.exec(e))?new po(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=d4.exec(e))?pr(t[1],t[2],t[3],t[4]):(t=d6.exec(e))?pr(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=d5.exec(e))?ph(t[1],t[2]/100,t[3]/100,1):(t=d8.exec(e))?ph(t[1],t[2]/100,t[3]/100,t[4]):d7.hasOwnProperty(e)?pn(d7[e]):"transparent"===e?new po(NaN,NaN,NaN,0):null}function pn(e){return new po(e>>16&255,e>>8&255,255&e,1)}function pr(e,t,n,i){return i<=0&&(e=t=n=NaN),new po(e,t,n,i)}function pi(e){return(e instanceof dX||(e=pt(e)),e)?new po((e=e.rgb()).r,e.g,e.b,e.opacity):new po}function pa(e,t,n,i){return 1==arguments.length?pi(e):new po(e,t,n,null==i?1:i)}function po(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function ps(){return`#${pp(this.r)}${pp(this.g)}${pp(this.b)}`}function pl(){return`#${pp(this.r)}${pp(this.g)}${pp(this.b)}${pp((isNaN(this.opacity)?1:this.opacity)*255)}`}function pu(){let e=pc(this.opacity);return`${1===e?"rgb(":"rgba("}${pd(this.r)}, ${pd(this.g)}, ${pd(this.b)}${1===e?")":`, ${e})`}`}function pc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function pd(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function pp(e){return((e=pd(e))<16?"0":"")+e.toString(16)}function ph(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new pm(e,t,n,i)}function pf(e){if(e instanceof pm)return new pm(e.h,e.s,e.l,e.opacity);if(e instanceof dX||(e=pt(e)),!e)return new pm;if(e instanceof pm)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,a=Math.min(t,n,i),o=Math.max(t,n,i),s=NaN,l=o-a,u=(o+a)/2;return l?(s=t===o?(n-i)/l+(n<i)*6:n===o?(i-t)/l+2:(t-n)/l+4,l/=u<.5?o+a:2-o-a,s*=60):l=u>0&&u<1?0:s,new pm(s,l,u,e.opacity)}function pg(e,t,n,i){return 1==arguments.length?pf(e):new pm(e,t,n,null==i?1:i)}function pm(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function py(e){return(e=(e||0)%360)<0?e+360:e}function pb(e){return Math.max(0,Math.min(1,e||0))}function pv(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function px(e,t,n,i,a){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*i+s*a)/6}function pw(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[i],o=e[i+1],s=i>0?e[i-1]:2*a-o,l=i<t-1?e[i+2]:2*o-a;return px((n-i/t)*t,s,a,o,l)}}function p_(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),a=e[(i+t-1)%t],o=e[i%t],s=e[(i+1)%t],l=e[(i+2)%t];return px((n-i/t)*t,a,o,s,l)}}dq(dX,pt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:d9,formatHex:d9,formatHex8:function e(){return this.rgb().formatHex8()},formatHsl:function e(){return pf(this).formatHsl()},formatRgb:pe,toString:pe}),dq(po,pa,dK(dX,{brighter(e){return e=null==e?dY:Math.pow(dY,e),new po(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?dZ:Math.pow(dZ,e),new po(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new po(pd(this.r),pd(this.g),pd(this.b),pc(this.opacity))},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ps,formatHex:ps,formatHex8:pl,formatRgb:pu,toString:pu})),dq(pm,pg,dK(dX,{brighter(e){return e=null==e?dY:Math.pow(dY,e),new pm(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?dZ:Math.pow(dZ,e),new pm(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,a=2*n-i;return new po(pv(e>=240?e-240:e+120,a,i),pv(e,a,i),pv(e<120?e+240:e-120,a,i),this.opacity)},clamp(){return new pm(py(this.h),pb(this.s),pb(this.l),pc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=pc(this.opacity);return`${1===e?"hsl(":"hsla("}${py(this.h)}, ${100*pb(this.s)}%, ${100*pb(this.l)}%${1===e?")":`, ${e})`}`}}));let pS=e=>()=>e;function pk(e,t){return function(n){return e+n*t}}function pT(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function pC(e){return 1==(e*=1)?pE:function(t,n){return n-t?pT(t,n,e):pS(isNaN(t)?n:t)}}function pE(e,t){var n=t-e;return n?pk(e,n):pS(isNaN(e)?t:e)}let pI=function e(t){var n=pC(t);function i(e,t){var i=n((e=pa(e)).r,(t=pa(t)).r),a=n(e.g,t.g),o=n(e.b,t.b),s=pE(e.opacity,t.opacity);return function(t){return e.r=i(t),e.g=a(t),e.b=o(t),e.opacity=s(t),e+""}}return i.gamma=e,i}(1);function p$(e){return function(t){var n,i,a=t.length,o=Array(a),s=Array(a),l=Array(a);for(n=0;n<a;++n)i=pa(t[n]),o[n]=i.r||0,s[n]=i.g||0,l[n]=i.b||0;return o=e(o),s=e(s),l=e(l),i.opacity=1,function(e){return i.r=o(e),i.g=s(e),i.b=l(e),i+""}}}p$(pw),p$(p_);var pO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pA=RegExp(pO.source,"g");function pN(e){return function(){return e}}function pP(e){return function(t){return e(t)+""}}function pD(e,t){var n,i,a,o=pO.lastIndex=pA.lastIndex=0,s=-1,l=[],u=[];for(e+="",t+="";(n=pO.exec(e))&&(i=pA.exec(t));)(a=i.index)>o&&(a=t.slice(o,a),l[s]?l[s]+=a:l[++s]=a),(n=n[0])===(i=i[0])?l[s]?l[s]+=i:l[++s]=i:(l[++s]=null,u.push({i:s,x:dM(n,i)})),o=pA.lastIndex;return o<t.length&&(a=t.slice(o),l[s]?l[s]+=a:l[++s]=a),l.length<2?u[0]?pP(u[0].x):pN(t):(t=u.length,function(e){for(var n,i=0;i<t;++i)l[(n=u[i]).i]=n.x(e);return l.join("")})}function pM(e,t){var n;return("number"==typeof t?dM:t instanceof pt?pI:(n=pt(t))?(t=n,pI):pD)(e,t)}function pz(e){return function(){this.removeAttribute(e)}}function pj(e){return function(){this.removeAttributeNS(e.space,e.local)}}function pR(e,t,n){var i,a,o=n+"";return function(){var s=this.getAttribute(e);return s===o?null:s===i?a:a=t(i=s,n)}}function pL(e,t,n){var i,a,o=n+"";return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===i?a:a=t(i=s,n)}}function pF(e,t,n){var i,a,o;return function(){var s,l,u=n(this);return null==u?void this.removeAttribute(e):(s=this.getAttribute(e))===(l=u+"")?null:s===i&&l===a?o:(a=l,o=t(i=s,u))}}function pB(e,t,n){var i,a,o;return function(){var s,l,u=n(this);return null==u?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local))===(l=u+"")?null:s===i&&l===a?o:(a=l,o=t(i=s,u))}}function pU(e,t){var n=u6(e),i="transform"===n?dU:pM;return this.attrTween(e,"function"==typeof t?(n.local?pB:pF)(n,i,dW(this,"attr."+e,t)):null==t?(n.local?pj:pz)(n):(n.local?pL:pR)(n,i,t))}function pV(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function pG(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function pH(e,t){var n,i;function a(){var a=t.apply(this,arguments);return a!==i&&(n=(i=a)&&pG(e,a)),n}return a._value=t,a}function pW(e,t){var n,i;function a(){var a=t.apply(this,arguments);return a!==i&&(n=(i=a)&&pV(e,a)),n}return a._value=t,a}function pq(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw Error();var i=u6(e);return this.tween(n,(i.local?pH:pW)(i,t))}function pK(e,t){return function(){d$(this,e).delay=+t.apply(this,arguments)}}function pX(e,t){return t*=1,function(){d$(this,e).delay=t}}function pZ(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?pK:pX)(t,e)):dA(this.node(),t).delay}function pY(e,t){return function(){dO(this,e).duration=+t.apply(this,arguments)}}function pQ(e,t){return t*=1,function(){dO(this,e).duration=t}}function pJ(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?pY:pQ)(t,e)):dA(this.node(),t).duration}function p0(e,t){if("function"!=typeof t)throw Error();return function(){dO(this,e).ease=t}}function p1(e){var t=this._id;return arguments.length?this.each(p0(t,e)):dA(this.node(),t).ease}function p2(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw Error();dO(this,e).ease=n}}function p3(e){if("function"!=typeof e)throw Error();return this.each(p2(this._id,e))}function p4(e){"function"!=typeof e&&(e=uT(e));for(var t=this._groups,n=t.length,i=Array(n),a=0;a<n;++a)for(var o,s=t[a],l=s.length,u=i[a]=[],c=0;c<l;++c)(o=s[c])&&e.call(o,o.__data__,c,s)&&u.push(o);return new hS(i,this._parents,this._name,this._id)}function p6(e){if(e._id!==this._id)throw Error();for(var t=this._groups,n=e._groups,i=t.length,a=n.length,o=Math.min(i,a),s=Array(i),l=0;l<o;++l)for(var u,c=t[l],d=n[l],p=c.length,h=s[l]=Array(p),f=0;f<p;++f)(u=c[f]||d[f])&&(h[f]=u);for(;l<i;++l)s[l]=t[l];return new hS(s,this._parents,this._name,this._id)}function p5(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}function p8(e,t,n){var i,a,o=p5(t)?d$:dO;return function(){var s=o(this,e),l=s.on;l!==i&&(a=(i=l).copy()).on(t,n),s.on=a}}function p7(e,t){var n=this._id;return arguments.length<2?dA(this.node(),n).on.on(e):this.each(p8(n,e,t))}function p9(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function he(){return this.on("end.remove",p9(this._id))}function ht(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=ub(e));for(var i=this._groups,a=i.length,o=Array(a),s=0;s<a;++s)for(var l,u,c=i[s],d=c.length,p=o[s]=Array(d),h=0;h<d;++h)(l=c[h])&&(u=e.call(l,l.__data__,h,c))&&("__data__"in l&&(u.__data__=l.__data__),p[h]=u,dI(p[h],t,n,h,p,dA(l,n)));return new hS(o,this._parents,t,n)}function hn(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=u_(e));for(var i=this._groups,a=i.length,o=[],s=[],l=0;l<a;++l)for(var u,c=i[l],d=c.length,p=0;p<d;++p)if(u=c[p]){for(var h,f=e.call(u,u.__data__,p,c),g=dA(u,n),m=0,y=f.length;m<y;++m)(h=f[m])&&dI(h,t,n,m,f,g);o.push(f),s.push(u)}return new hS(o,s,t,n)}var hr=cW.prototype.constructor;function hi(){return new hr(this._groups,this._parents)}function ha(e,t){var n,i,a;return function(){var o=cl(this,e),s=(this.style.removeProperty(e),cl(this,e));return o===s?null:o===n&&s===i?a:a=t(n=o,i=s)}}function ho(e){return function(){this.style.removeProperty(e)}}function hs(e,t,n){var i,a,o=n+"";return function(){var s=cl(this,e);return s===o?null:s===i?a:a=t(i=s,n)}}function hl(e,t,n){var i,a,o;return function(){var s=cl(this,e),l=n(this),u=l+"";return null==l&&(this.style.removeProperty(e),u=l=cl(this,e)),s===u?null:s===i&&u===a?o:(a=u,o=t(i=s,l))}}function hu(e,t){var n,i,a,o,s="style."+t,l="end."+s;return function(){var u=dO(this,e),c=u.on,d=null==u.value[s]?o||(o=ho(t)):void 0;(c!==n||a!==d)&&(i=(n=c).copy()).on(l,a=d),u.on=i}}function hc(e,t,n){var i="transform"==(e+="")?dB:pM;return null==t?this.styleTween(e,ha(e,i)).on("end.style."+e,ho(e)):"function"==typeof t?this.styleTween(e,hl(e,i,dW(this,"style."+e,t))).each(hu(this._id,e)):this.styleTween(e,hs(e,i,t),n).on("end.style."+e,null)}function hd(e,t,n){return function(i){this.style.setProperty(e,t.call(this,i),n)}}function hp(e,t,n){var i,a;function o(){var o=t.apply(this,arguments);return o!==a&&(i=(a=o)&&hd(e,o,n)),i}return o._value=t,o}function hh(e,t,n){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==t)return this.tween(i,null);if("function"!=typeof t)throw Error();return this.tween(i,hp(e,t,null==n?"":n))}function hf(e){return function(){this.textContent=e}}function hg(e){return function(){var t=e(this);this.textContent=null==t?"":t}}function hm(e){return this.tween("text","function"==typeof e?hg(dW(this,"text",e)):hf(null==e?"":e+""))}function hy(e){return function(t){this.textContent=e.call(this,t)}}function hb(e){var t,n;function i(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&hy(i)),t}return i._value=e,i}function hv(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw Error();return this.tween(t,hb(e))}function hx(){for(var e=this._name,t=this._id,n=hT(),i=this._groups,a=i.length,o=0;o<a;++o)for(var s,l=i[o],u=l.length,c=0;c<u;++c)if(s=l[c]){var d=dA(s,t);dI(s,e,n,c,l,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new hS(i,this._parents,e,n)}function hw(){var e,t,n=this,i=n._id,a=n.size();return new Promise(function(o,s){var l={value:s},u={value:function(){0==--a&&o()}};n.each(function(){var n=dO(this,i),a=n.on;a!==e&&((t=(e=a).copy())._.cancel.push(l),t._.interrupt.push(l),t._.end.push(u)),n.on=t}),0===a&&o()})}var h_=0;function hS(e,t,n,i){this._groups=e,this._parents=t,this._name=n,this._id=i}function hk(e){return cW().transition(e)}function hT(){return++h_}var hC=cW.prototype;hS.prototype=hk.prototype={constructor:hS,select:ht,selectAll:hn,selectChild:hC.selectChild,selectChildren:hC.selectChildren,filter:p4,merge:p6,selection:hi,transition:hx,call:hC.call,nodes:hC.nodes,node:hC.node,size:hC.size,empty:hC.empty,each:hC.each,on:p7,attr:pU,attrTween:pq,style:hc,styleTween:hh,text:hm,textTween:hv,remove:he,tween:dH,delay:pZ,duration:pJ,ease:p1,easeVarying:p3,end:hw,[Symbol.iterator]:hC[Symbol.iterator]};var hE={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function hI(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw Error(`transition ${t} not found`);return n}function h$(e){var t,n;e instanceof hS?(t=e._id,e=e._name):(t=hT(),(n=hE).time=du(),e=null==e?null:e+"");for(var i=this._groups,a=i.length,o=0;o<a;++o)for(var s,l=i[o],u=l.length,c=0;c<u;++c)(s=l[c])&&dI(s,e,t,c,l,n||hI(s,t));return new hS(i,this._parents,e,t)}cW.prototype.interrupt=dD,cW.prototype.transition=h$;let hO=e=>()=>e;function hA(e,{sourceEvent:t,target:n,transform:i,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:a}})}function hN(e,t,n){this.k=e,this.x=t,this.y=n}hN.prototype={constructor:hN,scale:function(e){return 1===e?this:new hN(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new hN(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var hP=new hN(1,0,0);function hD(e){e.stopImmediatePropagation()}function hM(e){e.preventDefault(),e.stopImmediatePropagation()}function hz(e){return(!e.ctrlKey||"wheel"===e.type)&&!e.button}function hj(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function hR(){return this.__zoom||hP}function hL(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function hF(){return navigator.maxTouchPoints||"ontouchstart"in this}function hB(e,t,n){var i=e.invertX(t[0][0])-n[0][0],a=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function hU(){var e,t,n,i=hz,a=hj,o=hB,s=hL,l=hF,u=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],d=250,p=c4,h=um("start","zoom","end"),f=500,g=150,m=0,y=10;function b(e){e.property("__zoom",hR).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",C).on("dblclick.zoom",E).filter(l).on("touchstart.zoom",I).on("touchmove.zoom",$).on("touchend.zoom touchcancel.zoom",O).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(e,t){return(t=Math.max(u[0],Math.min(u[1],t)))===e.k?e:new hN(t,e.x,e.y)}function x(e,t,n){var i=t[0]-n[0]*e.k,a=t[1]-n[1]*e.k;return i===e.x&&a===e.y?e:new hN(e.k,i,a)}function w(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function _(e,t,n,i){e.on("start.zoom",function(){S(this,arguments).event(i).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(i).end()}).tween("zoom",function(){var e=this,o=arguments,s=S(e,o).event(i),l=a.apply(e,o),u=null==n?w(l):"function"==typeof n?n.apply(e,o):n,c=Math.max(l[1][0]-l[0][0],l[1][1]-l[0][1]),d=e.__zoom,h="function"==typeof t?t.apply(e,o):t,f=p(d.invert(u).concat(c/d.k),h.invert(u).concat(c/h.k));return function(e){if(1===e)e=h;else{var t=f(e),n=c/t[2];e=new hN(n,u[0]-t[0]*n,u[1]-t[1]*n)}s.zoom(null,e)}})}function S(e,t,n){return!n&&e.__zooming||new k(e,t)}function k(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=a.apply(e,t),this.taps=0}function T(e,...t){if(i.apply(this,arguments)){var n=S(this,t).event(e),a=this.__zoom,l=Math.max(u[0],Math.min(u[1],a.k*Math.pow(2,s.apply(this,arguments)))),d=c5(e);if(n.wheel)(n.mouse[0][0]!==d[0]||n.mouse[0][1]!==d[1])&&(n.mouse[1]=a.invert(n.mouse[0]=d)),clearTimeout(n.wheel);else{if(a.k===l)return;n.mouse=[d,a.invert(d)],dP(this),n.start()}hM(e),n.wheel=setTimeout(p,g),n.zoom("mouse",o(x(v(a,l),n.mouse[0],n.mouse[1]),n.extent,c))}function p(){n.wheel=null,n.end()}}function C(e,...t){if(!n&&i.apply(this,arguments)){var a=e.currentTarget,s=S(this,t,!0).event(e),l=cq(e.view).on("mousemove.zoom",h,!0).on("mouseup.zoom",f,!0),u=c5(e,a),d=e.clientX,p=e.clientY;cQ(e.view),hD(e),s.mouse=[u,this.__zoom.invert(u)],dP(this),s.start()}function h(e){if(hM(e),!s.moved){var t=e.clientX-d,n=e.clientY-p;s.moved=t*t+n*n>m}s.event(e).zoom("mouse",o(x(s.that.__zoom,s.mouse[0]=c5(e,a),s.mouse[1]),s.extent,c))}function f(e){l.on("mousemove.zoom mouseup.zoom",null),cJ(e.view,s.moved),hM(e),s.event(e).end()}}function E(e,...t){if(i.apply(this,arguments)){var n=this.__zoom,s=c5(e.changedTouches?e.changedTouches[0]:e,this),l=n.invert(s),u=n.k*(e.shiftKey?.5:2),p=o(x(v(n,u),s,l),a.apply(this,t),c);hM(e),d>0?cq(this).transition().duration(d).call(_,p,s,e):cq(this).call(b.transform,p,s,e)}}function I(n,...a){if(i.apply(this,arguments)){var o,s,l,u,c=n.touches,d=c.length,p=S(this,a,n.changedTouches.length===d).event(n);for(hD(n),s=0;s<d;++s)u=[u=c5(l=c[s],this),this.__zoom.invert(u),l.identifier],p.touch0?p.touch1||p.touch0[2]===u[2]||(p.touch1=u,p.taps=0):(p.touch0=u,o=!0,p.taps=1+!!e);e&&(e=clearTimeout(e)),o&&(p.taps<2&&(t=u[0],e=setTimeout(function(){e=null},f)),dP(this),p.start())}}function $(e,...t){if(this.__zooming){var n,i,a,s,l=S(this,t).event(e),u=e.changedTouches,d=u.length;for(hM(e),n=0;n<d;++n)a=c5(i=u[n],this),l.touch0&&l.touch0[2]===i.identifier?l.touch0[0]=a:l.touch1&&l.touch1[2]===i.identifier&&(l.touch1[0]=a);if(i=l.that.__zoom,l.touch1){var p=l.touch0[0],h=l.touch0[1],f=l.touch1[0],g=l.touch1[1],m=(m=f[0]-p[0])*m+(m=f[1]-p[1])*m,y=(y=g[0]-h[0])*y+(y=g[1]-h[1])*y;i=v(i,Math.sqrt(m/y)),a=[(p[0]+f[0])/2,(p[1]+f[1])/2],s=[(h[0]+g[0])/2,(h[1]+g[1])/2]}else{if(!l.touch0)return;a=l.touch0[0],s=l.touch0[1]}l.zoom("touch",o(x(i,a,s),l.extent,c))}}function O(e,...i){if(this.__zooming){var a,o,s=S(this,i).event(e),l=e.changedTouches,u=l.length;for(hD(e),n&&clearTimeout(n),n=setTimeout(function(){n=null},f),a=0;a<u;++a)o=l[a],s.touch0&&s.touch0[2]===o.identifier?delete s.touch0:s.touch1&&s.touch1[2]===o.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(o=c5(o,this),Math.hypot(t[0]-o[0],t[1]-o[1])<y)){var c=cq(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return b.transform=function(e,t,n,i){var a=e.selection?e.selection():e;a.property("__zoom",hR),e!==a?_(e,t,n,i):a.interrupt().each(function(){S(this,arguments).event(i).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()})},b.scaleBy=function(e,t,n,i){b.scaleTo(e,function(){var e=this.__zoom.k,n="function"==typeof t?t.apply(this,arguments):t;return e*n},n,i)},b.scaleTo=function(e,t,n,i){b.transform(e,function(){var e=a.apply(this,arguments),i=this.__zoom,s=null==n?w(e):"function"==typeof n?n.apply(this,arguments):n,l=i.invert(s),u="function"==typeof t?t.apply(this,arguments):t;return o(x(v(i,u),s,l),e,c)},n,i)},b.translateBy=function(e,t,n,i){b.transform(e,function(){return o(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),a.apply(this,arguments),c)},null,i)},b.translateTo=function(e,t,n,i,s){b.transform(e,function(){var e=a.apply(this,arguments),s=this.__zoom,l=null==i?w(e):"function"==typeof i?i.apply(this,arguments):i;return o(hP.translate(l[0],l[1]).scale(s.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,c)},i,s)},k.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=cq(this.that).datum();h.call(e,this.that,new hA(e,{sourceEvent:this.sourceEvent,target:b,type:e,transform:this.that.__zoom,dispatch:h}),t)}},b.wheelDelta=function(e){return arguments.length?(s="function"==typeof e?e:hO(+e),b):s},b.filter=function(e){return arguments.length?(i="function"==typeof e?e:hO(!!e),b):i},b.touchable=function(e){return arguments.length?(l="function"==typeof e?e:hO(!!e),b):l},b.extent=function(e){return arguments.length?(a="function"==typeof e?e:hO([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),b):a},b.scaleExtent=function(e){return arguments.length?(u[0]=+e[0],u[1]=+e[1],b):[u[0],u[1]]},b.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],b):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},b.constrain=function(e){return arguments.length?(o=e,b):o},b.duration=function(e){return arguments.length?(d=+e,b):d},b.interpolate=function(e){return arguments.length?(p=e,b):p},b.on=function(){var e=h.on.apply(h,arguments);return e===h?b:e},b.clickDistance=function(e){return arguments.length?(m=(e*=1)*e,b):Math.sqrt(m)},b.tapDistance=function(e){return arguments.length?(y=+e,b):y},b}(function e(e){for(;!e.__zoom;)if(!(e=e.parentNode))return hP;return e.__zoom}).prototype=hN.prototype;let hV=e=>()=>e;function hG(e,{sourceEvent:t,subject:n,target:i,identifier:a,active:o,x:s,y:l,dx:u,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}function hH(e){return!e.ctrlKey&&!e.button}function hW(){return this.parentNode}function hq(e,t){return null==t?{x:e.x,y:e.y}:t}function hK(){return navigator.maxTouchPoints||"ontouchstart"in this}function hX(){var e,t,n,i,a=hH,o=hW,s=hq,l=hK,u={},c=um("start","drag","end"),d=0,p=0;function h(e){e.on("mousedown.drag",f).filter(l).on("touchstart.drag",y).on("touchmove.drag",b,cK).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(s,l){if(!i&&a.call(this,s,l)){var u=x(this,o.call(this,s,l),s,l,"mouse");u&&(cq(s.view).on("mousemove.drag",g,cX).on("mouseup.drag",m,cX),cQ(s.view),cZ(s),n=!1,e=s.clientX,t=s.clientY,u("start",s))}}function g(i){if(cY(i),!n){var a=i.clientX-e,o=i.clientY-t;n=a*a+o*o>p}u.mouse("drag",i)}function m(e){cq(e.view).on("mousemove.drag mouseup.drag",null),cJ(e.view,n),cY(e),u.mouse("end",e)}function y(e,t){if(a.call(this,e,t)){var n,i,s=e.changedTouches,l=o.call(this,e,t),u=s.length;for(n=0;n<u;++n)(i=x(this,l,e,t,s[n].identifier,s[n]))&&(cZ(e),i("start",e,s[n]))}}function b(e){var t,n,i=e.changedTouches,a=i.length;for(t=0;t<a;++t)(n=u[i[t].identifier])&&(cY(e),n("drag",e,i[t]))}function v(e){var t,n,a=e.changedTouches,o=a.length;for(i&&clearTimeout(i),i=setTimeout(function(){i=null},500),t=0;t<o;++t)(n=u[a[t].identifier])&&(cZ(e),n("end",e,a[t]))}function x(e,t,n,i,a,o){var l,p,f,g=c.copy(),m=c5(o||n,t);if(null!=(f=s.call(e,new hG("beforestart",{sourceEvent:n,target:h,identifier:a,active:d,x:m[0],y:m[1],dx:0,dy:0,dispatch:g}),i)))return l=f.x-m[0]||0,p=f.y-m[1]||0,function n(o,s,c){var y,b=m;switch(o){case"start":u[a]=n,y=d++;break;case"end":delete u[a],--d;case"drag":m=c5(c||s,t),y=d}g.call(o,e,new hG(o,{sourceEvent:s,subject:f,target:h,identifier:a,active:y,x:m[0]+l,y:m[1]+p,dx:m[0]-b[0],dy:m[1]-b[1],dispatch:g}),i)}}return h.filter=function(e){return arguments.length?(a="function"==typeof e?e:hV(!!e),h):a},h.container=function(e){return arguments.length?(o="function"==typeof e?e:hV(e),h):o},h.subject=function(e){return arguments.length?(s="function"==typeof e?e:hV(e),h):s},h.touchable=function(e){return arguments.length?(l="function"==typeof e?e:hV(!!e),h):l},h.on=function(){var e=c.on.apply(c,arguments);return e===c?h:e},h.clickDistance=function(e){return arguments.length?(p=(e*=1)*e,h):Math.sqrt(p)},h}hG.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};let hZ=(0,x.createContext)(null),hY=hZ.Provider,hQ=e=>`Node type "${e}" not found. Using fallback type "default".`,hJ=()=>"The React Flow parent container needs a width and a height to render the graph.",h0=()=>"Only child nodes can use a parent extent.",h1=()=>"Can't create edge. An edge needs a source and a target.",h2=e=>`The old edge with id=${e} does not exist.`,h3=e=>`Marker type "${e}" doesn't exist.`,h4=(e,t)=>`Couldn't create edge for ${!e?"source":"target"} handle id: "${!e?t.sourceHandle:t.targetHandle}", edge id: ${t.id}.`,h6=()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",h5=e=>`Edge type "${e}" not found. Using fallback type "default".`,h8=e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,h7=(()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001")();function h9(e,t){let n=(0,x.useContext)(hZ);if(null===n)throw Error(h7);return uo(n,e,t)}let fe=()=>{let e=(0,x.useContext)(hZ);if(null===e)throw Error(h7);return(0,x.useMemo)(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},ft=e=>e.userSelectionActive?"none":"all";function fn({position:e,children:t,className:n,style:i,...a}){let o=h9(ft),s=`${e}`.split("-");return x.createElement("div",{className:l9(["react-flow__panel",n,...s]),style:{...i,pointerEvents:o},...a},t)}function fr({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:x.createElement(fn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},x.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}let fi=({x:e,y:t,label:n,labelStyle:i={},labelShowBg:a=!0,labelBgStyle:o={},labelBgPadding:s=[2,4],labelBgBorderRadius:l=2,children:u,className:c,...d})=>{let p=(0,x.useRef)(null),[h,f]=(0,x.useState)({x:0,y:0,width:0,height:0}),g=l9(["react-flow__edge-textwrapper",c]);return((0,x.useEffect)(()=>{if(p.current){let e=p.current.getBBox();f({x:e.x,y:e.y,width:e.width,height:e.height})}},[n]),void 0!==n&&n)?x.createElement("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:g,visibility:h.width?"visible":"hidden",...d},a&&x.createElement("rect",{width:h.width+2*s[0],x:-s[0],y:-s[1],height:h.height+2*s[1],className:"react-flow__edge-textbg",style:o,rx:l,ry:l}),x.createElement("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:p,style:i},n),u):null};var fa=(0,x.memo)(fi);let fo=e=>({width:e.offsetWidth,height:e.offsetHeight}),fs=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),fl=(e={x:0,y:0},t)=>({x:fs(e.x,t[0][0],t[1][0]),y:fs(e.y,t[0][1],t[1][1])}),fu=(e,t,n)=>e<t?fs(Math.abs(e-t),1,50)/50:e>n?-fs(Math.abs(e-n),1,50)/50:0,fc=(e,t)=>[20*fu(e.x,35,t.width-35),20*fu(e.y,35,t.height-35)],fd=e=>e.getRootNode?.()||window?.document,fp=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),fh=({x:e,y:t,width:n,height:i})=>({x:e,y:t,x2:e+n,y2:t+i}),ff=({x:e,y:t,x2:n,y2:i})=>({x:e,y:t,width:n-e,height:i-t}),fg=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),fm=(e,t)=>ff(fp(fh(e),fh(t))),fy=(e,t)=>Math.ceil(Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x))*Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y))),fb=e=>fv(e.width)&&fv(e.height)&&fv(e.x)&&fv(e.y),fv=e=>!isNaN(e)&&isFinite(e),fx=Symbol.for("internals"),fw=["Enter"," ","Escape"],f_=(e,t)=>{},fS=e=>"nativeEvent"in e;function fk(e){let t=fS(e)?e.nativeEvent:e,n=t.composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n?.nodeName)||n?.hasAttribute("contenteditable")||!!n?.closest(".nokey")}let fT=e=>"clientX"in e,fC=(e,t)=>{let n=fT(e),i=n?e.clientX:e.touches?.[0].clientX,a=n?e.clientY:e.touches?.[0].clientY;return{x:i-(t?.left??0),y:a-(t?.top??0)}},fE=()=>"undefined"!=typeof navigator&&navigator?.userAgent?.indexOf("Mac")>=0,fI=({id:e,path:t,labelX:n,labelY:i,label:a,labelStyle:o,labelShowBg:s,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:c,style:d,markerEnd:p,markerStart:h,interactionWidth:f=20})=>x.createElement(x.Fragment,null,x.createElement("path",{id:e,style:d,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:p,markerStart:h}),f&&x.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}),a&&fv(n)&&fv(i)?x.createElement(fa,{x:n,y:i,label:a,labelStyle:o,labelShowBg:s,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:c}):null);function f$(e,t,n){return void 0===n?n:i=>{let a=t().edges.find(t=>t.id===e);a&&n(i,{...a})}}function fO({sourceX:e,sourceY:t,targetX:n,targetY:i}){let a=Math.abs(n-e)/2,o=Math.abs(i-t)/2;return[n<e?n+a:n-a,i<t?i+o:i-o,a,o]}function fA({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:a,sourceControlY:o,targetControlX:s,targetControlY:l}){let u=.125*e+.375*a+.375*s+.125*n,c=.125*t+.375*o+.375*l+.125*i,d=Math.abs(u-e),p=Math.abs(c-t);return[u,c,d,p]}function fN({pos:e,x1:t,y1:n,x2:i,y2:a}){return e===c.Left||e===c.Right?[.5*(t+i),n]:[t,.5*(n+a)]}function fP({sourceX:e,sourceY:t,sourcePosition:n=c.Bottom,targetX:i,targetY:a,targetPosition:o=c.Top}){let[s,l]=fN({pos:n,x1:e,y1:t,x2:i,y2:a}),[u,d]=fN({pos:o,x1:i,y1:a,x2:e,y2:t}),[p,h,f,g]=fA({sourceX:e,sourceY:t,targetX:i,targetY:a,sourceControlX:s,sourceControlY:l,targetControlX:u,targetControlY:d});return[`M${e},${t} C${s},${l} ${u},${d} ${i},${a}`,p,h,f,g]}fI.displayName="BaseEdge",!function(e){e.Strict="strict",e.Loose="loose"}(a||(a={})),function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"}(o||(o={})),function(e){e.Partial="partial",e.Full="full"}(s||(s={})),function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"}(l||(l={})),function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"}(u||(u={})),function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"}(c||(c={}));let fD=(0,x.memo)(({sourceX:e,sourceY:t,targetX:n,targetY:i,sourcePosition:a=c.Bottom,targetPosition:o=c.Top,label:s,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:m,interactionWidth:y})=>{let[b,v,w]=fP({sourceX:e,sourceY:t,sourcePosition:a,targetX:n,targetY:i,targetPosition:o});return x.createElement(fI,{path:b,labelX:v,labelY:w,label:s,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:m,interactionWidth:y})});fD.displayName="SimpleBezierEdge";let fM={[c.Left]:{x:-1,y:0},[c.Right]:{x:1,y:0},[c.Top]:{x:0,y:-1},[c.Bottom]:{x:0,y:1}},fz=({source:e,sourcePosition:t=c.Bottom,target:n})=>t===c.Left||t===c.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},fj=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function fR({source:e,sourcePosition:t=c.Bottom,target:n,targetPosition:i=c.Top,center:a,offset:o}){let s,l,u=fM[t],d=fM[i],p={x:e.x+u.x*o,y:e.y+u.y*o},h={x:n.x+d.x*o,y:n.y+d.y*o},f=fz({source:p,sourcePosition:t,target:h}),g=0!==f.x?"x":"y",m=f[g],y=[],b={x:0,y:0},v={x:0,y:0},[x,w,_,S]=fO({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(u[g]*d[g]==-1){s=a.x??x,l=a.y??w;let e=[{x:s,y:p.y},{x:s,y:h.y}],t=[{x:p.x,y:l},{x:h.x,y:l}];y=u[g]===m?"x"===g?e:t:"x"===g?t:e}else{let a=[{x:p.x,y:h.y}],c=[{x:h.x,y:p.y}];if(y="x"===g?u.x===m?c:a:u.y===m?a:c,t===i){let t=Math.abs(e[g]-n[g]);if(t<=o){let i=Math.min(o-1,o-t);u[g]===m?b[g]=(p[g]>e[g]?-1:1)*i:v[g]=(h[g]>n[g]?-1:1)*i}}if(t!==i){let e="x"===g?"y":"x",t=u[g]===d[e],n=p[e]>h[e],i=p[e]<h[e];(1===u[g]&&(!t&&n||t&&i)||1!==u[g]&&(!t&&i||t&&n))&&(y="x"===g?a:c)}let f={x:p.x+b.x,y:p.y+b.y},x={x:h.x+v.x,y:h.y+v.y};Math.max(Math.abs(f.x-y[0].x),Math.abs(x.x-y[0].x))>=Math.max(Math.abs(f.y-y[0].y),Math.abs(x.y-y[0].y))?(s=(f.x+x.x)/2,l=y[0].y):(s=y[0].x,l=(f.y+x.y)/2)}return[[e,{x:p.x+b.x,y:p.y+b.y},...y,{x:h.x+v.x,y:h.y+v.y},n],s,l,_,S]}function fL(e,t,n,i){let a=Math.min(fj(e,t)/2,fj(t,n)/2,i),{x:o,y:s}=t;if(e.x===o&&o===n.x||e.y===s&&s===n.y)return`L${o} ${s}`;if(e.y===s){let t=e.x<n.x?-1:1,i=e.y<n.y?1:-1;return`L ${o+a*t},${s}Q ${o},${s} ${o},${s+a*i}`}let l=e.x<n.x?1:-1,u=e.y<n.y?-1:1;return`L ${o},${s+a*u}Q ${o},${s} ${o+a*l},${s}`}function fF({sourceX:e,sourceY:t,sourcePosition:n=c.Bottom,targetX:i,targetY:a,targetPosition:o=c.Top,borderRadius:s=5,centerX:l,centerY:u,offset:d=20}){let[p,h,f,g,m]=fR({source:{x:e,y:t},sourcePosition:n,target:{x:i,y:a},targetPosition:o,center:{x:l,y:u},offset:d});return[p.reduce((e,t,n)=>{let i="";return e+(i=n>0&&n<p.length-1?fL(p[n-1],t,p[n+1],s):`${0===n?"M":"L"}${t.x} ${t.y}`)},""),h,f,g,m]}let fB=(0,x.memo)(({sourceX:e,sourceY:t,targetX:n,targetY:i,label:a,labelStyle:o,labelShowBg:s,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:p,sourcePosition:h=c.Bottom,targetPosition:f=c.Top,markerEnd:g,markerStart:m,pathOptions:y,interactionWidth:b})=>{let[v,w,_]=fF({sourceX:e,sourceY:t,sourcePosition:h,targetX:n,targetY:i,targetPosition:f,borderRadius:y?.borderRadius,offset:y?.offset});return x.createElement(fI,{path:v,labelX:w,labelY:_,label:a,labelStyle:o,labelShowBg:s,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:p,markerEnd:g,markerStart:m,interactionWidth:b})});fB.displayName="SmoothStepEdge";let fU=(0,x.memo)(e=>x.createElement(fB,{...e,pathOptions:(0,x.useMemo)(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));function fV({sourceX:e,sourceY:t,targetX:n,targetY:i}){let[a,o,s,l]=fO({sourceX:e,sourceY:t,targetX:n,targetY:i});return[`M ${e},${t}L ${n},${i}`,a,o,s,l]}fU.displayName="StepEdge";let fG=(0,x.memo)(({sourceX:e,sourceY:t,targetX:n,targetY:i,label:a,labelStyle:o,labelShowBg:s,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:c,style:d,markerEnd:p,markerStart:h,interactionWidth:f})=>{let[g,m,y]=fV({sourceX:e,sourceY:t,targetX:n,targetY:i});return x.createElement(fI,{path:g,labelX:m,labelY:y,label:a,labelStyle:o,labelShowBg:s,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:c,style:d,markerEnd:p,markerStart:h,interactionWidth:f})});function fH(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function fW({pos:e,x1:t,y1:n,x2:i,y2:a,c:o}){switch(e){case c.Left:return[t-fH(t-i,o),n];case c.Right:return[t+fH(i-t,o),n];case c.Top:return[t,n-fH(n-a,o)];case c.Bottom:return[t,n+fH(a-n,o)]}}function fq({sourceX:e,sourceY:t,sourcePosition:n=c.Bottom,targetX:i,targetY:a,targetPosition:o=c.Top,curvature:s=.25}){let[l,u]=fW({pos:n,x1:e,y1:t,x2:i,y2:a,c:s}),[d,p]=fW({pos:o,x1:i,y1:a,x2:e,y2:t,c:s}),[h,f,g,m]=fA({sourceX:e,sourceY:t,targetX:i,targetY:a,sourceControlX:l,sourceControlY:u,targetControlX:d,targetControlY:p});return[`M${e},${t} C${l},${u} ${d},${p} ${i},${a}`,h,f,g,m]}fG.displayName="StraightEdge";let fK=(0,x.memo)(({sourceX:e,sourceY:t,targetX:n,targetY:i,sourcePosition:a=c.Bottom,targetPosition:o=c.Top,label:s,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:m,pathOptions:y,interactionWidth:b})=>{let[v,w,_]=fq({sourceX:e,sourceY:t,sourcePosition:a,targetX:n,targetY:i,targetPosition:o,curvature:y?.curvature});return x.createElement(fI,{path:v,labelX:w,labelY:_,label:s,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:m,interactionWidth:b})});fK.displayName="BezierEdge";let fX=(0,x.createContext)(null),fZ=fX.Provider;fX.Consumer;let fY=()=>(0,x.useContext)(fX),fQ=e=>"id"in e&&"source"in e&&"target"in e,fJ=({source:e,sourceHandle:t,target:n,targetHandle:i})=>`reactflow__edge-${e}${t||""}-${n}${i||""}`,f0=(e,t)=>{if(void 0===e)return"";if("string"==typeof e)return e;let n=t?`${t}__`:"";return`${n}${Object.keys(e).sort().map(t=>`${t}=${e[t]}`).join("&")}`},f1=(e,t)=>t.some(t=>t.source===e.source&&t.target===e.target&&(t.sourceHandle===e.sourceHandle||!t.sourceHandle&&!e.sourceHandle)&&(t.targetHandle===e.targetHandle||!t.targetHandle&&!e.targetHandle)),f2=(e,t)=>{let n;return e.source&&e.target?f1(n=fQ(e)?{...e}:{...e,id:fJ(e)},t)?t:t.concat(n):(f_("006",h1()),t)},f3=({x:e,y:t},[n,i,a],o,[s,l])=>{let u={x:(e-n)/a,y:(t-i)/a};return o?{x:s*Math.round(u.x/s),y:l*Math.round(u.y/l)}:u},f4=({x:e,y:t},[n,i,a])=>({x:e*a+n,y:t*a+i}),f6=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};let n=(e.width??0)*t[0],i=(e.height??0)*t[1],a={x:e.position.x-n,y:e.position.y-i};return{...a,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-i}:a}},f5=(e,t=[0,0])=>0===e.length?{x:0,y:0,width:0,height:0}:ff(e.reduce((e,n)=>{let{x:i,y:a}=f6(n,t).positionAbsolute;return fp(e,fh({x:i,y:a,width:n.width||0,height:n.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0})),f8=(e,t,[n,i,a]=[0,0,1],o=!1,s=!1,l=[0,0])=>{let u={x:(t.x-n)/a,y:(t.y-i)/a,width:t.width/a,height:t.height/a},c=[];return e.forEach(e=>{let{width:t,height:n,selectable:i=!0,hidden:a=!1}=e;if(s&&!i||a)return!1;let{positionAbsolute:d}=f6(e,l),p=fy(u,{x:d.x,y:d.y,width:t||0,height:n||0}),h=void 0===t||void 0===n||null===t||null===n,f=o&&p>0,g=(t||0)*(n||0);(h||f||p>=g||e.dragging)&&c.push(e)}),c},f7=(e,t)=>{let n=e.map(e=>e.id);return t.filter(e=>n.includes(e.source)||n.includes(e.target))},f9=(e,t,n,i,a,o=.1)=>{let s=fs(Math.min(t/(e.width*(1+o)),n/(e.height*(1+o))),i,a);return{x:t/2-(e.x+e.width/2)*s,y:n/2-(e.y+e.height/2)*s,zoom:s}},ge=(e,t=0)=>e.transition().duration(t);function gt(e,t,n,i){return(t[n]||[]).reduce((t,a)=>(`${e.id}-${a.id}-${n}`!==i&&t.push({id:a.id||null,type:n,nodeId:e.id,x:(e.positionAbsolute?.x??0)+a.x+a.width/2,y:(e.positionAbsolute?.y??0)+a.y+a.height/2}),t),[])}function gn(e,t,n,i,a,o){let{x:s,y:l}=fC(e),u=t.elementsFromPoint(s,l).find(e=>e.classList.contains("react-flow__handle"));if(u){let e=u.getAttribute("data-nodeid");if(e){let t=gs(void 0,u),i=u.getAttribute("data-handleid"),s=o({nodeId:e,id:i,type:t});if(s){let o=a.find(n=>n.nodeId===e&&n.type===t&&n.id===i);return{handle:{id:i,type:t,nodeId:e,x:o?.x||n.x,y:o?.y||n.y},validHandleResult:s}}}}let c=[],d=1/0;if(a.forEach(e=>{let t=Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2);if(t<=i){let n=o(e);t<=d&&(t<d?c=[{handle:e,validHandleResult:n}]:t===d&&c.push({handle:e,validHandleResult:n}),d=t)}}),!c.length)return{handle:null,validHandleResult:gi()};if(1===c.length)return c[0];let p=c.some(({validHandleResult:e})=>e.isValid),h=c.some(({handle:e})=>"target"===e.type);return c.find(({handle:e,validHandleResult:t})=>h?"target"===e.type:!p||t.isValid)||c[0]}let gr={source:null,target:null,sourceHandle:null,targetHandle:null},gi=()=>({handleDomNode:null,isValid:!1,connection:gr,endHandle:null});function ga(e,t,n,i,o,s,l){let u="target"===o,c=l.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),d={...gi(),handleDomNode:c};if(c){let e=gs(void 0,c),o=c.getAttribute("data-nodeid"),l=c.getAttribute("data-handleid"),p=c.classList.contains("connectable"),h=c.classList.contains("connectableend"),f={source:u?o:n,sourceHandle:u?l:i,target:u?n:o,targetHandle:u?i:l};d.connection=f,p&&h&&(t===a.Strict?u&&"source"===e||!u&&"target"===e:o!==n||l!==i)&&(d.endHandle={nodeId:o,handleId:l,type:e},d.isValid=s(f))}return d}function go({nodes:e,nodeId:t,handleId:n,handleType:i}){return e.reduce((e,a)=>{if(a[fx]){let{handleBounds:o}=a[fx],s=[],l=[];o&&(s=gt(a,o,"source",`${t}-${n}-${i}`),l=gt(a,o,"target",`${t}-${n}-${i}`)),e.push(...s,...l)}return e},[])}function gs(e,t){return e?e:t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null}function gl(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function gu(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function gc({event:e,handleId:t,nodeId:n,onConnect:i,isTarget:a,getState:o,setState:s,isValidConnection:l,edgeUpdaterType:u,onReconnectEnd:c}){let d,p,h=fd(e.target),{connectionMode:f,domNode:g,autoPanOnConnect:m,connectionRadius:y,onConnectStart:b,panBy:v,getNodes:x,cancelConnection:w}=o(),_=0,{x:S,y:k}=fC(e),T=gs(u,h?.elementFromPoint(S,k)),C=g?.getBoundingClientRect();if(!C||!T)return;let E=fC(e,C),I=!1,$=null,O=!1,A=null,N=go({nodes:x(),nodeId:n,handleId:t,handleType:T}),P=()=>{if(!m)return;let[e,t]=fc(E,C);v({x:e,y:t}),_=requestAnimationFrame(P)};function D(e){let{transform:i}=o();E=fC(e,C);let{handle:u,validHandleResult:c}=gn(e,h,f3(E,i,!1,[1,1]),y,N,e=>ga(e,f,n,t,a?"target":"source",l,h));if(d=u,I||(P(),I=!0),A=c.handleDomNode,$=c.connection,O=c.isValid,s({connectionPosition:d&&O?f4({x:d.x,y:d.y},i):E,connectionStatus:gu(!!d,O),connectionEndHandle:c.endHandle}),!d&&!O&&!A)return gl(p);$.source!==$.target&&A&&(gl(p),p=A,A.classList.add("connecting","react-flow__handle-connecting"),A.classList.toggle("valid",O),A.classList.toggle("react-flow__handle-valid",O))}function M(e){(d||A)&&$&&O&&i?.($),o().onConnectEnd?.(e),u&&c?.(e),gl(p),w(),cancelAnimationFrame(_),I=!1,O=!1,$=null,A=null,h.removeEventListener("mousemove",D),h.removeEventListener("mouseup",M),h.removeEventListener("touchmove",D),h.removeEventListener("touchend",M)}s({connectionPosition:E,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:T,connectionStartHandle:{nodeId:n,handleId:t,type:T},connectionEndHandle:null}),b?.(e,{nodeId:n,handleId:t,handleType:T}),h.addEventListener("mousemove",D),h.addEventListener("mouseup",M),h.addEventListener("touchmove",D),h.addEventListener("touchend",M)}let gd=()=>!0,gp=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),gh=(e,t,n)=>i=>{let{connectionStartHandle:a,connectionEndHandle:o,connectionClickStartHandle:s}=i;return{connecting:a?.nodeId===e&&a?.handleId===t&&a?.type===n||o?.nodeId===e&&o?.handleId===t&&o?.type===n,clickConnecting:s?.nodeId===e&&s?.handleId===t&&s?.type===n}},gf=(0,x.forwardRef)(({type:e="source",position:t=c.Top,isValidConnection:n,isConnectable:i=!0,isConnectableStart:a=!0,isConnectableEnd:o=!0,id:s,onConnect:l,children:u,className:d,onMouseDown:p,onTouchStart:h,...f},g)=>{let m=s||null,y="target"===e,b=fe(),v=fY(),{connectOnClick:w,noPanClassName:_}=h9(gp,uu),{connecting:S,clickConnecting:k}=h9(gh(v,m,e),uu);v||b.getState().onError?.("010",h6());let T=e=>{let{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:i}=b.getState(),a={...t,...e};if(i){let{edges:e,setEdges:t}=b.getState();t(f2(a,e))}n?.(a),l?.(a)},C=e=>{if(!v)return;let t=fT(e);a&&(t&&0===e.button||!t)&&gc({event:e,handleId:m,nodeId:v,onConnect:T,isTarget:y,getState:b.getState,setState:b.setState,isValidConnection:n||b.getState().isValidConnection||gd}),t?p?.(e):h?.(e)},E=t=>{let{onClickConnectStart:i,onClickConnectEnd:o,connectionClickStartHandle:s,connectionMode:l,isValidConnection:u}=b.getState();if(!v||!s&&!a)return;if(!s){i?.(t,{nodeId:v,handleId:m,handleType:e}),b.setState({connectionClickStartHandle:{nodeId:v,type:e,handleId:m}});return}let c=fd(t.target),d=n||u||gd,{connection:p,isValid:h}=ga({nodeId:v,id:m,type:e},l,s.nodeId,s.handleId||null,s.type,d,c);h&&T(p),o?.(t),b.setState({connectionClickStartHandle:null})};return x.createElement("div",{"data-handleid":m,"data-nodeid":v,"data-handlepos":t,"data-id":`${v}-${m}-${e}`,className:l9(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",_,d,{source:!y,target:y,connectable:i,connectablestart:a,connectableend:o,connecting:k,connectionindicator:i&&(a&&!S||o&&S)}]),onMouseDown:C,onTouchStart:C,onClick:w?E:void 0,ref:g,...f},u)});gf.displayName="Handle";var gg=(0,x.memo)(gf);let gm=({data:e,isConnectable:t,targetPosition:n=c.Top,sourcePosition:i=c.Bottom})=>x.createElement(x.Fragment,null,x.createElement(gg,{type:"target",position:n,isConnectable:t}),e?.label,x.createElement(gg,{type:"source",position:i,isConnectable:t}));gm.displayName="DefaultNode";var gy=(0,x.memo)(gm);let gb=({data:e,isConnectable:t,sourcePosition:n=c.Bottom})=>x.createElement(x.Fragment,null,e?.label,x.createElement(gg,{type:"source",position:n,isConnectable:t}));gb.displayName="InputNode";var gv=(0,x.memo)(gb);let gx=({data:e,isConnectable:t,targetPosition:n=c.Top})=>x.createElement(x.Fragment,null,x.createElement(gg,{type:"target",position:n,isConnectable:t}),e?.label);gx.displayName="OutputNode";var gw=(0,x.memo)(gx);let g_=()=>null;g_.displayName="GroupNode";let gS=e=>({selectedNodes:e.getNodes().filter(e=>e.selected),selectedEdges:e.edges.filter(e=>e.selected).map(e=>({...e}))}),gk=e=>e.id;function gT(e,t){return uu(e.selectedNodes.map(gk),t.selectedNodes.map(gk))&&uu(e.selectedEdges.map(gk),t.selectedEdges.map(gk))}let gC=(0,x.memo)(({onSelectionChange:e})=>{let t=fe(),{selectedNodes:n,selectedEdges:i}=h9(gS,gT);return(0,x.useEffect)(()=>{let a={nodes:n,edges:i};e?.(a),t.getState().onSelectionChange.forEach(e=>e(a))},[n,i,e]),null});gC.displayName="SelectionListener";let gE=e=>!!e.onSelectionChange;function gI({onSelectionChange:e}){let t=h9(gE);return e||t?x.createElement(gC,{onSelectionChange:e}):null}let g$=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function gO(e,t){(0,x.useEffect)(()=>{void 0!==e&&t(e)},[e])}function gA(e,t,n){(0,x.useEffect)(()=>{void 0!==t&&n({[e]:t})},[t])}let gN=({nodes:e,edges:t,defaultNodes:n,defaultEdges:i,onConnect:a,onConnectStart:o,onConnectEnd:s,onClickConnectStart:l,onClickConnectEnd:u,nodesDraggable:c,nodesConnectable:d,nodesFocusable:p,edgesFocusable:h,edgesUpdatable:f,elevateNodesOnSelect:g,minZoom:m,maxZoom:y,nodeExtent:b,onNodesChange:v,onEdgesChange:w,elementsSelectable:_,connectionMode:S,snapGrid:k,snapToGrid:T,translateExtent:C,connectOnClick:E,defaultEdgeOptions:I,fitView:$,fitViewOptions:O,onNodesDelete:A,onEdgesDelete:N,onNodeDrag:P,onNodeDragStart:D,onNodeDragStop:M,onSelectionDrag:z,onSelectionDragStart:j,onSelectionDragStop:R,noPanClassName:L,nodeOrigin:F,rfId:B,autoPanOnConnect:U,autoPanOnNodeDrag:V,onError:G,connectionRadius:H,isValidConnection:W,nodeDragThreshold:q})=>{let{setNodes:K,setEdges:X,setDefaultNodesAndEdges:Z,setMinZoom:Y,setMaxZoom:Q,setTranslateExtent:J,setNodeExtent:ee,reset:et}=h9(g$,uu),en=fe();return(0,x.useEffect)(()=>(Z(n,i?.map(e=>({...e,...I}))),()=>{et()}),[]),gA("defaultEdgeOptions",I,en.setState),gA("connectionMode",S,en.setState),gA("onConnect",a,en.setState),gA("onConnectStart",o,en.setState),gA("onConnectEnd",s,en.setState),gA("onClickConnectStart",l,en.setState),gA("onClickConnectEnd",u,en.setState),gA("nodesDraggable",c,en.setState),gA("nodesConnectable",d,en.setState),gA("nodesFocusable",p,en.setState),gA("edgesFocusable",h,en.setState),gA("edgesUpdatable",f,en.setState),gA("elementsSelectable",_,en.setState),gA("elevateNodesOnSelect",g,en.setState),gA("snapToGrid",T,en.setState),gA("snapGrid",k,en.setState),gA("onNodesChange",v,en.setState),gA("onEdgesChange",w,en.setState),gA("connectOnClick",E,en.setState),gA("fitViewOnInit",$,en.setState),gA("fitViewOnInitOptions",O,en.setState),gA("onNodesDelete",A,en.setState),gA("onEdgesDelete",N,en.setState),gA("onNodeDrag",P,en.setState),gA("onNodeDragStart",D,en.setState),gA("onNodeDragStop",M,en.setState),gA("onSelectionDrag",z,en.setState),gA("onSelectionDragStart",j,en.setState),gA("onSelectionDragStop",R,en.setState),gA("noPanClassName",L,en.setState),gA("nodeOrigin",F,en.setState),gA("rfId",B,en.setState),gA("autoPanOnConnect",U,en.setState),gA("autoPanOnNodeDrag",V,en.setState),gA("onError",G,en.setState),gA("connectionRadius",H,en.setState),gA("isValidConnection",W,en.setState),gA("nodeDragThreshold",q,en.setState),gO(e,K),gO(t,X),gO(m,Y),gO(y,Q),gO(C,J),gO(b,ee),null},gP={display:"none"},gD={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},gM="react-flow__node-desc",gz="react-flow__edge-desc",gj="react-flow__aria-live",gR=e=>e.ariaLiveMessage;function gL({rfId:e}){let t=h9(gR);return x.createElement("div",{id:`${gj}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:gD},t)}function gF({rfId:e,disableKeyboardA11y:t}){return x.createElement(x.Fragment,null,x.createElement("div",{id:`${gM}-${e}`,style:gP},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),x.createElement("div",{id:`${gz}-${e}`,style:gP},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&x.createElement(gL,{rfId:e}))}var gB=(e=null,t={actInsideInputWithModifier:!0})=>{let[n,i]=(0,x.useState)(!1),a=(0,x.useRef)(!1),o=(0,x.useRef)(new Set([])),[s,l]=(0,x.useMemo)(()=>{if(null!==e){let t=(Array.isArray(e)?e:[e]).filter(e=>"string"==typeof e).map(e=>e.split("+")),n=t.reduce((e,t)=>e.concat(...t),[]);return[t,n]}return[[],[]]},[e]);return(0,x.useEffect)(()=>{let n="undefined"!=typeof document?document:null,u=t?.target||n;if(null!==e){let e=e=>{if(a.current=e.ctrlKey||e.metaKey||e.shiftKey,(!a.current||a.current&&!t.actInsideInputWithModifier)&&fk(e))return!1;let n=gV(e.code,l);o.current.add(e[n]),gU(s,o.current,!1)&&(e.preventDefault(),i(!0))},n=e=>{if((!a.current||a.current&&!t.actInsideInputWithModifier)&&fk(e))return!1;let n=gV(e.code,l);gU(s,o.current,!0)?(i(!1),o.current.clear()):o.current.delete(e[n]),"Meta"===e.key&&o.current.clear(),a.current=!1},c=()=>{o.current.clear(),i(!1)};return u?.addEventListener("keydown",e),u?.addEventListener("keyup",n),window.addEventListener("blur",c),()=>{u?.removeEventListener("keydown",e),u?.removeEventListener("keyup",n),window.removeEventListener("blur",c)}}},[e,i]),n};function gU(e,t,n){return e.filter(e=>n||e.length===t.size).some(e=>e.every(e=>t.has(e)))}function gV(e,t){return t.includes(e)?"code":"key"}function gG(e,t,n,i){let a=e.parentNode||e.parentId;if(!a)return n;let o=t.get(a),s=f6(o,i);return gG(o,t,{x:(n.x??0)+s.x,y:(n.y??0)+s.y,z:(o[fx]?.z??0)>(n.z??0)?o[fx]?.z??0:n.z??0},i)}function gH(e,t,n){e.forEach(i=>{let a=i.parentNode||i.parentId;if(a&&!e.has(a))throw Error(`Parent node ${a} not found`);if(a||n?.[i.id]){let{x:a,y:o,z:s}=gG(i,e,{...i.position,z:i[fx]?.z??0},t);i.positionAbsolute={x:a,y:o},i[fx].z=s,n?.[i.id]&&(i[fx].isParent=!0)}})}function gW(e,t,n,i){let a=new Map,o={},s=1e3*!!i;return e.forEach(e=>{let n=(fv(e.zIndex)?e.zIndex:0)+(e.selected?s:0),i=t.get(e.id),l={...e,positionAbsolute:{x:e.position.x,y:e.position.y}},u=e.parentNode||e.parentId;u&&(o[u]=!0),Object.defineProperty(l,fx,{enumerable:!1,value:{handleBounds:i?.type&&i?.type!==e.type?void 0:i?.[fx]?.handleBounds,z:n}}),a.set(e.id,l)}),gH(a,n,o),a}function gq(e,t={}){let{getNodes:n,width:i,height:a,minZoom:o,maxZoom:s,d3Zoom:l,d3Selection:u,fitViewOnInitDone:c,fitViewOnInit:d,nodeOrigin:p}=e(),h=t.initial&&!c&&d;if(l&&u&&(h||!t.initial)){let e=n().filter(e=>{let n=t.includeHiddenNodes?e.width&&e.height:!e.hidden;return t.nodes?.length?n&&t.nodes.some(t=>t.id===e.id):n}),c=e.every(e=>e.width&&e.height);if(e.length>0&&c){let{x:n,y:c,zoom:d}=f9(f5(e,p),i,a,t.minZoom??o,t.maxZoom??s,t.padding??.1),h=hP.translate(n,c).scale(d);return"number"==typeof t.duration&&t.duration>0?l.transform(ge(u,t.duration),h):l.transform(u,h),!0}}return!1}function gK(e,t){return e.forEach(e=>{let n=t.get(e.id);n&&t.set(n.id,{...n,[fx]:n[fx],selected:e.selected})}),new Map(t)}function gX(e,t){return t.map(t=>{let n=e.find(e=>e.id===t.id);return n&&(t.selected=n.selected),t})}function gZ({changedNodes:e,changedEdges:t,get:n,set:i}){let{nodeInternals:a,edges:o,onNodesChange:s,onEdgesChange:l,hasDefaultNodes:u,hasDefaultEdges:c}=n();e?.length&&(u&&i({nodeInternals:gK(e,a)}),s?.(e)),t?.length&&(c&&i({edges:gX(t,o)}),l?.(t))}let gY=()=>{},gQ={zoomIn:gY,zoomOut:gY,zoomTo:gY,getZoom:()=>1,setViewport:gY,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:gY,fitBounds:gY,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},gJ=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),g0=()=>{let e=fe(),{d3Zoom:t,d3Selection:n}=h9(gJ,uu);return(0,x.useMemo)(()=>n&&t?{zoomIn:e=>t.scaleBy(ge(n,e?.duration),1.2),zoomOut:e=>t.scaleBy(ge(n,e?.duration),1/1.2),zoomTo:(e,i)=>t.scaleTo(ge(n,i?.duration),e),getZoom:()=>e.getState().transform[2],setViewport:(i,a)=>{let[o,s,l]=e.getState().transform,u=hP.translate(i.x??o,i.y??s).scale(i.zoom??l);t.transform(ge(n,a?.duration),u)},getViewport:()=>{let[t,n,i]=e.getState().transform;return{x:t,y:n,zoom:i}},fitView:t=>gq(e.getState,t),setCenter:(i,a,o)=>{let{width:s,height:l,maxZoom:u}=e.getState(),c=void 0!==o?.zoom?o.zoom:u,d=s/2-i*c,p=l/2-a*c,h=hP.translate(d,p).scale(c);t.transform(ge(n,o?.duration),h)},fitBounds:(i,a)=>{let{width:o,height:s,minZoom:l,maxZoom:u}=e.getState(),{x:c,y:d,zoom:p}=f9(i,o,s,l,u,a?.padding??.1),h=hP.translate(c,d).scale(p);t.transform(ge(n,a?.duration),h)},project:t=>{let{transform:n,snapToGrid:i,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),f3(t,n,i,a)},screenToFlowPosition:t=>{let{transform:n,snapToGrid:i,snapGrid:a,domNode:o}=e.getState();if(!o)return t;let{x:s,y:l}=o.getBoundingClientRect();return f3({x:t.x-s,y:t.y-l},n,i,a)},flowToScreenPosition:t=>{let{transform:n,domNode:i}=e.getState();if(!i)return t;let{x:a,y:o}=i.getBoundingClientRect(),s=f4(t,n);return{x:s.x+a,y:s.y+o}},viewportInitialized:!0}:gQ,[t,n])};function g1(){let e=g0(),t=fe(),n=(0,x.useCallback)(()=>t.getState().getNodes().map(e=>({...e})),[]),i=(0,x.useCallback)(e=>t.getState().nodeInternals.get(e),[]),a=(0,x.useCallback)(()=>{let{edges:e=[]}=t.getState();return e.map(e=>({...e}))},[]),o=(0,x.useCallback)(e=>{let{edges:n=[]}=t.getState();return n.find(t=>t.id===e)},[]),s=(0,x.useCallback)(e=>{let{getNodes:n,setNodes:i,hasDefaultNodes:a,onNodesChange:o}=t.getState(),s=n(),l="function"==typeof e?e(s):e;a?i(l):o&&o(0===l.length?s.map(e=>({type:"remove",id:e.id})):l.map(e=>({item:e,type:"reset"})))},[]),l=(0,x.useCallback)(e=>{let{edges:n=[],setEdges:i,hasDefaultEdges:a,onEdgesChange:o}=t.getState(),s="function"==typeof e?e(n):e;a?i(s):o&&o(0===s.length?n.map(e=>({type:"remove",id:e.id})):s.map(e=>({item:e,type:"reset"})))},[]),u=(0,x.useCallback)(e=>{let n=Array.isArray(e)?e:[e],{getNodes:i,setNodes:a,hasDefaultNodes:o,onNodesChange:s}=t.getState();o?a([...i(),...n]):s&&s(n.map(e=>({item:e,type:"add"})))},[]),c=(0,x.useCallback)(e=>{let n=Array.isArray(e)?e:[e],{edges:i=[],setEdges:a,hasDefaultEdges:o,onEdgesChange:s}=t.getState();o?a([...i,...n]):s&&s(n.map(e=>({item:e,type:"add"})))},[]),d=(0,x.useCallback)(()=>{let{getNodes:e,edges:n=[],transform:i}=t.getState(),[a,o,s]=i;return{nodes:e().map(e=>({...e})),edges:n.map(e=>({...e})),viewport:{x:a,y:o,zoom:s}}},[]),p=(0,x.useCallback)(({nodes:e,edges:n})=>{let{nodeInternals:i,getNodes:a,edges:o,hasDefaultNodes:s,hasDefaultEdges:l,onNodesDelete:u,onEdgesDelete:c,onNodesChange:d,onEdgesChange:p}=t.getState(),h=(e||[]).map(e=>e.id),f=(n||[]).map(e=>e.id),g=a().reduce((e,t)=>{let n=t.parentNode||t.parentId,i=!h.includes(t.id)&&n&&e.find(e=>e.id===n);return("boolean"!=typeof t.deletable||t.deletable)&&(h.includes(t.id)||i)&&e.push(t),e},[]),m=o.filter(e=>"boolean"!=typeof e.deletable||e.deletable),y=m.filter(e=>f.includes(e.id));if(g||y){let e=[...y,...f7(g,m)],n=e.reduce((e,t)=>(e.includes(t.id)||e.push(t.id),e),[]);(l||s)&&(l&&t.setState({edges:o.filter(e=>!n.includes(e.id))}),s&&(g.forEach(e=>{i.delete(e.id)}),t.setState({nodeInternals:new Map(i)}))),n.length>0&&(c?.(e),p&&p(n.map(e=>({id:e,type:"remove"})))),g.length>0&&(u?.(g),d&&d(g.map(e=>({id:e.id,type:"remove"}))))}},[]),h=(0,x.useCallback)(e=>{let n=fb(e),i=n?null:t.getState().nodeInternals.get(e.id);return n||i?[n?e:fg(i),i,n]:[null,null,n]},[]),f=(0,x.useCallback)((e,n=!0,i)=>{let[a,o,s]=h(e);return a?(i||t.getState().getNodes()).filter(e=>{if(!s&&(e.id===o.id||!e.positionAbsolute))return!1;let t=fy(fg(e),a);return n&&t>0||t>=a.width*a.height}):[]},[]),g=(0,x.useCallback)((e,t,n=!0)=>{let[i]=h(e);if(!i)return!1;let a=fy(i,t);return n&&a>0||a>=i.width*i.height},[]);return(0,x.useMemo)(()=>({...e,getNodes:n,getNode:i,getEdges:a,getEdge:o,setNodes:s,setEdges:l,addNodes:u,addEdges:c,toObject:d,deleteElements:p,getIntersectingNodes:f,isNodeIntersecting:g}),[e,n,i,a,o,s,l,u,c,d,p,f,g])}let g2={actInsideInputWithModifier:!1};var g3=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{let n=fe(),{deleteElements:i}=g1(),a=gB(e,g2),o=gB(t);(0,x.useEffect)(()=>{if(a){let{edges:e,getNodes:t}=n.getState();i({nodes:t().filter(e=>e.selected),edges:e.filter(e=>e.selected)}),n.setState({nodesSelectionActive:!1})}},[a]),(0,x.useEffect)(()=>{n.setState({multiSelectionActive:o})},[o])};function g4(e){let t=fe();(0,x.useEffect)(()=>{let n,i=()=>{if(!e.current)return;let n=fo(e.current);(0===n.height||0===n.width)&&t.getState().onError?.("004",hJ()),t.setState({width:n.width||500,height:n.height||500})};return i(),window.addEventListener("resize",i),e.current&&(n=new ResizeObserver(()=>i())).observe(e.current),()=>{window.removeEventListener("resize",i),n&&e.current&&n.unobserve(e.current)}},[])}let g6={position:"absolute",width:"100%",height:"100%",top:0,left:0},g5=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,g8=e=>({x:e.x,y:e.y,zoom:e.k}),g7=(e,t)=>e.target.closest(`.${t}`),g9=(e,t)=>2===t&&Array.isArray(e)&&e.includes(2),me=e=>{let t=e.ctrlKey&&fE()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*t},mt=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),mn=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:i,zoomOnScroll:a=!0,zoomOnPinch:s=!0,panOnScroll:l=!1,panOnScrollSpeed:u=.5,panOnScrollMode:c=o.Free,zoomOnDoubleClick:d=!0,elementsSelectable:p,panOnDrag:h=!0,defaultViewport:f,translateExtent:g,minZoom:m,maxZoom:y,zoomActivationKeyCode:b,preventScrolling:v=!0,children:w,noWheelClassName:_,noPanClassName:S})=>{let k=(0,x.useRef)(),T=fe(),C=(0,x.useRef)(!1),E=(0,x.useRef)(!1),I=(0,x.useRef)(null),$=(0,x.useRef)({x:0,y:0,zoom:0}),{d3Zoom:O,d3Selection:A,d3ZoomHandler:N,userSelectionActive:P}=h9(mt,uu),D=gB(b),M=(0,x.useRef)(0),z=(0,x.useRef)(!1),j=(0,x.useRef)();return g4(I),(0,x.useEffect)(()=>{if(I.current){let e=I.current.getBoundingClientRect(),t=hU().scaleExtent([m,y]).translateExtent(g),n=cq(I.current).call(t),i=hP.translate(f.x,f.y).scale(fs(f.zoom,m,y)),a=[[0,0],[e.width,e.height]],o=t.constrain()(i,a,g);t.transform(n,o),t.wheelDelta(me),T.setState({d3Zoom:t,d3Selection:n,d3ZoomHandler:n.on("wheel.zoom"),transform:[o.x,o.y,o.k],domNode:I.current.closest(".react-flow")})}},[]),(0,x.useEffect)(()=>{A&&O&&(!l||D||P?void 0!==N&&A.on("wheel.zoom",function(e,t){if(!v&&"wheel"===e.type&&!e.ctrlKey||g7(e,_))return null;e.preventDefault(),N.call(this,e,t)},{passive:!1}):A.on("wheel.zoom",i=>{if(g7(i,_))return!1;i.preventDefault(),i.stopImmediatePropagation();let a=A.property("__zoom").k||1;if(i.ctrlKey&&s){let e=c5(i),t=a*Math.pow(2,me(i));O.scaleTo(A,t,e,i);return}let l=1===i.deltaMode?20:1,d=c===o.Vertical?0:i.deltaX*l,p=c===o.Horizontal?0:i.deltaY*l;!fE()&&i.shiftKey&&c!==o.Vertical&&(d=i.deltaY*l,p=0),O.translateBy(A,-(d/a)*u,-(p/a)*u,{internal:!0});let h=g8(A.property("__zoom")),{onViewportChangeStart:f,onViewportChange:g,onViewportChangeEnd:m}=T.getState();clearTimeout(j.current),z.current||(z.current=!0,t?.(i,h),f?.(h)),z.current&&(e?.(i,h),g?.(h),j.current=setTimeout(()=>{n?.(i,h),m?.(h),z.current=!1},150))},{passive:!1}))},[P,l,c,A,O,N,D,s,v,_,t,e,n]),(0,x.useEffect)(()=>{O&&O.on("start",e=>{if(!e.sourceEvent||e.sourceEvent.internal)return null;M.current=e.sourceEvent?.button;let{onViewportChangeStart:n}=T.getState(),i=g8(e.transform);C.current=!0,$.current=i,e.sourceEvent?.type==="mousedown"&&T.setState({paneDragging:!0}),n?.(i),t?.(e.sourceEvent,i)})},[O,t]),(0,x.useEffect)(()=>{O&&(P&&!C.current?O.on("zoom",null):P||O.on("zoom",t=>{let{onViewportChange:n}=T.getState();if(T.setState({transform:[t.transform.x,t.transform.y,t.transform.k]}),E.current=!!(i&&g9(h,M.current??0)),(e||n)&&!t.sourceEvent?.internal){let i=g8(t.transform);n?.(i),e?.(t.sourceEvent,i)}}))},[P,O,e,h,i]),(0,x.useEffect)(()=>{O&&O.on("end",e=>{if(!e.sourceEvent||e.sourceEvent.internal)return null;let{onViewportChangeEnd:t}=T.getState();if(C.current=!1,T.setState({paneDragging:!1}),i&&g9(h,M.current??0)&&!E.current&&i(e.sourceEvent),E.current=!1,(n||t)&&g5($.current,e.transform)){let i=g8(e.transform);$.current=i,clearTimeout(k.current),k.current=setTimeout(()=>{t?.(i),n?.(e.sourceEvent,i)},150*!!l)}})},[O,l,h,n,i]),(0,x.useEffect)(()=>{O&&O.filter(e=>{let t=D||a,n=s&&e.ctrlKey;if((!0===h||Array.isArray(h)&&h.includes(1))&&1===e.button&&"mousedown"===e.type&&(g7(e,"react-flow__node")||g7(e,"react-flow__edge")))return!0;if(!h&&!t&&!l&&!d&&!s||P||!d&&"dblclick"===e.type||g7(e,_)&&"wheel"===e.type||g7(e,S)&&("wheel"!==e.type||l&&"wheel"===e.type&&!D)||!s&&e.ctrlKey&&"wheel"===e.type||!t&&!l&&!n&&"wheel"===e.type||!h&&("mousedown"===e.type||"touchstart"===e.type)||Array.isArray(h)&&!h.includes(e.button)&&"mousedown"===e.type)return!1;let i=Array.isArray(h)&&h.includes(e.button)||!e.button||e.button<=1;return(!e.ctrlKey||"wheel"===e.type)&&i})},[P,O,a,s,l,d,h,p,D]),x.createElement("div",{className:"react-flow__renderer",ref:I,style:g6},w)},mr=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function mi(){let{userSelectionActive:e,userSelectionRect:t}=h9(mr,uu);return e&&t?x.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function ma(e,t){let n=t.parentNode||t.parentId,i=e.find(e=>e.id===n);if(i){let e=t.position.x+t.width-i.width,n=t.position.y+t.height-i.height;if(e>0||n>0||t.position.x<0||t.position.y<0){if(i.style={...i.style},i.style.width=i.style.width??i.width,i.style.height=i.style.height??i.height,e>0&&(i.style.width+=e),n>0&&(i.style.height+=n),t.position.x<0){let e=Math.abs(t.position.x);i.position.x=i.position.x-e,i.style.width+=e,t.position.x=0}if(t.position.y<0){let e=Math.abs(t.position.y);i.position.y=i.position.y-e,i.style.height+=e,t.position.y=0}i.width=i.style.width,i.height=i.style.height}}}function mo(e,t){if(e.some(e=>"reset"===e.type))return e.filter(e=>"reset"===e.type).map(e=>e.item);let n=e.filter(e=>"add"===e.type).map(e=>e.item);return t.reduce((t,n)=>{let i=e.filter(e=>e.id===n.id);if(0===i.length)return t.push(n),t;let a={...n};for(let e of i)if(e)switch(e.type){case"select":a.selected=e.selected;break;case"position":void 0!==e.position&&(a.position=e.position),void 0!==e.positionAbsolute&&(a.positionAbsolute=e.positionAbsolute),void 0!==e.dragging&&(a.dragging=e.dragging),a.expandParent&&ma(t,a);break;case"dimensions":void 0!==e.dimensions&&(a.width=e.dimensions.width,a.height=e.dimensions.height),void 0!==e.updateStyle&&(a.style={...a.style||{},...e.dimensions}),"boolean"==typeof e.resizing&&(a.resizing=e.resizing),a.expandParent&&ma(t,a);break;case"remove":return t}return t.push(a),t},n)}function ms(e,t){return mo(e,t)}function ml(e,t){return mo(e,t)}let mu=(e,t)=>({id:e,type:"select",selected:t});function mc(e,t){return e.reduce((e,n)=>{let i=t.includes(n.id);return!n.selected&&i?(n.selected=!0,e.push(mu(n.id,!0))):n.selected&&!i&&(n.selected=!1,e.push(mu(n.id,!1))),e},[])}let md=(e,t)=>n=>{n.target===t.current&&e?.(n)},mp=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),mh=(0,x.memo)(({isSelecting:e,selectionMode:t=s.Full,panOnDrag:n,onSelectionStart:i,onSelectionEnd:a,onPaneClick:o,onPaneContextMenu:l,onPaneScroll:u,onPaneMouseEnter:c,onPaneMouseMove:d,onPaneMouseLeave:p,children:h})=>{let f=(0,x.useRef)(null),g=fe(),m=(0,x.useRef)(0),y=(0,x.useRef)(0),b=(0,x.useRef)(),{userSelectionActive:v,elementsSelectable:w,dragging:_}=h9(mp,uu),S=()=>{g.setState({userSelectionActive:!1,userSelectionRect:null}),m.current=0,y.current=0},k=e=>{o?.(e),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},T=e=>{Array.isArray(n)&&n?.includes(2)?e.preventDefault():l?.(e)},C=u?e=>u(e):void 0,E=t=>{let{resetSelectedElements:n,domNode:a}=g.getState();if(b.current=a?.getBoundingClientRect(),!w||!e||0!==t.button||t.target!==f.current||!b.current)return;let{x:o,y:s}=fC(t,b.current);n(),g.setState({userSelectionRect:{width:0,height:0,startX:o,startY:s,x:o,y:s}}),i?.(t)},I=n=>{let{userSelectionRect:i,nodeInternals:a,edges:o,transform:l,onNodesChange:u,onEdgesChange:c,nodeOrigin:d,getNodes:p}=g.getState();if(!e||!b.current||!i)return;g.setState({userSelectionActive:!0,nodesSelectionActive:!1});let h=fC(n,b.current),f=i.startX??0,v=i.startY??0,x={...i,x:h.x<f?h.x:f,y:h.y<v?h.y:v,width:Math.abs(h.x-f),height:Math.abs(h.y-v)},w=p(),_=f8(a,x,l,t===s.Partial,!0,d),S=f7(_,o).map(e=>e.id),k=_.map(e=>e.id);if(m.current!==k.length){m.current=k.length;let e=mc(w,k);e.length&&u?.(e)}if(y.current!==S.length){y.current=S.length;let e=mc(o,S);e.length&&c?.(e)}g.setState({userSelectionRect:x})},$=e=>{if(0!==e.button)return;let{userSelectionRect:t}=g.getState();!v&&t&&e.target===f.current&&k?.(e),g.setState({nodesSelectionActive:m.current>0}),S(),a?.(e)},O=e=>{v&&(g.setState({nodesSelectionActive:m.current>0}),a?.(e)),S()},A=w&&(e||v);return x.createElement("div",{className:l9(["react-flow__pane",{dragging:_,selection:e}]),onClick:A?void 0:md(k,f),onContextMenu:md(T,f),onWheel:md(C,f),onMouseEnter:A?void 0:c,onMouseDown:A?E:void 0,onMouseMove:A?I:d,onMouseUp:A?$:void 0,onMouseLeave:A?O:p,ref:f,style:g6},h,x.createElement(mi,null))});function mf(e,t){let n=e.parentNode||e.parentId;if(!n)return!1;let i=t.get(n);return!!i&&(!!i.selected||mf(i,t))}function mg(e,t,n){let i=e;do{if(i?.matches(t))return!0;if(i===n.current)break;i=i.parentElement}while(i);return!1}function mm(e,t,n,i){return Array.from(e.values()).filter(n=>(n.selected||n.id===i)&&(!n.parentNode||n.parentId||!mf(n,e))&&(n.draggable||t&&void 0===n.draggable)).map(e=>({id:e.id,position:e.position||{x:0,y:0},positionAbsolute:e.positionAbsolute||{x:0,y:0},distance:{x:n.x-(e.positionAbsolute?.x??0),y:n.y-(e.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:e.extent,parentNode:e.parentNode||e.parentId,parentId:e.parentNode||e.parentId,width:e.width,height:e.height,expandParent:e.expandParent}))}function my(e,t){return t&&"parent"!==t?[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]:t}function mb(e,t,n,i,a=[0,0],o){let s=my(e,e.extent||i),l=s,u=e.parentNode||e.parentId;if("parent"!==e.extent||e.expandParent){if(e.extent&&u&&"parent"!==e.extent){let{x:t,y:i}=f6(n.get(u),a).positionAbsolute;l=[[e.extent[0][0]+t,e.extent[0][1]+i],[e.extent[1][0]+t,e.extent[1][1]+i]]}}else if(u&&e.width&&e.height){let t=n.get(u),{x:i,y:o}=f6(t,a).positionAbsolute;l=t&&fv(i)&&fv(o)&&fv(t.width)&&fv(t.height)?[[i+e.width*a[0],o+e.height*a[1]],[i+t.width-e.width+e.width*a[0],o+t.height-e.height+e.height*a[1]]]:l}else o?.("005",h0()),l=s;let c={x:0,y:0};u&&(c=f6(n.get(u),a).positionAbsolute);let d=l&&"parent"!==l?fl(t,l):t;return{position:{x:d.x-c.x,y:d.y-c.y},positionAbsolute:d}}function mv({nodeId:e,dragItems:t,nodeInternals:n}){let i=t.map(e=>({...n.get(e.id),position:e.position,positionAbsolute:e.positionAbsolute}));return[e?i.find(t=>t.id===e):i[0],i]}mh.displayName="Pane";let mx=(e,t,n,i)=>{let a=t.querySelectorAll(e);if(!a||!a.length)return null;let o=Array.from(a),s=t.getBoundingClientRect(),l={x:s.width*i[0],y:s.height*i[1]};return o.map(e=>{let t=e.getBoundingClientRect();return{id:e.getAttribute("data-handleid"),position:e.getAttribute("data-handlepos"),x:(t.left-s.left-l.x)/n,y:(t.top-s.top-l.y)/n,...fo(e)}})};function mw(e,t,n){return void 0===n?n:i=>{let a=t().nodeInternals.get(e);a&&n(i,{...a})}}function m_({id:e,store:t,unselect:n=!1,nodeRef:i}){let{addSelectedNodes:a,unselectNodesAndEdges:o,multiSelectionActive:s,nodeInternals:l,onError:u}=t.getState(),c=l.get(e);c?(t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&s)&&(o({nodes:[c],edges:[]}),requestAnimationFrame(()=>i?.current?.blur())):a([e])):u?.("012",h8(e))}function mS(){let e=fe();return(0,x.useCallback)(({sourceEvent:t})=>{let{transform:n,snapGrid:i,snapToGrid:a}=e.getState(),o=t.touches?t.touches[0].clientX:t.clientX,s=t.touches?t.touches[0].clientY:t.clientY,l={x:(o-n[0])/n[2],y:(s-n[1])/n[2]};return{xSnapped:a?i[0]*Math.round(l.x/i[0]):l.x,ySnapped:a?i[1]*Math.round(l.y/i[1]):l.y,...l}},[])}function mk(e){return(t,n,i)=>e?.(t,i)}function mT({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:i,nodeId:a,isSelectable:o,selectNodesOnDrag:s}){let l=fe(),[u,c]=(0,x.useState)(!1),d=(0,x.useRef)([]),p=(0,x.useRef)({x:null,y:null}),h=(0,x.useRef)(0),f=(0,x.useRef)(null),g=(0,x.useRef)({x:0,y:0}),m=(0,x.useRef)(null),y=(0,x.useRef)(!1),b=(0,x.useRef)(!1),v=(0,x.useRef)(!1),w=mS();return(0,x.useEffect)(()=>{if(e?.current){let u=cq(e.current),x=({x:e,y:t})=>{let{nodeInternals:n,onNodeDrag:i,onSelectionDrag:o,updateNodePositions:s,nodeExtent:u,snapGrid:h,snapToGrid:f,nodeOrigin:g,onError:y}=l.getState();p.current={x:e,y:t};let b=!1,v={x:0,y:0,x2:0,y2:0};if(d.current.length>1&&u&&(v=fh(f5(d.current,g))),d.current=d.current.map(i=>{let a={x:e-i.distance.x,y:t-i.distance.y};f&&(a.x=h[0]*Math.round(a.x/h[0]),a.y=h[1]*Math.round(a.y/h[1]));let o=[[u[0][0],u[0][1]],[u[1][0],u[1][1]]];d.current.length>1&&u&&!i.extent&&(o[0][0]=i.positionAbsolute.x-v.x+u[0][0],o[1][0]=i.positionAbsolute.x+(i.width??0)-v.x2+u[1][0],o[0][1]=i.positionAbsolute.y-v.y+u[0][1],o[1][1]=i.positionAbsolute.y+(i.height??0)-v.y2+u[1][1]);let s=mb(i,a,n,o,g,y);return b=b||i.position.x!==s.position.x||i.position.y!==s.position.y,i.position=s.position,i.positionAbsolute=s.positionAbsolute,i}),!b)return;s(d.current,!0,!0),c(!0);let x=a?i:mk(o);if(x&&m.current){let[e,t]=mv({nodeId:a,dragItems:d.current,nodeInternals:n});x(m.current,e,t)}},_=()=>{if(!f.current)return;let[e,t]=fc(g.current,f.current);if(0!==e||0!==t){let{transform:n,panBy:i}=l.getState();p.current.x=(p.current.x??0)-e/n[2],p.current.y=(p.current.y??0)-t/n[2],i({x:e,y:t})&&x(p.current)}h.current=requestAnimationFrame(_)},S=t=>{let{nodeInternals:n,multiSelectionActive:i,nodesDraggable:u,unselectNodesAndEdges:c,onNodeDragStart:h,onSelectionDragStart:f}=l.getState();b.current=!0;let g=a?h:mk(f);s&&o||i||!a||n.get(a)?.selected||c(),a&&o&&s&&m_({id:a,store:l,nodeRef:e});let m=w(t);if(p.current=m,d.current=mm(n,u,m,a),g&&d.current){let[e,i]=mv({nodeId:a,dragItems:d.current,nodeInternals:n});g(t.sourceEvent,e,i)}};if(t)u.on(".drag",null);else{let t=hX().on("start",e=>{let{domNode:t,nodeDragThreshold:n}=l.getState();0===n&&S(e),v.current=!1,p.current=w(e),f.current=t?.getBoundingClientRect()||null,g.current=fC(e.sourceEvent,f.current)}).on("drag",e=>{let t=w(e),{autoPanOnNodeDrag:n,nodeDragThreshold:i}=l.getState();if("touchmove"===e.sourceEvent.type&&e.sourceEvent.touches.length>1&&(v.current=!0),!v.current){if(!y.current&&b.current&&n&&(y.current=!0,_()),!b.current){let n=t.xSnapped-(p?.current?.x??0),a=t.ySnapped-(p?.current?.y??0);Math.sqrt(n*n+a*a)>i&&S(e)}(p.current.x!==t.xSnapped||p.current.y!==t.ySnapped)&&d.current&&b.current&&(m.current=e.sourceEvent,g.current=fC(e.sourceEvent,f.current),x(t))}}).on("end",e=>{if(b.current&&!v.current&&(c(!1),y.current=!1,b.current=!1,cancelAnimationFrame(h.current),d.current)){let{updateNodePositions:t,nodeInternals:n,onNodeDragStop:i,onSelectionDragStop:o}=l.getState(),s=a?i:mk(o);if(t(d.current,!1,!1),s){let[t,i]=mv({nodeId:a,dragItems:d.current,nodeInternals:n});s(e.sourceEvent,t,i)}}}).filter(t=>{let a=t.target;return!t.button&&(!n||!mg(a,`.${n}`,e))&&(!i||mg(a,i,e))});return u.call(t),()=>{u.on(".drag",null)}}}},[e,t,n,i,o,l,a,s,w]),u}function mC(){let e=fe();return(0,x.useCallback)(t=>{let{nodeInternals:n,nodeExtent:i,updateNodePositions:a,getNodes:o,snapToGrid:s,snapGrid:l,onError:u,nodesDraggable:c}=e.getState(),d=o().filter(e=>e.selected&&(e.draggable||c&&void 0===e.draggable)),p=s?l[0]:5,h=s?l[1]:5,f=t.isShiftPressed?4:1,g=t.x*p*f,m=t.y*h*f;a(d.map(e=>{if(e.positionAbsolute){let t={x:e.positionAbsolute.x+g,y:e.positionAbsolute.y+m};s&&(t.x=l[0]*Math.round(t.x/l[0]),t.y=l[1]*Math.round(t.y/l[1]));let{positionAbsolute:a,position:o}=mb(e,t,n,i,void 0,u);e.position=o,e.positionAbsolute=a}return e}),!0,!1)},[])}let mE={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var mI=e=>{let t=({id:t,type:n,data:i,xPos:a,yPos:o,xPosOrigin:s,yPosOrigin:l,selected:u,onClick:c,onMouseEnter:d,onMouseMove:p,onMouseLeave:h,onContextMenu:f,onDoubleClick:g,style:m,className:y,isDraggable:b,isSelectable:v,isConnectable:w,isFocusable:_,selectNodesOnDrag:S,sourcePosition:k,targetPosition:T,hidden:C,resizeObserver:E,dragHandle:I,zIndex:$,isParent:O,noDragClassName:A,noPanClassName:N,initialized:P,disableKeyboardA11y:D,ariaLabel:M,rfId:z,hasHandleBounds:j})=>{let R=fe(),L=(0,x.useRef)(null),F=(0,x.useRef)(null),B=(0,x.useRef)(k),U=(0,x.useRef)(T),V=(0,x.useRef)(n),G=v||b||c||d||p||h,H=mC(),W=mw(t,R.getState,d),q=mw(t,R.getState,p),K=mw(t,R.getState,h),X=mw(t,R.getState,f),Z=mw(t,R.getState,g),Y=e=>{let{nodeDragThreshold:n}=R.getState();if(v&&(!S||!b||n>0)&&m_({id:t,store:R,nodeRef:L}),c){let n=R.getState().nodeInternals.get(t);n&&c(e,{...n})}},Q=e=>{fk(e)||!D&&(fw.includes(e.key)&&v?m_({id:t,store:R,unselect:"Escape"===e.key,nodeRef:L}):b&&u&&Object.prototype.hasOwnProperty.call(mE,e.key)&&(R.setState({ariaLiveMessage:`Moved selected node ${e.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~a}, y: ${~~o}`}),H({x:mE[e.key].x,y:mE[e.key].y,isShiftPressed:e.shiftKey})))};(0,x.useEffect)(()=>()=>{F.current&&(E?.unobserve(F.current),F.current=null)},[]),(0,x.useEffect)(()=>{if(L.current&&!C){let e=L.current;P&&j&&F.current===e||(F.current&&E?.unobserve(F.current),E?.observe(e),F.current=e)}},[C,P,j]),(0,x.useEffect)(()=>{let e=V.current!==n,i=B.current!==k,a=U.current!==T;L.current&&(e||i||a)&&(e&&(V.current=n),i&&(B.current=k),a&&(U.current=T),R.getState().updateNodeDimensions([{id:t,nodeElement:L.current,forceUpdate:!0}]))},[t,n,k,T]);let J=mT({nodeRef:L,disabled:C||!b,noDragClassName:A,handleSelector:I,nodeId:t,isSelectable:v,selectNodesOnDrag:S});return C?null:x.createElement("div",{className:l9(["react-flow__node",`react-flow__node-${n}`,{[N]:b},y,{selected:u,selectable:v,parent:O,dragging:J}]),ref:L,style:{zIndex:$,transform:`translate(${s}px,${l}px)`,pointerEvents:G?"all":"none",visibility:P?"visible":"hidden",...m},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:W,onMouseMove:q,onMouseLeave:K,onContextMenu:X,onClick:Y,onDoubleClick:Z,onKeyDown:_?Q:void 0,tabIndex:_?0:void 0,role:_?"button":void 0,"aria-describedby":D?void 0:`${gM}-${z}`,"aria-label":M},x.createElement(fZ,{value:t},x.createElement(e,{id:t,data:i,type:n,xPos:a,yPos:o,selected:u,isConnectable:w,sourcePosition:k,targetPosition:T,dragging:J,dragHandle:I,zIndex:$})))};return t.displayName="NodeWrapper",(0,x.memo)(t)};let m$=e=>({...f5(e.getNodes().filter(e=>e.selected),e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive});function mO({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){let i=fe(),{width:a,height:o,x:s,y:l,transformString:u,userSelectionActive:c}=h9(m$,uu),d=mC(),p=(0,x.useRef)(null);if((0,x.useEffect)(()=>{n||p.current?.focus({preventScroll:!0})},[n]),mT({nodeRef:p}),c||!a||!o)return null;let h=e?t=>{e(t,i.getState().getNodes().filter(e=>e.selected))}:void 0,f=e=>{Object.prototype.hasOwnProperty.call(mE,e.key)&&d({x:mE[e.key].x,y:mE[e.key].y,isShiftPressed:e.shiftKey})};return x.createElement("div",{className:l9(["react-flow__nodesselection","react-flow__container",t]),style:{transform:u}},x.createElement("div",{ref:p,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:a,height:o,top:l,left:s}}))}var mA=(0,x.memo)(mO);let mN=e=>e.nodesSelectionActive,mP=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:i,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:s,deleteKeyCode:l,onMove:u,onMoveStart:c,onMoveEnd:d,selectionKeyCode:p,selectionOnDrag:h,selectionMode:f,onSelectionStart:g,onSelectionEnd:m,multiSelectionKeyCode:y,panActivationKeyCode:b,zoomActivationKeyCode:v,elementsSelectable:w,zoomOnScroll:_,zoomOnPinch:S,panOnScroll:k,panOnScrollSpeed:T,panOnScrollMode:C,zoomOnDoubleClick:E,panOnDrag:I,defaultViewport:$,translateExtent:O,minZoom:A,maxZoom:N,preventScrolling:P,onSelectionContextMenu:D,noWheelClassName:M,noPanClassName:z,disableKeyboardA11y:j})=>{let R=h9(mN),L=gB(p),F=gB(b),B=F||I,U=F||k,V=L||h&&!0!==B;return g3({deleteKeyCode:l,multiSelectionKeyCode:y}),x.createElement(mn,{onMove:u,onMoveStart:c,onMoveEnd:d,onPaneContextMenu:o,elementsSelectable:w,zoomOnScroll:_,zoomOnPinch:S,panOnScroll:U,panOnScrollSpeed:T,panOnScrollMode:C,zoomOnDoubleClick:E,panOnDrag:!L&&B,defaultViewport:$,translateExtent:O,minZoom:A,maxZoom:N,zoomActivationKeyCode:v,preventScrolling:P,noWheelClassName:M,noPanClassName:z},x.createElement(mh,{onSelectionStart:g,onSelectionEnd:m,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:i,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:s,panOnDrag:B,isSelecting:!!V,selectionMode:f},e,R&&x.createElement(mA,{onSelectionContextMenu:D,noPanClassName:z,disableKeyboardA11y:j})))};mP.displayName="FlowRenderer";var mD=(0,x.memo)(mP);function mM(e){return h9((0,x.useCallback)(t=>e?f8(t.nodeInternals,{x:0,y:0,width:t.width,height:t.height},t.transform,!0):t.getNodes(),[e]))}function mz(e){let t={input:mI(e.input||gv),default:mI(e.default||gy),output:mI(e.output||gw),group:mI(e.group||g_)},n={},i=Object.keys(e).filter(e=>!["input","default","output","group"].includes(e)).reduce((t,n)=>(t[n]=mI(e[n]||gy),t),n);return{...t,...i}}let mj=({x:e,y:t,width:n,height:i,origin:a})=>!n||!i||a[0]<0||a[1]<0||a[0]>1||a[1]>1?{x:e,y:t}:{x:e-n*a[0],y:t-i*a[1]},mR=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),mL=e=>{let{nodesDraggable:t,nodesConnectable:n,nodesFocusable:i,elementsSelectable:a,updateNodeDimensions:o,onError:s}=h9(mR,uu),l=mM(e.onlyRenderVisibleElements),u=(0,x.useRef)(),d=(0,x.useMemo)(()=>{if("undefined"==typeof ResizeObserver)return null;let e=new ResizeObserver(e=>{o(e.map(e=>({id:e.target.getAttribute("data-id"),nodeElement:e.target,forceUpdate:!0})))});return u.current=e,e},[]);return(0,x.useEffect)(()=>()=>{u?.current?.disconnect()},[]),x.createElement("div",{className:"react-flow__nodes",style:g6},l.map(o=>{let l=o.type||"default";e.nodeTypes[l]||(s?.("003",hQ(l)),l="default");let u=e.nodeTypes[l]||e.nodeTypes.default,p=!!(o.draggable||t&&void 0===o.draggable),h=!!(o.selectable||a&&void 0===o.selectable),f=!!(o.connectable||n&&void 0===o.connectable),g=!!(o.focusable||i&&void 0===o.focusable),m=e.nodeExtent?fl(o.positionAbsolute,e.nodeExtent):o.positionAbsolute,y=m?.x??0,b=m?.y??0,v=mj({x:y,y:b,width:o.width??0,height:o.height??0,origin:e.nodeOrigin});return x.createElement(u,{key:o.id,id:o.id,className:o.className,style:o.style,type:l,data:o.data,sourcePosition:o.sourcePosition||c.Bottom,targetPosition:o.targetPosition||c.Top,hidden:o.hidden,xPos:y,yPos:b,xPosOrigin:v.x,yPosOrigin:v.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!o.selected,isDraggable:p,isSelectable:h,isConnectable:f,isFocusable:g,resizeObserver:d,dragHandle:o.dragHandle,zIndex:o[fx]?.z??0,isParent:!!o[fx]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!o.width&&!!o.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:o.ariaLabel,hasHandleBounds:!!o[fx]?.handleBounds})}))};mL.displayName="NodeRenderer";var mF=(0,x.memo)(mL);let mB=(e,t,n)=>n===c.Left?e-t:n===c.Right?e+t:e,mU=(e,t,n)=>n===c.Top?e-t:n===c.Bottom?e+t:e,mV="react-flow__edgeupdater",mG=({position:e,centerX:t,centerY:n,radius:i=10,onMouseDown:a,onMouseEnter:o,onMouseOut:s,type:l})=>x.createElement("circle",{onMouseDown:a,onMouseEnter:o,onMouseOut:s,className:l9([mV,`${mV}-${l}`]),cx:mB(t,i,e),cy:mU(n,i,e),r:i,stroke:"transparent",fill:"transparent"}),mH=()=>!0;var mW=e=>{let t=({id:t,className:n,type:i,data:a,onClick:o,onEdgeDoubleClick:s,selected:l,animated:u,label:c,labelStyle:d,labelShowBg:p,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:m,source:y,target:b,sourceX:v,sourceY:w,targetX:_,targetY:S,sourcePosition:k,targetPosition:T,elementsSelectable:C,hidden:E,sourceHandleId:I,targetHandleId:$,onContextMenu:O,onMouseEnter:A,onMouseMove:N,onMouseLeave:P,reconnectRadius:D,onReconnect:M,onReconnectStart:z,onReconnectEnd:j,markerEnd:R,markerStart:L,rfId:F,ariaLabel:B,isFocusable:U,isReconnectable:V,pathOptions:G,interactionWidth:H,disableKeyboardA11y:W})=>{let q=(0,x.useRef)(null),[K,X]=(0,x.useState)(!1),[Z,Y]=(0,x.useState)(!1),Q=fe(),J=(0,x.useMemo)(()=>`url('#${f0(L,F)}')`,[L,F]),ee=(0,x.useMemo)(()=>`url('#${f0(R,F)}')`,[R,F]);if(E)return null;let et=e=>{let{edges:n,addSelectedEdges:i,unselectNodesAndEdges:a,multiSelectionActive:s}=Q.getState(),l=n.find(e=>e.id===t);l&&(C&&(Q.setState({nodesSelectionActive:!1}),l.selected&&s?(a({nodes:[],edges:[l]}),q.current?.blur()):i([t])),o&&o(e,l))},en=f$(t,Q.getState,s),er=f$(t,Q.getState,O),ei=f$(t,Q.getState,A),ea=f$(t,Q.getState,N),eo=f$(t,Q.getState,P),es=(e,n)=>{if(0!==e.button)return;let{edges:i,isValidConnection:a}=Q.getState(),o=n?b:y,s=(n?$:I)||null,l=n?"target":"source",u=a||mH,c=n,d=i.find(e=>e.id===t);Y(!0),z?.(e,d,l);let p=e=>{Y(!1),j?.(e,d,l)};gc({event:e,handleId:s,nodeId:o,onConnect:e=>M?.(d,e),isTarget:c,getState:Q.getState,setState:Q.setState,isValidConnection:u,edgeUpdaterType:l,onReconnectEnd:p})},el=e=>es(e,!0),eu=e=>es(e,!1),ec=()=>X(!0),ed=()=>X(!1),ep=!C&&!o,eh=e=>{if(!W&&fw.includes(e.key)&&C){let{unselectNodesAndEdges:n,addSelectedEdges:i,edges:a}=Q.getState();"Escape"===e.key?(q.current?.blur(),n({edges:[a.find(e=>e.id===t)]})):i([t])}};return x.createElement("g",{className:l9(["react-flow__edge",`react-flow__edge-${i}`,n,{selected:l,animated:u,inactive:ep,updating:K}]),onClick:et,onDoubleClick:en,onContextMenu:er,onMouseEnter:ei,onMouseMove:ea,onMouseLeave:eo,onKeyDown:U?eh:void 0,tabIndex:U?0:void 0,role:U?"button":"img","data-testid":`rf__edge-${t}`,"aria-label":null===B?void 0:B||`Edge from ${y} to ${b}`,"aria-describedby":U?`${gz}-${F}`:void 0,ref:q},!Z&&x.createElement(e,{id:t,source:y,target:b,selected:l,animated:u,label:c,labelStyle:d,labelShowBg:p,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,data:a,style:m,sourceX:v,sourceY:w,targetX:_,targetY:S,sourcePosition:k,targetPosition:T,sourceHandleId:I,targetHandleId:$,markerStart:J,markerEnd:ee,pathOptions:G,interactionWidth:H}),V&&x.createElement(x.Fragment,null,("source"===V||!0===V)&&x.createElement(mG,{position:k,centerX:v,centerY:w,radius:D,onMouseDown:el,onMouseEnter:ec,onMouseOut:ed,type:"source"}),("target"===V||!0===V)&&x.createElement(mG,{position:T,centerX:_,centerY:S,radius:D,onMouseDown:eu,onMouseEnter:ec,onMouseOut:ed,type:"target"})))};return t.displayName="EdgeWrapper",(0,x.memo)(t)};function mq(e){let t={default:mW(e.default||fK),straight:mW(e.bezier||fG),step:mW(e.step||fU),smoothstep:mW(e.step||fB),simplebezier:mW(e.simplebezier||fD)},n={},i=Object.keys(e).filter(e=>!["default","bezier"].includes(e)).reduce((t,n)=>(t[n]=mW(e[n]||fK),t),n);return{...t,...i}}function mK(e,t,n=null){let i=(n?.x||0)+t.x,a=(n?.y||0)+t.y,o=n?.width||t.width,s=n?.height||t.height;switch(e){case c.Top:return{x:i+o/2,y:a};case c.Right:return{x:i+o,y:a+s/2};case c.Bottom:return{x:i+o/2,y:a+s};case c.Left:return{x:i,y:a+s/2}}}function mX(e,t){return e?1!==e.length&&t?t&&e.find(e=>e.id===t)||null:e[0]:null}let mZ=(e,t,n,i,a,o)=>{let s=mK(n,e,t),l=mK(o,i,a);return{sourceX:s.x,sourceY:s.y,targetX:l.x,targetY:l.y}};function mY({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:i,targetWidth:a,targetHeight:o,width:s,height:l,transform:u}){let c={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+a),y2:Math.max(e.y+i,t.y+o)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);let d=fh({x:(0-u[0])/u[2],y:(0-u[1])/u[2],width:s/u[2],height:l/u[2]});return Math.ceil(Math.max(0,Math.min(d.x2,c.x2)-Math.max(d.x,c.x))*Math.max(0,Math.min(d.y2,c.y2)-Math.max(d.y,c.y)))>0}function mQ(e){let t=e?.[fx]?.handleBounds||null,n=t&&e?.width&&e?.height&&void 0!==e?.positionAbsolute?.x&&void 0!==e?.positionAbsolute?.y;return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},t,!!n]}let mJ=[{level:0,isMaxLevel:!0,edges:[]}];function m0(e,t,n=!1){let i=-1,a=Object.entries(e.reduce((e,a)=>{let o=fv(a.zIndex),s=o?a.zIndex:0;if(n){let e=t.get(a.target),n=t.get(a.source),i=a.selected||e?.selected||n?.selected,l=Math.max(n?.[fx]?.z||0,e?.[fx]?.z||0,1e3);s=(o?a.zIndex:0)+(i?l:0)}return e[s]?e[s].push(a):e[s]=[a],i=s>i?s:i,e},{})).map(([e,t])=>{let n=+e;return{edges:t,level:n,isMaxLevel:n===i}});return 0===a.length?mJ:a}function m1(e,t,n){return m0(h9((0,x.useCallback)(n=>e?n.edges.filter(e=>{let i=t.get(e.source),a=t.get(e.target);return i?.width&&i?.height&&a?.width&&a?.height&&mY({sourcePos:i.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:i.width,sourceHeight:i.height,targetWidth:a.width,targetHeight:a.height,width:n.width,height:n.height,transform:n.transform})}):n.edges,[e,t])),t,n)}let m2=({color:e="none",strokeWidth:t=1})=>x.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),m3=({color:e="none",strokeWidth:t=1})=>x.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),m4={[u.Arrow]:m2,[u.ArrowClosed]:m3};function m6(e){let t=fe();return(0,x.useMemo)(()=>Object.prototype.hasOwnProperty.call(m4,e)?m4[e]:(t.getState().onError?.("009",h3(e)),null),[e])}let m5=({id:e,type:t,color:n,width:i=12.5,height:a=12.5,markerUnits:o="strokeWidth",strokeWidth:s,orient:l="auto-start-reverse"})=>{let u=m6(t);return u?x.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${i}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:l,refX:"0",refY:"0"},x.createElement(u,{color:n,strokeWidth:s})):null},m8=({defaultColor:e,rfId:t})=>n=>{let i=[];return n.edges.reduce((n,a)=>([a.markerStart,a.markerEnd].forEach(a=>{if(a&&"object"==typeof a){let o=f0(a,t);i.includes(o)||(n.push({id:o,color:a.color||e,...a}),i.push(o))}}),n),[]).sort((e,t)=>e.id.localeCompare(t.id))},m7=({defaultColor:e,rfId:t})=>{let n=h9((0,x.useCallback)(m8({defaultColor:e,rfId:t}),[e,t]),(e,t)=>!(e.length!==t.length||e.some((e,n)=>e.id!==t[n].id)));return x.createElement("defs",null,n.map(e=>x.createElement(m5,{id:e.id,key:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient})))};m7.displayName="MarkerDefinitions";var m9=(0,x.memo)(m7);let ye=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),yt=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:i,edgeTypes:o,noPanClassName:s,onEdgeContextMenu:l,onEdgeMouseEnter:u,onEdgeMouseMove:d,onEdgeMouseLeave:p,onEdgeClick:h,onEdgeDoubleClick:f,onReconnect:g,onReconnectStart:m,onReconnectEnd:y,reconnectRadius:b,children:v,disableKeyboardA11y:w})=>{let{edgesFocusable:_,edgesUpdatable:S,elementsSelectable:k,width:T,height:C,connectionMode:E,nodeInternals:I,onError:$}=h9(ye,uu),O=m1(t,I,n);return T?x.createElement(x.Fragment,null,O.map(({level:t,edges:n,isMaxLevel:v})=>x.createElement("svg",{key:t,style:{zIndex:t},width:T,height:C,className:"react-flow__edges react-flow__container"},v&&x.createElement(m9,{defaultColor:e,rfId:i}),x.createElement("g",null,n.map(e=>{let[t,n,v]=mQ(I.get(e.source)),[T,C,O]=mQ(I.get(e.target));if(!v||!O)return null;let A=e.type||"default";o[A]||($?.("011",h5(A)),A="default");let N=o[A]||o.default,P=E===a.Strict?C.target:(C.target??[]).concat(C.source??[]),D=mX(n.source,e.sourceHandle),M=mX(P,e.targetHandle),z=D?.position||c.Bottom,j=M?.position||c.Top,R=!!(e.focusable||_&&void 0===e.focusable),L=e.reconnectable||e.updatable,F=void 0!==g&&(L||S&&void 0===L);if(!D||!M)return $?.("008",h4(D,e)),null;let{sourceX:B,sourceY:U,targetX:V,targetY:G}=mZ(t,D,z,T,M,j);return x.createElement(N,{key:e.id,id:e.id,className:l9([e.className,s]),type:A,data:e.data,selected:!!e.selected,animated:!!e.animated,hidden:!!e.hidden,label:e.label,labelStyle:e.labelStyle,labelShowBg:e.labelShowBg,labelBgStyle:e.labelBgStyle,labelBgPadding:e.labelBgPadding,labelBgBorderRadius:e.labelBgBorderRadius,style:e.style,source:e.source,target:e.target,sourceHandleId:e.sourceHandle,targetHandleId:e.targetHandle,markerEnd:e.markerEnd,markerStart:e.markerStart,sourceX:B,sourceY:U,targetX:V,targetY:G,sourcePosition:z,targetPosition:j,elementsSelectable:k,onContextMenu:l,onMouseEnter:u,onMouseMove:d,onMouseLeave:p,onClick:h,onEdgeDoubleClick:f,onReconnect:g,onReconnectStart:m,onReconnectEnd:y,reconnectRadius:b,rfId:i,ariaLabel:e.ariaLabel,isFocusable:R,isReconnectable:F,pathOptions:"pathOptions"in e?e.pathOptions:void 0,interactionWidth:e.interactionWidth,disableKeyboardA11y:w})})))),v):null};yt.displayName="EdgeRenderer";var yn=(0,x.memo)(yt);let yr=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function yi({children:e}){let t=h9(yr);return x.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function ya(e){let t=g1(),n=(0,x.useRef)(!1);(0,x.useEffect)(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}let yo={[c.Left]:c.Right,[c.Right]:c.Left,[c.Top]:c.Bottom,[c.Bottom]:c.Top},ys=({nodeId:e,handleType:t,style:n,type:i=l.Bezier,CustomComponent:o,connectionStatus:s})=>{let{fromNode:u,handleId:c,toX:d,toY:p,connectionMode:h}=h9((0,x.useCallback)(t=>({fromNode:t.nodeInternals.get(e),handleId:t.connectionHandleId,toX:(t.connectionPosition.x-t.transform[0])/t.transform[2],toY:(t.connectionPosition.y-t.transform[1])/t.transform[2],connectionMode:t.connectionMode}),[e]),uu),f=u?.[fx]?.handleBounds,g=f?.[t];if(h===a.Loose&&(g=g||f?.["source"===t?"target":"source"]),!u||!g)return null;let m=c?g.find(e=>e.id===c):g[0],y=m?m.x+m.width/2:(u.width??0)/2,b=m?m.y+m.height/2:u.height??0,v=(u.positionAbsolute?.x??0)+y,w=(u.positionAbsolute?.y??0)+b,_=m?.position,S=_?yo[_]:null;if(!_||!S)return null;if(o)return x.createElement(o,{connectionLineType:i,connectionLineStyle:n,fromNode:u,fromHandle:m,fromX:v,fromY:w,toX:d,toY:p,fromPosition:_,toPosition:S,connectionStatus:s});let k="",T={sourceX:v,sourceY:w,sourcePosition:_,targetX:d,targetY:p,targetPosition:S};return i===l.Bezier?[k]=fq(T):i===l.Step?[k]=fF({...T,borderRadius:0}):i===l.SmoothStep?[k]=fF(T):i===l.SimpleBezier?[k]=fP(T):k=`M${v},${w} ${d},${p}`,x.createElement("path",{d:k,fill:"none",className:"react-flow__connection-path",style:n})};ys.displayName="ConnectionLine";let yl=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function yu({containerStyle:e,style:t,type:n,component:i}){let{nodeId:a,handleType:o,nodesConnectable:s,width:l,height:u,connectionStatus:c}=h9(yl,uu);return a&&o&&l&&s?x.createElement("svg",{style:e,width:l,height:u,className:"react-flow__edges react-flow__connectionline react-flow__container"},x.createElement("g",{className:l9(["react-flow__connection",c])},x.createElement(ys,{nodeId:a,handleType:o,style:t,type:n,CustomComponent:i,connectionStatus:c}))):null}function yc(e,t){return(0,x.useRef)(null),fe(),(0,x.useMemo)(()=>t(e),[e])}let yd=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:i,onMoveEnd:a,onInit:o,onNodeClick:s,onEdgeClick:l,onNodeDoubleClick:u,onEdgeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:p,onNodeMouseLeave:h,onNodeContextMenu:f,onSelectionContextMenu:g,onSelectionStart:m,onSelectionEnd:y,connectionLineType:b,connectionLineStyle:v,connectionLineComponent:w,connectionLineContainerStyle:_,selectionKeyCode:S,selectionOnDrag:k,selectionMode:T,multiSelectionKeyCode:C,panActivationKeyCode:E,zoomActivationKeyCode:I,deleteKeyCode:$,onlyRenderVisibleElements:O,elementsSelectable:A,selectNodesOnDrag:N,defaultViewport:P,translateExtent:D,minZoom:M,maxZoom:z,preventScrolling:j,defaultMarkerColor:R,zoomOnScroll:L,zoomOnPinch:F,panOnScroll:B,panOnScrollSpeed:U,panOnScrollMode:V,zoomOnDoubleClick:G,panOnDrag:H,onPaneClick:W,onPaneMouseEnter:q,onPaneMouseMove:K,onPaneMouseLeave:X,onPaneScroll:Z,onPaneContextMenu:Y,onEdgeContextMenu:Q,onEdgeMouseEnter:J,onEdgeMouseMove:ee,onEdgeMouseLeave:et,onReconnect:en,onReconnectStart:er,onReconnectEnd:ei,reconnectRadius:ea,noDragClassName:eo,noWheelClassName:es,noPanClassName:el,elevateEdgesOnSelect:eu,disableKeyboardA11y:ec,nodeOrigin:ed,nodeExtent:ep,rfId:eh})=>{let ef=yc(e,mz),eg=yc(t,mq);return ya(o),x.createElement(mD,{onPaneClick:W,onPaneMouseEnter:q,onPaneMouseMove:K,onPaneMouseLeave:X,onPaneContextMenu:Y,onPaneScroll:Z,deleteKeyCode:$,selectionKeyCode:S,selectionOnDrag:k,selectionMode:T,onSelectionStart:m,onSelectionEnd:y,multiSelectionKeyCode:C,panActivationKeyCode:E,zoomActivationKeyCode:I,elementsSelectable:A,onMove:n,onMoveStart:i,onMoveEnd:a,zoomOnScroll:L,zoomOnPinch:F,zoomOnDoubleClick:G,panOnScroll:B,panOnScrollSpeed:U,panOnScrollMode:V,panOnDrag:H,defaultViewport:P,translateExtent:D,minZoom:M,maxZoom:z,onSelectionContextMenu:g,preventScrolling:j,noDragClassName:eo,noWheelClassName:es,noPanClassName:el,disableKeyboardA11y:ec},x.createElement(yi,null,x.createElement(yn,{edgeTypes:eg,onEdgeClick:l,onEdgeDoubleClick:c,onlyRenderVisibleElements:O,onEdgeContextMenu:Q,onEdgeMouseEnter:J,onEdgeMouseMove:ee,onEdgeMouseLeave:et,onReconnect:en,onReconnectStart:er,onReconnectEnd:ei,reconnectRadius:ea,defaultMarkerColor:R,noPanClassName:el,elevateEdgesOnSelect:!!eu,disableKeyboardA11y:ec,rfId:eh},x.createElement(yu,{style:v,type:b,component:w,containerStyle:_})),x.createElement("div",{className:"react-flow__edgelabel-renderer"}),x.createElement(mF,{nodeTypes:ef,onNodeClick:s,onNodeDoubleClick:u,onNodeMouseEnter:d,onNodeMouseMove:p,onNodeMouseLeave:h,onNodeContextMenu:f,selectNodesOnDrag:N,onlyRenderVisibleElements:O,noPanClassName:el,noDragClassName:eo,disableKeyboardA11y:ec,nodeOrigin:ed,nodeExtent:ep,rfId:eh})))};yd.displayName="GraphView";var yp=(0,x.memo)(yd);let yh=[[-1/0,-1/0],[1/0,1/0]],yf={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:yh,nodeExtent:yh,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:a.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:f_,isValidConnection:void 0},yg=()=>ul((e,t)=>({...yf,setNodes:n=>{let{nodeInternals:i,nodeOrigin:a,elevateNodesOnSelect:o}=t();e({nodeInternals:gW(n,i,a,o)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{let{defaultEdgeOptions:i={}}=t();e({edges:n.map(e=>({...i,...e}))})},setDefaultNodesAndEdges:(n,i)=>{let a=void 0!==n,o=void 0!==i;e({nodeInternals:a?gW(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map,edges:o?i:[],hasDefaultNodes:a,hasDefaultEdges:o})},updateNodeDimensions:n=>{let{onNodesChange:i,nodeInternals:a,fitViewOnInit:o,fitViewOnInitDone:s,fitViewOnInitOptions:l,domNode:u,nodeOrigin:c}=t(),d=u?.querySelector(".react-flow__viewport");if(!d)return;let p=window.getComputedStyle(d),{m22:h}=new window.DOMMatrixReadOnly(p.transform),f=n.reduce((e,t)=>{let n=a.get(t.id);if(n?.hidden)a.set(n.id,{...n,[fx]:{...n[fx],handleBounds:void 0}});else if(n){let i=fo(t.nodeElement);i.width&&i.height&&(n.width!==i.width||n.height!==i.height||t.forceUpdate)&&(a.set(n.id,{...n,[fx]:{...n[fx],handleBounds:{source:mx(".source",t.nodeElement,h,c),target:mx(".target",t.nodeElement,h,c)}},...i}),e.push({id:n.id,type:"dimensions",dimensions:i}))}return e},[]);gH(a,c);let g=s||o&&!s&&gq(t,{initial:!0,...l});e({nodeInternals:new Map(a),fitViewOnInitDone:g}),f?.length>0&&i?.(f)},updateNodePositions:(e,n=!0,i=!1)=>{let{triggerNodeChanges:a}=t();a(e.map(e=>{let t={id:e.id,type:"position",dragging:i};return n&&(t.positionAbsolute=e.positionAbsolute,t.position=e.position),t}))},triggerNodeChanges:n=>{let{onNodesChange:i,nodeInternals:a,hasDefaultNodes:o,nodeOrigin:s,getNodes:l,elevateNodesOnSelect:u}=t();n?.length&&(o&&e({nodeInternals:gW(ms(n,l()),a,s,u)}),i?.(n))},addSelectedNodes:n=>{let i,{multiSelectionActive:a,edges:o,getNodes:s}=t(),l=null;a?i=n.map(e=>mu(e,!0)):(i=mc(s(),n),l=mc(o,[])),gZ({changedNodes:i,changedEdges:l,get:t,set:e})},addSelectedEdges:n=>{let i,{multiSelectionActive:a,edges:o,getNodes:s}=t(),l=null;a?i=n.map(e=>mu(e,!0)):(i=mc(o,n),l=mc(s(),[])),gZ({changedNodes:l,changedEdges:i,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:i}={})=>{let{edges:a,getNodes:o}=t(),s=n||o(),l=i||a;gZ({changedNodes:s.map(e=>(e.selected=!1,mu(e.id,!1))),changedEdges:l.map(e=>mu(e.id,!1)),get:t,set:e})},setMinZoom:n=>{let{d3Zoom:i,maxZoom:a}=t();i?.scaleExtent([n,a]),e({minZoom:n})},setMaxZoom:n=>{let{d3Zoom:i,minZoom:a}=t();i?.scaleExtent([a,n]),e({maxZoom:n})},setTranslateExtent:n=>{t().d3Zoom?.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{let{edges:n,getNodes:i}=t();gZ({changedNodes:i().filter(e=>e.selected).map(e=>mu(e.id,!1)),changedEdges:n.filter(e=>e.selected).map(e=>mu(e.id,!1)),get:t,set:e})},setNodeExtent:n=>{let{nodeInternals:i}=t();i.forEach(e=>{e.positionAbsolute=fl(e.position,n)}),e({nodeExtent:n,nodeInternals:new Map(i)})},panBy:e=>{let{transform:n,width:i,height:a,d3Zoom:o,d3Selection:s,translateExtent:l}=t();if(!o||!s||!e.x&&!e.y)return!1;let u=hP.translate(n[0]+e.x,n[1]+e.y).scale(n[2]),c=[[0,0],[i,a]],d=o?.constrain()(u,c,l);return o.transform(s,d),n[0]!==d.x||n[1]!==d.y||n[2]!==d.k},cancelConnection:()=>e({connectionNodeId:yf.connectionNodeId,connectionHandleId:yf.connectionHandleId,connectionHandleType:yf.connectionHandleType,connectionStatus:yf.connectionStatus,connectionStartHandle:yf.connectionStartHandle,connectionEndHandle:yf.connectionEndHandle}),reset:()=>e({...yf})}),Object.is),ym=({children:e})=>{let t=(0,x.useRef)(null);return t.current||(t.current=yg()),x.createElement(hY,{value:t.current},e)};ym.displayName="ReactFlowProvider";let yy=({children:e})=>(0,x.useContext)(hZ)?x.createElement(x.Fragment,null,e):x.createElement(ym,null,e);yy.displayName="ReactFlowWrapper";let yb={input:gv,default:gy,output:gw,group:g_},yv={default:fK,straight:fG,step:fU,smoothstep:fB,simplebezier:fD},yx=[0,0],yw=[15,15],y_={x:0,y:0,zoom:1},yS={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},yk=(0,x.forwardRef)(({nodes:e,edges:t,defaultNodes:n,defaultEdges:i,className:u,nodeTypes:c=yb,edgeTypes:d=yv,onNodeClick:p,onEdgeClick:h,onInit:f,onMove:g,onMoveStart:m,onMoveEnd:y,onConnect:b,onConnectStart:v,onConnectEnd:w,onClickConnectStart:_,onClickConnectEnd:S,onNodeMouseEnter:k,onNodeMouseMove:T,onNodeMouseLeave:C,onNodeContextMenu:E,onNodeDoubleClick:I,onNodeDragStart:$,onNodeDrag:O,onNodeDragStop:A,onNodesDelete:N,onEdgesDelete:P,onSelectionChange:D,onSelectionDragStart:M,onSelectionDrag:z,onSelectionDragStop:j,onSelectionContextMenu:R,onSelectionStart:L,onSelectionEnd:F,connectionMode:B=a.Strict,connectionLineType:U=l.Bezier,connectionLineStyle:V,connectionLineComponent:G,connectionLineContainerStyle:H,deleteKeyCode:W="Backspace",selectionKeyCode:q="Shift",selectionOnDrag:K=!1,selectionMode:X=s.Full,panActivationKeyCode:Z="Space",multiSelectionKeyCode:Y=fE()?"Meta":"Control",zoomActivationKeyCode:Q=fE()?"Meta":"Control",snapToGrid:J=!1,snapGrid:ee=yw,onlyRenderVisibleElements:et=!1,selectNodesOnDrag:en=!0,nodesDraggable:er,nodesConnectable:ei,nodesFocusable:ea,nodeOrigin:eo=yx,edgesFocusable:es,edgesUpdatable:el,elementsSelectable:eu,defaultViewport:ec=y_,minZoom:ed=.5,maxZoom:ep=2,translateExtent:eh=yh,preventScrolling:ef=!0,nodeExtent:eg,defaultMarkerColor:em="#b1b1b7",zoomOnScroll:ey=!0,zoomOnPinch:eb=!0,panOnScroll:ev=!1,panOnScrollSpeed:ex=.5,panOnScrollMode:ew=o.Free,zoomOnDoubleClick:e_=!0,panOnDrag:eS=!0,onPaneClick:ek,onPaneMouseEnter:eT,onPaneMouseMove:eC,onPaneMouseLeave:eE,onPaneScroll:eI,onPaneContextMenu:e$,children:eO,onEdgeContextMenu:eA,onEdgeDoubleClick:eN,onEdgeMouseEnter:eP,onEdgeMouseMove:eD,onEdgeMouseLeave:eM,onEdgeUpdate:ez,onEdgeUpdateStart:ej,onEdgeUpdateEnd:eR,onReconnect:eL,onReconnectStart:eF,onReconnectEnd:eB,reconnectRadius:eU=10,edgeUpdaterRadius:eV=10,onNodesChange:eG,onEdgesChange:eH,noDragClassName:eW="nodrag",noWheelClassName:eq="nowheel",noPanClassName:eK="nopan",fitView:eX=!1,fitViewOptions:eZ,connectOnClick:eY=!0,attributionPosition:eQ,proOptions:eJ,defaultEdgeOptions:e0,elevateNodesOnSelect:e1=!0,elevateEdgesOnSelect:e2=!1,disableKeyboardA11y:e3=!1,autoPanOnConnect:e4=!0,autoPanOnNodeDrag:e6=!0,connectionRadius:e5=20,isValidConnection:e8,onError:e7,style:e9,id:te,nodeDragThreshold:tt,...tn},tr)=>{let ti=te||"1";return x.createElement("div",{...tn,style:{...e9,...yS},ref:tr,className:l9(["react-flow",u]),"data-testid":"rf__wrapper",id:te},x.createElement(yy,null,x.createElement(yp,{onInit:f,onMove:g,onMoveStart:m,onMoveEnd:y,onNodeClick:p,onEdgeClick:h,onNodeMouseEnter:k,onNodeMouseMove:T,onNodeMouseLeave:C,onNodeContextMenu:E,onNodeDoubleClick:I,nodeTypes:c,edgeTypes:d,connectionLineType:U,connectionLineStyle:V,connectionLineComponent:G,connectionLineContainerStyle:H,selectionKeyCode:q,selectionOnDrag:K,selectionMode:X,deleteKeyCode:W,multiSelectionKeyCode:Y,panActivationKeyCode:Z,zoomActivationKeyCode:Q,onlyRenderVisibleElements:et,selectNodesOnDrag:en,defaultViewport:ec,translateExtent:eh,minZoom:ed,maxZoom:ep,preventScrolling:ef,zoomOnScroll:ey,zoomOnPinch:eb,zoomOnDoubleClick:e_,panOnScroll:ev,panOnScrollSpeed:ex,panOnScrollMode:ew,panOnDrag:eS,onPaneClick:ek,onPaneMouseEnter:eT,onPaneMouseMove:eC,onPaneMouseLeave:eE,onPaneScroll:eI,onPaneContextMenu:e$,onSelectionContextMenu:R,onSelectionStart:L,onSelectionEnd:F,onEdgeContextMenu:eA,onEdgeDoubleClick:eN,onEdgeMouseEnter:eP,onEdgeMouseMove:eD,onEdgeMouseLeave:eM,onReconnect:eL??ez,onReconnectStart:eF??ej,onReconnectEnd:eB??eR,reconnectRadius:eU??eV,defaultMarkerColor:em,noDragClassName:eW,noWheelClassName:eq,noPanClassName:eK,elevateEdgesOnSelect:e2,rfId:ti,disableKeyboardA11y:e3,nodeOrigin:eo,nodeExtent:eg}),x.createElement(gN,{nodes:e,edges:t,defaultNodes:n,defaultEdges:i,onConnect:b,onConnectStart:v,onConnectEnd:w,onClickConnectStart:_,onClickConnectEnd:S,nodesDraggable:er,nodesConnectable:ei,nodesFocusable:ea,edgesFocusable:es,edgesUpdatable:el,elementsSelectable:eu,elevateNodesOnSelect:e1,minZoom:ed,maxZoom:ep,nodeExtent:eg,onNodesChange:eG,onEdgesChange:eH,snapToGrid:J,snapGrid:ee,connectionMode:B,translateExtent:eh,connectOnClick:eY,defaultEdgeOptions:e0,fitView:eX,fitViewOptions:eZ,onNodesDelete:N,onEdgesDelete:P,onNodeDragStart:$,onNodeDrag:O,onNodeDragStop:A,onSelectionDrag:z,onSelectionDragStart:M,onSelectionDragStop:j,noPanClassName:eK,nodeOrigin:eo,rfId:ti,autoPanOnConnect:e4,autoPanOnNodeDrag:e6,onError:e7,connectionRadius:e5,isValidConnection:e8,nodeDragThreshold:tt}),x.createElement(gI,{onSelectionChange:D}),eO,x.createElement(fr,{proOptions:eJ,position:eQ}),x.createElement(gF,{rfId:ti,disableKeyboardA11y:e3})))});yk.displayName="ReactFlow";function yT(e){return t=>{let[n,i]=(0,x.useState)(t),a=(0,x.useCallback)(t=>i(n=>e(t,n)),[]);return[n,i,a]}}yT(ms),yT(ml);function yC({color:e,dimensions:t,lineWidth:n}){return x.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function yE({color:e,radius:t}){return x.createElement("circle",{cx:t,cy:t,r:t,fill:e})}!function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"}(d||(d={}));let yI={[d.Dots]:"#91919a",[d.Lines]:"#eee",[d.Cross]:"#e2e2e2"},y$={[d.Dots]:1,[d.Lines]:1,[d.Cross]:6},yO=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function yA({id:e,variant:t=d.Dots,gap:n=20,size:i,lineWidth:a=1,offset:o=2,color:s,style:l,className:u}){let c=(0,x.useRef)(null),{transform:p,patternId:h}=h9(yO,uu),f=s||yI[t],g=i||y$[t],m=t===d.Dots,y=t===d.Cross,b=Array.isArray(n)?n:[n,n],v=[b[0]*p[2]||1,b[1]*p[2]||1],w=g*p[2],_=y?[w,w]:v,S=m?[w/o,w/o]:[_[0]/o,_[1]/o];return x.createElement("svg",{className:l9(["react-flow__background",u]),style:{...l,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:c,"data-testid":"rf__background"},x.createElement("pattern",{id:h+e,x:p[0]%v[0],y:p[1]%v[1],width:v[0],height:v[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${S[0]},-${S[1]})`},m?x.createElement(yE,{color:f,radius:w/o}):x.createElement(yC,{dimensions:_,color:f,lineWidth:a})),x.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${h+e})`}))}yA.displayName="Background";var yN=(0,x.memo)(yA);function yP(){return x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},x.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function yD(){return x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},x.createElement("path",{d:"M0 0h32v4.2H0z"}))}function yM(){return x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},x.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function yz(){return x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},x.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function yj(){return x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},x.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}let yR=({children:e,className:t,...n})=>x.createElement("button",{type:"button",className:l9(["react-flow__controls-button",t]),...n},e);yR.displayName="ControlButton";let yL=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),yF=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:i=!0,fitViewOptions:a,onZoomIn:o,onZoomOut:s,onFitView:l,onInteractiveChange:u,className:c,children:d,position:p="bottom-left"})=>{let h=fe(),[f,g]=(0,x.useState)(!1),{isInteractive:m,minZoomReached:y,maxZoomReached:b}=h9(yL,uu),{zoomIn:v,zoomOut:w,fitView:_}=g1();if((0,x.useEffect)(()=>{g(!0)},[]),!f)return null;let S=()=>{v(),o?.()},k=()=>{w(),s?.()},T=()=>{_(a),l?.()},C=()=>{h.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),u?.(!m)};return x.createElement(fn,{className:l9(["react-flow__controls",c]),position:p,style:e,"data-testid":"rf__controls"},t&&x.createElement(x.Fragment,null,x.createElement(yR,{onClick:S,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b},x.createElement(yP,null)),x.createElement(yR,{onClick:k,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:y},x.createElement(yD,null))),n&&x.createElement(yR,{className:"react-flow__controls-fitview",onClick:T,title:"fit view","aria-label":"fit view"},x.createElement(yM,null)),i&&x.createElement(yR,{className:"react-flow__controls-interactive",onClick:C,title:"toggle interactivity","aria-label":"toggle interactivity"},m?x.createElement(yj,null):x.createElement(yz,null)),d)};yF.displayName="Controls";var yB=(0,x.memo)(yF);let yU=({id:e,x:t,y:n,width:i,height:a,style:o,color:s,strokeColor:l,strokeWidth:u,className:c,borderRadius:d,shapeRendering:p,onClick:h,selected:f})=>{let{background:g,backgroundColor:m}=o||{},y=s||g||m;return x.createElement("rect",{className:l9(["react-flow__minimap-node",{selected:f},c]),x:t,y:n,rx:d,ry:d,width:i,height:a,fill:y,stroke:l,strokeWidth:u,shapeRendering:p,onClick:h?t=>h(t,e):void 0})};yU.displayName="MiniMapNode";var yV=(0,x.memo)(yU);let yG=e=>e.nodeOrigin,yH=e=>e.getNodes().filter(e=>!e.hidden&&e.width&&e.height),yW=e=>e instanceof Function?e:()=>e;function yq({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:i=5,nodeStrokeWidth:a=2,nodeComponent:o=yV,onClick:s}){let l=h9(yH,uu),u=h9(yG),c=yW(t),d=yW(e),p=yW(n),h="undefined"==typeof window||window.chrome?"crispEdges":"geometricPrecision";return x.createElement(x.Fragment,null,l.map(e=>{let{x:t,y:n}=f6(e,u).positionAbsolute;return x.createElement(o,{key:e.id,x:t,y:n,width:e.width,height:e.height,style:e.style,selected:e.selected,className:p(e),color:c(e),borderRadius:i,strokeColor:d(e),strokeWidth:a,shapeRendering:h,onClick:s,id:e.id})}))}var yK=(0,x.memo)(yq);let yX=200,yZ=150,yY=e=>{let t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?fm(f5(t,e.nodeOrigin),n):n,rfId:e.rfId}},yQ="react-flow__minimap-desc";function yJ({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:i="#e2e2e2",nodeClassName:a="",nodeBorderRadius:o=5,nodeStrokeWidth:s=2,nodeComponent:l,maskColor:u="rgb(240, 240, 240, 0.6)",maskStrokeColor:c="none",maskStrokeWidth:d=1,position:p="bottom-right",onClick:h,onNodeClick:f,pannable:g=!1,zoomable:m=!1,ariaLabel:y="React Flow mini map",inversePan:b=!1,zoomStep:v=10,offsetScale:w=5}){let _=fe(),S=(0,x.useRef)(null),{boundingRect:k,viewBB:T,rfId:C}=h9(yY,uu),E=e?.width??yX,I=e?.height??yZ,$=Math.max(k.width/E,k.height/I),O=$*E,A=$*I,N=w*$,P=k.x-(O-k.width)/2-N,D=k.y-(A-k.height)/2-N,M=O+2*N,z=A+2*N,j=`${yQ}-${C}`,R=(0,x.useRef)(0);R.current=$,(0,x.useEffect)(()=>{if(S.current){let e=cq(S.current),t=e=>{let{transform:t,d3Selection:n,d3Zoom:i}=_.getState();if("wheel"!==e.sourceEvent.type||!n||!i)return;let a=-e.sourceEvent.deltaY*(1===e.sourceEvent.deltaMode?.05:e.sourceEvent.deltaMode?1:.002)*v,o=t[2]*Math.pow(2,a);i.scaleTo(n,o)},n=e=>{let{transform:t,d3Selection:n,d3Zoom:i,translateExtent:a,width:o,height:s}=_.getState();if("mousemove"!==e.sourceEvent.type||!n||!i)return;let l=R.current*Math.max(1,t[2])*(b?-1:1),u={x:t[0]-e.sourceEvent.movementX*l,y:t[1]-e.sourceEvent.movementY*l},c=[[0,0],[o,s]],d=hP.translate(u.x,u.y).scale(t[2]),p=i.constrain()(d,c,a);i.transform(n,p)},i=hU().on("zoom",g?n:null).on("zoom.wheel",m?t:null);return e.call(i),()=>{e.on("zoom",null)}}},[g,m,b,v]);let L=h?e=>{let t=c5(e);h(e,{x:t[0],y:t[1]})}:void 0,F=f?(e,t)=>{f(e,_.getState().nodeInternals.get(t))}:void 0;return x.createElement(fn,{position:p,style:e,className:l9(["react-flow__minimap",t]),"data-testid":"rf__minimap"},x.createElement("svg",{width:E,height:I,viewBox:`${P} ${D} ${M} ${z}`,role:"img","aria-labelledby":j,ref:S,onClick:L},y&&x.createElement("title",{id:j},y),x.createElement(yK,{onClick:F,nodeColor:i,nodeStrokeColor:n,nodeBorderRadius:o,nodeClassName:a,nodeStrokeWidth:s,nodeComponent:l}),x.createElement("path",{className:"react-flow__minimap-mask",d:`M${P-N},${D-N}h${M+2*N}v${z+2*N}h${-M-2*N}z
        M${T.x},${T.y}h${T.width}v${T.height}h${-T.width}z`,fill:u,fillRule:"evenodd",stroke:c,strokeWidth:d,pointerEvents:"none"})))}yJ.displayName="MiniMap";var y0=(0,x.memo)(yJ);function y1(e){let t=null,n=null,i=function(){for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];n=a,null===t&&(t=requestAnimationFrame(()=>{t=null,n&&e(...n)}))};return i.cancel=()=>{null!==t&&(cancelAnimationFrame(t),t=null),n=null},i}let y2=150,y3=200,y4=[[-200,-200],[200,200]],y6=e=>{if("undefined"==typeof window)return e(),0;let t=window;return t.requestIdleCallback?t.requestIdleCallback(()=>e(),{timeout:y2}):window.setTimeout(e,16)},y5=e=>{if(0===e||"undefined"==typeof window)return;let t=window;t.cancelIdleCallback?t.cancelIdleCallback(e):window.clearTimeout(e)};function y8(e){let t={opacity:0,width:0,height:0,border:"none",background:"transparent",pointerEvents:"none"};switch(e){case c.Left:return{...t,left:0,transform:"translate(0, -50%)"};case c.Right:return{...t,right:0,transform:"translate(0, -50%)"};case c.Top:return{...t,top:0,transform:"translate(-50%, 0)"};case c.Bottom:return{...t,bottom:0,transform:"translate(-50%, 0)"};default:return t}}let y7=x.memo(e=>{let{data:t}=e,{currentNodeId:n}=tV(),{color:i,moveNumber:a,hasComment:o,hasMarkers:s,hasSetupStones:l,horizontal:u,isRoot:d,nodeId:p,isPass:h}=t,f=String(p)===String(n),g=u?c.Left:c.Top,m=u?c.Right:c.Bottom,y=x.useMemo(()=>y8(g),[g]),b=x.useMemo(()=>y8(m),[m]),w=x.useMemo(()=>d?{background:"#666",color:"white",boxShadow:f?"0 2px 4px rgba(0, 0, 0, 0.2), 0 0 0 3px #4A9EFF":"0 2px 4px rgba(0, 0, 0, 0.2)",border:"1px solid #888"}:h?{background:"black"===i?"rgba(0, 0, 0, 0.15)":"rgba(255, 255, 255, 0.3)",boxShadow:f?"0 0 0 3px #4A9EFF":"none",border:`2px solid ${"black"===i?"#333":"#aaa"}`}:"black"===i?{background:"radial-gradient(circle at 35% 35%, #555 0%, #222 30%, #000 100%)",boxShadow:f?"0 2px 4px rgba(0, 0, 0, 0.4), 0 0 0 3px #4A9EFF":"0 2px 4px rgba(0, 0, 0, 0.4), 0 0 0 1.5px rgba(255, 255, 255, 0.45)",border:"none"}:{background:"radial-gradient(circle at 30% 30%, #fff 0%, #f0f0f0 25%, #d5d5d5 60%, #bbb 100%)",boxShadow:f?"0 3px 5px rgba(0, 0, 0, 0.3), 0 0 0 3px #4A9EFF":"0 3px 5px rgba(0, 0, 0, 0.3), 0 0 0 1.5px rgba(0, 0, 0, 0.35)",border:"none"},[d,i,f,h]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(gg,{type:"target",position:g,style:y}),(0,v.jsxs)("div",{style:{width:24,height:24,borderRadius:d?"2px":"50%",...w,display:"flex",alignItems:"center",justifyContent:"center",fontSize:h?"11px":"10px",fontWeight:"bold",color:h?"black"===i?"#333":"#888":"black"===i||d?"#FFF":"#000",position:"relative"},children:[d?"":h?"P":a>0&&a,o&&(0,v.jsx)("div",{style:{position:"absolute",top:-2,right:s?2:-2,width:6,height:6,borderRadius:"50%",backgroundColor:"#FF6B6B",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.3)"}}),s&&(0,v.jsx)("div",{style:{position:"absolute",top:-2,right:-2,width:5,height:5,borderRadius:"1px",backgroundColor:"#4A9EFF",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.3)"}}),l&&(0,v.jsx)("div",{style:{position:"absolute",bottom:-2,right:-2,width:5,height:5,borderRadius:"1px",backgroundColor:"#51CF66",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.3)"}})]}),(0,v.jsx)(gg,{type:"source",position:m,style:b})]})});function y9(e){return e.data.B?"black":e.data.W?"white":"empty"}function be(e){var t,n;let i=null==(t=e.data.B)?void 0:t[0],a=null==(n=e.data.W)?void 0:n[0];return void 0!==i?""===i||"tt"===i:void 0!==a&&(""===a||"tt"===a)}function bt(e){return!!(e.data.C&&e.data.C[0]&&""!==e.data.C[0].trim())}function bn(e){return["TR","SQ","CR","MA","LB"].some(t=>e.data[t]&&e.data[t].length>0)}function br(e){return["AB","AW","AE"].some(t=>e.data[t]&&e.data[t].length>0)}let bi=24,ba=24,bo=14,bs=18;function bl(e,t,n){if(0===e.length)return{nodes:e,edges:t};let i=new Map,a=new Map;for(let e of t)i.has(e.source)||i.set(e.source,[]),i.get(e.source).push(e.target),a.set(e.target,e.source);let o=new Set(e.map(e=>e.id)),s=null;for(let e of o)if(!a.has(e)){s=e;break}s||(s=e[0].id);let l=new Map,u="LR"===n,c=ba+bo,d=new Map;function p(e,t,n){let a=i.get(e)||[],o=d.get(t)??0,s=n<0?o:Math.max(n,o),h=t*(u?bi+bs:ba+bs);if(u?l.set(e,{x:h,y:s}):l.set(e,{x:s,y:h}),d.set(t,s+c),0!==a.length)for(let e=0;e<a.length;e++)0===e?p(a[e],t+1,s):p(a[e],t+1,-1)}return p(s,0,0),{nodes:e.map(e=>{let t=l.get(e.id);return t?{...e,position:t}:e}),edges:t}}function bu(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;if(n.has(e.id))return null;if(n.add(e.id),e.id===t)return[e];for(let i of e.children){let a=bu(i,t,n);if(a)return[e,...a]}return null}function bc(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#fff",a=1e3,o=new Set,s=new Map;function l(e){for(let t of(s.set(e.id,e),e.children))l(t)}l(e);let u=null!==t?bu(e,t):null;if((null==u?void 0:u.map(e=>e.id))??[],o.add(e.id),u)for(let e of u)o.add(e.id);if(u){for(let e of u)if(null!==e.parentId){let t=s.get(e.parentId);if(t)for(let e of t.children)o.add(e.id)}}for(let t of e.children)o.add(t.id);let c=[];if(u)for(let e of u)for(let t of e.children)o.has(t.id)||c.push(t);for(let e of o){let t=s.get(e);if(t)for(let e of t.children)o.has(e.id)||c.some(t=>t.id===e.id)||c.push(e)}for(;c.length>0&&o.size<a;){let e=c.shift();if(!o.has(e.id))for(let t of(o.add(e.id),e.children))o.has(t.id)||c.push(t)}let d=[],p=new Map;function h(e,t){let n="empty"!==y9(e)?t+1:t;for(let t of(p.set(e.id,n),e.children))o.has(t.id)&&h(t,n)}for(let t of(h(e,0),o)){let i=s.get(t);if(!i)continue;let a=y9(i),o=i.id===e.id,l=be(i),u=p.get(i.id)??0;d.push({id:String(i.id),type:"stone",position:{x:0,y:0},data:{nodeId:i.id,color:a,moveNumber:"empty"!==a?u:0,hasComment:bt(i),hasMarkers:bn(i),hasSetupStones:br(i),horizontal:n,isRoot:o,isPass:l}})}let f=[];for(let e of o){let t=s.get(e);if(t)for(let e of t.children)o.has(e.id)&&f.push({id:`e${String(t.id)}-${String(e.id)}`,source:String(t.id),target:String(e.id),style:{stroke:i,strokeWidth:1.5}})}return{nodes:d,edges:f,includedNodeIds:o}}let bd={stone:y7},bp="kaya-game-tree-zoom",bh=(0,x.forwardRef)((e,t)=>{let{horizontal:n,onLayoutChange:i,showMinimap:a=!1}=e,{gameTree:o,rootId:s,currentNodeId:l,goToNode:u}=tQ(),{theme:c}=C(),d="dark"===c?"#fff":"#333",[p,h]=x.useState(!0),[f,g]=(0,x.useState)([]),[m,y]=(0,x.useState)([]),[b,w]=(0,x.useState)(y4),_=(0,x.useRef)([]),S=(0,x.useRef)([]),k=(0,x.useRef)(null),T=(0,x.useRef)(null),[E,I]=x.useState(!1),[$,O]=x.useState(!0),A=(0,x.useRef)(null),N=(0,x.useRef)(null),P=(0,x.useRef)(!1),D=(0,x.useRef)(new Set),M=(0,x.useRef)(null),z=(0,x.useRef)(null),j=(0,x.useRef)(null),R=(0,x.useRef)(void 0),L=(0,x.useRef)(!1),F=(0,x.useRef)(l);(0,x.useEffect)(()=>{F.current=l},[l]),(0,x.useEffect)(()=>("undefined"!=typeof Worker&&(T.current=new Worker(new URL(__webpack_require__.p+__webpack_require__.u("891"),__webpack_require__.b),Object.assign({},{type:"module"},{type:void 0}))),()=>{var e;null==(e=T.current)||e.terminate()}),[]),x.useEffect(()=>{if(null!==z.current||"undefined"==typeof window||!window.localStorage)return;let e=window.localStorage.getItem(bp),t=e?parseFloat(e):NaN;Number.isFinite(t)&&(z.current=t)},[]);let B=n??p,U=x.useRef({width:0,height:0}),V=(0,x.useCallback)(()=>{_.current.length>0&&(g(_.current),y(S.current))},[]),G=(0,x.useMemo)(()=>y1(V),[V]);(0,x.useEffect)(()=>()=>{G.cancel()},[G]);let H=(0,x.useCallback)(()=>{if(null===l||!A.current)return;let e=_.current.find(e=>e.id===String(l));if(!e)return;let{x:t,y:n}=e.position;A.current.setCenter(t+12,n+12,{zoom:1.5,duration:200}),setTimeout(()=>V(),250)},[l,V]);(0,x.useImperativeHandle)(t,()=>({centerOnCurrentNode:H}),[H]),(0,x.useEffect)(()=>{if(!k.current)return;let e=k.current.getBoundingClientRect();U.current={width:e.width,height:e.height};let t=new ResizeObserver(e=>{for(let t of e)U.current={width:t.contentRect.width,height:t.contentRect.height};A.current&&V()});return t.observe(k.current),()=>{t.disconnect()}},[V]),x.useEffect(()=>{void 0!==R.current&&R.current!==B&&(L.current=!0),R.current=B,O(!0),D.current=new Set},[o,s,B,d]),x.useEffect(()=>{if($||null===j.current||(y5(j.current),j.current=null),!$)return;let e=()=>{if(j.current=null,!o||null===s){g([]),y([]),D.current=new Set,I(!1),O(!1);return}let e=o.get(s);if(!e)return void O(!1);I(!0);let{nodes:t,edges:n,includedNodeIds:i}=bc(e,l,B,d),a=(e,t)=>{if(_.current=e,S.current=t,e.length>0){let t=1/0,n=1/0,i=-1/0,a=-1/0;for(let o of e){let e=o.width??24,s=o.height??24;t=Math.min(t,o.position.x),n=Math.min(n,o.position.y),i=Math.max(i,o.position.x+e),a=Math.max(a,o.position.y+s)}Number.isFinite(t)&&Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(a)&&w([[t-y3,n-y3],[i+y3,a+y3]])}else w(y4);g(e),y(t),D.current=new Set(Array.from(i).map(e=>String(e))),I(!1),O(!1),P.current?L.current&&(L.current=!1,setTimeout(()=>{if(!A.current)return;let t=F.current,n=e.find(e=>e.id===String(t));if(n){let e=A.current.getViewport();A.current.setCenter(n.position.x+12,n.position.y+12,{zoom:e.zoom,duration:200})}},50)):(P.current=!0,setTimeout(()=>{if(!A.current)return;let t=F.current,n=e.find(e=>e.id===String(t)),i=z.current??1;if(n)A.current.setCenter(n.position.x+12,n.position.y+12,{zoom:i,duration:0});else if(z.current){let e=A.current.getViewport();A.current.setViewport({x:e.x,y:e.y,zoom:i},{duration:0})}else A.current.fitView({padding:.05,duration:0,maxZoom:1.5})},50))};if(T.current)T.current.onmessage=e=>{let{nodes:t,edges:n}=e.data;a(t,n)},T.current.postMessage({nodes:t,edges:n,direction:B?"LR":"TB"});else{let{nodes:e,edges:i}=bl(t,n,B?"LR":"TB");a(e,i)}};return null===j.current&&(j.current=y6(e)),()=>{null!==j.current&&(y5(j.current),j.current=null)}},[$,o,s,B,l,d,g,y]),x.useEffect(()=>{if(null===l||$||0===D.current.size)return;let e=String(l);D.current.has(e)||O(!0)},[l,$]),x.useEffect(()=>{null!==l&&A.current&&(null!==M.current&&cancelAnimationFrame(M.current),M.current=requestAnimationFrame(()=>{let e=_.current.find(e=>e.id===String(l));if(!e||!A.current||N.current===l)return;let{x:t,y:n}=e.position,i=A.current.getZoom();A.current.setCenter(t+12,n+12,{zoom:i,duration:0}),N.current=l,V()}))},[l,V]),x.useEffect(()=>()=>{null!==M.current&&(cancelAnimationFrame(M.current),M.current=null)},[]),x.useEffect(()=>{P.current=!1,N.current=null},[o,s]),x.useEffect(()=>{N.current=null},[B]);let W=(0,x.useCallback)((e,t)=>{u("0"===t.id?0:Number(t.id))},[u]),q=(0,x.useCallback)(()=>{},[]),K=(0,x.useCallback)(()=>{if(!A.current)return;let{zoom:e}=A.current.getViewport();z.current=e,"undefined"!=typeof window&&window.localStorage&&window.localStorage.setItem(bp,e.toString())},[]);return(0,v.jsx)("div",{ref:k,className:"gametree-graph-container",style:{width:"100%",height:"100%",position:"relative"},children:(0,v.jsxs)(yk,{nodes:f,edges:m,onNodeClick:W,onMove:q,onMoveEnd:K,nodeTypes:bd,onInit:e=>{A.current=e},proOptions:{hideAttribution:!0},fitView:!0,fitViewOptions:{padding:.05,minZoom:.2,maxZoom:1.5},minZoom:.1,maxZoom:4,translateExtent:b,onlyRenderVisibleElements:!0,panOnDrag:!0,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,preventScrolling:!0,zoomOnDoubleClick:!1,selectNodesOnDrag:!1,children:[(0,v.jsx)(yN,{}),(0,v.jsx)(yB,{showInteractive:!1,style:{background:"var(--bg-secondary, rgba(0,0,0,0.8))",border:"1px solid var(--border-color, #333)"}}),a&&(0,v.jsx)(y0,{pannable:!0,zoomable:!0,nodeColor:e=>{var t;let n=null==(t=e.data)?void 0:t.color;return"black"===n?"#000":"white"===n?"#FFF":"#CCC"},style:{background:"var(--bg-secondary, rgba(10,12,18,0.6))",border:"1px solid var(--border-color, #333)",boxShadow:"0 4px 12px rgba(0,0,0,0.35)",cursor:"grab"},maskColor:"rgba(8,10,14,0.25)",nodeStrokeColor:"var(--border-color, #333)"})]})})});bh.displayName="GameTreeGraph";let bf=e=>{let{active:t}=e;return(0,v.jsxs)("svg",{className:"game-tree-control-icon",width:"16",height:"16",viewBox:"0 0 16 16","aria-hidden":"true",children:[(0,v.jsx)("rect",{x:"1.5",y:"1.5",width:"13",height:"13",rx:"2",fill:"none",stroke:"currentColor",strokeWidth:"1.2"}),(0,v.jsx)("rect",{x:"4.25",y:"4.25",width:"7.5",height:"7.5",fill:"currentColor",fillOpacity:t?.6:.35,stroke:"none"}),(0,v.jsx)("path",{d:"M4.25 8H11.75",stroke:"var(--bg-primary, #0f1318)",strokeOpacity:"0.45",strokeWidth:"0.75"}),(0,v.jsx)("path",{d:"M8 4.25V11.75",stroke:"var(--bg-primary, #0f1318)",strokeOpacity:"0.45",strokeWidth:"0.75"})]})},bg=e=>{let{horizontal:t,onToggleLayout:n,showMinimap:i,onToggleMinimap:a,onCenterOnCurrentNode:o}=e,{t:s}=rK();return(0,v.jsxs)("div",{className:"game-tree-controls",children:[(0,v.jsx)("button",{type:"button",onClick:n,className:"game-tree-control-btn",title:s(t?"gameTree.switchToVertical":"gameTree.switchToHorizontal"),children:t?"":""}),(0,v.jsx)("button",{type:"button",onClick:a,className:`game-tree-control-btn ${i?"active":""}`,title:s(i?"gameTree.hideMinimap":"gameTree.showMinimap"),"aria-pressed":i,children:(0,v.jsx)(bf,{active:i})}),o&&(0,v.jsx)("button",{type:"button",onClick:o,className:"game-tree-control-btn",title:s("gameTree.centerOnPosition"),"aria-label":s("gameTree.centerOnPosition"),children:(0,v.jsx)(ov,{size:16})})]})},bm=e=>{let t=/(https?:\/\/[^\s]+)/g;return e.split(t).map((e,n)=>e.match(t)?(0,v.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"game-info-link",children:e},n):e)},by=[{key:"gameName",labelKey:"gameInfo.game",placeholderKey:"gameInfo.untitled",alwaysShow:!0,fallbackKey:"gameInfo.untitled"},{key:"date",labelKey:"gameInfo.date",placeholderKey:"gameInfo.datePlaceholder"},{key:"place",labelKey:"gameInfo.place",placeholderKey:"gameInfo.placePlaceholder",hasLinkRender:!0},{key:"playerBlack",labelKey:"gameInfo.black",placeholderKey:"gameInfo.black",alwaysShow:!0,fallbackKey:"gameInfo.black"},{key:"rankBlack",labelKey:"gameInfo.blackRank",placeholderKey:"gameInfo.rankPlaceholder"},{key:"playerWhite",labelKey:"gameInfo.white",placeholderKey:"gameInfo.white",alwaysShow:!0,fallbackKey:"gameInfo.white"},{key:"rankWhite",labelKey:"gameInfo.whiteRank",placeholderKey:"gameInfo.rankPlaceholder"},{key:"komi",labelKey:"gameInfo.komi",placeholderKey:"gameInfo.komiPlaceholder",type:"number",step:"0.5",alwaysShow:!0},{key:"handicap",labelKey:"gameInfo.handicap",placeholderKey:"gameInfo.handicapPlaceholder",type:"number",min:"0",max:"9"},{key:"rules",labelKey:"gameInfo.rules",placeholderKey:"gameInfo.rulesPlaceholder"},{key:"timeControl",labelKey:"gameInfo.time",placeholderKey:"gameInfo.timePlaceholder"},{key:"result",labelKey:"gameInfo.result",placeholderKey:"gameInfo.resultPlaceholder"}],bb=()=>{let{gameId:e}=tH(),[t,n]=(0,x.useState)(!1);(0,x.useEffect)(()=>{n(!1)},[e]);let i=(0,x.useCallback)(()=>{n(e=>!e)},[]);return{isEditMode:t,setIsEditMode:n,toggleEditMode:i}},bv=e=>{let{isEditMode:t,onToggle:n}=e,{t:i}=rK();return(0,v.jsx)("button",{className:`info-edit-button ${t?"active":""}`,onClick:n,title:i(t?"gameInfo.exitEditMode":"gameInfo.editAllFields"),children:(0,v.jsx)(oI,{size:14})})},bx=e=>{let{isEditMode:t,onEditModeChange:n}=e,{t:i}=rK(),{gameInfo:a,updateGameInfo:o,gameId:s}=tH(),{clearAnalysisCache:l}=na(),u=(0,x.useMemo)(()=>by.map(e=>({key:e.key,label:i(e.labelKey),placeholder:i(e.placeholderKey),type:e.type,step:e.step,min:e.min,max:e.max,alwaysShow:e.alwaysShow,renderValue:e.fallbackKey?t=>t||(0,v.jsx)("em",{children:i(e.fallbackKey)}):e.hasLinkRender?e=>e?bm(String(e)):null:void 0})),[i]),[c,d]=(0,x.useState)(!1),p=t??c,h=n??d,[f,g]=(0,x.useState)(null),[m,y]=(0,x.useState)(""),b=(0,x.useRef)(null);(0,x.useEffect)(()=>{h(!1),g(null),y("")},[s,h]),(0,x.useEffect)(()=>{f&&b.current&&(b.current.focus(),b.current.select())},[f]);let w=(0,x.useCallback)(e=>{switch(e){case"gameName":return a.gameName;case"date":return a.date;case"place":return a.place;case"playerBlack":return a.playerBlack;case"rankBlack":return a.rankBlack;case"playerWhite":return a.playerWhite;case"rankWhite":return a.rankWhite;case"komi":return a.komi;case"handicap":return a.handicap;case"rules":return a.rules;case"timeControl":return a.timeControl;case"result":return a.result;default:return}},[a]),_=(0,x.useCallback)(e=>{let t=w(e);y(void 0!==t?String(t):""),g(e)},[w]),S=(0,x.useCallback)((e,t)=>{let n=t.trim(),i={};"komi"===e?i.komi=n?parseFloat(n):6.5:"handicap"===e?i.handicap=n?parseInt(n,10):0:i[e]=n||void 0,o(i),g(null),y("")},[o]),k=(0,x.useCallback)(()=>{f&&S(f,m)},[f,m,S]),T=(0,x.useCallback)(e=>{e.stopPropagation(),"Enter"===e.key?(e.preventDefault(),f&&S(f,m)):"Escape"===e.key&&(g(null),y(""))},[f,m,S]);(0,x.useCallback)(()=>{h(!p),g(null),y("")},[p,h]);let C=e=>{let t,n=w(e.key),i=void 0!==n&&""!==n&&0!==n,a=f===e.key;return(p||e.alwaysShow||i)&&("handicap"!==e.key||p||n&&0!==n)?(t=e.renderValue?e.renderValue(n):"komi"===e.key?n??6.5:n||(p?(0,v.jsx)("em",{className:"empty-placeholder",children:"Click to add"}):null),(0,v.jsxs)("div",{className:"game-info-row",children:[(0,v.jsxs)("strong",{children:[e.label,":"]})," ",a?(0,v.jsx)("input",{ref:b,type:e.type||"text",step:e.step,min:e.min,max:e.max,className:"inline-edit-input",value:m,onChange:e=>y(e.target.value),onBlur:k,onKeyDown:T,onKeyUp:e=>e.stopPropagation(),onKeyPress:e=>e.stopPropagation(),placeholder:e.placeholder}):(0,v.jsx)("span",{className:`editable-field ${p?"edit-mode":""}`,onClick:()=>_(e.key),title:"Click to edit",children:t})]},e.key)):null},E=(e,t,n)=>{let i=w(e),a=w(t),o=f===e,s=f===t,l=u.find(t=>t.key===e),c=u.find(e=>e.key===t);return(0,v.jsxs)("div",{className:"game-info-row",children:[(0,v.jsxs)("strong",{children:[n,":"]})," ",o?(0,v.jsx)("input",{ref:b,type:"text",className:"inline-edit-input",value:m,onChange:e=>y(e.target.value),onBlur:k,onKeyDown:T,onKeyUp:e=>e.stopPropagation(),onKeyPress:e=>e.stopPropagation(),placeholder:l.placeholder}):(0,v.jsx)("span",{className:`editable-field ${p?"edit-mode":""}`,onClick:()=>_(e),title:"Click to edit name",children:i||(0,v.jsx)("em",{children:"playerBlack"===e?"Black":"White"})}),(a||p)&&(0,v.jsxs)(v.Fragment,{children:[" ",s?(0,v.jsxs)(v.Fragment,{children:["(",(0,v.jsx)("input",{ref:b,type:"text",className:"inline-edit-input inline-edit-input-small",value:m,onChange:e=>y(e.target.value),onBlur:k,onKeyDown:T,onKeyUp:e=>e.stopPropagation(),onKeyPress:e=>e.stopPropagation(),placeholder:c.placeholder}),")"]}):(0,v.jsxs)("span",{className:`editable-field editable-rank ${p?"edit-mode":""}`,onClick:()=>_(t),title:"Click to edit rank",children:["(",a||(0,v.jsx)("em",{children:"rank"}),")"]})]})]},e)};return(0,v.jsx)("div",{className:"game-info-editor",children:(0,v.jsxs)("div",{className:"game-info-display",children:[C(u.find(e=>"gameName"===e.key)),C(u.find(e=>"date"===e.key)),C(u.find(e=>"place"===e.key)),E("playerBlack","rankBlack",i("gameInfo.black")),E("playerWhite","rankWhite",i("gameInfo.white")),C(u.find(e=>"komi"===e.key)),C(u.find(e=>"handicap"===e.key)),C(u.find(e=>"rules"===e.key)),C(u.find(e=>"timeControl"===e.key)),C(u.find(e=>"result"===e.key)),p&&(0,v.jsx)("div",{className:"info-hint",children:i("gameInfo.editHint")})]})})},bw="https://github.com/kaya-go/kaya",b_=e=>{let t,n,i,a,o,{isOpen:s,onClose:l,versionData:u}=e,{t:c}=rK();return s?(u&&(t=u.version,n=u.gitHash,i=new Date(u.buildDate).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}),o=`${bw}/commit/${n}`,a=t.includes("-dev")||t.includes("-")?o:`${bw}/releases/tag/v${t}`),(0,v.jsx)("div",{className:"about-overlay",onClick:l,children:(0,v.jsxs)("div",{className:"about-dialog",onClick:e=>e.stopPropagation(),children:[(0,v.jsx)("button",{className:"about-close-button",onClick:l,title:c("close"),children:(0,v.jsx)(oY,{size:18})}),(0,v.jsxs)("div",{className:"about-header",children:[(0,v.jsx)("img",{src:"/icon.png",alt:"Kaya",className:"about-logo"}),(0,v.jsx)("h1",{className:"about-title",children:"Kaya"})]}),(0,v.jsx)("p",{className:"about-description",children:c("aboutDescription")}),(0,v.jsxs)("div",{className:"about-info",children:[u?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"about-info-row",children:[(0,v.jsxs)("span",{className:"about-label",children:[c("aboutVersion"),":"]}),(0,v.jsxs)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"about-link",children:["v",t," ",(0,v.jsx)(a9,{size:12})]})]}),(0,v.jsxs)("div",{className:"about-info-row",children:[(0,v.jsxs)("span",{className:"about-label",children:[c("aboutCommit"),":"]}),(0,v.jsxs)("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"about-link",children:[n," ",(0,v.jsx)(a9,{size:12})]})]}),(0,v.jsxs)("div",{className:"about-info-row",children:[(0,v.jsxs)("span",{className:"about-label",children:[c("aboutBuildDate"),":"]}),(0,v.jsx)("span",{className:"about-value",children:i})]})]}):(0,v.jsx)("div",{className:"about-info-row",children:(0,v.jsx)("span",{className:"about-value",children:c("aboutVersionNotAvailable")})}),(0,v.jsxs)("div",{className:"about-info-row",children:[(0,v.jsxs)("span",{className:"about-label",children:[c("aboutLicense"),":"]}),(0,v.jsx)("span",{className:"about-value",children:"AGPL-3.0"})]})]}),(0,v.jsxs)("div",{className:"about-links",children:[(0,v.jsxs)("a",{href:bw,target:"_blank",rel:"noopener noreferrer",className:"about-github-link",children:[c("aboutGitHub")," ",(0,v.jsx)(a9,{size:14})]}),(0,v.jsxs)("a",{href:`${bw}/issues/new/choose`,target:"_blank",rel:"noopener noreferrer",className:"about-github-link",children:[c("aboutReportIssue")," ",(0,v.jsx)(a9,{size:14})]})]}),(0,v.jsx)("p",{className:"about-copyright",children:"\xa9 2025 Kaya Team"})]})})):null};function bS(e,t){let n=t||{};return(""===e[e.length-1]?[...e,""]:e).join((n.padRight?" ":"")+","+(!1===n.padLeft?"":" ")).trim()}let bk=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,bT=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,bC={};function bE(e,t){return((t||bC).jsx?bT:bk).test(e)}let bI=/[ \t\n\f\r]/g;function b$(e){return"object"==typeof e?"text"===e.type&&bO(e.value):bO(e)}function bO(e){return""===e.replace(bI,"")}class bA{constructor(e,t,n){this.normal=t,this.property=e,n&&(this.space=n)}}function bN(e,t){let n={},i={};for(let t of e)Object.assign(n,t.property),Object.assign(i,t.normal);return new bA(n,i,t)}function bP(e){return e.toLowerCase()}bA.prototype.normal={},bA.prototype.property={},bA.prototype.space=void 0;class bD{constructor(e,t){this.attribute=t,this.property=e}}bD.prototype.attribute="",bD.prototype.booleanish=!1,bD.prototype.boolean=!1,bD.prototype.commaOrSpaceSeparated=!1,bD.prototype.commaSeparated=!1,bD.prototype.defined=!1,bD.prototype.mustUseProperty=!1,bD.prototype.number=!1,bD.prototype.overloadedBoolean=!1,bD.prototype.property="",bD.prototype.spaceSeparated=!1,bD.prototype.space=void 0;let bM=0,bz=bV(),bj=bV(),bR=bV(),bL=bV(),bF=bV(),bB=bV(),bU=bV();function bV(){return 2**++bM}let bG=Object.keys(g);class bH extends bD{constructor(e,t,n,i){let a=-1;if(super(e,t),bW(this,"space",i),"number"==typeof n)for(;++a<bG.length;){const e=bG[a];bW(this,bG[a],(n&g[e])===g[e])}}}function bW(e,t,n){n&&(e[t]=n)}function bq(e){let t={},n={};for(let[i,a]of Object.entries(e.properties)){let o=new bH(i,e.transform(e.attributes||{},i),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(i)&&(o.mustUseProperty=!0),t[i]=o,n[bP(i)]=i,n[bP(o.attribute)]=i}return new bA(t,n,e.space)}bH.prototype.defined=!0;let bK=bq({properties:{ariaActiveDescendant:null,ariaAtomic:bj,ariaAutoComplete:null,ariaBusy:bj,ariaChecked:bj,ariaColCount:bL,ariaColIndex:bL,ariaColSpan:bL,ariaControls:bF,ariaCurrent:null,ariaDescribedBy:bF,ariaDetails:null,ariaDisabled:bj,ariaDropEffect:bF,ariaErrorMessage:null,ariaExpanded:bj,ariaFlowTo:bF,ariaGrabbed:bj,ariaHasPopup:null,ariaHidden:bj,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:bF,ariaLevel:bL,ariaLive:null,ariaModal:bj,ariaMultiLine:bj,ariaMultiSelectable:bj,ariaOrientation:null,ariaOwns:bF,ariaPlaceholder:null,ariaPosInSet:bL,ariaPressed:bj,ariaReadOnly:bj,ariaRelevant:null,ariaRequired:bj,ariaRoleDescription:bF,ariaRowCount:bL,ariaRowIndex:bL,ariaRowSpan:bL,ariaSelected:bj,ariaSetSize:bL,ariaSort:null,ariaValueMax:bL,ariaValueMin:bL,ariaValueNow:bL,ariaValueText:null,role:null},transform:(e,t)=>"role"===t?t:"aria-"+t.slice(4).toLowerCase()});function bX(e,t){return t in e?e[t]:t}function bZ(e,t){return bX(e,t.toLowerCase())}let bY=bq({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:bB,acceptCharset:bF,accessKey:bF,action:null,allow:null,allowFullScreen:bz,allowPaymentRequest:bz,allowUserMedia:bz,alt:null,as:null,async:bz,autoCapitalize:null,autoComplete:bF,autoFocus:bz,autoPlay:bz,blocking:bF,capture:null,charSet:null,checked:bz,cite:null,className:bF,cols:bL,colSpan:null,content:null,contentEditable:bj,controls:bz,controlsList:bF,coords:bL|bB,crossOrigin:null,data:null,dateTime:null,decoding:null,default:bz,defer:bz,dir:null,dirName:null,disabled:bz,download:bR,draggable:bj,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:bz,formTarget:null,headers:bF,height:bL,hidden:bR,high:bL,href:null,hrefLang:null,htmlFor:bF,httpEquiv:bF,id:null,imageSizes:null,imageSrcSet:null,inert:bz,inputMode:null,integrity:null,is:null,isMap:bz,itemId:null,itemProp:bF,itemRef:bF,itemScope:bz,itemType:bF,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:bz,low:bL,manifest:null,max:null,maxLength:bL,media:null,method:null,min:null,minLength:bL,multiple:bz,muted:bz,name:null,nonce:null,noModule:bz,noValidate:bz,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:bz,optimum:bL,pattern:null,ping:bF,placeholder:null,playsInline:bz,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:bz,referrerPolicy:null,rel:bF,required:bz,reversed:bz,rows:bL,rowSpan:bL,sandbox:bF,scope:null,scoped:bz,seamless:bz,selected:bz,shadowRootClonable:bz,shadowRootDelegatesFocus:bz,shadowRootMode:null,shape:null,size:bL,sizes:null,slot:null,span:bL,spellCheck:bj,src:null,srcDoc:null,srcLang:null,srcSet:null,start:bL,step:null,style:null,tabIndex:bL,target:null,title:null,translate:null,type:null,typeMustMatch:bz,useMap:null,value:bj,width:bL,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:bF,axis:null,background:null,bgColor:null,border:bL,borderColor:null,bottomMargin:bL,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:bz,declare:bz,event:null,face:null,frame:null,frameBorder:null,hSpace:bL,leftMargin:bL,link:null,longDesc:null,lowSrc:null,marginHeight:bL,marginWidth:bL,noResize:bz,noHref:bz,noShade:bz,noWrap:bz,object:null,profile:null,prompt:null,rev:null,rightMargin:bL,rules:null,scheme:null,scrolling:bj,standby:null,summary:null,text:null,topMargin:bL,valueType:null,version:null,vAlign:null,vLink:null,vSpace:bL,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:bz,disableRemotePlayback:bz,prefix:null,property:null,results:bL,security:null,unselectable:null},space:"html",transform:bZ}),bQ=bq({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:bU,accentHeight:bL,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:bL,amplitude:bL,arabicForm:null,ascent:bL,attributeName:null,attributeType:null,azimuth:bL,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:bL,by:null,calcMode:null,capHeight:bL,className:bF,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:bL,diffuseConstant:bL,direction:null,display:null,dur:null,divisor:bL,dominantBaseline:null,download:bz,dx:null,dy:null,edgeMode:null,editable:null,elevation:bL,enableBackground:null,end:null,event:null,exponent:bL,externalResourcesRequired:null,fill:null,fillOpacity:bL,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:bB,g2:bB,glyphName:bB,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:bL,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:bL,horizOriginX:bL,horizOriginY:bL,id:null,ideographic:bL,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:bL,k:bL,k1:bL,k2:bL,k3:bL,k4:bL,kernelMatrix:bU,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:bL,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:bL,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:bL,overlineThickness:bL,paintOrder:null,panose1:null,path:null,pathLength:bL,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:bF,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:bL,pointsAtY:bL,pointsAtZ:bL,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:bU,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:bU,rev:bU,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:bU,requiredFeatures:bU,requiredFonts:bU,requiredFormats:bU,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:bL,specularExponent:bL,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:bL,strikethroughThickness:bL,string:null,stroke:null,strokeDashArray:bU,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:bL,strokeOpacity:bL,strokeWidth:null,style:null,surfaceScale:bL,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:bU,tabIndex:bL,tableValues:null,target:null,targetX:bL,targetY:bL,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:bU,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:bL,underlineThickness:bL,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:bL,values:null,vAlphabetic:bL,vMathematical:bL,vectorEffect:null,vHanging:bL,vIdeographic:bL,version:null,vertAdvY:bL,vertOriginX:bL,vertOriginY:bL,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:bL,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:bX}),bJ=bq({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform:(e,t)=>"xlink:"+t.slice(5).toLowerCase()}),b0=bq({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:bZ}),b1=bq({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform:(e,t)=>"xml:"+t.slice(3).toLowerCase()}),b2=bN([bK,bY,bJ,b0,b1],"html"),b3=bN([bK,bQ,bJ,b0,b1],"svg"),b4=/[A-Z]/g,b6=/-[a-z]/g,b5=/^data[-\w.:]+$/i;function b8(e,t){let n=bP(t),i=t,a=bD;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&"data"===n.slice(0,4)&&b5.test(t)){if("-"===t.charAt(4)){let e=t.slice(5).replace(b6,b9);i="data"+e.charAt(0).toUpperCase()+e.slice(1)}else{let e=t.slice(4);if(!b6.test(e)){let n=e.replace(b4,b7);"-"!==n.charAt(0)&&(n="-"+n),t="data"+n}}a=bH}return new a(i,t)}function b7(e){return"-"+e.toLowerCase()}function b9(e){return e.charAt(1).toUpperCase()}let ve={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"};function vt(e){return e.join(" ").trim()}var vn=__webpack_require__(20);let vr=va("end"),vi=va("start");function va(e){return t;function t(t){let n=t&&t.position&&t.position[e]||{};if("number"==typeof n.line&&n.line>0&&"number"==typeof n.column&&n.column>0)return{line:n.line,column:n.column,offset:"number"==typeof n.offset&&n.offset>-1?n.offset:void 0}}}function vo(e){let t=vi(e),n=vr(e);if(t&&n)return{start:t,end:n}}function vs(e){return e&&"object"==typeof e?"position"in e||"type"in e?vu(e.position):"start"in e||"end"in e?vu(e):"line"in e||"column"in e?vl(e):"":""}function vl(e){return vc(e&&e.line)+":"+vc(e&&e.column)}function vu(e){return vl(e&&e.start)+"-"+vl(e&&e.end)}function vc(e){return e&&"number"==typeof e?e:1}class vd extends Error{constructor(e,t,n){super(),"string"==typeof t&&(n=t,t=void 0);let i="",a={},o=!1;if(t&&(a="line"in t&&"column"in t||"start"in t&&"end"in t?{place:t}:"type"in t?{ancestors:[t],place:t.position}:{...t}),"string"==typeof e?i=e:!a.cause&&e&&(o=!0,i=e.message,a.cause=e),!a.ruleId&&!a.source&&"string"==typeof n){const e=n.indexOf(":");-1===e?a.ruleId=n:(a.source=n.slice(0,e),a.ruleId=n.slice(e+1))}if(!a.place&&a.ancestors&&a.ancestors){const e=a.ancestors[a.ancestors.length-1];e&&(a.place=e.position)}const s=a.place&&"start"in a.place?a.place.start:a.place;this.ancestors=a.ancestors||void 0,this.cause=a.cause||void 0,this.column=s?s.column:void 0,this.fatal=void 0,this.file="",this.message=i,this.line=s?s.line:void 0,this.name=vs(a.place)||"1:1",this.place=a.place||void 0,this.reason=this.message,this.ruleId=a.ruleId||void 0,this.source=a.source||void 0,this.stack=o&&a.cause&&"string"==typeof a.cause.stack?a.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}vd.prototype.file="",vd.prototype.name="",vd.prototype.reason="",vd.prototype.message="",vd.prototype.stack="",vd.prototype.column=void 0,vd.prototype.line=void 0,vd.prototype.ancestors=void 0,vd.prototype.cause=void 0,vd.prototype.fatal=void 0,vd.prototype.place=void 0,vd.prototype.ruleId=void 0,vd.prototype.source=void 0;let vp={}.hasOwnProperty,vh=new Map,vf=/[A-Z]/g,vg=new Set(["table","tbody","thead","tfoot","tr"]),vm=new Set(["td","th"]),vy="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function vb(e,t){let n;if(!t||void 0===t.Fragment)throw TypeError("Expected `Fragment` in options");let i=t.filePath||void 0;if(t.development){if("function"!=typeof t.jsxDEV)throw TypeError("Expected `jsxDEV` in options when `development: true`");n=v$(i,t.jsxDEV)}else{if("function"!=typeof t.jsx)throw TypeError("Expected `jsx` in production options");if("function"!=typeof t.jsxs)throw TypeError("Expected `jsxs` in production options");n=vI(i,t.jsx,t.jsxs)}let a={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:n,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:i,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:!1!==t.passKeys,passNode:t.passNode||!1,schema:"svg"===t.space?b3:b2,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:!1!==t.tableCellAlignToStyle},o=vv(a,e,void 0);return o&&"string"!=typeof o?o:a.create(e,a.Fragment,{children:o||void 0},void 0)}function vv(e,t,n){return"element"===t.type?vx(e,t,n):"mdxFlowExpression"===t.type||"mdxTextExpression"===t.type?vw(e,t):"mdxJsxFlowElement"===t.type||"mdxJsxTextElement"===t.type?vS(e,t,n):"mdxjsEsm"===t.type?v_(e,t):"root"===t.type?vk(e,t,n):"text"===t.type?vT(e,t):void 0}function vx(e,t,n){let i=e.schema,a=i;"svg"===t.tagName.toLowerCase()&&"html"===i.space&&(e.schema=a=b3),e.ancestors.push(t);let o=vM(e,t.tagName,!1),s=vO(e,t),l=vN(e,t);return vg.has(t.tagName)&&(l=l.filter(function(e){return"string"!=typeof e||!b$(e)})),vC(e,s,o,t),vE(s,l),e.ancestors.pop(),e.schema=i,e.create(t,o,s,n)}function vw(e,t){if(t.data&&t.data.estree&&e.evaluater){let n=t.data.estree.body[0];return n.type,e.evaluater.evaluateExpression(n.expression)}vz(e,t.position)}function v_(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);vz(e,t.position)}function vS(e,t,n){let i=e.schema,a=i;"svg"===t.name&&"html"===i.space&&(e.schema=a=b3),e.ancestors.push(t);let o=null===t.name?e.Fragment:vM(e,t.name,!0),s=vA(e,t),l=vN(e,t);return vC(e,s,o,t),vE(s,l),e.ancestors.pop(),e.schema=i,e.create(t,o,s,n)}function vk(e,t,n){let i={};return vE(i,vN(e,t)),e.create(t,e.Fragment,i,n)}function vT(e,t){return t.value}function vC(e,t,n,i){"string"!=typeof n&&n!==e.Fragment&&e.passNode&&(t.node=i)}function vE(e,t){if(t.length>0){let n=t.length>1?t:t[0];n&&(e.children=n)}}function vI(e,t,n){return i;function i(e,i,a,o){let s=Array.isArray(a.children)?n:t;return o?s(i,a,o):s(i,a)}}function v$(e,t){return n;function n(n,i,a,o){let s=Array.isArray(a.children),l=vi(n);return t(i,a,o,s,{columnNumber:l?l.column-1:void 0,fileName:e,lineNumber:l?l.line:void 0},void 0)}}function vO(e,t){let n,i,a={};for(i in t.properties)if("children"!==i&&vp.call(t.properties,i)){let o=vP(e,i,t.properties[i]);if(o){let[i,s]=o;e.tableCellAlignToStyle&&"align"===i&&"string"==typeof s&&vm.has(t.tagName)?n=s:a[i]=s}}return n&&((a.style||(a.style={}))["css"===e.stylePropertyNameCase?"text-align":"textAlign"]=n),a}function vA(e,t){let n={};for(let i of t.attributes)if("mdxJsxExpressionAttribute"===i.type)if(i.data&&i.data.estree&&e.evaluater){let t=i.data.estree.body[0];t.type;let a=t.expression;a.type;let o=a.properties[0];o.type,Object.assign(n,e.evaluater.evaluateExpression(o.argument))}else vz(e,t.position);else{let a,o=i.name;if(i.value&&"object"==typeof i.value)if(i.value.data&&i.value.data.estree&&e.evaluater){let t=i.value.data.estree.body[0];t.type,a=e.evaluater.evaluateExpression(t.expression)}else vz(e,t.position);else a=null===i.value||i.value;n[o]=a}return n}function vN(e,t){let n=[],i=-1,a=e.passKeys?new Map:vh;for(;++i<t.children.length;){let o,s=t.children[i];if(e.passKeys){let e="element"===s.type?s.tagName:"mdxJsxFlowElement"===s.type||"mdxJsxTextElement"===s.type?s.name:void 0;if(e){let t=a.get(e)||0;o=e+"-"+t,a.set(e,t+1)}}let l=vv(e,s,o);void 0!==l&&n.push(l)}return n}function vP(e,t,n){let i=b8(e.schema,t);if(!(null==n||"number"==typeof n&&Number.isNaN(n))){if(Array.isArray(n)&&(n=i.commaSeparated?bS(n):vt(n)),"style"===i.property){let t="object"==typeof n?n:vD(e,String(n));return"css"===e.stylePropertyNameCase&&(t=vj(t)),["style",t]}return["react"===e.elementAttributeNameCase&&i.space?ve[i.property]||i.property:i.attribute,n]}}function vD(e,t){try{return vn(t,{reactCompat:!0})}catch(i){if(e.ignoreInvalidStyle)return{};let t=i,n=new vd("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:t,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=vy+"#cannot-parse-style-attribute",n}}function vM(e,t,n){let i;if(n)if(t.includes(".")){let e,n=t.split("."),a=-1;for(;++a<n.length;){let t=bE(n[a])?{type:"Identifier",name:n[a]}:{type:"Literal",value:n[a]};e=e?{type:"MemberExpression",object:e,property:t,computed:!!(a&&"Literal"===t.type),optional:!1}:t}i=e}else i=bE(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};else i={type:"Literal",value:t};if("Literal"===i.type){let t=i.value;return vp.call(e.components,t)?e.components[t]:t}if(e.evaluater)return e.evaluater.evaluateExpression(i);vz(e)}function vz(e,t){let n=new vd("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=vy+"#cannot-handle-mdx-estrees-without-createevaluater",n}function vj(e){let t,n={};for(t in e)vp.call(e,t)&&(n[vR(t)]=e[t]);return n}function vR(e){let t=e.replace(vf,vL);return"ms-"===t.slice(0,3)&&(t="-"+t),t}function vL(e){return"-"+e.toLowerCase()}let vF={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},vB={};function vU(e,t){let n=t||vB;return vV(e,"boolean"!=typeof n.includeImageAlt||n.includeImageAlt,"boolean"!=typeof n.includeHtml||n.includeHtml)}function vV(e,t,n){if(vH(e)){if("value"in e)return"html"!==e.type||n?e.value:"";if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return vG(e.children,t,n)}return Array.isArray(e)?vG(e,t,n):""}function vG(e,t,n){let i=[],a=-1;for(;++a<e.length;)i[a]=vV(e[a],t,n);return i.join("")}function vH(e){return!!(e&&"object"==typeof e)}function vW(e,t,n,i){let a,o=e.length,s=0;if(t=t<0?-t>o?0:o+t:t>o?o:t,n=n>0?n:0,i.length<1e4)(a=Array.from(i)).unshift(t,n),e.splice(...a);else for(n&&e.splice(t,n);s<i.length;)(a=i.slice(s,s+1e4)).unshift(t,0),e.splice(...a),s+=1e4,t+=1e4}function vq(e,t){return e.length>0?(vW(e,e.length,0,t),e):t}class vK{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,t){let n=null==t?1/0:t;return n<this.left.length?this.left.slice(e,n):e>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(e,t,n){let i=t||0;this.setCursor(Math.trunc(e));let a=this.right.splice(this.right.length-i,1/0);return n&&vX(this.left,n),a.reverse()}pop(){return this.setCursor(1/0),this.left.pop()}push(e){this.setCursor(1/0),this.left.push(e)}pushMany(e){this.setCursor(1/0),vX(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),vX(this.right,e.reverse())}setCursor(e){if(e!==this.left.length&&(!(e>this.left.length)||0!==this.right.length)&&(!(e<0)||0!==this.left.length))if(e<this.left.length){let t=this.left.splice(e,1/0);vX(this.right,t.reverse())}else{let t=this.right.splice(this.left.length+this.right.length-e,1/0);vX(this.left,t.reverse())}}}function vX(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function vZ(e){let t,n,i,a,o,s,l,u={},c=-1,d=new vK(e);for(;++c<d.length;){for(;c in u;)c=u[c];if(t=d.get(c),c&&"chunkFlow"===t[1].type&&"listItemPrefix"===d.get(c-1)[1].type&&((i=0)<(s=t[1]._tokenizer.events).length&&"lineEndingBlank"===s[i][1].type&&(i+=2),i<s.length&&"content"===s[i][1].type))for(;++i<s.length&&"content"!==s[i][1].type;)"chunkText"===s[i][1].type&&(s[i][1]._isInFirstContentOfListItem=!0,i++);if("enter"===t[0])t[1].contentType&&(Object.assign(u,vY(d,c)),c=u[c],l=!0);else if(t[1]._container){for(i=c,n=void 0;i--;)if("lineEnding"===(a=d.get(i))[1].type||"lineEndingBlank"===a[1].type)"enter"===a[0]&&(n&&(d.get(n)[1].type="lineEndingBlank"),a[1].type="lineEnding",n=i);else if("linePrefix"===a[1].type||"listItemIndent"===a[1].type);else break;n&&(t[1].end={...d.get(n)[1].start},(o=d.slice(n,c)).unshift(t),d.splice(n,c-n+1,o))}}return vW(e,0,1/0,d.slice(0)),!l}function vY(e,t){let n,i,a=e.get(t)[1],o=e.get(t)[2],s=t-1,l=[],u=a._tokenizer;!u&&(u=o.parser[a.contentType](a.start),a._contentTypeTextTrailing&&(u._contentTypeTextTrailing=!0));let c=u.events,d=[],p={},h=-1,f=a,g=0,m=0,y=[0];for(;f;){for(;e.get(++s)[1]!==f;);l.push(s),!f._tokenizer&&(n=o.sliceStream(f),f.next||n.push(null),i&&u.defineSkip(f.start),f._isInFirstContentOfListItem&&(u._gfmTasklistFirstContentOfListItem=!0),u.write(n),f._isInFirstContentOfListItem&&(u._gfmTasklistFirstContentOfListItem=void 0)),i=f,f=f.next}for(f=a;++h<c.length;)"exit"===c[h][0]&&"enter"===c[h-1][0]&&c[h][1].type===c[h-1][1].type&&c[h][1].start.line!==c[h][1].end.line&&(m=h+1,y.push(m),f._tokenizer=void 0,f.previous=void 0,f=f.next);for(u.events=[],f?(f._tokenizer=void 0,f.previous=void 0):y.pop(),h=y.length;h--;){let t=c.slice(y[h],y[h+1]),n=l.pop();d.push([n,n+t.length-1]),e.splice(n,2,t)}for(d.reverse(),h=-1;++h<d.length;)p[g+d[h][0]]=g+d[h][1],g+=d[h][1]-d[h][0]-1;return p}function vQ(e){for(;!vZ(e););return e}let vJ={}.hasOwnProperty;function v0(e){let t={},n=-1;for(;++n<e.length;)v1(t,e[n]);return t}function v1(e,t){let n;for(n in t){let i,a=(vJ.call(e,n)?e[n]:void 0)||(e[n]={}),o=t[n];if(o)for(i in o){vJ.call(a,i)||(a[i]=[]);let e=o[i];v2(a[i],Array.isArray(e)?e:e?[e]:[])}}}function v2(e,t){let n=-1,i=[];for(;++n<t.length;)("after"===t[n].add?e:i).push(t[n]);vW(e,0,0,i)}let v3=xa(/[A-Za-z]/),v4=xa(/[\dA-Za-z]/),v6=xa(/[#-'*+\--9=?A-Z^-~]/);function v5(e){return null!==e&&(e<32||127===e)}let v8=xa(/\d/),v7=xa(/[\dA-Fa-f]/),v9=xa(/[!-/:-@[-`{-~]/);function xe(e){return null!==e&&e<-2}function xt(e){return null!==e&&(e<0||32===e)}function xn(e){return -2===e||-1===e||32===e}let xr=xa(/\p{P}|\p{S}/u),xi=xa(/\s/);function xa(e){return t;function t(t){return null!==t&&t>-1&&e.test(String.fromCharCode(t))}}function xo(e,t,n,i){let a=i?i-1:1/0,o=0;return s;function s(i){return xn(i)?(e.enter(n),l(i)):t(i)}function l(i){return xn(i)&&o++<a?(e.consume(i),l):(e.exit(n),t(i))}}let xs={tokenize:xl};function xl(e){let t,n=e.attempt(this.parser.constructs.contentInitial,i,a);return n;function i(t){return null===t?void e.consume(t):(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),xo(e,n,"linePrefix"))}function a(t){return e.enter("paragraph"),o(t)}function o(n){let i=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=i),t=i,s(n)}function s(t){if(null===t){e.exit("chunkText"),e.exit("paragraph"),e.consume(t);return}return xe(t)?(e.consume(t),e.exit("chunkText"),o):(e.consume(t),s)}}let xu={tokenize:xd},xc={tokenize:xp};function xd(e){let t,n,i,a=this,o=[],s=0;return l;function l(t){if(s<o.length){let n=o[s];return a.containerState=n[1],e.attempt(n[0].continuation,u,c)(t)}return c(t)}function u(e){if(s++,a.containerState._closeFlow){let n;a.containerState._closeFlow=void 0,t&&v();let i=a.events.length,o=i;for(;o--;)if("exit"===a.events[o][0]&&"chunkFlow"===a.events[o][1].type){n=a.events[o][1].end;break}b(s);let l=i;for(;l<a.events.length;)a.events[l][1].end={...n},l++;return vW(a.events,o+1,0,a.events.slice(i)),a.events.length=l,c(e)}return l(e)}function c(n){if(s===o.length){if(!t)return h(n);if(t.currentConstruct&&t.currentConstruct.concrete)return g(n);a.interrupt=!!(t.currentConstruct&&!t._gfmTableDynamicInterruptHack)}return a.containerState={},e.check(xc,d,p)(n)}function d(e){return t&&v(),b(s),h(e)}function p(e){return a.parser.lazy[a.now().line]=s!==o.length,i=a.now().offset,g(e)}function h(t){return a.containerState={},e.attempt(xc,f,g)(t)}function f(e){return s++,o.push([a.currentConstruct,a.containerState]),h(e)}function g(i){if(null===i){t&&v(),b(0),e.consume(i);return}return t=t||a.parser.flow(a.now()),e.enter("chunkFlow",{_tokenizer:t,contentType:"flow",previous:n}),m(i)}function m(t){if(null===t){y(e.exit("chunkFlow"),!0),b(0),e.consume(t);return}return xe(t)?(e.consume(t),y(e.exit("chunkFlow")),s=0,a.interrupt=void 0,l):(e.consume(t),m)}function y(e,o){let l=a.sliceStream(e);if(o&&l.push(null),e.previous=n,n&&(n.next=e),n=e,t.defineSkip(e.start),t.write(l),a.parser.lazy[e.start.line]){let e,n,o=t.events.length;for(;o--;)if(t.events[o][1].start.offset<i&&(!t.events[o][1].end||t.events[o][1].end.offset>i))return;let l=a.events.length,u=l;for(;u--;)if("exit"===a.events[u][0]&&"chunkFlow"===a.events[u][1].type){if(e){n=a.events[u][1].end;break}e=!0}for(b(s),o=l;o<a.events.length;)a.events[o][1].end={...n},o++;vW(a.events,u+1,0,a.events.slice(l)),a.events.length=o}}function b(t){let n=o.length;for(;n-- >t;){let t=o[n];a.containerState=t[1],t[0].exit.call(a,e)}o.length=t}function v(){t.write([null]),n=void 0,t=void 0,a.containerState._closeFlow=void 0}}function xp(e,t,n){return xo(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}let xh={partial:!0,tokenize:xf};function xf(e,t,n){return i;function i(t){return xn(t)?xo(e,a,"linePrefix")(t):a(t)}function a(e){return null===e||xe(e)?t(e):n(e)}}let xg={resolve:xy,tokenize:xb},xm={partial:!0,tokenize:xv};function xy(e){return vZ(e),e}function xb(e,t){let n;return i;function i(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),a(t)}function a(t){return null===t?o(t):xe(t)?e.check(xm,s,o)(t):(e.consume(t),a)}function o(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function s(t){return e.consume(t),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,a}}function xv(e,t,n){let i=this;return a;function a(t){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),xo(e,o,"linePrefix")}function o(a){if(null===a||xe(a))return n(a);let o=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&o&&"linePrefix"===o[1].type&&o[2].sliceSerialize(o[1],!0).length>=4?t(a):e.interrupt(i.parser.constructs.flow,n,t)(a)}}let xx={tokenize:xw};function xw(e){let t=this,n=e.attempt(xh,i,e.attempt(this.parser.constructs.flowInitial,a,xo(e,e.attempt(this.parser.constructs.flow,a,e.attempt(xg,a)),"linePrefix")));return n;function i(i){return null===i?void e.consume(i):(e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n)}function a(i){return null===i?void e.consume(i):(e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,n)}}let x_={resolveAll:xC()},xS=xT("string"),xk=xT("text");function xT(e){return{resolveAll:xC("text"===e?xE:void 0),tokenize:t};function t(t){let n=this,i=this.parser.constructs[e],a=t.attempt(i,o,s);return o;function o(e){return u(e)?a(e):s(e)}function s(e){return null===e?void t.consume(e):(t.enter("data"),t.consume(e),l)}function l(e){return u(e)?(t.exit("data"),a(e)):(t.consume(e),l)}function u(e){if(null===e)return!0;let t=i[e],a=-1;if(t)for(;++a<t.length;){let e=t[a];if(!e.previous||e.previous.call(n,n.previous))return!0}return!1}}}function xC(e){return t;function t(t,n){let i,a=-1;for(;++a<=t.length;)void 0===i?t[a]&&"data"===t[a][1].type&&(i=a,a++):t[a]&&"data"===t[a][1].type||(a!==i+2&&(t[i][1].end=t[a-1][1].end,t.splice(i+2,a-i-2),a=i+2),i=void 0);return e?e(t,n):t}}function xE(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||"lineEnding"===e[n][1].type)&&"data"===e[n-1][1].type){let i,a=e[n-1][1],o=t.sliceStream(a),s=o.length,l=-1,u=0;for(;s--;){let e=o[s];if("string"==typeof e){for(l=e.length;32===e.charCodeAt(l-1);)u++,l--;if(l)break;l=-1}else if(-2===e)i=!0,u++;else if(-1===e);else{s++;break}}if(t._contentTypeTextTrailing&&n===e.length&&(u=0),u){let o={type:n===e.length||i||u<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?l:a.start._bufferIndex+l,_index:a.start._index+s,line:a.end.line,column:a.end.column-u,offset:a.end.offset-u},end:{...a.end}};a.end={...o.start},a.start.offset===a.end.offset?Object.assign(a,o):(e.splice(n,0,["enter",o,t],["exit",o,t]),n+=2)}n++}return e}let xI={name:"thematicBreak",tokenize:x$};function x$(e,t,n){let i,a=0;return o;function o(t){return e.enter("thematicBreak"),s(t)}function s(e){return i=e,l(e)}function l(o){return o===i?(e.enter("thematicBreakSequence"),u(o)):a>=3&&(null===o||xe(o))?(e.exit("thematicBreak"),t(o)):n(o)}function u(t){return t===i?(e.consume(t),a++,u):(e.exit("thematicBreakSequence"),xn(t)?xo(e,l,"whitespace")(t):l(t))}}let xO={continuation:{tokenize:xD},exit:xz,name:"list",tokenize:xP},xA={partial:!0,tokenize:xj},xN={partial:!0,tokenize:xM};function xP(e,t,n){let i=this,a=i.events[i.events.length-1],o=a&&"linePrefix"===a[1].type?a[2].sliceSerialize(a[1],!0).length:0,s=0;return l;function l(t){let a=i.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===a?!i.containerState.marker||t===i.containerState.marker:v8(t)){if(i.containerState.type||(i.containerState.type=a,e.enter(a,{_container:!0})),"listUnordered"===a)return e.enter("listItemPrefix"),42===t||45===t?e.check(xI,n,c)(t):c(t);if(!i.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(t)}return n(t)}function u(t){return v8(t)&&++s<10?(e.consume(t),u):(!i.interrupt||s<2)&&(i.containerState.marker?t===i.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),c(t)):n(t)}function c(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||t,e.check(xh,i.interrupt?n:d,e.attempt(xA,h,p))}function d(e){return i.containerState.initialBlankLine=!0,o++,h(e)}function p(t){return xn(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),h):n(t)}function h(n){return i.containerState.size=o+i.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(n)}}function xD(e,t,n){let i=this;return i.containerState._closeFlow=void 0,e.check(xh,a,o);function a(n){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,xo(e,t,"listItemIndent",i.containerState.size+1)(n)}function o(n){return i.containerState.furtherBlankLines||!xn(n)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,s(n)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,e.attempt(xN,t,s)(n))}function s(a){return i.containerState._closeFlow=!0,i.interrupt=void 0,xo(e,e.attempt(xO,t,n),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a)}}function xM(e,t,n){let i=this;return xo(e,a,"listItemIndent",i.containerState.size+1);function a(e){let a=i.events[i.events.length-1];return a&&"listItemIndent"===a[1].type&&a[2].sliceSerialize(a[1],!0).length===i.containerState.size?t(e):n(e)}}function xz(e){e.exit(this.containerState.type)}function xj(e,t,n){let i=this;return xo(e,a,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(e){let a=i.events[i.events.length-1];return!xn(e)&&a&&"listItemPrefixWhitespace"===a[1].type?t(e):n(e)}}let xR={continuation:{tokenize:xF},exit:xB,name:"blockQuote",tokenize:xL};function xL(e,t,n){let i=this;return a;function a(t){if(62===t){let n=i.containerState;return n.open||(e.enter("blockQuote",{_container:!0}),n.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),o}return n(t)}function o(n){return xn(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}}function xF(e,t,n){let i=this;return a;function a(t){return xn(t)?xo(e,o,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):o(t)}function o(i){return e.attempt(xR,t,n)(i)}}function xB(e){e.exit("blockQuote")}function xU(e,t,n,i,a,o,s,l,u){let c=u||1/0,d=0;return p;function p(t){return 60===t?(e.enter(i),e.enter(a),e.enter(o),e.consume(t),e.exit(o),h):null===t||32===t||41===t||v5(t)?n(t):(e.enter(i),e.enter(s),e.enter(l),e.enter("chunkString",{contentType:"string"}),m(t))}function h(n){return 62===n?(e.enter(o),e.consume(n),e.exit(o),e.exit(a),e.exit(i),t):(e.enter(l),e.enter("chunkString",{contentType:"string"}),f(n))}function f(t){return 62===t?(e.exit("chunkString"),e.exit(l),h(t)):null===t||60===t||xe(t)?n(t):(e.consume(t),92===t?g:f)}function g(t){return 60===t||62===t||92===t?(e.consume(t),f):f(t)}function m(a){return!d&&(null===a||41===a||xt(a))?(e.exit("chunkString"),e.exit(l),e.exit(s),e.exit(i),t(a)):d<c&&40===a?(e.consume(a),d++,m):41===a?(e.consume(a),d--,m):null===a||32===a||40===a||v5(a)?n(a):(e.consume(a),92===a?y:m)}function y(t){return 40===t||41===t||92===t?(e.consume(t),m):m(t)}}function xV(e,t,n,i,a,o){let s,l=this,u=0;return c;function c(t){return e.enter(i),e.enter(a),e.consume(t),e.exit(a),e.enter(o),d}function d(c){return u>999||null===c||91===c||93===c&&!s||94===c&&!u&&"_hiddenFootnoteSupport"in l.parser.constructs?n(c):93===c?(e.exit(o),e.enter(a),e.consume(c),e.exit(a),e.exit(i),t):xe(c)?(e.enter("lineEnding"),e.consume(c),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),p(c))}function p(t){return null===t||91===t||93===t||xe(t)||u++>999?(e.exit("chunkString"),d(t)):(e.consume(t),s||(s=!xn(t)),92===t?h:p)}function h(t){return 91===t||92===t||93===t?(e.consume(t),u++,p):p(t)}}function xG(e,t,n,i,a,o){let s;return l;function l(t){return 34===t||39===t||40===t?(e.enter(i),e.enter(a),e.consume(t),e.exit(a),s=40===t?41:t,u):n(t)}function u(n){return n===s?(e.enter(a),e.consume(n),e.exit(a),e.exit(i),t):(e.enter(o),c(n))}function c(t){return t===s?(e.exit(o),u(s)):null===t?n(t):xe(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),xo(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(t))}function d(t){return t===s||null===t||xe(t)?(e.exit("chunkString"),c(t)):(e.consume(t),92===t?p:d)}function p(t){return t===s||92===t?(e.consume(t),d):d(t)}}function xH(e,t){let n;return i;function i(a){return xe(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),n=!0,i):xn(a)?xo(e,i,n?"linePrefix":"lineSuffix")(a):t(a)}}function xW(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}let xq={name:"definition",tokenize:xX},xK={partial:!0,tokenize:xZ};function xX(e,t,n){let i,a=this;return o;function o(t){return e.enter("definition"),s(t)}function s(t){return xV.call(a,e,l,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)}function l(t){return(i=xW(a.sliceSerialize(a.events[a.events.length-1][1]).slice(1,-1)),58===t)?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),u):n(t)}function u(t){return xt(t)?xH(e,c)(t):c(t)}function c(t){return xU(e,d,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(t)}function d(t){return e.attempt(xK,p,p)(t)}function p(t){return xn(t)?xo(e,h,"whitespace")(t):h(t)}function h(o){return null===o||xe(o)?(e.exit("definition"),a.parser.defined.push(i),t(o)):n(o)}}function xZ(e,t,n){return i;function i(t){return xt(t)?xH(e,a)(t):n(t)}function a(t){return xG(e,o,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t)}function o(t){return xn(t)?xo(e,s,"whitespace")(t):s(t)}function s(e){return null===e||xe(e)?t(e):n(e)}}let xY={name:"codeIndented",tokenize:xJ},xQ={partial:!0,tokenize:x0};function xJ(e,t,n){let i=this;return a;function a(t){return e.enter("codeIndented"),xo(e,o,"linePrefix",5)(t)}function o(e){let t=i.events[i.events.length-1];return t&&"linePrefix"===t[1].type&&t[2].sliceSerialize(t[1],!0).length>=4?s(e):n(e)}function s(t){return null===t?u(t):xe(t)?e.attempt(xQ,s,u)(t):(e.enter("codeFlowValue"),l(t))}function l(t){return null===t||xe(t)?(e.exit("codeFlowValue"),s(t)):(e.consume(t),l)}function u(n){return e.exit("codeIndented"),t(n)}}function x0(e,t,n){let i=this;return a;function a(t){return i.parser.lazy[i.now().line]?n(t):xe(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),a):xo(e,o,"linePrefix",5)(t)}function o(e){let o=i.events[i.events.length-1];return o&&"linePrefix"===o[1].type&&o[2].sliceSerialize(o[1],!0).length>=4?t(e):xe(e)?a(e):n(e)}}let x1={name:"headingAtx",resolve:x2,tokenize:x3};function x2(e,t){let n,i,a=e.length-2,o=3;return"whitespace"===e[3][1].type&&(o+=2),a-2>o&&"whitespace"===e[a][1].type&&(a-=2),"atxHeadingSequence"===e[a][1].type&&(o===a-1||a-4>o&&"whitespace"===e[a-2][1].type)&&(a-=o+1===a?2:4),a>o&&(n={type:"atxHeadingText",start:e[o][1].start,end:e[a][1].end},i={type:"chunkText",start:e[o][1].start,end:e[a][1].end,contentType:"text"},vW(e,o,a-o+1,[["enter",n,t],["enter",i,t],["exit",i,t],["exit",n,t]])),e}function x3(e,t,n){let i=0;return a;function a(t){return e.enter("atxHeading"),o(t)}function o(t){return e.enter("atxHeadingSequence"),s(t)}function s(t){return 35===t&&i++<6?(e.consume(t),s):null===t||xt(t)?(e.exit("atxHeadingSequence"),l(t)):n(t)}function l(n){return 35===n?(e.enter("atxHeadingSequence"),u(n)):null===n||xe(n)?(e.exit("atxHeading"),t(n)):xn(n)?xo(e,l,"whitespace")(n):(e.enter("atxHeadingText"),c(n))}function u(t){return 35===t?(e.consume(t),u):(e.exit("atxHeadingSequence"),l(t))}function c(t){return null===t||35===t||xt(t)?(e.exit("atxHeadingText"),l(t)):(e.consume(t),c)}}let x4={name:"setextUnderline",resolveTo:x6,tokenize:x5};function x6(e,t){let n,i,a,o=e.length;for(;o--;)if("enter"===e[o][0]){if("content"===e[o][1].type){n=o;break}"paragraph"===e[o][1].type&&(i=o)}else"content"===e[o][1].type&&e.splice(o,1),a||"definition"!==e[o][1].type||(a=o);let s={type:"setextHeading",start:{...e[n][1].start},end:{...e[e.length-1][1].end}};return e[i][1].type="setextHeadingText",a?(e.splice(i,0,["enter",s,t]),e.splice(a+1,0,["exit",e[n][1],t]),e[n][1].end={...e[a][1].end}):e[n][1]=s,e.push(["exit",s,t]),e}function x5(e,t,n){let i,a=this;return o;function o(t){let o,l=a.events.length;for(;l--;)if("lineEnding"!==a.events[l][1].type&&"linePrefix"!==a.events[l][1].type&&"content"!==a.events[l][1].type){o="paragraph"===a.events[l][1].type;break}return!a.parser.lazy[a.now().line]&&(a.interrupt||o)?(e.enter("setextHeadingLine"),i=t,s(t)):n(t)}function s(t){return e.enter("setextHeadingLineSequence"),l(t)}function l(t){return t===i?(e.consume(t),l):(e.exit("setextHeadingLineSequence"),xn(t)?xo(e,u,"lineSuffix")(t):u(t))}function u(i){return null===i||xe(i)?(e.exit("setextHeadingLine"),t(i)):n(i)}}let x8=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],x7=["pre","script","style","textarea"],x9={concrete:!0,name:"htmlFlow",resolveTo:wn,tokenize:wr},we={partial:!0,tokenize:wa},wt={partial:!0,tokenize:wi};function wn(e){let t=e.length;for(;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););return t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function wr(e,t,n){let i,a,o,s,l,u=this;return c;function c(e){return d(e)}function d(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),p}function p(s){return 33===s?(e.consume(s),h):47===s?(e.consume(s),a=!0,m):63===s?(e.consume(s),i=3,u.interrupt?t:j):v3(s)?(e.consume(s),o=String.fromCharCode(s),y):n(s)}function h(a){return 45===a?(e.consume(a),i=2,f):91===a?(e.consume(a),i=5,s=0,g):v3(a)?(e.consume(a),i=4,u.interrupt?t:j):n(a)}function f(i){return 45===i?(e.consume(i),u.interrupt?t:j):n(i)}function g(i){let a="CDATA[";return i===a.charCodeAt(s++)?(e.consume(i),s===a.length)?u.interrupt?t:$:g:n(i)}function m(t){return v3(t)?(e.consume(t),o=String.fromCharCode(t),y):n(t)}function y(s){if(null===s||47===s||62===s||xt(s)){let l=47===s,c=o.toLowerCase();return!l&&!a&&x7.includes(c)?(i=1,u.interrupt?t(s):$(s)):x8.includes(o.toLowerCase())?(i=6,l)?(e.consume(s),b):u.interrupt?t(s):$(s):(i=7,u.interrupt&&!u.parser.lazy[u.now().line]?n(s):a?v(s):x(s))}return 45===s||v4(s)?(e.consume(s),o+=String.fromCharCode(s),y):n(s)}function b(i){return 62===i?(e.consume(i),u.interrupt?t:$):n(i)}function v(t){return xn(t)?(e.consume(t),v):E(t)}function x(t){return 47===t?(e.consume(t),E):58===t||95===t||v3(t)?(e.consume(t),w):xn(t)?(e.consume(t),x):E(t)}function w(t){return 45===t||46===t||58===t||95===t||v4(t)?(e.consume(t),w):_(t)}function _(t){return 61===t?(e.consume(t),S):xn(t)?(e.consume(t),_):x(t)}function S(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),l=t,k):xn(t)?(e.consume(t),S):T(t)}function k(t){return t===l?(e.consume(t),l=null,C):null===t||xe(t)?n(t):(e.consume(t),k)}function T(t){return null===t||34===t||39===t||47===t||60===t||61===t||62===t||96===t||xt(t)?_(t):(e.consume(t),T)}function C(e){return 47===e||62===e||xn(e)?x(e):n(e)}function E(t){return 62===t?(e.consume(t),I):n(t)}function I(t){return null===t||xe(t)?$(t):xn(t)?(e.consume(t),I):n(t)}function $(t){return 45===t&&2===i?(e.consume(t),P):60===t&&1===i?(e.consume(t),D):62===t&&4===i?(e.consume(t),R):63===t&&3===i?(e.consume(t),j):93===t&&5===i?(e.consume(t),z):xe(t)&&(6===i||7===i)?(e.exit("htmlFlowData"),e.check(we,L,O)(t)):null===t||xe(t)?(e.exit("htmlFlowData"),O(t)):(e.consume(t),$)}function O(t){return e.check(wt,A,L)(t)}function A(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),N}function N(t){return null===t||xe(t)?O(t):(e.enter("htmlFlowData"),$(t))}function P(t){return 45===t?(e.consume(t),j):$(t)}function D(t){return 47===t?(e.consume(t),o="",M):$(t)}function M(t){if(62===t){let n=o.toLowerCase();return x7.includes(n)?(e.consume(t),R):$(t)}return v3(t)&&o.length<8?(e.consume(t),o+=String.fromCharCode(t),M):$(t)}function z(t){return 93===t?(e.consume(t),j):$(t)}function j(t){return 62===t?(e.consume(t),R):45===t&&2===i?(e.consume(t),j):$(t)}function R(t){return null===t||xe(t)?(e.exit("htmlFlowData"),L(t)):(e.consume(t),R)}function L(n){return e.exit("htmlFlow"),t(n)}}function wi(e,t,n){let i=this;return a;function a(t){return xe(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o):n(t)}function o(e){return i.parser.lazy[i.now().line]?n(e):t(e)}}function wa(e,t,n){return i;function i(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),e.attempt(xh,t,n)}}let wo={partial:!0,tokenize:wu},ws={concrete:!0,name:"codeFenced",tokenize:wl};function wl(e,t,n){let i,a=this,o={partial:!0,tokenize:_},s=0,l=0;return u;function u(e){return c(e)}function c(t){let n=a.events[a.events.length-1];return s=n&&"linePrefix"===n[1].type?n[2].sliceSerialize(n[1],!0).length:0,i=t,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),d(t)}function d(t){return t===i?(l++,e.consume(t),d):l<3?n(t):(e.exit("codeFencedFenceSequence"),xn(t)?xo(e,p,"whitespace")(t):p(t))}function p(n){return null===n||xe(n)?(e.exit("codeFencedFence"),a.interrupt?t(n):e.check(wo,m,w)(n)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),h(n))}function h(t){return null===t||xe(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),p(t)):xn(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),xo(e,f,"whitespace")(t)):96===t&&t===i?n(t):(e.consume(t),h)}function f(t){return null===t||xe(t)?p(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),g(t))}function g(t){return null===t||xe(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),p(t)):96===t&&t===i?n(t):(e.consume(t),g)}function m(t){return e.attempt(o,w,y)(t)}function y(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),b}function b(t){return s>0&&xn(t)?xo(e,v,"linePrefix",s+1)(t):v(t)}function v(t){return null===t||xe(t)?e.check(wo,m,w)(t):(e.enter("codeFlowValue"),x(t))}function x(t){return null===t||xe(t)?(e.exit("codeFlowValue"),v(t)):(e.consume(t),x)}function w(n){return e.exit("codeFenced"),t(n)}function _(e,t,n){let o=0;return s;function s(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),u}function u(t){return e.enter("codeFencedFence"),xn(t)?xo(e,c,"linePrefix",a.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):c(t)}function c(t){return t===i?(e.enter("codeFencedFenceSequence"),d(t)):n(t)}function d(t){return t===i?(o++,e.consume(t),d):o>=l?(e.exit("codeFencedFenceSequence"),xn(t)?xo(e,p,"whitespace")(t):p(t)):n(t)}function p(i){return null===i||xe(i)?(e.exit("codeFencedFence"),t(i)):n(i)}}}function wu(e,t,n){let i=this;return a;function a(t){return null===t?n(t):(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o)}function o(e){return i.parser.lazy[i.now().line]?n(e):t(e)}}let wc=document.createElement("i");function wd(e){let t="&"+e+";";wc.innerHTML=t;let n=wc.textContent;return(59!==n.charCodeAt(n.length-1)||"semi"===e)&&n!==t&&n}let wp={name:"characterReference",tokenize:wh};function wh(e,t,n){let i,a,o=this,s=0;return l;function l(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),u}function u(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),c):(e.enter("characterReferenceValue"),i=31,a=v4,d(t))}function c(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,a=v7,d):(e.enter("characterReferenceValue"),i=7,a=v8,d(t))}function d(l){if(59===l&&s){let i=e.exit("characterReferenceValue");return a!==v4||wd(o.sliceSerialize(i))?(e.enter("characterReferenceMarker"),e.consume(l),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(l)}return a(l)&&s++<i?(e.consume(l),d):n(l)}}let wf={name:"characterEscape",tokenize:wg};function wg(e,t,n){return i;function i(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),a}function a(i){return v9(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(i)}}let wm={name:"lineEnding",tokenize:wy};function wy(e,t){return n;function n(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),xo(e,t,"linePrefix")}}function wb(e,t,n){let i=[],a=-1;for(;++a<e.length;){let o=e[a].resolveAll;o&&!i.includes(o)&&(t=o(t,n),i.push(o))}return t}let wv={name:"labelEnd",resolveAll:wS,resolveTo:wk,tokenize:wT},wx={tokenize:wC},ww={tokenize:wE},w_={tokenize:wI};function wS(e){let t=-1,n=[];for(;++t<e.length;){let i=e[t][1];if(n.push(e[t]),"labelImage"===i.type||"labelLink"===i.type||"labelEnd"===i.type){let e="labelImage"===i.type?4:2;i.type="data",t+=e}}return e.length!==n.length&&vW(e,0,e.length,n),e}function wk(e,t){let n,i,a,o,s=e.length,l=0;for(;s--;)if(n=e[s][1],i){if("link"===n.type||"labelLink"===n.type&&n._inactive)break;"enter"===e[s][0]&&"labelLink"===n.type&&(n._inactive=!0)}else if(a){if("enter"===e[s][0]&&("labelImage"===n.type||"labelLink"===n.type)&&!n._balanced&&(i=s,"labelLink"!==n.type)){l=2;break}}else"labelEnd"===n.type&&(a=s);let u={type:"labelLink"===e[i][1].type?"link":"image",start:{...e[i][1].start},end:{...e[e.length-1][1].end}},c={type:"label",start:{...e[i][1].start},end:{...e[a][1].end}},d={type:"labelText",start:{...e[i+l+2][1].end},end:{...e[a-2][1].start}};return o=vq(o=[["enter",u,t],["enter",c,t]],e.slice(i+1,i+l+3)),o=vq(o,[["enter",d,t]]),o=vq(o,wb(t.parser.constructs.insideSpan.null,e.slice(i+l+4,a-3),t)),o=vq(o,[["exit",d,t],e[a-2],e[a-1],["exit",c,t]]),o=vq(o,e.slice(a+1)),o=vq(o,[["exit",u,t]]),vW(e,i,e.length,o),e}function wT(e,t,n){let i,a,o=this,s=o.events.length;for(;s--;)if(("labelImage"===o.events[s][1].type||"labelLink"===o.events[s][1].type)&&!o.events[s][1]._balanced){i=o.events[s][1];break}return l;function l(t){return i?i._inactive?p(t):(a=o.parser.defined.includes(xW(o.sliceSerialize({start:i.end,end:o.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),u):n(t)}function u(t){return 40===t?e.attempt(wx,d,a?d:p)(t):91===t?e.attempt(ww,d,a?c:p)(t):a?d(t):p(t)}function c(t){return e.attempt(w_,d,p)(t)}function d(e){return t(e)}function p(e){return i._balanced=!0,n(e)}}function wC(e,t,n){return i;function i(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),a}function a(t){return xt(t)?xH(e,o)(t):o(t)}function o(t){return 41===t?d(t):xU(e,s,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(t)}function s(t){return xt(t)?xH(e,u)(t):d(t)}function l(e){return n(e)}function u(t){return 34===t||39===t||40===t?xG(e,c,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):d(t)}function c(t){return xt(t)?xH(e,d)(t):d(t)}function d(i){return 41===i?(e.enter("resourceMarker"),e.consume(i),e.exit("resourceMarker"),e.exit("resource"),t):n(i)}}function wE(e,t,n){let i=this;return a;function a(t){return xV.call(i,e,o,s,"reference","referenceMarker","referenceString")(t)}function o(e){return i.parser.defined.includes(xW(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?t(e):n(e)}function s(e){return n(e)}}function wI(e,t,n){return i;function i(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),a}function a(i){return 93===i?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):n(i)}}let w$={name:"labelStartImage",resolveAll:wv.resolveAll,tokenize:wO};function wO(e,t,n){let i=this;return a;function a(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),o}function o(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),s):n(t)}function s(e){return 94===e&&"_hiddenFootnoteSupport"in i.parser.constructs?n(e):t(e)}}function wA(e){return null===e||xt(e)||xi(e)?1:xr(e)?2:void 0}let wN={name:"attention",resolveAll:wP,tokenize:wD};function wP(e,t){let n,i,a,o,s,l,u,c,d=-1;for(;++d<e.length;)if("enter"===e[d][0]&&"attentionSequence"===e[d][1].type&&e[d][1]._close){for(n=d;n--;)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[d][1]).charCodeAt(0)){if((e[n][1]._close||e[d][1]._open)&&(e[d][1].end.offset-e[d][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[d][1].end.offset-e[d][1].start.offset)%3))continue;l=e[n][1].end.offset-e[n][1].start.offset>1&&e[d][1].end.offset-e[d][1].start.offset>1?2:1;let p={...e[n][1].end},h={...e[d][1].start};wM(p,-l),wM(h,l),o={type:l>1?"strongSequence":"emphasisSequence",start:p,end:{...e[n][1].end}},s={type:l>1?"strongSequence":"emphasisSequence",start:{...e[d][1].start},end:h},a={type:l>1?"strongText":"emphasisText",start:{...e[n][1].end},end:{...e[d][1].start}},i={type:l>1?"strong":"emphasis",start:{...o.start},end:{...s.end}},e[n][1].end={...o.start},e[d][1].start={...s.end},u=[],e[n][1].end.offset-e[n][1].start.offset&&(u=vq(u,[["enter",e[n][1],t],["exit",e[n][1],t]])),u=vq(u,[["enter",i,t],["enter",o,t],["exit",o,t],["enter",a,t]]),u=vq(u,wb(t.parser.constructs.insideSpan.null,e.slice(n+1,d),t)),u=vq(u,[["exit",a,t],["enter",s,t],["exit",s,t],["exit",i,t]]),e[d][1].end.offset-e[d][1].start.offset?(c=2,u=vq(u,[["enter",e[d][1],t],["exit",e[d][1],t]])):c=0,vW(e,n-1,d-n+3,u),d=n+u.length-c-2;break}}for(d=-1;++d<e.length;)"attentionSequence"===e[d][1].type&&(e[d][1].type="data");return e}function wD(e,t){let n,i=this.parser.constructs.attentionMarkers.null,a=this.previous,o=wA(a);return s;function s(t){return n=t,e.enter("attentionSequence"),l(t)}function l(s){if(s===n)return e.consume(s),l;let u=e.exit("attentionSequence"),c=wA(s),d=!c||2===c&&o||i.includes(s),p=!o||2===o&&c||i.includes(a);return u._open=!!(42===n?d:d&&(o||!p)),u._close=!!(42===n?p:p&&(c||!d)),t(s)}}function wM(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}let wz={name:"autolink",tokenize:wj};function wj(e,t,n){let i=0;return a;function a(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(t){return v3(t)?(e.consume(t),s):64===t?n(t):c(t)}function s(e){return 43===e||45===e||46===e||v4(e)?(i=1,l(e)):c(e)}function l(t){return 58===t?(e.consume(t),i=0,u):(43===t||45===t||46===t||v4(t))&&i++<32?(e.consume(t),l):(i=0,c(t))}function u(i){return 62===i?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(i),e.exit("autolinkMarker"),e.exit("autolink"),t):null===i||32===i||60===i||v5(i)?n(i):(e.consume(i),u)}function c(t){return 64===t?(e.consume(t),d):v6(t)?(e.consume(t),c):n(t)}function d(e){return v4(e)?p(e):n(e)}function p(n){return 46===n?(e.consume(n),i=0,d):62===n?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(n),e.exit("autolinkMarker"),e.exit("autolink"),t):h(n)}function h(t){if((45===t||v4(t))&&i++<63){let n=45===t?h:p;return e.consume(t),n}return n(t)}}let wR={name:"htmlText",tokenize:wL};function wL(e,t,n){let i,a,o,s=this;return l;function l(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),u}function u(t){return 33===t?(e.consume(t),c):47===t?(e.consume(t),_):63===t?(e.consume(t),x):v3(t)?(e.consume(t),T):n(t)}function c(t){return 45===t?(e.consume(t),d):91===t?(e.consume(t),a=0,g):v3(t)?(e.consume(t),v):n(t)}function d(t){return 45===t?(e.consume(t),f):n(t)}function p(t){return null===t?n(t):45===t?(e.consume(t),h):xe(t)?(o=p,D(t)):(e.consume(t),p)}function h(t){return 45===t?(e.consume(t),f):p(t)}function f(e){return 62===e?P(e):45===e?h(e):p(e)}function g(t){let i="CDATA[";return t===i.charCodeAt(a++)?(e.consume(t),a===i.length?m:g):n(t)}function m(t){return null===t?n(t):93===t?(e.consume(t),y):xe(t)?(o=m,D(t)):(e.consume(t),m)}function y(t){return 93===t?(e.consume(t),b):m(t)}function b(t){return 62===t?P(t):93===t?(e.consume(t),b):m(t)}function v(t){return null===t||62===t?P(t):xe(t)?(o=v,D(t)):(e.consume(t),v)}function x(t){return null===t?n(t):63===t?(e.consume(t),w):xe(t)?(o=x,D(t)):(e.consume(t),x)}function w(e){return 62===e?P(e):x(e)}function _(t){return v3(t)?(e.consume(t),S):n(t)}function S(t){return 45===t||v4(t)?(e.consume(t),S):k(t)}function k(t){return xe(t)?(o=k,D(t)):xn(t)?(e.consume(t),k):P(t)}function T(t){return 45===t||v4(t)?(e.consume(t),T):47===t||62===t||xt(t)?C(t):n(t)}function C(t){return 47===t?(e.consume(t),P):58===t||95===t||v3(t)?(e.consume(t),E):xe(t)?(o=C,D(t)):xn(t)?(e.consume(t),C):P(t)}function E(t){return 45===t||46===t||58===t||95===t||v4(t)?(e.consume(t),E):I(t)}function I(t){return 61===t?(e.consume(t),$):xe(t)?(o=I,D(t)):xn(t)?(e.consume(t),I):C(t)}function $(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),i=t,O):xe(t)?(o=$,D(t)):xn(t)?(e.consume(t),$):(e.consume(t),A)}function O(t){return t===i?(e.consume(t),i=void 0,N):null===t?n(t):xe(t)?(o=O,D(t)):(e.consume(t),O)}function A(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):47===t||62===t||xt(t)?C(t):(e.consume(t),A)}function N(e){return 47===e||62===e||xt(e)?C(e):n(e)}function P(i){return 62===i?(e.consume(i),e.exit("htmlTextData"),e.exit("htmlText"),t):n(i)}function D(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),M}function M(t){return xn(t)?xo(e,z,"linePrefix",s.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):z(t)}function z(t){return e.enter("htmlTextData"),o(t)}}let wF={name:"labelStartLink",resolveAll:wv.resolveAll,tokenize:wB};function wB(e,t,n){let i=this;return a;function a(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),o}function o(e){return 94===e&&"_hiddenFootnoteSupport"in i.parser.constructs?n(e):t(e)}}let wU={42:xO,43:xO,45:xO,48:xO,49:xO,50:xO,51:xO,52:xO,53:xO,54:xO,55:xO,56:xO,57:xO,62:xR},wV={91:xq},wG={[-2]:xY,[-1]:xY,32:xY},wH={35:x1,42:xI,45:[x4,xI],60:x9,61:x4,95:xI,96:ws,126:ws},wW={38:wp,92:wf},wq={[-5]:wm,[-4]:wm,[-3]:wm,33:w$,38:wp,42:wN,60:[wz,wR],91:wF,92:[{name:"hardBreakEscape",tokenize:function(e,t,n){return i;function i(t){return e.enter("hardBreakEscape"),e.consume(t),a}function a(i){return xe(i)?(e.exit("hardBreakEscape"),t(i)):n(i)}}},wf],93:wv,95:wN,96:{name:"codeText",previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type},resolve:function(e){let t,n,i=e.length-4,a=3;if(("lineEnding"===e[3][1].type||"space"===e[a][1].type)&&("lineEnding"===e[i][1].type||"space"===e[i][1].type)){for(t=a;++t<i;)if("codeTextData"===e[t][1].type){e[a][1].type="codeTextPadding",e[i][1].type="codeTextPadding",a+=2,i-=2;break}}for(t=a-1,i++;++t<=i;)void 0===n?t!==i&&"lineEnding"!==e[t][1].type&&(n=t):(t===i||"lineEnding"===e[t][1].type)&&(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),i-=t-n-2,t=n+2),n=void 0);return e},tokenize:function(e,t,n){let i,a,o=0;return s;function s(t){return e.enter("codeText"),e.enter("codeTextSequence"),l(t)}function l(t){return 96===t?(e.consume(t),o++,l):(e.exit("codeTextSequence"),u(t))}function u(t){return null===t?n(t):32===t?(e.enter("space"),e.consume(t),e.exit("space"),u):96===t?(a=e.enter("codeTextSequence"),i=0,d(t)):xe(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),u):(e.enter("codeTextData"),c(t))}function c(t){return null===t||32===t||96===t||xe(t)?(e.exit("codeTextData"),u(t)):(e.consume(t),c)}function d(n){return 96===n?(e.consume(n),i++,d):i===o?(e.exit("codeTextSequence"),e.exit("codeText"),t(n)):(a.type="codeTextData",c(n))}}}},wK={null:[wN,x_]},wX={null:[42,95]},wZ={null:[]};function wY(e,t,n){let i,a={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0},o={},s=[],l=[],u=[],c=!0,d={attempt:C(k),check:C(T),consume:w,enter:_,exit:S,interrupt:C(T,{interrupt:!0})},p={code:null,containerState:{},defineSkip:b,events:[],now:y,parser:e,previous:null,sliceSerialize:g,sliceStream:m,write:f},h=t.tokenize.call(p,d);return t.resolveAll&&s.push(t),p;function f(e){return(l=vq(l,e),v(),null!==l[l.length-1])?[]:(E(t,0),p.events=wb(s,p.events,p),p.events)}function g(e,t){return wJ(m(e),t)}function m(e){return wQ(l,e)}function y(){let{_bufferIndex:e,_index:t,line:n,column:i,offset:o}=a;return{_bufferIndex:e,_index:t,line:n,column:i,offset:o}}function b(e){o[e.line]=e.column,$()}function v(){let e;for(;a._index<l.length;){let t=l[a._index];if("string"==typeof t)for(e=a._index,a._bufferIndex<0&&(a._bufferIndex=0);a._index===e&&a._bufferIndex<t.length;)x(t.charCodeAt(a._bufferIndex));else x(t)}}function x(e){c=void 0,i=e,h=h(e)}function w(e){xe(e)?(a.line++,a.column=1,a.offset+=-3===e?2:1,$()):-1!==e&&(a.column++,a.offset++),a._bufferIndex<0?a._index++:(a._bufferIndex++,a._bufferIndex===l[a._index].length&&(a._bufferIndex=-1,a._index++)),p.previous=e,c=!0}function _(e,t){let n=t||{};return n.type=e,n.start=y(),p.events.push(["enter",n,p]),u.push(n),n}function S(e){let t=u.pop();return t.end=y(),p.events.push(["exit",t,p]),t}function k(e,t){E(e,t.from)}function T(e,t){t.restore()}function C(e,t){return n;function n(n,i,a){let o,s,l,u;return Array.isArray(n)?f(n):"tokenize"in n?f([n]):h(n);function h(e){return t;function t(t){let n=null!==t&&e[t],i=null!==t&&e.null;return f([...Array.isArray(n)?n:n?[n]:[],...Array.isArray(i)?i:i?[i]:[]])(t)}}function f(e){return(o=e,s=0,0===e.length)?a:g(e[s])}function g(e){return n;function n(n){return(u=I(),l=e,e.partial||(p.currentConstruct=e),e.name&&p.parser.constructs.disable.null.includes(e.name))?y(n):e.tokenize.call(t?Object.assign(Object.create(p),t):p,d,m,y)(n)}}function m(t){return c=!0,e(l,u),i}function y(e){return(c=!0,u.restore(),++s<o.length)?g(o[s]):a}}}function E(e,t){e.resolveAll&&!s.includes(e)&&s.push(e),e.resolve&&vW(p.events,t,p.events.length-t,e.resolve(p.events.slice(t),p)),e.resolveTo&&(p.events=e.resolveTo(p.events,p))}function I(){let e=y(),t=p.previous,n=p.currentConstruct,i=p.events.length,o=Array.from(u);return{from:i,restore:s};function s(){a=e,p.previous=t,p.currentConstruct=n,p.events.length=i,u=o,$()}}function $(){a.line in o&&a.column<2&&(a.column=o[a.line],a.offset+=o[a.line]-1)}}function wQ(e,t){let n,i=t.start._index,a=t.start._bufferIndex,o=t.end._index,s=t.end._bufferIndex;if(i===o)n=[e[i].slice(a,s)];else{if(n=e.slice(i,o),a>-1){let e=n[0];"string"==typeof e?n[0]=e.slice(a):n.shift()}s>0&&n.push(e[o].slice(0,s))}return n}function wJ(e,t){let n,i=-1,a=[];for(;++i<e.length;){let o,s=e[i];if("string"==typeof s)o=s;else switch(s){case -5:o="\r";break;case -4:o="\n";break;case -3:o="\r\n";break;case -2:o=t?" ":"	";break;case -1:if(!t&&n)continue;o=" ";break;default:o=String.fromCharCode(s)}n=-2===s,a.push(o)}return a.join("")}function w0(e){let t={constructs:v0([m,...(e||{}).extensions||[]]),content:n(xs),defined:[],document:n(xu),flow:n(xx),lazy:{},string:n(xS),text:n(xk)};return t;function n(e){return n;function n(n){return wY(t,e,n)}}}let w1=/[\0\t\n\r]/g;function w2(){let e,t=1,n="",i=!0;return a;function a(a,o,s){let l,u,c,d,p,h=[];for(a=n+("string"==typeof a?a.toString():new TextDecoder(o||void 0).decode(a)),c=0,n="",i&&(65279===a.charCodeAt(0)&&c++,i=void 0);c<a.length;){if(w1.lastIndex=c,d=(l=w1.exec(a))&&void 0!==l.index?l.index:a.length,p=a.charCodeAt(d),!l){n=a.slice(c);break}if(10===p&&c===d&&e)h.push(-3),e=void 0;else switch(e&&(h.push(-5),e=void 0),c<d&&(h.push(a.slice(c,d)),t+=d-c),p){case 0:h.push(65533),t++;break;case 9:for(u=4*Math.ceil(t/4),h.push(-2);t++<u;)h.push(-1);break;case 10:h.push(-4),t=1;break;default:e=!0,t=1}c=d+1}return s&&(e&&h.push(-5),n&&h.push(n),h.push(null)),h}}function w3(e,t){let n=Number.parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(65535&n)==65535||(65535&n)==65534||n>1114111?"":String.fromCodePoint(n)}let w4=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function w6(e){return e.replace(w4,w5)}function w5(e,t,n){if(t)return t;if(35===n.charCodeAt(0)){let e=n.charCodeAt(1),t=120===e||88===e;return w3(n.slice(t?2:1),t?16:10)}return wd(n)||e}let w8={}.hasOwnProperty;function w7(e,t,n){return"string"!=typeof t&&(n=t,t=void 0),w9(n)(vQ(w0(n).document().write(w2()(e,t,!0))))}function w9(e){let t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(en),autolinkProtocol:C,autolinkEmail:C,atxHeading:o(Q),blockQuote:o(q),characterEscape:C,characterReference:C,codeFenced:o(K),codeFencedFenceInfo:s,codeFencedFenceMeta:s,codeIndented:o(K,s),codeText:o(X,s),codeTextData:C,data:C,codeFlowValue:C,definition:o(Z),definitionDestinationString:s,definitionLabelString:s,definitionTitleString:s,emphasis:o(Y),hardBreakEscape:o(J),hardBreakTrailing:o(J),htmlFlow:o(ee,s),htmlFlowData:C,htmlText:o(ee,s),htmlTextData:C,image:o(et),label:s,link:o(en),listItem:o(ei),listItemValue:h,listOrdered:o(er,p),listUnordered:o(er),paragraph:o(ea),reference:F,referenceString:s,resourceDestinationString:s,resourceTitleString:s,setextHeading:o(Q),strong:o(eo),thematicBreak:o(el)},exit:{atxHeading:u(),atxHeadingSequence:_,autolink:u(),autolinkEmail:W,autolinkProtocol:H,blockQuote:u(),characterEscapeValue:E,characterReferenceMarkerHexadecimal:U,characterReferenceMarkerNumeric:U,characterReferenceValue:V,characterReference:G,codeFenced:u(y),codeFencedFence:m,codeFencedFenceInfo:f,codeFencedFenceMeta:g,codeFlowValue:E,codeIndented:u(b),codeText:u(N),codeTextData:E,data:E,definition:u(),definitionDestinationString:w,definitionLabelString:v,definitionTitleString:x,emphasis:u(),hardBreakEscape:u($),hardBreakTrailing:u($),htmlFlow:u(O),htmlFlowData:E,htmlText:u(A),htmlTextData:E,image:u(D),label:z,labelText:M,lineEnding:I,link:u(P),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:B,resourceDestinationString:j,resourceTitleString:R,resource:L,setextHeading:u(T),setextHeadingLineSequence:k,setextHeadingText:S,strong:u(),thematicBreak:u()}};_t(t,(e||{}).mdastExtensions||[]);let n={};return i;function i(e){let i={type:"root",children:[]},o={stack:[i],tokenStack:[],config:t,enter:l,exit:c,buffer:s,resume:d,data:n},u=[],p=-1;for(;++p<e.length;)("listOrdered"===e[p][1].type||"listUnordered"===e[p][1].type)&&("enter"===e[p][0]?u.push(p):p=a(e,u.pop(),p));for(p=-1;++p<e.length;){let n=t[e[p][0]];w8.call(n,e[p][1].type)&&n[e[p][1].type].call(Object.assign({sliceSerialize:e[p][2].sliceSerialize},o),e[p][1])}if(o.tokenStack.length>0){let e=o.tokenStack[o.tokenStack.length-1];(e[1]||_r).call(o,void 0,e[0])}for(i.position={start:_e(e.length>0?e[0][1].start:{line:1,column:1,offset:0}),end:_e(e.length>0?e[e.length-2][1].end:{line:1,column:1,offset:0})},p=-1;++p<t.transforms.length;)i=t.transforms[p](i)||i;return i}function a(e,t,n){let i,a,o,s,l=t-1,u=-1,c=!1;for(;++l<=n;){let t=e[l];switch(t[1].type){case"listUnordered":case"listOrdered":case"blockQuote":"enter"===t[0]?u++:u--,s=void 0;break;case"lineEndingBlank":"enter"===t[0]&&(!i||s||u||o||(o=l),s=void 0);break;case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:s=void 0}if(!u&&"enter"===t[0]&&"listItemPrefix"===t[1].type||-1===u&&"exit"===t[0]&&("listUnordered"===t[1].type||"listOrdered"===t[1].type)){if(i){let s=l;for(a=void 0;s--;){let t=e[s];if("lineEnding"===t[1].type||"lineEndingBlank"===t[1].type){if("exit"===t[0])continue;a&&(e[a][1].type="lineEndingBlank",c=!0),t[1].type="lineEnding",a=s}else if("linePrefix"===t[1].type||"blockQuotePrefix"===t[1].type||"blockQuotePrefixWhitespace"===t[1].type||"blockQuoteMarker"===t[1].type||"listItemIndent"===t[1].type);else break}o&&(!a||o<a)&&(i._spread=!0),i.end=Object.assign({},a?e[a][1].start:t[1].end),e.splice(a||l,0,["exit",i,t[2]]),l++,n++}if("listItemPrefix"===t[1].type){let a={type:"listItem",_spread:!1,start:Object.assign({},t[1].start),end:void 0};i=a,e.splice(l,0,["enter",a,t[2]]),l++,n++,o=void 0,s=!0}}}return e[t][1]._spread=c,n}function o(e,t){return n;function n(n){l.call(this,e(n),n),t&&t.call(this,n)}}function s(){this.stack.push({type:"fragment",children:[]})}function l(e,t,n){this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push([t,n||void 0]),e.position={start:_e(t.start),end:void 0}}function u(e){return t;function t(t){e&&e.call(this,t),c.call(this,t)}}function c(e,t){let n=this.stack.pop(),i=this.tokenStack.pop();if(i)i[0].type!==e.type&&(t?t.call(this,e,i[0]):(i[1]||_r).call(this,e,i[0]));else throw Error("Cannot close `"+e.type+"` ("+vs({start:e.start,end:e.end})+"): its not open");n.position.end=_e(e.end)}function d(){return vU(this.stack.pop())}function p(){this.data.expectingFirstListItemValue=!0}function h(e){this.data.expectingFirstListItemValue&&(this.stack[this.stack.length-2].start=Number.parseInt(this.sliceSerialize(e),10),this.data.expectingFirstListItemValue=void 0)}function f(){let e=this.resume();this.stack[this.stack.length-1].lang=e}function g(){let e=this.resume();this.stack[this.stack.length-1].meta=e}function m(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function y(){let e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function b(){let e=this.resume();this.stack[this.stack.length-1].value=e.replace(/(\r?\n|\r)$/g,"")}function v(e){let t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=xW(this.sliceSerialize(e)).toLowerCase()}function x(){let e=this.resume();this.stack[this.stack.length-1].title=e}function w(){let e=this.resume();this.stack[this.stack.length-1].url=e}function _(e){let t=this.stack[this.stack.length-1];t.depth||(t.depth=this.sliceSerialize(e).length)}function S(){this.data.setextHeadingSlurpLineEnding=!0}function k(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).codePointAt(0)?1:2}function T(){this.data.setextHeadingSlurpLineEnding=void 0}function C(e){let t=this.stack[this.stack.length-1].children,n=t[t.length-1];n&&"text"===n.type||((n=es()).position={start:_e(e.start),end:void 0},t.push(n)),this.stack.push(n)}function E(e){let t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=_e(e.end)}function I(e){let n=this.stack[this.stack.length-1];if(this.data.atHardBreak){n.children[n.children.length-1].position.end=_e(e.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(n.type)&&(C.call(this,e),E.call(this,e))}function $(){this.data.atHardBreak=!0}function O(){let e=this.resume();this.stack[this.stack.length-1].value=e}function A(){let e=this.resume();this.stack[this.stack.length-1].value=e}function N(){let e=this.resume();this.stack[this.stack.length-1].value=e}function P(){let e=this.stack[this.stack.length-1];if(this.data.inReference){let t=this.data.referenceType||"shortcut";e.type+="Reference",e.referenceType=t,delete e.url,delete e.title}else delete e.identifier,delete e.label;this.data.referenceType=void 0}function D(){let e=this.stack[this.stack.length-1];if(this.data.inReference){let t=this.data.referenceType||"shortcut";e.type+="Reference",e.referenceType=t,delete e.url,delete e.title}else delete e.identifier,delete e.label;this.data.referenceType=void 0}function M(e){let t=this.sliceSerialize(e),n=this.stack[this.stack.length-2];n.label=w6(t),n.identifier=xW(t).toLowerCase()}function z(){let e=this.stack[this.stack.length-1],t=this.resume(),n=this.stack[this.stack.length-1];this.data.inReference=!0,"link"===n.type?n.children=e.children:n.alt=t}function j(){let e=this.resume();this.stack[this.stack.length-1].url=e}function R(){let e=this.resume();this.stack[this.stack.length-1].title=e}function L(){this.data.inReference=void 0}function F(){this.data.referenceType="collapsed"}function B(e){let t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=xW(this.sliceSerialize(e)).toLowerCase(),this.data.referenceType="full"}function U(e){this.data.characterReferenceType=e.type}function V(e){let t,n=this.sliceSerialize(e),i=this.data.characterReferenceType;i?(t=w3(n,"characterReferenceMarkerNumeric"===i?10:16),this.data.characterReferenceType=void 0):t=wd(n);let a=this.stack[this.stack.length-1];a.value+=t}function G(e){this.stack.pop().position.end=_e(e.end)}function H(e){E.call(this,e),this.stack[this.stack.length-1].url=this.sliceSerialize(e)}function W(e){E.call(this,e),this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)}function q(){return{type:"blockquote",children:[]}}function K(){return{type:"code",lang:null,meta:null,value:""}}function X(){return{type:"inlineCode",value:""}}function Z(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Y(){return{type:"emphasis",children:[]}}function Q(){return{type:"heading",depth:0,children:[]}}function J(){return{type:"break"}}function ee(){return{type:"html",value:""}}function et(){return{type:"image",title:null,url:"",alt:null}}function en(){return{type:"link",title:null,url:"",children:[]}}function er(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}function ei(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}}function ea(){return{type:"paragraph",children:[]}}function eo(){return{type:"strong",children:[]}}function es(){return{type:"text",value:""}}function el(){return{type:"thematicBreak"}}}function _e(e){return{line:e.line,column:e.column,offset:e.offset}}function _t(e,t){let n=-1;for(;++n<t.length;){let i=t[n];Array.isArray(i)?_t(e,i):_n(e,i)}}function _n(e,t){let n;for(n in t)if(w8.call(t,n))switch(n){case"canContainEols":{let i=t[n];i&&e[n].push(...i);break}case"transforms":{let i=t[n];i&&e[n].push(...i);break}case"enter":case"exit":{let i=t[n];i&&Object.assign(e[n],i)}}}function _r(e,t){if(e)throw Error("Cannot close `"+e.type+"` ("+vs({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+vs({start:t.start,end:t.end})+") is open");throw Error("Cannot close document, a token (`"+t.type+"`, "+vs({start:t.start,end:t.end})+") is still open")}function _i(e){let t=this;function n(n){return w7(n,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}t.parser=n}let _a="object"==typeof self?self:globalThis,_o=(e,t)=>{let n=(t,n)=>(e.set(n,t),t),i=a=>{if(e.has(a))return e.get(a);let[o,s]=t[a];switch(o){case 0:case -1:return n(s,a);case 1:{let e=n([],a);for(let t of s)e.push(i(t));return e}case 2:{let e=n({},a);for(let[t,n]of s)e[i(t)]=i(n);return e}case 3:return n(new Date(s),a);case 4:{let{source:e,flags:t}=s;return n(new RegExp(e,t),a)}case 5:{let e=n(new Map,a);for(let[t,n]of s)e.set(i(t),i(n));return e}case 6:{let e=n(new Set,a);for(let t of s)e.add(i(t));return e}case 7:{let{name:e,message:t}=s;return n(new _a[e](t),a)}case 8:return n(BigInt(s),a);case"BigInt":return n(Object(BigInt(s)),a);case"ArrayBuffer":return n(new Uint8Array(s).buffer,s);case"DataView":{let{buffer:e}=new Uint8Array(s);return n(new DataView(e),s)}}return n(new _a[o](s),a)};return i},_s=e=>_o(new Map,e)(0),_l="",{toString:_u}={},{keys:_c}=Object,_d=e=>{let t=typeof e;if("object"!==t||!e)return[0,t];let n=_u.call(e).slice(8,-1);switch(n){case"Array":return[1,_l];case"Object":return[2,_l];case"Date":return[3,_l];case"RegExp":return[4,_l];case"Map":return[5,_l];case"Set":return[6,_l];case"DataView":return[1,n]}return n.includes("Array")?[1,n]:n.includes("Error")?[7,n]:[2,n]},_p=([e,t])=>0===e&&("function"===t||"symbol"===t),_h=(e,t,n,i)=>{let a=(e,t)=>{let a=i.push(e)-1;return n.set(t,a),a},o=i=>{if(n.has(i))return n.get(i);let[s,l]=_d(i);switch(s){case 0:{let t=i;switch(l){case"bigint":s=8,t=i.toString();break;case"function":case"symbol":if(e)throw TypeError("unable to serialize "+l);t=null;break;case"undefined":return a([-1],i)}return a([s,t],i)}case 1:{if(l){let e=i;return"DataView"===l?e=new Uint8Array(i.buffer):"ArrayBuffer"===l&&(e=new Uint8Array(i)),a([l,[...e]],i)}let e=[],t=a([s,e],i);for(let t of i)e.push(o(t));return t}case 2:{if(l)switch(l){case"BigInt":return a([l,i.toString()],i);case"Boolean":case"Number":case"String":return a([l,i.valueOf()],i)}if(t&&"toJSON"in i)return o(i.toJSON());let n=[],u=a([s,n],i);for(let t of _c(i))(e||!_p(_d(i[t])))&&n.push([o(t),o(i[t])]);return u}case 3:return a([s,i.toISOString()],i);case 4:{let{source:e,flags:t}=i;return a([s,{source:e,flags:t}],i)}case 5:{let t=[],n=a([s,t],i);for(let[n,a]of i)(e||!(_p(_d(n))||_p(_d(a))))&&t.push([o(n),o(a)]);return n}case 6:{let t=[],n=a([s,t],i);for(let n of i)(e||!_p(_d(n)))&&t.push(o(n));return n}}let{message:u}=i;return a([s,{name:l,message:u}],i)};return o},_f=(e,{json:t,lossy:n}={})=>{let i=[];return _h(!(t||n),!!t,new Map,i)(e),i},_g="function"==typeof structuredClone?(e,t)=>t&&("json"in t||"lossy"in t)?_s(_f(e,t)):structuredClone(e):(e,t)=>_s(_f(e,t));function _m(e){let t=[],n=-1,i=0,a=0;for(;++n<e.length;){let o=e.charCodeAt(n),s="";if(37===o&&v4(e.charCodeAt(n+1))&&v4(e.charCodeAt(n+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(s=String.fromCharCode(o));else if(o>55295&&o<57344){let t=e.charCodeAt(n+1);o<56320&&t>56319&&t<57344?(s=String.fromCharCode(o,t),a=1):s=""}else s=String.fromCharCode(o);s&&(t.push(e.slice(i,n),encodeURIComponent(s)),i=n+a+1,s=""),a&&(n+=a,a=0)}return t.join("")+e.slice(i)}function _y(e,t){let n=[{type:"text",value:""}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function _b(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function _v(e){let t="string"==typeof e.options.clobberPrefix?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||_y,i=e.options.footnoteBackLabel||_b,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",s=e.options.footnoteLabelProperties||{className:["sr-only"]},l=[],u=-1;for(;++u<e.footnoteOrder.length;){let a=e.footnoteById.get(e.footnoteOrder[u]);if(!a)continue;let o=e.all(a),s=String(a.identifier).toUpperCase(),c=_m(s.toLowerCase()),d=0,p=[],h=e.footnoteCounts.get(s);for(;void 0!==h&&++d<=h;){p.length>0&&p.push({type:"text",value:" "});let e="string"==typeof n?n:n(u,d);"string"==typeof e&&(e={type:"text",value:e}),p.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+c+(d>1?"-"+d:""),dataFootnoteBackref:"",ariaLabel:"string"==typeof i?i:i(u,d),className:["data-footnote-backref"]},children:Array.isArray(e)?e:[e]})}let f=o[o.length-1];if(f&&"element"===f.type&&"p"===f.tagName){let e=f.children[f.children.length-1];e&&"text"===e.type?e.value+=" ":f.children.push({type:"text",value:" "}),f.children.push(...p)}else o.push(...p);let g={type:"element",tagName:"li",properties:{id:t+"fn-"+c},children:e.wrap(o,!0)};e.patch(a,g),l.push(g)}if(0!==l.length)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{..._g(s),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:"\n"},{type:"element",tagName:"ol",properties:{},children:e.wrap(l,!0)},{type:"text",value:"\n"}]}}let _x=function(e){if(null==e)return _T;if("function"==typeof e)return _k(e);if("object"==typeof e)return Array.isArray(e)?_w(e):__(e);if("string"==typeof e)return _S(e);throw Error("Expected function, string, or object as test")};function _w(e){let t=[],n=-1;for(;++n<e.length;)t[n]=_x(e[n]);return _k(i);function i(...e){let n=-1;for(;++n<t.length;)if(t[n].apply(this,e))return!0;return!1}}function __(e){let t=e;return _k(n);function n(n){let i,a=n;for(i in e)if(a[i]!==t[i])return!1;return!0}}function _S(e){return _k(t);function t(t){return t&&t.type===e}}function _k(e){return t;function t(t,n,i){return!!(_C(t)&&e.call(this,t,"number"==typeof n?n:void 0,i||void 0))}}function _T(){return!0}function _C(e){return null!==e&&"object"==typeof e&&"type"in e}function _E(e){return e}let _I=[],_$=!0,_O=!1,_A="skip";function _N(e,t,n,i){let a;"function"==typeof t&&"function"!=typeof n?(i=n,n=t):a=t;let o=_x(a),s=i?-1:1;function l(e,a,u){let c=e&&"object"==typeof e?e:{};if("string"==typeof c.type){let t="string"==typeof c.tagName?c.tagName:"string"==typeof c.name?c.name:void 0;Object.defineProperty(d,"name",{value:"node ("+_E(e.type+(t?"<"+t+">":""))+")"})}return d;function d(){let c,d,p,h=_I;if((!t||o(e,a,u[u.length-1]||void 0))&&(h=_P(n(e,u)))[0]===_O)return h;if("children"in e&&e.children){let t=e;if(t.children&&h[0]!==_A)for(d=(i?t.children.length:-1)+s,p=u.concat(t);d>-1&&d<t.children.length;){if((c=l(t.children[d],d,p)())[0]===_O)return c;d="number"==typeof c[1]?c[1]:d+s}}return h}}l(e,void 0,[])()}function _P(e){return Array.isArray(e)?e:"number"==typeof e?[_$,e]:null==e?_I:[e]}function _D(e,t,n,i){let a,o,s;function l(e,t){let n=t[t.length-1],i=n?n.children.indexOf(e):void 0;return s(e,i,n)}"function"==typeof t&&"function"!=typeof n?(o=void 0,s=t,a=n):(o=t,s=n,a=i),_N(e,o,l,a)}function _M(e,t){let n=t.referenceType,i="]";if("collapsed"===n?i+="[]":"full"===n&&(i+="["+(t.label||t.identifier)+"]"),"imageReference"===t.type)return[{type:"text",value:"!["+t.alt+i}];let a=e.all(t),o=a[0];o&&"text"===o.type?o.value="["+o.value:a.unshift({type:"text",value:"["});let s=a[a.length-1];return s&&"text"===s.type?s.value+=i:a.push({type:"text",value:i}),a}function _z(e){let t=!1;if("list"===e.type){t=e.spread||!1;let n=e.children,i=-1;for(;!t&&++i<n.length;)t=_j(n[i])}return t}function _j(e){let t=e.spread;return null==t?e.children.length>1:t}let _R=9,_L=32;function _F(e){let t=String(e),n=/\r?\n|\r/g,i=n.exec(t),a=0,o=[];for(;i;)o.push(_B(t.slice(a,i.index),a>0,!0),i[0]),a=i.index+i[0].length,i=n.exec(t);return o.push(_B(t.slice(a),a>0,!1)),o.join("")}function _B(e,t,n){let i=0,a=e.length;if(t){let t=e.codePointAt(i);for(;t===_R||t===_L;)i++,t=e.codePointAt(i)}if(n){let t=e.codePointAt(a-1);for(;t===_R||t===_L;)a--,t=e.codePointAt(a-1)}return a>i?e.slice(i,a):""}let _U={blockquote:function(e,t){let n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)},break:function(e,t){let n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:"\n"}]},code:function(e,t){let n=t.value?t.value+"\n":"",i={};t.lang&&(i.className=["language-"+t.lang]);let a={type:"element",tagName:"code",properties:i,children:[{type:"text",value:n}]};return t.meta&&(a.data={meta:t.meta}),e.patch(t,a),a={type:"element",tagName:"pre",properties:{},children:[a=e.applyData(t,a)]},e.patch(t,a),a},delete:function(e,t){let n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},emphasis:function(e,t){let n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},footnoteReference:function(e,t){let n,i="string"==typeof e.options.clobberPrefix?e.options.clobberPrefix:"user-content-",a=String(t.identifier).toUpperCase(),o=_m(a.toLowerCase()),s=e.footnoteOrder.indexOf(a),l=e.footnoteCounts.get(a);void 0===l?(l=0,e.footnoteOrder.push(a),n=e.footnoteOrder.length):n=s+1,l+=1,e.footnoteCounts.set(a,l);let u={type:"element",tagName:"a",properties:{href:"#"+i+"fn-"+o,id:i+"fnref-"+o+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(n)}]};e.patch(t,u);let c={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(t,c),e.applyData(t,c)},heading:function(e,t){let n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},html:function(e,t){if(e.options.allowDangerousHtml){let n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}},imageReference:function(e,t){let n=String(t.identifier).toUpperCase(),i=e.definitionById.get(n);if(!i)return _M(e,t);let a={src:_m(i.url||""),alt:t.alt};null!==i.title&&void 0!==i.title&&(a.title=i.title);let o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(t,o),e.applyData(t,o)},image:function(e,t){let n={src:_m(t.url)};null!==t.alt&&void 0!==t.alt&&(n.alt=t.alt),null!==t.title&&void 0!==t.title&&(n.title=t.title);let i={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,i),e.applyData(t,i)},inlineCode:function(e,t){let n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);let i={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,i),e.applyData(t,i)},linkReference:function(e,t){let n=String(t.identifier).toUpperCase(),i=e.definitionById.get(n);if(!i)return _M(e,t);let a={href:_m(i.url||"")};null!==i.title&&void 0!==i.title&&(a.title=i.title);let o={type:"element",tagName:"a",properties:a,children:e.all(t)};return e.patch(t,o),e.applyData(t,o)},link:function(e,t){let n={href:_m(t.url)};null!==t.title&&void 0!==t.title&&(n.title=t.title);let i={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)},listItem:function(e,t,n){let i=e.all(t),a=n?_z(n):_j(t),o={},s=[];if("boolean"==typeof t.checked){let e,n=i[0];n&&"element"===n.type&&"p"===n.tagName?e=n:(e={type:"element",tagName:"p",properties:{},children:[]},i.unshift(e)),e.children.length>0&&e.children.unshift({type:"text",value:" "}),e.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let l=-1;for(;++l<i.length;){let e=i[l];(a||0!==l||"element"!==e.type||"p"!==e.tagName)&&s.push({type:"text",value:"\n"}),"element"!==e.type||"p"!==e.tagName||a?s.push(e):s.push(...e.children)}let u=i[i.length-1];u&&(a||"element"!==u.type||"p"!==u.tagName)&&s.push({type:"text",value:"\n"});let c={type:"element",tagName:"li",properties:o,children:s};return e.patch(t,c),e.applyData(t,c)},list:function(e,t){let n={},i=e.all(t),a=-1;for("number"==typeof t.start&&1!==t.start&&(n.start=t.start);++a<i.length;){let e=i[a];if("element"===e.type&&"li"===e.tagName&&e.properties&&Array.isArray(e.properties.className)&&e.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}let o={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(i,!0)};return e.patch(t,o),e.applyData(t,o)},paragraph:function(e,t){let n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},root:function(e,t){let n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)},strong:function(e,t){let n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},table:function(e,t){let n=e.all(t),i=n.shift(),a=[];if(i){let n={type:"element",tagName:"thead",properties:{},children:e.wrap([i],!0)};e.patch(t.children[0],n),a.push(n)}if(n.length>0){let i={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},o=vi(t.children[1]),s=vr(t.children[t.children.length-1]);o&&s&&(i.position={start:o,end:s}),a.push(i)}let o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(t,o),e.applyData(t,o)},tableCell:function(e,t){let n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},tableRow:function(e,t,n){let i=n?n.children:void 0,a=0===(i?i.indexOf(t):1)?"th":"td",o=n&&"table"===n.type?n.align:void 0,s=o?o.length:t.children.length,l=-1,u=[];for(;++l<s;){let n=t.children[l],i={},s=o?o[l]:void 0;s&&(i.align=s);let c={type:"element",tagName:a,properties:i,children:[]};n&&(c.children=e.all(n),e.patch(n,c),c=e.applyData(n,c)),u.push(c)}let c={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(t,c),e.applyData(t,c)},text:function(e,t){let n={type:"text",value:_F(String(t.value))};return e.patch(t,n),e.applyData(t,n)},thematicBreak:function(e,t){let n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)},toml:_V,yaml:_V,definition:_V,footnoteDefinition:_V};function _V(){}let _G={}.hasOwnProperty,_H={};function _W(e,t){let n=t||_H,i=new Map,a=new Map,o={all:l,applyData:_K,definitionById:i,footnoteById:a,footnoteCounts:new Map,footnoteOrder:[],handlers:{..._U,...n.handlers},one:s,options:n,patch:_q,wrap:_Z};return _D(e,function(e){if("definition"===e.type||"footnoteDefinition"===e.type){let t="definition"===e.type?i:a,n=String(e.identifier).toUpperCase();t.has(n)||t.set(n,e)}}),o;function s(e,t){let n=e.type,i=o.handlers[n];if(_G.call(o.handlers,n)&&i)return i(o,e,t);if(o.options.passThrough&&o.options.passThrough.includes(n)){if("children"in e){let{children:t,...n}=e,i=_g(n);return i.children=o.all(e),i}return _g(e)}return(o.options.unknownHandler||_X)(o,e,t)}function l(e){let t=[];if("children"in e){let n=e.children,i=-1;for(;++i<n.length;){let a=o.one(n[i],e);if(a){if(i&&"break"===n[i-1].type&&(Array.isArray(a)||"text"!==a.type||(a.value=_Y(a.value)),!Array.isArray(a)&&"element"===a.type)){let e=a.children[0];e&&"text"===e.type&&(e.value=_Y(e.value))}Array.isArray(a)?t.push(...a):t.push(a)}}}return t}}function _q(e,t){e.position&&(t.position=vo(e))}function _K(e,t){let n=t;if(e&&e.data){let t=e.data.hName,i=e.data.hChildren,a=e.data.hProperties;"string"==typeof t&&("element"===n.type?n.tagName=t:n={type:"element",tagName:t,properties:{},children:"children"in n?n.children:[n]}),"element"===n.type&&a&&Object.assign(n.properties,_g(a)),"children"in n&&n.children&&null!=i&&(n.children=i)}return n}function _X(e,t){let n=t.data||{},i="value"in t&&!(_G.call(n,"hProperties")||_G.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function _Z(e,t){let n=[],i=-1;for(t&&n.push({type:"text",value:"\n"});++i<e.length;)i&&n.push({type:"text",value:"\n"}),n.push(e[i]);return t&&e.length>0&&n.push({type:"text",value:"\n"}),n}function _Y(e){let t=0,n=e.charCodeAt(t);for(;9===n||32===n;)t++,n=e.charCodeAt(t);return e.slice(t)}function _Q(e,t){let n=_W(e,t),i=n.one(e,void 0),a=_v(n),o=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return a&&o.children.push({type:"text",value:"\n"},a),o}function _J(e,t){return e&&"run"in e?async function(n,i){let a=_Q(n,{file:i,...t});await e.run(a,i)}:function(n,i){return _Q(n,{file:i,...e||t})}}function _0(e){if(e)throw e}var _1=__webpack_require__(710);function _2(e){if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function _3(){let e=[],t={run:n,use:i};return t;function n(...t){let i=-1,a=t.pop();if("function"!=typeof a)throw TypeError("Expected function as last argument, not "+a);function o(n,...s){let l=e[++i],u=-1;if(n)return void a(n);for(;++u<t.length;)(null===s[u]||void 0===s[u])&&(s[u]=t[u]);t=s,l?_4(l,o)(...s):a(null,...s)}o(null,...t)}function i(n){if("function"!=typeof n)throw TypeError("Expected `middelware` to be a function, not "+n);return e.push(n),t}}function _4(e,t){let n;return i;function i(...t){let s,l=e.length>t.length;l&&t.push(a);try{s=e.apply(this,t)}catch(t){let e=t;if(l&&n)throw e;return a(e)}l||(s&&s.then&&"function"==typeof s.then?s.then(o,a):s instanceof Error?a(s):o(s))}function a(e,...i){n||(n=!0,t(e,...i))}function o(e){a(null,e)}}let _6=Se,_5=St,_8=Sn,_7=Sr,_9="/";function Se(e,t){let n;if(void 0!==t&&"string"!=typeof t)throw TypeError('"ext" argument must be a string');So(e);let i=0,a=-1,o=e.length;if(void 0===t||0===t.length||t.length>e.length){for(;o--;)if(47===e.codePointAt(o)){if(n){i=o+1;break}}else a<0&&(n=!0,a=o+1);return a<0?"":e.slice(i,a)}if(t===e)return"";let s=-1,l=t.length-1;for(;o--;)if(47===e.codePointAt(o)){if(n){i=o+1;break}}else s<0&&(n=!0,s=o+1),l>-1&&(e.codePointAt(o)===t.codePointAt(l--)?l<0&&(a=o):(l=-1,a=s));return i===a?a=s:a<0&&(a=e.length),e.slice(i,a)}function St(e){let t;if(So(e),0===e.length)return".";let n=-1,i=e.length;for(;--i;)if(47===e.codePointAt(i)){if(t){n=i;break}}else t||(t=!0);return n<0?47===e.codePointAt(0)?"/":".":1===n&&47===e.codePointAt(0)?"//":e.slice(0,n)}function Sn(e){let t;So(e);let n=e.length,i=-1,a=0,o=-1,s=0;for(;n--;){let l=e.codePointAt(n);if(47===l){if(t){a=n+1;break}continue}i<0&&(t=!0,i=n+1),46===l?o<0?o=n:1!==s&&(s=1):o>-1&&(s=-1)}return o<0||i<0||0===s||1===s&&o===i-1&&o===a+1?"":e.slice(o,i)}function Sr(...e){let t,n=-1;for(;++n<e.length;)So(e[n]),e[n]&&(t=void 0===t?e[n]:t+"/"+e[n]);return void 0===t?".":Si(t)}function Si(e){So(e);let t=47===e.codePointAt(0),n=Sa(e,!t);return 0!==n.length||t||(n="."),n.length>0&&47===e.codePointAt(e.length-1)&&(n+="/"),t?"/"+n:n}function Sa(e,t){let n,i,a="",o=0,s=-1,l=0,u=-1;for(;++u<=e.length;){if(u<e.length)n=e.codePointAt(u);else if(47===n)break;else n=47;if(47===n){if(s===u-1||1===l);else if(s!==u-1&&2===l){if(a.length<2||2!==o||46!==a.codePointAt(a.length-1)||46!==a.codePointAt(a.length-2)){if(a.length>2){if((i=a.lastIndexOf("/"))!==a.length-1){i<0?(a="",o=0):o=(a=a.slice(0,i)).length-1-a.lastIndexOf("/"),s=u,l=0;continue}}else if(a.length>0){a="",o=0,s=u,l=0;continue}}t&&(a=a.length>0?a+"/..":"..",o=2)}else a.length>0?a+="/"+e.slice(s+1,u):a=e.slice(s+1,u),o=u-s-1;s=u,l=0}else 46===n&&l>-1?l++:l=-1}return a}function So(e){if("string"!=typeof e)throw TypeError("Path must be a string. Received "+JSON.stringify(e))}let Ss=Sl;function Sl(){return"/"}function Su(e){return!!(null!==e&&"object"==typeof e&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&void 0===e.auth)}function Sc(e){if("string"==typeof e)e=new URL(e);else if(!Su(e)){let t=TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if("file:"!==e.protocol){let e=TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return Sd(e)}function Sd(e){if(""!==e.hostname){let e=TypeError('File URL host must be "localhost" or empty on darwin');throw e.code="ERR_INVALID_FILE_URL_HOST",e}let t=e.pathname,n=-1;for(;++n<t.length;)if(37===t.codePointAt(n)&&50===t.codePointAt(n+1)){let e=t.codePointAt(n+2);if(70===e||102===e){let e=TypeError("File URL path must not include encoded / characters");throw e.code="ERR_INVALID_FILE_URL_PATH",e}}return decodeURIComponent(t)}let Sp=["history","path","basename","stem","extname","dirname"];class Sh{constructor(e){let t,n;t=e?Su(e)?{path:e}:"string"==typeof e||Sy(e)?{value:e}:e:{},this.cwd="cwd"in t?"":Ss(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<Sp.length;){const e=Sp[i];e in t&&void 0!==t[e]&&null!==t[e]&&(this[e]="history"===e?[...t[e]]:t[e])}for(n in t)Sp.includes(n)||(this[n]=t[n])}get basename(){return"string"==typeof this.path?_6(this.path):void 0}set basename(e){Sg(e,"basename"),Sf(e,"basename"),this.path=_7(this.dirname||"",e)}get dirname(){return"string"==typeof this.path?_5(this.path):void 0}set dirname(e){Sm(this.basename,"dirname"),this.path=_7(e||"",this.basename)}get extname(){return"string"==typeof this.path?_8(this.path):void 0}set extname(e){if(Sf(e,"extname"),Sm(this.dirname,"extname"),e){if(46!==e.codePointAt(0))throw Error("`extname` must start with `.`");if(e.includes(".",1))throw Error("`extname` cannot contain multiple dots")}this.path=_7(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){Su(e)&&(e=Sc(e)),Sg(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return"string"==typeof this.path?_6(this.path,this.extname):void 0}set stem(e){Sg(e,"stem"),Sf(e,"stem"),this.path=_7(this.dirname||"",e+(this.extname||""))}fail(e,t,n){let i=this.message(e,t,n);throw i.fatal=!0,i}info(e,t,n){let i=this.message(e,t,n);return i.fatal=void 0,i}message(e,t,n){let i=new vd(e,t,n);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(e){return void 0===this.value?"":"string"==typeof this.value?this.value:new TextDecoder(e||void 0).decode(this.value)}}function Sf(e,t){if(e&&e.includes(_9))throw Error("`"+t+"` cannot be a path: did not expect `"+_9+"`")}function Sg(e,t){if(!e)throw Error("`"+t+"` cannot be empty")}function Sm(e,t){if(!e)throw Error("Setting `"+t+"` requires `path` to be set too")}function Sy(e){return!!(e&&"object"==typeof e&&"byteLength"in e&&"byteOffset"in e)}let Sb=function(e){let t=this,n=t.constructor.prototype,i=n[e],a=function(){return i.apply(a,arguments)};return Object.setPrototypeOf(a,n),a},Sv={}.hasOwnProperty;class Sx extends Sb{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=_3()}copy(){let e=new Sx,t=-1;for(;++t<this.attachers.length;){let n=this.attachers[t];e.use(...n)}return e.data(_1(!0,{},this.namespace)),e}data(e,t){return"string"==typeof e?2==arguments.length?(Sk("data",this.frozen),this.namespace[e]=t,this):Sv.call(this.namespace,e)&&this.namespace[e]||void 0:e?(Sk("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;let e=this;for(;++this.freezeIndex<this.attachers.length;){let[t,...n]=this.attachers[this.freezeIndex];if(!1===n[0])continue;!0===n[0]&&(n[0]=void 0);let i=t.call(e,...n);"function"==typeof i&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=1/0,this}parse(e){this.freeze();let t=SE(e),n=this.parser||this.Parser;return S_("parse",n),n(String(t),t)}process(e,t){let n=this;return this.freeze(),S_("process",this.parser||this.Parser),SS("process",this.compiler||this.Compiler),t?i(void 0,t):new Promise(i);function i(i,a){let o=SE(e),s=n.parse(o);function l(e,n){e||!n?a(e):i?i(n):t(void 0,n)}n.run(s,o,function(e,t,i){if(e||!t||!i)return l(e);let a=t,o=n.stringify(a,i);S$(o)?i.value=o:i.result=o,l(e,i)})}}processSync(e){let t,n=!1;return this.freeze(),S_("processSync",this.parser||this.Parser),SS("processSync",this.compiler||this.Compiler),this.process(e,i),SC("processSync","process",n),t;function i(e,i){n=!0,_0(e),t=i}}run(e,t,n){ST(e),this.freeze();let i=this.transformers;return n||"function"!=typeof t||(n=t,t=void 0),n?a(void 0,n):new Promise(a);function a(a,o){let s=SE(t);function l(t,i,s){let l=i||e;t?o(t):a?a(l):n(void 0,l,s)}i.run(e,s,l)}}runSync(e,t){let n,i=!1;return this.run(e,t,a),SC("runSync","run",i),n;function a(e,t){_0(e),n=t,i=!0}}stringify(e,t){this.freeze();let n=SE(t),i=this.compiler||this.Compiler;return SS("stringify",i),ST(e),i(e,n)}use(e,...t){let n=this.attachers,i=this.namespace;if(Sk("use",this.frozen),null==e);else if("function"==typeof e)l(e,t);else if("object"==typeof e)Array.isArray(e)?s(e):o(e);else throw TypeError("Expected usable value, not `"+e+"`");return this;function a(e){if("function"==typeof e)l(e,[]);else if("object"==typeof e)if(Array.isArray(e)){let[t,...n]=e;l(t,n)}else o(e);else throw TypeError("Expected usable value, not `"+e+"`")}function o(e){if(!("plugins"in e)&&!("settings"in e))throw Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");s(e.plugins),e.settings&&(i.settings=_1(!0,i.settings,e.settings))}function s(e){let t=-1;if(null==e);else if(Array.isArray(e))for(;++t<e.length;)a(e[t]);else throw TypeError("Expected a list of plugins, not `"+e+"`")}function l(e,t){let i=-1,a=-1;for(;++i<n.length;)if(n[i][0]===e){a=i;break}if(-1===a)n.push([e,...t]);else if(t.length>0){let[i,...o]=t,s=n[a][1];_2(s)&&_2(i)&&(i=_1(!0,s,i)),n[a]=[e,i,...o]}}}}let Sw=new Sx().freeze();function S_(e,t){if("function"!=typeof t)throw TypeError("Cannot `"+e+"` without `parser`")}function SS(e,t){if("function"!=typeof t)throw TypeError("Cannot `"+e+"` without `compiler`")}function Sk(e,t){if(t)throw Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function ST(e){if(!_2(e)||"string"!=typeof e.type)throw TypeError("Expected node, got `"+e+"`")}function SC(e,t,n){if(!n)throw Error("`"+e+"` finished async. Use `"+t+"` instead")}function SE(e){return SI(e)?e:new Sh(e)}function SI(e){return!!(e&&"object"==typeof e&&"message"in e&&"messages"in e)}function S$(e){return"string"==typeof e||SO(e)}function SO(e){return!!(e&&"object"==typeof e&&"byteLength"in e&&"byteOffset"in e)}let SA=[],SN={allowDangerousHtml:!0},SP=/^(https?|ircs?|mailto|xmpp)$/i,SD=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function SM(e){let t=Sz(e),n=Sj(e);return SR(t.runSync(t.parse(n),n),e)}function Sz(e){let t=e.rehypePlugins||SA,n=e.remarkPlugins||SA,i=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...SN}:SN;return Sw().use(_i).use(n).use(_J,i).use(t)}function Sj(e){let t=e.children||"",n=new Sh;return"string"==typeof t&&(n.value=t),n}function SR(e,t){let n=t.allowedElements,i=t.allowElement,a=t.components,o=t.disallowedElements,s=t.skipHtml,l=t.unwrapDisallowed,u=t.urlTransform||SL;for(let e of SD)Object.hasOwn(t,e.from)&&(e.from,e.to&&e.to,e.id);return _D(e,c),vb(e,{Fragment:v.Fragment,components:a,ignoreInvalidStyle:!0,jsx:v.jsx,jsxs:v.jsxs,passKeys:!0,passNode:!0});function c(e,t,a){if("raw"===e.type&&a&&"number"==typeof t)return s?a.children.splice(t,1):a.children[t]={type:"text",value:e.value},t;if("element"===e.type){let t;for(t in vF)if(Object.hasOwn(vF,t)&&Object.hasOwn(e.properties,t)){let n=e.properties[t],i=vF[t];(null===i||i.includes(e.tagName))&&(e.properties[t]=u(String(n||""),t,e))}}if("element"===e.type){let s=n?!n.includes(e.tagName):!!o&&o.includes(e.tagName);if(!s&&i&&"number"==typeof t&&(s=!i(e,t,a)),s&&a&&"number"==typeof t)return l&&e.children?a.children.splice(t,1,...e.children):a.children.splice(t,1),t}}}function SL(e){let t=e.indexOf(":"),n=e.indexOf("?"),i=e.indexOf("#"),a=e.indexOf("/");return -1===t||-1!==a&&t>a||-1!==n&&t>n||-1!==i&&t>i||SP.test(e.slice(0,t))?e:""}function SF(e,t){let n=String(e);if("string"!=typeof t)throw TypeError("Expected character");let i=0,a=n.indexOf(t);for(;-1!==a;)i++,a=n.indexOf(t,a+t.length);return i}function SB(e){if("string"!=typeof e)throw TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function SU(e,t,n){let i=_x((n||{}).ignore||[]),a=SV(t),o=-1;for(;++o<a.length;)_N(e,"text",s);function s(e,t){let n,a=-1;for(;++a<t.length;){let e=t[a],o=n?n.children:void 0;if(i(e,o?o.indexOf(e):void 0,n))return;n=e}if(n)return l(e,t)}function l(e,t){let n=t[t.length-1],i=a[o][0],s=a[o][1],l=0,u=n.children.indexOf(e),c=!1,d=[];i.lastIndex=0;let p=i.exec(e.value);for(;p;){let n=p.index,a={index:p.index,input:p.input,stack:[...t,e]},o=s(...p,a);if("string"==typeof o&&(o=o.length>0?{type:"text",value:o}:void 0),!1===o?i.lastIndex=n+1:(l!==n&&d.push({type:"text",value:e.value.slice(l,n)}),Array.isArray(o)?d.push(...o):o&&d.push(o),l=n+p[0].length,c=!0),!i.global)break;p=i.exec(e.value)}return c?(l<e.value.length&&d.push({type:"text",value:e.value.slice(l)}),n.children.splice(u,1,...d)):d=[e],u+d.length}}function SV(e){let t=[];if(!Array.isArray(e))throw TypeError("Expected find and replace tuple or list of tuples");let n=!e[0]||Array.isArray(e[0])?e:[e],i=-1;for(;++i<n.length;){let e=n[i];t.push([SG(e[0]),SH(e[1])])}return t}function SG(e){return"string"==typeof e?RegExp(SB(e),"g"):e}function SH(e){return"function"==typeof e?e:function(){return e}}let SW="phrasing",Sq=["autolink","link","image","label"];function SK(){return{transforms:[S2],enter:{literalAutolink:SZ,literalAutolinkEmail:SY,literalAutolinkHttp:SY,literalAutolinkWww:SY},exit:{literalAutolink:S1,literalAutolinkEmail:S0,literalAutolinkHttp:SQ,literalAutolinkWww:SJ}}}function SX(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:SW,notInConstruct:Sq},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:SW,notInConstruct:Sq},{character:":",before:"[ps]",after:"\\/",inConstruct:SW,notInConstruct:Sq}]}}function SZ(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function SY(e){this.config.enter.autolinkProtocol.call(this,e)}function SQ(e){this.config.exit.autolinkProtocol.call(this,e)}function SJ(e){this.config.exit.data.call(this,e);let t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function S0(e){this.config.exit.autolinkEmail.call(this,e)}function S1(e){this.exit(e)}function S2(e){SU(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,S3],[/(?<=^|\s|\p{P}|\p{S})([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/gu,S4]],{ignore:["link","linkReference"]})}function S3(e,t,n,i,a){let o="";if(!S8(a)||(/^w/i.test(t)&&(n=t+n,t="",o="http://"),!S6(n)))return!1;let s=S5(n+i);if(!s[0])return!1;let l={type:"link",title:null,url:o+t+s[0],children:[{type:"text",value:t+s[0]}]};return s[1]?[l,{type:"text",value:s[1]}]:l}function S4(e,t,n,i){return!(!S8(i,!0)||/[-\d_]$/.test(n))&&{type:"link",title:null,url:"mailto:"+t+"@"+n,children:[{type:"text",value:t+"@"+n}]}}function S6(e){let t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function S5(e){let t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let n=t[0],i=n.indexOf(")"),a=SF(e,"("),o=SF(e,")");for(;-1!==i&&a>o;)e+=n.slice(0,i+1),i=(n=n.slice(i+1)).indexOf(")"),o++;return[e,n]}function S8(e,t){let n=e.input.charCodeAt(e.index-1);return(0===e.index||xi(n)||xr(n))&&(!t||47!==n)}function S7(){this.buffer()}function S9(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function ke(){this.buffer()}function kt(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function kn(e){let t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=xW(this.sliceSerialize(e)).toLowerCase(),n.label=t}function kr(e){this.exit(e)}function ki(e){let t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=xW(this.sliceSerialize(e)).toLowerCase(),n.label=t}function ka(e){this.exit(e)}function ko(e,t,n,i){let a=n.createTracker(i),o=a.move("[^"),s=n.enter("footnoteReference"),l=n.enter("reference");return o+=a.move(n.safe(n.associationId(e),{after:"]",before:o})),l(),s(),o+=a.move("]")}function ks(){return{enter:{gfmFootnoteCallString:S7,gfmFootnoteCall:S9,gfmFootnoteDefinitionLabelString:ke,gfmFootnoteDefinition:kt},exit:{gfmFootnoteCallString:kn,gfmFootnoteCall:kr,gfmFootnoteDefinitionLabelString:ki,gfmFootnoteDefinition:ka}}}function kl(e){let t=!1;return e&&e.firstLineBlank&&(t=!0),{handlers:{footnoteDefinition:n,footnoteReference:ko},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function n(e,n,i,a){let o=i.createTracker(a),s=o.move("[^"),l=i.enter("footnoteDefinition"),u=i.enter("label");return s+=o.move(i.safe(i.associationId(e),{before:s,after:"]"})),u(),s+=o.move("]:"),e.children&&e.children.length>0&&(o.shift(4),s+=o.move((t?"\n":" ")+i.indentLines(i.containerFlow(e,o.current()),t?kc:ku))),l(),s}}function ku(e,t,n){return 0===t?e:kc(e,t,n)}function kc(e,t,n){return(n?"":"    ")+e}ko.peek=function e(){return"["};let kd=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];function kp(){return{canContainEols:["delete"],enter:{strikethrough:kf},exit:{strikethrough:kg}}}function kh(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:kd}],handlers:{delete:km}}}function kf(e){this.enter({type:"delete",children:[]},e)}function kg(e){this.exit(e)}function km(e,t,n,i){let a=n.createTracker(i),o=n.enter("strikethrough"),s=a.move("~~");return s+=n.containerPhrasing(e,{...a.current(),before:s,after:"~"}),s+=a.move("~~"),o(),s}function ky(){return"~"}function kb(e){return e.length}function kv(e,t){let n=t||{},i=(n.align||[]).concat(),a=n.stringLength||kb,o=[],s=[],l=[],u=[],c=0,d=-1;for(;++d<e.length;){let t=[],i=[],o=-1;for(e[d].length>c&&(c=e[d].length);++o<e[d].length;){let s=kx(e[d][o]);if(!1!==n.alignDelimiters){let e=a(s);i[o]=e,(void 0===u[o]||e>u[o])&&(u[o]=e)}t.push(s)}s[d]=t,l[d]=i}let p=-1;if("object"==typeof i&&"length"in i)for(;++p<c;)o[p]=kw(i[p]);else{let e=kw(i);for(;++p<c;)o[p]=e}p=-1;let h=[],f=[];for(;++p<c;){let e=o[p],t="",i="";99===e?(t=":",i=":"):108===e?t=":":114===e&&(i=":");let a=!1===n.alignDelimiters?1:Math.max(1,u[p]-t.length-i.length),s=t+"-".repeat(a)+i;!1!==n.alignDelimiters&&((a=t.length+a+i.length)>u[p]&&(u[p]=a),f[p]=a),h[p]=s}s.splice(1,0,h),l.splice(1,0,f),d=-1;let g=[];for(;++d<s.length;){let e=s[d],t=l[d];p=-1;let i=[];for(;++p<c;){let a=e[p]||"",s="",l="";if(!1!==n.alignDelimiters){let e=u[p]-(t[p]||0),n=o[p];114===n?s=" ".repeat(e):99===n?e%2?(s=" ".repeat(e/2+.5),l=" ".repeat(e/2-.5)):l=s=" ".repeat(e/2):l=" ".repeat(e)}!1===n.delimiterStart||p||i.push("|"),!1!==n.padding&&(!1!==n.alignDelimiters||""!==a)&&(!1!==n.delimiterStart||p)&&i.push(" "),!1!==n.alignDelimiters&&i.push(s),i.push(a),!1!==n.alignDelimiters&&i.push(l),!1!==n.padding&&i.push(" "),(!1!==n.delimiterEnd||p!==c-1)&&i.push("|")}g.push(!1===n.delimiterEnd?i.join("").replace(/ +$/,""):i.join(""))}return g.join("\n")}function kx(e){return null==e?"":String(e)}function kw(e){let t="string"==typeof e?e.codePointAt(0):0;return 67===t||99===t?99:76===t||108===t?108:114*(82===t||114===t)}function k_(e,t,n){return">"+(n?"":" ")+e}function kS(e,t){return kk(e,t.inConstruct,!0)&&!kk(e,t.notInConstruct,!1)}function kk(e,t,n){if("string"==typeof t&&(t=[t]),!t||0===t.length)return n;let i=-1;for(;++i<t.length;)if(e.includes(t[i]))return!0;return!1}function kT(e,t){let n=String(e),i=n.indexOf(t),a=i,o=0,s=0;if("string"!=typeof t)throw TypeError("Expected substring");for(;-1!==i;)i===a?++o>s&&(s=o):o=1,a=i+t.length,i=n.indexOf(t,a);return s}function kC(e,t){return!!(!1===t.options.fences&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function kE(e){let t=e.options.fence||"`";if("`"!==t&&"~"!==t)throw Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function kI(e,t,n){return(n?"":"    ")+e}function k$(e){let t=e.options.quote||'"';if('"'!==t&&"'"!==t)throw Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function kO(e){let t=e.options.emphasis||"*";if("*"!==t&&"_"!==t)throw Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function kA(e){return"&#x"+e.toString(16).toUpperCase()+";"}function kN(e,t,n){let i=wA(e),a=wA(t);return void 0===i?void 0===a?"_"===n?{inside:!0,outside:!0}:{inside:!1,outside:!1}:1===a?{inside:!0,outside:!0}:{inside:!1,outside:!0}:1===i?void 0===a?{inside:!1,outside:!1}:1===a?{inside:!0,outside:!0}:{inside:!1,outside:!1}:void 0===a?{inside:!1,outside:!1}:1===a?{inside:!0,outside:!1}:{inside:!1,outside:!1}}function kP(e,t,n,i){let a=kO(n),o=n.enter("emphasis"),s=n.createTracker(i),l=s.move(a),u=s.move(n.containerPhrasing(e,{after:a,before:l,...s.current()})),c=u.charCodeAt(0),d=kN(i.before.charCodeAt(i.before.length-1),c,a);d.inside&&(u=kA(c)+u.slice(1));let p=u.charCodeAt(u.length-1),h=kN(i.after.charCodeAt(0),p,a);h.inside&&(u=u.slice(0,-1)+kA(p));let f=s.move(a);return o(),n.attentionEncodeSurroundingInfo={after:h.outside,before:d.outside},l+u+f}function kD(e,t,n){return n.options.emphasis||"*"}function kM(e,t){let n=!1;return _D(e,function(e){if("value"in e&&/\r?\n|\r/.test(e.value)||"break"===e.type)return n=!0,_O}),!!((!e.depth||e.depth<3)&&vU(e)&&(t.options.setext||n))}function kz(e){return e.value||""}function kj(){return"<"}function kR(e,t,n,i){let a=k$(n),o='"'===a?"Quote":"Apostrophe",s=n.enter("image"),l=n.enter("label"),u=n.createTracker(i),c=u.move("![");return c+=u.move(n.safe(e.alt,{before:c,after:"]",...u.current()})),c+=u.move("]("),l(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),c+=u.move("<"),c+=u.move(n.safe(e.url,{before:c,after:">",...u.current()})),c+=u.move(">")):(l=n.enter("destinationRaw"),c+=u.move(n.safe(e.url,{before:c,after:e.title?" ":")",...u.current()}))),l(),e.title&&(l=n.enter(`title${o}`),c+=u.move(" "+a),c+=u.move(n.safe(e.title,{before:c,after:a,...u.current()})),c+=u.move(a),l()),c+=u.move(")"),s(),c}function kL(){return"!"}function kF(e,t,n,i){let a=e.referenceType,o=n.enter("imageReference"),s=n.enter("label"),l=n.createTracker(i),u=l.move("!["),c=n.safe(e.alt,{before:u,after:"]",...l.current()});u+=l.move(c+"]["),s();let d=n.stack;n.stack=[],s=n.enter("reference");let p=n.safe(n.associationId(e),{before:u,after:"]",...l.current()});return s(),n.stack=d,o(),"full"!==a&&c&&c===p?"shortcut"===a?u=u.slice(0,-1):u+=l.move("]"):u+=l.move(p+"]"),u}function kB(){return"!"}function kU(e,t,n){let i=e.value||"",a="`",o=-1;for(;RegExp("(^|[^`])"+a+"([^`]|$)").test(i);)a+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++o<n.unsafe.length;){let e,t=n.unsafe[o],a=n.compilePattern(t);if(t.atBreak)for(;e=a.exec(i);){let t=e.index;10===i.charCodeAt(t)&&13===i.charCodeAt(t-1)&&t--,i=i.slice(0,t)+" "+i.slice(e.index+1)}}return a+i+a}function kV(){return"`"}function kG(e,t){let n=vU(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&1===e.children.length&&"text"===e.children[0].type&&(n===e.url||"mailto:"+n===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}function kH(e,t,n,i){let a,o,s=k$(n),l='"'===s?"Quote":"Apostrophe",u=n.createTracker(i);if(kG(e,n)){let t=n.stack;n.stack=[],a=n.enter("autolink");let i=u.move("<");return i+=u.move(n.containerPhrasing(e,{before:i,after:">",...u.current()})),i+=u.move(">"),a(),n.stack=t,i}a=n.enter("link"),o=n.enter("label");let c=u.move("[");return c+=u.move(n.containerPhrasing(e,{before:c,after:"](",...u.current()})),c+=u.move("]("),o(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(o=n.enter("destinationLiteral"),c+=u.move("<"),c+=u.move(n.safe(e.url,{before:c,after:">",...u.current()})),c+=u.move(">")):(o=n.enter("destinationRaw"),c+=u.move(n.safe(e.url,{before:c,after:e.title?" ":")",...u.current()}))),o(),e.title&&(o=n.enter(`title${l}`),c+=u.move(" "+s),c+=u.move(n.safe(e.title,{before:c,after:s,...u.current()})),c+=u.move(s),o()),c+=u.move(")"),a(),c}function kW(e,t,n){return kG(e,n)?"<":"["}function kq(e,t,n,i){let a=e.referenceType,o=n.enter("linkReference"),s=n.enter("label"),l=n.createTracker(i),u=l.move("["),c=n.containerPhrasing(e,{before:u,after:"]",...l.current()});u+=l.move(c+"]["),s();let d=n.stack;n.stack=[],s=n.enter("reference");let p=n.safe(n.associationId(e),{before:u,after:"]",...l.current()});return s(),n.stack=d,o(),"full"!==a&&c&&c===p?"shortcut"===a?u=u.slice(0,-1):u+=l.move("]"):u+=l.move(p+"]"),u}function kK(){return"["}function kX(e){let t=e.options.bullet||"*";if("*"!==t&&"+"!==t&&"-"!==t)throw Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function kZ(e){let t=kX(e),n=e.options.bulletOther;if(!n)return"*"===t?"-":"*";if("*"!==n&&"+"!==n&&"-"!==n)throw Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===t)throw Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+n+"`) to be different");return n}function kY(e){let t=e.options.bulletOrdered||".";if("."!==t&&")"!==t)throw Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function kQ(e){let t=e.options.rule||"*";if("*"!==t&&"-"!==t&&"_"!==t)throw Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function kJ(e){let t=e.options.listItemIndent||"one";if("tab"!==t&&"one"!==t&&"mixed"!==t)throw Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function k0(e,t,n,i){let a=kJ(n),o=n.bulletCurrent||kX(n);t&&"list"===t.type&&t.ordered&&(o=("number"==typeof t.start&&t.start>-1?t.start:1)+(!1===n.options.incrementListMarker?0:t.children.indexOf(e))+o);let s=o.length+1;("tab"===a||"mixed"===a&&(t&&"list"===t.type&&t.spread||e.spread))&&(s=4*Math.ceil(s/4));let l=n.createTracker(i);l.move(o+" ".repeat(s-o.length)),l.shift(s);let u=n.enter("listItem"),c=n.indentLines(n.containerFlow(e,l.current()),d);return u(),c;function d(e,t,n){return t?(n?"":" ".repeat(s))+e:(n?o:o+" ".repeat(s-o.length))+e}}km.peek=ky,kP.peek=kD,kz.peek=kj,kR.peek=kL,kF.peek=kB,kU.peek=kV,kH.peek=kW,kq.peek=kK;let k1=_x(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function k2(e){let t=e.options.strong||"*";if("*"!==t&&"_"!==t)throw Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}function k3(e,t,n,i){let a=k2(n),o=n.enter("strong"),s=n.createTracker(i),l=s.move(a+a),u=s.move(n.containerPhrasing(e,{after:a,before:l,...s.current()})),c=u.charCodeAt(0),d=kN(i.before.charCodeAt(i.before.length-1),c,a);d.inside&&(u=kA(c)+u.slice(1));let p=u.charCodeAt(u.length-1),h=kN(i.after.charCodeAt(0),p,a);h.inside&&(u=u.slice(0,-1)+kA(p));let f=s.move(a+a);return o(),n.attentionEncodeSurroundingInfo={after:h.outside,before:d.outside},l+u+f}function k4(e,t,n){return n.options.strong||"*"}function k6(e){let t=e.options.ruleRepetition||3;if(t<3)throw Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}k3.peek=k4;let k5=kU,k8=k0;function k7(){return{enter:{table:k9,tableData:Tr,tableHeader:Tr,tableRow:Tt},exit:{codeText:Ti,table:Te,tableData:Tn,tableHeader:Tn,tableRow:Tn}}}function k9(e){let t=e._align;this.enter({type:"table",align:t.map(function(e){return"none"===e?null:e}),children:[]},e),this.data.inTable=!0}function Te(e){this.exit(e),this.data.inTable=void 0}function Tt(e){this.enter({type:"tableRow",children:[]},e)}function Tn(e){this.exit(e)}function Tr(e){this.enter({type:"tableCell",children:[]},e)}function Ti(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,Ta));let n=this.stack[this.stack.length-1];n.type,n.value=t,this.exit(e)}function Ta(e,t){return"|"===t?t:e}function To(e){let t=e||{},n=t.tableCellPadding,i=t.tablePipeAlign,a=t.stringLength,o=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:"\n",inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:h,table:s,tableCell:u,tableRow:l}};function s(e,t,n,i){return c(d(e,n,i),e.align)}function l(e,t,n,i){let a=c([p(e,n,i)]);return a.slice(0,a.indexOf("\n"))}function u(e,t,n,i){let a=n.enter("tableCell"),s=n.enter("phrasing"),l=n.containerPhrasing(e,{...i,before:o,after:o});return s(),a(),l}function c(e,t){return kv(e,{align:t,alignDelimiters:i,padding:n,stringLength:a})}function d(e,t,n){let i=e.children,a=-1,o=[],s=t.enter("table");for(;++a<i.length;)o[a]=p(i[a],t,n);return s(),o}function p(e,t,n){let i=e.children,a=-1,o=[],s=t.enter("tableRow");for(;++a<i.length;)o[a]=u(i[a],e,t,n);return s(),o}function h(e,t,n){let i=k5(e,t,n);return n.stack.includes("tableCell")&&(i=i.replace(/\|/g,"\\$&")),i}}function Ts(){return{exit:{taskListCheckValueChecked:Tu,taskListCheckValueUnchecked:Tu,paragraph:Tc}}}function Tl(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:Td}}}function Tu(e){let t=this.stack[this.stack.length-2];t.type,t.checked="taskListCheckValueChecked"===e.type}function Tc(e){let t=this.stack[this.stack.length-2];if(t&&"listItem"===t.type&&"boolean"==typeof t.checked){let e=this.stack[this.stack.length-1];e.type;let n=e.children[0];if(n&&"text"===n.type){let i,a=t.children,o=-1;for(;++o<a.length;){let e=a[o];if("paragraph"===e.type){i=e;break}}i===e&&(n.value=n.value.slice(1),0===n.value.length?e.children.shift():e.position&&n.position&&"number"==typeof n.position.start.offset&&(n.position.start.column++,n.position.start.offset++,e.position.start=Object.assign({},n.position.start)))}}this.exit(e)}function Td(e,t,n,i){let a=e.children[0],o="boolean"==typeof e.checked&&a&&"paragraph"===a.type,s="["+(e.checked?"x":" ")+"] ",l=n.createTracker(i);o&&l.move(s);let u=k8(e,t,n,{...i,...l.current()});return o&&(u=u.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,c)),u;function c(e){return e+s}}function Tp(){return[SK(),ks(),kp(),k7(),Ts()]}function Th(e){return{extensions:[SX(),kl(e),kh(),To(e),Tl()]}}let Tf={tokenize:TI,partial:!0},Tg={tokenize:T$,partial:!0},Tm={tokenize:TO,partial:!0},Ty={tokenize:TA,partial:!0},Tb={tokenize:TN,partial:!0},Tv={name:"wwwAutolink",tokenize:TC,previous:TP},Tx={name:"protocolAutolink",tokenize:TE,previous:TD},Tw={name:"emailAutolink",tokenize:TT,previous:TM},T_={};function TS(){return{text:T_}}let Tk=48;for(;Tk<123;)T_[Tk]=Tw,58==++Tk?Tk=65:91===Tk&&(Tk=97);function TT(e,t,n){let i,a,o=this;return s;function s(t){return!Tz(t)||!TM.call(o,o.previous)||Tj(o.events)?n(t):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),l(t))}function l(t){return Tz(t)?(e.consume(t),l):64===t?(e.consume(t),u):n(t)}function u(t){return 46===t?e.check(Tb,d,c)(t):45===t||95===t||v4(t)?(a=!0,e.consume(t),u):d(t)}function c(t){return e.consume(t),i=!0,u}function d(s){return a&&i&&v3(o.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(s)):n(s)}}function TC(e,t,n){let i=this;return a;function a(t){return 87!==t&&119!==t||!TP.call(i,i.previous)||Tj(i.events)?n(t):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(Tf,e.attempt(Tg,e.attempt(Tm,o),n),n)(t))}function o(n){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(n)}}function TE(e,t,n){let i=this,a="",o=!1;return s;function s(t){return(72===t||104===t)&&TD.call(i,i.previous)&&!Tj(i.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(t),e.consume(t),l):n(t)}function l(t){if(v3(t)&&a.length<5)return a+=String.fromCodePoint(t),e.consume(t),l;if(58===t){let n=a.toLowerCase();if("http"===n||"https"===n)return e.consume(t),u}return n(t)}function u(t){return 47===t?(e.consume(t),o)?c:(o=!0,u):n(t)}function c(t){return null===t||v5(t)||xt(t)||xi(t)||xr(t)?n(t):e.attempt(Tg,e.attempt(Tm,d),n)(t)}function d(n){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(n)}}function TI(e,t,n){let i=0;return a;function a(t){return(87===t||119===t)&&i<3?(i++,e.consume(t),a):46===t&&3===i?(e.consume(t),o):n(t)}function o(e){return null===e?n(e):t(e)}}function T$(e,t,n){let i,a,o;return s;function s(t){return 46===t||95===t?e.check(Ty,u,l)(t):null===t||xt(t)||xi(t)||45!==t&&xr(t)?u(t):(o=!0,e.consume(t),s)}function l(t){return 95===t?i=!0:(a=i,i=void 0),e.consume(t),s}function u(e){return a||i||!o?n(e):t(e)}}function TO(e,t){let n=0,i=0;return a;function a(s){return 40===s?(n++,e.consume(s),a):41===s&&i<n?o(s):33===s||34===s||38===s||39===s||41===s||42===s||44===s||46===s||58===s||59===s||60===s||63===s||93===s||95===s||126===s?e.check(Ty,t,o)(s):null===s||xt(s)||xi(s)?t(s):(e.consume(s),a)}function o(t){return 41===t&&i++,e.consume(t),a}}function TA(e,t,n){return i;function i(s){return 33===s||34===s||39===s||41===s||42===s||44===s||46===s||58===s||59===s||63===s||95===s||126===s?(e.consume(s),i):38===s?(e.consume(s),o):93===s?(e.consume(s),a):60===s||null===s||xt(s)||xi(s)?t(s):n(s)}function a(e){return null===e||40===e||91===e||xt(e)||xi(e)?t(e):i(e)}function o(e){return v3(e)?s(e):n(e)}function s(t){return 59===t?(e.consume(t),i):v3(t)?(e.consume(t),s):n(t)}}function TN(e,t,n){return i;function i(t){return e.consume(t),a}function a(e){return v4(e)?n(e):t(e)}}function TP(e){return null===e||40===e||42===e||95===e||91===e||93===e||126===e||xt(e)}function TD(e){return!v3(e)}function TM(e){return!(47===e||Tz(e))}function Tz(e){return 43===e||45===e||46===e||95===e||v4(e)}function Tj(e){let t=e.length,n=!1;for(;t--;){let i=e[t][1];if(("labelLink"===i.type||"labelImage"===i.type)&&!i._balanced){n=!0;break}if(i._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}T_[43]=Tw,T_[45]=Tw,T_[46]=Tw,T_[95]=Tw,T_[72]=[Tw,Tx],T_[104]=[Tw,Tx],T_[87]=[Tw,Tv],T_[119]=[Tw,Tv];let TR={tokenize:TW,partial:!0};function TL(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:TV,continuation:{tokenize:TG},exit:TH}},text:{91:{name:"gfmFootnoteCall",tokenize:TU},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:TF,resolveTo:TB}}}}function TF(e,t,n){let i,a=this,o=a.events.length,s=a.parser.gfmFootnotes||(a.parser.gfmFootnotes=[]);for(;o--;){let e=a.events[o][1];if("labelImage"===e.type){i=e;break}if("gfmFootnoteCall"===e.type||"labelLink"===e.type||"label"===e.type||"image"===e.type||"link"===e.type)break}return l;function l(o){if(!i||!i._balanced)return n(o);let l=xW(a.sliceSerialize({start:i.end,end:a.now()}));return 94===l.codePointAt(0)&&s.includes(l.slice(1))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(o),e.exit("gfmFootnoteCallLabelMarker"),t(o)):n(o)}}function TB(e,t){let n,i=e.length;for(;i--;)if("labelImage"===e[i][1].type&&"enter"===e[i][0]){n=e[i][1];break}e[i+1][1].type="data",e[i+3][1].type="gfmFootnoteCallLabelMarker";let a={type:"gfmFootnoteCall",start:Object.assign({},e[i+3][1].start),end:Object.assign({},e[e.length-1][1].end)},o={type:"gfmFootnoteCallMarker",start:Object.assign({},e[i+3][1].end),end:Object.assign({},e[i+3][1].end)};o.end.column++,o.end.offset++,o.end._bufferIndex++;let s={type:"gfmFootnoteCallString",start:Object.assign({},o.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},s.start),end:Object.assign({},s.end)},u=[e[i+1],e[i+2],["enter",a,t],e[i+3],e[i+4],["enter",o,t],["exit",o,t],["enter",s,t],["enter",l,t],["exit",l,t],["exit",s,t],e[e.length-2],e[e.length-1],["exit",a,t]];return e.splice(i,e.length-i+1,...u),e}function TU(e,t,n){let i,a=this,o=a.parser.gfmFootnotes||(a.parser.gfmFootnotes=[]),s=0;return l;function l(t){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(t),e.exit("gfmFootnoteCallLabelMarker"),u}function u(t){return 94!==t?n(t):(e.enter("gfmFootnoteCallMarker"),e.consume(t),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",c)}function c(l){if(s>999||93===l&&!i||null===l||91===l||xt(l))return n(l);if(93===l){e.exit("chunkString");let i=e.exit("gfmFootnoteCallString");return o.includes(xW(a.sliceSerialize(i)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(l),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(l)}return xt(l)||(i=!0),s++,e.consume(l),92===l?d:c}function d(t){return 91===t||92===t||93===t?(e.consume(t),s++,c):c(t)}}function TV(e,t,n){let i,a,o=this,s=o.parser.gfmFootnotes||(o.parser.gfmFootnotes=[]),l=0;return u;function u(t){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(t){return 94===t?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",d):n(t)}function d(t){if(l>999||93===t&&!a||null===t||91===t||xt(t))return n(t);if(93===t){e.exit("chunkString");let n=e.exit("gfmFootnoteDefinitionLabelString");return i=xW(o.sliceSerialize(n)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),h}return xt(t)||(a=!0),l++,e.consume(t),92===t?p:d}function p(t){return 91===t||92===t||93===t?(e.consume(t),l++,d):d(t)}function h(t){return 58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),s.includes(i)||s.push(i),xo(e,f,"gfmFootnoteDefinitionWhitespace")):n(t)}function f(e){return t(e)}}function TG(e,t,n){return e.check(xh,t,e.attempt(TR,t,n))}function TH(e){e.exit("gfmFootnoteDefinition")}function TW(e,t,n){let i=this;return xo(e,a,"gfmFootnoteDefinitionIndent",5);function a(e){let a=i.events[i.events.length-1];return a&&"gfmFootnoteDefinitionIndent"===a[1].type&&4===a[2].sliceSerialize(a[1],!0).length?t(e):n(e)}}function Tq(e){let t=(e||{}).singleTilde,n={name:"strikethrough",tokenize:a,resolveAll:i};return null==t&&(t=!0),{text:{126:n},insideSpan:{null:[n]},attentionMarkers:{null:[126]}};function i(e,t){let n=-1;for(;++n<e.length;)if("enter"===e[n][0]&&"strikethroughSequenceTemporary"===e[n][1].type&&e[n][1]._close){let i=n;for(;i--;)if("exit"===e[i][0]&&"strikethroughSequenceTemporary"===e[i][1].type&&e[i][1]._open&&e[n][1].end.offset-e[n][1].start.offset==e[i][1].end.offset-e[i][1].start.offset){e[n][1].type="strikethroughSequence",e[i][1].type="strikethroughSequence";let a={type:"strikethrough",start:Object.assign({},e[i][1].start),end:Object.assign({},e[n][1].end)},o={type:"strikethroughText",start:Object.assign({},e[i][1].end),end:Object.assign({},e[n][1].start)},s=[["enter",a,t],["enter",e[i][1],t],["exit",e[i][1],t],["enter",o,t]],l=t.parser.constructs.insideSpan.null;l&&vW(s,s.length,0,wb(l,e.slice(i+1,n),t)),vW(s,s.length,0,[["exit",o,t],["enter",e[n][1],t],["exit",e[n][1],t],["exit",a,t]]),vW(e,i-1,n-i+3,s),n=i+s.length-2;break}}for(n=-1;++n<e.length;)"strikethroughSequenceTemporary"===e[n][1].type&&(e[n][1].type="data");return e}function a(e,n,i){let a=this.previous,o=this.events,s=0;return l;function l(t){return 126===a&&"characterEscape"!==o[o.length-1][1].type?i(t):(e.enter("strikethroughSequenceTemporary"),u(t))}function u(o){let l=wA(a);if(126===o)return s>1?i(o):(e.consume(o),s++,u);if(s<2&&!t)return i(o);let c=e.exit("strikethroughSequenceTemporary"),d=wA(o);return c._open=!d||2===d&&!!l,c._close=!l||2===l&&!!d,n(o)}}}class TK{constructor(){this.map=[]}add(e,t,n){TX(this,e,t,n)}consume(e){if(this.map.sort(function(e,t){return e[0]-t[0]}),0===this.map.length)return;let t=this.map.length,n=[];for(;t>0;)t-=1,n.push(e.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),e.length=this.map[t][0];n.push(e.slice()),e.length=0;let i=n.pop();for(;i;){for(let t of i)e.push(t);i=n.pop()}this.map.length=0}}function TX(e,t,n,i){let a=0;if(0!==n||0!==i.length){for(;a<e.map.length;){if(e.map[a][0]===t){e.map[a][1]+=n,e.map[a][2].push(...i);return}a+=1}e.map.push([t,n,i])}}function TZ(e,t){let n=!1,i=[];for(;t<e.length;){let a=e[t];if(n){if("enter"===a[0])"tableContent"===a[1].type&&i.push("tableDelimiterMarker"===e[t+1][1].type?"left":"none");else if("tableContent"===a[1].type){if("tableDelimiterMarker"===e[t-1][1].type){let e=i.length-1;i[e]="left"===i[e]?"center":"right"}}else if("tableDelimiterRow"===a[1].type)break}else"enter"===a[0]&&"tableDelimiterRow"===a[1].type&&(n=!0);t+=1}return i}function TY(){return{flow:{null:{name:"table",tokenize:TQ,resolveAll:TJ}}}}function TQ(e,t,n){let i,a=this,o=0,s=0;return l;function l(e){let t=a.events.length-1;for(;t>-1;){let e=a.events[t][1].type;if("lineEnding"===e||"linePrefix"===e)t--;else break}let i=t>-1?a.events[t][1].type:null,o="tableHead"===i||"tableRow"===i?S:u;return o===S&&a.parser.lazy[a.now().line]?n(e):o(e)}function u(t){return e.enter("tableHead"),e.enter("tableRow"),c(t)}function c(e){return 124===e||(i=!0,s+=1),d(e)}function d(t){return null===t?n(t):xe(t)?s>1?(s=0,a.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),f):n(t):xn(t)?xo(e,d,"whitespace")(t):(s+=1,i&&(i=!1,o+=1),124===t)?(e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),i=!0,d):(e.enter("data"),p(t))}function p(t){return null===t||124===t||xt(t)?(e.exit("data"),d(t)):(e.consume(t),92===t?h:p)}function h(t){return 92===t||124===t?(e.consume(t),p):p(t)}function f(t){return(a.interrupt=!1,a.parser.lazy[a.now().line])?n(t):(e.enter("tableDelimiterRow"),i=!1,xn(t))?xo(e,g,"linePrefix",a.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):g(t)}function g(t){return 45===t||58===t?y(t):124===t?(i=!0,e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),m):_(t)}function m(t){return xn(t)?xo(e,y,"whitespace")(t):y(t)}function y(t){return 58===t?(s+=1,i=!0,e.enter("tableDelimiterMarker"),e.consume(t),e.exit("tableDelimiterMarker"),b):45===t?(s+=1,b(t)):null===t||xe(t)?w(t):_(t)}function b(t){return 45===t?(e.enter("tableDelimiterFiller"),v(t)):_(t)}function v(t){return 45===t?(e.consume(t),v):58===t?(i=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(t),e.exit("tableDelimiterMarker"),x):(e.exit("tableDelimiterFiller"),x(t))}function x(t){return xn(t)?xo(e,w,"whitespace")(t):w(t)}function w(n){return 124===n?g(n):null===n||xe(n)?i&&o===s?(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(n)):_(n):_(n)}function _(e){return n(e)}function S(t){return e.enter("tableRow"),k(t)}function k(n){return 124===n?(e.enter("tableCellDivider"),e.consume(n),e.exit("tableCellDivider"),k):null===n||xe(n)?(e.exit("tableRow"),t(n)):xn(n)?xo(e,k,"whitespace")(n):(e.enter("data"),T(n))}function T(t){return null===t||124===t||xt(t)?(e.exit("data"),k(t)):(e.consume(t),92===t?C:T)}function C(t){return 92===t||124===t?(e.consume(t),T):T(t)}}function TJ(e,t){let n,i,a,o=-1,s=!0,l=0,u=[0,0,0,0],c=[0,0,0,0],d=!1,p=0,h=new TK;for(;++o<e.length;){let f=e[o],g=f[1];"enter"===f[0]?"tableHead"===g.type?(d=!1,0!==p&&(T1(h,t,p,n,i),i=void 0,p=0),n={type:"table",start:Object.assign({},g.start),end:Object.assign({},g.end)},h.add(o,0,[["enter",n,t]])):"tableRow"===g.type||"tableDelimiterRow"===g.type?(s=!0,a=void 0,u=[0,0,0,0],c=[0,o+1,0,0],d&&(d=!1,i={type:"tableBody",start:Object.assign({},g.start),end:Object.assign({},g.end)},h.add(o,0,[["enter",i,t]])),l="tableDelimiterRow"===g.type?2:i?3:1):l&&("data"===g.type||"tableDelimiterMarker"===g.type||"tableDelimiterFiller"===g.type)?(s=!1,0===c[2]&&(0!==u[1]&&(c[0]=c[1],a=T0(h,t,u,l,void 0,a),u=[0,0,0,0]),c[2]=o)):"tableCellDivider"===g.type&&(s?s=!1:(0!==u[1]&&(c[0]=c[1],a=T0(h,t,u,l,void 0,a)),c=[(u=c)[1],o,0,0])):"tableHead"===g.type?(d=!0,p=o):"tableRow"===g.type||"tableDelimiterRow"===g.type?(p=o,0!==u[1]?(c[0]=c[1],a=T0(h,t,u,l,o,a)):0!==c[1]&&(a=T0(h,t,c,l,o,a)),l=0):l&&("data"===g.type||"tableDelimiterMarker"===g.type||"tableDelimiterFiller"===g.type)&&(c[3]=o)}for(0!==p&&T1(h,t,p,n,i),h.consume(t.events),o=-1;++o<t.events.length;){let e=t.events[o];"enter"===e[0]&&"table"===e[1].type&&(e[1]._align=TZ(t.events,o))}return e}function T0(e,t,n,i,a,o){let s=1===i?"tableHeader":2===i?"tableDelimiter":"tableData",l="tableContent";0!==n[0]&&(o.end=Object.assign({},T2(t.events,n[0])),e.add(n[0],0,[["exit",o,t]]));let u=T2(t.events,n[1]);if(o={type:s,start:Object.assign({},u),end:Object.assign({},u)},e.add(n[1],0,[["enter",o,t]]),0!==n[2]){let a=T2(t.events,n[2]),o=T2(t.events,n[3]),s={type:l,start:Object.assign({},a),end:Object.assign({},o)};if(e.add(n[2],0,[["enter",s,t]]),2!==i){let i=t.events[n[2]],a=t.events[n[3]];if(i[1].end=Object.assign({},a[1].end),i[1].type="chunkText",i[1].contentType="text",n[3]>n[2]+1){let t=n[2]+1,i=n[3]-n[2]-1;e.add(t,i,[])}}e.add(n[3]+1,0,[["exit",s,t]])}return void 0!==a&&(o.end=Object.assign({},T2(t.events,a)),e.add(a,0,[["exit",o,t]]),o=void 0),o}function T1(e,t,n,i,a){let o=[],s=T2(t.events,n);a&&(a.end=Object.assign({},s),o.push(["exit",a,t])),i.end=Object.assign({},s),o.push(["exit",i,t]),e.add(n+1,0,o)}function T2(e,t){let n=e[t],i="enter"===n[0]?"start":"end";return n[1][i]}let T3={name:"tasklistCheck",tokenize:T6};function T4(){return{text:{91:T3}}}function T6(e,t,n){let i=this;return a;function a(t){return null===i.previous&&i._gfmTasklistFirstContentOfListItem?(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(t),e.exit("taskListCheckMarker"),o):n(t)}function o(t){return xt(t)?(e.enter("taskListCheckValueUnchecked"),e.consume(t),e.exit("taskListCheckValueUnchecked"),s):88===t||120===t?(e.enter("taskListCheckValueChecked"),e.consume(t),e.exit("taskListCheckValueChecked"),s):n(t)}function s(t){return 93===t?(e.enter("taskListCheckMarker"),e.consume(t),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),l):n(t)}function l(i){return xe(i)?t(i):xn(i)?e.check({tokenize:T5},t,n)(i):n(i)}}function T5(e,t,n){return xo(e,i,"whitespace");function i(e){return null===e?n(e):t(e)}}function T8(e){return v0([TS(),TL(),Tq(e),TY(),T4()])}let T7={};function T9(e){let t=this,n=e||T7,i=t.data(),a=i.micromarkExtensions||(i.micromarkExtensions=[]),o=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),s=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);a.push(T8(n)),o.push(Tp()),s.push(Th(n))}let Ce=(0,x.createContext)(null),Ct=e=>{var t;let{children:n}=e,{currentNode:i,moveNumber:a}=tH(),{setNodeComment:o}=tq(),[s,l]=(0,x.useState)(!1),[u,c]=(0,x.useState)(""),d=(0,x.useRef)(null),p=(null==i||null==(t=i.data.C)?void 0:t[0])||"",h=(null==i?void 0:i.id)??null;(0,x.useEffect)(()=>{d.current!==h&&(c(p),l(!1),d.current=h)},[h,p]),(0,x.useEffect)(()=>{s||c(p)},[p,s]);let f=(0,x.useCallback)(()=>{c(p),l(!0)},[p]),g=(0,x.useCallback)(()=>{o(u),l(!1)},[u,o]),m=(0,x.useCallback)(()=>{c(p),l(!1)},[p]),y={moveNumber:a,isEditing:s,editText:u,setEditText:c,currentComment:p,currentNodeId:h,handleEdit:f,handleSave:g,handleCancel:m};return(0,v.jsx)(Ce.Provider,{value:y,children:n})},Cn=()=>{let e=(0,x.useContext)(Ce);if(!e)throw Error("useCommentEditorState must be used within a CommentEditorProvider");return e},Cr=()=>{let{t:e}=rK(),{moveNumber:t,isEditing:n,handleEdit:i,handleSave:a,handleCancel:o}=Cn();return(0,v.jsxs)(v.Fragment,{children:[t>0&&(0,v.jsx)("span",{className:"move-number",children:e("comment.move",{number:t})}),!n&&(0,v.jsx)("button",{onClick:i,className:"comment-edit-button",title:e("comment.editComment"),children:(0,v.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,v.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,v.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),n&&(0,v.jsxs)("div",{className:"comment-actions",children:[(0,v.jsx)("button",{onClick:a,className:"comment-save-button",title:e("comment.saveShortcut"),children:e("comment.save")}),(0,v.jsx)("button",{onClick:o,className:"comment-cancel-button",title:e("comment.cancelShortcut"),children:e("comment.cancel")})]})]})},Ci=()=>{let{t:e}=rK(),{isEditing:t,editText:n,setEditText:i,currentComment:a,currentNodeId:o,handleEdit:s,handleSave:l,handleCancel:u}=Cn(),c=(0,x.useRef)(null);(0,x.useEffect)(()=>{if(t&&c.current){c.current.focus();let e=c.current.value.length;c.current.setSelectionRange(e,e)}},[t]);let d=(0,x.useCallback)(e=>{e.stopPropagation(),"Escape"===e.key?(e.preventDefault(),u()):"Enter"!==e.key||e.shiftKey?"s"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),l()):(e.preventDefault(),l())},[u,l]);return null===o?(0,v.jsx)("div",{className:"comment-editor",children:(0,v.jsx)("div",{className:"comment-empty",children:e("comment.noMoveSelected")})}):(0,v.jsx)("div",{className:`comment-editor ${t?"comment-editor--editing":""}`,children:t?(0,v.jsxs)("div",{className:"comment-editor-container",children:[(0,v.jsx)("textarea",{ref:c,value:n,onChange:e=>i(e.target.value),onKeyDown:d,className:"comment-textarea",placeholder:e("comment.placeholder")}),(0,v.jsx)("div",{className:"comment-hint",children:e("comment.enterHint")})]}):(0,v.jsx)("div",{className:"comment-display",onClick:s,children:a?(0,v.jsx)("div",{className:"comment-markdown",children:(0,v.jsx)(SM,{remarkPlugins:[T9],children:a})}):(0,v.jsx)("div",{className:"comment-empty",children:e("comment.noComment")})})})},Ca=()=>{let{t:e}=rK(),{isLoadingSGF:t,loadingProgress:n,loadingMessage:i}=tZ();return t?(0,v.jsx)("div",{className:"loading-overlay",children:(0,v.jsxs)("div",{className:"loading-modal",children:[(0,v.jsx)("div",{className:"loading-header",children:(0,v.jsx)("h3",{children:e("loading.loadingSgfFile")})}),(0,v.jsxs)("div",{className:"loading-content",children:[(0,v.jsx)("div",{className:"loading-spinner"}),(0,v.jsxs)("div",{className:"loading-progress-container",children:[(0,v.jsx)("div",{className:"loading-progress-bar",children:(0,v.jsx)("div",{className:"loading-progress-fill",style:{width:`${n}%`}})}),(0,v.jsxs)("div",{className:"loading-progress-text",children:[n,"%"]})]}),(0,v.jsx)("div",{className:"loading-message",children:i})]})]})}):null},Co=e=>{let{data:t,currentMoveNumber:n,totalMoves:i,onNavigate:a,onNavigateToMove:o,showWinRate:s=!0,showScoreLead:l=!0,onToggleWinRate:u,onToggleScoreLead:c}=e,[d,p]=(0,x.useState)(null),h=(0,x.useRef)(null),f=(0,x.useRef)(null),[g,m]=(0,x.useState)(400),y=150,b=12,w=36,_=28,S=40;(0,x.useEffect)(()=>{let e=f.current;if(!e)return;m(e.getBoundingClientRect().width||400);let t=new ResizeObserver(e=>{for(let t of e){let e=t.contentRect.width;e>0&&m(e)}});return t.observe(e),()=>t.disconnect()},[]);let k=(0,x.useMemo)(()=>{let e=g,n=y,a=e-S-w,o=n-b-_;if(0===t.length)return{width:e,height:n,innerWidth:a,innerHeight:o,maxMove:i,scoreRange:20};let s=Math.max(i,...t.map(e=>e.moveNumber)),l=t.map(e=>e.scoreLead);return{width:e,height:n,innerWidth:a,innerHeight:o,maxMove:s,scoreRange:Math.ceil(1.1*Math.max(Math.abs(Math.min(...l)),Math.abs(Math.max(...l)),10))}},[t,i,g,S,w,b,_]),T=(0,x.useCallback)(e=>0===k.maxMove?S:S+e/k.maxMove*k.innerWidth,[k.maxMove,k.innerWidth,S]),C=.05,E=(0,x.useCallback)(e=>{let t=1+2*C;return b+(1+C-e)/t*k.innerHeight},[k.innerHeight,b,C]),I=(0,x.useCallback)(e=>b+(k.scoreRange-e)/(2*k.scoreRange)*k.innerHeight,[k.scoreRange,k.innerHeight,b]),$=(0,x.useMemo)(()=>0!==t.length&&s?[...t].sort((e,t)=>e.moveNumber-t.moveNumber).map((e,t)=>{let n=T(e.moveNumber),i=E(e.blackWinRate);return`${0===t?"M":"L"} ${n} ${i}`}).join(" "):"",[t,s,T,E]),O=(0,x.useMemo)(()=>0!==t.length&&l?[...t].sort((e,t)=>e.moveNumber-t.moveNumber).map((e,t)=>{let n=T(e.moveNumber),i=I(e.scoreLead);return`${0===t?"M":"L"} ${n} ${i}`}).join(" "):"",[t,l,T,I]),A=(0,x.useCallback)(e=>{if(!h.current)return;let n=h.current.getBoundingClientRect(),a=Math.max(0,Math.min(i,Math.round((e.clientX-n.left-S)/k.innerWidth*k.maxMove))),o=t.find(e=>e.moveNumber===a)??null;p({x:T(a),y:0,moveNumber:a,dataPoint:o})},[t,T,S,k.innerWidth,k.maxMove,i]),N=(0,x.useCallback)(()=>{p(null)},[]),P=(0,x.useCallback)(e=>{d&&(d.dataPoint&&a?a(d.dataPoint.nodeId):o&&o(d.moveNumber))},[d,a,o]),D=(0,x.useMemo)(()=>{let e;if(0===k.maxMove)return[];let t=5,n=k.maxMove/t,i=Math.pow(10,Math.floor(Math.log10(n))),a=n/i,o=[0],s=e=a<=1?i:a<=2?2*i:a<=5?5*i:10*i;for(;s<k.maxMove;)o.push(s),s+=e;return o[o.length-1]!==k.maxMove&&o.push(k.maxMove),o},[k.maxMove]),M=(0,x.useCallback)(e=>{let t=Math.abs(e);return e>0?`B+${t.toFixed(1)}`:e<0?`W+${t.toFixed(1)}`:"0"},[]),z=(0,x.useCallback)(e=>{let t=(100*e).toFixed(1);return`B: ${t}%`},[]),j=(0,x.useMemo)(()=>n<0||0===k.maxMove?null:T(n),[n,k.maxMove,T]),R=(0,x.useMemo)(()=>t.find(e=>e.moveNumber===n)??null,[t,n]);return(0,v.jsxs)("div",{className:"analysis-chart-container",children:[(0,v.jsx)("div",{ref:f,className:"analysis-chart-wrapper",children:(0,v.jsxs)("svg",{ref:h,className:"analysis-chart-svg",width:k.width,height:k.height,onMouseMove:A,onMouseLeave:N,onClick:P,style:{cursor:d?"pointer":"default"},children:[(0,v.jsx)("rect",{x:S,y:b,width:k.innerWidth,height:k.innerHeight,className:"chart-background"}),s&&(0,v.jsx)("line",{x1:S,y1:E(.5),x2:S+k.innerWidth,y2:E(.5),className:"chart-midline"}),l&&(0,v.jsx)("line",{x1:S,y1:I(0),x2:S+k.innerWidth,y2:I(0),className:"chart-zeroline"}),s&&(0,v.jsx)("path",{d:$,className:"chart-line winrate-line"}),l&&(0,v.jsx)("path",{d:O,className:"chart-line score-line"}),null!==j&&(0,v.jsx)("line",{x1:j,y1:b,x2:j,y2:b+k.innerHeight,className:"chart-current-line"}),d&&(0,v.jsx)(v.Fragment,{children:(0,v.jsx)("line",{x1:d.x,y1:b,x2:d.x,y2:b+k.innerHeight,className:"chart-hover-line"})}),s&&(0,v.jsxs)("g",{className:"axis axis-left",children:[(0,v.jsx)("line",{x1:S,y1:b,x2:S,y2:b+k.innerHeight,className:"axis-line"}),(0,v.jsx)("text",{x:S-4,y:b+5,className:"axis-label winrate-label-top",children:"100%"}),(0,v.jsx)("text",{x:S-4,y:E(.5)+4,className:"axis-label winrate-label-mid",children:"50%"}),(0,v.jsx)("text",{x:S-4,y:b+k.innerHeight,className:"axis-label winrate-label-bottom",children:"0%"}),(0,v.jsx)("text",{x:8,y:b+k.innerHeight/2,className:"axis-title winrate-axis-title",transform:`rotate(-90, 8, ${b+k.innerHeight/2})`,children:"Win Rate"})]}),l&&(0,v.jsxs)("g",{className:"axis axis-right",children:[(0,v.jsx)("line",{x1:S+k.innerWidth,y1:b,x2:S+k.innerWidth,y2:b+k.innerHeight,className:"axis-line"}),(0,v.jsxs)("text",{x:S+k.innerWidth+4,y:b+5,className:"axis-label score-label-value",children:["+",k.scoreRange]}),(0,v.jsx)("text",{x:S+k.innerWidth+4,y:I(0)+4,className:"axis-label score-label-value",children:"0"}),(0,v.jsxs)("text",{x:S+k.innerWidth+4,y:b+k.innerHeight,className:"axis-label score-label-value",children:["-",k.scoreRange]}),(0,v.jsx)("text",{x:k.width-8,y:b+k.innerHeight/2,className:"axis-title score-axis-title",transform:`rotate(90, ${k.width-8}, ${b+k.innerHeight/2})`,children:"Score"})]}),(0,v.jsxs)("g",{className:"axis axis-bottom",children:[(0,v.jsx)("line",{x1:S,y1:b+k.innerHeight,x2:S+k.innerWidth,y2:b+k.innerHeight,className:"axis-line"}),D.map(e=>(0,v.jsxs)("g",{children:[(0,v.jsx)("line",{x1:T(e),y1:b+k.innerHeight,x2:T(e),y2:b+k.innerHeight+4,className:"axis-tick"}),(0,v.jsx)("text",{x:T(e),y:b+k.innerHeight+16,className:"axis-label axis-label-bottom",children:e})]},e))]})]})}),(0,v.jsxs)("div",{className:"analysis-chart-current-info",children:[(0,v.jsxs)("span",{className:"current-move",children:["Move ",n]}),R?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{className:"current-winrate winrate-value",children:z(R.blackWinRate)}),(0,v.jsx)("span",{className:`current-score ${R.scoreLead>=0?"score-positive":"score-negative"}`,children:M(R.scoreLead)})]}):(0,v.jsx)("span",{className:"current-no-data",children:"Not analyzed"})]}),(0,v.jsx)("div",{className:"analysis-chart-perspective-note",children:(0,v.jsx)("em",{children:"Win rate and score are from Black's perspective"})})]})},Cs=e=>{let{className:t=""}=e,{t:n}=rK(),{gameTree:i,currentNodeId:a,rootId:o,gameInfo:s,analysisCache:l,analysisCacheSize:u,navigate:c,navigateToMove:d,analysisMode:p,toggleAnalysisMode:h}=tQ(),{analyzeFullGame:f,stopFullGameAnalysis:g,isFullGameAnalyzing:m,isStopping:y,fullGameProgress:b,isInitializing:w,pendingFullGameAnalysis:_,toggleOwnership:S,showOwnership:k,clearAnalysisCache:T,showTopMoves:C,toggleTopMoves:E,isAnalyzing:I}=na(),[$,O]=(0,x.useState)(!0),[A,N]=(0,x.useState)(!0),[P,D]=(0,x.useState)(!1),M=(0,x.useCallback)(()=>{O(e=>!e)},[]),z=(0,x.useCallback)(()=>{N(e=>!e)},[]),{dataPoints:j,totalPositions:R,currentPositionIndex:L,analyzedCount:F}=(0,x.useMemo)(()=>{if(!i||null==o||null===a)return{dataPoints:[],totalPositions:0,currentPositionIndex:0,analyzedCount:0};let e=s.boardSize??19,t=s.komi??7.5,n=et(i,a),u=n.length-1,c=[...n],d=n[n.length-1];for(;d&&d.children.length>0;){let e=d.children[0];c.push(e),d=e}if(0===c.length)return{dataPoints:[],totalPositions:0,currentPositionIndex:0,analyzedCount:0};let p=[],h=[],f=ti(e);for(let e=0;e<c.length;e++){let n=te((f=ta(f,c[e],e)).board.signMap,f.nextToPlay,t,f.history);p.push(n),h.push(l.current.get(n)??null)}let g=h.filter(e=>null!==e).length,m=[];for(let e=0;e<c.length;e++){let t=h[e];if(!t)continue;let n=e9(t,e>0?h[e-1]:null);m.push({moveNumber:e,nodeId:c[e].id,blackWinRate:n.winRate,scoreLead:n.scoreLead})}return{dataPoints:m,totalPositions:c.length,currentPositionIndex:u,analyzedCount:g}},[i,o,a,s,l,u]),B=(0,x.useCallback)(e=>{c(e)},[c]),U=(0,x.useCallback)(e=>{d(e)},[d]),V=R>0&&j.length===R;return(0,v.jsxs)("div",{className:`analysis-graph-panel ${t}`,children:[(0,v.jsxs)("div",{className:"analysis-panel-toolbar",children:[(0,v.jsxs)("button",{className:`analysis-mode-indicator ${p?"active":""}`,onClick:h,title:n(p?"analysis.analysisModeOn":"analysis.analysisModeOff"),"aria-label":n(p?"analysis.analysisModeOn":"analysis.analysisModeOff"),children:[(0,v.jsx)("span",{className:"analysis-mode-dot"}),(0,v.jsx)(aq,{size:14})]}),(0,v.jsx)("div",{className:"analysis-toolbar-separator"}),(0,v.jsx)("button",{className:`analysis-overlay-button ${k?"active":""}`,onClick:S,disabled:w,title:n("analysis.toggleOwnership"),"aria-label":n("analysis.toggleOwnership"),"aria-pressed":k,children:(0,v.jsx)(ox,{size:14})}),(0,v.jsx)("button",{className:`analysis-overlay-button ${C?"active":""}`,onClick:E,disabled:w,title:n("analysis.toggleTopMoves"),"aria-label":n("analysis.toggleTopMoves"),"aria-pressed":C,children:(0,v.jsx)(of,{size:14})}),(0,v.jsx)("div",{className:"analysis-toolbar-separator"}),(0,v.jsx)("button",{className:`analysis-action-button ${m?"active analyzing":""}`,title:n(m?"analysis.stopAnalysis":_?"analysis.waitingForEngine":"analysis.analyzeFullGame"),onClick:m?g:f,disabled:w||y||_||V,"aria-label":n("analysis.analyzeFullGame"),children:m?(0,v.jsx)(oF,{size:14}):(0,v.jsx)(oQ,{size:14})}),(0,v.jsx)("button",{className:"analysis-action-button",title:u>0?n("analysis.clearCacheWithCount",{count:u}):n("analysis.noCachedAnalysis"),onClick:T,disabled:0===u||m,"aria-label":n("analysis.clearCache"),children:(0,v.jsx)(oU,{size:14})}),(0,v.jsx)("button",{className:"analysis-action-button",title:n("analysis.analysisLegend"),onClick:()=>D(!0),"aria-label":n("analysis.analysisLegend"),children:(0,v.jsx)(oh,{size:14})}),(0,v.jsx)("div",{className:"analysis-toolbar-separator"}),(0,v.jsxs)("span",{className:"analysis-positions-count",title:n("analysis.positionsAnalyzed",{analyzed:F,total:R}),children:[F,"/",R]})]}),(0,v.jsxs)("div",{className:"analysis-chart-legend",children:[(0,v.jsxs)("button",{className:`analysis-legend-toggle ${$?"active":""}`,onClick:M,title:n("analysis.toggleWinRate"),"aria-label":n("analysis.toggleWinRate"),"aria-pressed":$,children:[(0,v.jsx)("span",{className:"legend-indicator legend-winrate"}),(0,v.jsx)("span",{className:"legend-label",children:n("analysis.winRate")})]}),(0,v.jsxs)("button",{className:`analysis-legend-toggle ${A?"active":""}`,onClick:z,title:n("analysis.toggleScore"),"aria-label":n("analysis.toggleScore"),"aria-pressed":A,children:[(0,v.jsx)("span",{className:"legend-indicator legend-score"}),(0,v.jsx)("span",{className:"legend-label",children:n("analysis.score")})]})]}),(w||I)&&(0,v.jsxs)("div",{className:"analysis-status-bar",children:[(0,v.jsx)(ob,{className:"analysis-spinner"}),(0,v.jsx)("span",{children:n(w?"analysis.initializingEngine":"analysis.analyzing")})]}),m&&(0,v.jsxs)("div",{className:"analysis-progress-inline",children:[(0,v.jsx)("span",{className:"analysis-progress-label",children:y?n("analysis.stopping"):n("analysis.analyzingProgress",{progress:Math.round(b)})}),(0,v.jsx)("div",{className:"analysis-progress-bar-inline",children:(0,v.jsx)("div",{className:"analysis-progress-bar",style:{width:`${b}%`}})}),(0,v.jsx)("button",{className:"analysis-stop-button-small",onClick:g,disabled:y,title:n("analysis.stopAnalysisButton"),children:""})]}),(0,v.jsx)(Co,{data:j,currentMoveNumber:L,totalMoves:R>0?R-1:0,onNavigate:B,onNavigateToMove:U,showWinRate:$,showScoreLead:A,onToggleWinRate:M,onToggleScoreLead:z}),(0,v.jsx)(l8,{isOpen:P,onClose:()=>D(!1)})]})},Cl=e=>{let t,n,i,a,o,{versionData:s,moveName:l,moveUrl:u,patternMatchingEnabled:c=!0,onTogglePatternMatching:d,onShowAbout:p}=e,{t:h}=rK();if(s){t=s.version,n=s.gitHash,i=new Date(s.buildDate).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric"});let e="https://github.com/kaya-go/kaya";a=`${e}/releases/tag/v${t}`,o=`${e}/commit/${n}`}return(0,v.jsxs)("div",{className:"status-bar",children:[(0,v.jsxs)("div",{className:"status-bar-section status-bar-left",children:[d&&(0,v.jsx)("button",{onClick:d,className:`status-bar-pattern-toggle ${c?"enabled":"disabled"}`,title:h(c?"patternEnabled":"patternDisabled"),children:(0,v.jsx)(oL,{size:13})}),l?(0,v.jsx)(v.Fragment,{children:u?(0,v.jsx)("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"status-bar-link",title:h("learnMore"),children:l}):(0,v.jsx)("span",{className:"status-bar-text",children:l})}):(0,v.jsx)("span",{className:"status-bar-text status-bar-empty",children:""})]}),(0,v.jsxs)("div",{className:"status-bar-section status-bar-right",children:[s?(0,v.jsxs)("button",{className:"status-bar-version status-bar-about-button",onClick:p,title:h("aboutKaya"),children:[(0,v.jsxs)("span",{children:["v",t]}),"  ",(0,v.jsx)("span",{children:n}),"  ",(0,v.jsx)("span",{className:"status-bar-date",children:i})]}):(0,v.jsx)("span",{className:"status-bar-text status-bar-empty",children:""}),"  ",(0,v.jsxs)("a",{href:"https://github.com/kaya-go/kaya/issues/new/choose",target:"_blank",rel:"noopener noreferrer",className:"status-bar-report-button",title:h("reportBug"),children:[(0,v.jsx)(aK,{size:13}),(0,v.jsx)("span",{children:h("reportIssue")})]})]})]})},Cu=(0,x.createContext)(null);function Cc(){let e=(0,x.useContext)(Cu);if(null===e)throw Error("No Tree Api Provided");return e}let Cd=(0,x.createContext)(null);function Cp(){let e=(0,x.useContext)(Cd);if(null===e)throw Error("Provide a NodesContext");return e}let Ch=(0,x.createContext)(null);function Cf(){let e=(0,x.useContext)(Ch);if(null===e)throw Error("Provide a DnDContext");return e}let Cg=(0,x.createContext)(0);function Cm(){(0,x.useContext)(Cg)}function Cy(e,t,n){return Math.max(Math.min(e,n),t)}function Cb(e){return e&&e.isLeaf}function Cv(e){return e&&e.isInternal&&!e.isOpen}function Cx(e){var t;return e&&e.isOpen&&!(null==(t=e.children)?void 0:t.length)}let Cw=(e,t)=>{let n=e;for(;n;){if(n.id===t.id)return!0;n=n.parent}return!1},C_=e=>{if(!e.parent)throw Error("Node does not have a parent");return e.parent.children.findIndex(t=>t.id===e.id)};function CS(e,t){if(!e)return null;if(e.id===t)return e;if(e.children)for(let n of e.children){let e=CS(n,t);if(e)return e}return null}function Ck(e,t){if(t(e),e.children)for(let n of e.children)Ck(n,t)}function CT(e){let t,n=C$(e);for(let i=0;i<n.length;++i)if(n[i]===e){t=CE(n,i);break}null==t||t.focus()}function CC(e){let t,n=C$(e);for(let i=0;i<n.length;++i)if(n[i]===e){t=CI(n,i);break}null==t||t.focus()}function CE(e,t){return t+1<e.length?e[t+1]:e[0]}function CI(e,t){return t-1>=0?e[t-1]:e[e.length-1]}function C$(e){return Array.from(document.querySelectorAll('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"]):not([disabled]), details:not([disabled]), summary:not(:disabled)')).filter(t=>t===e||!e.contains(t))}function CO(e,t){return"boolean"==typeof t?t:"string"==typeof t?e[t]:t(e)}function CA(e){return null===e?null:CN(e)}function CN(e){return"string"==typeof e?e:e.id}function CP(e,...t){if(e)return e(...t)}function CD(e){return new Promise((t,n)=>{let i=0;function a(){100===(i+=1)&&n(),e()?t():setTimeout(a,10)}a()})}function CM(e){var t,n;let i=e.focusedNode;return i?i.isOpen?0:i.parent?i.childIndex+1:0:null!=(n=null==(t=e.root.children)?void 0:t.length)?n:0}function Cz(e){let t=e.focusedNode;return t?t.isOpen?t.id:t.parent&&!t.parent.isRoot?t.parent.id:null:null}let Cj={display:"flex",alignItems:"center",zIndex:1},CR={flex:1,height:"2px",background:"#4B91E2",borderRadius:"1px"},CL={width:"4px",height:"4px",boxShadow:"0 0 0 3px #4B91E2",borderRadius:"50%"},CF=x.memo(function({top:e,left:t,indent:n}){let i={position:"absolute",pointerEvents:"none",top:e-2+"px",left:t+"px",right:n+"px"};return(0,v.jsxs)("div",{style:Object.assign(Object.assign({},Cj),i),children:[(0,v.jsx)("div",{style:Object.assign({},CL)}),(0,v.jsx)("div",{style:Object.assign({},CR)})]})});function CB({node:e,attrs:t,innerRef:n,children:i}){return(0,v.jsx)("div",Object.assign({},t,{ref:n,onFocus:e=>e.stopPropagation(),onClick:e.handleClick,children:i}))}function CU(e){return(0,v.jsxs)("div",{ref:e.dragHandle,style:e.style,children:[(0,v.jsx)("span",{onClick:t=>{t.stopPropagation(),e.node.toggle()},children:e.node.isLeaf?"\uD83C\uDF33":e.node.isOpen?"\uD83D\uDDC1":"\uD83D\uDDC0"})," ",e.node.isEditing?(0,v.jsx)(CG,Object.assign({},e)):(0,v.jsx)(CV,Object.assign({},e))]})}function CV(e){return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)("span",{children:e.node.data.name})})}function CG({node:e}){let t=(0,x.useRef)();return(0,x.useEffect)(()=>{var e,n;null==(e=t.current)||e.focus(),null==(n=t.current)||n.select()},[]),(0,v.jsx)("input",{ref:t,defaultValue:e.data.name,onBlur:()=>e.reset(),onKeyDown:n=>{var i;"Escape"===n.key&&e.reset(),"Enter"===n.key&&e.submit((null==(i=t.current)?void 0:i.value)||"")}})}function CH(e){return{type:"EDIT",id:e}}function CW(e={id:null},t){return"EDIT"===t.type?Object.assign(Object.assign({},e),{id:t.id}):e}function Cq(e){return{type:"FOCUS",id:e}}function CK(){return{type:"TREE_BLUR"}}function CX(e={id:null,treeFocused:!1},t){return"FOCUS"===t.type?Object.assign(Object.assign({},e),{id:t.id,treeFocused:!0}):"TREE_BLUR"===t.type?Object.assign(Object.assign({},e),{treeFocused:!1}):e}class CZ{constructor(e){this.handleClick=e=>{e.metaKey&&!this.tree.props.disableMultiSelection?this.isSelected?this.deselect():this.selectMulti():e.shiftKey&&!this.tree.props.disableMultiSelection?this.selectContiguous():(this.select(),this.activate())},this.tree=e.tree,this.id=e.id,this.data=e.data,this.level=e.level,this.children=e.children,this.parent=e.parent,this.isDraggable=e.isDraggable,this.rowIndex=e.rowIndex}get isRoot(){return this.id===CY}get isLeaf(){return!Array.isArray(this.children)}get isInternal(){return!this.isLeaf}get isOpen(){return!this.isLeaf&&this.tree.isOpen(this.id)}get isClosed(){return!this.isLeaf&&!this.tree.isOpen(this.id)}get isEditable(){return this.tree.isEditable(this.data)}get isEditing(){return this.tree.editingId===this.id}get isSelected(){return this.tree.isSelected(this.id)}get isOnlySelection(){return this.isSelected&&this.tree.hasOneSelection}get isSelectedStart(){var e;return this.isSelected&&!(null==(e=this.prev)?void 0:e.isSelected)}get isSelectedEnd(){var e;return this.isSelected&&!(null==(e=this.next)?void 0:e.isSelected)}get isFocused(){return this.tree.isFocused(this.id)}get isDragging(){return this.tree.isDragging(this.id)}get willReceiveDrop(){return this.tree.willReceiveDrop(this.id)}get state(){return{isClosed:this.isClosed,isDragging:this.isDragging,isEditing:this.isEditing,isFocused:this.isFocused,isInternal:this.isInternal,isLeaf:this.isLeaf,isOpen:this.isOpen,isSelected:this.isSelected,isSelectedEnd:this.isSelectedEnd,isSelectedStart:this.isSelectedStart,willReceiveDrop:this.willReceiveDrop}}get childIndex(){return this.parent&&this.parent.children?this.parent.children.findIndex(e=>e.id===this.id):-1}get next(){return null===this.rowIndex?null:this.tree.at(this.rowIndex+1)}get prev(){return null===this.rowIndex?null:this.tree.at(this.rowIndex-1)}get nextSibling(){var e,t;let n=this.childIndex;return null!=(t=null==(e=this.parent)?void 0:e.children[n+1])?t:null}isAncestorOf(e){if(!e)return!1;let t=e;for(;t;){if(t.id===this.id)return!0;t=t.parent}return!1}select(){this.tree.select(this)}deselect(){this.tree.deselect(this)}selectMulti(){this.tree.selectMulti(this)}selectContiguous(){this.tree.selectContiguous(this)}activate(){this.tree.activate(this)}focus(){this.tree.focus(this)}toggle(){this.tree.toggle(this)}open(){this.tree.open(this)}openParents(){this.tree.openParents(this)}close(){this.tree.close(this)}submit(e){this.tree.submit(this,e)}reset(){this.tree.reset()}clone(){return new CZ(Object.assign({},this))}edit(){return this.tree.edit(this)}}let CY="__REACT_ARBORIST_INTERNAL_ROOT__";function CQ(e){var t;function n(t,i,a){let o=e.accessId(t),s=new CZ({tree:e,data:t,level:i,parent:a,id:o,children:null,isDraggable:e.isDraggable(t),rowIndex:null}),l=e.accessChildren(t);return l&&(s.children=l.map(e=>n(e,i+1,s))),s}let i=new CZ({tree:e,id:CY,data:{id:CY},level:-1,parent:null,children:null,isDraggable:!0,rowIndex:null});return i.children=(null!=(t=e.props.data)?t:[]).map(e=>n(e,0,i)),i}let CJ=(e,t)=>({type:"VISIBILITY_OPEN",id:e,filtered:t}),C0=(e,t)=>({type:"VISIBILITY_CLOSE",id:e,filtered:t}),C1=e=>({type:"VISIBILITY_CLEAR",filtered:e});function C2(e={},t){if("VISIBILITY_OPEN"===t.type)return Object.assign(Object.assign({},e),{[t.id]:!0});if("VISIBILITY_CLOSE"===t.type)return Object.assign(Object.assign({},e),{[t.id]:!1});if("VISIBILITY_TOGGLE"===t.type){let n=e[t.id];return Object.assign(Object.assign({},e),{[t.id]:!n})}if("VISIBILITY_CLEAR"===t.type)return{};return e}function C3(e={filtered:{},unfiltered:{}},t){return t.type.startsWith("VISIBILITY")?t.filtered?Object.assign(Object.assign({},e),{filtered:C2(e.filtered,t)}):Object.assign(Object.assign({},e),{unfiltered:C2(e.unfiltered,t)}):e}let C4=e=>{var t;return{nodes:{open:{filtered:{},unfiltered:null!=(t=null==e?void 0:e.initialOpenState)?t:{}},focus:{id:null,treeFocused:!1},edit:{id:null},drag:{id:null,selectedIds:[],destinationParentId:null,destinationIndex:null},selection:{ids:new Set,anchor:null,mostRecent:null}},dnd:{cursor:{type:"none"},dragId:null,dragIds:[],parentId:null,index:-1}}},C6=e=>({type:"SELECTION_ONLY",id:CN(e)}),C5=e=>({type:"SELECTION_ADD",ids:(Array.isArray(e)?e:[e]).map(CN)}),C8=e=>({type:"SELECTION_REMOVE",ids:(Array.isArray(e)?e:[e]).map(CN)}),C7=e=>Object.assign({type:"SELECTION_SET"},e),C9=e=>({type:"SELECTION_MOST_RECENT",id:null===e?null:CN(e)}),Ee=e=>({type:"SELECTION_ANCHOR",id:null===e?null:CN(e)});function Et(e=C4().nodes.selection,t){let n=e.ids;switch(t.type){case"SELECTION_CLEAR":return Object.assign(Object.assign({},e),{ids:new Set});case"SELECTION_ONLY":return Object.assign(Object.assign({},e),{ids:new Set([t.id])});case"SELECTION_ADD":if(0===t.ids.length)return e;return t.ids.forEach(e=>n.add(e)),Object.assign(Object.assign({},e),{ids:new Set(n)});case"SELECTION_REMOVE":if(0===t.ids.length)return e;return t.ids.forEach(e=>n.delete(e)),Object.assign(Object.assign({},e),{ids:new Set(n)});case"SELECTION_SET":return Object.assign(Object.assign({},e),{ids:t.ids,mostRecent:t.mostRecent,anchor:t.anchor});case"SELECTION_MOST_RECENT":return Object.assign(Object.assign({},e),{mostRecent:t.id});case"SELECTION_ANCHOR":return Object.assign(Object.assign({},e),{anchor:t.id});default:return e}}let En=e=>({type:"DND_CURSOR",cursor:e}),Er=(e,t)=>({type:"DND_DRAG_START",id:e,dragIds:t}),Ei=()=>({type:"DND_DRAG_END"}),Ea=(e,t)=>({type:"DND_HOVERING",parentId:e,index:t});function Eo(e=C4().dnd,t){switch(t.type){case"DND_CURSOR":return Object.assign(Object.assign({},e),{cursor:t.cursor});case"DND_DRAG_START":return Object.assign(Object.assign({},e),{dragId:t.id,dragIds:t.dragIds});case"DND_DRAG_END":return C4().dnd;case"DND_HOVERING":return Object.assign(Object.assign({},e),{parentId:t.parentId,index:t.index});default:return e}}let Es={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"},El=e=>{if(!e)return{display:"none"};let{x:t,y:n}=e;return{transform:`translate(${t}px, ${n}px)`}},Eu=e=>{if(!e)return{display:"none"};let{x:t,y:n}=e;return{transform:`translate(${t+10}px, ${n+10}px)`}};function Ec({offset:e,mouse:t,id:n,dragIds:i,isDragging:a}){return(0,v.jsxs)(Ed,{isDragging:a,children:[(0,v.jsx)(Ep,{offset:e,children:(0,v.jsx)(Ef,{id:n,dragIds:i})}),(0,v.jsx)(Eh,{mouse:t,count:i.length})]})}let Ed=(0,x.memo)(function(e){return e.isDragging?(0,v.jsx)("div",{style:Es,children:e.children}):null});function Ep(e){return(0,v.jsx)("div",{className:"row preview",style:El(e.offset),children:e.children})}function Eh(e){let{count:t,mouse:n}=e;return t>1?(0,v.jsx)("div",{className:"selected-count",style:Eu(n),children:t}):null}let Ef=(0,x.memo)(function(e){let t=Cc(),n=t.get(e.id);return n?(0,v.jsx)(t.renderNode,{preview:!0,node:n,style:{paddingLeft:n.level*t.indent,opacity:.2,background:"transparent"},tree:t}):null});function Eg(){return(Eg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(null,arguments)}function Em(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ey(e,t){return(Ey=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Eb(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Ey(e,t)}var Ev=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function Ex(e,t){return!!(e===t||Ev(e)&&Ev(t))}function Ew(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!Ex(e[n],t[n]))return!1;return!0}let E_=function(e,t){void 0===t&&(t=Ew);var n,i,a=[],o=!1;return function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];return o&&n===this&&t(s,a)||(i=e.apply(this,s),o=!0,n=this,a=s),i}};var ES="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function Ek(e){cancelAnimationFrame(e.id)}function ET(e,t){var n=ES();function i(){ES()-n>=t?e.call(null):a.id=requestAnimationFrame(i)}var a={id:requestAnimationFrame(i)};return a}var EC=-1;function EE(e){if(void 0===e&&(e=!1),-1===EC||e){var t=document.createElement("div"),n=t.style;n.width="50px",n.height="50px",n.overflow="scroll",document.body.appendChild(t),EC=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return EC}var EI=null;function E$(e){if(void 0===e&&(e=!1),null===EI||e){var t=document.createElement("div"),n=t.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";var i=document.createElement("div"),a=i.style;a.width="100px",a.height="100px",t.appendChild(i),document.body.appendChild(t),t.scrollLeft>0?EI="positive-descending":(t.scrollLeft=1,EI=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t)}return EI}var EO=function(e,t,n,i){var a,o,s;if("column"===e?(a=i.columnMetadataMap,o=t.columnWidth,s=i.lastMeasuredColumnIndex):(a=i.rowMetadataMap,o=t.rowHeight,s=i.lastMeasuredRowIndex),n>s){var l=0;if(s>=0){var u=a[s];l=u.offset+u.size}for(var c=s+1;c<=n;c++){var d=o(c);a[c]={offset:l,size:d},l+=d}"column"===e?i.lastMeasuredColumnIndex=n:i.lastMeasuredRowIndex=n}return a[n]},EA=function(e,t,n,i,a,o){for(;a<=i;){var s=a+Math.floor((i-a)/2),l=EO(e,t,s,n).offset;if(l===o)return s;l<o?a=s+1:l>o&&(i=s-1)}return a>0?a-1:0},EN=150,EP=function(e,t){return e},ED=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},EM=function(e,t,n){var i=e.itemSize,a=n.itemMetadataMap,o=n.lastMeasuredIndex;if(t>o){var s=0;if(o>=0){var l=a[o];s=l.offset+l.size}for(var u=o+1;u<=t;u++){var c=i(u);a[u]={offset:s,size:c},s+=c}n.lastMeasuredIndex=t}return a[t]},Ez=function(e,t,n,i,a){for(;i<=n;){var o=i+Math.floor((n-i)/2),s=EM(e,o,t).offset;if(s===a)return o;s<a?i=o+1:s>a&&(n=o-1)}return i>0?i-1:0},Ej=function e(e){var t,n=e.getItemOffset,i=e.getEstimatedTotalSize,a=e.getItemSize,o=e.getOffsetForIndexAndAlignment,s=e.getStartIndexForOffset,l=e.getStopIndexForStartIndex,u=e.initInstanceProps,c=e.shouldResetStyleCacheOnItemSizeChange,d=e.validateProps;return(t=function(e){function t(t){var i;return(i=e.call(this,t)||this)._instanceProps=u(i.props,Em(i)),i._outerRef=void 0,i._resetIsScrollingTimeoutId=null,i.state={instance:Em(i),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"==typeof i.props.initialScrollOffset?i.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},i._callOnItemsRendered=void 0,i._callOnItemsRendered=E_(function(e,t,n,a){return i.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:n,visibleStopIndex:a})}),i._callOnScroll=void 0,i._callOnScroll=E_(function(e,t,n){return i.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:n})}),i._getItemStyle=void 0,i._getItemStyle=function(e){var t,o=i.props,s=o.direction,l=o.itemSize,u=o.layout,d=i._getItemStyleCache(c&&l,c&&u,c&&s);if(d.hasOwnProperty(e))t=d[e];else{var p=n(i.props,e,i._instanceProps),h=a(i.props,e,i._instanceProps),f="horizontal"===s||"horizontal"===u,g="rtl"===s,m=f?p:0;d[e]=t={position:"absolute",left:g?void 0:m,right:g?m:void 0,top:f?0:p,height:f?"100%":h,width:f?h:"100%"}}return t},i._getItemStyleCache=void 0,i._getItemStyleCache=E_(function(e,t,n){return{}}),i._onScrollHorizontal=function(e){var t=e.currentTarget,n=t.clientWidth,a=t.scrollLeft,o=t.scrollWidth;i.setState(function(e){if(e.scrollOffset===a)return null;var t=i.props.direction,s=a;if("rtl"===t)switch(E$()){case"negative":s=-a;break;case"positive-descending":s=o-n-a}return s=Math.max(0,Math.min(s,o-n)),{isScrolling:!0,scrollDirection:e.scrollOffset<s?"forward":"backward",scrollOffset:s,scrollUpdateWasRequested:!1}},i._resetIsScrollingDebounced)},i._onScrollVertical=function(e){var t=e.currentTarget,n=t.clientHeight,a=t.scrollHeight,o=t.scrollTop;i.setState(function(e){if(e.scrollOffset===o)return null;var t=Math.max(0,Math.min(o,a-n));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}},i._resetIsScrollingDebounced)},i._outerRefSetter=function(e){var t=i.props.outerRef;i._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},i._resetIsScrollingDebounced=function(){null!==i._resetIsScrollingTimeoutId&&Ek(i._resetIsScrollingTimeoutId),i._resetIsScrollingTimeoutId=ET(i._resetIsScrolling,EN)},i._resetIsScrolling=function(){i._resetIsScrollingTimeoutId=null,i.setState({isScrolling:!1},function(){i._getItemStyleCache(-1,null)})},i}Eb(t,e),t.getDerivedStateFromProps=function(e,t){return ED(e,t),d(e),null};var p=t.prototype;return p.scrollTo=function(e){e=Math.max(0,e),this.setState(function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},p.scrollToItem=function(e,t){void 0===t&&(t="auto");var n=this.props,i=n.itemCount,a=n.layout,s=this.state.scrollOffset;e=Math.max(0,Math.min(e,i-1));var l=0;if(this._outerRef){var u=this._outerRef;l="vertical"===a?u.scrollWidth>u.clientWidth?EE():0:u.scrollHeight>u.clientHeight?EE():0}this.scrollTo(o(this.props,e,t,s,this._instanceProps,l))},p.componentDidMount=function(){var e=this.props,t=e.direction,n=e.initialScrollOffset,i=e.layout;if("number"==typeof n&&null!=this._outerRef){var a=this._outerRef;"horizontal"===t||"horizontal"===i?a.scrollLeft=n:a.scrollTop=n}this._callPropsCallbacks()},p.componentDidUpdate=function(){var e=this.props,t=e.direction,n=e.layout,i=this.state,a=i.scrollOffset;if(i.scrollUpdateWasRequested&&null!=this._outerRef){var o=this._outerRef;if("horizontal"===t||"horizontal"===n)if("rtl"===t)switch(E$()){case"negative":o.scrollLeft=-a;break;case"positive-ascending":o.scrollLeft=a;break;default:var s=o.clientWidth,l=o.scrollWidth;o.scrollLeft=l-s-a}else o.scrollLeft=a;else o.scrollTop=a}this._callPropsCallbacks()},p.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&Ek(this._resetIsScrollingTimeoutId)},p.render=function(){var e=this.props,t=e.children,n=e.className,a=e.direction,o=e.height,s=e.innerRef,l=e.innerElementType,u=e.innerTagName,c=e.itemCount,d=e.itemData,p=e.itemKey,h=void 0===p?EP:p,f=e.layout,g=e.outerElementType,m=e.outerTagName,y=e.style,b=e.useIsScrolling,v=e.width,w=this.state.isScrolling,_="horizontal"===a||"horizontal"===f,S=_?this._onScrollHorizontal:this._onScrollVertical,k=this._getRangeToRender(),T=k[0],C=k[1],E=[];if(c>0)for(var I=T;I<=C;I++)E.push((0,x.createElement)(t,{data:d,key:h(I,d),index:I,isScrolling:b?w:void 0,style:this._getItemStyle(I)}));var $=i(this.props,this._instanceProps);return(0,x.createElement)(g||m||"div",{className:n,onScroll:S,ref:this._outerRefSetter,style:Eg({position:"relative",height:o,width:v,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:a},y)},(0,x.createElement)(l||u||"div",{children:E,ref:s,style:{height:_?"100%":$,pointerEvents:w?"none":void 0,width:_?$:"100%"}}))},p._callPropsCallbacks=function(){if("function"==typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],n=e[1],i=e[2],a=e[3];this._callOnItemsRendered(t,n,i,a)}if("function"==typeof this.props.onScroll){var o=this.state,s=o.scrollDirection,l=o.scrollOffset,u=o.scrollUpdateWasRequested;this._callOnScroll(s,l,u)}},p._getRangeToRender=function(){var e=this.props,t=e.itemCount,n=e.overscanCount,i=this.state,a=i.isScrolling,o=i.scrollDirection,u=i.scrollOffset;if(0===t)return[0,0,0,0];var c=s(this.props,u,this._instanceProps),d=l(this.props,c,u,this._instanceProps);return[Math.max(0,c-(a&&"backward"!==o?1:Math.max(1,n))),Math.max(0,Math.min(t-1,d+(a&&"forward"!==o?1:Math.max(1,n)))),c,d]},t}(x.PureComponent)).defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}({getItemOffset:function(e,t){return t*e.itemSize},getItemSize:function(e,t){return e.itemSize},getEstimatedTotalSize:function(e){var t=e.itemCount;return e.itemSize*t},getOffsetForIndexAndAlignment:function(e,t,n,i,a,o){var s=e.direction,l=e.height,u=e.itemCount,c=e.itemSize,d=e.layout,p=e.width,h="horizontal"===s||"horizontal"===d?p:l,f=Math.max(0,u*c-h),g=Math.min(f,t*c),m=Math.max(0,t*c-h+c+o);switch("smart"===n&&(n=i>=m-h&&i<=g+h?"auto":"center"),n){case"start":return g;case"end":return m;case"center":var y=Math.round(m+(g-m)/2);if(y<Math.ceil(h/2))return 0;if(y>f+Math.floor(h/2))return f;return y;default:if(i>=m&&i<=g)return i;if(i<m)return m;return g}},getStartIndexForOffset:function(e,t){return Math.max(0,Math.min(e.itemCount-1,Math.floor(t/e.itemSize)))},getStopIndexForStartIndex:function(e,t,n){var i=e.direction,a=e.height,o=e.itemCount,s=e.itemSize,l=e.layout,u=e.width,c=Math.ceil((("horizontal"===i||"horizontal"===l?u:a)+n-t*s)/s);return Math.max(0,Math.min(o-1,t+c-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});function ER(e,t){for(var n in e)if(!(n in t))return!0;for(var i in t)if(e[i]!==t[i])return!0;return!1}var EL=null,EF=null;function EB(){var e,t;let n=Cc(),i=Cf().cursor;if(!i||"line"!==i.type)return null;let a=n.indent,o=n.rowHeight*i.index+(null!=(t=null!=(e=n.props.padding)?e:n.props.paddingTop)?t:0),s=a*i.level,l=n.renderCursor;return(0,v.jsx)(l,{top:o,left:s,indent:a})}var EU=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)0>t.indexOf(i[a])&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]]);return n};let EV=(0,x.forwardRef)(function(e,t){let{children:n}=e,i=EU(e,["children"]),a=Cc();return(0,v.jsxs)("div",Object.assign({ref:t},i,{onClick:e=>{e.currentTarget===e.target&&a.deselectAll()},children:[(0,v.jsx)(EG,{}),n]}))}),EG=()=>{let e=Cc();return(0,v.jsx)("div",{style:{height:e.visibleNodes.length*e.rowHeight,width:"100%",position:"absolute",left:"0",right:"0"},children:(0,v.jsx)(EB,{})})};var EH=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)0>t.indexOf(i[a])&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]]);return n};let EW=(0,x.forwardRef)(function(e,t){var n,i,a,o,{style:s}=e,l=EH(e,["style"]);let u=Cc(),c=null!=(i=null!=(n=u.props.padding)?n:u.props.paddingTop)?i:0,d=null!=(o=null!=(a=u.props.padding)?a:u.props.paddingBottom)?o:0;return(0,v.jsx)("div",Object.assign({ref:t,style:Object.assign(Object.assign({},s),{height:`${parseFloat(s.height)+c+d}px`})},l))});function Eq(e,t,n){var i=n.getRegistry(),a=i.addTarget(e,t);return[a,function(){return i.removeTarget(a)}]}function EK(e,t,n){var i=n.getRegistry(),a=i.addSource(e,t);return[a,function(){return i.removeSource(a)}]}var EX="undefined"!=typeof window?x.useLayoutEffect:x.useEffect;function EZ(e){return(EZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function EY(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function EQ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function EJ(e,t,n){return t&&EQ(e.prototype,t),n&&EQ(e,n),e}function E0(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E1=function(){function e(t,n,i){EY(this,e),E0(this,"spec",void 0),E0(this,"monitor",void 0),E0(this,"connector",void 0),this.spec=t,this.monitor=n,this.connector=i}return EJ(e,[{key:"beginDrag",value:function(){var e,t=this.spec,n=this.monitor,i=null;return null!=(e=i="object"===EZ(t.item)?t.item:"function"==typeof t.item?t.item(n):{})?e:null}},{key:"canDrag",value:function(){var e=this.spec,t=this.monitor;return"boolean"==typeof e.canDrag?e.canDrag:"function"!=typeof e.canDrag||e.canDrag(t)}},{key:"isDragging",value:function(e,t){var n=this.spec,i=this.monitor,a=n.isDragging;return a?a(i):t===e.getSourceId()}},{key:"endDrag",value:function(){var e=this.spec,t=this.monitor,n=this.connector,i=e.end;i&&i(t.getItem(),t),n.reconnect()}}]),e}();function E2(e,t,n){var i=(0,x.useMemo)(function(){return new E1(e,t,n)},[t,n]);return(0,x.useEffect)(function(){i.spec=e},[e]),i}function E3(e,t){for(var n,i=arguments.length,a=Array(i>2?i-2:0),o=2;o<i;o++)a[o-2]=arguments[o];if(!e){if(void 0===t)n=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=0;(n=Error(t.replace(/%s/g,function(){return a[s++]}))).name="Invariant Violation"}throw n.framesToPop=1,n}}var E4=(0,x.createContext)({dragDropManager:void 0});function E6(){var e=(0,x.useContext)(E4).dragDropManager;return E3(null!=e,"Expected drag drop context"),e}function E5(e){return(0,x.useMemo)(function(){var t=e.type;return E3(null!=t,"spec.type must be defined"),t},[e])}function E8(e,t){return In(e)||It(e,t)||E9(e,t)||E7()}function E7(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E9(e,t){if(e){if("string"==typeof e)return Ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ie(e,t)}}function Ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function It(e,t){var n,i,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],s=!0,l=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{s||null==a.return||a.return()}finally{if(l)throw i}}return o}}function In(e){if(Array.isArray(e))return e}function Ir(e,t,n){var i=E6(),a=E2(e,t,n),o=E5(e);EX(function(){if(null!=o){var e=E8(EK(o,a,i),2),s=e[0],l=e[1];return t.receiveHandlerId(s),n.receiveHandlerId(s),l}},[i,t,n,a,o])}function Ii(e){return Il(e)||Is(e)||Io(e)||Ia()}function Ia(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Io(e,t){if(e){if("string"==typeof e)return Iu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Iu(e,t)}}function Is(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Il(e){if(Array.isArray(e))return Iu(e)}function Iu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function Ic(e,t){var n=Ii(t||[]);return null==t&&"function"!=typeof e&&n.push(e),(0,x.useMemo)(function(){return"function"==typeof e?e():e},n)}function Id(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function Ip(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ih(e,t,n){return t&&Ip(e.prototype,t),n&&Ip(e,n),e}function If(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ig=!1,Im=!1,Iy=function(){function e(t){Id(this,e),If(this,"internalMonitor",void 0),If(this,"sourceId",null),this.internalMonitor=t.getMonitor()}return Ih(e,[{key:"receiveHandlerId",value:function(e){this.sourceId=e}},{key:"getHandlerId",value:function(){return this.sourceId}},{key:"canDrag",value:function(){E3(!Ig,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Ig=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{Ig=!1}}},{key:"isDragging",value:function(){if(!this.sourceId)return!1;E3(!Im,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Im=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{Im=!1}}},{key:"subscribeToStateChange",value:function(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}},{key:"isDraggingSource",value:function(e){return this.internalMonitor.isDraggingSource(e)}},{key:"isOverTarget",value:function(e,t){return this.internalMonitor.isOverTarget(e,t)}},{key:"getTargetIds",value:function(){return this.internalMonitor.getTargetIds()}},{key:"isSourcePublic",value:function(){return this.internalMonitor.isSourcePublic()}},{key:"getSourceId",value:function(){return this.internalMonitor.getSourceId()}},{key:"subscribeToOffsetChange",value:function(e){return this.internalMonitor.subscribeToOffsetChange(e)}},{key:"canDragSource",value:function(e){return this.internalMonitor.canDragSource(e)}},{key:"canDropOnTarget",value:function(e){return this.internalMonitor.canDropOnTarget(e)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}]),e}();function Ib(){var e=E6();return(0,x.useMemo)(function(){return new Iy(e)},[e])}function Iv(e){if("string"!=typeof e.type){var t=e.type.displayName||e.type.name||"the component";throw Error("Only native element nodes can now be passed to React DnD connectors."+"You can either wrap ".concat(t," into a <div>, or turn it into a ")+"drag source or a drop target itself.")}}function Ix(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!(0,x.isValidElement)(t)){var i=t;return e(i,n),i}var a=t;return Iv(a),IS(a,n?function(t){return e(t,n)}:e)}}function Iw(e){var t={};return Object.keys(e).forEach(function(n){var i=e[n];if(n.endsWith("Ref"))t[n]=e[n];else{var a=Ix(i);t[n]=function(){return a}}}),t}function I_(e,t){"function"==typeof e?e(t):e.current=t}function IS(e,t){var n=e.ref;return(E3("string"!=typeof n,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),n)?(0,x.cloneElement)(e,{ref:function(e){I_(n,e),I_(t,e)}}):(0,x.cloneElement)(e,{ref:t})}function Ik(e){return(Ik="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IT(e){return null!==e&&"object"===Ik(e)&&Object.prototype.hasOwnProperty.call(e,"current")}function IC(e,t,n,i){var a=n?n.call(i,e,t):void 0;if(void 0!==a)return!!a;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var o=Object.keys(e),s=Object.keys(t);if(o.length!==s.length)return!1;for(var l=Object.prototype.hasOwnProperty.bind(t),u=0;u<o.length;u++){var c=o[u];if(!l(c))return!1;var d=e[c],p=t[c];if(!1===(a=n?n.call(i,d,p,c):void 0)||void 0===a&&d!==p)return!1}return!0}function IE(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function II(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function I$(e,t,n){return t&&II(e.prototype,t),n&&II(e,n),e}function IO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var IA=function(){function e(t){var n=this;IE(this,e),IO(this,"hooks",Iw({dragSource:function(e,t){n.clearDragSource(),n.dragSourceOptions=t||null,IT(e)?n.dragSourceRef=e:n.dragSourceNode=e,n.reconnectDragSource()},dragPreview:function(e,t){n.clearDragPreview(),n.dragPreviewOptions=t||null,IT(e)?n.dragPreviewRef=e:n.dragPreviewNode=e,n.reconnectDragPreview()}})),IO(this,"handlerId",null),IO(this,"dragSourceRef",null),IO(this,"dragSourceNode",void 0),IO(this,"dragSourceOptionsInternal",null),IO(this,"dragSourceUnsubscribe",void 0),IO(this,"dragPreviewRef",null),IO(this,"dragPreviewNode",void 0),IO(this,"dragPreviewOptionsInternal",null),IO(this,"dragPreviewUnsubscribe",void 0),IO(this,"lastConnectedHandlerId",null),IO(this,"lastConnectedDragSource",null),IO(this,"lastConnectedDragSourceOptions",null),IO(this,"lastConnectedDragPreview",null),IO(this,"lastConnectedDragPreviewOptions",null),IO(this,"backend",void 0),this.backend=t}return I$(e,[{key:"receiveHandlerId",value:function(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}},{key:"connectTarget",get:function(){return this.dragSource}},{key:"dragSourceOptions",get:function(){return this.dragSourceOptionsInternal},set:function(e){this.dragSourceOptionsInternal=e}},{key:"dragPreviewOptions",get:function(){return this.dragPreviewOptionsInternal},set:function(e){this.dragPreviewOptionsInternal=e}},{key:"reconnect",value:function(){this.reconnectDragSource(),this.reconnectDragPreview()}},{key:"reconnectDragSource",value:function(){var e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();if(t&&this.disconnectDragSource(),this.handlerId){if(!e){this.lastConnectedDragSource=e;return}t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions))}}},{key:"reconnectDragPreview",value:function(){var e=this.dragPreview,t=this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(t&&this.disconnectDragPreview(),this.handlerId){if(!e){this.lastConnectedDragPreview=e;return}t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=e,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,e,this.dragPreviewOptions))}}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didConnectedDragSourceChange",value:function(){return this.lastConnectedDragSource!==this.dragSource}},{key:"didConnectedDragPreviewChange",value:function(){return this.lastConnectedDragPreview!==this.dragPreview}},{key:"didDragSourceOptionsChange",value:function(){return!IC(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}},{key:"didDragPreviewOptionsChange",value:function(){return!IC(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}},{key:"disconnectDragSource",value:function(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}},{key:"disconnectDragPreview",value:function(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}},{key:"dragSource",get:function(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}},{key:"dragPreview",get:function(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}},{key:"clearDragSource",value:function(){this.dragSourceNode=null,this.dragSourceRef=null}},{key:"clearDragPreview",value:function(){this.dragPreviewNode=null,this.dragPreviewRef=null}}]),e}();function IN(e,t){var n=E6(),i=(0,x.useMemo)(function(){return new IA(n.getBackend())},[n]);return EX(function(){return i.dragSourceOptions=e||null,i.reconnect(),function(){return i.disconnectDragSource()}},[i,e]),EX(function(){return i.dragPreviewOptions=t||null,i.reconnect(),function(){return i.disconnectDragPreview()}},[i,t]),i}var IP=__webpack_require__(792),ID=__webpack_require__.n(IP);function IM(e,t){return IF(e)||IL(e,t)||Ij(e,t)||Iz()}function Iz(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ij(e,t){if(e){if("string"==typeof e)return IR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IR(e,t)}}function IR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function IL(e,t){var n,i,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],s=!0,l=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{s||null==a.return||a.return()}finally{if(l)throw i}}return o}}function IF(e){if(Array.isArray(e))return e}function IB(e,t,n){var i=IM((0,x.useState)(function(){return t(e)}),2),a=i[0],o=i[1],s=(0,x.useCallback)(function(){var i=t(e);!ID()(a,i)&&(o(i),n&&n())},[a,e,n]);return EX(s),[a,s]}function IU(e,t){return Iq(e)||IW(e,t)||IG(e,t)||IV()}function IV(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function IG(e,t){if(e){if("string"==typeof e)return IH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IH(e,t)}}function IH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function IW(e,t){var n,i,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],s=!0,l=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{s||null==a.return||a.return()}finally{if(l)throw i}}return o}}function Iq(e){if(Array.isArray(e))return e}function IK(e,t,n){var i=IU(IB(e,t,n),2),a=i[0],o=i[1];return EX(function(){var t=e.getHandlerId();if(null!=t)return e.subscribeToStateChange(o,{handlerIds:[t]})},[e,o]),a}function IX(e,t,n){return IK(t,e||function(){return{}},function(){return n.reconnect()})}function IZ(e){return(0,x.useMemo)(function(){return e.hooks.dragSource()},[e])}function IY(e){return(0,x.useMemo)(function(){return e.hooks.dragPreview()},[e])}function IQ(e,t){var n=Ic(e,t);E3(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");var i=Ib(),a=IN(n.options,n.previewOptions);return Ir(n,i,a),[IX(n.collect,i,a),IZ(a),IY(a)]}function IJ(){return p||((p=new Image).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),p}function I0(e){let t=Cc(),n=t.selectedIds,[i,a,o]=IQ(()=>({canDrag:()=>e.isDraggable,type:"NODE",item:()=>{let i=t.isSelected(e.id)?Array.from(n):[e.id];return t.dispatch(Er(e.id,i)),{id:e.id,dragIds:i}},end:()=>{t.hideCursor(),t.dispatch(Ei())}}),[n,e]);return(0,x.useEffect)(()=>{o(IJ())},[o]),a}function I1(e){var t=e.accept;return(0,x.useMemo)(function(){return E3(null!=e.accept,"accept must be defined"),Array.isArray(t)?t:[t]},[t])}function I2(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function I3(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function I4(e,t,n){return t&&I3(e.prototype,t),n&&I3(e,n),e}function I6(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I5=function(){function e(t,n){I2(this,e),I6(this,"spec",void 0),I6(this,"monitor",void 0),this.spec=t,this.monitor=n}return I4(e,[{key:"canDrop",value:function(){var e=this.spec,t=this.monitor;return!e.canDrop||e.canDrop(t.getItem(),t)}},{key:"hover",value:function(){var e=this.spec,t=this.monitor;e.hover&&e.hover(t.getItem(),t)}},{key:"drop",value:function(){var e=this.spec,t=this.monitor;if(e.drop)return e.drop(t.getItem(),t)}}]),e}();function I8(e,t){var n=(0,x.useMemo)(function(){return new I5(e,t)},[t]);return(0,x.useEffect)(function(){n.spec=e},[e]),n}function I7(e,t){return $r(e)||$n(e,t)||$e(e,t)||I9()}function I9(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $e(e,t){if(e){if("string"==typeof e)return $t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $t(e,t)}}function $t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function $n(e,t){var n,i,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],s=!0,l=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{s||null==a.return||a.return()}finally{if(l)throw i}}return o}}function $r(e){if(Array.isArray(e))return e}function $i(e,t,n){var i=E6(),a=I8(e,t),o=I1(e);EX(function(){var e=I7(Eq(o,a,i),2),s=e[0],l=e[1];return t.receiveHandlerId(s),n.receiveHandlerId(s),l},[i,t,a,n,o.map(function(e){return e.toString()}).join("|")])}function $a(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function $o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $s(e,t,n){return t&&$o(e.prototype,t),n&&$o(e,n),e}function $l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $u=!1,$c=function(){function e(t){$a(this,e),$l(this,"internalMonitor",void 0),$l(this,"targetId",null),this.internalMonitor=t.getMonitor()}return $s(e,[{key:"receiveHandlerId",value:function(e){this.targetId=e}},{key:"getHandlerId",value:function(){return this.targetId}},{key:"subscribeToStateChange",value:function(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}},{key:"canDrop",value:function(){if(!this.targetId)return!1;E3(!$u,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return $u=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{$u=!1}}},{key:"isOver",value:function(e){return!!this.targetId&&this.internalMonitor.isOverTarget(this.targetId,e)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}]),e}();function $d(){var e=E6();return(0,x.useMemo)(function(){return new $c(e)},[e])}function $p(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function $h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $f(e,t,n){return t&&$h(e.prototype,t),n&&$h(e,n),e}function $g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $m=function(){function e(t){var n=this;$p(this,e),$g(this,"hooks",Iw({dropTarget:function(e,t){n.clearDropTarget(),n.dropTargetOptions=t,IT(e)?n.dropTargetRef=e:n.dropTargetNode=e,n.reconnect()}})),$g(this,"handlerId",null),$g(this,"dropTargetRef",null),$g(this,"dropTargetNode",void 0),$g(this,"dropTargetOptionsInternal",null),$g(this,"unsubscribeDropTarget",void 0),$g(this,"lastConnectedHandlerId",null),$g(this,"lastConnectedDropTarget",null),$g(this,"lastConnectedDropTargetOptions",null),$g(this,"backend",void 0),this.backend=t}return $f(e,[{key:"connectTarget",get:function(){return this.dropTarget}},{key:"reconnect",value:function(){var e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();var t=this.dropTarget;if(this.handlerId){if(!t){this.lastConnectedDropTarget=t;return}e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions))}}},{key:"receiveHandlerId",value:function(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}},{key:"dropTargetOptions",get:function(){return this.dropTargetOptionsInternal},set:function(e){this.dropTargetOptionsInternal=e}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didDropTargetChange",value:function(){return this.lastConnectedDropTarget!==this.dropTarget}},{key:"didOptionsChange",value:function(){return!IC(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}},{key:"disconnectDropTarget",value:function(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}},{key:"dropTarget",get:function(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}},{key:"clearDropTarget",value:function(){this.dropTargetRef=null,this.dropTargetNode=null}}]),e}();function $y(e){var t=E6(),n=(0,x.useMemo)(function(){return new $m(t.getBackend())},[t]);return EX(function(){return n.dropTargetOptions=e||null,n.reconnect(),function(){return n.disconnectDropTarget()}},[e]),n}function $b(e){return(0,x.useMemo)(function(){return e.hooks.dropTarget()},[e])}function $v(e,t){var n=Ic(e,t),i=$d(),a=$y(n.options);return $i(n,i,a),[IX(n.collect,i,a),$b(a)]}function $x(e,t){let n=e.getBoundingClientRect(),i=t.x-Math.round(n.x),a=t.y-Math.round(n.y),o=n.height,s=a<o/2,l=!s,u=o/4,c=a>u&&a<o-u,d=!c&&s,p=!c&&l;return{x:i,inTopHalf:s,inBottomHalf:l,inMiddle:c,atTop:d,atBottom:p}}function $w(e,t,n,i){if(!e)return[t,null];if(e.isInternal)if(i.atTop)return[t,e];else if(i.inMiddle)return[e,e];else return[e,n];return i.inTopHalf?[t,e]:[e,n]}function $_(e,t){return{parentId:e||null,index:t}}function $S(e,t){return{type:"line",index:e,level:t}}function $k(e){return{type:"highlight",id:e}}function $T(e,t){var n;let i=e;for(;i.parent&&i.level>t;)i=i.parent;return{parentId:(null==(n=i.parent)?void 0:n.id)||null,index:C_(i)+1}}function $C(e){var t;let n=$x(e.element,e.offset),i=e.indent,a=Math.round(Math.max(0,n.x-i)/i),{node:o,nextNode:s,prevNode:l}=e,[u,c]=$w(o,l,s,n);if(o&&o.isInternal&&n.inMiddle)return{drop:$_(o.id,null),cursor:$k(o.id)};if(!u)return{drop:$_(null==(t=null==c?void 0:c.parent)?void 0:t.id,0),cursor:$S(0,0)};if(Cb(u)||Cv(u)){let e=Cy(a,(null==c?void 0:c.level)||0,u.level);return{drop:$T(u,e),cursor:$S(u.rowIndex+1,e)}}if(Cx(u)){let e=Cy(a,0,u.level+1);return e>u.level?{drop:$_(u.id,0),cursor:$S(u.rowIndex+1,e)}:{drop:$T(u,e),cursor:$S(u.rowIndex+1,e)}}return{drop:$_(null==u?void 0:u.id,0),cursor:$S(u.rowIndex+1,u.level+1)}}function $E(e,t){let n=Cc(),[i,a]=$v(()=>({accept:"NODE",canDrop:()=>n.canDrop(),hover:(i,a)=>{let o=a.getClientOffset();if(!e.current||!o)return;let{cursor:s,drop:l}=$C({element:e.current,offset:o,indent:n.indent,node:t,prevNode:t.prev,nextNode:t.next});l&&n.dispatch(Ea(l.parentId,l.index)),a.canDrop()?s&&n.showCursor(s):n.hideCursor()},drop:(e,t)=>{if(!t.canDrop())return null;let{parentId:i,index:a,dragIds:o}=n.state.dnd;CP(n.props.onMove,{dragIds:o,parentId:i===CY?null:i,index:null===a?0:a,dragNodes:n.dragNodes,parentNode:n.get(i)}),n.open(i)}}),[t,e.current,n.props]);return a}function $I(e){let t=Cc(),n=t.at(e);if(!n)throw Error(`Could not find node for index: ${e}`);return(0,x.useMemo)(()=>{let i=n.clone();return t.visibleNodes[e]=i,i},[...Object.values(n.state),n])}let $$=x.memo(function({index:e,style:t}){Cm(),Cp();let n=Cc(),i=$I(e),a=(0,x.useRef)(null),o=I0(i),s=$E(a,i),l=(0,x.useCallback)(e=>{a.current=e,s(e)},[s]),u=n.indent*i.level,c=(0,x.useMemo)(()=>({paddingLeft:u}),[u]),d=(0,x.useMemo)(()=>{var e,i;return Object.assign(Object.assign({},t),{top:parseFloat(t.top)+(null!=(i=null!=(e=n.props.padding)?e:n.props.paddingTop)?i:0)})},[t,n.props.padding,n.props.paddingTop]),p={role:"treeitem","aria-level":i.level+1,"aria-selected":i.isSelected,"aria-expanded":i.isOpen,style:d,tabIndex:-1,className:n.props.rowClassName};(0,x.useEffect)(()=>{var e;!i.isEditing&&i.isFocused&&(null==(e=a.current)||e.focus({preventScroll:!0}))},[i.isEditing,i.isFocused,a.current]);let h=n.renderNode,f=n.renderRow;return(0,v.jsx)(f,{node:i,innerRef:l,attrs:p,children:(0,v.jsx)(h,{node:i,tree:n,style:c,dragHandle:o})})}),$O="",$A=null;function $N(){Cm();let e=Cc();return(0,v.jsx)("div",{role:"tree",style:{height:e.height,width:e.width,minHeight:0,minWidth:0},onContextMenu:e.props.onContextMenu,onClick:e.props.onClick,tabIndex:0,onFocus:t=>{t.currentTarget.contains(t.relatedTarget)||e.onFocus()},onBlur:t=>{t.currentTarget.contains(t.relatedTarget)||e.onBlur()},onKeyDown:t=>{var n;if(e.isEditing)return;if("Backspace"===t.key){if(!e.props.onDelete)return;let t=Array.from(e.selectedIds);if(t.length>1){let n=e.mostRecentNode;for(;n&&n.isSelected;)n=n.nextSibling;n||(n=e.lastNode),e.focus(n,{scroll:!1}),e.delete(Array.from(t))}else{let t=e.focusedNode;if(t){let n=t.nextSibling,i=t.parent;e.focus(n||i,{scroll:!1}),e.delete(t)}}return}if("Tab"===t.key&&!t.shiftKey){t.preventDefault(),CT(t.currentTarget);return}if("Tab"===t.key&&t.shiftKey){t.preventDefault(),CC(t.currentTarget);return}if("ArrowDown"===t.key){t.preventDefault();let n=e.nextNode;if(t.metaKey){e.select(e.focusedNode),e.activate(e.focusedNode);return}{if(!t.shiftKey||e.props.disableMultiSelection)return void e.focus(n);if(!n)return;let i=e.focusedNode;return void(i?i.isSelected?e.selectContiguous(n):e.selectMulti(n):e.focus(e.firstNode))}}if("ArrowUp"===t.key){t.preventDefault();let n=e.prevNode;if(!t.shiftKey||e.props.disableMultiSelection)return void e.focus(n);{if(!n)return;let t=e.focusedNode;t?t.isSelected?e.selectContiguous(n):e.selectMulti(n):e.focus(e.lastNode);return}}if("ArrowRight"===t.key){let t=e.focusedNode;if(!t)return;t.isInternal&&t.isOpen?e.focus(e.nextNode):t.isInternal&&e.open(t.id);return}if("ArrowLeft"===t.key){let t=e.focusedNode;if(!t||t.isRoot)return;t.isInternal&&t.isOpen?e.close(t.id):(null==(n=t.parent)?void 0:n.isRoot)||e.focus(t.parent);return}if("a"===t.key&&t.metaKey&&!e.props.disableMultiSelection){t.preventDefault(),e.selectAll();return}if("a"===t.key&&!t.metaKey&&e.props.onCreate)return void e.createLeaf();if("A"===t.key&&!t.metaKey){if(!e.props.onCreate)return;e.createInternal();return}if("Home"===t.key){t.preventDefault(),e.focus(e.firstNode);return}if("End"===t.key){t.preventDefault(),e.focus(e.lastNode);return}if("Enter"===t.key){let t=e.focusedNode;if(!t||!t.isEditable||!e.props.onRename)return;setTimeout(()=>{t&&e.edit(t)});return}if(" "===t.key){t.preventDefault();let n=e.focusedNode;if(!n)return;n.isLeaf?(n.select(),n.activate()):n.toggle();return}if("*"===t.key){let t=e.focusedNode;if(!t)return;e.openSiblings(t);return}if("PageUp"===t.key){t.preventDefault(),e.pageUp();return}"PageDown"===t.key&&(t.preventDefault(),e.pageDown()),clearTimeout($A),$O+=t.key,$A=setTimeout(()=>{$O=""},600);let i=e.visibleNodes.find(e=>{let t=e.data.name;return"string"==typeof t&&t.toLowerCase().startsWith($O)});i&&e.focus(i.id)},children:(0,v.jsx)(Ej,{className:e.props.className,outerRef:e.listEl,itemCount:e.visibleNodes.length,height:e.height,width:e.width,itemSize:e.rowHeight,overscanCount:e.overscanCount,itemKey:t=>{var n;return(null==(n=e.visibleNodes[t])?void 0:n.id)||t},outerElementType:EV,innerElementType:EW,onScroll:e.props.onScroll,onItemsRendered:e.onItemsRendered.bind(e),ref:e.list,children:$$})})}function $P(e){return e.isFiltered?$M(e.root,e.isMatch.bind(e)):$D(e.root)}function $D(e){let t=[];function n(e){var i;e.level>=0&&t.push(e),e.isOpen&&(null==(i=e.children)||i.forEach(n))}return n(e),t.forEach($z),t}function $M(e,t){let n={},i=[];function a(e){if(!e.isRoot&&t(e)){n[e.id]=!0;let t=e.parent;for(;t;)n[t.id]=!0,t=t.parent}if(e.children)for(let t of e.children)a(t)}function o(e){var t;e.level>=0&&n[e.id]&&i.push(e),e.isOpen&&(null==(t=e.children)||t.forEach(o))}return a(e),o(e),i.forEach($z),i}function $z(e,t){e.rowIndex=t}let $j=e=>e.reduce((e,t,n)=>(e[t.id]=n,e),{});var $R=function(e,t,n,i){function a(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function l(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?n(e.value):a(e.value).then(s,l)}u((i=i.apply(e,t||[])).next())})};let{FS:$L,ls:$F,yQ:$B}=y;class $U{constructor(e,t,n,i){this.store=e,this.props=t,this.list=n,this.listEl=i,this.visibleStartIndex=0,this.visibleStopIndex=0,this.root=CQ(this),this.visibleNodes=$P(this),this.idToIndex=$j(this.visibleNodes)}update(e){this.props=e,this.root=CQ(this),this.visibleNodes=$P(this),this.idToIndex=$j(this.visibleNodes)}dispatch(e){return this.store.dispatch(e)}get state(){return this.store.getState()}get openState(){return this.state.nodes.open.unfiltered}get width(){var e;return null!=(e=this.props.width)?e:300}get height(){var e;return null!=(e=this.props.height)?e:500}get indent(){var e;return null!=(e=this.props.indent)?e:24}get rowHeight(){var e;return null!=(e=this.props.rowHeight)?e:24}get overscanCount(){var e;return null!=(e=this.props.overscanCount)?e:1}get searchTerm(){return(this.props.searchTerm||"").trim()}get matchFn(){var e;let t=null!=(e=this.props.searchMatch)?e:(e,t)=>JSON.stringify(Object.values(e.data)).toLocaleLowerCase().includes(t.toLocaleLowerCase());return e=>t(e,this.searchTerm)}accessChildren(e){var t;return null!=(t=CO(e,this.props.childrenAccessor||"children"))?t:null}accessId(e){let t=CO(e,this.props.idAccessor||"id");if(!t)throw Error("Data must contain an 'id' property or props.idAccessor must return a string");return t}get firstNode(){var e;return null!=(e=this.visibleNodes[0])?e:null}get lastNode(){var e;return null!=(e=this.visibleNodes[this.visibleNodes.length-1])?e:null}get focusedNode(){var e;return null!=(e=this.get(this.state.nodes.focus.id))?e:null}get mostRecentNode(){var e;return null!=(e=this.get(this.state.nodes.selection.mostRecent))?e:null}get nextNode(){let e=this.indexOf(this.focusedNode);return null===e?null:this.at(e+1)}get prevNode(){let e=this.indexOf(this.focusedNode);return null===e?null:this.at(e-1)}get(e){return e&&e in this.idToIndex&&this.visibleNodes[this.idToIndex[e]]||null}at(e){return this.visibleNodes[e]||null}nodesBetween(e,t){var n;if(null===e||null===t)return[];let i=null!=(n=this.indexOf(e))?n:0,a=this.indexOf(t);if(null===a)return[];let o=Math.min(i,a),s=Math.max(i,a);return this.visibleNodes.slice(o,s+1)}indexOf(e){let t=CA(e);return t?this.idToIndex[t]:null}get editingId(){return this.state.nodes.edit.id}createInternal(){return this.create({type:"internal"})}createLeaf(){return this.create({type:"leaf"})}create(){return $R(this,arguments,void 0,function*(e={}){var t,n;let i=void 0===e.parentId?Cz(this):e.parentId,a=null!=(t=e.index)?t:CM(this),o=null!=(n=e.type)?n:"leaf",s=yield $L(this.props.onCreate,{type:o,parentId:i,index:a,parentNode:this.get(i)});s&&(this.focus(s),setTimeout(()=>{this.edit(s).then(()=>{this.select(s),this.activate(s)})}))})}delete(e){return $R(this,void 0,void 0,function*(){if(!e)return;let t=(Array.isArray(e)?e:[e]).map($F),n=t.map(e=>this.get(e)).filter(e=>!!e);yield $L(this.props.onDelete,{nodes:n,ids:t})})}edit(e){let t=$F(e);return this.resolveEdit({cancelled:!0}),this.scrollTo(t),this.dispatch(CH(t)),new Promise(e=>{$U.editPromise=e})}submit(e,t){return $R(this,void 0,void 0,function*(){if(!e)return;let n=$F(e);yield $L(this.props.onRename,{id:n,name:t,node:this.get(n)}),this.dispatch(CH(null)),this.resolveEdit({cancelled:!1,value:t}),setTimeout(()=>this.onFocus())})}reset(){this.dispatch(CH(null)),this.resolveEdit({cancelled:!0}),setTimeout(()=>this.onFocus())}activate(e){let t=this.get($B(e));t&&$L(this.props.onActivate,t)}resolveEdit(e){let t=$U.editPromise;t&&t(e),$U.editPromise=null}get selectedIds(){return this.state.nodes.selection.ids}get selectedNodes(){let e=[];for(let t of Array.from(this.selectedIds)){let n=this.get(t);n&&e.push(n)}return e}focus(e,t={}){e&&(this.props.selectionFollowsFocus?this.select(e):(this.dispatch(Cq($F(e))),!1!==t.scroll&&this.scrollTo(e),this.focusedNode&&$L(this.props.onFocus,this.focusedNode)))}pageUp(){var e,t;let n=this.visibleStartIndex,i=this.visibleStopIndex-n,a=null!=(t=null==(e=this.focusedNode)?void 0:e.rowIndex)?t:0;a=a>n?n:Math.max(n-i,0),this.focus(this.at(a))}pageDown(){var e,t;let n=this.visibleStartIndex,i=this.visibleStopIndex,a=i-n,o=null!=(t=null==(e=this.focusedNode)?void 0:e.rowIndex)?t:0;o=o<i?i:Math.min(o+a,this.visibleNodes.length-1),this.focus(this.at(o))}select(e,t={}){if(!e)return;let n=!1!==t.focus,i=$F(e);n&&this.dispatch(Cq(i)),this.dispatch(C6(i)),this.dispatch(Ee(i)),this.dispatch(C9(i)),this.scrollTo(i,t.align),this.focusedNode&&n&&$L(this.props.onFocus,this.focusedNode),$L(this.props.onSelect,this.selectedNodes)}deselect(e){if(!e)return;let t=$F(e);this.dispatch(C8(t)),$L(this.props.onSelect,this.selectedNodes)}selectMulti(e){let t=this.get($B(e));t&&(this.dispatch(Cq(t.id)),this.dispatch(C5(t.id)),this.dispatch(Ee(t.id)),this.dispatch(C9(t.id)),this.scrollTo(t),this.focusedNode&&$L(this.props.onFocus,this.focusedNode),$L(this.props.onSelect,this.selectedNodes))}selectContiguous(e){if(!e)return;let t=$F(e),{anchor:n,mostRecent:i}=this.state.nodes.selection;this.dispatch(Cq(t)),this.dispatch(C8(this.nodesBetween(n,i))),this.dispatch(C5(this.nodesBetween(n,$B(t)))),this.dispatch(C9(t)),this.scrollTo(t),this.focusedNode&&$L(this.props.onFocus,this.focusedNode),$L(this.props.onSelect,this.selectedNodes)}deselectAll(){this.setSelection({ids:[],anchor:null,mostRecent:null}),$L(this.props.onSelect,this.selectedNodes)}selectAll(){var e;this.setSelection({ids:Object.keys(this.idToIndex),anchor:this.firstNode,mostRecent:this.lastNode}),this.dispatch(Cq(null==(e=this.lastNode)?void 0:e.id)),this.focusedNode&&$L(this.props.onFocus,this.focusedNode),$L(this.props.onSelect,this.selectedNodes)}setSelection(e){var t;let n=new Set(null==(t=e.ids)?void 0:t.map($F)),i=$B(e.anchor),a=$B(e.mostRecent);this.dispatch(C7({ids:n,anchor:i,mostRecent:a})),$L(this.props.onSelect,this.selectedNodes)}get cursorParentId(){let{cursor:e}=this.state.dnd;return"highlight"===e.type?e.id:null}get cursorOverFolder(){return"highlight"===this.state.dnd.cursor.type}get dragNodes(){return this.state.dnd.dragIds.map(e=>this.get(e)).filter(e=>!!e)}get dragNode(){return this.get(this.state.nodes.drag.id)}get dragDestinationParent(){return this.get(this.state.nodes.drag.destinationParentId)}get dragDestinationIndex(){return this.state.nodes.drag.destinationIndex}canDrop(){var e;if(this.isFiltered)return!1;let t=null!=(e=this.get(this.state.dnd.parentId))?e:this.root,n=this.dragNodes,i=this.props.disableDrop;for(let e of n)if(!e||!t||e.isInternal&&Cw(t,e))return!1;return"function"==typeof i?!i({parentNode:t,dragNodes:this.dragNodes,index:this.state.dnd.index||0}):"string"==typeof i?!t.data[i]:"boolean"!=typeof i||!i}hideCursor(){this.dispatch(En({type:"none"}))}showCursor(e){this.dispatch(En(e))}open(e){let t=$B(e);!t||this.isOpen(t)||(this.dispatch(CJ(t,this.isFiltered)),$L(this.props.onToggle,t))}close(e){let t=$B(e);!t||this.isOpen(t)&&(this.dispatch(C0(t,this.isFiltered)),$L(this.props.onToggle,t))}toggle(e){let t=$B(e);if(t)return this.isOpen(t)?this.close(t):this.open(t)}openParents(e){let t=$B(e);if(!t)return;let n=CS(this.root,t),i=null==n?void 0:n.parent;for(;i;)this.open(i.id),i=i.parent}openSiblings(e){let t=e.parent;if(t){if(t.children){let n=e.isOpen;for(let e of t.children)e.isInternal&&(n?this.close(e.id):this.open(e.id));this.scrollTo(this.focusedNode)}}else this.toggle(e.id)}openAll(){Ck(this.root,e=>{e.isInternal&&e.open()})}closeAll(){Ck(this.root,e=>{e.isInternal&&e.close()})}scrollTo(e,t="smart"){if(!e)return;let n=$F(e);return this.openParents(n),CD(()=>n in this.idToIndex).then(()=>{var e;let i=this.idToIndex[n];void 0!==i&&(null==(e=this.list.current)||e.scrollToItem(i,t))}).catch(()=>{})}get isEditing(){return null!==this.state.nodes.edit.id}get isFiltered(){var e;return!!(null==(e=this.props.searchTerm)?void 0:e.trim())}get hasFocus(){return this.state.nodes.focus.treeFocused}get hasNoSelection(){return 0===this.state.nodes.selection.ids.size}get hasOneSelection(){return 1===this.state.nodes.selection.ids.size}get hasMultipleSelections(){return this.state.nodes.selection.ids.size>1}isSelected(e){return!!e&&this.state.nodes.selection.ids.has(e)}isOpen(e){var t,n,i;if(!e)return!1;if(e===CY)return!0;let a=null==(t=this.props.openByDefault)||t;return this.isFiltered?null==(n=this.state.nodes.open.filtered[e])||n:null!=(i=this.state.nodes.open.unfiltered[e])?i:a}isEditable(e){return!CO(e,this.props.disableEdit||(()=>!1))}isDraggable(e){return!CO(e,this.props.disableDrag||(()=>!1))}isDragging(e){let t=$B(e);return!!t&&this.state.nodes.drag.id===t}isFocused(e){return this.hasFocus&&this.state.nodes.focus.id===e}isMatch(e){return this.matchFn(e)}willReceiveDrop(e){let t=$B(e);if(!t)return!1;let{destinationParentId:n,destinationIndex:i}=this.state.nodes.drag;return t===n&&null===i}onFocus(){let e=this.focusedNode||this.firstNode;e&&this.dispatch(Cq(e.id))}onBlur(){this.dispatch(CK())}onItemsRendered(e){this.visibleStartIndex=e.visibleStartIndex,this.visibleStopIndex=e.visibleStopIndex}get renderContainer(){return this.props.renderContainer||$N}get renderRow(){return this.props.renderRow||CB}get renderNode(){return this.props.children||CU}get renderDragPreview(){return this.props.renderDragPreview||Ec}get renderCursor(){return this.props.renderCursor||CF}}function $V(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var $G="function"==typeof Symbol&&Symbol.observable||"@@observable",$H=()=>Math.random().toString(36).substring(7).split("").join("."),$W={INIT:`@@redux/INIT${$H()}`,REPLACE:`@@redux/REPLACE${$H()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${$H()}`};function $q(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function $K(e,t,n){if("function"!=typeof e)throw Error($V(2));if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw Error($V(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw Error($V(1));return n($K)(e,t)}let i=e,a=t,o=new Map,s=o,l=0,u=!1;function c(){s===o&&(s=new Map,o.forEach((e,t)=>{s.set(t,e)}))}function d(){if(u)throw Error($V(3));return a}function p(e){if("function"!=typeof e)throw Error($V(4));if(u)throw Error($V(5));let t=!0;c();let n=l++;return s.set(n,e),function(){if(t){if(u)throw Error($V(6));t=!1,c(),s.delete(n),o=null}}}function h(e){if(!$q(e))throw Error($V(7));if(void 0===e.type)throw Error($V(8));if("string"!=typeof e.type)throw Error($V(17));if(u)throw Error($V(9));try{u=!0,a=i(a,e)}finally{u=!1}return(o=s).forEach(e=>{e()}),e}function f(e){if("function"!=typeof e)throw Error($V(10));i=e,h({type:$W.REPLACE})}function g(){let e=p;return{subscribe(t){if("object"!=typeof t||null===t)throw Error($V(11));function n(){let e=t;e.next&&e.next(d())}return n(),{unsubscribe:e(n)}},[$G](){return this}}}return h({type:$W.INIT}),{dispatch:h,subscribe:p,getState:d,replaceReducer:f,[$G]:g}}function $X(e){Object.keys(e).forEach(t=>{let n=e[t];if(void 0===n(void 0,{type:$W.INIT}))throw Error($V(12));if(void 0===n(void 0,{type:$W.PROBE_UNKNOWN_ACTION()}))throw Error($V(13))})}function $Z(e){let t,n=Object.keys(e),i={};for(let t=0;t<n.length;t++){let a=n[t];"function"==typeof e[a]&&(i[a]=e[a])}let a=Object.keys(i);try{$X(i)}catch(e){t=e}return function(e={},n){if(t)throw t;let o=!1,s={};for(let t=0;t<a.length;t++){let l=a[t],u=i[l],c=e[l],d=u(c,n);if(void 0===d)throw n&&n.type,Error($V(14));s[l]=d,o=o||d!==c}return(o=o||a.length!==Object.keys(e).length)?s:e}}let $Y=$Z({nodes:$Z({focus:CX,edit:CW,open:C3,selection:Et,drag:function(e=C4().nodes.drag,t){switch(t.type){case"DND_DRAG_START":return Object.assign(Object.assign({},e),{id:t.id,selectedIds:t.dragIds});case"DND_DRAG_END":return Object.assign(Object.assign({},e),{id:null,destinationParentId:null,destinationIndex:null,selectedIds:[]});case"DND_HOVERING":if(t.parentId!==e.destinationParentId||t.index!=e.destinationIndex)return Object.assign(Object.assign({},e),{destinationParentId:t.parentId,destinationIndex:t.index});return e;default:return e}}}),dnd:Eo});function $Q(e){var t=null;return function(){return null==t&&(t=e()),t}}function $J(e,t){return e.filter(function(e){return e!==t})}function $0(e,t){var n=new Set,i=function(e){return n.add(e)};e.forEach(i),t.forEach(i);var a=[];return n.forEach(function(e){return a.push(e)}),a}function $1(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function $2(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $3(e,t,n){return t&&$2(e.prototype,t),n&&$2(e,n),e}function $4(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $6=function(){function e(t){$1(this,e),$4(this,"entered",[]),$4(this,"isNodeInDocument",void 0),this.isNodeInDocument=t}return $3(e,[{key:"enter",value:function(e){var t=this,n=this.entered.length,i=function(n){return t.isNodeInDocument(n)&&(!n.contains||n.contains(e))};return this.entered=$0(this.entered.filter(i),[e]),0===n&&this.entered.length>0}},{key:"leave",value:function(e){var t=this.entered.length;return this.entered=$J(this.entered.filter(this.isNodeInDocument),e),t>0&&0===this.entered.length}},{key:"reset",value:function(){this.entered=[]}}]),e}(),$5=$Q(function(){return/firefox/i.test(navigator.userAgent)}),$8=$Q(function(){return!!window.safari});function $7(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function $9(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Oe(e,t,n){return t&&$9(e.prototype,t),n&&$9(e,n),e}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var On=function(){function e(t,n){$7(this,e),Ot(this,"xs",void 0),Ot(this,"ys",void 0),Ot(this,"c1s",void 0),Ot(this,"c2s",void 0),Ot(this,"c3s",void 0);for(var i,a,o,s=t.length,l=[],u=0;u<s;u++)l.push(u);l.sort(function(e,n){return t[e]<t[n]?-1:1});for(var c=[],d=[],p=[],h=0;h<s-1;h++)i=t[h+1]-t[h],a=n[h+1]-n[h],d.push(i),c.push(a),p.push(a/i);for(var f=[p[0]],g=0;g<d.length-1;g++){var m=p[g],y=p[g+1];if(m*y<=0)f.push(0);else{i=d[g];var b=d[g+1],v=i+b;f.push(3*v/((v+b)/m+(v+i)/y))}}f.push(p[p.length-1]);for(var x=[],w=[],_=0;_<f.length-1;_++){o=p[_];var S=f[_],k=1/d[_],T=S+f[_+1]-o-o;x.push((o-S-T)*k),w.push(T*k*k)}this.xs=t,this.ys=n,this.c1s=f,this.c2s=x,this.c3s=w}return Oe(e,[{key:"interpolate",value:function(e){var t,n=this.xs,i=this.ys,a=this.c1s,o=this.c2s,s=this.c3s,l=n.length-1;if(e===n[l])return i[l];for(var u=0,c=s.length-1;u<=c;){var d=n[t=Math.floor(.5*(u+c))];if(d<e)u=t+1;else{if(!(d>e))return i[t];c=t-1}}var p=e-n[l=Math.max(0,c)],h=p*p;return i[l]+a[l]*p+o[l]*h+s[l]*p*h}}]),e}(),Or=1;function Oi(e){var t=e.nodeType===Or?e:e.parentElement;if(!t)return null;var n=t.getBoundingClientRect(),i=n.top;return{x:n.left,y:i}}function Oa(e){return{x:e.clientX,y:e.clientY}}function Oo(e){var t;return"IMG"===e.nodeName&&($5()||!(null!=(t=document.documentElement)&&t.contains(e)))}function Os(e,t,n,i){var a=e?t.width:n,o=e?t.height:i;return $8()&&e&&(o/=window.devicePixelRatio,a/=window.devicePixelRatio),{dragPreviewWidth:a,dragPreviewHeight:o}}function Ol(e,t,n,i,a){var o=Oo(t),s=Oi(o?e:t),l={x:n.x-s.x,y:n.y-s.y},u=e.offsetWidth,c=e.offsetHeight,d=i.anchorX,p=i.anchorY,h=Os(o,t,u,c),f=h.dragPreviewWidth,g=h.dragPreviewHeight,m=function(){var e=new On([0,.5,1],[l.y,l.y/c*g,l.y+g-c]).interpolate(p);return $8()&&o&&(e+=(window.devicePixelRatio-1)*g),e},y=function(){return new On([0,.5,1],[l.x,l.x/u*f,l.x+f-u]).interpolate(d)},b=a.offsetX,v=a.offsetY,x=0===v||v;return{x:0===b||b?b:y(),y:x?v:m()}}var Ou="__NATIVE_FILE__",Oc="__NATIVE_URL__",Od="__NATIVE_TEXT__",Op="__NATIVE_HTML__";function Oh(e,t,n){var i=t.reduce(function(t,n){return t||e.getData(n)},"");return null!=i?i:n}function Of(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Og=(Of(h={},Ou,{exposeProperties:{files:function(e){return Array.prototype.slice.call(e.files)},items:function(e){return e.items},dataTransfer:function(e){return e}},matchesTypes:["Files"]}),Of(h,Op,{exposeProperties:{html:function(e,t){return Oh(e,t,"")},dataTransfer:function(e){return e}},matchesTypes:["Html","text/html"]}),Of(h,Oc,{exposeProperties:{urls:function(e,t){return Oh(e,t,"").split("\n")},dataTransfer:function(e){return e}},matchesTypes:["Url","text/uri-list"]}),Of(h,Od,{exposeProperties:{text:function(e,t){return Oh(e,t,"")},dataTransfer:function(e){return e}},matchesTypes:["Text","text/plain"]}),h);function Om(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function Oy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ob(e,t,n){return t&&Oy(e.prototype,t),n&&Oy(e,n),e}function Ov(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ox=function(){function e(t){Om(this,e),Ov(this,"item",void 0),Ov(this,"config",void 0),this.config=t,this.item={},this.initializeExposedProperties()}return Ob(e,[{key:"initializeExposedProperties",value:function(){var e=this;Object.keys(this.config.exposeProperties).forEach(function(t){Object.defineProperty(e.item,t,{configurable:!0,enumerable:!0,get:function(){return console.warn("Browser doesn't allow reading \"".concat(t,'" until the drop event.')),null}})})}},{key:"loadDataTransfer",value:function(e){var t=this;if(e){var n={};Object.keys(this.config.exposeProperties).forEach(function(i){n[i]={value:t.config.exposeProperties[i](e,t.config.matchesTypes),configurable:!0,enumerable:!0}}),Object.defineProperties(this.item,n)}}},{key:"canDrag",value:function(){return!0}},{key:"beginDrag",value:function(){return this.item}},{key:"isDragging",value:function(e,t){return t===e.getSourceId()}},{key:"endDrag",value:function(){}}]),e}();function Ow(e,t){var n=new Ox(Og[e]);return n.loadDataTransfer(t),n}function O_(e){if(!e)return null;var t=Array.prototype.slice.call(e.types||[]);return Object.keys(Og).filter(function(e){return Og[e].matchesTypes.some(function(e){return t.indexOf(e)>-1})})[0]||null}function OS(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function Ok(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function OT(e,t,n){return t&&Ok(e.prototype,t),n&&Ok(e,n),e}function OC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var OE=function(){function e(t,n){OS(this,e),OC(this,"ownerDocument",null),OC(this,"globalContext",void 0),OC(this,"optionsArgs",void 0),this.globalContext=t,this.optionsArgs=n}return OT(e,[{key:"window",get:function(){return this.globalContext?this.globalContext:"undefined"!=typeof window?window:void 0}},{key:"document",get:function(){var e;return null!=(e=this.globalContext)&&e.document?this.globalContext.document:this.window?this.window.document:void 0}},{key:"rootElement",get:function(){var e;return(null==(e=this.optionsArgs)?void 0:e.rootElement)||this.window}}]),e}();function OI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function O$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?OI(Object(n),!0).forEach(function(t){OP(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OI(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function OO(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function OA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ON(e,t,n){return t&&OA(e.prototype,t),n&&OA(e,n),e}function OP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var OD=function(){function e(t,n,i){var a=this;OO(this,e),OP(this,"options",void 0),OP(this,"actions",void 0),OP(this,"monitor",void 0),OP(this,"registry",void 0),OP(this,"enterLeaveCounter",void 0),OP(this,"sourcePreviewNodes",new Map),OP(this,"sourcePreviewNodeOptions",new Map),OP(this,"sourceNodes",new Map),OP(this,"sourceNodeOptions",new Map),OP(this,"dragStartSourceIds",null),OP(this,"dropTargetIds",[]),OP(this,"dragEnterTargetIds",[]),OP(this,"currentNativeSource",null),OP(this,"currentNativeHandle",null),OP(this,"currentDragSourceNode",null),OP(this,"altKeyPressed",!1),OP(this,"mouseMoveTimeoutTimer",null),OP(this,"asyncEndDragFrameId",null),OP(this,"dragOverTargetIds",null),OP(this,"lastClientOffset",null),OP(this,"hoverRafId",null),OP(this,"getSourceClientOffset",function(e){var t=a.sourceNodes.get(e);return t&&Oi(t)||null}),OP(this,"endDragNativeItem",function(){a.isDraggingNativeItem()&&(a.actions.endDrag(),a.currentNativeHandle&&a.registry.removeSource(a.currentNativeHandle),a.currentNativeHandle=null,a.currentNativeSource=null)}),OP(this,"isNodeInDocument",function(e){return!!(e&&a.document&&a.document.body&&a.document.body.contains(e))}),OP(this,"endDragIfSourceWasRemovedFromDOM",function(){var e=a.currentDragSourceNode;!(null==e||a.isNodeInDocument(e))&&a.clearCurrentDragSourceNode()&&a.monitor.isDragging()&&a.actions.endDrag()}),OP(this,"handleTopDragStartCapture",function(){a.clearCurrentDragSourceNode(),a.dragStartSourceIds=[]}),OP(this,"handleTopDragStart",function(e){if(!e.defaultPrevented){var t=a.dragStartSourceIds;a.dragStartSourceIds=null;var n=Oa(e);a.monitor.isDragging()&&a.actions.endDrag(),a.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:a.getSourceClientOffset,clientOffset:n});var i=e.dataTransfer,o=O_(i);if(a.monitor.isDragging()){if(i&&"function"==typeof i.setDragImage){var s=a.monitor.getSourceId(),l=a.sourceNodes.get(s),u=a.sourcePreviewNodes.get(s)||l;if(u){var c=a.getCurrentSourcePreviewNodeOptions(),d=Ol(l,u,n,{anchorX:c.anchorX,anchorY:c.anchorY},{offsetX:c.offsetX,offsetY:c.offsetY});i.setDragImage(u,d.x,d.y)}}try{null==i||i.setData("application/json",{})}catch(e){}a.setCurrentDragSourceNode(e.target),a.getCurrentSourcePreviewNodeOptions().captureDraggingState?a.actions.publishDragSource():setTimeout(function(){return a.actions.publishDragSource()},0)}else if(o)a.beginDragNativeItem(o);else{if(i&&!i.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}}}),OP(this,"handleTopDragEndCapture",function(){a.clearCurrentDragSourceNode()&&a.monitor.isDragging()&&a.actions.endDrag()}),OP(this,"handleTopDragEnterCapture",function(e){if(a.dragEnterTargetIds=[],!(!a.enterLeaveCounter.enter(e.target)||a.monitor.isDragging())){var t=e.dataTransfer,n=O_(t);n&&a.beginDragNativeItem(n,t)}}),OP(this,"handleTopDragEnter",function(e){var t=a.dragEnterTargetIds;if(a.dragEnterTargetIds=[],a.monitor.isDragging()){a.altKeyPressed=e.altKey,t.length>0&&a.actions.hover(t,{clientOffset:Oa(e)});var n=t.some(function(e){return a.monitor.canDropOnTarget(e)});n&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=a.getCurrentDropEffect()))}}),OP(this,"handleTopDragOverCapture",function(){a.dragOverTargetIds=[]}),OP(this,"handleTopDragOver",function(e){var t=a.dragOverTargetIds;if(a.dragOverTargetIds=[],!a.monitor.isDragging()){e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none");return}a.altKeyPressed=e.altKey,a.lastClientOffset=Oa(e),null===a.hoverRafId&&"undefined"!=typeof requestAnimationFrame&&(a.hoverRafId=requestAnimationFrame(function(){a.monitor.isDragging()&&a.actions.hover(t||[],{clientOffset:a.lastClientOffset}),a.hoverRafId=null})),(t||[]).some(function(e){return a.monitor.canDropOnTarget(e)})?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=a.getCurrentDropEffect())):a.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))}),OP(this,"handleTopDragLeaveCapture",function(e){a.isDraggingNativeItem()&&e.preventDefault(),a.enterLeaveCounter.leave(e.target)&&a.isDraggingNativeItem()&&setTimeout(function(){return a.endDragNativeItem()},0)}),OP(this,"handleTopDropCapture",function(e){if(a.dropTargetIds=[],a.isDraggingNativeItem()){var t;e.preventDefault(),null==(t=a.currentNativeSource)||t.loadDataTransfer(e.dataTransfer)}else O_(e.dataTransfer)&&e.preventDefault();a.enterLeaveCounter.reset()}),OP(this,"handleTopDrop",function(e){var t=a.dropTargetIds;a.dropTargetIds=[],a.actions.hover(t,{clientOffset:Oa(e)}),a.actions.drop({dropEffect:a.getCurrentDropEffect()}),a.isDraggingNativeItem()?a.endDragNativeItem():a.monitor.isDragging()&&a.actions.endDrag()}),OP(this,"handleSelectStart",function(e){var t=e.target;"function"!=typeof t.dragDrop||"INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop())}),this.options=new OE(n,i),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.registry=t.getRegistry(),this.enterLeaveCounter=new $6(this.isNodeInDocument)}return ON(e,[{key:"profile",value:function(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null==(e=this.dragStartSourceIds)?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null==(t=this.dragOverTargetIds)?void 0:t.length)||0}}},{key:"window",get:function(){return this.options.window}},{key:"document",get:function(){return this.options.document}},{key:"rootElement",get:function(){return this.options.rootElement}},{key:"setup",value:function(){var e=this.rootElement;if(void 0!==e){if(e.__isReactDndBackendSetUp)throw Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}},{key:"teardown",value:function(){var e,t=this.rootElement;void 0!==t&&(t.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&(null==(e=this.window)||e.cancelAnimationFrame(this.asyncEndDragFrameId)))}},{key:"connectDragPreview",value:function(e,t,n){var i=this;return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),function(){i.sourcePreviewNodes.delete(e),i.sourcePreviewNodeOptions.delete(e)}}},{key:"connectDragSource",value:function(e,t,n){var i=this;this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,n);var a=function(t){return i.handleDragStart(t,e)},o=function(e){return i.handleSelectStart(e)};return t.setAttribute("draggable","true"),t.addEventListener("dragstart",a),t.addEventListener("selectstart",o),function(){i.sourceNodes.delete(e),i.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",a),t.removeEventListener("selectstart",o),t.setAttribute("draggable","false")}}},{key:"connectDropTarget",value:function(e,t){var n=this,i=function(t){return n.handleDragEnter(t,e)},a=function(t){return n.handleDragOver(t,e)},o=function(t){return n.handleDrop(t,e)};return t.addEventListener("dragenter",i),t.addEventListener("dragover",a),t.addEventListener("drop",o),function(){t.removeEventListener("dragenter",i),t.removeEventListener("dragover",a),t.removeEventListener("drop",o)}}},{key:"addEventListeners",value:function(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}},{key:"removeEventListeners",value:function(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}},{key:"getCurrentSourceNodeOptions",value:function(){var e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return O$({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}},{key:"getCurrentDropEffect",value:function(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}},{key:"getCurrentSourcePreviewNodeOptions",value:function(){var e=this.monitor.getSourceId();return O$({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(e)||{})}},{key:"isDraggingNativeItem",value:function(){var e=this.monitor.getItemType();return Object.keys(b).some(function(t){return b[t]===e})}},{key:"beginDragNativeItem",value:function(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=Ow(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}},{key:"setCurrentDragSourceNode",value:function(e){var t=this;this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;var n=1e3;this.mouseMoveTimeoutTimer=setTimeout(function(){var e;return null==(e=t.rootElement)?void 0:e.addEventListener("mousemove",t.endDragIfSourceWasRemovedFromDOM,!0)},n)}},{key:"clearCurrentDragSourceNode",value:function(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var e;null==(e=this.window)||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}},{key:"handleDragStart",value:function(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}},{key:"handleDragEnter",value:function(e,t){this.dragEnterTargetIds.unshift(t)}},{key:"handleDragOver",value:function(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}},{key:"handleDrop",value:function(e,t){this.dropTargetIds.unshift(t)}}]),e}(),OM=function(e,t,n){return new OD(e,t,n)},Oz="dnd-core/INIT_COORDS",Oj="dnd-core/BEGIN_DRAG",OR="dnd-core/PUBLISH_DRAG_SOURCE",OL="dnd-core/HOVER",OF="dnd-core/DROP",OB="dnd-core/END_DRAG";function OU(e,t){return{type:Oz,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}function OV(e){return(OV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OG(e,t,n){return t.split(".").reduce(function(e,t){return e&&e[t]?e[t]:n||null},e)}function OH(e,t){return e.filter(function(e){return e!==t})}function OW(e){return"object"===OV(e)}function Oq(e,t){var n=new Map,i=function(e){n.set(e,n.has(e)?n.get(e)+1:1)};e.forEach(i),t.forEach(i);var a=[];return n.forEach(function(e,t){1===e&&a.push(t)}),a}function OK(e,t){return e.filter(function(e){return t.indexOf(e)>-1})}var OX={type:Oz,payload:{clientOffset:null,sourceClientOffset:null}};function OZ(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{publishSource:!0},i=n.publishSource,a=void 0===i||i,o=n.clientOffset,s=n.getSourceClientOffset,l=e.getMonitor(),u=e.getRegistry();e.dispatch(OU(o)),OY(t,l,u);var c=O0(t,l);if(null===c)return void e.dispatch(OX);var d=null;if(o){if(!s)throw Error("getSourceClientOffset must be defined");OQ(s),d=s(c)}e.dispatch(OU(o,d));var p=u.getSource(c).beginDrag(l,c);if(null!=p){OJ(p),u.pinSource(c);var h=u.getSourceType(c);return{type:Oj,payload:{itemType:h,item:p,sourceId:c,clientOffset:o||null,sourceClientOffset:d||null,isSourcePublic:!!a}}}}}function OY(e,t,n){E3(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach(function(e){E3(n.getSource(e),"Expected sourceIds to be registered.")})}function OQ(e){E3("function"==typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}function OJ(e){E3(OW(e),"Item must be an object.")}function O0(e,t){for(var n=null,i=e.length-1;i>=0;i--)if(t.canDragSource(e[i])){n=e[i];break}return n}function O1(e){return function(){if(e.getMonitor().isDragging())return{type:OR}}}function O2(e,t){return null===t?null===e:Array.isArray(e)?e.some(function(e){return e===t}):e===t}function O3(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.clientOffset;O4(t);var a=t.slice(0),o=e.getMonitor(),s=e.getRegistry();return O6(a,o,s),O5(a,s,o.getItemType()),O8(a,o,s),{type:OL,payload:{targetIds:a,clientOffset:i||null}}}}function O4(e){E3(Array.isArray(e),"Expected targetIds to be an array.")}function O6(e,t,n){E3(t.isDragging(),"Cannot call hover while not dragging."),E3(!t.didDrop(),"Cannot call hover after drop.");for(var i=0;i<e.length;i++){var a=e[i];E3(e.lastIndexOf(a)===i,"Expected targetIds to be unique in the passed array."),E3(n.getTarget(a),"Expected targetIds to be registered.")}}function O5(e,t,n){for(var i=e.length-1;i>=0;i--){var a=e[i];O2(t.getTargetType(a),n)||e.splice(i,1)}}function O8(e,t,n){e.forEach(function(e){n.getTarget(e).hover(t,e)})}function O7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function O9(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O7(Object(n),!0).forEach(function(t){Ae(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O7(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function At(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.getMonitor(),i=e.getRegistry();An(n),Aa(n).forEach(function(a,o){var s=Ar(a,o,i,n),l={type:OF,payload:{dropResult:O9(O9({},t),s)}};e.dispatch(l)})}}function An(e){E3(e.isDragging(),"Cannot call drop while not dragging."),E3(!e.didDrop(),"Cannot call drop twice during one drag operation.")}function Ar(e,t,n,i){var a=n.getTarget(e),o=a?a.drop(i,e):void 0;return Ai(o),void 0===o&&(o=0===t?{}:i.getDropResult()),o}function Ai(e){E3(void 0===e||OW(e),"Drop result must either be an object or undefined.")}function Aa(e){var t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}function Ao(e){return function(){var t=e.getMonitor(),n=e.getRegistry();As(t);var i=t.getSourceId();return null!=i&&(n.getSource(i,!0).endDrag(t,i),n.unpinSource()),{type:OB}}}function As(e){E3(e.isDragging(),"Cannot call endDrag while not dragging.")}function Al(e){return{beginDrag:OZ(e),publishDragSource:O1(e),hover:O3(e),drop:At(e),endDrag:Ao(e)}}function Au(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function Ac(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ad(e,t,n){return t&&Ac(e.prototype,t),n&&Ac(e,n),e}function Ap(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ah=function(){function e(t,n){var i=this;Au(this,e),Ap(this,"store",void 0),Ap(this,"monitor",void 0),Ap(this,"backend",void 0),Ap(this,"isSetUp",!1),Ap(this,"handleRefCountChange",function(){var e=i.store.getState().refCount>0;i.backend&&(e&&!i.isSetUp?(i.backend.setup(),i.isSetUp=!0):!e&&i.isSetUp&&(i.backend.teardown(),i.isSetUp=!1))}),this.store=t,this.monitor=n,t.subscribe(this.handleRefCountChange)}return Ad(e,[{key:"receiveBackend",value:function(e){this.backend=e}},{key:"getMonitor",value:function(){return this.monitor}},{key:"getBackend",value:function(){return this.backend}},{key:"getRegistry",value:function(){return this.monitor.registry}},{key:"getActions",value:function(){var e=this,t=this.store.dispatch;function n(n){return function(){for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];var s=n.apply(e,a);void 0!==s&&t(s)}}var i=Al(this);return Object.keys(i).reduce(function(e,t){var a=i[t];return e[t]=n(a),e},{})}},{key:"dispatch",value:function(e){this.store.dispatch(e)}}]),e}();function Af(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var Ag=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}(),Am=function(){return Math.random().toString(36).substring(7).split("").join(".")},Ay={INIT:"@@redux/INIT"+Am(),REPLACE:"@@redux/REPLACE"+Am(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Am()}};function Ab(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Av(e,t,n){if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw Error(Af(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw Error(Af(1));return n(Av)(e,t)}if("function"!=typeof e)throw Error(Af(2));var i,a=e,o=t,s=[],l=s,u=!1;function c(){l===s&&(l=s.slice())}function d(){if(u)throw Error(Af(3));return o}function p(e){if("function"!=typeof e)throw Error(Af(4));if(u)throw Error(Af(5));var t=!0;return c(),l.push(e),function(){if(t){if(u)throw Error(Af(6));t=!1,c();var n=l.indexOf(e);l.splice(n,1),s=null}}}function h(e){if(!Ab(e))throw Error(Af(7));if(void 0===e.type)throw Error(Af(8));if(u)throw Error(Af(9));try{u=!0,o=a(o,e)}finally{u=!1}for(var t=s=l,n=0;n<t.length;n++)(0,t[n])();return e}function f(e){if("function"!=typeof e)throw Error(Af(10));a=e,h({type:Ay.REPLACE})}function g(){var e,t=p;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw Error(Af(11));function n(){e.next&&e.next(d())}return n(),{unsubscribe:t(n)}}})[Ag]=function(){return this},e}return h({type:Ay.INIT}),(i={dispatch:h,subscribe:p,getState:d,replaceReducer:f})[Ag]=g,i}var Ax=function(e,t){return e===t};function Aw(e,t){return!e&&!t||!!e&&!!t&&e.x===t.x&&e.y===t.y}function A_(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ax;if(e.length!==t.length)return!1;for(var i=0;i<e.length;++i)if(!n(e[i],t[i]))return!1;return!0}function AS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Ak(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?AS(Object(n),!0).forEach(function(t){AT(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function AT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var AC={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function AE(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:AC,t=arguments.length>1?arguments[1]:void 0,n=t.payload;switch(t.type){case Oz:case Oj:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case OL:if(Aw(e.clientOffset,n.clientOffset))return e;return Ak(Ak({},e),{},{clientOffset:n.clientOffset});case OB:case OF:return AC;default:return e}}var AI="dnd-core/ADD_SOURCE",A$="dnd-core/ADD_TARGET",AO="dnd-core/REMOVE_SOURCE",AA="dnd-core/REMOVE_TARGET";function AN(e){return{type:AI,payload:{sourceId:e}}}function AP(e){return{type:A$,payload:{targetId:e}}}function AD(e){return{type:AO,payload:{sourceId:e}}}function AM(e){return{type:AA,payload:{targetId:e}}}function Az(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Aj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Az(Object(n),!0).forEach(function(t){AR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Az(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function AR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var AL={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function AF(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:AL,t=arguments.length>1?arguments[1]:void 0,n=t.payload;switch(t.type){case Oj:return Aj(Aj({},e),{},{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case OR:return Aj(Aj({},e),{},{isSourcePublic:!0});case OL:return Aj(Aj({},e),{},{targetIds:n.targetIds});case AA:if(-1===e.targetIds.indexOf(n.targetId))return e;return Aj(Aj({},e),{},{targetIds:OH(e.targetIds,n.targetId)});case OF:return Aj(Aj({},e),{},{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case OB:return Aj(Aj({},e),{},{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}}function AB(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case AI:case A$:return e+1;case AO:case AA:return e-1;default:return e}}var AU=[],AV=[];function AG(e,t){return e!==AU&&(e===AV||void 0===t||OK(t,e).length>0)}function AH(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1?arguments[1]:void 0;switch(e.type){case OL:break;case AI:case A$:case AA:case AO:return AU;default:return AV}var t=e.payload,n=t.targetIds,i=void 0===n?[]:n,a=t.prevTargetIds,o=void 0===a?[]:a,s=Oq(i,o);if(!(s.length>0||!A_(i,o)))return AU;var l=o[o.length-1],u=i[i.length-1];return l!==u&&(l&&s.push(l),u&&s.push(u)),s}function AW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e+1}function Aq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function AK(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Aq(Object(n),!0).forEach(function(t){AX(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Aq(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function AX(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AZ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{dirtyHandlerIds:AH(e.dirtyHandlerIds,{type:t.type,payload:AK(AK({},t.payload),{},{prevTargetIds:OG(e,"dragOperation.targetIds",[])})}),dragOffset:AE(e.dragOffset,t),refCount:AB(e.refCount,t),dragOperation:AF(e.dragOperation,t),stateId:AW(e.stateId)}}function AY(e,t){return{x:e.x+t.x,y:e.y+t.y}}function AQ(e,t){return{x:e.x-t.x,y:e.y-t.y}}function AJ(e){var t=e.clientOffset,n=e.initialClientOffset,i=e.initialSourceClientOffset;return t&&n&&i?AQ(AY(t,i),n):null}function A0(e){var t=e.clientOffset,n=e.initialClientOffset;return t&&n?AQ(t,n):null}function A1(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function A2(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function A3(e,t,n){return t&&A2(e.prototype,t),n&&A2(e,n),e}function A4(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}AU.__IS_NONE__=!0,AV.__IS_ALL__=!0;var A6=function(){function e(t,n){A1(this,e),A4(this,"store",void 0),A4(this,"registry",void 0),this.store=t,this.registry=n}return A3(e,[{key:"subscribeToStateChange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{handlerIds:void 0},i=n.handlerIds;E3("function"==typeof e,"listener must be a function."),E3(void 0===i||Array.isArray(i),"handlerIds, when specified, must be an array of strings.");var a=this.store.getState().stateId,o=function(){var n=t.store.getState(),o=n.stateId;try{o!==a&&(o!==a+1||AG(n.dirtyHandlerIds,i))&&e()}finally{a=o}};return this.store.subscribe(o)}},{key:"subscribeToOffsetChange",value:function(e){var t=this;E3("function"==typeof e,"listener must be a function.");var n=this.store.getState().dragOffset,i=function(){var i=t.store.getState().dragOffset;i!==n&&(n=i,e())};return this.store.subscribe(i)}},{key:"canDragSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e);return E3(t,"Expected to find a valid source. sourceId=".concat(e)),!this.isDragging()&&t.canDrag(this,e)}},{key:"canDropOnTarget",value:function(e){if(!e)return!1;var t=this.registry.getTarget(e);return E3(t,"Expected to find a valid target. targetId=".concat(e)),!(!this.isDragging()||this.didDrop())&&O2(this.registry.getTargetType(e),this.getItemType())&&t.canDrop(this,e)}},{key:"isDragging",value:function(){return!!this.getItemType()}},{key:"isDraggingSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e,!0);return E3(t,"Expected to find a valid source. sourceId=".concat(e)),!!this.isDragging()&&!!this.isSourcePublic()&&this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e)}},{key:"isOverTarget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shallow:!1};if(!e)return!1;var n=t.shallow;if(!this.isDragging())return!1;var i=this.registry.getTargetType(e),a=this.getItemType();if(a&&!O2(i,a))return!1;var o=this.getTargetIds();if(!o.length)return!1;var s=o.indexOf(e);return n?s===o.length-1:s>-1}},{key:"getItemType",value:function(){return this.store.getState().dragOperation.itemType}},{key:"getItem",value:function(){return this.store.getState().dragOperation.item}},{key:"getSourceId",value:function(){return this.store.getState().dragOperation.sourceId}},{key:"getTargetIds",value:function(){return this.store.getState().dragOperation.targetIds}},{key:"getDropResult",value:function(){return this.store.getState().dragOperation.dropResult}},{key:"didDrop",value:function(){return this.store.getState().dragOperation.didDrop}},{key:"isSourcePublic",value:function(){return!!this.store.getState().dragOperation.isSourcePublic}},{key:"getInitialClientOffset",value:function(){return this.store.getState().dragOffset.initialClientOffset}},{key:"getInitialSourceClientOffset",value:function(){return this.store.getState().dragOffset.initialSourceClientOffset}},{key:"getClientOffset",value:function(){return this.store.getState().dragOffset.clientOffset}},{key:"getSourceClientOffset",value:function(){return AJ(this.store.getState().dragOffset)}},{key:"getDifferenceFromInitialOffset",value:function(){return A0(this.store.getState().dragOffset)}}]),e}(),A5=0;function A8(){return A5++}function A7(e){return(A7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A9(e){E3("function"==typeof e.canDrag,"Expected canDrag to be a function."),E3("function"==typeof e.beginDrag,"Expected beginDrag to be a function."),E3("function"==typeof e.endDrag,"Expected endDrag to be a function.")}function Ne(e){E3("function"==typeof e.canDrop,"Expected canDrop to be a function."),E3("function"==typeof e.hover,"Expected hover to be a function."),E3("function"==typeof e.drop,"Expected beginDrag to be a function.")}function Nt(e,t){t&&Array.isArray(e)?e.forEach(function(e){return Nt(e,!1)}):E3("string"==typeof e||"symbol"===A7(e),t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}!function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"}(f||(f={}));let Nn="undefined"!=typeof global?global:self,Nr=Nn.MutationObserver||Nn.WebKitMutationObserver;function Ni(e){return function(){let t=setTimeout(i,0),n=setInterval(i,50);function i(){clearTimeout(t),clearInterval(n),e()}}}function Na(e){let t=1,n=new Nr(e),i=document.createTextNode("");return n.observe(i,{characterData:!0}),function(){i.data=t=-t}}let No="function"==typeof Nr?Na:Ni;class Ns{enqueueTask(e){let{queue:t,requestFlush:n}=this;t.length||(n(),this.flushing=!0),t[t.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{let{queue:e}=this;for(;this.index<e.length;){let t=this.index;if(this.index++,e[t].call(),this.index>this.capacity){for(let t=0,n=e.length-this.index;t<n;t++)e[t]=e[t+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=No(this.flush),this.requestErrorThrow=Ni(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class Nl{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,t){this.onError=e,this.release=t,this.task=null}}class Nu{create(e){let t=this.freeTasks,n=t.length?t.pop():new Nl(this.onError,e=>t[t.length]=e);return n.task=e,n}constructor(e){this.onError=e,this.freeTasks=[]}}let Nc=new Ns,Nd=new Nu(Nc.registerPendingError);function Np(e){Nc.enqueueTask(Nd.create(e))}function Nh(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function Nf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ng(e,t,n){return t&&Nf(e.prototype,t),n&&Nf(e,n),e}function Nm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ny(e,t){return N_(e)||Nw(e,t)||Nv(e,t)||Nb()}function Nb(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Nv(e,t){if(e){if("string"==typeof e)return Nx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nx(e,t)}}function Nx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function Nw(e,t){var n,i,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],s=!0,l=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{s||null==a.return||a.return()}finally{if(l)throw i}}return o}}function N_(e){if(Array.isArray(e))return e}function NS(e){var t=A8().toString();switch(e){case f.SOURCE:return"S".concat(t);case f.TARGET:return"T".concat(t);default:throw Error("Unknown Handler Role: ".concat(e))}}function Nk(e){switch(e[0]){case"S":return f.SOURCE;case"T":return f.TARGET;default:E3(!1,"Cannot parse handler ID: ".concat(e))}}function NT(e,t){var n=e.entries(),i=!1;do{var a=n.next(),o=a.done;if(Ny(a.value,2)[1]===t)return!0;i=!!o}while(!i);return!1}var NC=function(){function e(t){Nh(this,e),Nm(this,"types",new Map),Nm(this,"dragSources",new Map),Nm(this,"dropTargets",new Map),Nm(this,"pinnedSourceId",null),Nm(this,"pinnedSource",null),Nm(this,"store",void 0),this.store=t}return Ng(e,[{key:"addSource",value:function(e,t){Nt(e),A9(t);var n=this.addHandler(f.SOURCE,e,t);return this.store.dispatch(AN(n)),n}},{key:"addTarget",value:function(e,t){Nt(e,!0),Ne(t);var n=this.addHandler(f.TARGET,e,t);return this.store.dispatch(AP(n)),n}},{key:"containsHandler",value:function(e){return NT(this.dragSources,e)||NT(this.dropTargets,e)}},{key:"getSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return E3(this.isSourceId(e),"Expected a valid source ID."),t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}},{key:"getTarget",value:function(e){return E3(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}},{key:"getSourceType",value:function(e){return E3(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}},{key:"getTargetType",value:function(e){return E3(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}},{key:"isSourceId",value:function(e){return Nk(e)===f.SOURCE}},{key:"isTargetId",value:function(e){return Nk(e)===f.TARGET}},{key:"removeSource",value:function(e){var t=this;E3(this.getSource(e),"Expected an existing source."),this.store.dispatch(AD(e)),Np(function(){t.dragSources.delete(e),t.types.delete(e)})}},{key:"removeTarget",value:function(e){E3(this.getTarget(e),"Expected an existing target."),this.store.dispatch(AM(e)),this.dropTargets.delete(e),this.types.delete(e)}},{key:"pinSource",value:function(e){var t=this.getSource(e);E3(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}},{key:"unpinSource",value:function(){E3(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}},{key:"addHandler",value:function(e,t,n){var i=NS(e);return this.types.set(i,t),e===f.SOURCE?this.dragSources.set(i,n):e===f.TARGET&&this.dropTargets.set(i,n),i}}]),e}();function NE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=NI(i),o=new A6(a,new NC(a)),s=new Ah(a,o),l=e(s,t,n);return s.receiveBackend(l),s}function NI(e){var t="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return Av(AZ,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}var N$=["children"];function NO(e,t){return NM(e)||ND(e,t)||NN(e,t)||NA()}function NA(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function NN(e,t){if(e){if("string"==typeof e)return NP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NP(e,t)}}function NP(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function ND(e,t){var n,i,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],s=!0,l=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{s||null==a.return||a.return()}finally{if(l)throw i}}return o}}function NM(e){if(Array.isArray(e))return e}function Nz(e,t){if(null==e)return{};var n,i,a=Nj(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Nj(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}var NR=0,NL=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__"),NF=(0,x.memo)(function(e){var t=e.children,n=NO(NB(Nz(e,N$)),2),i=n[0],a=n[1];return(0,x.useEffect)(function(){if(a){var e=NV();return++NR,function(){0==--NR&&(e[NL]=null)}}},[]),(0,v.jsx)(E4.Provider,Object.assign({value:i},{children:t}),void 0)});function NB(e){return"manager"in e?[{dragDropManager:e.manager},!1]:[NU(e.backend,e.context,e.options,e.debugMode),!e.context]}function NU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NV(),n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,a=t;return a[NL]||(a[NL]={dragDropManager:NE(e,t,n,i)}),a[NL]}function NV(){return void 0!==__webpack_require__.g?__webpack_require__.g:window}let NG=C4();function NH({treeProps:e,imperativeHandle:t,children:n}){let i=(0,x.useRef)(null),a=(0,x.useRef)(null),o=(0,x.useRef)($K($Y,C4(e))),s=(0,rH.useSyncExternalStore)(o.current.subscribe,o.current.getState,()=>NG),l=(0,x.useMemo)(()=>new $U(o.current,e,i,a),[]),u=(0,x.useRef)(0);return(0,x.useMemo)(()=>{u.current+=1,l.update(e)},[...Object.values(e),s.nodes.open]),(0,x.useImperativeHandle)(t,()=>l),(0,x.useEffect)(()=>{l.props.selection?l.select(l.props.selection,{focus:!1}):l.deselectAll()},[l.props.selection]),(0,x.useEffect)(()=>{l.props.searchTerm||o.current.dispatch(C1(!0))},[l.props.searchTerm]),(0,v.jsx)(Cu.Provider,{value:l,children:(0,v.jsx)(Cg.Provider,{value:u.current,children:(0,v.jsx)(Cd.Provider,{value:s.nodes,children:(0,v.jsx)(Ch.Provider,{value:s.dnd,children:(0,v.jsx)(NF,Object.assign({backend:OM,options:{rootElement:l.props.dndRootElement||void 0}},e.dndManager&&{manager:e.dndManager},{children:n}))})})})})}function NW(){let e=Cc(),[,t]=$v(()=>({accept:"NODE",canDrop:(t,n)=>!!n.isOver({shallow:!0})&&e.canDrop(),hover:(t,n)=>{if(!n.isOver({shallow:!0}))return;let i=n.getClientOffset();if(!e.listEl.current||!i)return;let{cursor:a,drop:o}=$C({element:e.listEl.current,offset:i,indent:e.indent,node:null,prevNode:e.visibleNodes[e.visibleNodes.length-1],nextNode:null});o&&e.dispatch(Ea(o.parentId,o.index)),n.canDrop()?a&&e.showCursor(a):e.hideCursor()}}),[e]);t(e.listEl)}function Nq(e){return NW(),e.children}function NK(){let e=Cc().props.renderContainer||$N;return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(e,{})})}function NX(e,t){return N0(e)||NJ(e,t)||NY(e,t)||NZ()}function NZ(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function NY(e,t){if(e){if("string"==typeof e)return NQ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NQ(e,t)}}function NQ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function NJ(e,t){var n,i,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],s=!0,l=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{s||null==a.return||a.return()}finally{if(l)throw i}}return o}}function N0(e){if(Array.isArray(e))return e}function N1(e){var t=E6().getMonitor(),n=NX(IB(t,e),2),i=n[0],a=n[1];return(0,x.useEffect)(function(){return t.subscribeToOffsetChange(a)}),(0,x.useEffect)(function(){return t.subscribeToStateChange(a)}),i}function N2(){let e=Cc(),{offset:t,mouse:n,item:i,isDragging:a}=N1(e=>({offset:e.getSourceClientOffset(),mouse:e.getClientOffset(),item:e.getItem(),isDragging:e.isDragging()})),o=e.props.renderDragPreview||Ec;return(0,v.jsx)(o,{offset:t,mouse:n,id:(null==i?void 0:i.id)||null,dragIds:(null==i?void 0:i.dragIds)||[],isDragging:a})}class N3{constructor(e){this.root=N4(e)}get data(){var e,t;return null!=(t=null==(e=this.root.children)?void 0:e.map(e=>e.data))?t:[]}create(e){let t=e.parentId?this.find(e.parentId):this.root;if(!t)return null;t.addChild(e.data,e.index)}move(e){let t=this.find(e.id),n=e.parentId?this.find(e.parentId):this.root;t&&n&&(n.addChild(t.data,e.index),t.drop())}update(e){let t=this.find(e.id);t&&t.update(e.changes)}drop(e){let t=this.find(e.id);t&&t.drop()}find(e,t=this.root){if(!t)return null;if(t.id===e)return t;if(t.children)for(let n of t.children){let t=this.find(e,n);if(t)return t}return null}}function N4(e){let t=new N5({id:"ROOT"},null);return t.children=e.map(e=>N6(e,t)),t}function N6(e,t){let n=new N5(e,t);return e.children&&(n.children=e.children.map(e=>N6(e,n))),n}class N5{constructor(e,t){this.data=e,this.parent=t,this.id=e.id}hasParent(){return!!this.parent}get childIndex(){return this.hasParent()?this.parent.children.indexOf(this):-1}addChild(e,t){var n,i;let a=N6(e,this);this.children=null!=(n=this.children)?n:[],this.children.splice(t,0,a),this.data.children=null!=(i=this.data.children)?i:[],this.data.children.splice(t,0,e)}removeChild(e){var t,n;null==(t=this.children)||t.splice(e,1),null==(n=this.data.children)||n.splice(e,1)}update(e){if(this.hasParent()){let t=this.childIndex;this.parent.addChild(Object.assign(Object.assign({},this.data),e),t),this.drop()}}drop(){this.hasParent()&&this.parent.removeChild(this.childIndex)}}let N8=0;function N7(e){let[t,n]=(0,x.useState)(e),i=(0,x.useMemo)(()=>new N3(t),[t]);return[t,{onMove:e=>{for(let t of e.dragIds)i.move({id:t,parentId:e.parentId,index:e.index});n(i.data)},onRename:({name:e,id:t})=>{i.update({id:t,changes:{name:e}}),n(i.data)},onCreate:({parentId:e,index:t,type:a})=>{let o={id:`simple-tree-id-${N8++}`,name:""};return"internal"===a&&(o.children=[]),i.create({parentId:e,index:t,data:o}),n(i.data),o},onDelete:e=>{e.ids.forEach(e=>i.drop({id:e})),n(i.data)}}]}function N9(e){if(e.initialData&&e.data)throw Error("React Arborist Tree => Provide either a data or initialData prop, but not both.");if(e.initialData&&(e.onCreate||e.onDelete||e.onMove||e.onRename))throw Error(`React Arborist Tree => You passed the initialData prop along with a data handler.
Use the data prop if you want to provide your own handlers.`);if(!e.initialData)return e;{let[t,n]=N7(e.initialData);return Object.assign(Object.assign(Object.assign({},e),n),{data:t})}}function Pe(e,t){let n=N9(e);return(0,v.jsxs)(NH,{treeProps:n,imperativeHandle:t,children:[(0,v.jsx)(Nq,{children:(0,v.jsx)(NK,{})}),(0,v.jsx)(N2,{})]})}let Pt=(0,x.forwardRef)(Pe),Pn=e=>{let{mouse:t,isDragging:n,dragIds:i}=e;return n&&t?(0,v.jsx)("div",{className:"library-drag-preview",style:{position:"fixed",left:t.x+8,top:t.y-8,pointerEvents:"none",zIndex:9999,transform:"translateY(-50%)"},children:1===i.length?"\uD83D\uDCC4 Moving item...":` Moving ${i.length} items...`}):null};function Pr(e){let{collapsed:t=!1,onCollapseChange:n}=e,{t:i}=rK(),{isInitialized:a,isLoading:o,items:s,selectedId:l,selectedIds:u,expandedIds:c,loadedFileId:d,stats:p,error:h,selectItem:f,toggleItemSelection:g,selectRange:m,clearSelection:y,toggleExpanded:b,createFolder:w,createFile:_,deleteItem:S,deleteItems:k,renameItem:T,moveItem:C,openFile:E,importZip:I,exportZip:$,downloadFile:O,downloadFolder:A,downloadItems:N,clearLibrary:P,duplicateItem:D,duplicateItems:M}=ls(),{isTauriDragging:z,isOverLibrary:j}=nb(),{isDirty:R}=tZ(),[L,F]=(0,x.useState)(null),[B,U]=(0,x.useState)(null),[V,G]=(0,x.useState)(""),[H,W]=(0,x.useState)(!1),[q,K]=(0,x.useState)(!1),[X,Z]=(0,x.useState)(""),[Y,Q]=(0,x.useState)(null),[J,ee]=(0,x.useState)(null),et=(0,x.useRef)(null),en=(0,x.useRef)(null),er=(0,x.useRef)(null),ei=(0,x.useRef)(!1),ea=(0,x.useRef)(!1),eo=(0,x.useRef)(null),[es,el]=(0,x.useState)(400),[eu,ec]=(0,x.useState)(250),ed=(0,x.useCallback)(()=>{let e=new Map,t=[];for(let t of s)e.set(t.id,{id:t.id,name:t.name,children:"folder"===t.type?[]:void 0,data:t});for(let i of s){let a=e.get(i.id);if(i.parentId&&e.has(i.parentId)){var n;null==(n=e.get(i.parentId).children)||n.push(a)}else t.push(a)}let i=e=>{for(let t of(e.sort((e,t)=>e.data.type!==t.data.type?"folder"===e.data.type?-1:1:e.name.localeCompare(t.name)),e))t.children&&i(t.children)};return i(t),t},[s])(),ep=(0,x.useMemo)(()=>{if(!d)return new Set;let e=new Set,t=s.find(e=>e.id===d);if(!t)return e;let n=t.parentId;for(;n;){e.add(n);let t=s.find(e=>e.id===n);n=(null==t?void 0:t.parentId)??null}return e},[d,s]);(0,x.useEffect)(()=>{let e=()=>F(null);return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]),(0,x.useEffect)(()=>{let e=eo.current;if(!e)return;let t=(e,t)=>{let n=t-16,i=e-16;n>0&&el(n),i>0&&ec(i)},n=e.getBoundingClientRect();t(n.width,n.height);let i=new ResizeObserver(e=>{for(let n of e)t(n.contentRect.width,n.contentRect.height)});return i.observe(e),()=>i.disconnect()},[]);let eh=(0,x.useCallback)(async e=>{let t=Array.from(e.dataTransfer.files);if(0===t.length)return;e.preventDefault(),e.stopPropagation(),W(!1);let n=null;if(l){let e=s.find(e=>e.id===l);e&&(n="folder"===e.type?l:e.parentId)}for(let e of t)if(e.name.toLowerCase().endsWith(".sgf")){let t=await e.text();try{await _(e.name,t,n)}catch{}}else if(e.name.toLowerCase().endsWith(".zip")){let t=await e.arrayBuffer();await I(t)}},[_,I,l,s]),ef=(0,x.useCallback)(e=>{e.dataTransfer.types.includes("Files")&&(e.preventDefault(),e.stopPropagation(),W(!0))},[]),eg=(0,x.useCallback)(e=>{H&&(e.preventDefault(),e.stopPropagation(),W(!1))},[H]),em=(0,x.useCallback)((e,t)=>{e.preventDefault(),e.stopPropagation(),F({x:e.clientX,y:e.clientY,item:t})},[]),ey=(0,x.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),F({x:e.clientX,y:e.clientY,item:null})},[]),eb=(0,x.useCallback)(()=>{var e;null==(e=en.current)||e.click()},[]),ev=(0,x.useCallback)(async e=>{let t=e.target.files;if(t){for(let e of Array.from(t))if(e.name.toLowerCase().endsWith(".sgf")){let t=await e.text();try{await _(e.name,t,null)}catch{}}else if(e.name.toLowerCase().endsWith(".zip")){let t=await e.arrayBuffer();await I(t)}e.target.value=""}},[_,I]),ex=(0,x.useCallback)(e=>{let t=null;if(void 0!==e)t=e;else{let e=l?s.find(e=>e.id===l):null;t=(null==e?void 0:e.type)==="folder"?l:(null==e?void 0:e.parentId)||null}Q(t),Z("New Folder"),ea.current=!1,K(!0)},[l,s]),ew=(0,x.useCallback)(async()=>{X.trim()&&await w(X.trim(),Y),K(!1),Z(""),Q(null)},[X,Y,w]),{showToast:e_}=lb(),eS=(0,x.useCallback)(e=>{ei.current=!1,U(e.id),G(e.name),F(null)},[]),ek=(0,x.useCallback)(async()=>{B&&V.trim()&&await T(B,V.trim()),U(null),G("")},[B,V,T]),eT=(0,x.useCallback)(e=>{ee({title:"folder"===e.type?"Delete Folder":"Delete File",message:"folder"===e.type?`Delete folder "${e.name}" and all its contents?`:`Delete "${e.name}"?`,danger:!0,onConfirm:async()=>{await S(e.id),ee(null)}}),F(null)},[S]),eC=(0,x.useCallback)(e=>{let t=e.length;ee({title:`Delete ${t} Items`,message:`Delete ${t} selected items? This cannot be undone.`,danger:!0,onConfirm:async()=>{await k(e),ee(null)}}),F(null)},[k]),eE=(0,x.useCallback)(async e=>{await N(e),F(null)},[N]),eI=(0,x.useCallback)(async e=>{await M(e),F(null)},[M]),e$=(0,x.useCallback)(()=>{0!==s.length&&ee({title:"Clear Library",message:`Delete all ${s.length} items from your library? This cannot be undone.`,danger:!0,onConfirm:async()=>{await P(),ee(null)}})},[s.length,P]),eO=(0,x.useCallback)(e=>{"file"===e.type?E(e.id):b(e.id),F(null)},[E,b]),eA=(0,x.useRef)(0),eN=(0,x.useRef)(null),eP=(0,x.useCallback)(e=>{let{node:t,style:n,dragHandle:i}=e,a=t.data.data,o="folder"===a.type,s=u.has(a.id),l=t.isOpen,c=B===a.id,p=t.willReceiveDrop,h=d===a.id,y=o&&!l&&ep.has(a.id),b=e=>{let n=Date.now(),i=eN.current===a.id&&n-eA.current<400;if(eA.current=n,eN.current=a.id,i&&!e.shiftKey&&!e.ctrlKey&&!e.metaKey){"file"===a.type&&E(a.id);return}e.shiftKey&&et.current?(e.preventDefault(),m(et.current,a.id)):e.ctrlKey||e.metaKey?(e.preventDefault(),g(a.id),et.current=a.id):(f(a.id),et.current=a.id,"folder"===a.type&&t.toggle())};return(0,v.jsxs)("div",{ref:i,style:n,className:`library-tree-node ${s?"selected":""} ${p?"drop-target":""} ${h?"loaded":""} ${y?"has-loaded":""}`,onClick:b,onContextMenu:e=>em(e,a),children:[o&&(0,v.jsx)("span",{className:`library-tree-node-arrow ${l?"expanded":""}`,onClick:e=>{e.stopPropagation(),t.toggle()},children:(0,v.jsx)(a0,{size:14})}),(0,v.jsx)("span",{className:"library-tree-node-icon",children:o?l?(0,v.jsx)(oa,{size:16}):(0,v.jsx)(os,{size:16}):(0,v.jsx)(or,{size:16})}),c?(0,v.jsx)("input",{type:"text",className:"library-tree-node-input",value:V,onChange:e=>G(e.target.value),onBlur:ek,onKeyDown:e=>{e.stopPropagation(),"Enter"===e.key&&ek(),"Escape"===e.key&&(U(null),G(""))},onKeyUp:e=>e.stopPropagation(),onKeyPress:e=>e.stopPropagation(),autoFocus:!0,onClick:e=>e.stopPropagation(),ref:e=>{e&&!ei.current&&(ei.current=!0,e.focus(),e.select())}}):(0,v.jsxs)("span",{className:"library-tree-node-name",children:[h&&R&&(0,v.jsx)("span",{className:"library-dirty-indicator",title:"Unsaved changes",children:""}),a.name]}),"file"===a.type&&(0,v.jsx)("span",{className:"library-tree-node-meta",children:s2(a.size)})]})},[u,B,V,d,ep,R,f,m,g,em,ek,E]),eD=(0,x.useCallback)(async e=>{let{dragIds:t,parentId:n}=e;for(let e of t)await C(e,n)},[C]),eM=(0,x.useCallback)(async e=>{null!==e.parentId&&await C(e.id,null),F(null)},[C]),ez=(0,x.useCallback)(async e=>{await D(e.id),F(null)},[D]);return t?null:(0,v.jsxs)("div",{ref:er,className:"library-panel",onDrop:eh,onDragOver:ef,onDragLeave:eg,children:[(0,v.jsx)("div",{className:"library-header",children:(0,v.jsxs)("div",{className:"library-actions",children:[(0,v.jsx)("button",{className:"library-btn",onClick:()=>ex(),title:i("library.newFolder"),children:(0,v.jsx)(oo,{size:16})}),(0,v.jsx)("button",{className:"library-btn",onClick:eb,title:i("library.importSgfZip"),children:(0,v.jsx)(oK,{size:16})}),(0,v.jsx)("button",{className:"library-btn",onClick:$,title:i("library.exportLibraryAsZip"),children:(0,v.jsx)(a5,{size:16})}),(0,v.jsx)("button",{className:"library-btn danger",onClick:e$,title:i("library.clearLibrary"),disabled:0===s.length,children:(0,v.jsx)(oU,{size:16})})]})}),(0,v.jsxs)("div",{className:"library-content",ref:eo,onContextMenu:ey,children:[h&&(0,v.jsx)("div",{className:"library-error",children:h}),o&&!a?(0,v.jsx)("div",{className:"library-loading",children:i("library.loading")}):0===s.length?(0,v.jsxs)("div",{className:"library-empty",children:[(0,v.jsx)("div",{className:"library-empty-icon",children:"\uD83D\uDCDA"}),(0,v.jsx)("div",{className:"library-empty-text",children:i("library.emptyLibrary")}),(0,v.jsx)("div",{className:"library-empty-hint",children:i("library.emptyLibraryHint")})]}):(0,v.jsx)("div",{className:"library-tree",onWheel:e=>e.stopPropagation(),children:(0,v.jsx)(Pt,{data:ed,openByDefault:!1,width:eu,height:es,indent:16,rowHeight:32,selection:l||void 0,onMove:eD,disableDrag:!1,disableDrop:e=>{if(!e.parentNode)return!1;let t=e.parentNode.data;return!t||!t.data||"folder"!==t.data.type},dndRootElement:er.current,renderDragPreview:Pn,children:eP})})]}),u.size>1&&(0,v.jsxs)("div",{className:"library-selection-bar",children:[(0,v.jsx)("span",{className:"library-selection-count",children:i("library.itemsSelected",{count:u.size})}),(0,v.jsxs)("div",{className:"library-selection-actions",children:[(0,v.jsx)("button",{className:"library-btn",onClick:()=>eI([...u]),title:i("library.duplicateSelected"),children:(0,v.jsx)(a4,{size:14})}),(0,v.jsx)("button",{className:"library-btn",onClick:()=>eE([...u]),title:i("library.downloadSelected"),children:(0,v.jsx)(a5,{size:14})}),(0,v.jsx)("button",{className:"library-btn danger",onClick:()=>eC([...u]),title:i("library.deleteSelected"),children:(0,v.jsx)(oU,{size:14})}),(0,v.jsx)("button",{className:"library-btn",onClick:y,title:i("library.clearSelection"),children:""})]})]}),p&&p.totalFiles>0&&u.size<=1&&(0,v.jsxs)("div",{className:"library-stats",children:[i("library.gamesCount",{count:p.totalFiles})," "," ",i("library.foldersCount",{count:p.totalFolders})," "," ",s2(p.totalSize)]}),(0,v.jsx)("input",{ref:en,type:"file",accept:".sgf,.zip",multiple:!0,style:{display:"none"},onChange:ev}),(H||z&&j)&&(0,v.jsx)("div",{className:"library-drop-zone",children:(0,v.jsx)("span",{className:"library-drop-zone-text",children:i("library.dropToAdd")})}),L&&(0,lI.createPortal)((0,v.jsx)("div",{className:"library-context-menu",style:{left:L.x,top:L.y},ref:e=>{if(e){let t=e.getBoundingClientRect(),n=window.innerWidth,i=window.innerHeight,a=L.x,o=L.y;t.right>n&&(a=n-t.width-8),a<0&&(a=8),t.bottom>i&&(o=i-t.height-8),o<0&&(o=8),(a!==L.x||o!==L.y)&&(e.style.left=`${a}px`,e.style.top=`${o}px`)}},onClick:e=>e.stopPropagation(),children:null===L.item?(0,v.jsxs)("div",{className:"library-context-menu-item",onClick:()=>{ex(null),F(null)},children:[(0,v.jsx)("span",{className:"library-context-menu-item-icon",children:(0,v.jsx)(oo,{size:14})}),i("library.newFolder")]}):u.size>1?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"library-context-menu-header",children:i("library.itemsSelected",{count:u.size})}),(0,v.jsx)("div",{className:"library-context-menu-separator"}),(0,v.jsxs)("div",{className:"library-context-menu-item",onClick:()=>eI([...u]),children:[(0,v.jsx)("span",{className:"library-context-menu-item-icon",children:(0,v.jsx)(a4,{size:14})}),i("library.duplicateItems",{count:u.size})]}),(0,v.jsxs)("div",{className:"library-context-menu-item",onClick:()=>eE([...u]),children:[(0,v.jsx)("span",{className:"library-context-menu-item-icon",children:(0,v.jsx)(a5,{size:14})}),i("library.downloadItems",{count:u.size})]}),(0,v.jsx)("div",{className:"library-context-menu-separator"}),(0,v.jsxs)("div",{className:"library-context-menu-item danger",onClick:()=>eC([...u]),children:[(0,v.jsx)("span",{className:"library-context-menu-item-icon",children:(0,v.jsx)(oU,{size:14})}),i("library.deleteItems",{count:u.size})]})]}):(0,v.jsx)(v.Fragment,{children:(()=>{let e=L.item;return(0,v.jsxs)(v.Fragment,{children:["file"===e.type&&(0,v.jsxs)("div",{className:"library-context-menu-item",onClick:()=>eO(e),children:[(0,v.jsx)("span",{className:"library-context-menu-item-icon",children:(0,v.jsx)(o$,{size:14})}),i("library.load")]}),"folder"===e.type&&(0,v.jsxs)("div",{className:"library-context-menu-item",onClick:()=>{ex(e.id),F(null)},children:[(0,v.jsx)("span",{className:"library-context-menu-item-icon",children:(0,v.jsx)(oo,{size:14})}),i("library.newFolder")]}),(0,v.jsxs)("div",{className:"library-context-menu-item",onClick:()=>eS(e),children:[(0,v.jsx)("span",{className:"library-context-menu-item-icon",children:(0,v.jsx)(oI,{size:14})}),i("library.rename")]}),(0,v.jsxs)("div",{className:"library-context-menu-item",onClick:()=>ez(e),children:[(0,v.jsx)("span",{className:"library-context-menu-item-icon",children:(0,v.jsx)(a4,{size:14})}),i("library.duplicate")]}),(0,v.jsxs)("div",{className:"library-context-menu-item",onClick:()=>{"file"===e.type?O(e.id):A(e.id),F(null)},children:[(0,v.jsx)("span",{className:"library-context-menu-item-icon",children:(0,v.jsx)(a5,{size:14})}),i("library.download")]}),null!==e.parentId&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"library-context-menu-separator"}),(0,v.jsxs)("div",{className:"library-context-menu-item",onClick:()=>eM(e),children:[(0,v.jsx)("span",{className:"library-context-menu-item-icon",children:(0,v.jsx)(os,{size:14})}),i("library.moveToRoot")]})]}),(0,v.jsx)("div",{className:"library-context-menu-separator"}),(0,v.jsxs)("div",{className:"library-context-menu-item danger",onClick:()=>eT(e),children:[(0,v.jsx)("span",{className:"library-context-menu-item-icon",children:(0,v.jsx)(oU,{size:14})}),i("library.delete")]})]})})()})}),document.body),q&&(0,lI.createPortal)((0,v.jsx)("div",{className:"library-dialog-overlay",onClick:()=>K(!1),children:(0,v.jsxs)("div",{className:"library-dialog",onClick:e=>e.stopPropagation(),children:[(0,v.jsx)("div",{className:"library-dialog-title",children:i("library.newFolder")}),(0,v.jsx)("input",{type:"text",className:"library-dialog-input",value:X,onChange:e=>Z(e.target.value),onKeyDown:e=>{e.stopPropagation(),"Enter"===e.key&&ew(),"Escape"===e.key&&K(!1)},onKeyUp:e=>e.stopPropagation(),onKeyPress:e=>e.stopPropagation(),autoFocus:!0,ref:e=>{e&&!ea.current&&(ea.current=!0,e.focus(),e.select())}}),(0,v.jsxs)("div",{className:"library-dialog-buttons",children:[(0,v.jsx)("button",{className:"library-dialog-btn secondary",onClick:()=>K(!1),children:i("cancel")}),(0,v.jsx)("button",{className:"library-dialog-btn primary",onClick:ew,children:i("library.create")})]})]})}),document.body),J&&(0,lI.createPortal)((0,v.jsx)("div",{className:"library-dialog-overlay",onClick:()=>ee(null),children:(0,v.jsxs)("div",{className:`library-dialog ${J.danger?"danger":""}`,onClick:e=>e.stopPropagation(),children:[(0,v.jsxs)("div",{className:"library-dialog-header",children:[J.danger&&(0,v.jsx)("span",{className:"library-dialog-icon",children:(0,v.jsx)(oG,{size:20})}),(0,v.jsx)("div",{className:"library-dialog-title",children:J.title})]}),(0,v.jsx)("div",{className:"library-dialog-message",children:J.message}),(0,v.jsxs)("div",{className:"library-dialog-buttons",children:[(0,v.jsx)("button",{className:"library-dialog-btn secondary",onClick:()=>ee(null),children:i("cancel")}),(0,v.jsx)("button",{className:`library-dialog-btn ${J.danger?"danger":"primary"}`,onClick:J.onConfirm,children:i("library.delete")})]})]})}),document.body)]})}let Pi="kaya-show-library";function Pa(){let[e,t]=(0,x.useState)(()=>"undefined"!=typeof window&&!!window.localStorage&&"true"===localStorage.getItem(Pi));(0,x.useEffect)(()=>{"undefined"!=typeof window&&window.localStorage&&localStorage.setItem(Pi,String(e))},[e]);let n=(0,x.useCallback)(()=>{t(e=>!e)},[]);return(0,x.useEffect)(()=>{let e=e=>{(e.metaKey||e.ctrlKey)&&"l"===e.key.toLowerCase()&&!e.shiftKey&&(e.preventDefault(),n())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[n]),{showLibrary:e,setShowLibrary:t,toggleLibrary:n}}function Po(e){let{currentVersion:t}=e,[n,i]=(0,x.useState)(!1);if((0,x.useEffect)(()=>{if(!t)return;let e=async()=>{try{let e="/kaya/next/",n=await fetch(`${e}version.json?t=${Date.now()}`);n.ok&&(await n.json()).gitHash!==t.gitHash&&i(!0)}catch(e){}},n=setInterval(e,3e5),a=()=>e();return window.addEventListener("focus",a),()=>{clearInterval(n),window.removeEventListener("focus",a)}},[t]),!n)return null;let a=async()=>{if("serviceWorker"in navigator)for(let e of(await navigator.serviceWorker.getRegistrations()))await e.unregister();window.location.reload()};return(0,v.jsxs)("div",{style:{position:"fixed",bottom:"20px",right:"20px",backgroundColor:"var(--bg-primary, #ffffff)",color:"var(--text-primary, #000000)",border:"1px solid var(--border-color, #e5e5e5)",padding:"16px",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0,0,0,0.15)",zIndex:9999,display:"flex",flexDirection:"column",gap:"12px",maxWidth:"320px"},children:[(0,v.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[(0,v.jsx)("span",{style:{fontSize:"20px"},children:""}),(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{style:{fontWeight:600,marginBottom:"4px"},children:"New version available"}),(0,v.jsx)("div",{style:{fontSize:"13px",color:"var(--text-secondary, #666)",lineHeight:1.4},children:"A new version of Kaya is available. Refresh to get the latest features and improvements."})]})]}),(0,v.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[(0,v.jsx)("button",{onClick:()=>i(!1),style:{padding:"8px 12px",borderRadius:"6px",border:"1px solid var(--border-color, #ccc)",background:"transparent",color:"var(--text-primary, #333)",cursor:"pointer",fontSize:"13px",fontWeight:500},children:"Dismiss"}),(0,v.jsx)("button",{onClick:a,style:{padding:"8px 16px",borderRadius:"6px",border:"none",background:"var(--accent-color, #3b82f6)",color:"white",cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Update Now"})]})]})}function Ps(e){let{versionData:t,activeMobileTab:n,onMobileTabChange:i}=e,{showLibrary:a,setShowLibrary:o,toggleLibrary:s}=Pa(),l=(0,x.useRef)(null),[u,c]=(0,x.useState)(()=>{if("undefined"!=typeof window&&window.localStorage){let e=localStorage.getItem("kaya-tree-layout-horizontal");return null!==e&&"true"===e}return!1}),[d,p]=(0,x.useState)(()=>"undefined"!=typeof window&&!!window.localStorage&&"true"===localStorage.getItem("kaya-tree-show-minimap"));(0,x.useEffect)(()=>{"undefined"!=typeof window&&window.localStorage&&localStorage.setItem("kaya-tree-layout-horizontal",String(u))},[u]),(0,x.useEffect)(()=>{"undefined"!=typeof window&&window.localStorage&&localStorage.setItem("kaya-tree-show-minimap",String(d))},[d]);let{moveName:h,moveUrl:f,patternMatchingEnabled:g,togglePatternMatching:m,scoringMode:y,deadStones:b,gameInfo:w}=tQ(),[_,S]=(0,x.useState)(null),[k,T]=(0,x.useState)(()=>{if("undefined"!=typeof window&&window.localStorage){let e=localStorage.getItem("kaya-show-header");return null===e||"true"===e}return!0}),[C,E]=(0,x.useState)(()=>{if("undefined"!=typeof window&&window.localStorage){let e=localStorage.getItem("kaya-show-sidebar");return null===e||"true"===e}return!0}),{isEditMode:I,toggleEditMode:$}=bb(),[O,A]=(0,x.useState)(!1);(0,x.useEffect)(()=>{"undefined"!=typeof window&&window.localStorage&&localStorage.setItem("kaya-show-header",String(k))},[k]),(0,x.useEffect)(()=>{"undefined"!=typeof window&&window.localStorage&&localStorage.setItem("kaya-show-sidebar",String(C))},[C]),(0,x.useEffect)(()=>{let e=e=>{(e.metaKey||e.ctrlKey)&&e.shiftKey&&"m"===e.key.toLowerCase()&&(e.preventDefault(),T(e=>!e)),(e.metaKey||e.ctrlKey)&&e.shiftKey&&"b"===e.key.toLowerCase()&&(e.preventDefault(),E(e=>!e))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);let N="mobile"===o2(),[P,D]=(0,x.useState)(!1),[M,z]=(0,x.useState)(!1),{gameTree:j,rootId:R,createNewGame:L,filename:F}=tQ(),B=(0,x.useMemo)(()=>{if(F&&"Untitled Game.sgf"!==F)return!0;if(j&&null!==R){let e=j.get(R);if(e&&(e.children.length>0||e.data.annotated))return!0}return!1},[j,R,F]);(0,x.useEffect)(()=>{N||D(!0)},[N]),(0,x.useEffect)(()=>{P&&M&&(z(!1),N&&i?i("library"):o(!0))},[P,M,o,N,i]);let U=(0,x.useCallback)(()=>{L(),D(!0),N&&i&&i("board")},[L,N,i]),V=(0,x.useCallback)(()=>{D(!0),N&&i&&i("board")},[N,i]),G=(0,x.useCallback)(()=>{z(!0),D(!0)},[]),H=(0,x.useCallback)(()=>{N&&D(!1)},[N]),{loadSGFAsync:W,setFileName:q}=tQ(),K=(0,x.useCallback)(e=>{let t=new FileReader;t.onload=t=>{var n;let i=null==(n=t.target)?void 0:n.result;i&&(W(i),q(e.name),D(!0))},t.readAsText(e)},[W,q]);return N&&!P?(0,v.jsx)(lM,{onNewGame:U,onContinue:V,onOpenLibrary:G,onFileDrop:K,version:null==t?void 0:t.version,hasSavedGame:B}):(0,v.jsx)(lD,{children:(0,v.jsxs)("div",{className:"app",children:[k?(0,v.jsx)(lO,{showThemeToggle:!0,showLibrary:a,showSidebar:C,onToggleLibrary:s,onToggleSidebar:()=>E(e=>!e),onHide:()=>T(!1),onGoHome:N?H:void 0,versionData:t}):(0,v.jsx)("div",{onClick:()=>T(!0),title:"Show Menu (Cmd/Ctrl+Shift+M)",style:{height:"12px",width:"100%",background:"var(--bg-tertiary)",borderBottom:"1px solid var(--border-color)",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",transition:"background-color 0.2s",flexShrink:0},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--bg-hover)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="var(--bg-tertiary)"},children:(0,v.jsx)("div",{style:{width:"48px",height:"4px",borderRadius:"2px",background:"var(--border-color)",opacity:.6}})}),(0,v.jsx)("div",{className:"app-main",children:(0,v.jsx)(st,{showLibrary:a,onToggleLibrary:s,libraryContent:(0,v.jsx)(Pr,{}),analysisGraphContent:(0,v.jsx)(Cs,{}),showSidebar:C,onToggleSidebar:()=>E(e=>!e),boardContent:(0,v.jsx)(l7,{onScoreData:S}),activeMobileTab:n,onMobileTabChange:i,gameTreeContent:!N&&y&&_?(0,v.jsx)("div",{style:{padding:"1rem",height:"100%",overflow:"auto"},children:(0,v.jsx)(l4,{scoreData:_,deadStones:b,playerBlack:w.playerBlack,playerWhite:w.playerWhite,rankBlack:w.rankBlack,rankWhite:w.rankWhite})}):(0,v.jsx)(bh,{ref:l,horizontal:u,onLayoutChange:c,showMinimap:d}),gameTreeHeaderActions:y?null:(0,v.jsx)(bg,{horizontal:u,onToggleLayout:()=>c(e=>!e),showMinimap:d,onToggleMinimap:()=>p(e=>!e),onCenterOnCurrentNode:()=>{var e;return null==(e=l.current)?void 0:e.centerOnCurrentNode()}}),gameInfoHeaderActions:(0,v.jsx)(bv,{isEditMode:I,onToggle:$}),commentHeaderActions:(0,v.jsx)(Cr,{}),gameInfoContent:(0,v.jsx)(bx,{isEditMode:I,onEditModeChange:$}),commentContent:(0,v.jsx)(Ci,{})})}),(0,v.jsx)(Ca,{}),(0,v.jsx)(Cl,{versionData:t,moveName:h,moveUrl:f,patternMatchingEnabled:g,onTogglePatternMatching:m,onShowAbout:()=>A(!0)}),(0,v.jsx)(b_,{isOpen:O,onClose:()=>A(!1),versionData:t})]})})}function Pl(e){let{versionData:t}=e,{showToast:n}=lb(),i=(0,x.useCallback)(()=>{n("Game is too large for auto-save (max 5MB)","info")},[n]);return(0,v.jsx)(nu,{children:(0,v.jsx)(tJ,{onAutoSaveDisabled:i,children:(0,v.jsx)(ne,{children:(0,v.jsx)(no,{children:(0,v.jsx)(nm,{children:(0,v.jsx)(Pu,{versionData:t})})})})})})}function Pu(e){let{versionData:t}=e,{loadSGFAsync:n,exportSGF:i,setFileName:a,isDirty:o,setIsDirty:s}=tQ(),[l,u]=(0,x.useState)("board"),c=(0,x.useCallback)((e,t)=>{n(e),a(t),u("board")},[n,a]),d=(0,x.useCallback)(()=>i(),[i]),p=(0,x.useCallback)(()=>o,[o]),h=(0,x.useCallback)(()=>{s(!1)},[s]);return(0,v.jsx)(lo,{onFileOpen:c,getCurrentGameContent:d,getIsDirty:p,onSaveComplete:h,children:(0,v.jsx)(Ct,{children:(0,v.jsx)(Ps,{versionData:t,activeMobileTab:l,onMobileTabChange:u})})})}let Pc=function(){let[e,t]=(0,x.useState)(void 0);return(0,x.useEffect)(()=>{let e="/kaya/next/";fetch(`${e}version.json?t=${Date.now()}`).then(e=>e.json()).then(e=>t(e)).catch(()=>console.warn("Could not load version info"))},[]),(0,v.jsxs)(ly,{children:[(0,v.jsx)(Pl,{versionData:e}),(0,v.jsx)(Po,{currentVersion:e})]})},Pd=null;(function e(e){if(!("serviceWorker"in navigator))return console.log("[PWA] Service workers not supported");let t="/kaya/next/";navigator.serviceWorker.register(`${t}sw.js`).then(t=>{var n;Pd=t,console.log("[PWA] Service worker registered"),null==e||null==(n=e.onRegistered)||n.call(e,t),setInterval(()=>{t.update()},36e5),t.addEventListener("updatefound",()=>{let n=t.installing;n&&n.addEventListener("statechange",()=>{var t,i;"installed"===n.state&&navigator.serviceWorker.controller?(console.log("[PWA] New version available"),null==e||null==(t=e.onNeedRefresh)||t.call(e)):"activated"!==n.state||navigator.serviceWorker.controller||(console.log("[PWA] Content cached for offline use"),null==e||null==(i=e.onOfflineReady)||i.call(e))})})}).catch(e=>{console.error("[PWA] Service worker registration failed:",e)})})({onNeedRefresh:()=>{console.log("[PWA] New content available, refresh to update")},onOfflineReady:()=>{console.log("[PWA] App ready to work offline")}});let Pp=window.console.error;window.console.error=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];"string"==typeof t[0]&&t[0].includes("ResizeObserver loop completed with undelivered notifications")||Pp(...t)},(0,_.createRoot)(document.getElementById("root")).render((0,v.jsx)(x.StrictMode,{children:(0,v.jsx)(sH,{children:(0,v.jsx)(T,{children:(0,v.jsx)(Pc,{})})})}))})()})();
//# sourceMappingURL=index.a672256d.js.map