# Internationalization (i18n) Guide

## Overview

Kaya uses **react-i18next** for internationalization. All user-facing strings must be localized to ensure the app is accessible to the global Go community.

## Supported Languages

| Code | Language | Native Name |
| ---- | -------- | ----------- |
| `en` | English  | English     |
| `zh` | Chinese  | 中文        |
| `ko` | Korean   | 한국어      |
| `ja` | Japanese | 日本語      |
| `fr` | French   | Français    |
| `de` | German   | Deutsch     |
| `es` | Spanish  | Español     |
| `it` | Italian  | Italiano    |

## Translation Files Location

```
packages/ui/src/i18n/
├── index.ts           # i18n configuration and utilities
└── locales/
    ├── en.json        # English (primary/source)
    ├── zh.json        # Chinese
    ├── ko.json        # Korean
    ├── ja.json        # Japanese
    ├── fr.json        # French
    ├── de.json        # German
    ├── es.json        # Spanish
    └── it.json        # Italian
```

## Adding New Translations

### 1. Add to English First

Always start with `en.json` as it's the source of truth:

```json
{
  "myNewKey": "My new text",
  "mySection": {
    "nestedKey": "Nested text with {{variable}}"
  }
}
```

### 2. Use in React Components

```tsx
import { useTranslation } from 'react-i18next';

export const MyComponent: React.FC = () => {
  const { t } = useTranslation();

  return (
    <div>
      <h1>{t('myNewKey')}</h1>
      <p>{t('mySection.nestedKey', { variable: 'value' })}</p>
    </div>
  );
};
```

### 3. Add Translations for All Languages

**CRITICAL**: After adding keys to `en.json`, you **must** add corresponding translations to all 7 other language files:

- `zh.json` - Chinese
- `ko.json` - Korean
- `ja.json` - Japanese
- `fr.json` - French
- `de.json` - German
- `es.json` - Spanish
- `it.json` - Italian

## Best Practices

### DO ✅

```tsx
// Use translation keys for all user-visible text
<button>{t('save')}</button>
<p>{t('unsavedChangesPrompt')}</p>

// Use interpolation for dynamic values
<span>{t('moveNumber', { number: 42 })}</span>

// Use nested keys for organization
<h2>{t('aiConfig.title')}</h2>
```

### DON'T ❌

```tsx
// Never hardcode user-visible text
<button>Save</button>
<p>You have unsaved changes</p>

// Don't concatenate translated strings
<span>{t('move') + ' ' + number}</span>
```

## Translation Key Conventions

1. **Use camelCase** for keys: `saveGame`, `unsavedChanges`
2. **Group related keys** in nested objects: `aiConfig.title`, `aiConfig.settings`
3. **Keep keys descriptive** but concise
4. **Use interpolation** for dynamic content: `"moveNumber": "Move {{number}}"`

## Verifying Translations

### Check for Missing Keys

Run the app in each language and check the console for warnings about missing translation keys.

### Manual Verification

Periodically compare all locale files to ensure they have the same keys:

```bash
# Quick check - count keys in each file
for f in packages/ui/src/i18n/locales/*.json; do
  echo "$f: $(grep -c '"' $f) lines"
done
```

### Visual Verification

1. Switch language in Settings
2. Navigate through all app sections
3. Look for untranslated text or broken layouts (some languages have longer text)

## Language Switching

Users can switch language via:

1. **Settings panel** → Language dropdown
2. Language preference is persisted in `localStorage`
3. Falls back to browser language, then English

## Technical Details

### Lazy Loading

Non-English locales are lazy-loaded to reduce initial bundle size:

```typescript
// Only en.json is bundled initially
// Other locales are loaded on-demand when selected
```

### Fallback Behavior

If a translation key is missing:

1. Falls back to English translation
2. If English is also missing, shows the key itself
3. Console warning is logged in development

## Adding a New Language

1. Create new locale file: `packages/ui/src/i18n/locales/XX.json`
2. Copy structure from `en.json`
3. Add translations for all keys
4. Register in `packages/ui/src/i18n/index.ts`:

```typescript
export const locales = {
  // ... existing locales
  xx: 'Language Name',
} as const;

const localeLoaders: Record<Locale, ...> = {
  // ... existing loaders
  xx: () => import('./locales/xx.json'),
};
```

---

**Remember**: Every user-visible string must be translated. When in doubt, use a translation key!
